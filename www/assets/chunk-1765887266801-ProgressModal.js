const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/entry-1765887266798-index.js","assets/asset-1765887267361-index.css"])))=>i.map(i=>d[i]);
import{r as k,P as N,_ as P,j as e}from"./entry-1765887266798-index.js";function T({isOpen:p,onClose:x,todaySteps:A=0}){const[o,v]=k.useState({weeklySteps:[],weeklyWorkouts:0,weeklyCalories:0,totalActiveDays:0});k.useEffect(()=>{p&&S()},[p]);const S=async()=>{try{const t=JSON.parse(localStorage.getItem("workoutHistory")||"[]");let a=null;try{const{value:s}=await N.get({key:"wellnessai_stepHistory"});s&&(a=JSON.parse(s),console.log("ğŸ“ˆ Progress Modal loaded from Android CapacitorStorage:",a?.length,"entries"))}catch(s){console.warn("âš ï¸ Could not read from Android CapacitorStorage:",s)}if(!a)try{const{default:s}=await P(async()=>{const{default:l}=await import("./entry-1765887266798-index.js").then(h=>h.x);return{default:l}},__vite__mapDeps([0,1])),r=await s.get("stepHistory");r&&Array.isArray(r)&&r.length>0&&(a=r,console.log("ğŸ“ˆ Progress Modal loaded from Firestore cloud:",a?.length,"entries"),localStorage.setItem("stepHistory",JSON.stringify(r)),await N.set({key:"wellnessai_stepHistory",value:JSON.stringify(r)}))}catch(s){console.warn("âš ï¸ Could not load from Firestore:",s)}if(!a){const s=localStorage.getItem("stepHistory");s&&(a=JSON.parse(s),console.log("ğŸ“ˆ Progress Modal fallback to localStorage:",a?.length,"entries"))}const c=Array.isArray(a)?a:[],n=new Date,i=n.getDay(),d=new Date(n),w=i===0?6:i-1;d.setDate(n.getDate()-w),d.setHours(0,0,0,0);const m=[];for(let s=0;s<7;s++){const r=new Date(d);r.setDate(d.getDate()+s);const l=r.toISOString().split("T")[0],h=c.find(C=>C.date===l);m.push({date:l,steps:h?h.steps:0})}console.log("ğŸ“Š Progress Modal: Current week data (Sun-Sat):",m);const y=new Date;y.setDate(y.getDate()-7);const D=t.filter(s=>new Date(s.date)>=y).length,b={Running:11,Cycling:10,Swimming:12,Weights:7,Yoga:3,HIIT:13,Walking:5,Sports:9,Other:7};let u=0;m.forEach(s=>{u+=Math.round(s.steps*.04)});let g=0;t.filter(s=>new Date(s.date)>=y).forEach(s=>{const r=s.type||s.activity||"Other",l=b[r]||7;g+=(s.duration||0)*l});const j=u+g;console.log("ğŸ“Š [ProgressModal] Weekly Calories - Steps:",u,"Workouts:",g,"Total:",j);const W=c.filter(s=>s.steps>1e3).length;v({weeklySteps:m,weeklyWorkouts:D,weeklyCalories:j,totalActiveDays:W})}catch{}};if(!p)return null;const f=Math.max(...o.weeklySteps.map(t=>t.steps),1e4);return e.jsx("div",{className:"modal-overlay",onClick:x,children:e.jsxs("div",{className:"progress-modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"ğŸ“ˆ Progress"}),e.jsx("button",{className:"close-btn",onClick:x,children:"âœ•"})]}),e.jsxs("div",{className:"progress-hero",children:[e.jsx("div",{className:"hero-icon",children:"ğŸ“Š"}),e.jsx("h3",{children:"Your Weekly Journey"}),e.jsx("p",{children:"Track your improvements over time"})]}),e.jsxs("div",{className:"progress-summary",children:[e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-icon",children:"ğŸ‘Ÿ"}),e.jsxs("div",{className:"summary-content",children:[e.jsxs("span",{className:"summary-value",children:[(o.weeklySteps.reduce((t,a)=>t+a.steps,0)/1e3).toFixed(1),"K"]}),e.jsx("span",{className:"summary-label",children:"Steps This Week"})]})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-icon",children:"ğŸ’ª"}),e.jsxs("div",{className:"summary-content",children:[e.jsx("span",{className:"summary-value",children:o.weeklyWorkouts}),e.jsx("span",{className:"summary-label",children:"Weekly Workouts"})]})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("span",{className:"summary-icon",children:"ğŸ”¥"}),e.jsxs("div",{className:"summary-content",children:[e.jsx("span",{className:"summary-value",children:o.weeklyCalories.toLocaleString()}),e.jsx("span",{className:"summary-label",children:"Weekly Calories"})]})]})]}),e.jsxs("div",{className:"progress-chart",children:[e.jsx("h4",{children:"Steps This Week"}),e.jsx("div",{className:"chart-bars",children:o.weeklySteps.map((t,a)=>{const c=t.steps/f*100,i=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][a];return e.jsxs("div",{className:"chart-bar-container",children:[e.jsx("div",{className:"chart-bar-wrapper",children:e.jsx("div",{className:"chart-bar",style:{height:`${c}%`},title:`${t.steps.toLocaleString()} steps`})}),e.jsx("span",{className:"chart-label",children:i})]},a)})})]}),e.jsxs("div",{className:"progress-badge",children:[e.jsx("span",{className:"badge-icon",children:"ğŸ†"}),e.jsxs("div",{className:"badge-content",children:[e.jsx("span",{className:"badge-number",children:o.totalActiveDays}),e.jsx("span",{className:"badge-text",children:"Total Active Days"})]})]}),e.jsx("div",{className:"progress-info",children:e.jsx("p",{children:"ğŸ’¡ Keep your streak going to unlock achievements!"})})]})})}export{T as default};
