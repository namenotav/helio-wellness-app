const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-1765888035845-smartFoodSearch.js","assets/chunk-1765888035988-usdaService.js","assets/chunk-1765888035988-restaurantService.js","assets/chunk-1765888035858-barcodeScannerService.js","assets/entry-1765888035645-index.js","assets/asset-1765888036385-index.css","assets/chunk-1765888035845-index.js"])))=>i.map(i=>d[i]);
import{_ as v,r as h,j as e,s as g}from"./entry-1765888035645-index.js";import{C as b}from"./chunk-1765888035845-index.js";import{a as y}from"./chunk-1765888035846-aiVisionService.js";import j from"./chunk-1765888035647-PaywallModal.js";/* empty css                                */class N{constructor(){this.isScanning=!1,this.overlayData=null}async startARMode(){try{this.isScanning=!0;const s=await b.getPhoto({quality:50,allowEditing:!1,resultType:"base64",source:"CAMERA",width:1024,height:1024}),t=await y.analyzeFoodImage(s.base64String);if(t.success){const a=t.analysis.foodName||t.analysis.food,i=await(await v(async()=>{const{default:o}=await import("./chunk-1765888035845-smartFoodSearch.js");return{default:o}},__vite__mapDeps([0,1,2,3,4,5,6]))).default.searchAllDatabases(a);return this.overlayData=this.createAROverlay(t.analysis,i),{success:!0,imageData:s.base64String,overlayData:this.overlayData,databaseMatches:i}}return{success:!1,error:t.error||"Analysis failed"}}catch(s){return{success:!1,error:s.message}}finally{this.isScanning=!1}}createAROverlay(s,t=[]){const{foodName:a,ingredients:n,detectedAllergens:i,safetyLevel:o}=s;let d,f,u,m,r;if(t&&t.length>0){const c=t[0];d=c.calories||0,f=c.protein||0,u=c.carbs||c.carbohydrates||0,m=c.fat||c.fats||0,r=c.source}else d=this.estimateCalories(a,n),f=u=m=0,r="Estimated";const l=this.calculatePortionSize(a,d);return{mainInfo:{foodName:a,calories:d,protein:f,carbs:u,fats:m,source:r,databaseMatch:t.length>0,position:"top-center",color:this.getARColor(o)},allergenZones:i.map((c,x)=>({allergen:c.name,position:this.calculateZonePosition(x,i.length),intensity:c.confidence==="high"?.8:.5,color:"#FF4444"})),portionGuide:{diameter:l.size,position:"center",label:l.label,color:"#44FF44",opacity:.3},nutritionPanel:{protein:this.estimateNutrient(n,"protein"),carbs:this.estimateNutrient(n,"carbs"),fat:this.estimateNutrient(n,"fat"),fiber:this.estimateNutrient(n,"fiber")},safetyBanner:{level:o,message:s.safetyMessage,position:"bottom",animated:o==="danger"}}}estimateCalories(s,t){const a={pizza:285,burger:350,salad:150,pasta:220,chicken:165,fish:140,rice:130,bread:265,apple:52,banana:89},n=s.toLowerCase();for(const[i,o]of Object.entries(a))if(n.includes(i))return o;return t.length*50+100}estimateNutrient(s,t){const n={protein:["chicken","fish","beef","egg","tofu","beans"],carbs:["bread","rice","pasta","potato","wheat","corn"],fat:["oil","butter","cheese","avocado","nuts"],fiber:["vegetables","fruit","beans","oats","whole grain"]}[t]||[],i=s.filter(o=>n.some(d=>o.toLowerCase().includes(d))).length;return i>0?"High":i>2?"Medium":"Low"}calculatePortionSize(s,t){return t<150?{size:"200px",label:"Recommended serving"}:t<300?{size:"150px",label:"Moderate portion"}:{size:"100px",label:"Small portion advised"}}calculateZonePosition(s,t){const a=s/t*2*Math.PI,n=30;return{x:50+n*Math.cos(a),y:50+n*Math.sin(a)}}getARColor(s){return{safe:"#44FF44",caution:"#FFA500",danger:"#FF4444",unknown:"#888888"}[s]||"#888888"}async scanRestaurantMenu(){const s=await this.startARMode();return s.success&&(s.overlayData.restaurantTips=["ðŸ“ Ask server about preparation methods","ðŸ”„ Request modifications for allergens","ðŸ‘¨â€ðŸ³ Speak directly with chef if needed"]),s}async enableLiveARStream(){return{success:!1,message:"Live AR streaming coming in v2.0"}}}const S=new N;function C({onClose:p}){const[s,t]=h.useState(!1),[a,n]=h.useState(null),[i,o]=h.useState(null),[d,f]=h.useState(!1),u=async()=>{if(!g.hasAccess("arScanner")){f(!0);return}const r=g.checkLimit("arScans");if(!r.allowed){alert(r.message),f(!0);return}t(!0);try{const l=await S.startARMode();if(!l.success)throw new Error(l.error||"AR scan failed");o(`data:image/jpeg;base64,${l.imageData}`),n({...l.overlayData,databaseMatches:l.databaseMatches||[]})}catch(l){alert("Failed to start AR scan: "+l.message)}t(!1)},m=()=>{o(null),n(null)};return e.jsxs("div",{className:"ar-overlay",children:[e.jsxs("div",{className:"ar-modal",children:[e.jsx("button",{className:"ar-close",onClick:p,children:"âœ•"}),e.jsx("h2",{className:"ar-title",children:"ðŸ“¸ Body Scanner"}),i?e.jsxs("div",{className:"ar-view",children:[e.jsxs("div",{className:"ar-camera-feed",children:[e.jsx("img",{src:i,alt:"Scanned food",className:"ar-image"}),a&&a.mainInfo&&e.jsx("div",{className:"ar-food-label",children:a.mainInfo.foodName})]}),a&&e.jsxs("div",{className:"ar-info-panel",children:[a.mainInfo&&a.mainInfo.databaseMatch&&e.jsxs("div",{style:{fontSize:"12px",color:"#0284c7",fontWeight:"bold",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:["âœ“ Verified from ",a.mainInfo.source]}),a.mainInfo&&e.jsxs("div",{className:"info-calories",children:["ðŸ”¥ ",a.mainInfo.calories," Calories",a.mainInfo.protein>0&&e.jsxs("span",{style:{fontSize:"13px",marginLeft:"10px",color:"#666"},children:["ðŸ’ª ",a.mainInfo.protein,"g | ðŸž ",a.mainInfo.carbs,"g | ðŸ¥‘ ",a.mainInfo.fats,"g"]})]}),a.nutritionPanel&&e.jsxs("div",{className:"info-nutrition-grid",children:[e.jsxs("div",{className:"nutrition-card",children:[e.jsx("div",{className:"nutrition-icon",children:"ðŸ’ª"}),e.jsx("div",{className:"nutrition-value",children:a.nutritionPanel.protein}),e.jsx("div",{className:"nutrition-label",children:"Protein"})]}),e.jsxs("div",{className:"nutrition-card",children:[e.jsx("div",{className:"nutrition-icon",children:"ðŸž"}),e.jsx("div",{className:"nutrition-value",children:a.nutritionPanel.carbs}),e.jsx("div",{className:"nutrition-label",children:"Carbs"})]}),e.jsxs("div",{className:"nutrition-card",children:[e.jsx("div",{className:"nutrition-icon",children:"ðŸ¥‘"}),e.jsx("div",{className:"nutrition-value",children:a.nutritionPanel.fat}),e.jsx("div",{className:"nutrition-label",children:"Fat"})]})]}),a.databaseMatches&&a.databaseMatches.length>1&&e.jsxs("details",{style:{marginTop:"10px",fontSize:"13px",background:"#f0f9ff",padding:"10px",borderRadius:"8px"},children:[e.jsxs("summary",{style:{cursor:"pointer",fontWeight:"bold",color:"#0284c7"},children:["ðŸ” ",a.databaseMatches.length," database matches available"]}),e.jsx("div",{style:{maxHeight:"120px",overflowY:"auto",marginTop:"8px"},children:a.databaseMatches.slice(0,5).map((r,l)=>e.jsxs("div",{style:{background:"white",padding:"6px",marginBottom:"4px",borderRadius:"6px",fontSize:"11px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("span",{children:r.sourceBadge}),e.jsx("strong",{children:r.name})]}),e.jsxs("div",{style:{color:"#666",fontSize:"10px"},children:[r.calories," cal | P: ",r.protein,"g | C: ",r.carbs||r.carbohydrates,"g"]})]},l))})]}),a.safetyBanner&&e.jsx("div",{className:`info-safety-alert ${a.safetyBanner.level}`,children:a.safetyBanner.message})]}),e.jsxs("div",{className:"ar-actions",children:[e.jsx("button",{className:"ar-action-btn reset",onClick:m,children:"ðŸ”„ Scan Again"}),e.jsx("button",{className:"ar-action-btn close",onClick:p,children:"âœ“ Done"})]})]}):e.jsxs("div",{className:"ar-start",children:[e.jsx("div",{className:"ar-icon",children:"ðŸ¥—"}),e.jsx("h3",{children:"Scan Any Food"}),e.jsx("p",{children:"Point your camera at food to see instant AR nutrition overlay"}),e.jsx("button",{className:"ar-scan-btn",onClick:u,disabled:s,children:s?"â³ Scanning...":"ðŸ“· Start AR Scan"})]}),e.jsxs("div",{className:"ar-features",children:[e.jsxs("div",{className:"feature-badge",children:[e.jsx("span",{className:"feature-icon",children:"ðŸŽ¯"}),e.jsx("span",{className:"feature-text",children:"Instant Calorie Detection"})]}),e.jsxs("div",{className:"feature-badge",children:[e.jsx("span",{className:"feature-icon",children:"âš ï¸"}),e.jsx("span",{className:"feature-text",children:"Allergen Zones Highlighted"})]}),e.jsxs("div",{className:"feature-badge",children:[e.jsx("span",{className:"feature-icon",children:"ðŸ½ï¸"}),e.jsx("span",{className:"feature-text",children:"Smart Portion Guide"})]})]})]}),d&&e.jsx(j,{isOpen:d,onClose:()=>f(!1),featureName:"AR Scanner",message:g.getUpgradeMessage("arScanner"),currentPlan:g.getCurrentPlan()})]})}export{C as default};
