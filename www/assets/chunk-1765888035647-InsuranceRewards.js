import{a as g,r as h,j as e}from"./entry-1765888035645-index.js";import{healthAvatarService as v}from"./chunk-1765888035648-healthAvatarService.js";class S{constructor(){this.partnersDB=[{id:"bupa",name:"Bupa Health Insurance",maxDiscount:40,currency:"Â£",basePremium:150,requirements:{minHealthScore:70,minMonthlySteps:2e5,minWorkouts:12,regularCheckIns:!0}},{id:"vitality",name:"Vitality Health",maxDiscount:35,currency:"Â£",basePremium:180,requirements:{minHealthScore:65,minMonthlySteps:15e4,minWorkouts:10,foodLogging:!0}},{id:"axa",name:"AXA Health",maxDiscount:30,currency:"Â£",basePremium:140,requirements:{minHealthScore:60,minMonthlySteps:12e4,minWorkouts:8}},{id:"aviva",name:"Aviva Health",maxDiscount:25,currency:"Â£",basePremium:130,requirements:{minHealthScore:55,minMonthlySteps:1e5,minWorkouts:6}}]}async calculateDiscount(s){const a=g.getCurrentUser();if(!a)return{eligible:!1};const t=this.partnersDB.find(y=>y.id===s);if(!t)return{eligible:!1};const i=(await v.getAvatarState()).current.score,l=this.calculateMonthlySteps(a.stats),c=i>=t.requirements.minHealthScore,m=l>=t.requirements.minMonthlySteps,u=t.requirements.regularCheckIns?this.hasRegularCheckIns(a):!0,n=t.requirements.foodLogging?this.hasFoodLogging(a):!0,o=c&&m&&u&&n;let d=0;return o&&(d=this.calculateDiscountPercent(i,l,t)),{eligible:o,discountPercent:d,partner:t.name,monthlySavings:this.estimateSavings(d),yearlySavings:this.estimateSavings(d)*12,requirements:{healthScore:{current:i,required:t.requirements.minHealthScore,met:c},monthlySteps:{current:l,required:t.requirements.minMonthlySteps,met:m},checkIns:u,foodLogging:n}}}calculateMonthlySteps(s){const a=JSON.parse(localStorage.getItem("stepHistory")||"{}"),t=Object.keys(a),r=Date.now()-720*60*60*1e3;return t.filter(c=>new Date(c).getTime()>=r).reduce((c,m)=>c+(a[m]||0),0)}hasRegularCheckIns(s){return new Date(s.profile?.lastActive||Date.now()),JSON.parse(localStorage.getItem("loginHistory")||"[]").filter(r=>{const i=new Date(r);return Date.now()-i.getTime()<=720*60*60*1e3}).length>=20}hasFoodLogging(s){const a=JSON.parse(localStorage.getItem("foodLog")||"[]"),t=Date.now()-720*60*60*1e3;return a.filter(i=>new Date(i.timestamp||i.date).getTime()>=t).length>=60}calculateDiscountPercent(s,a,t){const{maxDiscount:r,requirements:i}=t;let l=r*.5;const c=Math.min((s-i.minHealthScore)/100*r*.3,r*.3),m=Math.min((a-i.minMonthlySteps)/i.minMonthlySteps*r*.2,r*.2);return l=Math.min(l+c+m,r),Math.round(l)}estimateSavings(s){return Math.round(500*s/100)}getAvailablePartners(){return this.partnersDB}async generateVerificationReport(){const s=g.getCurrentUser();if(!s)return null;const a=await v.getAvatarState();return{userId:s.id,userName:s.name,reportDate:new Date().toISOString(),healthMetrics:{currentHealthScore:a.current.score,totalDays:s.stats.totalDays,totalSteps:s.stats.totalSteps,avgDailySteps:s.stats.totalDays>0?Math.round(s.stats.totalSteps/s.stats.totalDays):0},activityLog:{last30DaysSteps:this.calculateMonthlySteps(s.stats),foodLogsCount:(s.profile.foodLog||[]).length,meditationSessions:s.stats.totalSessions||0,lastActive:s.profile.lastActive},verified:!0,signature:this.generateVerificationSignature(s)}}generateVerificationSignature(s){const a=`${s.id}-${Date.now()}`;return btoa(a)}async applyForDiscount(s){const a=await this.calculateDiscount(s);if(!a.eligible)return{success:!1,message:"Not eligible yet. Keep improving your health!",requirements:a.requirements};const t=await this.generateVerificationReport();return{success:!0,applicationId:"APP-"+Date.now(),discountPercent:a.discountPercent,monthlySavings:a.monthlySavings,yearlySavings:a.yearlySavings,report:t,message:`Application submitted! Estimated savings: $${a.monthlySavings}/month`}}}const x=new S;function D({onClose:p}){const[s,a]=h.useState(null),[t,r]=h.useState(null),[i,l]=h.useState(!1),c=[{id:"bupa",name:"Bupa Health Insurance",maxDiscount:40,color:"#44FF44",logo:"ğŸ¥"},{id:"vitality",name:"Vitality Health",maxDiscount:35,color:"#00FFFF",logo:"ğŸ’š"},{id:"axa",name:"AXA Health",maxDiscount:30,color:"#FF00FF",logo:"ğŸ›¡ï¸"},{id:"aviva",name:"Aviva Health",maxDiscount:25,color:"#FFD700",logo:"â­"}];h.useEffect(()=>{s&&m(s)},[s]);const m=async n=>{const o=await x.calculateDiscount(n);r(o)},u=async()=>{if(s){l(!0);try{const n=await x.applyForDiscount(s);alert(`âœ… Application Submitted!

Application ID: ${n.applicationId}

Estimated Savings:
$${n.estimatedSavings.monthly}/month
$${n.estimatedSavings.yearly}/year

You'll receive an email with next steps within 2-3 business days.`)}catch(n){alert("Failed to apply: "+n.message)}l(!1)}};return e.jsx("div",{className:"insurance-overlay",children:e.jsxs("div",{className:"insurance-modal",children:[e.jsx("button",{className:"insurance-close",onClick:p,children:"âœ•"}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(255, 193, 7, 0.25) 0%, rgba(255, 152, 0, 0.25) 100%)",padding:"16px",borderRadius:"12px",marginBottom:"20px",border:"2px solid rgba(255, 193, 7, 0.6)",boxShadow:"0 4px 12px rgba(255, 193, 7, 0.3)"},children:[e.jsx("div",{style:{fontSize:"16px",color:"#FFC107",fontWeight:"700",marginBottom:"6px",textAlign:"center"},children:"âš ï¸ DEMO FEATURE - COMING SOON âš ï¸"}),e.jsx("div",{style:{fontSize:"13px",color:"rgba(255, 255, 255, 0.9)",lineHeight:"1.5",textAlign:"center"},children:"Insurance partnerships are pending regulatory approval. All calculations shown are estimates for demonstration purposes only."})]}),e.jsx("h2",{className:"insurance-title",children:"ğŸ’° Insurance Rewards (Preview)"}),e.jsx("p",{className:"insurance-subtitle",children:"Potential discounts up to 40% with partner approval"}),e.jsx("div",{className:"partner-grid",children:c.map(n=>e.jsxs("div",{className:`partner-card ${s===n.id?"selected":""}`,onClick:()=>a(n.id),style:{borderColor:s===n.id?n.color:"transparent"},children:[e.jsx("div",{className:"partner-name",children:n.name}),e.jsxs("div",{className:"partner-discount",children:["Up to ",n.maxDiscount,"% OFF"]})]},n.id))}),t&&e.jsxs("div",{className:"discount-results",children:[e.jsxs("div",{className:`eligibility-status ${t.eligible?"eligible":"not-eligible"}`,children:[e.jsx("span",{className:"status-icon",children:t.eligible?"âœ“":"âœ—"}),e.jsx("span",{className:"status-text",children:t.eligible?"You Qualify!":"Not Eligible Yet"})]}),t.eligible?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"savings-display",children:[e.jsxs("div",{className:"savings-main",children:[e.jsxs("span",{className:"savings-percent",children:[t.discountPercent,"%"]}),e.jsx("span",{className:"savings-label",children:"Discount"})]}),e.jsxs("div",{className:"savings-breakdown",children:[e.jsxs("div",{className:"savings-item",children:[e.jsxs("span",{className:"savings-amount",children:["$",t.monthlySavings]}),e.jsx("span",{className:"savings-period",children:"per month"})]}),e.jsxs("div",{className:"savings-item",children:[e.jsxs("span",{className:"savings-amount",children:["$",t.yearlySavings]}),e.jsx("span",{className:"savings-period",children:"per year"})]})]})]}),e.jsx("button",{className:"apply-button",onClick:u,disabled:i,children:i?"â³ Applying...":"âœ“ Apply for Discount"})]}):e.jsxs("div",{className:"requirements-list",children:[e.jsx("h3",{children:"Requirements to Qualify:"}),Object.entries(t.requirements).map(([n,o])=>e.jsxs("div",{className:`requirement-item ${o.met?"met":"not-met"}`,children:[e.jsx("span",{className:"req-icon",children:o.met?"âœ“":"âœ—"}),e.jsxs("div",{className:"req-info",children:[e.jsx("div",{className:"req-name",children:n.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"req-progress",children:[o.current," / ",o.required," ",n.includes("Score")?"points":"steps"]})]})]},n))]})]}),e.jsxs("div",{className:"how-it-works",children:[e.jsx("h3",{children:"ğŸ’¡ How It Works"}),e.jsxs("div",{className:"steps-grid",children:[e.jsxs("div",{className:"step-item",children:[e.jsx("span",{className:"step-number",children:"1"}),e.jsx("p",{children:"We track your health metrics securely"})]}),e.jsxs("div",{className:"step-item",children:[e.jsx("span",{className:"step-number",children:"2"}),e.jsx("p",{children:"Insurance partners verify your data"})]}),e.jsxs("div",{className:"step-item",children:[e.jsx("span",{className:"step-number",children:"3"}),e.jsx("p",{children:"Get instant premium discounts"})]}),e.jsxs("div",{className:"step-item",children:[e.jsx("span",{className:"step-number",children:"4"}),e.jsx("p",{children:"Save $2,400-$4,800 per year"})]})]})]}),e.jsxs("div",{className:"trust-section",children:[e.jsxs("div",{className:"trust-badge",children:[e.jsx("span",{className:"trust-icon",children:"ğŸ”’"}),e.jsx("span",{className:"trust-text",children:"HIPAA Compliant"})]}),e.jsxs("div",{className:"trust-badge",children:[e.jsx("span",{className:"trust-icon",children:"âœ“"}),e.jsx("span",{className:"trust-text",children:"Verified Partners"})]}),e.jsxs("div",{className:"trust-badge",children:[e.jsx("span",{className:"trust-icon",children:"ğŸ›¡ï¸"}),e.jsx("span",{className:"trust-text",children:"Data Encrypted"})]})]})]})})}export{D as default};
