import{h as u,f as a,a as n}from"./entry-1765889059086-index.js";class y{constructor(){this.workoutHistory=[]}async initialize(){await this.loadWorkoutHistory()}async logWorkout(t){try{this.workoutHistory.length===0&&await this.loadWorkoutHistory();const o={...t,id:"workout_"+Date.now(),timestamp:Date.now(),date:new Date().toISOString().split("T")[0]};return this.workoutHistory.push(o),await this.saveWorkoutHistory(),await u.trackWorkout({duration:t.duration||30,type:t.type||t.activity,intensity:this.calculateIntensity(t),completed:!0,energyBefore:5,energyAfter:7,mood:"energetic",location:t.location||"gym"}),window.updateDailyChallenge&&window.updateDailyChallenge("workout_15",t.duration||0),{success:!0,workout:o}}catch(o){return{success:!1,error:o.message}}}getWorkoutHistory(t=30){const o=Date.now()-t*24*60*60*1e3;return this.workoutHistory.filter(e=>e.timestamp>o)}getTodayWorkouts(){const t=new Date().toISOString().split("T")[0];return this.workoutHistory.filter(o=>o.date===t)}async deleteWorkout(t){try{return this.workoutHistory=this.workoutHistory.filter(o=>o.id!==t),await this.saveWorkoutHistory(),{success:!0}}catch(o){return{success:!1,error:o.message}}}async saveWorkoutHistory(){try{const t=Date.now()-7776e6,o=this.workoutHistory.filter(e=>e.timestamp>t);this.workoutHistory=o,localStorage.setItem("workoutHistory",JSON.stringify(o)),await a.save("workoutHistory",o,n.getCurrentUser()?.uid)}catch{}}async loadWorkoutHistory(){try{const t=await a.get("workoutHistory",n.getCurrentUser()?.uid);if(t&&Array.isArray(t))this.workoutHistory=t;else{const o=localStorage.getItem("workoutHistory");o?this.workoutHistory=JSON.parse(o):this.workoutHistory=[]}}catch{this.workoutHistory=[]}}calculateIntensity(t){const o=["hiit","running","sprinting","crossfit","boxing"],e=["cycling","swimming","weights","strength"],s=["yoga","stretching","walking","pilates"],r=(t.type||t.activity||"").toLowerCase();return o.some(i=>r.includes(i))?"high":e.some(i=>r.includes(i))?"moderate":s.some(i=>r.includes(i))?"low":"moderate"}getWorkoutStats(){const t=this.getWorkoutHistory(30),o=this.getWorkoutHistory(7),e=this.getTodayWorkouts();return{total:this.workoutHistory.length,last30Days:t.length,last7Days:o.length,today:e.length,totalDuration:t.reduce((s,r)=>s+(r.duration||0),0),totalCalories:t.reduce((s,r)=>s+(r.calories||0),0)}}}const h=new y;export{h as default};
