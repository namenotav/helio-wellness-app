import{r as c,j as a}from"./entry-1765889059086-index.js";import{healthAvatarService as i}from"./chunk-1765889059089-healthAvatarService.js";function y({onClose:d}){const[r,m]=c.useState(null),[e,n]=c.useState("current"),[u,x]=c.useState(!0);c.useEffect(()=>{o();const t=setInterval(o,1e4);return()=>clearInterval(t)},[]);const o=async()=>{const t=await i.getAvatarState(!0);m(t),x(!1)},s=(()=>{if(!r)return null;switch(e){case"current":return r.current;case"1year":return{...r.future1Year,visuals:i.getAvatarVisuals(r.future1Year.score)};case"5years":return{...r.future5Years,visuals:i.getAvatarVisuals(r.future5Years.score)};case"10years":return{...r.future10Years,visuals:i.getAvatarVisuals(r.future10Years.score)};default:return r.current}})();return u?a.jsx("div",{className:"avatar-overlay",children:a.jsx("div",{className:"avatar-modal",children:a.jsx("h2",{children:"â³ Loading your health avatar..."})})}):a.jsx("div",{className:"avatar-overlay",children:a.jsxs("div",{className:"avatar-modal",children:[a.jsx("button",{className:"avatar-close",onClick:d,children:"âœ•"}),a.jsx("h2",{className:"avatar-title",children:"ðŸ§¬ Your Health Avatar"}),a.jsxs("div",{className:"avatar-timeline",children:[a.jsx("button",{className:`timeline-btn ${e==="current"?"active":""}`,onClick:()=>n("current"),children:"NOW"}),a.jsx("button",{className:`timeline-btn ${e==="1year"?"active":""}`,onClick:()=>n("1year"),children:"+1 YEAR"}),a.jsx("button",{className:`timeline-btn ${e==="5years"?"active":""}`,onClick:()=>n("5years"),children:"+5 YEARS"}),a.jsx("button",{className:`timeline-btn ${e==="10years"?"active":""}`,onClick:()=>n("10years"),children:"+10 YEARS"})]}),s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"avatar-display","data-glow":s.visuals?.glowEffect||"none",children:[a.jsx("div",{className:"avatar-character",children:a.jsx("div",{className:"avatar-emoji",style:{filter:s.visuals?.eyeBrightness==="dull"?"grayscale(0.5)":"none",opacity:s.visuals?.energyLevel==="low"?.7:1},children:s.visuals?.overallMood||"ðŸ˜Š"})}),a.jsxs("div",{className:"health-score-circle",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#333",strokeWidth:"8"}),a.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:s.score>=70?"#44FF44":s.score>=50?"#FFA500":"#FF4444",strokeWidth:"8",strokeDasharray:`${2*Math.PI*45*(s.score/100)} ${2*Math.PI*45}`,transform:"rotate(-90 50 50)"})]}),a.jsxs("div",{className:"score-text",children:[a.jsx("span",{className:"score-number",children:s.score}),a.jsx("span",{className:"score-label",children:"Health Score"})]})]})]}),e!=="current"&&a.jsxs("div",{className:"age-warning",children:[a.jsxs("h3",{children:["âš ï¸ You'll look ",s.ageAppearance," years old"]}),a.jsxs("p",{children:["Actual age: ",r.current.age+parseInt(e.replace(/\D/g,""))]})]}),e==="current"&&s.dataBreakdown&&a.jsxs("div",{className:"data-sources",children:[a.jsx("h3",{children:"ðŸ“Š Your Real Health Data"}),a.jsxs("div",{className:"data-grid",children:[a.jsxs("div",{className:"data-source",children:[a.jsx("span",{className:"data-icon",children:"ðŸ‘Ÿ"}),a.jsxs("span",{className:"data-label",children:["Monthly Steps (",s.dataBreakdown.monthName,")"]}),a.jsx("span",{className:"data-value",children:(s.dataBreakdown.totalMonthlySteps||0).toLocaleString()}),a.jsxs("span",{className:"data-subtext",children:[s.dataBreakdown.stepsDays," days this month"]})]}),a.jsxs("div",{className:"data-source",children:[a.jsx("span",{className:"data-icon",children:"ðŸ½ï¸"}),a.jsxs("span",{className:"data-label",children:["Food Scans (",s.dataBreakdown.monthName,")"]}),a.jsx("span",{className:"data-value",children:s.dataBreakdown.foodLogsCount}),a.jsx("span",{className:"data-subtext",children:"This month"})]}),a.jsxs("div",{className:"data-source",children:[a.jsx("span",{className:"data-icon",children:"ðŸ’ª"}),a.jsxs("span",{className:"data-label",children:["Workouts (",s.dataBreakdown.monthName,")"]}),a.jsx("span",{className:"data-value",children:s.dataBreakdown.workoutsCount}),a.jsx("span",{className:"data-subtext",children:"This month"})]}),a.jsxs("div",{className:"data-source",children:[a.jsx("span",{className:"data-icon",children:"ðŸ§¬"}),a.jsx("span",{className:"data-label",children:"DNA Analysis"}),a.jsx("span",{className:"data-value",children:s.dataBreakdown.hasDNAAnalysis?"âœ…":"âŒ"}),a.jsx("span",{className:"data-subtext",children:s.dataBreakdown.hasDNAAnalysis?"Uploaded":"Not uploaded"})]}),a.jsxs("div",{className:"data-source",children:[a.jsx("span",{className:"data-icon",children:"ðŸ˜´"}),a.jsxs("span",{className:"data-label",children:["Sleep Logs (",s.dataBreakdown.monthName,")"]}),a.jsx("span",{className:"data-value",children:s.dataBreakdown.sleepLogsCount}),a.jsx("span",{className:"data-subtext",children:"This month"})]})]}),a.jsxs("p",{className:"data-note",children:["ðŸ’¡ Your health score is calculated from ",a.jsx("strong",{children:"real activity data"})," - not estimates!"]})]}),e==="current"&&s.dataBreakdown.stepHistory&&s.dataBreakdown.stepHistory.length>0&&a.jsxs("div",{className:"step-history-section",children:[a.jsxs("h3",{children:["ðŸ“… ",s.dataBreakdown.monthName," ",s.dataBreakdown.currentYear," Step History"]}),a.jsx("div",{className:"step-history-list",children:s.dataBreakdown.stepHistory.slice().sort((t,l)=>(l.date||"").localeCompare(t.date||"")).map((t,l)=>{const v=t?.steps||0,h=t?.date||"Unknown";return a.jsxs("div",{className:"step-history-item",children:[a.jsx("span",{className:"history-date",children:h}),a.jsxs("span",{className:"history-steps",children:[v.toLocaleString()," steps"]})]},h+l)})}),a.jsxs("div",{className:"history-summary",children:[a.jsxs("span",{children:["ðŸ“Š Total: ",s.dataBreakdown.totalMonthlySteps.toLocaleString()," steps"]}),a.jsxs("span",{children:["ðŸ“ˆ Average: ",s.dataBreakdown.avgDailySteps.toLocaleString()," steps/day"]})]})]}),a.jsxs("div",{className:"avatar-stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-icon",children:"ðŸ’ª"}),a.jsx("span",{className:"stat-label",children:"Muscle"}),a.jsx("span",{className:"stat-value",children:s.visuals?.muscleTone})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-icon",children:"âš¡"}),a.jsx("span",{className:"stat-label",children:"Energy"}),a.jsx("span",{className:"stat-value",children:s.visuals?.energyLevel})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-icon",children:"âœ¨"}),a.jsx("span",{className:"stat-label",children:"Glow"}),a.jsx("span",{className:"stat-value",children:s.visuals?.glowEffect})]})]}),e!=="current"&&s.warnings&&s.warnings.length>0&&a.jsxs("div",{className:"avatar-warnings",children:[a.jsx("h3",{children:"âš ï¸ Health Warnings"}),a.jsx("ul",{children:s.warnings.map((t,l)=>a.jsx("li",{children:t},l))})]}),e!=="current"&&s.improvements&&s.improvements.length>0&&a.jsxs("div",{className:"avatar-improvements",children:[a.jsx("h3",{children:"ðŸ’¡ How to Improve"}),a.jsx("ul",{children:s.improvements.map((t,l)=>a.jsx("li",{children:t},l))})]}),e!=="current"&&s.score<r.current.score&&a.jsxs("div",{className:"avatar-cta",children:[a.jsx("h3",{children:"ðŸš€ Change Your Future NOW!"}),a.jsx("p",{children:"Small changes today = huge impact on your future health"}),a.jsx("button",{className:"cta-button",onClick:d,children:"Start Improving Today"})]})]})]})})}export{y as default};
