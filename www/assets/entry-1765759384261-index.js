const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunk-1765759384263-FoodScanner.js","assets/chunk-1765759384484-aiVisionService.js","assets/chunk-1765759384482-index.js","assets/asset-1765759385012-FoodScanner.css","assets/asset-1765759385013-PaywallModal.css","assets/chunk-1765759384263-ProfileSetup.js","assets/chunk-1765759384264-healthAvatarService.js","assets/asset-1765759384970-ProfileSetup.css","assets/chunk-1765759384263-HealthAvatar.js","assets/asset-1765759385037-HealthAvatar.css","assets/chunk-1765759384263-ARScanner.js","assets/chunk-1765759384264-PaywallModal.js","assets/asset-1765759384970-ARScanner.css","assets/chunk-1765759384263-EmergencyPanel.js","assets/chunk-1765759384264-emergencyService.js","assets/asset-1765759384971-EmergencyPanel.css","assets/chunk-1765759384263-InsuranceRewards.js","assets/asset-1765759384971-InsuranceRewards.css","assets/chunk-1765759384263-DNAUpload.js","assets/asset-1765759385013-DNAUpload.css","assets/chunk-1765759384263-SocialBattles.js","assets/chunk-1765759384264-socialBattlesService.js","assets/asset-1765759384979-SocialBattles.css","assets/chunk-1765759384263-MealAutomation.js","assets/asset-1765759384971-MealAutomation.css","assets/chunk-1765759384263-LegalModal.js","assets/asset-1765759384971-LegalModal.css","assets/chunk-1765759384264-StripePayment.js","assets/asset-1765759384971-StripePayment.css","assets/chunk-1765759384264-AppleHealthSync.js","assets/asset-1765759384971-AppleHealthSync.css","assets/chunk-1765759384264-WearableSync.js","assets/asset-1765759384971-WearableSync.css","assets/chunk-1765759384264-Onboarding.js","assets/asset-1765759384975-Onboarding.css","assets/chunk-1765759384264-DevUnlock.js","assets/asset-1765759384976-DevUnlock.css","assets/chunk-1765759384264-DataRecovery.js","assets/asset-1765759384976-DataRecovery.css","assets/chunk-1765759384264-BarcodeScanner.js","assets/chunk-1765759384500-barcodeScannerService.js","assets/asset-1765759384977-BarcodeScanner.css","assets/chunk-1765759384264-RepCounter.js","assets/asset-1765759384977-RepCounter.css","assets/chunk-1765759384264-GlobalFallAlert.js","assets/chunk-1765759384264-BrainInsightsDashboard.js","assets/asset-1765759384977-BrainInsightsDashboard.css","assets/chunk-1765759384264-TodayOverview.js","assets/asset-1765759384977-TodayOverview.css","assets/chunk-1765759384264-HomeActionButton.js","assets/asset-1765759384979-HomeActionButton.css","assets/chunk-1765759384264-StatsModal.js","assets/asset-1765759384979-StatsModal.css","assets/chunk-1765759384264-PremiumModal.js","assets/asset-1765759384979-PremiumModal.css","assets/chunk-1765759384264-BattlesModal.js","assets/asset-1765759384979-BattlesModal.css","assets/chunk-1765759384264-FoodModal.js","assets/asset-1765759385011-FoodModal.css","assets/chunk-1765759384264-DNAModal.js","assets/asset-1765759385012-DNAModal.css","assets/chunk-1765759384264-WorkoutsModalNew.js","assets/asset-1765759385014-WorkoutsModalNew.css","assets/chunk-1765759384264-HealthModal.js","assets/asset-1765759385015-HealthModal.css","assets/chunk-1765759384264-GoalsModal.js","assets/asset-1765759385037-GoalsModal.css","assets/chunk-1765759384264-ProgressModal.js","assets/asset-1765759385038-ProgressModal.css","assets/chunk-1765759384264-StreakCounter.js","assets/asset-1765759385038-StreakCounter.css","assets/chunk-1765759384264-LevelProgressBar.js","assets/asset-1765759385038-LevelProgressBar.css","assets/chunk-1765759384264-DailyChallenges.js","assets/asset-1765759385038-DailyChallenges.css","assets/chunk-1765759384264-AchievementUnlock.js","assets/asset-1765759385038-AchievementUnlock.css","assets/chunk-1765759384264-VoiceTabRedesign.js","assets/chunk-1765759384724-PointsPopup.js","assets/asset-1765759385038-PointsPopup.css","assets/asset-1765759385038-VoiceTabRedesign.css","assets/chunk-1765759384264-ZenTabRedesign.js","assets/asset-1765759385038-ZenTabRedesign.css","assets/chunk-1765759384264-ScanTabRedesign.js","assets/asset-1765759385039-ScanTabRedesign.css","assets/chunk-1765759384264-ProfileTabRedesign.js","assets/asset-1765759385040-ProfileTabRedesign.css","assets/chunk-1765759384264-AIAssistantModal.js","assets/asset-1765759385040-AIAssistantModal.css","assets/chunk-1765759384264-HealthToolsModal.js","assets/asset-1765759385040-HealthToolsModal.css","assets/chunk-1765759384264-DataManagementModal.js","assets/asset-1765759385040-DataManagementModal.css","assets/chunk-1765759384264-SocialFeaturesModal.js","assets/asset-1765759385040-SocialFeaturesModal.css","assets/chunk-1765759384264-SettingsHubModal.js","assets/asset-1765759385040-SettingsHubModal.css","assets/chunk-1765759384264-QuickLogModal.js","assets/asset-1765759385040-QuickLogModal.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $k(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function lY(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var e=i.default;if(typeof e=="function"){var t=function n(){var r=!1;try{r=this instanceof n}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var r=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return i[n]}})}),t}var R_={exports:{}},hg={};var yT;function sP(){if(yT)return hg;yT=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,s){var l=null;if(s!==void 0&&(l=""+s),r.key!==void 0&&(l=""+r.key),"key"in r){s={};for(var u in r)u!=="key"&&(s[u]=r[u])}else s=r;return r=s.ref,{$$typeof:i,type:n,key:l,ref:r!==void 0?r:null,props:s}}return hg.Fragment=e,hg.jsx=t,hg.jsxs=t,hg}var vT;function aP(){return vT||(vT=1,R_.exports=sP()),R_.exports}var b=aP(),L_={exports:{}},fi={};var _T;function oP(){if(_T)return fi;_T=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),w=Symbol.iterator;function A(Ne){return Ne===null||typeof Ne!="object"?null:(Ne=w&&Ne[w]||Ne["@@iterator"],typeof Ne=="function"?Ne:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,W={};function q(Ne,se,Ee){this.props=Ne,this.context=se,this.refs=W,this.updater=Ee||B}q.prototype.isReactComponent={},q.prototype.setState=function(Ne,se){if(typeof Ne!="object"&&typeof Ne!="function"&&Ne!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ne,se,"setState")},q.prototype.forceUpdate=function(Ne){this.updater.enqueueForceUpdate(this,Ne,"forceUpdate")};function ge(){}ge.prototype=q.prototype;function he(Ne,se,Ee){this.props=Ne,this.context=se,this.refs=W,this.updater=Ee||B}var me=he.prototype=new ge;me.constructor=he,$(me,q.prototype),me.isPureReactComponent=!0;var Ce=Array.isArray;function Ve(){}var pe={H:null,A:null,T:null,S:null},ee=Object.prototype.hasOwnProperty;function J(Ne,se,Ee){var De=Ee.ref;return{$$typeof:i,type:Ne,key:se,ref:De!==void 0?De:null,props:Ee}}function ye(Ne,se){return J(Ne.type,se,Ne.props)}function X(Ne){return typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===i}function ae(Ne){var se={"=":"=0",":":"=2"};return"$"+Ne.replace(/[=:]/g,function(Ee){return se[Ee]})}var le=/\/+/g;function ze(Ne,se){return typeof Ne=="object"&&Ne!==null&&Ne.key!=null?ae(""+Ne.key):se.toString(36)}function nt(Ne){switch(Ne.status){case"fulfilled":return Ne.value;case"rejected":throw Ne.reason;default:switch(typeof Ne.status=="string"?Ne.then(Ve,Ve):(Ne.status="pending",Ne.then(function(se){Ne.status==="pending"&&(Ne.status="fulfilled",Ne.value=se)},function(se){Ne.status==="pending"&&(Ne.status="rejected",Ne.reason=se)})),Ne.status){case"fulfilled":return Ne.value;case"rejected":throw Ne.reason}}throw Ne}function je(Ne,se,Ee,De,Be){var $e=typeof Ne;($e==="undefined"||$e==="boolean")&&(Ne=null);var Ye=!1;if(Ne===null)Ye=!0;else switch($e){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(Ne.$$typeof){case i:case e:Ye=!0;break;case x:return Ye=Ne._init,je(Ye(Ne._payload),se,Ee,De,Be)}}if(Ye)return Be=Be(Ne),Ye=De===""?"."+ze(Ne,0):De,Ce(Be)?(Ee="",Ye!=null&&(Ee=Ye.replace(le,"$&/")+"/"),je(Be,se,Ee,"",function(Tt){return Tt})):Be!=null&&(X(Be)&&(Be=ye(Be,Ee+(Be.key==null||Ne&&Ne.key===Be.key?"":(""+Be.key).replace(le,"$&/")+"/")+Ye)),se.push(Be)),1;Ye=0;var ct=De===""?".":De+":";if(Ce(Ne))for(var ut=0;ut<Ne.length;ut++)De=Ne[ut],$e=ct+ze(De,ut),Ye+=je(De,se,Ee,$e,Be);else if(ut=A(Ne),typeof ut=="function")for(Ne=ut.call(Ne),ut=0;!(De=Ne.next()).done;)De=De.value,$e=ct+ze(De,ut++),Ye+=je(De,se,Ee,$e,Be);else if($e==="object"){if(typeof Ne.then=="function")return je(nt(Ne),se,Ee,De,Be);throw se=String(Ne),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(Ne).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function Je(Ne,se,Ee){if(Ne==null)return Ne;var De=[],Be=0;return je(Ne,De,"","",function($e){return se.call(Ee,$e,Be++)}),De}function qe(Ne){if(Ne._status===-1){var se=Ne._result;se=se(),se.then(function(Ee){(Ne._status===0||Ne._status===-1)&&(Ne._status=1,Ne._result=Ee)},function(Ee){(Ne._status===0||Ne._status===-1)&&(Ne._status=2,Ne._result=Ee)}),Ne._status===-1&&(Ne._status=0,Ne._result=se)}if(Ne._status===1)return Ne._result.default;throw Ne._result}var ot=typeof reportError=="function"?reportError:function(Ne){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ne=="object"&&Ne!==null&&typeof Ne.message=="string"?String(Ne.message):String(Ne),error:Ne});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ne);return}console.error(Ne)},St={map:Je,forEach:function(Ne,se,Ee){Je(Ne,function(){se.apply(this,arguments)},Ee)},count:function(Ne){var se=0;return Je(Ne,function(){se++}),se},toArray:function(Ne){return Je(Ne,function(se){return se})||[]},only:function(Ne){if(!X(Ne))throw Error("React.Children.only expected to receive a single React element child.");return Ne}};return fi.Activity=g,fi.Children=St,fi.Component=q,fi.Fragment=t,fi.Profiler=r,fi.PureComponent=he,fi.StrictMode=n,fi.Suspense=h,fi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=pe,fi.__COMPILER_RUNTIME={__proto__:null,c:function(Ne){return pe.H.useMemoCache(Ne)}},fi.cache=function(Ne){return function(){return Ne.apply(null,arguments)}},fi.cacheSignal=function(){return null},fi.cloneElement=function(Ne,se,Ee){if(Ne==null)throw Error("The argument must be a React element, but you passed "+Ne+".");var De=$({},Ne.props),Be=Ne.key;if(se!=null)for($e in se.key!==void 0&&(Be=""+se.key),se)!ee.call(se,$e)||$e==="key"||$e==="__self"||$e==="__source"||$e==="ref"&&se.ref===void 0||(De[$e]=se[$e]);var $e=arguments.length-2;if($e===1)De.children=Ee;else if(1<$e){for(var Ye=Array($e),ct=0;ct<$e;ct++)Ye[ct]=arguments[ct+2];De.children=Ye}return J(Ne.type,Be,De)},fi.createContext=function(Ne){return Ne={$$typeof:l,_currentValue:Ne,_currentValue2:Ne,_threadCount:0,Provider:null,Consumer:null},Ne.Provider=Ne,Ne.Consumer={$$typeof:s,_context:Ne},Ne},fi.createElement=function(Ne,se,Ee){var De,Be={},$e=null;if(se!=null)for(De in se.key!==void 0&&($e=""+se.key),se)ee.call(se,De)&&De!=="key"&&De!=="__self"&&De!=="__source"&&(Be[De]=se[De]);var Ye=arguments.length-2;if(Ye===1)Be.children=Ee;else if(1<Ye){for(var ct=Array(Ye),ut=0;ut<Ye;ut++)ct[ut]=arguments[ut+2];Be.children=ct}if(Ne&&Ne.defaultProps)for(De in Ye=Ne.defaultProps,Ye)Be[De]===void 0&&(Be[De]=Ye[De]);return J(Ne,$e,Be)},fi.createRef=function(){return{current:null}},fi.forwardRef=function(Ne){return{$$typeof:u,render:Ne}},fi.isValidElement=X,fi.lazy=function(Ne){return{$$typeof:x,_payload:{_status:-1,_result:Ne},_init:qe}},fi.memo=function(Ne,se){return{$$typeof:f,type:Ne,compare:se===void 0?null:se}},fi.startTransition=function(Ne){var se=pe.T,Ee={};pe.T=Ee;try{var De=Ne(),Be=pe.S;Be!==null&&Be(Ee,De),typeof De=="object"&&De!==null&&typeof De.then=="function"&&De.then(Ve,ot)}catch($e){ot($e)}finally{se!==null&&Ee.types!==null&&(se.types=Ee.types),pe.T=se}},fi.unstable_useCacheRefresh=function(){return pe.H.useCacheRefresh()},fi.use=function(Ne){return pe.H.use(Ne)},fi.useActionState=function(Ne,se,Ee){return pe.H.useActionState(Ne,se,Ee)},fi.useCallback=function(Ne,se){return pe.H.useCallback(Ne,se)},fi.useContext=function(Ne){return pe.H.useContext(Ne)},fi.useDebugValue=function(){},fi.useDeferredValue=function(Ne,se){return pe.H.useDeferredValue(Ne,se)},fi.useEffect=function(Ne,se){return pe.H.useEffect(Ne,se)},fi.useEffectEvent=function(Ne){return pe.H.useEffectEvent(Ne)},fi.useId=function(){return pe.H.useId()},fi.useImperativeHandle=function(Ne,se,Ee){return pe.H.useImperativeHandle(Ne,se,Ee)},fi.useInsertionEffect=function(Ne,se){return pe.H.useInsertionEffect(Ne,se)},fi.useLayoutEffect=function(Ne,se){return pe.H.useLayoutEffect(Ne,se)},fi.useMemo=function(Ne,se){return pe.H.useMemo(Ne,se)},fi.useOptimistic=function(Ne,se){return pe.H.useOptimistic(Ne,se)},fi.useReducer=function(Ne,se,Ee){return pe.H.useReducer(Ne,se,Ee)},fi.useRef=function(Ne){return pe.H.useRef(Ne)},fi.useState=function(Ne){return pe.H.useState(Ne)},fi.useSyncExternalStore=function(Ne,se,Ee){return pe.H.useSyncExternalStore(Ne,se,Ee)},fi.useTransition=function(){return pe.H.useTransition()},fi.version="19.2.0",fi}var bT;function Zx(){return bT||(bT=1,L_.exports=oP()),L_.exports}var Te=Zx();const lP=$k(Te);var D_={exports:{}},dg={},N_={exports:{}},P_={};var xT;function uP(){return xT||(xT=1,(function(i){function e(je,Je){var qe=je.length;je.push(Je);e:for(;0<qe;){var ot=qe-1>>>1,St=je[ot];if(0<r(St,Je))je[ot]=Je,je[qe]=St,qe=ot;else break e}}function t(je){return je.length===0?null:je[0]}function n(je){if(je.length===0)return null;var Je=je[0],qe=je.pop();if(qe!==Je){je[0]=qe;e:for(var ot=0,St=je.length,Ne=St>>>1;ot<Ne;){var se=2*(ot+1)-1,Ee=je[se],De=se+1,Be=je[De];if(0>r(Ee,qe))De<St&&0>r(Be,Ee)?(je[ot]=Be,je[De]=qe,ot=De):(je[ot]=Ee,je[se]=qe,ot=se);else if(De<St&&0>r(Be,qe))je[ot]=Be,je[De]=qe,ot=De;else break e}}return Je}function r(je,Je){var qe=je.sortIndex-Je.sortIndex;return qe!==0?qe:je.id-Je.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var h=[],f=[],x=1,g=null,w=3,A=!1,B=!1,$=!1,W=!1,q=typeof setTimeout=="function"?setTimeout:null,ge=typeof clearTimeout=="function"?clearTimeout:null,he=typeof setImmediate<"u"?setImmediate:null;function me(je){for(var Je=t(f);Je!==null;){if(Je.callback===null)n(f);else if(Je.startTime<=je)n(f),Je.sortIndex=Je.expirationTime,e(h,Je);else break;Je=t(f)}}function Ce(je){if($=!1,me(je),!B)if(t(h)!==null)B=!0,Ve||(Ve=!0,ae());else{var Je=t(f);Je!==null&&nt(Ce,Je.startTime-je)}}var Ve=!1,pe=-1,ee=5,J=-1;function ye(){return W?!0:!(i.unstable_now()-J<ee)}function X(){if(W=!1,Ve){var je=i.unstable_now();J=je;var Je=!0;try{e:{B=!1,$&&($=!1,ge(pe),pe=-1),A=!0;var qe=w;try{t:{for(me(je),g=t(h);g!==null&&!(g.expirationTime>je&&ye());){var ot=g.callback;if(typeof ot=="function"){g.callback=null,w=g.priorityLevel;var St=ot(g.expirationTime<=je);if(je=i.unstable_now(),typeof St=="function"){g.callback=St,me(je),Je=!0;break t}g===t(h)&&n(h),me(je)}else n(h);g=t(h)}if(g!==null)Je=!0;else{var Ne=t(f);Ne!==null&&nt(Ce,Ne.startTime-je),Je=!1}}break e}finally{g=null,w=qe,A=!1}Je=void 0}}finally{Je?ae():Ve=!1}}}var ae;if(typeof he=="function")ae=function(){he(X)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ze=le.port2;le.port1.onmessage=X,ae=function(){ze.postMessage(null)}}else ae=function(){q(X,0)};function nt(je,Je){pe=q(function(){je(i.unstable_now())},Je)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(je){je.callback=null},i.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<je?Math.floor(1e3/je):5},i.unstable_getCurrentPriorityLevel=function(){return w},i.unstable_next=function(je){switch(w){case 1:case 2:case 3:var Je=3;break;default:Je=w}var qe=w;w=Je;try{return je()}finally{w=qe}},i.unstable_requestPaint=function(){W=!0},i.unstable_runWithPriority=function(je,Je){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var qe=w;w=je;try{return Je()}finally{w=qe}},i.unstable_scheduleCallback=function(je,Je,qe){var ot=i.unstable_now();switch(typeof qe=="object"&&qe!==null?(qe=qe.delay,qe=typeof qe=="number"&&0<qe?ot+qe:ot):qe=ot,je){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=qe+St,je={id:x++,callback:Je,priorityLevel:je,startTime:qe,expirationTime:St,sortIndex:-1},qe>ot?(je.sortIndex=qe,e(f,je),t(h)===null&&je===t(f)&&($?(ge(pe),pe=-1):$=!0,nt(Ce,qe-ot))):(je.sortIndex=St,e(h,je),B||A||(B=!0,Ve||(Ve=!0,ae()))),je},i.unstable_shouldYield=ye,i.unstable_wrapCallback=function(je){var Je=w;return function(){var qe=w;w=Je;try{return je.apply(this,arguments)}finally{w=qe}}}})(P_)),P_}var wT;function cP(){return wT||(wT=1,N_.exports=uP()),N_.exports}var O_={exports:{}},Io={};var ST;function hP(){if(ST)return Io;ST=1;var i=Zx();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)f+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(h,f,x){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:h,containerInfo:f,implementation:x}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Io.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Io.createPortal=function(h,f){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return s(h,f,null,x)},Io.flushSync=function(h){var f=l.T,x=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=x,n.d.f()}},Io.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Io.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Io.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var x=f.as,g=u(x,f.crossOrigin),w=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;x==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:w,fetchPriority:A}):x==="script"&&n.d.X(h,{crossOrigin:g,integrity:w,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Io.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var x=u(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:x,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Io.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var x=f.as,g=u(x,f.crossOrigin);n.d.L(h,x,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Io.preloadModule=function(h,f){if(typeof h=="string")if(f){var x=u(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:x,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Io.requestFormReset=function(h){n.d.r(h)},Io.unstable_batchedUpdates=function(h,f){return h(f)},Io.useFormState=function(h,f,x){return l.H.useFormState(h,f,x)},Io.useFormStatus=function(){return l.H.useHostTransitionStatus()},Io.version="19.2.0",Io}var TT;function dP(){if(TT)return O_.exports;TT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),O_.exports=hP(),O_.exports}var AT;function fP(){if(AT)return dg;AT=1;var i=cP(),e=Zx(),t=dP();function n(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var o=a,c=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(c=o.return),a=o.return;while(a)}return o.tag===3?c:null}function l(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function u(a){if(a.tag===31){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function h(a){if(s(a)!==a)throw Error(n(188))}function f(a){var o=a.alternate;if(!o){if(o=s(a),o===null)throw Error(n(188));return o!==a?null:a}for(var c=a,m=o;;){var C=c.return;if(C===null)break;var D=C.alternate;if(D===null){if(m=C.return,m!==null){c=m;continue}break}if(C.child===D.child){for(D=C.child;D;){if(D===c)return h(C),a;if(D===m)return h(C),o;D=D.sibling}throw Error(n(188))}if(c.return!==m.return)c=C,m=D;else{for(var Z=!1,we=C.child;we;){if(we===c){Z=!0,c=C,m=D;break}if(we===m){Z=!0,m=C,c=D;break}we=we.sibling}if(!Z){for(we=D.child;we;){if(we===c){Z=!0,c=D,m=C;break}if(we===m){Z=!0,m=D,c=C;break}we=we.sibling}if(!Z)throw Error(n(189))}}if(c.alternate!==m)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:o}function x(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=x(a),o!==null)return o;a=a.sibling}return null}var g=Object.assign,w=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),ge=Symbol.for("react.consumer"),he=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),Ce=Symbol.for("react.suspense"),Ve=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),J=Symbol.for("react.activity"),ye=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function ae(a){return a===null||typeof a!="object"?null:(a=X&&a[X]||a["@@iterator"],typeof a=="function"?a:null)}var le=Symbol.for("react.client.reference");function ze(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===le?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case $:return"Fragment";case q:return"Profiler";case W:return"StrictMode";case Ce:return"Suspense";case Ve:return"SuspenseList";case J:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case B:return"Portal";case he:return a.displayName||"Context";case ge:return(a._context.displayName||"Context")+".Consumer";case me:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pe:return o=a.displayName||null,o!==null?o:ze(a.type)||"Memo";case ee:o=a._payload,a=a._init;try{return ze(a(o))}catch{}}return null}var nt=Array.isArray,je=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Je=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,qe={pending:!1,data:null,method:null,action:null},ot=[],St=-1;function Ne(a){return{current:a}}function se(a){0>St||(a.current=ot[St],ot[St]=null,St--)}function Ee(a,o){St++,ot[St]=a.current,a.current=o}var De=Ne(null),Be=Ne(null),$e=Ne(null),Ye=Ne(null);function ct(a,o){switch(Ee($e,o),Ee(Be,a),Ee(De,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?z5(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=z5(o),a=U5(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}se(De),Ee(De,a)}function ut(){se(De),se(Be),se($e)}function Tt(a){a.memoizedState!==null&&Ee(Ye,a);var o=De.current,c=U5(o,a.type);o!==c&&(Ee(Be,a),Ee(De,c))}function Ft(a){Be.current===a&&(se(De),se(Be)),Ye.current===a&&(se(Ye),og._currentValue=qe)}var Wt,qt;function Et(a){if(Wt===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Wt=o&&o[1]||"",qt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wt+a+qt}var Pe=!1;function $t(a,o){if(!a||Pe)return"";Pe=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(o){var Nt=function(){throw Error()};if(Object.defineProperty(Nt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Nt,[])}catch(xt){var yt=xt}Reflect.construct(a,[],Nt)}else{try{Nt.call()}catch(xt){yt=xt}a.call(Nt.prototype)}}else{try{throw Error()}catch(xt){yt=xt}(Nt=a())&&typeof Nt.catch=="function"&&Nt.catch(function(){})}}catch(xt){if(xt&&yt&&typeof xt.stack=="string")return[xt.stack,yt.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=m.DetermineComponentFrameRoot(),Z=D[0],we=D[1];if(Z&&we){var Ke=Z.split(`
`),pt=we.split(`
`);for(C=m=0;m<Ke.length&&!Ke[m].includes("DetermineComponentFrameRoot");)m++;for(;C<pt.length&&!pt[C].includes("DetermineComponentFrameRoot");)C++;if(m===Ke.length||C===pt.length)for(m=Ke.length-1,C=pt.length-1;1<=m&&0<=C&&Ke[m]!==pt[C];)C--;for(;1<=m&&0<=C;m--,C--)if(Ke[m]!==pt[C]){if(m!==1||C!==1)do if(m--,C--,0>C||Ke[m]!==pt[C]){var kt=`
`+Ke[m].replace(" at new "," at ");return a.displayName&&kt.includes("<anonymous>")&&(kt=kt.replace("<anonymous>",a.displayName)),kt}while(1<=m&&0<=C);break}}}finally{Pe=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?Et(c):""}function Dt(a,o){switch(a.tag){case 26:case 27:case 5:return Et(a.type);case 16:return Et("Lazy");case 13:return a.child!==o&&o!==null?Et("Suspense Fallback"):Et("Suspense");case 19:return Et("SuspenseList");case 0:case 15:return $t(a.type,!1);case 11:return $t(a.type.render,!1);case 1:return $t(a.type,!0);case 31:return Et("Activity");default:return""}}function wn(a){try{var o="",c=null;do o+=Dt(a,c),c=a,a=a.return;while(a);return o}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var _t=Object.prototype.hasOwnProperty,en=i.unstable_scheduleCallback,Xt=i.unstable_cancelCallback,Tn=i.unstable_shouldYield,bn=i.unstable_requestPaint,Un=i.unstable_now,ii=i.unstable_getCurrentPriorityLevel,Bn=i.unstable_ImmediatePriority,li=i.unstable_UserBlockingPriority,Xn=i.unstable_NormalPriority,ln=i.unstable_LowPriority,$n=i.unstable_IdlePriority,cn=i.log,er=i.unstable_setDisableYieldValue,Jn=null,mn=null;function On(a){if(typeof cn=="function"&&er(a),mn&&typeof mn.setStrictMode=="function")try{mn.setStrictMode(Jn,a)}catch{}}var qn=Math.clz32?Math.clz32:Mn,on=Math.log,Ni=Math.LN2;function Mn(a){return a>>>=0,a===0?32:31-(on(a)/Ni|0)|0}var xn=256,Qn=262144,Qt=4194304;function Ht(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Kn(a,o,c){var m=a.pendingLanes;if(m===0)return 0;var C=0,D=a.suspendedLanes,Z=a.pingedLanes;a=a.warmLanes;var we=m&134217727;return we!==0?(m=we&~D,m!==0?C=Ht(m):(Z&=we,Z!==0?C=Ht(Z):c||(c=we&~a,c!==0&&(C=Ht(c))))):(we=m&~D,we!==0?C=Ht(we):Z!==0?C=Ht(Z):c||(c=m&~a,c!==0&&(C=Ht(c)))),C===0?0:o!==0&&o!==C&&(o&D)===0&&(D=C&-C,c=o&-o,D>=c||D===32&&(c&4194048)!==0)?o:C}function kr(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function vr(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cr(){var a=Qt;return Qt<<=1,(Qt&62914560)===0&&(Qt=4194304),a}function Ci(a){for(var o=[],c=0;31>c;c++)o.push(a);return o}function dn(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Aa(a,o,c,m,C,D){var Z=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var we=a.entanglements,Ke=a.expirationTimes,pt=a.hiddenUpdates;for(c=Z&~c;0<c;){var kt=31-qn(c),Nt=1<<kt;we[kt]=0,Ke[kt]=-1;var yt=pt[kt];if(yt!==null)for(pt[kt]=null,kt=0;kt<yt.length;kt++){var xt=yt[kt];xt!==null&&(xt.lane&=-536870913)}c&=~Nt}m!==0&&ta(a,m,0),D!==0&&C===0&&a.tag!==0&&(a.suspendedLanes|=D&~(Z&~o))}function ta(a,o,c){a.pendingLanes|=o,a.suspendedLanes&=~o;var m=31-qn(o);a.entangledLanes|=o,a.entanglements[m]=a.entanglements[m]|1073741824|c&261930}function Rr(a,o){var c=a.entangledLanes|=o;for(a=a.entanglements;c;){var m=31-qn(c),C=1<<m;C&o|a[m]&o&&(a[m]|=o),c&=~C}}function ms(a,o){var c=o&-o;return c=(c&42)!==0?1:Pi(c),(c&(a.suspendedLanes|o))!==0?0:c}function Pi(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function tr(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function cr(){var a=Je.p;return a!==0?a:(a=window.event,a===void 0?32:cT(a.type))}function os(a,o){var c=Je.p;try{return Je.p=a,o()}finally{Je.p=c}}var Zr=Math.random().toString(36).slice(2),qi="__reactFiber$"+Zr,Yi="__reactProps$"+Zr,Kr="__reactContainer$"+Zr,ls="__reactEvents$"+Zr,da="__reactListeners$"+Zr,Va="__reactHandles$"+Zr,ys="__reactResources$"+Zr,es="__reactMarker$"+Zr;function to(a){delete a[qi],delete a[Yi],delete a[ls],delete a[da],delete a[Va]}function Ps(a){var o=a[qi];if(o)return o;for(var c=a.parentNode;c;){if(o=c[Kr]||c[qi]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(a=q5(a);a!==null;){if(c=a[qi])return c;a=q5(a)}return o}a=c,c=a.parentNode}return null}function Os(a){if(a=a[qi]||a[Kr]){var o=a.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return a}return null}function na(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(n(33))}function Ms(a){var o=a[ys];return o||(o=a[ys]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function hr(a){a[es]=!0}var ml=new Set,Fs={};function fa(a,o){Ts(a,o),Ts(a+"Capture",o)}function Ts(a,o){for(Fs[a]=o,a=0;a<o.length;a++)ml.add(o[a])}var Mo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),el={},tl={};function Fo(a){return _t.call(tl,a)?!0:_t.call(el,a)?!1:Mo.test(a)?tl[a]=!0:(el[a]=!0,!1)}function oi(a,o,c){if(Fo(o))if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var m=o.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+c)}}function jr(a,o,c){if(c===null)a.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+c)}}function _r(a,o,c,m){if(m===null)a.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(o,c,""+m)}}function hn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ea(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function js(a,o,c){var m=Object.getOwnPropertyDescriptor(a.constructor.prototype,o);if(!a.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var C=m.get,D=m.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return C.call(this)},set:function(Z){c=""+Z,D.call(this,Z)}}),Object.defineProperty(a,o,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(Z){c=""+Z},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function gi(a){if(!a._valueTracker){var o=Ea(a)?"checked":"value";a._valueTracker=js(a,o,""+a[o])}}function za(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var c=o.getValue(),m="";return a&&(m=Ea(a)?a.checked?"true":"false":a.value),a=m,a!==c?(o.setValue(a),!0):!1}function ri(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var dr=/[\n"\\]/g;function Lr(a){return a.replace(dr,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function jo(a,o,c,m,C,D,Z,we){a.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?a.type=Z:a.removeAttribute("type"),o!=null?Z==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+hn(o)):a.value!==""+hn(o)&&(a.value=""+hn(o)):Z!=="submit"&&Z!=="reset"||a.removeAttribute("value"),o!=null?Vo(a,Z,hn(o)):c!=null?Vo(a,Z,hn(c)):m!=null&&a.removeAttribute("value"),C==null&&D!=null&&(a.defaultChecked=!!D),C!=null&&(a.checked=C&&typeof C!="function"&&typeof C!="symbol"),we!=null&&typeof we!="function"&&typeof we!="symbol"&&typeof we!="boolean"?a.name=""+hn(we):a.removeAttribute("name")}function Bl(a,o,c,m,C,D,Z,we){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(a.type=D),o!=null||c!=null){if(!(D!=="submit"&&D!=="reset"||o!=null)){gi(a);return}c=c!=null?""+hn(c):"",o=o!=null?""+hn(o):c,we||o===a.value||(a.value=o),a.defaultValue=o}m=m??C,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=we?a.checked:!!m,a.defaultChecked=!!m,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(a.name=Z),gi(a)}function Vo(a,o,c){o==="number"&&ri(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function br(a,o,c,m){if(a=a.options,o){o={};for(var C=0;C<c.length;C++)o["$"+c[C]]=!0;for(c=0;c<a.length;c++)C=o.hasOwnProperty("$"+a[c].value),a[c].selected!==C&&(a[c].selected=C),C&&m&&(a[c].defaultSelected=!0)}else{for(c=""+hn(c),o=null,C=0;C<a.length;C++){if(a[C].value===c){a[C].selected=!0,m&&(a[C].defaultSelected=!0);return}o!==null||a[C].disabled||(o=a[C])}o!==null&&(o.selected=!0)}}function yl(a,o,c){if(o!=null&&(o=""+hn(o),o!==a.value&&(a.value=o),c==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=c!=null?""+hn(c):""}function ia(a,o,c,m){if(o==null){if(m!=null){if(c!=null)throw Error(n(92));if(nt(m)){if(1<m.length)throw Error(n(93));m=m[0]}c=m}c==null&&(c=""),o=c}c=hn(o),a.defaultValue=c,m=a.textContent,m===c&&m!==""&&m!==null&&(a.value=m),gi(a)}function Oi(a,o){if(o){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=o;return}}a.textContent=o}var no=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vl(a,o,c){var m=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":m?a.setProperty(o,c):typeof c!="number"||c===0||no.has(o)?o==="float"?a.cssFloat=c:a[o]=(""+c).trim():a[o]=c+"px"}function _l(a,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(a=a.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||o!=null&&o.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var C in o)m=o[C],o.hasOwnProperty(C)&&c[C]!==m&&vl(a,C,m)}else for(var D in o)o.hasOwnProperty(D)&&vl(a,D,o[D])}function zo(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ua=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mt(a){return It.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function kn(){}var xi=null;function or(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Mi=null,rn=null;function Vs(a){var o=Os(a);if(o&&(a=o.stateNode)){var c=a[Yi]||null;e:switch(a=o.stateNode,o.type){case"input":if(jo(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Lr(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var m=c[o];if(m!==a&&m.form===a.form){var C=m[Yi]||null;if(!C)throw Error(n(90));jo(m,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(o=0;o<c.length;o++)m=c[o],m.form===a.form&&za(m)}break e;case"textarea":yl(a,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&br(a,!!c.multiple,o,!1)}}}var io=!1;function pa(a,o,c){if(io)return a(o,c);io=!0;try{var m=a(o);return m}finally{if(io=!1,(Mi!==null||rn!==null)&&(py(),Mi&&(o=Mi,a=rn,rn=Mi=null,Vs(o),a)))for(o=0;o<a.length;o++)Vs(a[o])}}function Wr(a,o){var c=a.stateNode;if(c===null)return null;var m=c[Yi]||null;if(m===null)return null;c=m[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ga=!1;if(wi)try{var ki={};Object.defineProperty(ki,"passive",{get:function(){ga=!0}}),window.addEventListener("test",ki,ki),window.removeEventListener("test",ki,ki)}catch{ga=!1}var zs=null,Ba=null,Us=null;function fn(){if(Us)return Us;var a,o=Ba,c=o.length,m,C="value"in zs?zs.value:zs.textContent,D=C.length;for(a=0;a<c&&o[a]===C[a];a++);var Z=c-a;for(m=1;m<=Z&&o[c-m]===C[D-m];m++);return Us=C.slice(a,1<m?1-m:void 0)}function As(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function Ia(){return!0}function qr(){return!1}function Tr(a){function o(c,m,C,D,Z){this._reactName=c,this._targetInst=C,this.type=m,this.nativeEvent=D,this.target=Z,this.currentTarget=null;for(var we in a)a.hasOwnProperty(we)&&(c=a[we],this[we]=c?c(D):D[we]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Ia:qr,this.isPropagationStopped=qr,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ia)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ia)},persist:function(){},isPersistent:Ia}),o}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vr=Tr(ka),Ca=g({},ka,{view:0,detail:0}),ma=Tr(Ca),us,Cn,Ri,Es=g({},Ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vn,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ri&&(Ri&&a.type==="mousemove"?(us=a.screenX-Ri.screenX,Cn=a.screenY-Ri.screenY):Cn=us=0,Ri=a),us)},movementY:function(a){return"movementY"in a?a.movementY:Cn}}),$a=Tr(Es),Bs=g({},Es,{dataTransfer:0}),wo=Tr(Bs),du=g({},Ca,{relatedTarget:0}),ro=Tr(du),bl=g({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),j=Tr(bl),fe=g({},ka,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Me=Tr(fe),We=g({},ka,{data:0}),tt=Tr(We),At={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},an={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pn(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=an[a])?!!o[a]:!1}function Vn(){return pn}var Rn=g({},Ca,{key:function(a){if(a.key){var o=At[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=As(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Pt[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vn,charCode:function(a){return a.type==="keypress"?As(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?As(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Si=Tr(Rn),Ar=g({},Es,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fr=Tr(Ar),E=g({},Ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vn}),K=Tr(E),ne=g({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ie=Tr(ne),st=g({},Es,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),ft=Tr(st),jt=g({},ka,{newState:0,oldState:0}),Zn=Tr(jt),lr=[9,13,27,32],ui=wi&&"CompositionEvent"in window,nr=null;wi&&"documentMode"in document&&(nr=document.documentMode);var $s=wi&&"TextEvent"in window&&!nr,ra=wi&&(!ui||nr&&8<nr&&11>=nr),xr=" ",sa=!1;function Ga(a,o){switch(a){case"keyup":return lr.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uo(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var nl=!1;function ya(a,o){switch(a){case"compositionend":return Uo(o);case"keypress":return o.which!==32?null:(sa=!0,xr);case"textInput":return a=o.data,a===xr&&sa?null:a;default:return null}}function xl(a,o){if(nl)return a==="compositionend"||!ui&&Ga(a,o)?(a=fn(),Us=Ba=zs=null,nl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ra&&o.locale!=="ko"?null:o.data;default:return null}}var Mu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cc(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!Mu[a.type]:o==="textarea"}function so(a,o,c,m){Mi?rn?rn.push(m):rn=[m]:Mi=m,o=xy(o,"onChange"),0<o.length&&(c=new Vr("onChange","change",null,c,m),a.push({event:c,listeners:o}))}var Bo=null,wl=null;function hc(a){P5(a,0)}function $o(a){var o=na(a);if(za(o))return a}function $l(a,o){if(a==="change")return o}var Ha=!1;if(wi){var Ra;if(wi){var Go="oninput"in document;if(!Go){var il=document.createElement("div");il.setAttribute("oninput","return;"),Go=typeof il.oninput=="function"}Ra=Go}else Ra=!1;Ha=Ra&&(!document.documentMode||9<document.documentMode)}function rl(){Bo&&(Bo.detachEvent("onpropertychange",Fu),wl=Bo=null)}function Fu(a){if(a.propertyName==="value"&&$o(wl)){var o=[];so(o,wl,a,or(a)),pa(hc,o)}}function fu(a,o,c){a==="focusin"?(rl(),Bo=o,wl=c,Bo.attachEvent("onpropertychange",Fu)):a==="focusout"&&rl()}function cs(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return $o(wl)}function dc(a,o){if(a==="click")return $o(o)}function sl(a,o){if(a==="input"||a==="change")return $o(o)}function Is(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var ks=typeof Object.is=="function"?Object.is:Is;function Sl(a,o){if(ks(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var c=Object.keys(a),m=Object.keys(o);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var C=c[m];if(!_t.call(o,C)||!ks(a[C],o[C]))return!1}return!0}function ao(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ju(a,o){var c=ao(a);a=0;for(var m;c;){if(c.nodeType===3){if(m=a+c.textContent.length,a<=o&&m>=o)return{node:c,offset:o-a};a=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ao(c)}}function Ho(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?Ho(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function oo(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=ri(a.document);o instanceof a.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)a=o.contentWindow;else break;o=ri(a.document)}return o}function al(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var Gl=wi&&"documentMode"in document&&11>=document.documentMode,Ka=null,Wn=null,Ti=null,ts=!1;function Li(a,o,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ts||Ka==null||Ka!==ri(m)||(m=Ka,"selectionStart"in m&&al(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Ti&&Sl(Ti,m)||(Ti=m,m=xy(Wn,"onSelect"),0<m.length&&(o=new Vr("onSelect","select",null,o,c),a.push({event:o,listeners:m}),o.target=Ka)))}function zi(a,o){var c={};return c[a.toLowerCase()]=o.toLowerCase(),c["Webkit"+a]="webkit"+o,c["Moz"+a]="moz"+o,c}var Er={animationend:zi("Animation","AnimationEnd"),animationiteration:zi("Animation","AnimationIteration"),animationstart:zi("Animation","AnimationStart"),transitionrun:zi("Transition","TransitionRun"),transitionstart:zi("Transition","TransitionStart"),transitioncancel:zi("Transition","TransitionCancel"),transitionend:zi("Transition","TransitionEnd")},hs={},ol={};wi&&(ol=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);function Ko(a){if(hs[a])return hs[a];if(!Er[a])return a;var o=Er[a],c;for(c in o)if(o.hasOwnProperty(c)&&c in ol)return hs[a]=o[c];return a}var pu=Ko("animationend"),fc=Ko("animationiteration"),fd=Ko("animationstart"),gf=Ko("transitionrun"),mf=Ko("transitionstart"),yf=Ko("transitioncancel"),pd=Ko("transitionend"),gd=new Map,gu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gu.push("scrollEnd");function So(a,o){gd.set(a,o),fa(o,[a])}var Hl=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},lo=[],mu=0,pc=0;function yu(){for(var a=mu,o=pc=mu=0;o<a;){var c=lo[o];lo[o++]=null;var m=lo[o];lo[o++]=null;var C=lo[o];lo[o++]=null;var D=lo[o];if(lo[o++]=null,m!==null&&C!==null){var Z=m.pending;Z===null?C.next=C:(C.next=Z.next,Z.next=C),m.pending=C}D!==0&&Al(c,C,D)}}function vu(a,o,c,m){lo[mu++]=a,lo[mu++]=o,lo[mu++]=c,lo[mu++]=m,pc|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function Tl(a,o,c,m){return vu(a,o,c,m),Gs(a)}function uo(a,o){return vu(a,null,null,o),Gs(a)}function Al(a,o,c){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c);for(var C=!1,D=a.return;D!==null;)D.childLanes|=c,m=D.alternate,m!==null&&(m.childLanes|=c),D.tag===22&&(a=D.stateNode,a===null||a._visibility&1||(C=!0)),a=D,D=D.return;return a.tag===3?(D=a.stateNode,C&&o!==null&&(C=31-qn(c),a=D.hiddenUpdates,m=a[C],m===null?a[C]=[o]:m.push(o),o.lane=c|536870912),D):null}function Gs(a){if(50<eg)throw eg=0,e_=null,Error(n(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var Hs={};function gc(a,o,c,m){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function aa(a,o,c,m){return new gc(a,o,c,m)}function mc(a){return a=a.prototype,!(!a||!a.isReactComponent)}function co(a,o){var c=a.alternate;return c===null?(c=aa(a.tag,o,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=o,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,o=a.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function Kl(a,o){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,o=c.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function Vu(a,o,c,m,C,D){var Z=0;if(m=a,typeof a=="function")mc(a)&&(Z=1);else if(typeof a=="string")Z=WN(a,c,De.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case J:return a=aa(31,c,o,C),a.elementType=J,a.lanes=D,a;case $:return El(c.children,C,D,o);case W:Z=8,C|=24;break;case q:return a=aa(12,c,o,C|2),a.elementType=q,a.lanes=D,a;case Ce:return a=aa(13,c,o,C),a.elementType=Ce,a.lanes=D,a;case Ve:return a=aa(19,c,o,C),a.elementType=Ve,a.lanes=D,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case he:Z=10;break e;case ge:Z=9;break e;case me:Z=11;break e;case pe:Z=14;break e;case ee:Z=16,m=null;break e}Z=29,c=Error(n(130,a===null?"null":typeof a,"")),m=null}return o=aa(Z,c,o,C),o.elementType=a,o.type=m,o.lanes=D,o}function El(a,o,c,m){return a=aa(7,a,m,o),a.lanes=c,a}function zu(a,o,c){return a=aa(6,a,null,o),a.lanes=c,a}function yc(a){var o=aa(18,null,null,0);return o.stateNode=a,o}function _u(a,o,c){return o=aa(4,a.children!==null?a.children:[],a.key,o),o.lanes=c,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var vc=new WeakMap;function To(a,o){if(typeof a=="object"&&a!==null){var c=vc.get(a);return c!==void 0?c:(o={value:a,source:o,stack:wn(o)},vc.set(a,o),o)}return{value:a,source:o,stack:wn(o)}}var Uu=[],bu=0,sh=null,_c=0,Ao=[],Wa=0,Wl=null,ho=1,Eo="";function fo(a,o){Uu[bu++]=_c,Uu[bu++]=sh,sh=a,_c=o}function bc(a,o,c){Ao[Wa++]=ho,Ao[Wa++]=Eo,Ao[Wa++]=Wl,Wl=a;var m=ho;a=Eo;var C=32-qn(m)-1;m&=~(1<<C),c+=1;var D=32-qn(o)+C;if(30<D){var Z=C-C%5;D=(m&(1<<Z)-1).toString(32),m>>=Z,C-=Z,ho=1<<32-qn(o)+C|c<<C|m,Eo=D+a}else ho=1<<D|c<<C|m,Eo=a}function md(a){a.return!==null&&(fo(a,1),bc(a,1,0))}function ah(a){for(;a===sh;)sh=Uu[--bu],Uu[bu]=null,_c=Uu[--bu],Uu[bu]=null;for(;a===Wl;)Wl=Ao[--Wa],Ao[Wa]=null,Eo=Ao[--Wa],Ao[Wa]=null,ho=Ao[--Wa],Ao[Wa]=null}function yd(a,o){Ao[Wa++]=ho,Ao[Wa++]=Eo,Ao[Wa++]=Wl,ho=o.id,Eo=o.overflow,Wl=a}var oa=null,Dr=null,yi=!1,La=null,ns=!1,O=Error(n(519));function d(a){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw z(To(o,a)),O}function p(a){var o=a.stateNode,c=a.type,m=a.memoizedProps;switch(o[qi]=a,o[Yi]=m,c){case"dialog":Hi("cancel",o),Hi("close",o);break;case"iframe":case"object":case"embed":Hi("load",o);break;case"video":case"audio":for(c=0;c<ng.length;c++)Hi(ng[c],o);break;case"source":Hi("error",o);break;case"img":case"image":case"link":Hi("error",o),Hi("load",o);break;case"details":Hi("toggle",o);break;case"input":Hi("invalid",o),Bl(o,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Hi("invalid",o);break;case"textarea":Hi("invalid",o),ia(o,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||m.suppressHydrationWarning===!0||j5(o.textContent,c)?(m.popover!=null&&(Hi("beforetoggle",o),Hi("toggle",o)),m.onScroll!=null&&Hi("scroll",o),m.onScrollEnd!=null&&Hi("scrollend",o),m.onClick!=null&&(o.onclick=kn),o=!0):o=!1,o||d(a,!0)}function y(a){for(oa=a.return;oa;)switch(oa.tag){case 5:case 31:case 13:ns=!1;return;case 27:case 3:ns=!0;return;default:oa=oa.return}}function N(a){if(a!==oa)return!1;if(!yi)return y(a),yi=!0,!1;var o=a.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||g_(a.type,a.memoizedProps)),c=!c),c&&Dr&&d(a),y(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Dr=W5(a)}else if(o===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));Dr=W5(a)}else o===27?(o=Dr,bh(a.type)?(a=b_,b_=null,Dr=a):Dr=o):Dr=oa?Zl(a.stateNode.nextSibling):null;return!0}function L(){Dr=oa=null,yi=!1}function F(){var a=La;return a!==null&&(hl===null?hl=a:hl.push.apply(hl,a),La=null),a}function z(a){La===null?La=[a]:La.push(a)}var P=Ne(null),k=null,R=null;function S(a,o,c){Ee(P,o._currentValue),o._currentValue=c}function T(a){a._currentValue=P.current,se(P)}function H(a,o,c){for(;a!==null;){var m=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,m!==null&&(m.childLanes|=o)):m!==null&&(m.childLanes&o)!==o&&(m.childLanes|=o),a===c)break;a=a.return}}function te(a,o,c,m){var C=a.child;for(C!==null&&(C.return=a);C!==null;){var D=C.dependencies;if(D!==null){var Z=C.child;D=D.firstContext;e:for(;D!==null;){var we=D;D=C;for(var Ke=0;Ke<o.length;Ke++)if(we.context===o[Ke]){D.lanes|=c,we=D.alternate,we!==null&&(we.lanes|=c),H(D.return,c,a),m||(Z=null);break e}D=we.next}}else if(C.tag===18){if(Z=C.return,Z===null)throw Error(n(341));Z.lanes|=c,D=Z.alternate,D!==null&&(D.lanes|=c),H(Z,c,a),Z=null}else Z=C.child;if(Z!==null)Z.return=C;else for(Z=C;Z!==null;){if(Z===a){Z=null;break}if(C=Z.sibling,C!==null){C.return=Z.return,Z=C;break}Z=Z.return}C=Z}}function Se(a,o,c,m){a=null;for(var C=o,D=!1;C!==null;){if(!D){if((C.flags&524288)!==0)D=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var Z=C.alternate;if(Z===null)throw Error(n(387));if(Z=Z.memoizedProps,Z!==null){var we=C.type;ks(C.pendingProps.value,Z.value)||(a!==null?a.push(we):a=[we])}}else if(C===Ye.current){if(Z=C.alternate,Z===null)throw Error(n(387));Z.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(a!==null?a.push(og):a=[og])}C=C.return}a!==null&&te(o,a,c,m),o.flags|=262144}function ie(a){for(a=a.firstContext;a!==null;){if(!ks(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function _e(a){k=a,R=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Y(a){return be(k,a)}function re(a,o){return k===null&&_e(a),be(a,o)}function be(a,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},R===null){if(a===null)throw Error(n(308));R=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else R=R.next=o;return c}var ke=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(c,m){a.push(m)}};this.abort=function(){o.aborted=!0,a.forEach(function(c){return c()})}},it=i.unstable_scheduleCallback,vt=i.unstable_NormalPriority,Q={$$typeof:he,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function U(){return{controller:new ke,data:new Map,refCount:0}}function Oe(a){a.refCount--,a.refCount===0&&it(vt,function(){a.controller.abort()})}var Fe=null,bt=0,v=0,I=null;function M(a,o){if(Fe===null){var c=Fe=[];bt=0,v=a_(),I={status:"pending",value:void 0,then:function(m){c.push(m)}}}return bt++,o.then(G,G),o}function G(){if(--bt===0&&Fe!==null){I!==null&&(I.status="fulfilled");var a=Fe;Fe=null,v=0,I=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function oe(a,o){var c=[],m={status:"pending",value:null,reason:null,then:function(C){c.push(C)}};return a.then(function(){m.status="fulfilled",m.value=o;for(var C=0;C<c.length;C++)(0,c[C])(o)},function(C){for(m.status="rejected",m.reason=C,C=0;C<c.length;C++)(0,c[C])(void 0)}),m}var de=je.S;je.S=function(a,o){l5=Un(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&M(a,o),de!==null&&de(a,o)};var ue=Ne(null);function ve(){var a=ue.current;return a!==null?a:Jr.pooledCache}function xe(a,o){o===null?Ee(ue,ue.current):Ee(ue,o.pool)}function Re(){var a=ve();return a===null?null:{parent:Q._currentValue,pool:a}}var Ue=Error(n(460)),Xe=Error(n(474)),Ae=Error(n(542)),He={then:function(){}};function et(a){return a=a.status,a==="fulfilled"||a==="rejected"}function at(a,o,c){switch(c=a[c],c===void 0?a.push(o):c!==o&&(o.then(kn,kn),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Lt(a),a;default:if(typeof o.status=="string")o.then(kn,kn);else{if(a=Jr,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=o,a.status="pending",a.then(function(m){if(o.status==="pending"){var C=o;C.status="fulfilled",C.value=m}},function(m){if(o.status==="pending"){var C=o;C.status="rejected",C.reason=m}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Lt(a),a}throw gt=o,Ue}}function Ze(a){try{var o=a._init;return o(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(gt=c,Ue):c}}var gt=null;function wt(){if(gt===null)throw Error(n(459));var a=gt;return gt=null,a}function Lt(a){if(a===Ue||a===Ae)throw Error(n(483))}var ht=null,Ut=0;function Bt(a){var o=Ut;return Ut+=1,ht===null&&(ht=[]),at(ht,a,o)}function An(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Zt(a,o){throw o.$$typeof===w?Error(n(525)):(a=Object.prototype.toString.call(o),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function vi(a){function o(rt,Qe){if(a){var dt=rt.deletions;dt===null?(rt.deletions=[Qe],rt.flags|=16):dt.push(Qe)}}function c(rt,Qe){if(!a)return null;for(;Qe!==null;)o(rt,Qe),Qe=Qe.sibling;return null}function m(rt){for(var Qe=new Map;rt!==null;)rt.key!==null?Qe.set(rt.key,rt):Qe.set(rt.index,rt),rt=rt.sibling;return Qe}function C(rt,Qe){return rt=co(rt,Qe),rt.index=0,rt.sibling=null,rt}function D(rt,Qe,dt){return rt.index=dt,a?(dt=rt.alternate,dt!==null?(dt=dt.index,dt<Qe?(rt.flags|=67108866,Qe):dt):(rt.flags|=67108866,Qe)):(rt.flags|=1048576,Qe)}function Z(rt){return a&&rt.alternate===null&&(rt.flags|=67108866),rt}function we(rt,Qe,dt,Rt){return Qe===null||Qe.tag!==6?(Qe=zu(dt,rt.mode,Rt),Qe.return=rt,Qe):(Qe=C(Qe,dt),Qe.return=rt,Qe)}function Ke(rt,Qe,dt,Rt){var Gn=dt.type;return Gn===$?kt(rt,Qe,dt.props.children,Rt,dt.key):Qe!==null&&(Qe.elementType===Gn||typeof Gn=="object"&&Gn!==null&&Gn.$$typeof===ee&&Ze(Gn)===Qe.type)?(Qe=C(Qe,dt.props),An(Qe,dt),Qe.return=rt,Qe):(Qe=Vu(dt.type,dt.key,dt.props,null,rt.mode,Rt),An(Qe,dt),Qe.return=rt,Qe)}function pt(rt,Qe,dt,Rt){return Qe===null||Qe.tag!==4||Qe.stateNode.containerInfo!==dt.containerInfo||Qe.stateNode.implementation!==dt.implementation?(Qe=_u(dt,rt.mode,Rt),Qe.return=rt,Qe):(Qe=C(Qe,dt.children||[]),Qe.return=rt,Qe)}function kt(rt,Qe,dt,Rt,Gn){return Qe===null||Qe.tag!==7?(Qe=El(dt,rt.mode,Rt,Gn),Qe.return=rt,Qe):(Qe=C(Qe,dt),Qe.return=rt,Qe)}function Nt(rt,Qe,dt){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return Qe=zu(""+Qe,rt.mode,dt),Qe.return=rt,Qe;if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case A:return dt=Vu(Qe.type,Qe.key,Qe.props,null,rt.mode,dt),An(dt,Qe),dt.return=rt,dt;case B:return Qe=_u(Qe,rt.mode,dt),Qe.return=rt,Qe;case ee:return Qe=Ze(Qe),Nt(rt,Qe,dt)}if(nt(Qe)||ae(Qe))return Qe=El(Qe,rt.mode,dt,null),Qe.return=rt,Qe;if(typeof Qe.then=="function")return Nt(rt,Bt(Qe),dt);if(Qe.$$typeof===he)return Nt(rt,re(rt,Qe),dt);Zt(rt,Qe)}return null}function yt(rt,Qe,dt,Rt){var Gn=Qe!==null?Qe.key:null;if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return Gn!==null?null:we(rt,Qe,""+dt,Rt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case A:return dt.key===Gn?Ke(rt,Qe,dt,Rt):null;case B:return dt.key===Gn?pt(rt,Qe,dt,Rt):null;case ee:return dt=Ze(dt),yt(rt,Qe,dt,Rt)}if(nt(dt)||ae(dt))return Gn!==null?null:kt(rt,Qe,dt,Rt,null);if(typeof dt.then=="function")return yt(rt,Qe,Bt(dt),Rt);if(dt.$$typeof===he)return yt(rt,Qe,re(rt,dt),Rt);Zt(rt,dt)}return null}function xt(rt,Qe,dt,Rt,Gn){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return rt=rt.get(dt)||null,we(Qe,rt,""+Rt,Gn);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case A:return rt=rt.get(Rt.key===null?dt:Rt.key)||null,Ke(Qe,rt,Rt,Gn);case B:return rt=rt.get(Rt.key===null?dt:Rt.key)||null,pt(Qe,rt,Rt,Gn);case ee:return Rt=Ze(Rt),xt(rt,Qe,dt,Rt,Gn)}if(nt(Rt)||ae(Rt))return rt=rt.get(dt)||null,kt(Qe,rt,Rt,Gn,null);if(typeof Rt.then=="function")return xt(rt,Qe,dt,Bt(Rt),Gn);if(Rt.$$typeof===he)return xt(rt,Qe,dt,re(Qe,Rt),Gn);Zt(Qe,Rt)}return null}function yn(rt,Qe,dt,Rt){for(var Gn=null,gr=null,En=Qe,Ai=Qe=0,Zi=null;En!==null&&Ai<dt.length;Ai++){En.index>Ai?(Zi=En,En=null):Zi=En.sibling;var mr=yt(rt,En,dt[Ai],Rt);if(mr===null){En===null&&(En=Zi);break}a&&En&&mr.alternate===null&&o(rt,En),Qe=D(mr,Qe,Ai),gr===null?Gn=mr:gr.sibling=mr,gr=mr,En=Zi}if(Ai===dt.length)return c(rt,En),yi&&fo(rt,Ai),Gn;if(En===null){for(;Ai<dt.length;Ai++)En=Nt(rt,dt[Ai],Rt),En!==null&&(Qe=D(En,Qe,Ai),gr===null?Gn=En:gr.sibling=En,gr=En);return yi&&fo(rt,Ai),Gn}for(En=m(En);Ai<dt.length;Ai++)Zi=xt(En,rt,Ai,dt[Ai],Rt),Zi!==null&&(a&&Zi.alternate!==null&&En.delete(Zi.key===null?Ai:Zi.key),Qe=D(Zi,Qe,Ai),gr===null?Gn=Zi:gr.sibling=Zi,gr=Zi);return a&&En.forEach(function(Ah){return o(rt,Ah)}),yi&&fo(rt,Ai),Gn}function Yn(rt,Qe,dt,Rt){if(dt==null)throw Error(n(151));for(var Gn=null,gr=null,En=Qe,Ai=Qe=0,Zi=null,mr=dt.next();En!==null&&!mr.done;Ai++,mr=dt.next()){En.index>Ai?(Zi=En,En=null):Zi=En.sibling;var Ah=yt(rt,En,mr.value,Rt);if(Ah===null){En===null&&(En=Zi);break}a&&En&&Ah.alternate===null&&o(rt,En),Qe=D(Ah,Qe,Ai),gr===null?Gn=Ah:gr.sibling=Ah,gr=Ah,En=Zi}if(mr.done)return c(rt,En),yi&&fo(rt,Ai),Gn;if(En===null){for(;!mr.done;Ai++,mr=dt.next())mr=Nt(rt,mr.value,Rt),mr!==null&&(Qe=D(mr,Qe,Ai),gr===null?Gn=mr:gr.sibling=mr,gr=mr);return yi&&fo(rt,Ai),Gn}for(En=m(En);!mr.done;Ai++,mr=dt.next())mr=xt(En,rt,Ai,mr.value,Rt),mr!==null&&(a&&mr.alternate!==null&&En.delete(mr.key===null?Ai:mr.key),Qe=D(mr,Qe,Ai),gr===null?Gn=mr:gr.sibling=mr,gr=mr);return a&&En.forEach(function(rP){return o(rt,rP)}),yi&&fo(rt,Ai),Gn}function Br(rt,Qe,dt,Rt){if(typeof dt=="object"&&dt!==null&&dt.type===$&&dt.key===null&&(dt=dt.props.children),typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case A:e:{for(var Gn=dt.key;Qe!==null;){if(Qe.key===Gn){if(Gn=dt.type,Gn===$){if(Qe.tag===7){c(rt,Qe.sibling),Rt=C(Qe,dt.props.children),Rt.return=rt,rt=Rt;break e}}else if(Qe.elementType===Gn||typeof Gn=="object"&&Gn!==null&&Gn.$$typeof===ee&&Ze(Gn)===Qe.type){c(rt,Qe.sibling),Rt=C(Qe,dt.props),An(Rt,dt),Rt.return=rt,rt=Rt;break e}c(rt,Qe);break}else o(rt,Qe);Qe=Qe.sibling}dt.type===$?(Rt=El(dt.props.children,rt.mode,Rt,dt.key),Rt.return=rt,rt=Rt):(Rt=Vu(dt.type,dt.key,dt.props,null,rt.mode,Rt),An(Rt,dt),Rt.return=rt,rt=Rt)}return Z(rt);case B:e:{for(Gn=dt.key;Qe!==null;){if(Qe.key===Gn)if(Qe.tag===4&&Qe.stateNode.containerInfo===dt.containerInfo&&Qe.stateNode.implementation===dt.implementation){c(rt,Qe.sibling),Rt=C(Qe,dt.children||[]),Rt.return=rt,rt=Rt;break e}else{c(rt,Qe);break}else o(rt,Qe);Qe=Qe.sibling}Rt=_u(dt,rt.mode,Rt),Rt.return=rt,rt=Rt}return Z(rt);case ee:return dt=Ze(dt),Br(rt,Qe,dt,Rt)}if(nt(dt))return yn(rt,Qe,dt,Rt);if(ae(dt)){if(Gn=ae(dt),typeof Gn!="function")throw Error(n(150));return dt=Gn.call(dt),Yn(rt,Qe,dt,Rt)}if(typeof dt.then=="function")return Br(rt,Qe,Bt(dt),Rt);if(dt.$$typeof===he)return Br(rt,Qe,re(rt,dt),Rt);Zt(rt,dt)}return typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint"?(dt=""+dt,Qe!==null&&Qe.tag===6?(c(rt,Qe.sibling),Rt=C(Qe,dt),Rt.return=rt,rt=Rt):(c(rt,Qe),Rt=zu(dt,rt.mode,Rt),Rt.return=rt,rt=Rt),Z(rt)):c(rt,Qe)}return function(rt,Qe,dt,Rt){try{Ut=0;var Gn=Br(rt,Qe,dt,Rt);return ht=null,Gn}catch(En){if(En===Ue||En===Ae)throw En;var gr=aa(29,En,null,rt.mode);return gr.lanes=Rt,gr.return=rt,gr}finally{}}}var Ui=vi(!0),si=vi(!1),nn=!1;function Gt(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ei(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ln(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Nn(a,o,c){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(wr&2)!==0){var C=m.pending;return C===null?o.next=o:(o.next=C.next,C.next=o),m.pending=o,o=Gs(a),Al(a,null,c),o}return vu(a,m,o,c),Gs(a)}function ur(a,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var m=o.lanes;m&=a.pendingLanes,c|=m,o.lanes=c,Rr(a,c)}}function is(a,o){var c=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var C=null,D=null;if(c=c.firstBaseUpdate,c!==null){do{var Z={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};D===null?C=D=Z:D=D.next=Z,c=c.next}while(c!==null);D===null?C=D=o:D=D.next=o}else C=D=o;c={baseState:m.baseState,firstBaseUpdate:C,lastBaseUpdate:D,shared:m.shared,callbacks:m.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=o:a.next=o,c.lastBaseUpdate=o}var Sn=!1;function pr(){if(Sn){var a=I;if(a!==null)throw a}}function vs(a,o,c,m){Sn=!1;var C=a.updateQueue;nn=!1;var D=C.firstBaseUpdate,Z=C.lastBaseUpdate,we=C.shared.pending;if(we!==null){C.shared.pending=null;var Ke=we,pt=Ke.next;Ke.next=null,Z===null?D=pt:Z.next=pt,Z=Ke;var kt=a.alternate;kt!==null&&(kt=kt.updateQueue,we=kt.lastBaseUpdate,we!==Z&&(we===null?kt.firstBaseUpdate=pt:we.next=pt,kt.lastBaseUpdate=Ke))}if(D!==null){var Nt=C.baseState;Z=0,kt=pt=Ke=null,we=D;do{var yt=we.lane&-536870913,xt=yt!==we.lane;if(xt?(Qi&yt)===yt:(m&yt)===yt){yt!==0&&yt===v&&(Sn=!0),kt!==null&&(kt=kt.next={lane:0,tag:we.tag,payload:we.payload,callback:null,next:null});e:{var yn=a,Yn=we;yt=o;var Br=c;switch(Yn.tag){case 1:if(yn=Yn.payload,typeof yn=="function"){Nt=yn.call(Br,Nt,yt);break e}Nt=yn;break e;case 3:yn.flags=yn.flags&-65537|128;case 0:if(yn=Yn.payload,yt=typeof yn=="function"?yn.call(Br,Nt,yt):yn,yt==null)break e;Nt=g({},Nt,yt);break e;case 2:nn=!0}}yt=we.callback,yt!==null&&(a.flags|=64,xt&&(a.flags|=8192),xt=C.callbacks,xt===null?C.callbacks=[yt]:xt.push(yt))}else xt={lane:yt,tag:we.tag,payload:we.payload,callback:we.callback,next:null},kt===null?(pt=kt=xt,Ke=Nt):kt=kt.next=xt,Z|=yt;if(we=we.next,we===null){if(we=C.shared.pending,we===null)break;xt=we,we=xt.next,xt.next=null,C.lastBaseUpdate=xt,C.shared.pending=null}}while(!0);kt===null&&(Ke=Nt),C.baseState=Ke,C.firstBaseUpdate=pt,C.lastBaseUpdate=kt,D===null&&(C.shared.lanes=0),gh|=Z,a.lanes=Z,a.memoizedState=Nt}}function va(a,o){if(typeof a!="function")throw Error(n(191,a));a.call(o)}function zr(a,o){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)va(c[a],o)}var di=Ne(null),Bi=Ne(0);function ir(a,o){a=Rc,Ee(Bi,a),Ee(di,o),Rc=a|o.baseLanes}function sn(){Ee(Bi,Rc),Ee(di,di.current)}function Cs(){Rc=Bi.current,se(di),se(Bi)}var Ir=Ne(null),mi=null;function ds(a){var o=a.alternate;Ee(Fn,Fn.current&1),Ee(Ir,a),mi===null&&(o===null||di.current!==null||o.memoizedState!==null)&&(mi=a)}function Xi(a){Ee(Fn,Fn.current),Ee(Ir,a),mi===null&&(mi=a)}function Yr(a){a.tag===22?(Ee(Fn,Fn.current),Ee(Ir,a),mi===null&&(mi=a)):fs()}function fs(){Ee(Fn,Fn.current),Ee(Ir,Ir.current)}function _i(a){se(Ir),mi===a&&(mi=null),se(Fn)}var Fn=Ne(0);function Rs(a){for(var o=a;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||v_(c)||__(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Xr=0,Pn=null,zn=null,Ji=null,Da=!1,po=!1,_a=!1,_s=0,ql=0,Il=null,Bu=0;function Yt(){throw Error(n(321))}function Wo(a,o){if(o===null)return!1;for(var c=0;c<o.length&&c<a.length;c++)if(!ks(a[c],o[c]))return!1;return!0}function $u(a,o,c,m,C,D){return Xr=D,Pn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,je.H=a===null||a.memoizedState===null?_S:Cv,_a=!1,D=c(m,C),_a=!1,po&&(D=kl(o,c,m,C)),xc(a),D}function xc(a){je.H=Hp;var o=zn!==null&&zn.next!==null;if(Xr=0,Ji=zn=Pn=null,Da=!1,ql=0,Il=null,o)throw Error(n(300));a===null||ba||(a=a.dependencies,a!==null&&ie(a)&&(ba=!0))}function kl(a,o,c,m){Pn=a;var C=0;do{if(po&&(Il=null),ql=0,po=!1,25<=C)throw Error(n(301));if(C+=1,Ji=zn=null,a.updateQueue!=null){var D=a.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}je.H=bS,D=o(c,m)}while(po);return D}function $p(){var a=je.H,o=a.useState()[0];return o=typeof o.then=="function"?Cl(o):o,a=a.useState()[0],(zn!==null?zn.memoizedState:null)!==a&&(Pn.flags|=1024),o}function oh(){var a=_s!==0;return _s=0,a}function vd(a,o,c){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~c}function lh(a){if(Da){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Da=!1}Xr=0,Ji=zn=Pn=null,po=!1,ql=_s=0,Il=null}function Ls(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ji===null?Pn.memoizedState=Ji=a:Ji=Ji.next=a,Ji}function rs(){if(zn===null){var a=Pn.alternate;a=a!==null?a.memoizedState:null}else a=zn.next;var o=Ji===null?Pn.memoizedState:Ji.next;if(o!==null)Ji=o,zn=a;else{if(a===null)throw Pn.alternate===null?Error(n(467)):Error(n(310));zn=a,a={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},Ji===null?Pn.memoizedState=Ji=a:Ji=Ji.next=a}return Ji}function Yl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cl(a){var o=ql;return ql+=1,Il===null&&(Il=[]),a=at(Il,a,o),o=Pn,(Ji===null?o.memoizedState:Ji.next)===null&&(o=o.alternate,je.H=o===null||o.memoizedState===null?_S:Cv),a}function xu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Cl(a);if(a.$$typeof===he)return Y(a)}throw Error(n(438,String(a)))}function Xl(a){var o=null,c=Pn.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var m=Pn.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(o={data:m.data.map(function(C){return C.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Yl(),Pn.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(a),m=0;m<a;m++)c[m]=ye;return o.index++,c}function go(a,o){return typeof o=="function"?o(a):o}function bi(a){var o=rs();return Jl(o,zn,a)}function Jl(a,o,c){var m=a.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=c;var C=a.baseQueue,D=m.pending;if(D!==null){if(C!==null){var Z=C.next;C.next=D.next,D.next=Z}o.baseQueue=C=D,m.pending=null}if(D=a.baseState,C===null)a.memoizedState=D;else{o=C.next;var we=Z=null,Ke=null,pt=o,kt=!1;do{var Nt=pt.lane&-536870913;if(Nt!==pt.lane?(Qi&Nt)===Nt:(Xr&Nt)===Nt){var yt=pt.revertLane;if(yt===0)Ke!==null&&(Ke=Ke.next={lane:0,revertLane:0,gesture:null,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null}),Nt===v&&(kt=!0);else if((Xr&yt)===yt){pt=pt.next,yt===v&&(kt=!0);continue}else Nt={lane:0,revertLane:pt.revertLane,gesture:null,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},Ke===null?(we=Ke=Nt,Z=D):Ke=Ke.next=Nt,Pn.lanes|=yt,gh|=yt;Nt=pt.action,_a&&c(D,Nt),D=pt.hasEagerState?pt.eagerState:c(D,Nt)}else yt={lane:Nt,revertLane:pt.revertLane,gesture:pt.gesture,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},Ke===null?(we=Ke=yt,Z=D):Ke=Ke.next=yt,Pn.lanes|=Nt,gh|=Nt;pt=pt.next}while(pt!==null&&pt!==o);if(Ke===null?Z=D:Ke.next=we,!ks(D,a.memoizedState)&&(ba=!0,kt&&(c=I,c!==null)))throw c;a.memoizedState=D,a.baseState=Z,a.baseQueue=Ke,m.lastRenderedState=D}return C===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function wc(a){var o=rs(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var m=c.dispatch,C=c.pending,D=o.memoizedState;if(C!==null){c.pending=null;var Z=C=C.next;do D=a(D,Z.action),Z=Z.next;while(Z!==C);ks(D,o.memoizedState)||(ba=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),c.lastRenderedState=D}return[D,m]}function Sc(a,o,c){var m=Pn,C=rs(),D=yi;if(D){if(c===void 0)throw Error(n(407));c=c()}else c=o();var Z=!ks((zn||C).memoizedState,c);if(Z&&(C.memoizedState=c,ba=!0),C=C.queue,Sv(bd.bind(null,m,C,a),[a]),C.getSnapshot!==o||Z||Ji!==null&&Ji.memoizedState.tag&1){if(m.flags|=2048,Ql(9,{destroy:void 0},_d.bind(null,m,C,c,o),null),Jr===null)throw Error(n(349));D||(Xr&127)!==0||Rl(m,o,c)}return c}function Rl(a,o,c){a.flags|=16384,a={getSnapshot:o,value:c},o=Pn.updateQueue,o===null?(o=Yl(),Pn.updateQueue=o,o.stores=[a]):(c=o.stores,c===null?o.stores=[a]:c.push(a))}function _d(a,o,c,m){o.value=c,o.getSnapshot=m,_(o)&&V(a)}function bd(a,o,c){return c(function(){_(o)&&V(a)})}function _(a){var o=a.getSnapshot;a=a.value;try{var c=o();return!ks(a,c)}catch{return!0}}function V(a){var o=uo(a,2);o!==null&&dl(o,a,2)}function ce(a){var o=Ls();if(typeof a=="function"){var c=a;if(a=c(),_a){On(!0);try{c()}finally{On(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:a},o}function Le(a,o,c,m){return a.baseState=c,Jl(a,zn,typeof m=="function"?m:go)}function Ge(a,o,c,m,C){if(ny(a))throw Error(n(485));if(a=o.action,a!==null){var D={payload:C,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){D.listeners.push(Z)}};je.T!==null?c(!0):D.isTransition=!1,m(D),c=o.pending,c===null?(D.next=o.pending=D,mt(o,D)):(D.next=c.next,o.pending=c.next=D)}}function mt(a,o){var c=o.action,m=o.payload,C=a.state;if(o.isTransition){var D=je.T,Z={};je.T=Z;try{var we=c(C,m),Ke=je.S;Ke!==null&&Ke(Z,we),Ct(a,o,we)}catch(pt){Dn(a,o,pt)}finally{D!==null&&Z.types!==null&&(D.types=Z.types),je.T=D}}else try{D=c(C,m),Ct(a,o,D)}catch(pt){Dn(a,o,pt)}}function Ct(a,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){Jt(a,o,m)},function(m){return Dn(a,o,m)}):Jt(a,o,c)}function Jt(a,o,c){o.status="fulfilled",o.value=c,$i(o),a.state=c,o=a.pending,o!==null&&(c=o.next,c===o?a.pending=null:(c=c.next,o.next=c,mt(a,c)))}function Dn(a,o,c){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do o.status="rejected",o.reason=c,$i(o),o=o.next;while(o!==m)}a.action=null}function $i(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function Ks(a,o){return o}function Ws(a,o){if(yi){var c=Jr.formState;if(c!==null){e:{var m=Pn;if(yi){if(Dr){t:{for(var C=Dr,D=ns;C.nodeType!==8;){if(!D){C=null;break t}if(C=Zl(C.nextSibling),C===null){C=null;break t}}D=C.data,C=D==="F!"||D==="F"?C:null}if(C){Dr=Zl(C.nextSibling),m=C.data==="F!";break e}}d(m)}m=!1}m&&(o=c[0])}}return c=Ls(),c.memoizedState=c.baseState=o,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:o},c.queue=m,c=mS.bind(null,Pn,m),m.dispatch=c,m=ce(!1),D=kv.bind(null,Pn,!1,m.queue),m=Ls(),C={state:o,dispatch:null,action:a,pending:null},m.queue=C,c=Ge.bind(null,Pn,C,D,c),C.dispatch=c,m.memoizedState=a,[o,c,!1]}function qa(a){var o=rs();return Na(o,zn,a)}function Na(a,o,c){if(o=Jl(a,o,Ks)[0],a=bi(go)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var m=Cl(o)}catch(Z){throw Z===Ue?Ae:Z}else m=o;o=rs();var C=o.queue,D=C.dispatch;return c!==o.memoizedState&&(Pn.flags|=2048,Ql(9,{destroy:void 0},uh.bind(null,C,c),null)),[m,D,a]}function uh(a,o){a.action=o}function ch(a){var o=rs(),c=zn;if(c!==null)return Na(o,c,a);rs(),o=o.memoizedState,c=rs();var m=c.queue.dispatch;return c.memoizedState=a,[o,m,!1]}function Ql(a,o,c,m){return a={tag:a,create:c,deps:m,inst:o,next:null},o=Pn.updateQueue,o===null&&(o=Yl(),Pn.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=a.next=a:(m=c.next,c.next=a,a.next=m,o.lastEffect=a),a}function ty(){return rs().memoizedState}function hh(a,o,c,m){var C=Ls();Pn.flags|=a,C.memoizedState=Ql(1|o,{destroy:void 0},c,m===void 0?null:m)}function dh(a,o,c,m){var C=rs();m=m===void 0?null:m;var D=C.memoizedState.inst;zn!==null&&m!==null&&Wo(m,zn.memoizedState.deps)?C.memoizedState=Ql(o,D,c,m):(Pn.flags|=a,C.memoizedState=Ql(1|o,D,c,m))}function nS(a,o){hh(8390656,8,a,o)}function Sv(a,o){dh(2048,8,a,o)}function QD(a){Pn.flags|=4;var o=Pn.updateQueue;if(o===null)o=Yl(),Pn.updateQueue=o,o.events=[a];else{var c=o.events;c===null?o.events=[a]:c.push(a)}}function iS(a){var o=rs().memoizedState;return QD({ref:o,nextImpl:a}),function(){if((wr&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function rS(a,o){return dh(4,2,a,o)}function sS(a,o){return dh(4,4,a,o)}function aS(a,o){if(typeof o=="function"){a=a();var c=o(a);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function oS(a,o,c){c=c!=null?c.concat([a]):null,dh(4,4,aS.bind(null,o,a),c)}function Tv(){}function lS(a,o){var c=rs();o=o===void 0?null:o;var m=c.memoizedState;return o!==null&&Wo(o,m[1])?m[0]:(c.memoizedState=[a,o],a)}function uS(a,o){var c=rs();o=o===void 0?null:o;var m=c.memoizedState;if(o!==null&&Wo(o,m[1]))return m[0];if(m=a(),_a){On(!0);try{a()}finally{On(!1)}}return c.memoizedState=[m,o],m}function Av(a,o,c){return c===void 0||(Xr&1073741824)!==0&&(Qi&261930)===0?a.memoizedState=o:(a.memoizedState=c,a=c5(),Pn.lanes|=a,gh|=a,c)}function cS(a,o,c,m){return ks(c,o)?c:di.current!==null?(a=Av(a,c,m),ks(a,o)||(ba=!0),a):(Xr&42)===0||(Xr&1073741824)!==0&&(Qi&261930)===0?(ba=!0,a.memoizedState=c):(a=c5(),Pn.lanes|=a,gh|=a,o)}function hS(a,o,c,m,C){var D=Je.p;Je.p=D!==0&&8>D?D:8;var Z=je.T,we={};je.T=we,kv(a,!1,o,c);try{var Ke=C(),pt=je.S;if(pt!==null&&pt(we,Ke),Ke!==null&&typeof Ke=="object"&&typeof Ke.then=="function"){var kt=oe(Ke,m);Gp(a,o,kt,Nl(a))}else Gp(a,o,m,Nl(a))}catch(Nt){Gp(a,o,{then:function(){},status:"rejected",reason:Nt},Nl())}finally{Je.p=D,Z!==null&&we.types!==null&&(Z.types=we.types),je.T=Z}}function ZD(){}function Ev(a,o,c,m){if(a.tag!==5)throw Error(n(476));var C=dS(a).queue;hS(a,C,o,qe,c===null?ZD:function(){return fS(a),c(m)})}function dS(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:qe,baseState:qe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:qe},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:c},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function fS(a){var o=dS(a);o.next===null&&(o=a.alternate.memoizedState),Gp(a,o.next.queue,{},Nl())}function Iv(){return Y(og)}function pS(){return rs().memoizedState}function gS(){return rs().memoizedState}function eN(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var c=Nl();a=Ln(c);var m=Nn(o,a,c);m!==null&&(dl(m,o,c),ur(m,o,c)),o={cache:U()},a.payload=o;return}o=o.return}}function tN(a,o,c){var m=Nl();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ny(a)?yS(o,c):(c=Tl(a,o,c,m),c!==null&&(dl(c,a,m),vS(c,o,m)))}function mS(a,o,c){var m=Nl();Gp(a,o,c,m)}function Gp(a,o,c,m){var C={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(ny(a))yS(o,C);else{var D=a.alternate;if(a.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var Z=o.lastRenderedState,we=D(Z,c);if(C.hasEagerState=!0,C.eagerState=we,ks(we,Z))return vu(a,o,C,0),Jr===null&&yu(),!1}catch{}finally{}if(c=Tl(a,o,C,m),c!==null)return dl(c,a,m),vS(c,o,m),!0}return!1}function kv(a,o,c,m){if(m={lane:2,revertLane:a_(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},ny(a)){if(o)throw Error(n(479))}else o=Tl(a,c,m,2),o!==null&&dl(o,a,2)}function ny(a){var o=a.alternate;return a===Pn||o!==null&&o===Pn}function yS(a,o){po=Da=!0;var c=a.pending;c===null?o.next=o:(o.next=c.next,c.next=o),a.pending=o}function vS(a,o,c){if((c&4194048)!==0){var m=o.lanes;m&=a.pendingLanes,c|=m,o.lanes=c,Rr(a,c)}}var Hp={readContext:Y,use:xu,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useLayoutEffect:Yt,useInsertionEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useSyncExternalStore:Yt,useId:Yt,useHostTransitionStatus:Yt,useFormState:Yt,useActionState:Yt,useOptimistic:Yt,useMemoCache:Yt,useCacheRefresh:Yt};Hp.useEffectEvent=Yt;var _S={readContext:Y,use:xu,useCallback:function(a,o){return Ls().memoizedState=[a,o===void 0?null:o],a},useContext:Y,useEffect:nS,useImperativeHandle:function(a,o,c){c=c!=null?c.concat([a]):null,hh(4194308,4,aS.bind(null,o,a),c)},useLayoutEffect:function(a,o){return hh(4194308,4,a,o)},useInsertionEffect:function(a,o){hh(4,2,a,o)},useMemo:function(a,o){var c=Ls();o=o===void 0?null:o;var m=a();if(_a){On(!0);try{a()}finally{On(!1)}}return c.memoizedState=[m,o],m},useReducer:function(a,o,c){var m=Ls();if(c!==void 0){var C=c(o);if(_a){On(!0);try{c(o)}finally{On(!1)}}}else C=o;return m.memoizedState=m.baseState=C,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:C},m.queue=a,a=a.dispatch=tN.bind(null,Pn,a),[m.memoizedState,a]},useRef:function(a){var o=Ls();return a={current:a},o.memoizedState=a},useState:function(a){a=ce(a);var o=a.queue,c=mS.bind(null,Pn,o);return o.dispatch=c,[a.memoizedState,c]},useDebugValue:Tv,useDeferredValue:function(a,o){var c=Ls();return Av(c,a,o)},useTransition:function(){var a=ce(!1);return a=hS.bind(null,Pn,a.queue,!0,!1),Ls().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,c){var m=Pn,C=Ls();if(yi){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),Jr===null)throw Error(n(349));(Qi&127)!==0||Rl(m,o,c)}C.memoizedState=c;var D={value:c,getSnapshot:o};return C.queue=D,nS(bd.bind(null,m,D,a),[a]),m.flags|=2048,Ql(9,{destroy:void 0},_d.bind(null,m,D,c,o),null),c},useId:function(){var a=Ls(),o=Jr.identifierPrefix;if(yi){var c=Eo,m=ho;c=(m&~(1<<32-qn(m)-1)).toString(32)+c,o="_"+o+"R_"+c,c=_s++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=Bu++,o="_"+o+"r_"+c.toString(32)+"_";return a.memoizedState=o},useHostTransitionStatus:Iv,useFormState:Ws,useActionState:Ws,useOptimistic:function(a){var o=Ls();o.memoizedState=o.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=kv.bind(null,Pn,!0,c),c.dispatch=o,[a,o]},useMemoCache:Xl,useCacheRefresh:function(){return Ls().memoizedState=eN.bind(null,Pn)},useEffectEvent:function(a){var o=Ls(),c={impl:a};return o.memoizedState=c,function(){if((wr&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Cv={readContext:Y,use:xu,useCallback:lS,useContext:Y,useEffect:Sv,useImperativeHandle:oS,useInsertionEffect:rS,useLayoutEffect:sS,useMemo:uS,useReducer:bi,useRef:ty,useState:function(){return bi(go)},useDebugValue:Tv,useDeferredValue:function(a,o){var c=rs();return cS(c,zn.memoizedState,a,o)},useTransition:function(){var a=bi(go)[0],o=rs().memoizedState;return[typeof a=="boolean"?a:Cl(a),o]},useSyncExternalStore:Sc,useId:pS,useHostTransitionStatus:Iv,useFormState:qa,useActionState:qa,useOptimistic:function(a,o){var c=rs();return Le(c,zn,a,o)},useMemoCache:Xl,useCacheRefresh:gS};Cv.useEffectEvent=iS;var bS={readContext:Y,use:xu,useCallback:lS,useContext:Y,useEffect:Sv,useImperativeHandle:oS,useInsertionEffect:rS,useLayoutEffect:sS,useMemo:uS,useReducer:wc,useRef:ty,useState:function(){return wc(go)},useDebugValue:Tv,useDeferredValue:function(a,o){var c=rs();return zn===null?Av(c,a,o):cS(c,zn.memoizedState,a,o)},useTransition:function(){var a=wc(go)[0],o=rs().memoizedState;return[typeof a=="boolean"?a:Cl(a),o]},useSyncExternalStore:Sc,useId:pS,useHostTransitionStatus:Iv,useFormState:ch,useActionState:ch,useOptimistic:function(a,o){var c=rs();return zn!==null?Le(c,zn,a,o):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:Xl,useCacheRefresh:gS};bS.useEffectEvent=iS;function Rv(a,o,c,m){o=a.memoizedState,c=c(m,o),c=c==null?o:g({},o,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Lv={enqueueSetState:function(a,o,c){a=a._reactInternals;var m=Nl(),C=Ln(m);C.payload=o,c!=null&&(C.callback=c),o=Nn(a,C,m),o!==null&&(dl(o,a,m),ur(o,a,m))},enqueueReplaceState:function(a,o,c){a=a._reactInternals;var m=Nl(),C=Ln(m);C.tag=1,C.payload=o,c!=null&&(C.callback=c),o=Nn(a,C,m),o!==null&&(dl(o,a,m),ur(o,a,m))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var c=Nl(),m=Ln(c);m.tag=2,o!=null&&(m.callback=o),o=Nn(a,m,c),o!==null&&(dl(o,a,c),ur(o,a,c))}};function xS(a,o,c,m,C,D,Z){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,D,Z):o.prototype&&o.prototype.isPureReactComponent?!Sl(c,m)||!Sl(C,D):!0}function wS(a,o,c,m){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,m),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,m),o.state!==a&&Lv.enqueueReplaceState(o,o.state,null)}function xd(a,o){var c=o;if("ref"in o){c={};for(var m in o)m!=="ref"&&(c[m]=o[m])}if(a=a.defaultProps){c===o&&(c=g({},c));for(var C in a)c[C]===void 0&&(c[C]=a[C])}return c}function SS(a){Hl(a)}function TS(a){console.error(a)}function AS(a){Hl(a)}function iy(a,o){try{var c=a.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(m){setTimeout(function(){throw m})}}function ES(a,o,c){try{var m=a.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Dv(a,o,c){return c=Ln(c),c.tag=3,c.payload={element:null},c.callback=function(){iy(a,o)},c}function IS(a){return a=Ln(a),a.tag=3,a}function kS(a,o,c,m){var C=c.type.getDerivedStateFromError;if(typeof C=="function"){var D=m.value;a.payload=function(){return C(D)},a.callback=function(){ES(o,c,m)}}var Z=c.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(a.callback=function(){ES(o,c,m),typeof C!="function"&&(mh===null?mh=new Set([this]):mh.add(this));var we=m.stack;this.componentDidCatch(m.value,{componentStack:we!==null?we:""})})}function nN(a,o,c,m,C){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(o=c.alternate,o!==null&&Se(o,c,C,!0),c=Ir.current,c!==null){switch(c.tag){case 31:case 13:return mi===null?gy():c.alternate===null&&qs===0&&(qs=3),c.flags&=-257,c.flags|=65536,c.lanes=C,m===He?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([m]):o.add(m),i_(a,m,C)),!1;case 22:return c.flags|=65536,m===He?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([m]):c.add(m)),i_(a,m,C)),!1}throw Error(n(435,c.tag))}return i_(a,m,C),gy(),!1}if(yi)return o=Ir.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=C,m!==O&&(a=Error(n(422),{cause:m}),z(To(a,c)))):(m!==O&&(o=Error(n(423),{cause:m}),z(To(o,c))),a=a.current.alternate,a.flags|=65536,C&=-C,a.lanes|=C,m=To(m,c),C=Dv(a.stateNode,m,C),is(a,C),qs!==4&&(qs=2)),!1;var D=Error(n(520),{cause:m});if(D=To(D,c),Zp===null?Zp=[D]:Zp.push(D),qs!==4&&(qs=2),o===null)return!0;m=To(m,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,a=C&-C,c.lanes|=a,a=Dv(c.stateNode,m,a),is(c,a),!1;case 1:if(o=c.type,D=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(mh===null||!mh.has(D))))return c.flags|=65536,C&=-C,c.lanes|=C,C=IS(C),kS(C,a,c,m),is(c,C),!1}c=c.return}while(c!==null);return!1}var Nv=Error(n(461)),ba=!1;function mo(a,o,c,m){o.child=a===null?si(o,null,c,m):Ui(o,a.child,c,m)}function CS(a,o,c,m,C){c=c.render;var D=o.ref;if("ref"in m){var Z={};for(var we in m)we!=="ref"&&(Z[we]=m[we])}else Z=m;return _e(o),m=$u(a,o,c,Z,D,C),we=oh(),a!==null&&!ba?(vd(a,o,C),Tc(a,o,C)):(yi&&we&&md(o),o.flags|=1,mo(a,o,m,C),o.child)}function RS(a,o,c,m,C){if(a===null){var D=c.type;return typeof D=="function"&&!mc(D)&&D.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=D,LS(a,o,D,m,C)):(a=Vu(c.type,null,m,o,o.mode,C),a.ref=o.ref,a.return=o,o.child=a)}if(D=a.child,!Uv(a,C)){var Z=D.memoizedProps;if(c=c.compare,c=c!==null?c:Sl,c(Z,m)&&a.ref===o.ref)return Tc(a,o,C)}return o.flags|=1,a=co(D,m),a.ref=o.ref,a.return=o,o.child=a}function LS(a,o,c,m,C){if(a!==null){var D=a.memoizedProps;if(Sl(D,m)&&a.ref===o.ref)if(ba=!1,o.pendingProps=m=D,Uv(a,C))(a.flags&131072)!==0&&(ba=!0);else return o.lanes=a.lanes,Tc(a,o,C)}return Pv(a,o,c,m,C)}function DS(a,o,c,m){var C=m.children,D=a!==null?a.memoizedState:null;if(a===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((o.flags&128)!==0){if(D=D!==null?D.baseLanes|c:c,a!==null){for(m=o.child=a.child,C=0;m!==null;)C=C|m.lanes|m.childLanes,m=m.sibling;m=C&~D}else m=0,o.child=null;return NS(a,o,D,c,m)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&xe(o,D!==null?D.cachePool:null),D!==null?ir(o,D):sn(),Yr(o);else return m=o.lanes=536870912,NS(a,o,D!==null?D.baseLanes|c:c,c,m)}else D!==null?(xe(o,D.cachePool),ir(o,D),fs(),o.memoizedState=null):(a!==null&&xe(o,null),sn(),fs());return mo(a,o,C,c),o.child}function Kp(a,o){return a!==null&&a.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function NS(a,o,c,m,C){var D=ve();return D=D===null?null:{parent:Q._currentValue,pool:D},o.memoizedState={baseLanes:c,cachePool:D},a!==null&&xe(o,null),sn(),Yr(o),a!==null&&Se(a,o,m,!0),o.childLanes=C,null}function ry(a,o){return o=ay({mode:o.mode,children:o.children},a.mode),o.ref=a.ref,a.child=o,o.return=a,o}function PS(a,o,c){return Ui(o,a.child,null,c),a=ry(o,o.pendingProps),a.flags|=2,_i(o),o.memoizedState=null,a}function iN(a,o,c){var m=o.pendingProps,C=(o.flags&128)!==0;if(o.flags&=-129,a===null){if(yi){if(m.mode==="hidden")return a=ry(o,m),o.lanes=536870912,Kp(null,a);if(Xi(o),(a=Dr)?(a=K5(a,ns),a=a!==null&&a.data==="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:Wl!==null?{id:ho,overflow:Eo}:null,retryLane:536870912,hydrationErrors:null},c=yc(a),c.return=o,o.child=c,oa=o,Dr=null)):a=null,a===null)throw d(o);return o.lanes=536870912,null}return ry(o,m)}var D=a.memoizedState;if(D!==null){var Z=D.dehydrated;if(Xi(o),C)if(o.flags&256)o.flags&=-257,o=PS(a,o,c);else if(o.memoizedState!==null)o.child=a.child,o.flags|=128,o=null;else throw Error(n(558));else if(ba||Se(a,o,c,!1),C=(c&a.childLanes)!==0,ba||C){if(m=Jr,m!==null&&(Z=ms(m,c),Z!==0&&Z!==D.retryLane))throw D.retryLane=Z,uo(a,Z),dl(m,a,Z),Nv;gy(),o=PS(a,o,c)}else a=D.treeContext,Dr=Zl(Z.nextSibling),oa=o,yi=!0,La=null,ns=!1,a!==null&&yd(o,a),o=ry(o,m),o.flags|=4096;return o}return a=co(a.child,{mode:m.mode,children:m.children}),a.ref=o.ref,o.child=a,a.return=o,a}function sy(a,o){var c=o.ref;if(c===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(o.flags|=4194816)}}function Pv(a,o,c,m,C){return _e(o),c=$u(a,o,c,m,void 0,C),m=oh(),a!==null&&!ba?(vd(a,o,C),Tc(a,o,C)):(yi&&m&&md(o),o.flags|=1,mo(a,o,c,C),o.child)}function OS(a,o,c,m,C,D){return _e(o),o.updateQueue=null,c=kl(o,m,c,C),xc(a),m=oh(),a!==null&&!ba?(vd(a,o,D),Tc(a,o,D)):(yi&&m&&md(o),o.flags|=1,mo(a,o,c,D),o.child)}function MS(a,o,c,m,C){if(_e(o),o.stateNode===null){var D=Hs,Z=c.contextType;typeof Z=="object"&&Z!==null&&(D=Y(Z)),D=new c(m,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Lv,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=m,D.state=o.memoizedState,D.refs={},Gt(o),Z=c.contextType,D.context=typeof Z=="object"&&Z!==null?Y(Z):Hs,D.state=o.memoizedState,Z=c.getDerivedStateFromProps,typeof Z=="function"&&(Rv(o,c,Z,m),D.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(Z=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),Z!==D.state&&Lv.enqueueReplaceState(D,D.state,null),vs(o,m,D,C),pr(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),m=!0}else if(a===null){D=o.stateNode;var we=o.memoizedProps,Ke=xd(c,we);D.props=Ke;var pt=D.context,kt=c.contextType;Z=Hs,typeof kt=="object"&&kt!==null&&(Z=Y(kt));var Nt=c.getDerivedStateFromProps;kt=typeof Nt=="function"||typeof D.getSnapshotBeforeUpdate=="function",we=o.pendingProps!==we,kt||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(we||pt!==Z)&&wS(o,D,m,Z),nn=!1;var yt=o.memoizedState;D.state=yt,vs(o,m,D,C),pr(),pt=o.memoizedState,we||yt!==pt||nn?(typeof Nt=="function"&&(Rv(o,c,Nt,m),pt=o.memoizedState),(Ke=nn||xS(o,c,Ke,m,yt,pt,Z))?(kt||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=m,o.memoizedState=pt),D.props=m,D.state=pt,D.context=Z,m=Ke):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),m=!1)}else{D=o.stateNode,ei(a,o),Z=o.memoizedProps,kt=xd(c,Z),D.props=kt,Nt=o.pendingProps,yt=D.context,pt=c.contextType,Ke=Hs,typeof pt=="object"&&pt!==null&&(Ke=Y(pt)),we=c.getDerivedStateFromProps,(pt=typeof we=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Z!==Nt||yt!==Ke)&&wS(o,D,m,Ke),nn=!1,yt=o.memoizedState,D.state=yt,vs(o,m,D,C),pr();var xt=o.memoizedState;Z!==Nt||yt!==xt||nn||a!==null&&a.dependencies!==null&&ie(a.dependencies)?(typeof we=="function"&&(Rv(o,c,we,m),xt=o.memoizedState),(kt=nn||xS(o,c,kt,m,yt,xt,Ke)||a!==null&&a.dependencies!==null&&ie(a.dependencies))?(pt||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(m,xt,Ke),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(m,xt,Ke)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||Z===a.memoizedProps&&yt===a.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&yt===a.memoizedState||(o.flags|=1024),o.memoizedProps=m,o.memoizedState=xt),D.props=m,D.state=xt,D.context=Ke,m=kt):(typeof D.componentDidUpdate!="function"||Z===a.memoizedProps&&yt===a.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&yt===a.memoizedState||(o.flags|=1024),m=!1)}return D=m,sy(a,o),m=(o.flags&128)!==0,D||m?(D=o.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,a!==null&&m?(o.child=Ui(o,a.child,null,C),o.child=Ui(o,null,c,C)):mo(a,o,c,C),o.memoizedState=D.state,a=o.child):a=Tc(a,o,C),a}function FS(a,o,c,m){return L(),o.flags|=256,mo(a,o,c,m),o.child}var Ov={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mv(a){return{baseLanes:a,cachePool:Re()}}function Fv(a,o,c){return a=a!==null?a.childLanes&~c:0,o&&(a|=Dl),a}function jS(a,o,c){var m=o.pendingProps,C=!1,D=(o.flags&128)!==0,Z;if((Z=D)||(Z=a!==null&&a.memoizedState===null?!1:(Fn.current&2)!==0),Z&&(C=!0,o.flags&=-129),Z=(o.flags&32)!==0,o.flags&=-33,a===null){if(yi){if(C?ds(o):fs(),(a=Dr)?(a=K5(a,ns),a=a!==null&&a.data!=="&"?a:null,a!==null&&(o.memoizedState={dehydrated:a,treeContext:Wl!==null?{id:ho,overflow:Eo}:null,retryLane:536870912,hydrationErrors:null},c=yc(a),c.return=o,o.child=c,oa=o,Dr=null)):a=null,a===null)throw d(o);return __(a)?o.lanes=32:o.lanes=536870912,null}var we=m.children;return m=m.fallback,C?(fs(),C=o.mode,we=ay({mode:"hidden",children:we},C),m=El(m,C,c,null),we.return=o,m.return=o,we.sibling=m,o.child=we,m=o.child,m.memoizedState=Mv(c),m.childLanes=Fv(a,Z,c),o.memoizedState=Ov,Kp(null,m)):(ds(o),jv(o,we))}var Ke=a.memoizedState;if(Ke!==null&&(we=Ke.dehydrated,we!==null)){if(D)o.flags&256?(ds(o),o.flags&=-257,o=Vv(a,o,c)):o.memoizedState!==null?(fs(),o.child=a.child,o.flags|=128,o=null):(fs(),we=m.fallback,C=o.mode,m=ay({mode:"visible",children:m.children},C),we=El(we,C,c,null),we.flags|=2,m.return=o,we.return=o,m.sibling=we,o.child=m,Ui(o,a.child,null,c),m=o.child,m.memoizedState=Mv(c),m.childLanes=Fv(a,Z,c),o.memoizedState=Ov,o=Kp(null,m));else if(ds(o),__(we)){if(Z=we.nextSibling&&we.nextSibling.dataset,Z)var pt=Z.dgst;Z=pt,m=Error(n(419)),m.stack="",m.digest=Z,z({value:m,source:null,stack:null}),o=Vv(a,o,c)}else if(ba||Se(a,o,c,!1),Z=(c&a.childLanes)!==0,ba||Z){if(Z=Jr,Z!==null&&(m=ms(Z,c),m!==0&&m!==Ke.retryLane))throw Ke.retryLane=m,uo(a,m),dl(Z,a,m),Nv;v_(we)||gy(),o=Vv(a,o,c)}else v_(we)?(o.flags|=192,o.child=a.child,o=null):(a=Ke.treeContext,Dr=Zl(we.nextSibling),oa=o,yi=!0,La=null,ns=!1,a!==null&&yd(o,a),o=jv(o,m.children),o.flags|=4096);return o}return C?(fs(),we=m.fallback,C=o.mode,Ke=a.child,pt=Ke.sibling,m=co(Ke,{mode:"hidden",children:m.children}),m.subtreeFlags=Ke.subtreeFlags&65011712,pt!==null?we=co(pt,we):(we=El(we,C,c,null),we.flags|=2),we.return=o,m.return=o,m.sibling=we,o.child=m,Kp(null,m),m=o.child,we=a.child.memoizedState,we===null?we=Mv(c):(C=we.cachePool,C!==null?(Ke=Q._currentValue,C=C.parent!==Ke?{parent:Ke,pool:Ke}:C):C=Re(),we={baseLanes:we.baseLanes|c,cachePool:C}),m.memoizedState=we,m.childLanes=Fv(a,Z,c),o.memoizedState=Ov,Kp(a.child,m)):(ds(o),c=a.child,a=c.sibling,c=co(c,{mode:"visible",children:m.children}),c.return=o,c.sibling=null,a!==null&&(Z=o.deletions,Z===null?(o.deletions=[a],o.flags|=16):Z.push(a)),o.child=c,o.memoizedState=null,c)}function jv(a,o){return o=ay({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function ay(a,o){return a=aa(22,a,null,o),a.lanes=0,a}function Vv(a,o,c){return Ui(o,a.child,null,c),a=jv(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function VS(a,o,c){a.lanes|=o;var m=a.alternate;m!==null&&(m.lanes|=o),H(a.return,o,c)}function zv(a,o,c,m,C,D){var Z=a.memoizedState;Z===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:C,treeForkCount:D}:(Z.isBackwards=o,Z.rendering=null,Z.renderingStartTime=0,Z.last=m,Z.tail=c,Z.tailMode=C,Z.treeForkCount=D)}function zS(a,o,c){var m=o.pendingProps,C=m.revealOrder,D=m.tail;m=m.children;var Z=Fn.current,we=(Z&2)!==0;if(we?(Z=Z&1|2,o.flags|=128):Z&=1,Ee(Fn,Z),mo(a,o,m,c),m=yi?_c:0,!we&&a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&VS(a,c,o);else if(a.tag===19)VS(a,c,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(C){case"forwards":for(c=o.child,C=null;c!==null;)a=c.alternate,a!==null&&Rs(a)===null&&(C=c),c=c.sibling;c=C,c===null?(C=o.child,o.child=null):(C=c.sibling,c.sibling=null),zv(o,!1,C,c,D,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,C=o.child,o.child=null;C!==null;){if(a=C.alternate,a!==null&&Rs(a)===null){o.child=C;break}a=C.sibling,C.sibling=c,c=C,C=a}zv(o,!0,c,null,D,m);break;case"together":zv(o,!1,null,null,void 0,m);break;default:o.memoizedState=null}return o.child}function Tc(a,o,c){if(a!==null&&(o.dependencies=a.dependencies),gh|=o.lanes,(c&o.childLanes)===0)if(a!==null){if(Se(a,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(n(153));if(o.child!==null){for(a=o.child,c=co(a,a.pendingProps),o.child=c,c.return=o;a.sibling!==null;)a=a.sibling,c=c.sibling=co(a,a.pendingProps),c.return=o;c.sibling=null}return o.child}function Uv(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&ie(a)))}function rN(a,o,c){switch(o.tag){case 3:ct(o,o.stateNode.containerInfo),S(o,Q,a.memoizedState.cache),L();break;case 27:case 5:Tt(o);break;case 4:ct(o,o.stateNode.containerInfo);break;case 10:S(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Xi(o),null;break;case 13:var m=o.memoizedState;if(m!==null)return m.dehydrated!==null?(ds(o),o.flags|=128,null):(c&o.child.childLanes)!==0?jS(a,o,c):(ds(o),a=Tc(a,o,c),a!==null?a.sibling:null);ds(o);break;case 19:var C=(a.flags&128)!==0;if(m=(c&o.childLanes)!==0,m||(Se(a,o,c,!1),m=(c&o.childLanes)!==0),C){if(m)return zS(a,o,c);o.flags|=128}if(C=o.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Ee(Fn,Fn.current),m)break;return null;case 22:return o.lanes=0,DS(a,o,c,o.pendingProps);case 24:S(o,Q,a.memoizedState.cache)}return Tc(a,o,c)}function US(a,o,c){if(a!==null)if(a.memoizedProps!==o.pendingProps)ba=!0;else{if(!Uv(a,c)&&(o.flags&128)===0)return ba=!1,rN(a,o,c);ba=(a.flags&131072)!==0}else ba=!1,yi&&(o.flags&1048576)!==0&&bc(o,_c,o.index);switch(o.lanes=0,o.tag){case 16:e:{var m=o.pendingProps;if(a=Ze(o.elementType),o.type=a,typeof a=="function")mc(a)?(m=xd(a,m),o.tag=1,o=MS(null,o,a,m,c)):(o.tag=0,o=Pv(null,o,a,m,c));else{if(a!=null){var C=a.$$typeof;if(C===me){o.tag=11,o=CS(null,o,a,m,c);break e}else if(C===pe){o.tag=14,o=RS(null,o,a,m,c);break e}}throw o=ze(a)||a,Error(n(306,o,""))}}return o;case 0:return Pv(a,o,o.type,o.pendingProps,c);case 1:return m=o.type,C=xd(m,o.pendingProps),MS(a,o,m,C,c);case 3:e:{if(ct(o,o.stateNode.containerInfo),a===null)throw Error(n(387));m=o.pendingProps;var D=o.memoizedState;C=D.element,ei(a,o),vs(o,m,null,c);var Z=o.memoizedState;if(m=Z.cache,S(o,Q,m),m!==D.cache&&te(o,[Q],c,!0),pr(),m=Z.element,D.isDehydrated)if(D={element:m,isDehydrated:!1,cache:Z.cache},o.updateQueue.baseState=D,o.memoizedState=D,o.flags&256){o=FS(a,o,m,c);break e}else if(m!==C){C=To(Error(n(424)),o),z(C),o=FS(a,o,m,c);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Dr=Zl(a.firstChild),oa=o,yi=!0,La=null,ns=!0,c=si(o,null,m,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(L(),m===C){o=Tc(a,o,c);break e}mo(a,o,m,c)}o=o.child}return o;case 26:return sy(a,o),a===null?(c=Q5(o.type,null,o.pendingProps,null))?o.memoizedState=c:yi||(c=o.type,a=o.pendingProps,m=wy($e.current).createElement(c),m[qi]=o,m[Yi]=a,yo(m,c,a),hr(m),o.stateNode=m):o.memoizedState=Q5(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return Tt(o),a===null&&yi&&(m=o.stateNode=Y5(o.type,o.pendingProps,$e.current),oa=o,ns=!0,C=Dr,bh(o.type)?(b_=C,Dr=Zl(m.firstChild)):Dr=C),mo(a,o,o.pendingProps.children,c),sy(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&yi&&((C=m=Dr)&&(m=PN(m,o.type,o.pendingProps,ns),m!==null?(o.stateNode=m,oa=o,Dr=Zl(m.firstChild),ns=!1,C=!0):C=!1),C||d(o)),Tt(o),C=o.type,D=o.pendingProps,Z=a!==null?a.memoizedProps:null,m=D.children,g_(C,D)?m=null:Z!==null&&g_(C,Z)&&(o.flags|=32),o.memoizedState!==null&&(C=$u(a,o,$p,null,null,c),og._currentValue=C),sy(a,o),mo(a,o,m,c),o.child;case 6:return a===null&&yi&&((a=c=Dr)&&(c=ON(c,o.pendingProps,ns),c!==null?(o.stateNode=c,oa=o,Dr=null,a=!0):a=!1),a||d(o)),null;case 13:return jS(a,o,c);case 4:return ct(o,o.stateNode.containerInfo),m=o.pendingProps,a===null?o.child=Ui(o,null,m,c):mo(a,o,m,c),o.child;case 11:return CS(a,o,o.type,o.pendingProps,c);case 7:return mo(a,o,o.pendingProps,c),o.child;case 8:return mo(a,o,o.pendingProps.children,c),o.child;case 12:return mo(a,o,o.pendingProps.children,c),o.child;case 10:return m=o.pendingProps,S(o,o.type,m.value),mo(a,o,m.children,c),o.child;case 9:return C=o.type._context,m=o.pendingProps.children,_e(o),C=Y(C),m=m(C),o.flags|=1,mo(a,o,m,c),o.child;case 14:return RS(a,o,o.type,o.pendingProps,c);case 15:return LS(a,o,o.type,o.pendingProps,c);case 19:return zS(a,o,c);case 31:return iN(a,o,c);case 22:return DS(a,o,c,o.pendingProps);case 24:return _e(o),m=Y(Q),a===null?(C=ve(),C===null&&(C=Jr,D=U(),C.pooledCache=D,D.refCount++,D!==null&&(C.pooledCacheLanes|=c),C=D),o.memoizedState={parent:m,cache:C},Gt(o),S(o,Q,C)):((a.lanes&c)!==0&&(ei(a,o),vs(o,null,null,c),pr()),C=a.memoizedState,D=o.memoizedState,C.parent!==m?(C={parent:m,cache:m},o.memoizedState=C,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=C),S(o,Q,m)):(m=D.cache,S(o,Q,m),m!==C.cache&&te(o,[Q],c,!0))),mo(a,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Ac(a){a.flags|=4}function Bv(a,o,c,m,C){if((o=(a.mode&32)!==0)&&(o=!1),o){if(a.flags|=16777216,(C&335544128)===C)if(a.stateNode.complete)a.flags|=8192;else if(p5())a.flags|=8192;else throw gt=He,Xe}else a.flags&=-16777217}function BS(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!iT(o))if(p5())a.flags|=8192;else throw gt=He,Xe}function oy(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?Cr():536870912,a.lanes|=o,xf|=o)}function Wp(a,o){if(!yi)switch(a.tailMode){case"hidden":o=a.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function ps(a){var o=a.alternate!==null&&a.alternate.child===a.child,c=0,m=0;if(o)for(var C=a.child;C!==null;)c|=C.lanes|C.childLanes,m|=C.subtreeFlags&65011712,m|=C.flags&65011712,C.return=a,C=C.sibling;else for(C=a.child;C!==null;)c|=C.lanes|C.childLanes,m|=C.subtreeFlags,m|=C.flags,C.return=a,C=C.sibling;return a.subtreeFlags|=m,a.childLanes=c,o}function sN(a,o,c){var m=o.pendingProps;switch(ah(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ps(o),null;case 1:return ps(o),null;case 3:return c=o.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),o.memoizedState.cache!==m&&(o.flags|=2048),T(Q),ut(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(N(o)?Ac(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,F())),ps(o),null;case 26:var C=o.type,D=o.memoizedState;return a===null?(Ac(o),D!==null?(ps(o),BS(o,D)):(ps(o),Bv(o,C,null,m,c))):D?D!==a.memoizedState?(Ac(o),ps(o),BS(o,D)):(ps(o),o.flags&=-16777217):(a=a.memoizedProps,a!==m&&Ac(o),ps(o),Bv(o,C,a,m,c)),null;case 27:if(Ft(o),c=$e.current,C=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==m&&Ac(o);else{if(!m){if(o.stateNode===null)throw Error(n(166));return ps(o),null}a=De.current,N(o)?p(o):(a=Y5(C,m,c),o.stateNode=a,Ac(o))}return ps(o),null;case 5:if(Ft(o),C=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==m&&Ac(o);else{if(!m){if(o.stateNode===null)throw Error(n(166));return ps(o),null}if(D=De.current,N(o))p(o);else{var Z=wy($e.current);switch(D){case 1:D=Z.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:D=Z.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":D=Z.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":D=Z.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":D=Z.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof m.is=="string"?Z.createElement("select",{is:m.is}):Z.createElement("select"),m.multiple?D.multiple=!0:m.size&&(D.size=m.size);break;default:D=typeof m.is=="string"?Z.createElement(C,{is:m.is}):Z.createElement(C)}}D[qi]=o,D[Yi]=m;e:for(Z=o.child;Z!==null;){if(Z.tag===5||Z.tag===6)D.appendChild(Z.stateNode);else if(Z.tag!==4&&Z.tag!==27&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===o)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===o)break e;Z=Z.return}Z.sibling.return=Z.return,Z=Z.sibling}o.stateNode=D;e:switch(yo(D,C,m),C){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Ac(o)}}return ps(o),Bv(o,o.type,a===null?null:a.memoizedProps,o.pendingProps,c),null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==m&&Ac(o);else{if(typeof m!="string"&&o.stateNode===null)throw Error(n(166));if(a=$e.current,N(o)){if(a=o.stateNode,c=o.memoizedProps,m=null,C=oa,C!==null)switch(C.tag){case 27:case 5:m=C.memoizedProps}a[qi]=o,a=!!(a.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||j5(a.nodeValue,c)),a||d(o,!0)}else a=wy(a).createTextNode(m),a[qi]=o,o.stateNode=a}return ps(o),null;case 31:if(c=o.memoizedState,a===null||a.memoizedState!==null){if(m=N(o),c!==null){if(a===null){if(!m)throw Error(n(318));if(a=o.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(557));a[qi]=o}else L(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ps(o),a=!1}else c=F(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return o.flags&256?(_i(o),o):(_i(o),null);if((o.flags&128)!==0)throw Error(n(558))}return ps(o),null;case 13:if(m=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(C=N(o),m!==null&&m.dehydrated!==null){if(a===null){if(!C)throw Error(n(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(n(317));C[qi]=o}else L(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ps(o),C=!1}else C=F(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=C),C=!0;if(!C)return o.flags&256?(_i(o),o):(_i(o),null)}return _i(o),(o.flags&128)!==0?(o.lanes=c,o):(c=m!==null,a=a!==null&&a.memoizedState!==null,c&&(m=o.child,C=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(C=m.alternate.memoizedState.cachePool.pool),D=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(D=m.memoizedState.cachePool.pool),D!==C&&(m.flags|=2048)),c!==a&&c&&(o.child.flags|=8192),oy(o,o.updateQueue),ps(o),null);case 4:return ut(),a===null&&c_(o.stateNode.containerInfo),ps(o),null;case 10:return T(o.type),ps(o),null;case 19:if(se(Fn),m=o.memoizedState,m===null)return ps(o),null;if(C=(o.flags&128)!==0,D=m.rendering,D===null)if(C)Wp(m,!1);else{if(qs!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(D=Rs(a),D!==null){for(o.flags|=128,Wp(m,!1),a=D.updateQueue,o.updateQueue=a,oy(o,a),o.subtreeFlags=0,a=c,c=o.child;c!==null;)Kl(c,a),c=c.sibling;return Ee(Fn,Fn.current&1|2),yi&&fo(o,m.treeForkCount),o.child}a=a.sibling}m.tail!==null&&Un()>dy&&(o.flags|=128,C=!0,Wp(m,!1),o.lanes=4194304)}else{if(!C)if(a=Rs(D),a!==null){if(o.flags|=128,C=!0,a=a.updateQueue,o.updateQueue=a,oy(o,a),Wp(m,!0),m.tail===null&&m.tailMode==="hidden"&&!D.alternate&&!yi)return ps(o),null}else 2*Un()-m.renderingStartTime>dy&&c!==536870912&&(o.flags|=128,C=!0,Wp(m,!1),o.lanes=4194304);m.isBackwards?(D.sibling=o.child,o.child=D):(a=m.last,a!==null?a.sibling=D:o.child=D,m.last=D)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=Un(),a.sibling=null,c=Fn.current,Ee(Fn,C?c&1|2:c&1),yi&&fo(o,m.treeForkCount),a):(ps(o),null);case 22:case 23:return _i(o),Cs(),m=o.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(o.flags|=8192):m&&(o.flags|=8192),m?(c&536870912)!==0&&(o.flags&128)===0&&(ps(o),o.subtreeFlags&6&&(o.flags|=8192)):ps(o),c=o.updateQueue,c!==null&&oy(o,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),m=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(m=o.memoizedState.cachePool.pool),m!==c&&(o.flags|=2048),a!==null&&se(ue),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),T(Q),ps(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function aN(a,o){switch(ah(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return T(Q),ut(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return Ft(o),null;case 31:if(o.memoizedState!==null){if(_i(o),o.alternate===null)throw Error(n(340));L()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 13:if(_i(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(n(340));L()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return se(Fn),null;case 4:return ut(),null;case 10:return T(o.type),null;case 22:case 23:return _i(o),Cs(),a!==null&&se(ue),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return T(Q),null;case 25:return null;default:return null}}function $S(a,o){switch(ah(o),o.tag){case 3:T(Q),ut();break;case 26:case 27:case 5:Ft(o);break;case 4:ut();break;case 31:o.memoizedState!==null&&_i(o);break;case 13:_i(o);break;case 19:se(Fn);break;case 10:T(o.type);break;case 22:case 23:_i(o),Cs(),a!==null&&se(ue);break;case 24:T(Q)}}function qp(a,o){try{var c=o.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var C=m.next;c=C;do{if((c.tag&a)===a){m=void 0;var D=c.create,Z=c.inst;m=D(),Z.destroy=m}c=c.next}while(c!==C)}}catch(we){Pr(o,o.return,we)}}function fh(a,o,c){try{var m=o.updateQueue,C=m!==null?m.lastEffect:null;if(C!==null){var D=C.next;m=D;do{if((m.tag&a)===a){var Z=m.inst,we=Z.destroy;if(we!==void 0){Z.destroy=void 0,C=o;var Ke=c,pt=we;try{pt()}catch(kt){Pr(C,Ke,kt)}}}m=m.next}while(m!==D)}}catch(kt){Pr(o,o.return,kt)}}function GS(a){var o=a.updateQueue;if(o!==null){var c=a.stateNode;try{zr(o,c)}catch(m){Pr(a,a.return,m)}}}function HS(a,o,c){c.props=xd(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(m){Pr(a,o,m)}}function Yp(a,o){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var m=a.stateNode;break;case 30:m=a.stateNode;break;default:m=a.stateNode}typeof c=="function"?a.refCleanup=c(m):c.current=m}}catch(C){Pr(a,o,C)}}function Gu(a,o){var c=a.ref,m=a.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(C){Pr(a,o,C)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(C){Pr(a,o,C)}else c.current=null}function KS(a){var o=a.type,c=a.memoizedProps,m=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break e;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(C){Pr(a,a.return,C)}}function $v(a,o,c){try{var m=a.stateNode;kN(m,a.type,c,o),m[Yi]=o}catch(C){Pr(a,a.return,C)}}function WS(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&bh(a.type)||a.tag===4}function Gv(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||WS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&bh(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Hv(a,o,c){var m=a.tag;if(m===5||m===6)a=a.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(a),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=kn));else if(m!==4&&(m===27&&bh(a.type)&&(c=a.stateNode,o=null),a=a.child,a!==null))for(Hv(a,o,c),a=a.sibling;a!==null;)Hv(a,o,c),a=a.sibling}function ly(a,o,c){var m=a.tag;if(m===5||m===6)a=a.stateNode,o?c.insertBefore(a,o):c.appendChild(a);else if(m!==4&&(m===27&&bh(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(ly(a,o,c),a=a.sibling;a!==null;)ly(a,o,c),a=a.sibling}function qS(a){var o=a.stateNode,c=a.memoizedProps;try{for(var m=a.type,C=o.attributes;C.length;)o.removeAttributeNode(C[0]);yo(o,m,c),o[qi]=a,o[Yi]=c}catch(D){Pr(a,a.return,D)}}var Ec=!1,xa=!1,Kv=!1,YS=typeof WeakSet=="function"?WeakSet:Set,Ya=null;function oN(a,o){if(a=a.containerInfo,f_=Cy,a=oo(a),al(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var C=m.anchorOffset,D=m.focusNode;m=m.focusOffset;try{c.nodeType,D.nodeType}catch{c=null;break e}var Z=0,we=-1,Ke=-1,pt=0,kt=0,Nt=a,yt=null;t:for(;;){for(var xt;Nt!==c||C!==0&&Nt.nodeType!==3||(we=Z+C),Nt!==D||m!==0&&Nt.nodeType!==3||(Ke=Z+m),Nt.nodeType===3&&(Z+=Nt.nodeValue.length),(xt=Nt.firstChild)!==null;)yt=Nt,Nt=xt;for(;;){if(Nt===a)break t;if(yt===c&&++pt===C&&(we=Z),yt===D&&++kt===m&&(Ke=Z),(xt=Nt.nextSibling)!==null)break;Nt=yt,yt=Nt.parentNode}Nt=xt}c=we===-1||Ke===-1?null:{start:we,end:Ke}}else c=null}c=c||{start:0,end:0}}else c=null;for(p_={focusedElem:a,selectionRange:c},Cy=!1,Ya=o;Ya!==null;)if(o=Ya,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,Ya=a;else for(;Ya!==null;){switch(o=Ya,D=o.alternate,a=o.flags,o.tag){case 0:if((a&4)!==0&&(a=o.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)C=a[c],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&D!==null){a=void 0,c=o,C=D.memoizedProps,D=D.memoizedState,m=c.stateNode;try{var yn=xd(c.type,C);a=m.getSnapshotBeforeUpdate(yn,D),m.__reactInternalSnapshotBeforeUpdate=a}catch(Yn){Pr(c,c.return,Yn)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,c=a.nodeType,c===9)y_(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":y_(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=o.sibling,a!==null){a.return=o.return,Ya=a;break}Ya=o.return}}function XS(a,o,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:kc(a,c),m&4&&qp(5,c);break;case 1:if(kc(a,c),m&4)if(a=c.stateNode,o===null)try{a.componentDidMount()}catch(Z){Pr(c,c.return,Z)}else{var C=xd(c.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(C,o,a.__reactInternalSnapshotBeforeUpdate)}catch(Z){Pr(c,c.return,Z)}}m&64&&GS(c),m&512&&Yp(c,c.return);break;case 3:if(kc(a,c),m&64&&(a=c.updateQueue,a!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{zr(a,o)}catch(Z){Pr(c,c.return,Z)}}break;case 27:o===null&&m&4&&qS(c);case 26:case 5:kc(a,c),o===null&&m&4&&KS(c),m&512&&Yp(c,c.return);break;case 12:kc(a,c);break;case 31:kc(a,c),m&4&&ZS(a,c);break;case 13:kc(a,c),m&4&&e5(a,c),m&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=mN.bind(null,c),MN(a,c))));break;case 22:if(m=c.memoizedState!==null||Ec,!m){o=o!==null&&o.memoizedState!==null||xa,C=Ec;var D=xa;Ec=m,(xa=o)&&!D?Cc(a,c,(c.subtreeFlags&8772)!==0):kc(a,c),Ec=C,xa=D}break;case 30:break;default:kc(a,c)}}function JS(a){var o=a.alternate;o!==null&&(a.alternate=null,JS(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&to(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var bs=null,ll=!1;function Ic(a,o,c){for(c=c.child;c!==null;)QS(a,o,c),c=c.sibling}function QS(a,o,c){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(Jn,c)}catch{}switch(c.tag){case 26:xa||Gu(c,o),Ic(a,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:xa||Gu(c,o);var m=bs,C=ll;bh(c.type)&&(bs=c.stateNode,ll=!1),Ic(a,o,c),rg(c.stateNode),bs=m,ll=C;break;case 5:xa||Gu(c,o);case 6:if(m=bs,C=ll,bs=null,Ic(a,o,c),bs=m,ll=C,bs!==null)if(ll)try{(bs.nodeType===9?bs.body:bs.nodeName==="HTML"?bs.ownerDocument.body:bs).removeChild(c.stateNode)}catch(D){Pr(c,o,D)}else try{bs.removeChild(c.stateNode)}catch(D){Pr(c,o,D)}break;case 18:bs!==null&&(ll?(a=bs,G5(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),Cf(a)):G5(bs,c.stateNode));break;case 4:m=bs,C=ll,bs=c.stateNode.containerInfo,ll=!0,Ic(a,o,c),bs=m,ll=C;break;case 0:case 11:case 14:case 15:fh(2,c,o),xa||fh(4,c,o),Ic(a,o,c);break;case 1:xa||(Gu(c,o),m=c.stateNode,typeof m.componentWillUnmount=="function"&&HS(c,o,m)),Ic(a,o,c);break;case 21:Ic(a,o,c);break;case 22:xa=(m=xa)||c.memoizedState!==null,Ic(a,o,c),xa=m;break;default:Ic(a,o,c)}}function ZS(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Cf(a)}catch(c){Pr(o,o.return,c)}}}function e5(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Cf(a)}catch(c){Pr(o,o.return,c)}}function lN(a){switch(a.tag){case 31:case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new YS),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new YS),o;default:throw Error(n(435,a.tag))}}function uy(a,o){var c=lN(a);o.forEach(function(m){if(!c.has(m)){c.add(m);var C=yN.bind(null,a,m);m.then(C,C)}})}function ul(a,o){var c=o.deletions;if(c!==null)for(var m=0;m<c.length;m++){var C=c[m],D=a,Z=o,we=Z;e:for(;we!==null;){switch(we.tag){case 27:if(bh(we.type)){bs=we.stateNode,ll=!1;break e}break;case 5:bs=we.stateNode,ll=!1;break e;case 3:case 4:bs=we.stateNode.containerInfo,ll=!0;break e}we=we.return}if(bs===null)throw Error(n(160));QS(D,Z,C),bs=null,ll=!1,D=C.alternate,D!==null&&(D.return=null),C.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)t5(o,a),o=o.sibling}var wu=null;function t5(a,o){var c=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ul(o,a),cl(a),m&4&&(fh(3,a,a.return),qp(3,a),fh(5,a,a.return));break;case 1:ul(o,a),cl(a),m&512&&(xa||c===null||Gu(c,c.return)),m&64&&Ec&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var C=wu;if(ul(o,a),cl(a),m&512&&(xa||c===null||Gu(c,c.return)),m&4){var D=c!==null?c.memoizedState:null;if(m=a.memoizedState,c===null)if(m===null)if(a.stateNode===null){e:{m=a.type,c=a.memoizedProps,C=C.ownerDocument||C;t:switch(m){case"title":D=C.getElementsByTagName("title")[0],(!D||D[es]||D[qi]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=C.createElement(m),C.head.insertBefore(D,C.querySelector("head > title"))),yo(D,m,c),D[qi]=a,hr(D),m=D;break e;case"link":var Z=tT("link","href",C).get(m+(c.href||""));if(Z){for(var we=0;we<Z.length;we++)if(D=Z[we],D.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&D.getAttribute("rel")===(c.rel==null?null:c.rel)&&D.getAttribute("title")===(c.title==null?null:c.title)&&D.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){Z.splice(we,1);break t}}D=C.createElement(m),yo(D,m,c),C.head.appendChild(D);break;case"meta":if(Z=tT("meta","content",C).get(m+(c.content||""))){for(we=0;we<Z.length;we++)if(D=Z[we],D.getAttribute("content")===(c.content==null?null:""+c.content)&&D.getAttribute("name")===(c.name==null?null:c.name)&&D.getAttribute("property")===(c.property==null?null:c.property)&&D.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&D.getAttribute("charset")===(c.charSet==null?null:c.charSet)){Z.splice(we,1);break t}}D=C.createElement(m),yo(D,m,c),C.head.appendChild(D);break;default:throw Error(n(468,m))}D[qi]=a,hr(D),m=D}a.stateNode=m}else nT(C,a.type,a.stateNode);else a.stateNode=eT(C,m,a.memoizedProps);else D!==m?(D===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):D.count--,m===null?nT(C,a.type,a.stateNode):eT(C,m,a.memoizedProps)):m===null&&a.stateNode!==null&&$v(a,a.memoizedProps,c.memoizedProps)}break;case 27:ul(o,a),cl(a),m&512&&(xa||c===null||Gu(c,c.return)),c!==null&&m&4&&$v(a,a.memoizedProps,c.memoizedProps);break;case 5:if(ul(o,a),cl(a),m&512&&(xa||c===null||Gu(c,c.return)),a.flags&32){C=a.stateNode;try{Oi(C,"")}catch(yn){Pr(a,a.return,yn)}}m&4&&a.stateNode!=null&&(C=a.memoizedProps,$v(a,C,c!==null?c.memoizedProps:C)),m&1024&&(Kv=!0);break;case 6:if(ul(o,a),cl(a),m&4){if(a.stateNode===null)throw Error(n(162));m=a.memoizedProps,c=a.stateNode;try{c.nodeValue=m}catch(yn){Pr(a,a.return,yn)}}break;case 3:if(Ay=null,C=wu,wu=Sy(o.containerInfo),ul(o,a),wu=C,cl(a),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Cf(o.containerInfo)}catch(yn){Pr(a,a.return,yn)}Kv&&(Kv=!1,n5(a));break;case 4:m=wu,wu=Sy(a.stateNode.containerInfo),ul(o,a),cl(a),wu=m;break;case 12:ul(o,a),cl(a);break;case 31:ul(o,a),cl(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,uy(a,m)));break;case 13:ul(o,a),cl(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(hy=Un()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,uy(a,m)));break;case 22:C=a.memoizedState!==null;var Ke=c!==null&&c.memoizedState!==null,pt=Ec,kt=xa;if(Ec=pt||C,xa=kt||Ke,ul(o,a),xa=kt,Ec=pt,cl(a),m&8192)e:for(o=a.stateNode,o._visibility=C?o._visibility&-2:o._visibility|1,C&&(c===null||Ke||Ec||xa||wd(a)),c=null,o=a;;){if(o.tag===5||o.tag===26){if(c===null){Ke=c=o;try{if(D=Ke.stateNode,C)Z=D.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{we=Ke.stateNode;var Nt=Ke.memoizedProps.style,yt=Nt!=null&&Nt.hasOwnProperty("display")?Nt.display:null;we.style.display=yt==null||typeof yt=="boolean"?"":(""+yt).trim()}}catch(yn){Pr(Ke,Ke.return,yn)}}}else if(o.tag===6){if(c===null){Ke=o;try{Ke.stateNode.nodeValue=C?"":Ke.memoizedProps}catch(yn){Pr(Ke,Ke.return,yn)}}}else if(o.tag===18){if(c===null){Ke=o;try{var xt=Ke.stateNode;C?H5(xt,!0):H5(Ke.stateNode,!1)}catch(yn){Pr(Ke,Ke.return,yn)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}m&4&&(m=a.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,uy(a,c))));break;case 19:ul(o,a),cl(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,uy(a,m)));break;case 30:break;case 21:break;default:ul(o,a),cl(a)}}function cl(a){var o=a.flags;if(o&2){try{for(var c,m=a.return;m!==null;){if(WS(m)){c=m;break}m=m.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var C=c.stateNode,D=Gv(a);ly(a,D,C);break;case 5:var Z=c.stateNode;c.flags&32&&(Oi(Z,""),c.flags&=-33);var we=Gv(a);ly(a,we,Z);break;case 3:case 4:var Ke=c.stateNode.containerInfo,pt=Gv(a);Hv(a,pt,Ke);break;default:throw Error(n(161))}}catch(kt){Pr(a,a.return,kt)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function n5(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;n5(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function kc(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)XS(a,o.alternate,o),o=o.sibling}function wd(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:fh(4,o,o.return),wd(o);break;case 1:Gu(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&HS(o,o.return,c),wd(o);break;case 27:rg(o.stateNode);case 26:case 5:Gu(o,o.return),wd(o);break;case 22:o.memoizedState===null&&wd(o);break;case 30:wd(o);break;default:wd(o)}a=a.sibling}}function Cc(a,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var m=o.alternate,C=a,D=o,Z=D.flags;switch(D.tag){case 0:case 11:case 15:Cc(C,D,c),qp(4,D);break;case 1:if(Cc(C,D,c),m=D,C=m.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(pt){Pr(m,m.return,pt)}if(m=D,C=m.updateQueue,C!==null){var we=m.stateNode;try{var Ke=C.shared.hiddenCallbacks;if(Ke!==null)for(C.shared.hiddenCallbacks=null,C=0;C<Ke.length;C++)va(Ke[C],we)}catch(pt){Pr(m,m.return,pt)}}c&&Z&64&&GS(D),Yp(D,D.return);break;case 27:qS(D);case 26:case 5:Cc(C,D,c),c&&m===null&&Z&4&&KS(D),Yp(D,D.return);break;case 12:Cc(C,D,c);break;case 31:Cc(C,D,c),c&&Z&4&&ZS(C,D);break;case 13:Cc(C,D,c),c&&Z&4&&e5(C,D);break;case 22:D.memoizedState===null&&Cc(C,D,c),Yp(D,D.return);break;case 30:break;default:Cc(C,D,c)}o=o.sibling}}function Wv(a,o){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&Oe(c))}function qv(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Oe(a))}function Su(a,o,c,m){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)i5(a,o,c,m),o=o.sibling}function i5(a,o,c,m){var C=o.flags;switch(o.tag){case 0:case 11:case 15:Su(a,o,c,m),C&2048&&qp(9,o);break;case 1:Su(a,o,c,m);break;case 3:Su(a,o,c,m),C&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Oe(a)));break;case 12:if(C&2048){Su(a,o,c,m),a=o.stateNode;try{var D=o.memoizedProps,Z=D.id,we=D.onPostCommit;typeof we=="function"&&we(Z,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(Ke){Pr(o,o.return,Ke)}}else Su(a,o,c,m);break;case 31:Su(a,o,c,m);break;case 13:Su(a,o,c,m);break;case 23:break;case 22:D=o.stateNode,Z=o.alternate,o.memoizedState!==null?D._visibility&2?Su(a,o,c,m):Xp(a,o):D._visibility&2?Su(a,o,c,m):(D._visibility|=2,vf(a,o,c,m,(o.subtreeFlags&10256)!==0||!1)),C&2048&&Wv(Z,o);break;case 24:Su(a,o,c,m),C&2048&&qv(o.alternate,o);break;default:Su(a,o,c,m)}}function vf(a,o,c,m,C){for(C=C&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var D=a,Z=o,we=c,Ke=m,pt=Z.flags;switch(Z.tag){case 0:case 11:case 15:vf(D,Z,we,Ke,C),qp(8,Z);break;case 23:break;case 22:var kt=Z.stateNode;Z.memoizedState!==null?kt._visibility&2?vf(D,Z,we,Ke,C):Xp(D,Z):(kt._visibility|=2,vf(D,Z,we,Ke,C)),C&&pt&2048&&Wv(Z.alternate,Z);break;case 24:vf(D,Z,we,Ke,C),C&&pt&2048&&qv(Z.alternate,Z);break;default:vf(D,Z,we,Ke,C)}o=o.sibling}}function Xp(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=a,m=o,C=m.flags;switch(m.tag){case 22:Xp(c,m),C&2048&&Wv(m.alternate,m);break;case 24:Xp(c,m),C&2048&&qv(m.alternate,m);break;default:Xp(c,m)}o=o.sibling}}var Jp=8192;function _f(a,o,c){if(a.subtreeFlags&Jp)for(a=a.child;a!==null;)r5(a,o,c),a=a.sibling}function r5(a,o,c){switch(a.tag){case 26:_f(a,o,c),a.flags&Jp&&a.memoizedState!==null&&qN(c,wu,a.memoizedState,a.memoizedProps);break;case 5:_f(a,o,c);break;case 3:case 4:var m=wu;wu=Sy(a.stateNode.containerInfo),_f(a,o,c),wu=m;break;case 22:a.memoizedState===null&&(m=a.alternate,m!==null&&m.memoizedState!==null?(m=Jp,Jp=16777216,_f(a,o,c),Jp=m):_f(a,o,c));break;default:_f(a,o,c)}}function s5(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function Qp(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var m=o[c];Ya=m,o5(m,a)}s5(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)a5(a),a=a.sibling}function a5(a){switch(a.tag){case 0:case 11:case 15:Qp(a),a.flags&2048&&fh(9,a,a.return);break;case 3:Qp(a);break;case 12:Qp(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,cy(a)):Qp(a);break;default:Qp(a)}}function cy(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var m=o[c];Ya=m,o5(m,a)}s5(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:fh(8,o,o.return),cy(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,cy(o));break;default:cy(o)}a=a.sibling}}function o5(a,o){for(;Ya!==null;){var c=Ya;switch(c.tag){case 0:case 11:case 15:fh(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Oe(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,Ya=m;else e:for(c=a;Ya!==null;){m=Ya;var C=m.sibling,D=m.return;if(JS(m),m===c){Ya=null;break e}if(C!==null){C.return=D,Ya=C;break e}Ya=D}}}var uN={getCacheForType:function(a){var o=Y(Q),c=o.data.get(a);return c===void 0&&(c=a(),o.data.set(a,c)),c},cacheSignal:function(){return Y(Q).controller.signal}},cN=typeof WeakMap=="function"?WeakMap:Map,wr=0,Jr=null,Gi=null,Qi=0,Nr=0,Ll=null,ph=!1,bf=!1,Yv=!1,Rc=0,qs=0,gh=0,Sd=0,Xv=0,Dl=0,xf=0,Zp=null,hl=null,Jv=!1,hy=0,l5=0,dy=1/0,fy=null,mh=null,Pa=0,yh=null,wf=null,Lc=0,Qv=0,Zv=null,u5=null,eg=0,e_=null;function Nl(){return(wr&2)!==0&&Qi!==0?Qi&-Qi:je.T!==null?a_():cr()}function c5(){if(Dl===0)if((Qi&536870912)===0||yi){var a=Qn;Qn<<=1,(Qn&3932160)===0&&(Qn=262144),Dl=a}else Dl=536870912;return a=Ir.current,a!==null&&(a.flags|=32),Dl}function dl(a,o,c){(a===Jr&&(Nr===2||Nr===9)||a.cancelPendingCommit!==null)&&(Sf(a,0),vh(a,Qi,Dl,!1)),dn(a,c),((wr&2)===0||a!==Jr)&&(a===Jr&&((wr&2)===0&&(Sd|=c),qs===4&&vh(a,Qi,Dl,!1)),Hu(a))}function h5(a,o,c){if((wr&6)!==0)throw Error(n(327));var m=!c&&(o&127)===0&&(o&a.expiredLanes)===0||kr(a,o),C=m?fN(a,o):n_(a,o,!0),D=m;do{if(C===0){bf&&!m&&vh(a,o,0,!1);break}else{if(c=a.current.alternate,D&&!hN(c)){C=n_(a,o,!1),D=!1;continue}if(C===2){if(D=o,a.errorRecoveryDisabledLanes&D)var Z=0;else Z=a.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){o=Z;e:{var we=a;C=Zp;var Ke=we.current.memoizedState.isDehydrated;if(Ke&&(Sf(we,Z).flags|=256),Z=n_(we,Z,!1),Z!==2){if(Yv&&!Ke){we.errorRecoveryDisabledLanes|=D,Sd|=D,C=4;break e}D=hl,hl=C,D!==null&&(hl===null?hl=D:hl.push.apply(hl,D))}C=Z}if(D=!1,C!==2)continue}}if(C===1){Sf(a,0),vh(a,o,0,!0);break}e:{switch(m=a,D=C,D){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:vh(m,o,Dl,!ph);break e;case 2:hl=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(C=hy+300-Un(),10<C)){if(vh(m,o,Dl,!ph),Kn(m,0,!0)!==0)break e;Lc=o,m.timeoutHandle=B5(d5.bind(null,m,c,hl,fy,Jv,o,Dl,Sd,xf,ph,D,"Throttled",-0,0),C);break e}d5(m,c,hl,fy,Jv,o,Dl,Sd,xf,ph,D,null,-0,0)}}break}while(!0);Hu(a)}function d5(a,o,c,m,C,D,Z,we,Ke,pt,kt,Nt,yt,xt){if(a.timeoutHandle=-1,Nt=o.subtreeFlags,Nt&8192||(Nt&16785408)===16785408){Nt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:kn},r5(o,D,Nt);var yn=(D&62914560)===D?hy-Un():(D&4194048)===D?l5-Un():0;if(yn=YN(Nt,yn),yn!==null){Lc=D,a.cancelPendingCommit=yn(b5.bind(null,a,o,D,c,m,C,Z,we,Ke,kt,Nt,null,yt,xt)),vh(a,D,Z,!pt);return}}b5(a,o,D,c,m,C,Z,we,Ke)}function hN(a){for(var o=a;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var C=c[m],D=C.getSnapshot;C=C.value;try{if(!ks(D(),C))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function vh(a,o,c,m){o&=~Xv,o&=~Sd,a.suspendedLanes|=o,a.pingedLanes&=~o,m&&(a.warmLanes|=o),m=a.expirationTimes;for(var C=o;0<C;){var D=31-qn(C),Z=1<<D;m[D]=-1,C&=~Z}c!==0&&ta(a,c,o)}function py(){return(wr&6)===0?(tg(0),!1):!0}function t_(){if(Gi!==null){if(Nr===0)var a=Gi.return;else a=Gi,R=k=null,lh(a),ht=null,Ut=0,a=Gi;for(;a!==null;)$S(a.alternate,a),a=a.return;Gi=null}}function Sf(a,o){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,LN(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),Lc=0,t_(),Jr=a,Gi=c=co(a.current,null),Qi=o,Nr=0,Ll=null,ph=!1,bf=kr(a,o),Yv=!1,xf=Dl=Xv=Sd=gh=qs=0,hl=Zp=null,Jv=!1,(o&8)!==0&&(o|=o&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=o;0<m;){var C=31-qn(m),D=1<<C;o|=a[C],m&=~D}return Rc=o,yu(),c}function f5(a,o){Pn=null,je.H=Hp,o===Ue||o===Ae?(o=wt(),Nr=3):o===Xe?(o=wt(),Nr=4):Nr=o===Nv?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ll=o,Gi===null&&(qs=1,iy(a,To(o,a.current)))}function p5(){var a=Ir.current;return a===null?!0:(Qi&4194048)===Qi?mi===null:(Qi&62914560)===Qi||(Qi&536870912)!==0?a===mi:!1}function g5(){var a=je.H;return je.H=Hp,a===null?Hp:a}function m5(){var a=je.A;return je.A=uN,a}function gy(){qs=4,ph||(Qi&4194048)!==Qi&&Ir.current!==null||(bf=!0),(gh&134217727)===0&&(Sd&134217727)===0||Jr===null||vh(Jr,Qi,Dl,!1)}function n_(a,o,c){var m=wr;wr|=2;var C=g5(),D=m5();(Jr!==a||Qi!==o)&&(fy=null,Sf(a,o)),o=!1;var Z=qs;e:do try{if(Nr!==0&&Gi!==null){var we=Gi,Ke=Ll;switch(Nr){case 8:t_(),Z=6;break e;case 3:case 2:case 9:case 6:Ir.current===null&&(o=!0);var pt=Nr;if(Nr=0,Ll=null,Tf(a,we,Ke,pt),c&&bf){Z=0;break e}break;default:pt=Nr,Nr=0,Ll=null,Tf(a,we,Ke,pt)}}dN(),Z=qs;break}catch(kt){f5(a,kt)}while(!0);return o&&a.shellSuspendCounter++,R=k=null,wr=m,je.H=C,je.A=D,Gi===null&&(Jr=null,Qi=0,yu()),Z}function dN(){for(;Gi!==null;)y5(Gi)}function fN(a,o){var c=wr;wr|=2;var m=g5(),C=m5();Jr!==a||Qi!==o?(fy=null,dy=Un()+500,Sf(a,o)):bf=kr(a,o);e:do try{if(Nr!==0&&Gi!==null){o=Gi;var D=Ll;t:switch(Nr){case 1:Nr=0,Ll=null,Tf(a,o,D,1);break;case 2:case 9:if(et(D)){Nr=0,Ll=null,v5(o);break}o=function(){Nr!==2&&Nr!==9||Jr!==a||(Nr=7),Hu(a)},D.then(o,o);break e;case 3:Nr=7;break e;case 4:Nr=5;break e;case 7:et(D)?(Nr=0,Ll=null,v5(o)):(Nr=0,Ll=null,Tf(a,o,D,7));break;case 5:var Z=null;switch(Gi.tag){case 26:Z=Gi.memoizedState;case 5:case 27:var we=Gi;if(Z?iT(Z):we.stateNode.complete){Nr=0,Ll=null;var Ke=we.sibling;if(Ke!==null)Gi=Ke;else{var pt=we.return;pt!==null?(Gi=pt,my(pt)):Gi=null}break t}}Nr=0,Ll=null,Tf(a,o,D,5);break;case 6:Nr=0,Ll=null,Tf(a,o,D,6);break;case 8:t_(),qs=6;break e;default:throw Error(n(462))}}pN();break}catch(kt){f5(a,kt)}while(!0);return R=k=null,je.H=m,je.A=C,wr=c,Gi!==null?0:(Jr=null,Qi=0,yu(),qs)}function pN(){for(;Gi!==null&&!Tn();)y5(Gi)}function y5(a){var o=US(a.alternate,a,Rc);a.memoizedProps=a.pendingProps,o===null?my(a):Gi=o}function v5(a){var o=a,c=o.alternate;switch(o.tag){case 15:case 0:o=OS(c,o,o.pendingProps,o.type,void 0,Qi);break;case 11:o=OS(c,o,o.pendingProps,o.type.render,o.ref,Qi);break;case 5:lh(o);default:$S(c,o),o=Gi=Kl(o,Rc),o=US(c,o,Rc)}a.memoizedProps=a.pendingProps,o===null?my(a):Gi=o}function Tf(a,o,c,m){R=k=null,lh(o),ht=null,Ut=0;var C=o.return;try{if(nN(a,C,o,c,Qi)){qs=1,iy(a,To(c,a.current)),Gi=null;return}}catch(D){if(C!==null)throw Gi=C,D;qs=1,iy(a,To(c,a.current)),Gi=null;return}o.flags&32768?(yi||m===1?a=!0:bf||(Qi&536870912)!==0?a=!1:(ph=a=!0,(m===2||m===9||m===3||m===6)&&(m=Ir.current,m!==null&&m.tag===13&&(m.flags|=16384))),_5(o,a)):my(o)}function my(a){var o=a;do{if((o.flags&32768)!==0){_5(o,ph);return}a=o.return;var c=sN(o.alternate,o,Rc);if(c!==null){Gi=c;return}if(o=o.sibling,o!==null){Gi=o;return}Gi=o=a}while(o!==null);qs===0&&(qs=5)}function _5(a,o){do{var c=aN(a.alternate,a);if(c!==null){c.flags&=32767,Gi=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(a=a.sibling,a!==null)){Gi=a;return}Gi=a=c}while(a!==null);qs=6,Gi=null}function b5(a,o,c,m,C,D,Z,we,Ke){a.cancelPendingCommit=null;do yy();while(Pa!==0);if((wr&6)!==0)throw Error(n(327));if(o!==null){if(o===a.current)throw Error(n(177));if(D=o.lanes|o.childLanes,D|=pc,Aa(a,c,D,Z,we,Ke),a===Jr&&(Gi=Jr=null,Qi=0),wf=o,yh=a,Lc=c,Qv=D,Zv=C,u5=m,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,vN(Xn,function(){return A5(),null})):(a.callbackNode=null,a.callbackPriority=0),m=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||m){m=je.T,je.T=null,C=Je.p,Je.p=2,Z=wr,wr|=4;try{oN(a,o,c)}finally{wr=Z,Je.p=C,je.T=m}}Pa=1,x5(),w5(),S5()}}function x5(){if(Pa===1){Pa=0;var a=yh,o=wf,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=je.T,je.T=null;var m=Je.p;Je.p=2;var C=wr;wr|=4;try{t5(o,a);var D=p_,Z=oo(a.containerInfo),we=D.focusedElem,Ke=D.selectionRange;if(Z!==we&&we&&we.ownerDocument&&Ho(we.ownerDocument.documentElement,we)){if(Ke!==null&&al(we)){var pt=Ke.start,kt=Ke.end;if(kt===void 0&&(kt=pt),"selectionStart"in we)we.selectionStart=pt,we.selectionEnd=Math.min(kt,we.value.length);else{var Nt=we.ownerDocument||document,yt=Nt&&Nt.defaultView||window;if(yt.getSelection){var xt=yt.getSelection(),yn=we.textContent.length,Yn=Math.min(Ke.start,yn),Br=Ke.end===void 0?Yn:Math.min(Ke.end,yn);!xt.extend&&Yn>Br&&(Z=Br,Br=Yn,Yn=Z);var rt=ju(we,Yn),Qe=ju(we,Br);if(rt&&Qe&&(xt.rangeCount!==1||xt.anchorNode!==rt.node||xt.anchorOffset!==rt.offset||xt.focusNode!==Qe.node||xt.focusOffset!==Qe.offset)){var dt=Nt.createRange();dt.setStart(rt.node,rt.offset),xt.removeAllRanges(),Yn>Br?(xt.addRange(dt),xt.extend(Qe.node,Qe.offset)):(dt.setEnd(Qe.node,Qe.offset),xt.addRange(dt))}}}}for(Nt=[],xt=we;xt=xt.parentNode;)xt.nodeType===1&&Nt.push({element:xt,left:xt.scrollLeft,top:xt.scrollTop});for(typeof we.focus=="function"&&we.focus(),we=0;we<Nt.length;we++){var Rt=Nt[we];Rt.element.scrollLeft=Rt.left,Rt.element.scrollTop=Rt.top}}Cy=!!f_,p_=f_=null}finally{wr=C,Je.p=m,je.T=c}}a.current=o,Pa=2}}function w5(){if(Pa===2){Pa=0;var a=yh,o=wf,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=je.T,je.T=null;var m=Je.p;Je.p=2;var C=wr;wr|=4;try{XS(a,o.alternate,o)}finally{wr=C,Je.p=m,je.T=c}}Pa=3}}function S5(){if(Pa===4||Pa===3){Pa=0,bn();var a=yh,o=wf,c=Lc,m=u5;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Pa=5:(Pa=0,wf=yh=null,T5(a,a.pendingLanes));var C=a.pendingLanes;if(C===0&&(mh=null),tr(c),o=o.stateNode,mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(Jn,o,void 0,(o.current.flags&128)===128)}catch{}if(m!==null){o=je.T,C=Je.p,Je.p=2,je.T=null;try{for(var D=a.onRecoverableError,Z=0;Z<m.length;Z++){var we=m[Z];D(we.value,{componentStack:we.stack})}}finally{je.T=o,Je.p=C}}(Lc&3)!==0&&yy(),Hu(a),C=a.pendingLanes,(c&261930)!==0&&(C&42)!==0?a===e_?eg++:(eg=0,e_=a):eg=0,tg(0)}}function T5(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Oe(o)))}function yy(){return x5(),w5(),S5(),A5()}function A5(){if(Pa!==5)return!1;var a=yh,o=Qv;Qv=0;var c=tr(Lc),m=je.T,C=Je.p;try{Je.p=32>c?32:c,je.T=null,c=Zv,Zv=null;var D=yh,Z=Lc;if(Pa=0,wf=yh=null,Lc=0,(wr&6)!==0)throw Error(n(331));var we=wr;if(wr|=4,a5(D.current),i5(D,D.current,Z,c),wr=we,tg(0,!1),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(Jn,D)}catch{}return!0}finally{Je.p=C,je.T=m,T5(a,o)}}function E5(a,o,c){o=To(c,o),o=Dv(a.stateNode,o,2),a=Nn(a,o,2),a!==null&&(dn(a,2),Hu(a))}function Pr(a,o,c){if(a.tag===3)E5(a,a,c);else for(;o!==null;){if(o.tag===3){E5(o,a,c);break}else if(o.tag===1){var m=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(mh===null||!mh.has(m))){a=To(c,a),c=IS(2),m=Nn(o,c,2),m!==null&&(kS(c,m,o,a),dn(m,2),Hu(m));break}}o=o.return}}function i_(a,o,c){var m=a.pingCache;if(m===null){m=a.pingCache=new cN;var C=new Set;m.set(o,C)}else C=m.get(o),C===void 0&&(C=new Set,m.set(o,C));C.has(c)||(Yv=!0,C.add(c),a=gN.bind(null,a,o,c),o.then(a,a))}function gN(a,o,c){var m=a.pingCache;m!==null&&m.delete(o),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Jr===a&&(Qi&c)===c&&(qs===4||qs===3&&(Qi&62914560)===Qi&&300>Un()-hy?(wr&2)===0&&Sf(a,0):Xv|=c,xf===Qi&&(xf=0)),Hu(a)}function I5(a,o){o===0&&(o=Cr()),a=uo(a,o),a!==null&&(dn(a,o),Hu(a))}function mN(a){var o=a.memoizedState,c=0;o!==null&&(c=o.retryLane),I5(a,c)}function yN(a,o){var c=0;switch(a.tag){case 31:case 13:var m=a.stateNode,C=a.memoizedState;C!==null&&(c=C.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(o),I5(a,c)}function vN(a,o){return en(a,o)}var vy=null,Af=null,r_=!1,_y=!1,s_=!1,_h=0;function Hu(a){a!==Af&&a.next===null&&(Af===null?vy=Af=a:Af=Af.next=a),_y=!0,r_||(r_=!0,bN())}function tg(a,o){if(!s_&&_y){s_=!0;do for(var c=!1,m=vy;m!==null;){if(a!==0){var C=m.pendingLanes;if(C===0)var D=0;else{var Z=m.suspendedLanes,we=m.pingedLanes;D=(1<<31-qn(42|a)+1)-1,D&=C&~(Z&~we),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(c=!0,L5(m,D))}else D=Qi,D=Kn(m,m===Jr?D:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(D&3)===0||kr(m,D)||(c=!0,L5(m,D));m=m.next}while(c);s_=!1}}function _N(){k5()}function k5(){_y=r_=!1;var a=0;_h!==0&&RN()&&(a=_h);for(var o=Un(),c=null,m=vy;m!==null;){var C=m.next,D=C5(m,o);D===0?(m.next=null,c===null?vy=C:c.next=C,C===null&&(Af=c)):(c=m,(a!==0||(D&3)!==0)&&(_y=!0)),m=C}Pa!==0&&Pa!==5||tg(a),_h!==0&&(_h=0)}function C5(a,o){for(var c=a.suspendedLanes,m=a.pingedLanes,C=a.expirationTimes,D=a.pendingLanes&-62914561;0<D;){var Z=31-qn(D),we=1<<Z,Ke=C[Z];Ke===-1?((we&c)===0||(we&m)!==0)&&(C[Z]=vr(we,o)):Ke<=o&&(a.expiredLanes|=we),D&=~we}if(o=Jr,c=Qi,c=Kn(a,a===o?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m=a.callbackNode,c===0||a===o&&(Nr===2||Nr===9)||a.cancelPendingCommit!==null)return m!==null&&m!==null&&Xt(m),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||kr(a,c)){if(o=c&-c,o===a.callbackPriority)return o;switch(m!==null&&Xt(m),tr(c)){case 2:case 8:c=li;break;case 32:c=Xn;break;case 268435456:c=$n;break;default:c=Xn}return m=R5.bind(null,a),c=en(c,m),a.callbackPriority=o,a.callbackNode=c,o}return m!==null&&m!==null&&Xt(m),a.callbackPriority=2,a.callbackNode=null,2}function R5(a,o){if(Pa!==0&&Pa!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(yy()&&a.callbackNode!==c)return null;var m=Qi;return m=Kn(a,a===Jr?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m===0?null:(h5(a,m,o),C5(a,Un()),a.callbackNode!=null&&a.callbackNode===c?R5.bind(null,a):null)}function L5(a,o){if(yy())return null;h5(a,o,!0)}function bN(){DN(function(){(wr&6)!==0?en(Bn,_N):k5()})}function a_(){if(_h===0){var a=v;a===0&&(a=xn,xn<<=1,(xn&261888)===0&&(xn=256)),_h=a}return _h}function D5(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Mt(""+a)}function N5(a,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,a.id&&c.setAttribute("form",a.id),o.parentNode.insertBefore(c,o),a=new FormData(a),c.parentNode.removeChild(c),a}function xN(a,o,c,m,C){if(o==="submit"&&c&&c.stateNode===C){var D=D5((C[Yi]||null).action),Z=m.submitter;Z&&(o=(o=Z[Yi]||null)?D5(o.formAction):Z.getAttribute("formAction"),o!==null&&(D=o,Z=null));var we=new Vr("action","action",null,m,C);a.push({event:we,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(_h!==0){var Ke=Z?N5(C,Z):new FormData(C);Ev(c,{pending:!0,data:Ke,method:C.method,action:D},null,Ke)}}else typeof D=="function"&&(we.preventDefault(),Ke=Z?N5(C,Z):new FormData(C),Ev(c,{pending:!0,data:Ke,method:C.method,action:D},D,Ke))},currentTarget:C}]})}}for(var o_=0;o_<gu.length;o_++){var l_=gu[o_],wN=l_.toLowerCase(),SN=l_[0].toUpperCase()+l_.slice(1);So(wN,"on"+SN)}So(pu,"onAnimationEnd"),So(fc,"onAnimationIteration"),So(fd,"onAnimationStart"),So("dblclick","onDoubleClick"),So("focusin","onFocus"),So("focusout","onBlur"),So(gf,"onTransitionRun"),So(mf,"onTransitionStart"),So(yf,"onTransitionCancel"),So(pd,"onTransitionEnd"),Ts("onMouseEnter",["mouseout","mouseover"]),Ts("onMouseLeave",["mouseout","mouseover"]),Ts("onPointerEnter",["pointerout","pointerover"]),Ts("onPointerLeave",["pointerout","pointerover"]),fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fa("onBeforeInput",["compositionend","keypress","textInput","paste"]),fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ng="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ng));function P5(a,o){o=(o&4)!==0;for(var c=0;c<a.length;c++){var m=a[c],C=m.event;m=m.listeners;e:{var D=void 0;if(o)for(var Z=m.length-1;0<=Z;Z--){var we=m[Z],Ke=we.instance,pt=we.currentTarget;if(we=we.listener,Ke!==D&&C.isPropagationStopped())break e;D=we,C.currentTarget=pt;try{D(C)}catch(kt){Hl(kt)}C.currentTarget=null,D=Ke}else for(Z=0;Z<m.length;Z++){if(we=m[Z],Ke=we.instance,pt=we.currentTarget,we=we.listener,Ke!==D&&C.isPropagationStopped())break e;D=we,C.currentTarget=pt;try{D(C)}catch(kt){Hl(kt)}C.currentTarget=null,D=Ke}}}}function Hi(a,o){var c=o[ls];c===void 0&&(c=o[ls]=new Set);var m=a+"__bubble";c.has(m)||(O5(o,a,2,!1),c.add(m))}function u_(a,o,c){var m=0;o&&(m|=4),O5(c,a,m,o)}var by="_reactListening"+Math.random().toString(36).slice(2);function c_(a){if(!a[by]){a[by]=!0,ml.forEach(function(c){c!=="selectionchange"&&(TN.has(c)||u_(c,!1,a),u_(c,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[by]||(o[by]=!0,u_("selectionchange",!1,o))}}function O5(a,o,c,m){switch(cT(o)){case 2:var C=QN;break;case 8:C=ZN;break;default:C=A_}c=C.bind(null,o,c,a),C=void 0,!ga||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(C=!0),m?C!==void 0?a.addEventListener(o,c,{capture:!0,passive:C}):a.addEventListener(o,c,!0):C!==void 0?a.addEventListener(o,c,{passive:C}):a.addEventListener(o,c,!1)}function h_(a,o,c,m,C){var D=m;if((o&1)===0&&(o&2)===0&&m!==null)e:for(;;){if(m===null)return;var Z=m.tag;if(Z===3||Z===4){var we=m.stateNode.containerInfo;if(we===C)break;if(Z===4)for(Z=m.return;Z!==null;){var Ke=Z.tag;if((Ke===3||Ke===4)&&Z.stateNode.containerInfo===C)return;Z=Z.return}for(;we!==null;){if(Z=Ps(we),Z===null)return;if(Ke=Z.tag,Ke===5||Ke===6||Ke===26||Ke===27){m=D=Z;continue e}we=we.parentNode}}m=m.return}pa(function(){var pt=D,kt=or(c),Nt=[];e:{var yt=gd.get(a);if(yt!==void 0){var xt=Vr,yn=a;switch(a){case"keypress":if(As(c)===0)break e;case"keydown":case"keyup":xt=Si;break;case"focusin":yn="focus",xt=ro;break;case"focusout":yn="blur",xt=ro;break;case"beforeblur":case"afterblur":xt=ro;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xt=$a;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xt=wo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xt=K;break;case pu:case fc:case fd:xt=j;break;case pd:xt=Ie;break;case"scroll":case"scrollend":xt=ma;break;case"wheel":xt=ft;break;case"copy":case"cut":case"paste":xt=Me;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xt=fr;break;case"toggle":case"beforetoggle":xt=Zn}var Yn=(o&4)!==0,Br=!Yn&&(a==="scroll"||a==="scrollend"),rt=Yn?yt!==null?yt+"Capture":null:yt;Yn=[];for(var Qe=pt,dt;Qe!==null;){var Rt=Qe;if(dt=Rt.stateNode,Rt=Rt.tag,Rt!==5&&Rt!==26&&Rt!==27||dt===null||rt===null||(Rt=Wr(Qe,rt),Rt!=null&&Yn.push(ig(Qe,Rt,dt))),Br)break;Qe=Qe.return}0<Yn.length&&(yt=new xt(yt,yn,null,c,kt),Nt.push({event:yt,listeners:Yn}))}}if((o&7)===0){e:{if(yt=a==="mouseover"||a==="pointerover",xt=a==="mouseout"||a==="pointerout",yt&&c!==xi&&(yn=c.relatedTarget||c.fromElement)&&(Ps(yn)||yn[Kr]))break e;if((xt||yt)&&(yt=kt.window===kt?kt:(yt=kt.ownerDocument)?yt.defaultView||yt.parentWindow:window,xt?(yn=c.relatedTarget||c.toElement,xt=pt,yn=yn?Ps(yn):null,yn!==null&&(Br=s(yn),Yn=yn.tag,yn!==Br||Yn!==5&&Yn!==27&&Yn!==6)&&(yn=null)):(xt=null,yn=pt),xt!==yn)){if(Yn=$a,Rt="onMouseLeave",rt="onMouseEnter",Qe="mouse",(a==="pointerout"||a==="pointerover")&&(Yn=fr,Rt="onPointerLeave",rt="onPointerEnter",Qe="pointer"),Br=xt==null?yt:na(xt),dt=yn==null?yt:na(yn),yt=new Yn(Rt,Qe+"leave",xt,c,kt),yt.target=Br,yt.relatedTarget=dt,Rt=null,Ps(kt)===pt&&(Yn=new Yn(rt,Qe+"enter",yn,c,kt),Yn.target=dt,Yn.relatedTarget=Br,Rt=Yn),Br=Rt,xt&&yn)t:{for(Yn=AN,rt=xt,Qe=yn,dt=0,Rt=rt;Rt;Rt=Yn(Rt))dt++;Rt=0;for(var Gn=Qe;Gn;Gn=Yn(Gn))Rt++;for(;0<dt-Rt;)rt=Yn(rt),dt--;for(;0<Rt-dt;)Qe=Yn(Qe),Rt--;for(;dt--;){if(rt===Qe||Qe!==null&&rt===Qe.alternate){Yn=rt;break t}rt=Yn(rt),Qe=Yn(Qe)}Yn=null}else Yn=null;xt!==null&&M5(Nt,yt,xt,Yn,!1),yn!==null&&Br!==null&&M5(Nt,Br,yn,Yn,!0)}}e:{if(yt=pt?na(pt):window,xt=yt.nodeName&&yt.nodeName.toLowerCase(),xt==="select"||xt==="input"&&yt.type==="file")var gr=$l;else if(cc(yt))if(Ha)gr=sl;else{gr=cs;var En=fu}else xt=yt.nodeName,!xt||xt.toLowerCase()!=="input"||yt.type!=="checkbox"&&yt.type!=="radio"?pt&&zo(pt.elementType)&&(gr=$l):gr=dc;if(gr&&(gr=gr(a,pt))){so(Nt,gr,c,kt);break e}En&&En(a,yt,pt),a==="focusout"&&pt&&yt.type==="number"&&pt.memoizedProps.value!=null&&Vo(yt,"number",yt.value)}switch(En=pt?na(pt):window,a){case"focusin":(cc(En)||En.contentEditable==="true")&&(Ka=En,Wn=pt,Ti=null);break;case"focusout":Ti=Wn=Ka=null;break;case"mousedown":ts=!0;break;case"contextmenu":case"mouseup":case"dragend":ts=!1,Li(Nt,c,kt);break;case"selectionchange":if(Gl)break;case"keydown":case"keyup":Li(Nt,c,kt)}var Ai;if(ui)e:{switch(a){case"compositionstart":var Zi="onCompositionStart";break e;case"compositionend":Zi="onCompositionEnd";break e;case"compositionupdate":Zi="onCompositionUpdate";break e}Zi=void 0}else nl?Ga(a,c)&&(Zi="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(Zi="onCompositionStart");Zi&&(ra&&c.locale!=="ko"&&(nl||Zi!=="onCompositionStart"?Zi==="onCompositionEnd"&&nl&&(Ai=fn()):(zs=kt,Ba="value"in zs?zs.value:zs.textContent,nl=!0)),En=xy(pt,Zi),0<En.length&&(Zi=new tt(Zi,a,null,c,kt),Nt.push({event:Zi,listeners:En}),Ai?Zi.data=Ai:(Ai=Uo(c),Ai!==null&&(Zi.data=Ai)))),(Ai=$s?ya(a,c):xl(a,c))&&(Zi=xy(pt,"onBeforeInput"),0<Zi.length&&(En=new tt("onBeforeInput","beforeinput",null,c,kt),Nt.push({event:En,listeners:Zi}),En.data=Ai)),xN(Nt,a,pt,c,kt)}P5(Nt,o)})}function ig(a,o,c){return{instance:a,listener:o,currentTarget:c}}function xy(a,o){for(var c=o+"Capture",m=[];a!==null;){var C=a,D=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||D===null||(C=Wr(a,c),C!=null&&m.unshift(ig(a,C,D)),C=Wr(a,o),C!=null&&m.push(ig(a,C,D))),a.tag===3)return m;a=a.return}return[]}function AN(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function M5(a,o,c,m,C){for(var D=o._reactName,Z=[];c!==null&&c!==m;){var we=c,Ke=we.alternate,pt=we.stateNode;if(we=we.tag,Ke!==null&&Ke===m)break;we!==5&&we!==26&&we!==27||pt===null||(Ke=pt,C?(pt=Wr(c,D),pt!=null&&Z.unshift(ig(c,pt,Ke))):C||(pt=Wr(c,D),pt!=null&&Z.push(ig(c,pt,Ke)))),c=c.return}Z.length!==0&&a.push({event:o,listeners:Z})}var EN=/\r\n?/g,IN=/\u0000|\uFFFD/g;function F5(a){return(typeof a=="string"?a:""+a).replace(EN,`
`).replace(IN,"")}function j5(a,o){return o=F5(o),F5(a)===o}function Ur(a,o,c,m,C,D){switch(c){case"children":typeof m=="string"?o==="body"||o==="textarea"&&m===""||Oi(a,m):(typeof m=="number"||typeof m=="bigint")&&o!=="body"&&Oi(a,""+m);break;case"className":jr(a,"class",m);break;case"tabIndex":jr(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":jr(a,c,m);break;case"style":_l(a,m,D);break;case"data":if(o!=="object"){jr(a,"data",m);break}case"src":case"href":if(m===""&&(o!=="a"||c!=="href")){a.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(c);break}m=Mt(""+m),a.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(c==="formAction"?(o!=="input"&&Ur(a,o,"name",C.name,C,null),Ur(a,o,"formEncType",C.formEncType,C,null),Ur(a,o,"formMethod",C.formMethod,C,null),Ur(a,o,"formTarget",C.formTarget,C,null)):(Ur(a,o,"encType",C.encType,C,null),Ur(a,o,"method",C.method,C,null),Ur(a,o,"target",C.target,C,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(c);break}m=Mt(""+m),a.setAttribute(c,m);break;case"onClick":m!=null&&(a.onclick=kn);break;case"onScroll":m!=null&&Hi("scroll",a);break;case"onScrollEnd":m!=null&&Hi("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(c=m.__html,c!=null){if(C.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}c=Mt(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(c,""+m):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":m===!0?a.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(c,m):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(c,m):a.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(c):a.setAttribute(c,m);break;case"popover":Hi("beforetoggle",a),Hi("toggle",a),oi(a,"popover",m);break;case"xlinkActuate":_r(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":_r(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":_r(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":_r(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":_r(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":_r(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":_r(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":_r(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":_r(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":oi(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Ua.get(c)||c,oi(a,c,m))}}function d_(a,o,c,m,C,D){switch(c){case"style":_l(a,m,D);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(c=m.__html,c!=null){if(C.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof m=="string"?Oi(a,m):(typeof m=="number"||typeof m=="bigint")&&Oi(a,""+m);break;case"onScroll":m!=null&&Hi("scroll",a);break;case"onScrollEnd":m!=null&&Hi("scrollend",a);break;case"onClick":m!=null&&(a.onclick=kn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fs.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(C=c.endsWith("Capture"),o=c.slice(2,C?c.length-7:void 0),D=a[Yi]||null,D=D!=null?D[c]:null,typeof D=="function"&&a.removeEventListener(o,D,C),typeof m=="function")){typeof D!="function"&&D!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(o,m,C);break e}c in a?a[c]=m:m===!0?a.setAttribute(c,""):oi(a,c,m)}}}function yo(a,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Hi("error",a),Hi("load",a);var m=!1,C=!1,D;for(D in c)if(c.hasOwnProperty(D)){var Z=c[D];if(Z!=null)switch(D){case"src":m=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Ur(a,o,D,Z,c,null)}}C&&Ur(a,o,"srcSet",c.srcSet,c,null),m&&Ur(a,o,"src",c.src,c,null);return;case"input":Hi("invalid",a);var we=D=Z=C=null,Ke=null,pt=null;for(m in c)if(c.hasOwnProperty(m)){var kt=c[m];if(kt!=null)switch(m){case"name":C=kt;break;case"type":Z=kt;break;case"checked":Ke=kt;break;case"defaultChecked":pt=kt;break;case"value":D=kt;break;case"defaultValue":we=kt;break;case"children":case"dangerouslySetInnerHTML":if(kt!=null)throw Error(n(137,o));break;default:Ur(a,o,m,kt,c,null)}}Bl(a,D,we,Ke,pt,Z,C,!1);return;case"select":Hi("invalid",a),m=Z=D=null;for(C in c)if(c.hasOwnProperty(C)&&(we=c[C],we!=null))switch(C){case"value":D=we;break;case"defaultValue":Z=we;break;case"multiple":m=we;default:Ur(a,o,C,we,c,null)}o=D,c=Z,a.multiple=!!m,o!=null?br(a,!!m,o,!1):c!=null&&br(a,!!m,c,!0);return;case"textarea":Hi("invalid",a),D=C=m=null;for(Z in c)if(c.hasOwnProperty(Z)&&(we=c[Z],we!=null))switch(Z){case"value":m=we;break;case"defaultValue":C=we;break;case"children":D=we;break;case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(91));break;default:Ur(a,o,Z,we,c,null)}ia(a,m,C,D);return;case"option":for(Ke in c)if(c.hasOwnProperty(Ke)&&(m=c[Ke],m!=null))switch(Ke){case"selected":a.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Ur(a,o,Ke,m,c,null)}return;case"dialog":Hi("beforetoggle",a),Hi("toggle",a),Hi("cancel",a),Hi("close",a);break;case"iframe":case"object":Hi("load",a);break;case"video":case"audio":for(m=0;m<ng.length;m++)Hi(ng[m],a);break;case"image":Hi("error",a),Hi("load",a);break;case"details":Hi("toggle",a);break;case"embed":case"source":case"link":Hi("error",a),Hi("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pt in c)if(c.hasOwnProperty(pt)&&(m=c[pt],m!=null))switch(pt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Ur(a,o,pt,m,c,null)}return;default:if(zo(o)){for(kt in c)c.hasOwnProperty(kt)&&(m=c[kt],m!==void 0&&d_(a,o,kt,m,c,void 0));return}}for(we in c)c.hasOwnProperty(we)&&(m=c[we],m!=null&&Ur(a,o,we,m,c,null))}function kN(a,o,c,m){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,D=null,Z=null,we=null,Ke=null,pt=null,kt=null;for(xt in c){var Nt=c[xt];if(c.hasOwnProperty(xt)&&Nt!=null)switch(xt){case"checked":break;case"value":break;case"defaultValue":Ke=Nt;default:m.hasOwnProperty(xt)||Ur(a,o,xt,null,m,Nt)}}for(var yt in m){var xt=m[yt];if(Nt=c[yt],m.hasOwnProperty(yt)&&(xt!=null||Nt!=null))switch(yt){case"type":D=xt;break;case"name":C=xt;break;case"checked":pt=xt;break;case"defaultChecked":kt=xt;break;case"value":Z=xt;break;case"defaultValue":we=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(n(137,o));break;default:xt!==Nt&&Ur(a,o,yt,xt,m,Nt)}}jo(a,Z,we,Ke,pt,kt,D,C);return;case"select":xt=Z=we=yt=null;for(D in c)if(Ke=c[D],c.hasOwnProperty(D)&&Ke!=null)switch(D){case"value":break;case"multiple":xt=Ke;default:m.hasOwnProperty(D)||Ur(a,o,D,null,m,Ke)}for(C in m)if(D=m[C],Ke=c[C],m.hasOwnProperty(C)&&(D!=null||Ke!=null))switch(C){case"value":yt=D;break;case"defaultValue":we=D;break;case"multiple":Z=D;default:D!==Ke&&Ur(a,o,C,D,m,Ke)}o=we,c=Z,m=xt,yt!=null?br(a,!!c,yt,!1):!!m!=!!c&&(o!=null?br(a,!!c,o,!0):br(a,!!c,c?[]:"",!1));return;case"textarea":xt=yt=null;for(we in c)if(C=c[we],c.hasOwnProperty(we)&&C!=null&&!m.hasOwnProperty(we))switch(we){case"value":break;case"children":break;default:Ur(a,o,we,null,m,C)}for(Z in m)if(C=m[Z],D=c[Z],m.hasOwnProperty(Z)&&(C!=null||D!=null))switch(Z){case"value":yt=C;break;case"defaultValue":xt=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(n(91));break;default:C!==D&&Ur(a,o,Z,C,m,D)}yl(a,yt,xt);return;case"option":for(var yn in c)if(yt=c[yn],c.hasOwnProperty(yn)&&yt!=null&&!m.hasOwnProperty(yn))switch(yn){case"selected":a.selected=!1;break;default:Ur(a,o,yn,null,m,yt)}for(Ke in m)if(yt=m[Ke],xt=c[Ke],m.hasOwnProperty(Ke)&&yt!==xt&&(yt!=null||xt!=null))switch(Ke){case"selected":a.selected=yt&&typeof yt!="function"&&typeof yt!="symbol";break;default:Ur(a,o,Ke,yt,m,xt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yn in c)yt=c[Yn],c.hasOwnProperty(Yn)&&yt!=null&&!m.hasOwnProperty(Yn)&&Ur(a,o,Yn,null,m,yt);for(pt in m)if(yt=m[pt],xt=c[pt],m.hasOwnProperty(pt)&&yt!==xt&&(yt!=null||xt!=null))switch(pt){case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(n(137,o));break;default:Ur(a,o,pt,yt,m,xt)}return;default:if(zo(o)){for(var Br in c)yt=c[Br],c.hasOwnProperty(Br)&&yt!==void 0&&!m.hasOwnProperty(Br)&&d_(a,o,Br,void 0,m,yt);for(kt in m)yt=m[kt],xt=c[kt],!m.hasOwnProperty(kt)||yt===xt||yt===void 0&&xt===void 0||d_(a,o,kt,yt,m,xt);return}}for(var rt in c)yt=c[rt],c.hasOwnProperty(rt)&&yt!=null&&!m.hasOwnProperty(rt)&&Ur(a,o,rt,null,m,yt);for(Nt in m)yt=m[Nt],xt=c[Nt],!m.hasOwnProperty(Nt)||yt===xt||yt==null&&xt==null||Ur(a,o,Nt,yt,m,xt)}function V5(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function CN(){if(typeof performance.getEntriesByType=="function"){for(var a=0,o=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var C=c[m],D=C.transferSize,Z=C.initiatorType,we=C.duration;if(D&&we&&V5(Z)){for(Z=0,we=C.responseEnd,m+=1;m<c.length;m++){var Ke=c[m],pt=Ke.startTime;if(pt>we)break;var kt=Ke.transferSize,Nt=Ke.initiatorType;kt&&V5(Nt)&&(Ke=Ke.responseEnd,Z+=kt*(Ke<we?1:(we-pt)/(Ke-pt)))}if(--m,o+=8*(D+Z)/(C.duration/1e3),a++,10<a)break}}if(0<a)return o/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var f_=null,p_=null;function wy(a){return a.nodeType===9?a:a.ownerDocument}function z5(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U5(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function g_(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var m_=null;function RN(){var a=window.event;return a&&a.type==="popstate"?a===m_?!1:(m_=a,!0):(m_=null,!1)}var B5=typeof setTimeout=="function"?setTimeout:void 0,LN=typeof clearTimeout=="function"?clearTimeout:void 0,$5=typeof Promise=="function"?Promise:void 0,DN=typeof queueMicrotask=="function"?queueMicrotask:typeof $5<"u"?function(a){return $5.resolve(null).then(a).catch(NN)}:B5;function NN(a){setTimeout(function(){throw a})}function bh(a){return a==="head"}function G5(a,o){var c=o,m=0;do{var C=c.nextSibling;if(a.removeChild(c),C&&C.nodeType===8)if(c=C.data,c==="/$"||c==="/&"){if(m===0){a.removeChild(C),Cf(o);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")rg(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,rg(c);for(var D=c.firstChild;D;){var Z=D.nextSibling,we=D.nodeName;D[es]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&D.rel.toLowerCase()==="stylesheet"||c.removeChild(D),D=Z}}else c==="body"&&rg(a.ownerDocument.body);c=C}while(c);Cf(o)}function H5(a,o){var c=a;a=0;do{var m=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=m}while(c)}function y_(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":y_(c),to(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function PN(a,o,c,m){for(;a.nodeType===1;){var C=c;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[es])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(D=a.getAttribute("rel"),D==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(D!==C.rel||a.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||a.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||a.getAttribute("title")!==(C.title==null?null:C.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(D=a.getAttribute("src"),(D!==(C.src==null?null:C.src)||a.getAttribute("type")!==(C.type==null?null:C.type)||a.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&D&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var D=C.name==null?null:""+C.name;if(C.type==="hidden"&&a.getAttribute("name")===D)return a}else return a;if(a=Zl(a.nextSibling),a===null)break}return null}function ON(a,o,c){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Zl(a.nextSibling),a===null))return null;return a}function K5(a,o){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=Zl(a.nextSibling),a===null))return null;return a}function v_(a){return a.data==="$?"||a.data==="$~"}function __(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function MN(a,o){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=o;else if(a.data!=="$?"||c.readyState!=="loading")o();else{var m=function(){o(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),a._reactRetry=m}}function Zl(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return a}var b_=null;function W5(a){a=a.nextSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(o===0)return Zl(a.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}a=a.nextSibling}return null}function q5(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return a;o--}else c!=="/$"&&c!=="/&"||o++}a=a.previousSibling}return null}function Y5(a,o,c){switch(o=wy(c),a){case"html":if(a=o.documentElement,!a)throw Error(n(452));return a;case"head":if(a=o.head,!a)throw Error(n(453));return a;case"body":if(a=o.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function rg(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);to(a)}var eu=new Map,X5=new Set;function Sy(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Dc=Je.d;Je.d={f:FN,r:jN,D:VN,C:zN,L:UN,m:BN,X:GN,S:$N,M:HN};function FN(){var a=Dc.f(),o=py();return a||o}function jN(a){var o=Os(a);o!==null&&o.tag===5&&o.type==="form"?fS(o):Dc.r(a)}var Ef=typeof document>"u"?null:document;function J5(a,o,c){var m=Ef;if(m&&typeof o=="string"&&o){var C=Lr(o);C='link[rel="'+a+'"][href="'+C+'"]',typeof c=="string"&&(C+='[crossorigin="'+c+'"]'),X5.has(C)||(X5.add(C),a={rel:a,crossOrigin:c,href:o},m.querySelector(C)===null&&(o=m.createElement("link"),yo(o,"link",a),hr(o),m.head.appendChild(o)))}}function VN(a){Dc.D(a),J5("dns-prefetch",a,null)}function zN(a,o){Dc.C(a,o),J5("preconnect",a,o)}function UN(a,o,c){Dc.L(a,o,c);var m=Ef;if(m&&a&&o){var C='link[rel="preload"][as="'+Lr(o)+'"]';o==="image"&&c&&c.imageSrcSet?(C+='[imagesrcset="'+Lr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(C+='[imagesizes="'+Lr(c.imageSizes)+'"]')):C+='[href="'+Lr(a)+'"]';var D=C;switch(o){case"style":D=If(a);break;case"script":D=kf(a)}eu.has(D)||(a=g({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:a,as:o},c),eu.set(D,a),m.querySelector(C)!==null||o==="style"&&m.querySelector(sg(D))||o==="script"&&m.querySelector(ag(D))||(o=m.createElement("link"),yo(o,"link",a),hr(o),m.head.appendChild(o)))}}function BN(a,o){Dc.m(a,o);var c=Ef;if(c&&a){var m=o&&typeof o.as=="string"?o.as:"script",C='link[rel="modulepreload"][as="'+Lr(m)+'"][href="'+Lr(a)+'"]',D=C;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=kf(a)}if(!eu.has(D)&&(a=g({rel:"modulepreload",href:a},o),eu.set(D,a),c.querySelector(C)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ag(D)))return}m=c.createElement("link"),yo(m,"link",a),hr(m),c.head.appendChild(m)}}}function $N(a,o,c){Dc.S(a,o,c);var m=Ef;if(m&&a){var C=Ms(m).hoistableStyles,D=If(a);o=o||"default";var Z=C.get(D);if(!Z){var we={loading:0,preload:null};if(Z=m.querySelector(sg(D)))we.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":o},c),(c=eu.get(D))&&x_(a,c);var Ke=Z=m.createElement("link");hr(Ke),yo(Ke,"link",a),Ke._p=new Promise(function(pt,kt){Ke.onload=pt,Ke.onerror=kt}),Ke.addEventListener("load",function(){we.loading|=1}),Ke.addEventListener("error",function(){we.loading|=2}),we.loading|=4,Ty(Z,o,m)}Z={type:"stylesheet",instance:Z,count:1,state:we},C.set(D,Z)}}}function GN(a,o){Dc.X(a,o);var c=Ef;if(c&&a){var m=Ms(c).hoistableScripts,C=kf(a),D=m.get(C);D||(D=c.querySelector(ag(C)),D||(a=g({src:a,async:!0},o),(o=eu.get(C))&&w_(a,o),D=c.createElement("script"),hr(D),yo(D,"link",a),c.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},m.set(C,D))}}function HN(a,o){Dc.M(a,o);var c=Ef;if(c&&a){var m=Ms(c).hoistableScripts,C=kf(a),D=m.get(C);D||(D=c.querySelector(ag(C)),D||(a=g({src:a,async:!0,type:"module"},o),(o=eu.get(C))&&w_(a,o),D=c.createElement("script"),hr(D),yo(D,"link",a),c.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},m.set(C,D))}}function Q5(a,o,c,m){var C=(C=$e.current)?Sy(C):null;if(!C)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=If(c.href),c=Ms(C).hoistableStyles,m=c.get(o),m||(m={type:"style",instance:null,count:0,state:null},c.set(o,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=If(c.href);var D=Ms(C).hoistableStyles,Z=D.get(a);if(Z||(C=C.ownerDocument||C,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(a,Z),(D=C.querySelector(sg(a)))&&!D._p&&(Z.instance=D,Z.state.loading=5),eu.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},eu.set(a,c),D||KN(C,a,c,Z.state))),o&&m===null)throw Error(n(528,""));return Z}if(o&&m!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=kf(c),c=Ms(C).hoistableScripts,m=c.get(o),m||(m={type:"script",instance:null,count:0,state:null},c.set(o,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function If(a){return'href="'+Lr(a)+'"'}function sg(a){return'link[rel="stylesheet"]['+a+"]"}function Z5(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function KN(a,o,c,m){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?m.loading=1:(o=a.createElement("link"),m.preload=o,o.addEventListener("load",function(){return m.loading|=1}),o.addEventListener("error",function(){return m.loading|=2}),yo(o,"link",c),hr(o),a.head.appendChild(o))}function kf(a){return'[src="'+Lr(a)+'"]'}function ag(a){return"script[async]"+a}function eT(a,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var m=a.querySelector('style[data-href~="'+Lr(c.href)+'"]');if(m)return o.instance=m,hr(m),m;var C=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),hr(m),yo(m,"style",C),Ty(m,c.precedence,a),o.instance=m;case"stylesheet":C=If(c.href);var D=a.querySelector(sg(C));if(D)return o.state.loading|=4,o.instance=D,hr(D),D;m=Z5(c),(C=eu.get(C))&&x_(m,C),D=(a.ownerDocument||a).createElement("link"),hr(D);var Z=D;return Z._p=new Promise(function(we,Ke){Z.onload=we,Z.onerror=Ke}),yo(D,"link",m),o.state.loading|=4,Ty(D,c.precedence,a),o.instance=D;case"script":return D=kf(c.src),(C=a.querySelector(ag(D)))?(o.instance=C,hr(C),C):(m=c,(C=eu.get(D))&&(m=g({},c),w_(m,C)),a=a.ownerDocument||a,C=a.createElement("script"),hr(C),yo(C,"link",m),a.head.appendChild(C),o.instance=C);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(m=o.instance,o.state.loading|=4,Ty(m,c.precedence,a));return o.instance}function Ty(a,o,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=m.length?m[m.length-1]:null,D=C,Z=0;Z<m.length;Z++){var we=m[Z];if(we.dataset.precedence===o)D=we;else if(D!==C)break}D?D.parentNode.insertBefore(a,D.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(a,o.firstChild))}function x_(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function w_(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var Ay=null;function tT(a,o,c){if(Ay===null){var m=new Map,C=Ay=new Map;C.set(c,m)}else C=Ay,m=C.get(c),m||(m=new Map,C.set(c,m));if(m.has(a))return m;for(m.set(a,null),c=c.getElementsByTagName(a),C=0;C<c.length;C++){var D=c[C];if(!(D[es]||D[qi]||a==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=D.getAttribute(o)||"";Z=a+Z;var we=m.get(Z);we?we.push(D):m.set(Z,[D])}}return m}function nT(a,o,c){a=a.ownerDocument||a,a.head.insertBefore(c,o==="title"?a.querySelector("head > title"):null)}function WN(a,o,c){if(c===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function iT(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function qN(a,o,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var C=If(m.href),D=o.querySelector(sg(C));if(D){o=D._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(a.count++,a=Ey.bind(a),o.then(a,a)),c.state.loading|=4,c.instance=D,hr(D);return}D=o.ownerDocument||o,m=Z5(m),(C=eu.get(C))&&x_(m,C),D=D.createElement("link"),hr(D);var Z=D;Z._p=new Promise(function(we,Ke){Z.onload=we,Z.onerror=Ke}),yo(D,"link",m),c.instance=D}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=Ey.bind(a),o.addEventListener("load",c),o.addEventListener("error",c))}}var S_=0;function YN(a,o){return a.stylesheets&&a.count===0&&ky(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var m=setTimeout(function(){if(a.stylesheets&&ky(a,a.stylesheets),a.unsuspend){var D=a.unsuspend;a.unsuspend=null,D()}},6e4+o);0<a.imgBytes&&S_===0&&(S_=62500*CN());var C=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&ky(a,a.stylesheets),a.unsuspend)){var D=a.unsuspend;a.unsuspend=null,D()}},(a.imgBytes>S_?50:800)+o);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(m),clearTimeout(C)}}:null}function Ey(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ky(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Iy=null;function ky(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Iy=new Map,o.forEach(XN,a),Iy=null,Ey.call(a))}function XN(a,o){if(!(o.state.loading&4)){var c=Iy.get(a);if(c)var m=c.get(null);else{c=new Map,Iy.set(a,c);for(var C=a.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<C.length;D++){var Z=C[D];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(c.set(Z.dataset.precedence,Z),m=Z)}m&&c.set(null,m)}C=o.instance,Z=C.getAttribute("data-precedence"),D=c.get(Z)||m,D===m&&c.set(null,C),c.set(Z,C),this.count++,m=Ey.bind(this),C.addEventListener("load",m),C.addEventListener("error",m),D?D.parentNode.insertBefore(C,D.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(C,a.firstChild)),o.state.loading|=4}}var og={$$typeof:he,Provider:null,Consumer:null,_currentValue:qe,_currentValue2:qe,_threadCount:0};function JN(a,o,c,m,C,D,Z,we,Ke){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ci(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ci(0),this.hiddenUpdates=Ci(null),this.identifierPrefix=m,this.onUncaughtError=C,this.onCaughtError=D,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ke,this.incompleteTransitions=new Map}function rT(a,o,c,m,C,D,Z,we,Ke,pt,kt,Nt){return a=new JN(a,o,c,Z,Ke,pt,kt,Nt,we),o=1,D===!0&&(o|=24),D=aa(3,null,null,o),a.current=D,D.stateNode=a,o=U(),o.refCount++,a.pooledCache=o,o.refCount++,D.memoizedState={element:m,isDehydrated:c,cache:o},Gt(D),a}function sT(a){return a?(a=Hs,a):Hs}function aT(a,o,c,m,C,D){C=sT(C),m.context===null?m.context=C:m.pendingContext=C,m=Ln(o),m.payload={element:c},D=D===void 0?null:D,D!==null&&(m.callback=D),c=Nn(a,m,o),c!==null&&(dl(c,a,o),ur(c,a,o))}function oT(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<o?c:o}}function T_(a,o){oT(a,o),(a=a.alternate)&&oT(a,o)}function lT(a){if(a.tag===13||a.tag===31){var o=uo(a,67108864);o!==null&&dl(o,a,67108864),T_(a,67108864)}}function uT(a){if(a.tag===13||a.tag===31){var o=Nl();o=Pi(o);var c=uo(a,o);c!==null&&dl(c,a,o),T_(a,o)}}var Cy=!0;function QN(a,o,c,m){var C=je.T;je.T=null;var D=Je.p;try{Je.p=2,A_(a,o,c,m)}finally{Je.p=D,je.T=C}}function ZN(a,o,c,m){var C=je.T;je.T=null;var D=Je.p;try{Je.p=8,A_(a,o,c,m)}finally{Je.p=D,je.T=C}}function A_(a,o,c,m){if(Cy){var C=E_(m);if(C===null)h_(a,o,m,Ry,c),hT(a,m);else if(tP(C,a,o,c,m))m.stopPropagation();else if(hT(a,m),o&4&&-1<eP.indexOf(a)){for(;C!==null;){var D=Os(C);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var Z=Ht(D.pendingLanes);if(Z!==0){var we=D;for(we.pendingLanes|=2,we.entangledLanes|=2;Z;){var Ke=1<<31-qn(Z);we.entanglements[1]|=Ke,Z&=~Ke}Hu(D),(wr&6)===0&&(dy=Un()+500,tg(0))}}break;case 31:case 13:we=uo(D,2),we!==null&&dl(we,D,2),py(),T_(D,2)}if(D=E_(m),D===null&&h_(a,o,m,Ry,c),D===C)break;C=D}C!==null&&m.stopPropagation()}else h_(a,o,m,null,c)}}function E_(a){return a=or(a),I_(a)}var Ry=null;function I_(a){if(Ry=null,a=Ps(a),a!==null){var o=s(a);if(o===null)a=null;else{var c=o.tag;if(c===13){if(a=l(o),a!==null)return a;a=null}else if(c===31){if(a=u(o),a!==null)return a;a=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return Ry=a,null}function cT(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ii()){case Bn:return 2;case li:return 8;case Xn:case ln:return 32;case $n:return 268435456;default:return 32}default:return 32}}var k_=!1,xh=null,wh=null,Sh=null,lg=new Map,ug=new Map,Th=[],eP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hT(a,o){switch(a){case"focusin":case"focusout":xh=null;break;case"dragenter":case"dragleave":wh=null;break;case"mouseover":case"mouseout":Sh=null;break;case"pointerover":case"pointerout":lg.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ug.delete(o.pointerId)}}function cg(a,o,c,m,C,D){return a===null||a.nativeEvent!==D?(a={blockedOn:o,domEventName:c,eventSystemFlags:m,nativeEvent:D,targetContainers:[C]},o!==null&&(o=Os(o),o!==null&&lT(o)),a):(a.eventSystemFlags|=m,o=a.targetContainers,C!==null&&o.indexOf(C)===-1&&o.push(C),a)}function tP(a,o,c,m,C){switch(o){case"focusin":return xh=cg(xh,a,o,c,m,C),!0;case"dragenter":return wh=cg(wh,a,o,c,m,C),!0;case"mouseover":return Sh=cg(Sh,a,o,c,m,C),!0;case"pointerover":var D=C.pointerId;return lg.set(D,cg(lg.get(D)||null,a,o,c,m,C)),!0;case"gotpointercapture":return D=C.pointerId,ug.set(D,cg(ug.get(D)||null,a,o,c,m,C)),!0}return!1}function dT(a){var o=Ps(a.target);if(o!==null){var c=s(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){a.blockedOn=o,os(a.priority,function(){uT(c)});return}}else if(o===31){if(o=u(c),o!==null){a.blockedOn=o,os(a.priority,function(){uT(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Ly(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var c=E_(a.nativeEvent);if(c===null){c=a.nativeEvent;var m=new c.constructor(c.type,c);xi=m,c.target.dispatchEvent(m),xi=null}else return o=Os(c),o!==null&&lT(o),a.blockedOn=c,!1;o.shift()}return!0}function fT(a,o,c){Ly(a)&&c.delete(o)}function nP(){k_=!1,xh!==null&&Ly(xh)&&(xh=null),wh!==null&&Ly(wh)&&(wh=null),Sh!==null&&Ly(Sh)&&(Sh=null),lg.forEach(fT),ug.forEach(fT)}function Dy(a,o){a.blockedOn===o&&(a.blockedOn=null,k_||(k_=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,nP)))}var Ny=null;function pT(a){Ny!==a&&(Ny=a,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Ny===a&&(Ny=null);for(var o=0;o<a.length;o+=3){var c=a[o],m=a[o+1],C=a[o+2];if(typeof m!="function"){if(I_(m||c)===null)continue;break}var D=Os(c);D!==null&&(a.splice(o,3),o-=3,Ev(D,{pending:!0,data:C,method:c.method,action:m},m,C))}}))}function Cf(a){function o(Ke){return Dy(Ke,a)}xh!==null&&Dy(xh,a),wh!==null&&Dy(wh,a),Sh!==null&&Dy(Sh,a),lg.forEach(o),ug.forEach(o);for(var c=0;c<Th.length;c++){var m=Th[c];m.blockedOn===a&&(m.blockedOn=null)}for(;0<Th.length&&(c=Th[0],c.blockedOn===null);)dT(c),c.blockedOn===null&&Th.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var C=c[m],D=c[m+1],Z=C[Yi]||null;if(typeof D=="function")Z||pT(c);else if(Z){var we=null;if(D&&D.hasAttribute("formAction")){if(C=D,Z=D[Yi]||null)we=Z.formAction;else if(I_(C)!==null)continue}else we=Z.action;typeof we=="function"?c[m+1]=we:(c.splice(m,3),m-=3),pT(c)}}}function gT(){function a(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(Z){return C=Z})},focusReset:"manual",scroll:"manual"})}function o(){C!==null&&(C(),C=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,C=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),C!==null&&(C(),C=null)}}}function C_(a){this._internalRoot=a}Py.prototype.render=C_.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,m=Nl();aT(c,m,a,o,null,null)},Py.prototype.unmount=C_.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;aT(a.current,2,null,a,null,null),py(),o[Kr]=null}};function Py(a){this._internalRoot=a}Py.prototype.unstable_scheduleHydration=function(a){if(a){var o=cr();a={blockedOn:null,target:a,priority:o};for(var c=0;c<Th.length&&o!==0&&o<Th[c].priority;c++);Th.splice(c,0,a),c===0&&dT(a)}};var mT=e.version;if(mT!=="19.2.0")throw Error(n(527,mT,"19.2.0"));Je.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=f(o),a=a!==null?x(a):null,a=a===null?null:a.stateNode,a};var iP={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:je,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oy.isDisabled&&Oy.supportsFiber)try{Jn=Oy.inject(iP),mn=Oy}catch{}}return dg.createRoot=function(a,o){if(!r(a))throw Error(n(299));var c=!1,m="",C=SS,D=TS,Z=AS;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(C=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(Z=o.onRecoverableError)),o=rT(a,1,!1,null,null,c,m,null,C,D,Z,gT),a[Kr]=o.current,c_(a),new C_(o)},dg.hydrateRoot=function(a,o,c){if(!r(a))throw Error(n(299));var m=!1,C="",D=SS,Z=TS,we=AS,Ke=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(C=c.identifierPrefix),c.onUncaughtError!==void 0&&(D=c.onUncaughtError),c.onCaughtError!==void 0&&(Z=c.onCaughtError),c.onRecoverableError!==void 0&&(we=c.onRecoverableError),c.formState!==void 0&&(Ke=c.formState)),o=rT(a,1,!0,o,c??null,m,C,Ke,D,Z,we,gT),o.context=sT(null),c=o.current,m=Nl(),m=Pi(m),C=Ln(m),C.callback=null,Nn(c,C,m),c=m,o.current.lanes=c,dn(o,c),Hu(o),a[Kr]=o.current,c_(a),new Py(o)},dg.version="19.2.0",dg}var ET;function pP(){if(ET)return D_.exports;ET=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),D_.exports=fP(),D_.exports}var gP=pP();var IT="popstate";function mP(i={}){function e(n,r){let{pathname:s,search:l,hash:u}=n.location;return Ob("",{pathname:s,search:l,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(n,r){return typeof r=="string"?r:nm(r)}return vP(e,t,null,i)}function Ns(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function lu(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yP(){return Math.random().toString(36).substring(2,10)}function kT(i,e){return{usr:i.state,key:i.key,idx:e}}function Ob(i,e,t=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Rp(e):e,state:t,key:e&&e.key||n||yP()}}function nm({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Rp(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let n=i.indexOf("?");n>=0&&(e.search=i.substring(n),i=i.substring(0,n)),i&&(e.pathname=i)}return e}function vP(i,e,t,n={}){let{window:r=document.defaultView,v5Compat:s=!1}=n,l=r.history,u="POP",h=null,f=x();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function x(){return(l.state||{idx:null}).idx}function g(){u="POP";let W=x(),q=W==null?null:W-f;f=W,h&&h({action:u,location:$.location,delta:q})}function w(W,q){u="PUSH";let ge=Ob($.location,W,q);f=x()+1;let he=kT(ge,f),me=$.createHref(ge);try{l.pushState(he,"",me)}catch(Ce){if(Ce instanceof DOMException&&Ce.name==="DataCloneError")throw Ce;r.location.assign(me)}s&&h&&h({action:u,location:$.location,delta:1})}function A(W,q){u="REPLACE";let ge=Ob($.location,W,q);f=x();let he=kT(ge,f),me=$.createHref(ge);l.replaceState(he,"",me),s&&h&&h({action:u,location:$.location,delta:0})}function B(W){return _P(W)}let $={get action(){return u},get location(){return i(r,l)},listen(W){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(IT,g),h=W,()=>{r.removeEventListener(IT,g),h=null}},createHref(W){return e(r,W)},createURL:B,encodeLocation(W){let q=B(W);return{pathname:q.pathname,search:q.search,hash:q.hash}},push:w,replace:A,go(W){return l.go(W)}};return $}function _P(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ns(t,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:nm(i);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Gk(i,e,t="/"){return bP(i,e,t,!1)}function bP(i,e,t,n){let r=typeof e=="string"?Rp(e):e,s=Wc(r.pathname||"/",t);if(s==null)return null;let l=Hk(i);xP(l);let u=null;for(let h=0;u==null&&h<l.length;++h){let f=DP(s);u=RP(l[h],f,n)}return u}function Hk(i,e=[],t=[],n="",r=!1){let s=(l,u,h=r,f)=>{let x={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(n)&&h)return;Ns(x.relativePath.startsWith(n),`Absolute route path "${x.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(n.length)}let g=Gc([n,x.relativePath]),w=t.concat(x);l.children&&l.children.length>0&&(Ns(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),Hk(l.children,e,w,g,h)),!(l.path==null&&!l.index)&&e.push({path:g,score:kP(g,l.index),routesMeta:w})};return i.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))s(l,u);else for(let h of Kk(l.path))s(l,u,!0,h)}),e}function Kk(i){let e=i.split("/");if(e.length===0)return[];let[t,...n]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return r?[s,""]:[s];let l=Kk(n.join("/")),u=[];return u.push(...l.map(h=>h===""?s:[s,h].join("/"))),r&&u.push(...l),u.map(h=>i.startsWith("/")&&h===""?"/":h)}function xP(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:CP(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var wP=/^:[\w-]+$/,SP=3,TP=2,AP=1,EP=10,IP=-2,CT=i=>i==="*";function kP(i,e){let t=i.split("/"),n=t.length;return t.some(CT)&&(n+=IP),e&&(n+=TP),t.filter(r=>!CT(r)).reduce((r,s)=>r+(wP.test(s)?SP:s===""?AP:EP),n)}function CP(i,e){return i.length===e.length&&i.slice(0,-1).every((n,r)=>n===e[r])?i[i.length-1]-e[e.length-1]:0}function RP(i,e,t=!1){let{routesMeta:n}=i,r={},s="/",l=[];for(let u=0;u<n.length;++u){let h=n[u],f=u===n.length-1,x=s==="/"?e:e.slice(s.length)||"/",g=M0({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},x),w=h.route;if(!g&&f&&t&&!n[n.length-1].route.index&&(g=M0({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},x)),!g)return null;Object.assign(r,g.params),l.push({params:r,pathname:Gc([s,g.pathname]),pathnameBase:FP(Gc([s,g.pathnameBase])),route:w}),g.pathnameBase!=="/"&&(s=Gc([s,g.pathnameBase]))}return l}function M0(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,n]=LP(i.path,i.caseSensitive,i.end),r=e.match(t);if(!r)return null;let s=r[0],l=s.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:n.reduce((f,{paramName:x,isOptional:g},w)=>{if(x==="*"){let B=u[w]||"";l=s.slice(0,s.length-B.length).replace(/(.)\/+$/,"$1")}const A=u[w];return g&&!A?f[x]=void 0:f[x]=(A||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:l,pattern:i}}function LP(i,e=!1,t=!0){lu(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],r="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(n.push({paramName:"*"}),r+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":i!==""&&i!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),n]}function DP(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return lu(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Wc(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=i.charAt(t);return n&&n!=="/"?null:i.slice(t)||"/"}var NP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,PP=i=>NP.test(i);function OP(i,e="/"){let{pathname:t,search:n="",hash:r=""}=typeof i=="string"?Rp(i):i,s;if(t)if(PP(t))s=t;else{if(t.includes("//")){let l=t;t=t.replace(/\/\/+/g,"/"),lu(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${t}`)}t.startsWith("/")?s=RT(t.substring(1),"/"):s=RT(t,e)}else s=e;return{pathname:s,search:jP(n),hash:VP(r)}}function RT(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function M_(i,e,t,n){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function MP(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Wk(i){let e=MP(i);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function qk(i,e,t,n=!1){let r;typeof i=="string"?r=Rp(i):(r={...i},Ns(!r.pathname||!r.pathname.includes("?"),M_("?","pathname","search",r)),Ns(!r.pathname||!r.pathname.includes("#"),M_("#","pathname","hash",r)),Ns(!r.search||!r.search.includes("#"),M_("#","search","hash",r)));let s=i===""||r.pathname==="",l=s?"/":r.pathname,u;if(l==null)u=t;else{let g=e.length-1;if(!n&&l.startsWith("..")){let w=l.split("/");for(;w[0]==="..";)w.shift(),g-=1;r.pathname=w.join("/")}u=g>=0?e[g]:"/"}let h=OP(r,u),f=l&&l!=="/"&&l.endsWith("/"),x=(s||l===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(f||x)&&(h.pathname+="/"),h}var Gc=i=>i.join("/").replace(/\/\/+/g,"/"),FP=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),jP=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,VP=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function zP(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Yk=["POST","PUT","PATCH","DELETE"];new Set(Yk);var UP=["GET",...Yk];new Set(UP);var Lp=Te.createContext(null);Lp.displayName="DataRouter";var L1=Te.createContext(null);L1.displayName="DataRouterState";Te.createContext(!1);var Xk=Te.createContext({isTransitioning:!1});Xk.displayName="ViewTransition";var BP=Te.createContext(new Map);BP.displayName="Fetchers";var $P=Te.createContext(null);$P.displayName="Await";var sc=Te.createContext(null);sc.displayName="Navigation";var Rm=Te.createContext(null);Rm.displayName="Location";var th=Te.createContext({outlet:null,matches:[],isDataRoute:!1});th.displayName="Route";var e2=Te.createContext(null);e2.displayName="RouteError";function GP(i,{relative:e}={}){Ns(Lm(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=Te.useContext(sc),{hash:r,pathname:s,search:l}=Dm(i,{relative:e}),u=s;return t!=="/"&&(u=s==="/"?t:Gc([t,s])),n.createHref({pathname:u,search:l,hash:r})}function Lm(){return Te.useContext(Rm)!=null}function od(){return Ns(Lm(),"useLocation() may be used only in the context of a <Router> component."),Te.useContext(Rm).location}var Jk="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Qk(i){Te.useContext(sc).static||Te.useLayoutEffect(i)}function Dp(){let{isDataRoute:i}=Te.useContext(th);return i?iO():HP()}function HP(){Ns(Lm(),"useNavigate() may be used only in the context of a <Router> component.");let i=Te.useContext(Lp),{basename:e,navigator:t}=Te.useContext(sc),{matches:n}=Te.useContext(th),{pathname:r}=od(),s=JSON.stringify(Wk(n)),l=Te.useRef(!1);return Qk(()=>{l.current=!0}),Te.useCallback((h,f={})=>{if(lu(l.current,Jk),!l.current)return;if(typeof h=="number"){t.go(h);return}let x=qk(h,JSON.parse(s),r,f.relative==="path");i==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:Gc([e,x.pathname])),(f.replace?t.replace:t.push)(x,f.state,f)},[e,t,s,r,i])}Te.createContext(null);function Dm(i,{relative:e}={}){let{matches:t}=Te.useContext(th),{pathname:n}=od(),r=JSON.stringify(Wk(t));return Te.useMemo(()=>qk(i,JSON.parse(r),n,e==="path"),[i,r,n,e])}function KP(i,e){return Zk(i,e)}function Zk(i,e,t,n,r){Ns(Lm(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=Te.useContext(sc),{matches:l}=Te.useContext(th),u=l[l.length-1],h=u?u.params:{},f=u?u.pathname:"/",x=u?u.pathnameBase:"/",g=u&&u.route;{let ge=g&&g.path||"";eC(f,!g||ge.endsWith("*")||ge.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${ge}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ge}"> to <Route path="${ge==="/"?"*":`${ge}/*`}">.`)}let w=od(),A;if(e){let ge=typeof e=="string"?Rp(e):e;Ns(x==="/"||ge.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${ge.pathname}" was given in the \`location\` prop.`),A=ge}else A=w;let B=A.pathname||"/",$=B;if(x!=="/"){let ge=x.replace(/^\//,"").split("/");$="/"+B.replace(/^\//,"").split("/").slice(ge.length).join("/")}let W=Gk(i,{pathname:$});lu(g||W!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),lu(W==null||W[W.length-1].route.element!==void 0||W[W.length-1].route.Component!==void 0||W[W.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let q=JP(W&&W.map(ge=>Object.assign({},ge,{params:Object.assign({},h,ge.params),pathname:Gc([x,s.encodeLocation?s.encodeLocation(ge.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ge.pathname]),pathnameBase:ge.pathnameBase==="/"?x:Gc([x,s.encodeLocation?s.encodeLocation(ge.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ge.pathnameBase])})),l,t,n,r);return e&&q?Te.createElement(Rm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},q):q}function WP(){let i=nO(),e=zP(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",i),l=Te.createElement(Te.Fragment,null,Te.createElement("p",null," Hey developer "),Te.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Te.createElement("code",{style:s},"ErrorBoundary")," or"," ",Te.createElement("code",{style:s},"errorElement")," prop on your route.")),Te.createElement(Te.Fragment,null,Te.createElement("h2",null,"Unexpected Application Error!"),Te.createElement("h3",{style:{fontStyle:"italic"}},e),t?Te.createElement("pre",{style:r},t):null,l)}var qP=Te.createElement(WP,null),YP=class extends Te.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.onError?this.props.onError(i,e):console.error("React Router caught the following error during render",i)}render(){return this.state.error!==void 0?Te.createElement(th.Provider,{value:this.props.routeContext},Te.createElement(e2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function XP({routeContext:i,match:e,children:t}){let n=Te.useContext(Lp);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),Te.createElement(th.Provider,{value:i},t)}function JP(i,e=[],t=null,n=null,r=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let s=i,l=t?.errors;if(l!=null){let x=s.findIndex(g=>g.route.id&&l?.[g.route.id]!==void 0);Ns(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),s=s.slice(0,Math.min(s.length,x+1))}let u=!1,h=-1;if(t)for(let x=0;x<s.length;x++){let g=s[x];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=x),g.route.id){let{loaderData:w,errors:A}=t,B=g.route.loader&&!w.hasOwnProperty(g.route.id)&&(!A||A[g.route.id]===void 0);if(g.route.lazy||B){u=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}let f=t&&n?(x,g)=>{n(x,{location:t.location,params:t.matches?.[0]?.params??{},errorInfo:g})}:void 0;return s.reduceRight((x,g,w)=>{let A,B=!1,$=null,W=null;t&&(A=l&&g.route.id?l[g.route.id]:void 0,$=g.route.errorElement||qP,u&&(h<0&&w===0?(eC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,W=null):h===w&&(B=!0,W=g.route.hydrateFallbackElement||null)));let q=e.concat(s.slice(0,w+1)),ge=()=>{let he;return A?he=$:B?he=W:g.route.Component?he=Te.createElement(g.route.Component,null):g.route.element?he=g.route.element:he=x,Te.createElement(XP,{match:g,routeContext:{outlet:x,matches:q,isDataRoute:t!=null},children:he})};return t&&(g.route.ErrorBoundary||g.route.errorElement||w===0)?Te.createElement(YP,{location:t.location,revalidation:t.revalidation,component:$,error:A,children:ge(),routeContext:{outlet:null,matches:q,isDataRoute:!0},onError:f}):ge()},null)}function t2(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QP(i){let e=Te.useContext(Lp);return Ns(e,t2(i)),e}function ZP(i){let e=Te.useContext(L1);return Ns(e,t2(i)),e}function eO(i){let e=Te.useContext(th);return Ns(e,t2(i)),e}function n2(i){let e=eO(i),t=e.matches[e.matches.length-1];return Ns(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function tO(){return n2("useRouteId")}function nO(){let i=Te.useContext(e2),e=ZP("useRouteError"),t=n2("useRouteError");return i!==void 0?i:e.errors?.[t]}function iO(){let{router:i}=QP("useNavigate"),e=n2("useNavigate"),t=Te.useRef(!1);return Qk(()=>{t.current=!0}),Te.useCallback(async(r,s={})=>{lu(t.current,Jk),t.current&&(typeof r=="number"?i.navigate(r):await i.navigate(r,{fromRouteId:e,...s}))},[i,e])}var LT={};function eC(i,e,t){!e&&!LT[i]&&(LT[i]=!0,lu(!1,t))}Te.memo(rO);function rO({routes:i,future:e,state:t,unstable_onError:n}){return Zk(i,void 0,t,n,e)}function kg(i){Ns(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function sO({basename:i="/",children:e=null,location:t,navigationType:n="POP",navigator:r,static:s=!1}){Ns(!Lm(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=i.replace(/^\/*/,"/"),u=Te.useMemo(()=>({basename:l,navigator:r,static:s,future:{}}),[l,r,s]);typeof t=="string"&&(t=Rp(t));let{pathname:h="/",search:f="",hash:x="",state:g=null,key:w="default"}=t,A=Te.useMemo(()=>{let B=Wc(h,l);return B==null?null:{location:{pathname:B,search:f,hash:x,state:g,key:w},navigationType:n}},[l,h,f,x,g,w,n]);return lu(A!=null,`<Router basename="${l}"> is not able to match the URL "${h}${f}${x}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:Te.createElement(sc.Provider,{value:u},Te.createElement(Rm.Provider,{children:e,value:A}))}function aO({children:i,location:e}){return KP(Mb(i),e)}function Mb(i,e=[]){let t=[];return Te.Children.forEach(i,(n,r)=>{if(!Te.isValidElement(n))return;let s=[...e,r];if(n.type===Te.Fragment){t.push.apply(t,Mb(n.props.children,s));return}Ns(n.type===kg,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ns(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Mb(n.props.children,s)),t.push(l)}),t}var o0="get",l0="application/x-www-form-urlencoded";function D1(i){return i!=null&&typeof i.tagName=="string"}function oO(i){return D1(i)&&i.tagName.toLowerCase()==="button"}function lO(i){return D1(i)&&i.tagName.toLowerCase()==="form"}function uO(i){return D1(i)&&i.tagName.toLowerCase()==="input"}function cO(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function hO(i,e){return i.button===0&&(!e||e==="_self")&&!cO(i)}function Fb(i=""){return new URLSearchParams(typeof i=="string"||Array.isArray(i)||i instanceof URLSearchParams?i:Object.keys(i).reduce((e,t)=>{let n=i[t];return e.concat(Array.isArray(n)?n.map(r=>[t,r]):[[t,n]])},[]))}function dO(i,e){let t=Fb(i);return e&&e.forEach((n,r)=>{t.has(r)||e.getAll(r).forEach(s=>{t.append(r,s)})}),t}var My=null;function fO(){if(My===null)try{new FormData(document.createElement("form"),0),My=!1}catch{My=!0}return My}var pO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function F_(i){return i!=null&&!pO.has(i)?(lu(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${l0}"`),null):i}function gO(i,e){let t,n,r,s,l;if(lO(i)){let u=i.getAttribute("action");n=u?Wc(u,e):null,t=i.getAttribute("method")||o0,r=F_(i.getAttribute("enctype"))||l0,s=new FormData(i)}else if(oO(i)||uO(i)&&(i.type==="submit"||i.type==="image")){let u=i.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=i.getAttribute("formaction")||u.getAttribute("action");if(n=h?Wc(h,e):null,t=i.getAttribute("formmethod")||u.getAttribute("method")||o0,r=F_(i.getAttribute("formenctype"))||F_(u.getAttribute("enctype"))||l0,s=new FormData(u,i),!fO()){let{name:f,type:x,value:g}=i;if(x==="image"){let w=f?`${f}.`:"";s.append(`${w}x`,"0"),s.append(`${w}y`,"0")}else f&&s.append(f,g)}}else{if(D1(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=o0,n=null,r=l0,l=i}return s&&r==="text/plain"&&(l=s,s=void 0),{action:n,method:t.toLowerCase(),encType:r,formData:s,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function i2(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function mO(i,e,t){let n=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&Wc(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function yO(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vO(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function _O(i,e,t){let n=await Promise.all(i.map(async r=>{let s=e.routes[r.route.id];if(s){let l=await yO(s,t);return l.links?l.links():[]}return[]}));return SO(n.flat(1).filter(vO).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function DT(i,e,t,n,r,s){let l=(h,f)=>t[f]?h.route.id!==t[f].route.id:!0,u=(h,f)=>t[f].pathname!==h.pathname||t[f].route.path?.endsWith("*")&&t[f].params["*"]!==h.params["*"];return s==="assets"?e.filter((h,f)=>l(h,f)||u(h,f)):s==="data"?e.filter((h,f)=>{let x=n.routes[h.route.id];if(!x||!x.hasLoader)return!1;if(l(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let g=h.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function bO(i,e,{includeHydrateFallback:t}={}){return xO(i.map(n=>{let r=e.routes[n.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function xO(i){return[...new Set(i)]}function wO(i){let e={},t=Object.keys(i).sort();for(let n of t)e[n]=i[n];return e}function SO(i,e){let t=new Set;return new Set(e),i.reduce((n,r)=>{let s=JSON.stringify(wO(r));return t.has(s)||(t.add(s),n.push({key:s,link:r})),n},[])}function tC(){let i=Te.useContext(Lp);return i2(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function TO(){let i=Te.useContext(L1);return i2(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var r2=Te.createContext(void 0);r2.displayName="FrameworkContext";function nC(){let i=Te.useContext(r2);return i2(i,"You must render this element inside a <HydratedRouter> element"),i}function AO(i,e){let t=Te.useContext(r2),[n,r]=Te.useState(!1),[s,l]=Te.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:x,onTouchStart:g}=e,w=Te.useRef(null);Te.useEffect(()=>{if(i==="render"&&l(!0),i==="viewport"){let $=q=>{q.forEach(ge=>{l(ge.isIntersecting)})},W=new IntersectionObserver($,{threshold:.5});return w.current&&W.observe(w.current),()=>{W.disconnect()}}},[i]),Te.useEffect(()=>{if(n){let $=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout($)}}},[n]);let A=()=>{r(!0)},B=()=>{r(!1),l(!1)};return t?i!=="intent"?[s,w,{}]:[s,w,{onFocus:fg(u,A),onBlur:fg(h,B),onMouseEnter:fg(f,A),onMouseLeave:fg(x,B),onTouchStart:fg(g,A)}]:[!1,w,{}]}function fg(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function EO({page:i,...e}){let{router:t}=tC(),n=Te.useMemo(()=>Gk(t.routes,i,t.basename),[t.routes,i,t.basename]);return n?Te.createElement(kO,{page:i,matches:n,...e}):null}function IO(i){let{manifest:e,routeModules:t}=nC(),[n,r]=Te.useState([]);return Te.useEffect(()=>{let s=!1;return _O(i,e,t).then(l=>{s||r(l)}),()=>{s=!0}},[i,e,t]),n}function kO({page:i,matches:e,...t}){let n=od(),{manifest:r,routeModules:s}=nC(),{basename:l}=tC(),{loaderData:u,matches:h}=TO(),f=Te.useMemo(()=>DT(i,e,h,r,n,"data"),[i,e,h,r,n]),x=Te.useMemo(()=>DT(i,e,h,r,n,"assets"),[i,e,h,r,n]),g=Te.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let B=new Set,$=!1;if(e.forEach(q=>{let ge=r.routes[q.route.id];!ge||!ge.hasLoader||(!f.some(he=>he.route.id===q.route.id)&&q.route.id in u&&s[q.route.id]?.shouldRevalidate||ge.hasClientLoader?$=!0:B.add(q.route.id))}),B.size===0)return[];let W=mO(i,l,"data");return $&&B.size>0&&W.searchParams.set("_routes",e.filter(q=>B.has(q.route.id)).map(q=>q.route.id).join(",")),[W.pathname+W.search]},[l,u,n,r,f,e,i,s]),w=Te.useMemo(()=>bO(x,r),[x,r]),A=IO(x);return Te.createElement(Te.Fragment,null,g.map(B=>Te.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),w.map(B=>Te.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),A.map(({key:B,link:$})=>Te.createElement("link",{key:B,nonce:t.nonce,...$})))}function CO(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var iC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iC&&(window.__reactRouterVersion="7.9.6")}catch{}function RO({basename:i,children:e,window:t}){let n=Te.useRef();n.current==null&&(n.current=mP({window:t,v5Compat:!0}));let r=n.current,[s,l]=Te.useState({action:r.action,location:r.location}),u=Te.useCallback(h=>{Te.startTransition(()=>l(h))},[l]);return Te.useLayoutEffect(()=>r.listen(u),[r,u]),Te.createElement(sO,{basename:i,children:e,location:s.location,navigationType:s.action,navigator:r})}var rC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sC=Te.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:s,replace:l,state:u,target:h,to:f,preventScrollReset:x,viewTransition:g,...w},A){let{basename:B}=Te.useContext(sc),$=typeof f=="string"&&rC.test(f),W,q=!1;if(typeof f=="string"&&$&&(W=f,iC))try{let J=new URL(window.location.href),ye=f.startsWith("//")?new URL(J.protocol+f):new URL(f),X=Wc(ye.pathname,B);ye.origin===J.origin&&X!=null?f=X+ye.search+ye.hash:q=!0}catch{lu(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ge=GP(f,{relative:r}),[he,me,Ce]=AO(n,w),Ve=PO(f,{replace:l,state:u,target:h,preventScrollReset:x,relative:r,viewTransition:g});function pe(J){e&&e(J),J.defaultPrevented||Ve(J)}let ee=Te.createElement("a",{...w,...Ce,href:W||ge,onClick:q||s?e:pe,ref:CO(A,me),target:h,"data-discover":!$&&t==="render"?"true":void 0});return he&&!$?Te.createElement(Te.Fragment,null,ee,Te.createElement(EO,{page:ge})):ee});sC.displayName="Link";var LO=Te.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:s,to:l,viewTransition:u,children:h,...f},x){let g=Dm(l,{relative:f.relative}),w=od(),A=Te.useContext(L1),{navigator:B,basename:$}=Te.useContext(sc),W=A!=null&&VO(g)&&u===!0,q=B.encodeLocation?B.encodeLocation(g).pathname:g.pathname,ge=w.pathname,he=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;t||(ge=ge.toLowerCase(),he=he?he.toLowerCase():null,q=q.toLowerCase()),he&&$&&(he=Wc(he,$)||he);const me=q!=="/"&&q.endsWith("/")?q.length-1:q.length;let Ce=ge===q||!r&&ge.startsWith(q)&&ge.charAt(me)==="/",Ve=he!=null&&(he===q||!r&&he.startsWith(q)&&he.charAt(q.length)==="/"),pe={isActive:Ce,isPending:Ve,isTransitioning:W},ee=Ce?e:void 0,J;typeof n=="function"?J=n(pe):J=[n,Ce?"active":null,Ve?"pending":null,W?"transitioning":null].filter(Boolean).join(" ");let ye=typeof s=="function"?s(pe):s;return Te.createElement(sC,{...f,"aria-current":ee,className:J,ref:x,style:ye,to:l,viewTransition:u},typeof h=="function"?h(pe):h)});LO.displayName="NavLink";var DO=Te.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:r,state:s,method:l=o0,action:u,onSubmit:h,relative:f,preventScrollReset:x,viewTransition:g,...w},A)=>{let B=FO(),$=jO(u,{relative:f}),W=l.toLowerCase()==="get"?"get":"post",q=typeof u=="string"&&rC.test(u),ge=he=>{if(h&&h(he),he.defaultPrevented)return;he.preventDefault();let me=he.nativeEvent.submitter,Ce=me?.getAttribute("formmethod")||l;B(me||he.currentTarget,{fetcherKey:e,method:Ce,navigate:t,replace:r,state:s,relative:f,preventScrollReset:x,viewTransition:g})};return Te.createElement("form",{ref:A,method:W,action:$,onSubmit:n?h:ge,...w,"data-discover":!q&&i==="render"?"true":void 0})});DO.displayName="Form";function NO(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aC(i){let e=Te.useContext(Lp);return Ns(e,NO(i)),e}function PO(i,{target:e,replace:t,state:n,preventScrollReset:r,relative:s,viewTransition:l}={}){let u=Dp(),h=od(),f=Dm(i,{relative:s});return Te.useCallback(x=>{if(hO(x,e)){x.preventDefault();let g=t!==void 0?t:nm(h)===nm(f);u(i,{replace:g,state:n,preventScrollReset:r,relative:s,viewTransition:l})}},[h,u,f,t,n,e,i,r,s,l])}function oC(i){lu(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=Te.useRef(Fb(i)),t=Te.useRef(!1),n=od(),r=Te.useMemo(()=>dO(n.search,t.current?null:e.current),[n.search]),s=Dp(),l=Te.useCallback((u,h)=>{const f=Fb(typeof u=="function"?u(new URLSearchParams(r)):u);t.current=!0,s("?"+f,h)},[s,r]);return[r,l]}var OO=0,MO=()=>`__${String(++OO)}__`;function FO(){let{router:i}=aC("useSubmit"),{basename:e}=Te.useContext(sc),t=tO();return Te.useCallback(async(n,r={})=>{let{action:s,method:l,encType:u,formData:h,body:f}=gO(n,e);if(r.navigate===!1){let x=r.fetcherKey||MO();await i.fetch(x,t,r.action||s,{preventScrollReset:r.preventScrollReset,formData:h,body:f,formMethod:r.method||l,formEncType:r.encType||u,flushSync:r.flushSync})}else await i.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:h,body:f,formMethod:r.method||l,formEncType:r.encType||u,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[i,e,t])}function jO(i,{relative:e}={}){let{basename:t}=Te.useContext(sc),n=Te.useContext(th);Ns(n,"useFormAction must be used inside a RouteContext");let[r]=n.matches.slice(-1),s={...Dm(i||".",{relative:e})},l=od();if(i==null){s.search=l.search;let u=new URLSearchParams(s.search),h=u.getAll("index");if(h.some(x=>x==="")){u.delete("index"),h.filter(g=>g).forEach(g=>u.append("index",g));let x=u.toString();s.search=x?`?${x}`:""}}return(!i||i===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:Gc([t,s.pathname])),nm(s)}function VO(i,{relative:e}={}){let t=Te.useContext(Xk);Ns(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=aC("useViewTransitionState"),r=Dm(i,{relative:e});if(!t.isTransitioning)return!1;let s=Wc(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=Wc(t.nextLocation.pathname,n)||t.nextLocation.pathname;return M0(r.pathname,l)!=null||M0(r.pathname,s)!=null}const zO=()=>{};var NT={};const lC={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const Kt=function(i,e){if(!i)throw Np(e)},Np=function(i){return new Error("Firebase Database ("+lC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+i)};const uC=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},UO=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const r=i[t++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=i[t++];e[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=i[t++],l=i[t++],u=i[t++],h=((r&7)<<18|(s&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const s=i[t++],l=i[t++];e[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|l&63)}}return e.join("")},s2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){const s=i[r],l=r+1<i.length,u=l?i[r+1]:0,h=r+2<i.length,f=h?i[r+2]:0,x=s>>2,g=(s&3)<<4|u>>4;let w=(u&15)<<2|f>>6,A=f&63;h||(A=64,l||(w=64)),n.push(t[x],t[g],t[w],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(uC(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):UO(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){const s=t[i.charAt(r++)],u=r<i.length?t[i.charAt(r)]:0;++r;const f=r<i.length?t[i.charAt(r)]:64;++r;const g=r<i.length?t[i.charAt(r)]:64;if(++r,s==null||u==null||f==null||g==null)throw new BO;const w=s<<2|u>>4;if(n.push(w),f!==64){const A=u<<4&240|f>>2;if(n.push(A),g!==64){const B=f<<6&192|g;n.push(B)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class BO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const cC=function(i){const e=uC(i);return s2.encodeByteArray(e,!0)},F0=function(i){return cC(i).replace(/\./g,"")},j0=function(i){try{return s2.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $O(i){return hC(void 0,i)}function hC(i,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:i===void 0&&(i={});break;case Array:i=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!GO(t)||(i[t]=hC(i[t],e[t]));return i}function GO(i){return i!=="__proto__"}function dC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const HO=()=>dC().__FIREBASE_DEFAULTS__,KO=()=>{if(typeof process>"u"||typeof NT>"u")return;const i=NT.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},WO=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&j0(i[1]);return e&&JSON.parse(e)},N1=()=>{try{return zO()||HO()||KO()||WO()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},fC=i=>N1()?.emulatorHosts?.[i],a2=i=>{const e=fC(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},pC=()=>N1()?.config,gC=i=>N1()?.[`_${i}`];class Nm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function ac(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function P1(i){return(await fetch(i,{credentials:"include"})).ok}function o2(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",r=i.iat||0,s=i.sub||i.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...i};return[F0(JSON.stringify(t)),F0(JSON.stringify(l)),""].join(".")}const Fg={};function qO(){const i={prod:[],emulator:[]};for(const e of Object.keys(Fg))Fg[e]?i.emulator.push(e):i.prod.push(e);return i}function YO(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let PT=!1;function O1(i,e){if(typeof window>"u"||typeof document>"u"||!ac(window.location.host)||Fg[i]===e||Fg[i]||PT)return;Fg[i]=e;function t(w){return`__firebase__banner__${w}`}const n="__firebase__banner",s=qO().prod.length>0;function l(){const w=document.getElementById(n);w&&w.remove()}function u(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function h(w,A){w.setAttribute("width","24"),w.setAttribute("id",A),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function f(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{PT=!0,l()},w}function x(w,A){w.setAttribute("id",A),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function g(){const w=YO(n),A=t("text"),B=document.getElementById(A)||document.createElement("span"),$=t("learnmore"),W=document.getElementById($)||document.createElement("a"),q=t("preprendIcon"),ge=document.getElementById(q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const he=w.element;u(he),x(W,$);const me=f();h(ge,q),he.append(ge,B,W,me),document.body.appendChild(he)}s?(B.innerText="Preview backend disconnected.",ge.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ge.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Fa(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function l2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fa())}function mC(){const i=N1()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function JO(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function yC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function QO(){const i=Fa();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function ZO(){return lC.NODE_ADMIN===!0}function vC(){return!mC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _C(){return!mC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function bC(){try{return typeof indexedDB=="object"}catch{return!1}}function e6(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const t6="FirebaseError";class oc extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=t6,Object.setPrototypeOf(this,oc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pm.prototype.create)}}class Pm{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],l=s?n6(s,n):"Error",u=`${this.serviceName}: ${l} (${r}).`;return new oc(r,u,n)}}function n6(i,e){return i.replace(i6,(t,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const i6=/\{\$([^}]+)}/g;function im(i){return JSON.parse(i)}function Ma(i){return JSON.stringify(i)}const xC=function(i){let e={},t={},n={},r="";try{const s=i.split(".");e=im(j0(s[0])||""),t=im(j0(s[1])||""),r=s[2],n=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:n,signature:r}},r6=function(i){const e=xC(i),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},s6=function(i){const e=xC(i).claims;return typeof e=="object"&&e.admin===!0};function lc(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function up(i,e){if(Object.prototype.hasOwnProperty.call(i,e))return i[e]}function jb(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function V0(i,e,t){const n={};for(const r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=e.call(t,i[r],r,i));return n}function Jh(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const r of t){if(!n.includes(r))return!1;const s=i[r],l=e[r];if(OT(s)&&OT(l)){if(!Jh(s,l))return!1}else if(s!==l)return!1}for(const r of n)if(!t.includes(r))return!1;return!0}function OT(i){return i!==null&&typeof i=="object"}function Pp(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Cg(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[r,s]=n.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function Rg(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}class a6{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if(typeof e=="string")for(let g=0;g<16;g++)n[g]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let g=0;g<16;g++)n[g]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let g=16;g<80;g++){const w=n[g-3]^n[g-8]^n[g-14]^n[g-16];n[g]=(w<<1|w>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],l=this.chain_[2],u=this.chain_[3],h=this.chain_[4],f,x;for(let g=0;g<80;g++){g<40?g<20?(f=u^s&(l^u),x=1518500249):(f=s^l^u,x=1859775393):g<60?(f=s&l|u&(s|l),x=2400959708):(f=s^l^u,x=3395469782);const w=(r<<5|r>>>27)+f+h+x+n[g]&4294967295;h=u,u=l,l=(s<<30|s>>>2)&4294967295,s=r,r=w}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const n=t-this.blockSize;let r=0;const s=this.buf_;let l=this.inbuf_;for(;r<t;){if(l===0)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[l]=e.charCodeAt(r),++l,++r,l===this.blockSize){this.compress_(s),l=0;break}}else for(;r<t;)if(s[l]=e[r],++l,++r,l===this.blockSize){this.compress_(s),l=0;break}}this.inbuf_=l,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[n]=this.chain_[r]>>s&255,++n;return e}}function o6(i,e){const t=new l6(i,e);return t.subscribe.bind(t)}class l6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");u6(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:n},r.next===void 0&&(r.next=j_),r.error===void 0&&(r.error=j_),r.complete===void 0&&(r.complete=j_);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function u6(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function j_(){}function M1(i,e){return`${i} failed: ${e} argument `}const c6=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);if(r>=55296&&r<=56319){const s=r-55296;n++,Kt(n<i.length,"Surrogate pair missing trail surrogate.");const l=i.charCodeAt(n)-56320;r=65536+(s<<10)+l}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},F1=function(i){let e=0;for(let t=0;t<i.length;t++){const n=i.charCodeAt(t);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,t++):e+=3}return e};function Ss(i){return i&&i._delegate?i._delegate:i}class qc{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ad="[DEFAULT]";class h6{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Nm;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(f6(e))try{this.getOrInitializeService({instanceIdentifier:Ad})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(e=Ad){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ad){return this.instances.has(e)}getOptions(e=Ad){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);n===u&&l.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:d6(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ad){return this.component?this.component.multipleInstances?e:Ad:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function d6(i){return i===Ad?void 0:i}function f6(i){return i.instantiationMode==="EAGER"}class p6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new h6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ki;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Ki||(Ki={}));const g6={debug:Ki.DEBUG,verbose:Ki.VERBOSE,info:Ki.INFO,warn:Ki.WARN,error:Ki.ERROR,silent:Ki.SILENT},m6=Ki.INFO,y6={[Ki.DEBUG]:"log",[Ki.VERBOSE]:"log",[Ki.INFO]:"info",[Ki.WARN]:"warn",[Ki.ERROR]:"error"},v6=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),r=y6[e];if(r)console[r](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class j1{constructor(e){this.name=e,this._logLevel=m6,this._logHandler=v6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ki))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?g6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ki.DEBUG,...e),this._logHandler(this,Ki.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ki.VERBOSE,...e),this._logHandler(this,Ki.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ki.INFO,...e),this._logHandler(this,Ki.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ki.WARN,...e),this._logHandler(this,Ki.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ki.ERROR,...e),this._logHandler(this,Ki.ERROR,...e)}}const _6=(i,e)=>e.some(t=>i instanceof t);let MT,FT;function b6(){return MT||(MT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function x6(){return FT||(FT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wC=new WeakMap,Vb=new WeakMap,SC=new WeakMap,V_=new WeakMap,u2=new WeakMap;function w6(i){const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("success",s),i.removeEventListener("error",l)},s=()=>{t($h(i.result)),r()},l=()=>{n(i.error),r()};i.addEventListener("success",s),i.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&wC.set(t,i)}).catch(()=>{}),u2.set(e,i),e}function S6(i){if(Vb.has(i))return;const e=new Promise((t,n)=>{const r=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",l),i.removeEventListener("abort",l)},s=()=>{t(),r()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",s),i.addEventListener("error",l),i.addEventListener("abort",l)});Vb.set(i,e)}let zb={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Vb.get(i);if(e==="objectStoreNames")return i.objectStoreNames||SC.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $h(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function T6(i){zb=i(zb)}function A6(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(z_(this),e,...t);return SC.set(n,e.sort?e.sort():[e]),$h(n)}:x6().includes(i)?function(...e){return i.apply(z_(this),e),$h(wC.get(this))}:function(...e){return $h(i.apply(z_(this),e))}}function E6(i){return typeof i=="function"?A6(i):(i instanceof IDBTransaction&&S6(i),_6(i,b6())?new Proxy(i,zb):i)}function $h(i){if(i instanceof IDBRequest)return w6(i);if(V_.has(i))return V_.get(i);const e=E6(i);return e!==i&&(V_.set(i,e),u2.set(e,i)),e}const z_=i=>u2.get(i);function I6(i,e,{blocked:t,upgrade:n,blocking:r,terminated:s}={}){const l=indexedDB.open(i,e),u=$h(l);return n&&l.addEventListener("upgradeneeded",h=>{n($h(l.result),h.oldVersion,h.newVersion,$h(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{s&&h.addEventListener("close",()=>s()),r&&h.addEventListener("versionchange",f=>r(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const k6=["get","getKey","getAll","getAllKeys","count"],C6=["put","add","delete","clear"],U_=new Map;function jT(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(U_.get(e))return U_.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,r=C6.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(r||k6.includes(t)))return;const s=async function(l,...u){const h=this.transaction(l,r?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(u.shift())),(await Promise.all([f[t](...u),r&&h.done]))[0]};return U_.set(e,s),s}T6(i=>({...i,get:(e,t,n)=>jT(e,t)||i.get(e,t,n),has:(e,t)=>!!jT(e,t)||i.has(e,t)}));class R6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(L6(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function L6(i){return i.getComponent()?.type==="VERSION"}const Ub="@firebase/app",VT="0.14.6";const Yc=new j1("@firebase/app"),D6="@firebase/app-compat",N6="@firebase/analytics-compat",P6="@firebase/analytics",O6="@firebase/app-check-compat",M6="@firebase/app-check",F6="@firebase/auth",j6="@firebase/auth-compat",V6="@firebase/database",z6="@firebase/data-connect",U6="@firebase/database-compat",B6="@firebase/functions",$6="@firebase/functions-compat",G6="@firebase/installations",H6="@firebase/installations-compat",K6="@firebase/messaging",W6="@firebase/messaging-compat",q6="@firebase/performance",Y6="@firebase/performance-compat",X6="@firebase/remote-config",J6="@firebase/remote-config-compat",Q6="@firebase/storage",Z6="@firebase/storage-compat",eM="@firebase/firestore",tM="@firebase/ai",nM="@firebase/firestore-compat",iM="firebase",rM="12.6.0";const Bb="[DEFAULT]",sM={[Ub]:"fire-core",[D6]:"fire-core-compat",[P6]:"fire-analytics",[N6]:"fire-analytics-compat",[M6]:"fire-app-check",[O6]:"fire-app-check-compat",[F6]:"fire-auth",[j6]:"fire-auth-compat",[V6]:"fire-rtdb",[z6]:"fire-data-connect",[U6]:"fire-rtdb-compat",[B6]:"fire-fn",[$6]:"fire-fn-compat",[G6]:"fire-iid",[H6]:"fire-iid-compat",[K6]:"fire-fcm",[W6]:"fire-fcm-compat",[q6]:"fire-perf",[Y6]:"fire-perf-compat",[X6]:"fire-rc",[J6]:"fire-rc-compat",[Q6]:"fire-gcs",[Z6]:"fire-gcs-compat",[eM]:"fire-fst",[nM]:"fire-fst-compat",[tM]:"fire-vertex","fire-js":"fire-js",[iM]:"fire-js-all"};const z0=new Map,aM=new Map,$b=new Map;function zT(i,e){try{i.container.addComponent(e)}catch(t){Yc.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Qh(i){const e=i.name;if($b.has(e))return Yc.debug(`There were multiple attempts to register component ${e}.`),!1;$b.set(e,i);for(const t of z0.values())zT(t,i);for(const t of aM.values())zT(t,i);return!0}function Om(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Po(i){return i==null?!1:i.settings!==void 0}const oM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gh=new Pm("app","Firebase",oM);class lM{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new qc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gh.create("app-deleted",{appName:this._name})}}const ld=rM;function V1(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:Bb,automaticDataCollectionEnabled:!0,...e},r=n.name;if(typeof r!="string"||!r)throw Gh.create("bad-app-name",{appName:String(r)});if(t||(t=pC()),!t)throw Gh.create("no-options");const s=z0.get(r);if(s){if(Jh(t,s.options)&&Jh(n,s.config))return s;throw Gh.create("duplicate-app",{appName:r})}const l=new p6(r);for(const h of $b.values())l.addComponent(h);const u=new lM(t,n,l);return z0.set(r,u),u}function z1(i=Bb){const e=z0.get(i);if(!e&&i===Bb&&pC())return V1();if(!e)throw Gh.create("no-app",{appName:i});return e}function au(i,e,t){let n=sM[i]??i;t&&(n+=`-${t}`);const r=n.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const l=[`Unable to register library "${n}" with version "${e}":`];r&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&s&&l.push("and"),s&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yc.warn(l.join(" "));return}Qh(new qc(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const uM="firebase-heartbeat-database",cM=1,rm="firebase-heartbeat-store";let B_=null;function TC(){return B_||(B_=I6(uM,cM,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(rm)}catch(t){console.warn(t)}}}}).catch(i=>{throw Gh.create("idb-open",{originalErrorMessage:i.message})})),B_}async function hM(i){try{const t=(await TC()).transaction(rm),n=await t.objectStore(rm).get(AC(i));return await t.done,n}catch(e){if(e instanceof oc)Yc.warn(e.message);else{const t=Gh.create("idb-get",{originalErrorMessage:e?.message});Yc.warn(t.message)}}}async function UT(i,e){try{const n=(await TC()).transaction(rm,"readwrite");await n.objectStore(rm).put(e,AC(i)),await n.done}catch(t){if(t instanceof oc)Yc.warn(t.message);else{const n=Gh.create("idb-set",{originalErrorMessage:t?.message});Yc.warn(n.message)}}}function AC(i){return`${i.name}!${i.options.appId}`}const dM=1024,fM=30;class pM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new mM(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=BT();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(r=>r.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>fM){const r=yM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yc.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=BT(),{heartbeatsToSend:t,unsentEntries:n}=gM(this._heartbeatsCache.heartbeats),r=F0(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Yc.warn(e),""}}}function BT(){return new Date().toISOString().substring(0,10)}function gM(i,e=dM){const t=[];let n=i.slice();for(const r of i){const s=t.find(l=>l.agent===r.agent);if(s){if(s.dates.push(r.date),$T(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),$T(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class mM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bC()?e6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await hM(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return UT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return UT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function $T(i){return F0(JSON.stringify({version:2,heartbeats:i})).length}function yM(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}function vM(i){Qh(new qc("platform-logger",e=>new R6(e),"PRIVATE")),Qh(new qc("heartbeat",e=>new pM(e),"PRIVATE")),au(Ub,VT,i),au(Ub,VT,"esm2020"),au("fire-js","")}vM("");var _M="firebase",bM="12.6.0";au(_M,bM,"app");function EC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xM=EC,IC=new Pm("auth","Firebase",EC());const U0=new j1("@firebase/auth");function wM(i,...e){U0.logLevel<=Ki.WARN&&U0.warn(`Auth (${ld}): ${i}`,...e)}function u0(i,...e){U0.logLevel<=Ki.ERROR&&U0.error(`Auth (${ld}): ${i}`,...e)}function uu(i,...e){throw h2(i,...e)}function Lu(i,...e){return h2(i,...e)}function c2(i,e,t){const n={...xM(),[e]:t};return new Pm("auth","Firebase",n).create(e,{appName:i.name})}function ec(i){return c2(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SM(i,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&uu(i,"argument-error"),c2(i,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function h2(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return IC.create(i,...e)}function ti(i,e,...t){if(!i)throw h2(e,...t)}function Vc(i){const e="INTERNAL ASSERTION FAILED: "+i;throw u0(e),new Error(e)}function Xc(i,e){i||Vc(e)}function Gb(){return typeof self<"u"&&self.location?.href||""}function TM(){return GT()==="http:"||GT()==="https:"}function GT(){return typeof self<"u"&&self.location?.protocol||null}function AM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(TM()||JO()||"connection"in navigator)?navigator.onLine:!0}function EM(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}class Mm{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xc(t>e,"Short delay should be less than long delay!"),this.isMobile=l2()||yC()}get(){return AM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function d2(i,e){Xc(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class kC{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const IM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const kM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],CM=new Mm(3e4,6e4);function ud(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function cd(i,e,t,n,r={}){return CC(i,r,async()=>{let s={},l={};n&&(e==="GET"?l=n:s={body:JSON.stringify(n)});const u=Pp({key:i.config.apiKey,...l}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const f={method:e,headers:h,...s};return XO()||(f.referrerPolicy="no-referrer"),i.emulatorConfig&&ac(i.emulatorConfig.host)&&(f.credentials="include"),kC.fetch()(await RC(i,i.config.apiHost,t,u),f)})}async function CC(i,e,t){i._canInitEmulator=!1;const n={...IM,...e};try{const r=new LM(i),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw Fy(i,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const u=s.ok?l.errorMessage:l.error.message,[h,f]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fy(i,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Fy(i,"email-already-in-use",l);if(h==="USER_DISABLED")throw Fy(i,"user-disabled",l);const x=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw c2(i,x,f);uu(i,x)}}catch(r){if(r instanceof oc)throw r;uu(i,"network-request-failed",{message:String(r)})}}async function Fm(i,e,t,n,r={}){const s=await cd(i,e,t,n,r);return"mfaPendingCredential"in s&&uu(i,"multi-factor-auth-required",{_serverResponse:s}),s}async function RC(i,e,t,n){const r=`${e}${t}?${n}`,s=i,l=s.config.emulator?d2(i.config,r):`${i.config.apiScheme}://${r}`;return kM.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(l).toString():l}function RM(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class LM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Lu(this.auth,"network-request-failed")),CM.get())})}}function Fy(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const r=Lu(i,e,n);return r.customData._tokenResponse=t,r}function HT(i){return i!==void 0&&i.enterprise!==void 0}class DM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return RM(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function NM(i,e){return cd(i,"GET","/v2/recaptchaConfig",ud(i,e))}async function PM(i,e){return cd(i,"POST","/v1/accounts:delete",e)}async function B0(i,e){return cd(i,"POST","/v1/accounts:lookup",e)}function jg(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OM(i,e=!1){const t=Ss(i),n=await t.getIdToken(e),r=f2(n);ti(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,l=s?.sign_in_provider;return{claims:r,token:n,authTime:jg($_(r.auth_time)),issuedAtTime:jg($_(r.iat)),expirationTime:jg($_(r.exp)),signInProvider:l||null,signInSecondFactor:s?.sign_in_second_factor||null}}function $_(i){return Number(i)*1e3}function f2(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return u0("JWT malformed, contained fewer than 3 sections"),null;try{const r=j0(t);return r?JSON.parse(r):(u0("Failed to decode base64 JWT payload"),null)}catch(r){return u0("Caught error parsing JWT payload as JSON",r?.toString()),null}}function KT(i){const e=f2(i);return ti(e,"internal-error"),ti(typeof e.exp<"u","internal-error"),ti(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sm(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof oc&&MM(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function MM({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}class FM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Hb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jg(this.lastLoginAt),this.creationTime=jg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function $0(i){const e=i.auth,t=await i.getIdToken(),n=await sm(i,B0(e,{idToken:t}));ti(n?.users.length,e,"internal-error");const r=n.users[0];i._notifyReloadListener(r);const s=r.providerUserInfo?.length?LC(r.providerUserInfo):[],l=VM(i.providerData,s),u=i.isAnonymous,h=!(i.email&&r.passwordHash)&&!l?.length,f=u?h:!1,x={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new Hb(r.createdAt,r.lastLoginAt),isAnonymous:f};Object.assign(i,x)}async function jM(i){const e=Ss(i);await $0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function VM(i,e){return[...i.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function LC(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function zM(i,e){const t=await CC(i,{},async()=>{const n=Pp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=i.config,l=await RC(i,r,"/v1/token",`key=${s}`),u=await i._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return i.emulatorConfig&&ac(i.emulatorConfig.host)&&(h.credentials="include"),kC.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function UM(i,e){return cd(i,"POST","/v2/accounts:revokeToken",ud(i,e))}class Qf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ti(e.idToken,"internal-error"),ti(typeof e.idToken<"u","internal-error"),ti(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ti(e.length!==0,"internal-error");const t=KT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ti(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await zM(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,l=new Qf;return n&&(ti(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),r&&(ti(typeof r=="string","internal-error",{appName:e}),l.accessToken=r),s&&(ti(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qf,this.toJSON())}_performRefresh(){return Vc("not implemented")}}function Eh(i,e){ti(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Cu{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new FM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Hb(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await sm(this,this.stsTokenManager.getToken(this.auth,e));return ti(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return OM(this,e)}reload(){return jM(this)}_assign(e){this!==e&&(ti(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Cu({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ti(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await $0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Po(this.auth.app))return Promise.reject(ec(this.auth));const e=await this.getIdToken();return await sm(this,PM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,h=t._redirectEventId??void 0,f=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:g,emailVerified:w,isAnonymous:A,providerData:B,stsTokenManager:$}=t;ti(g&&$,e,"internal-error");const W=Qf.fromJSON(this.name,$);ti(typeof g=="string",e,"internal-error"),Eh(n,e.name),Eh(r,e.name),ti(typeof w=="boolean",e,"internal-error"),ti(typeof A=="boolean",e,"internal-error"),Eh(s,e.name),Eh(l,e.name),Eh(u,e.name),Eh(h,e.name),Eh(f,e.name),Eh(x,e.name);const q=new Cu({uid:g,auth:e,email:r,emailVerified:w,displayName:n,isAnonymous:A,photoURL:l,phoneNumber:s,tenantId:u,stsTokenManager:W,createdAt:f,lastLoginAt:x});return B&&Array.isArray(B)&&(q.providerData=B.map(ge=>({...ge}))),h&&(q._redirectEventId=h),q}static async _fromIdTokenResponse(e,t,n=!1){const r=new Qf;r.updateFromServerResponse(t);const s=new Cu({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await $0(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];ti(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?LC(r.providerUserInfo):[],l=!(r.email&&r.passwordHash)&&!s?.length,u=new Qf;u.updateFromIdToken(n);const h=new Cu({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:l}),f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Hb(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(h,f),h}}const WT=new Map;function zc(i){Xc(i instanceof Function,"Expected a class definition");let e=WT.get(i);return e?(Xc(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,WT.set(i,e),e)}class DC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}DC.type="NONE";const qT=DC;function c0(i,e,t){return`firebase:${i}:${e}:${t}`}class Zf{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=c0(this.userKey,r.apiKey,s),this.fullPersistenceKey=c0("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await B0(this.auth,{idToken:e}).catch(()=>{});return t?Cu._fromGetAccountInfoResponse(this.auth,t,e):null}return Cu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Zf(zc(qT),e,n);const r=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=r[0]||zc(qT);const l=c0(n,e.config.apiKey,e.name);let u=null;for(const f of t)try{const x=await f._get(l);if(x){let g;if(typeof x=="string"){const w=await B0(e,{idToken:x}).catch(()=>{});if(!w)break;g=await Cu._fromGetAccountInfoResponse(e,w,x)}else g=Cu._fromJSON(e,x);f!==s&&(u=g),s=f;break}}catch{}const h=r.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Zf(s,e,n):(s=h[0],u&&await s._set(l,u.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(l)}catch{}})),new Zf(s,e,n))}}function YT(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jC(e))return"Blackberry";if(VC(e))return"Webos";if(PC(e))return"Safari";if((e.includes("chrome/")||OC(e))&&!e.includes("edge/"))return"Chrome";if(FC(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if(n?.length===2)return n[1]}return"Other"}function NC(i=Fa()){return/firefox\//i.test(i)}function PC(i=Fa()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OC(i=Fa()){return/crios\//i.test(i)}function MC(i=Fa()){return/iemobile/i.test(i)}function FC(i=Fa()){return/android/i.test(i)}function jC(i=Fa()){return/blackberry/i.test(i)}function VC(i=Fa()){return/webos/i.test(i)}function p2(i=Fa()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function BM(i=Fa()){return p2(i)&&!!window.navigator?.standalone}function $M(){return QO()&&document.documentMode===10}function zC(i=Fa()){return p2(i)||FC(i)||VC(i)||jC(i)||/windows phone/i.test(i)||MC(i)}function UC(i,e=[]){let t;switch(i){case"Browser":t=YT(Fa());break;case"Worker":t=`${YT(Fa())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ld}/${n}`}class GM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((l,u)=>{try{const h=e(s);l(h)}catch(h){u(h)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function HM(i,e={}){return cd(i,"GET","/v2/passwordPolicy",ud(i,e))}const KM=6;class WM{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??KM,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class qM{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new XT(this),this.idTokenSubscription=new XT(this),this.beforeStateQueue=new GM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=IC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zc(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Zf.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await B0(this,{idToken:e}),n=await Cu._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Po(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,l=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!s||s===l)&&u?.user&&(n=u.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ti(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $0(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Po(this.app))return Promise.reject(ec(this));const t=e?Ss(e):null;return t&&ti(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ti(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Po(this.app)?Promise.reject(ec(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Po(this.app)?Promise.reject(ec(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zc(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HM(this),t=new WM(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Pm("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await UM(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zc(e)||this._popupRedirectResolver;ti(t,this,"argument-error"),this.redirectPersistenceManager=await Zf.create(this,[zc(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ti(u,this,"internal-error"),u.then(()=>{l||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,n,r);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ti(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=UC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Po(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&wM(`Error while retrieving App Check token: ${e.error}`),e?.token}}function nh(i){return Ss(i)}class XT{constructor(e){this.auth=e,this.observer=null,this.addObserver=o6(t=>this.observer=t)}get next(){return ti(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let U1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YM(i){U1=i}function BC(i){return U1.loadJS(i)}function XM(){return U1.recaptchaEnterpriseScript}function JM(){return U1.gapiScript}function QM(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class ZM{constructor(){this.enterprise=new e8}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class e8{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const t8="recaptcha-enterprise",$C="NO_RECAPTCHA";class n8{constructor(e){this.type=t8,this.auth=nh(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(l,u)=>{NM(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const f=new DM(h);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,l(f.siteKey)}}).catch(h=>{u(h)})})}function r(s,l,u){const h=window.grecaptcha;HT(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(f=>{l(f)}).catch(()=>{l($C)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ZM().execute("siteKey",{action:"verify"}):new Promise((s,l)=>{n(this.auth).then(u=>{if(!t&&HT(window.grecaptcha))r(u,s,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=XM();h.length!==0&&(h+=u),BC(h).then(()=>{r(u,s,l)}).catch(f=>{l(f)})}}).catch(u=>{l(u)})})}}async function JT(i,e,t,n=!1,r=!1){const s=new n8(i);let l;if(r)l=$C;else try{l=await s.verify(t)}catch{l=await s.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,f=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Kb(i,e,t,n,r){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await JT(i,e,t,t==="getOobCode");return n(i,s)}else return n(i,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await JT(i,e,t,t==="getOobCode");return n(i,l)}else return Promise.reject(s)})}function i8(i,e){const t=Om(i,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(Jh(s,e??{}))return r;uu(r,"already-initialized")}return t.initialize({options:e})}function r8(i,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(zc);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e?.popupRedirectResolver)}function s8(i,e,t){const n=nh(i);ti(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const r=!1,s=GC(e),{host:l,port:u}=a8(e),h=u===null?"":`:${u}`,f={url:`${s}//${l}${h}/`},x=Object.freeze({host:l,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!n._canInitEmulator){ti(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ti(Jh(f,n.config.emulator)&&Jh(x,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=x,n.settings.appVerificationDisabledForTesting=!0,ac(l)?(P1(`${s}//${l}${h}`),O1("Auth",!0)):o8()}function GC(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function a8(i){const e=GC(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){const s=r[1];return{host:s,port:QT(n.substr(s.length+1))}}else{const[s,l]=n.split(":");return{host:s,port:QT(l)}}}function QT(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function o8(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}class g2{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vc("not implemented")}_getIdTokenResponse(e){return Vc("not implemented")}_linkToIdToken(e,t){return Vc("not implemented")}_getReauthenticationResolver(e){return Vc("not implemented")}}async function l8(i,e){return cd(i,"POST","/v1/accounts:signUp",e)}async function u8(i,e){return Fm(i,"POST","/v1/accounts:signInWithPassword",ud(i,e))}async function c8(i,e){return Fm(i,"POST","/v1/accounts:signInWithEmailLink",ud(i,e))}async function h8(i,e){return Fm(i,"POST","/v1/accounts:signInWithEmailLink",ud(i,e))}class am extends g2{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new am(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new am(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kb(e,t,"signInWithPassword",u8);case"emailLink":return c8(e,{email:this._email,oobCode:this._password});default:uu(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kb(e,n,"signUpPassword",l8);case"emailLink":return h8(e,{idToken:t,email:this._email,oobCode:this._password});default:uu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ep(i,e){return Fm(i,"POST","/v1/accounts:signInWithIdp",ud(i,e))}const d8="http://localhost";class Kd extends g2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Kd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):uu("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:r,...s}=t;if(!n||!r)return null;const l=new Kd(n,r);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ep(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ep(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ep(e,t)}buildRequest(){const e={requestUri:d8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pp(t)}return e}}function f8(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function p8(i){const e=Cg(Rg(i)).link,t=e?Cg(Rg(e)).deep_link_id:null,n=Cg(Rg(i)).deep_link_id;return(n?Cg(Rg(n)).link:null)||n||t||e||i}class m2{constructor(e){const t=Cg(Rg(e)),n=t.apiKey??null,r=t.oobCode??null,s=f8(t.mode??null);ti(n&&r&&s,"argument-error"),this.apiKey=n,this.operation=s,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=p8(e);try{return new m2(t)}catch{return null}}}class Op{constructor(){this.providerId=Op.PROVIDER_ID}static credential(e,t){return am._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=m2.parseLink(t);return ti(n,"argument-error"),am._fromEmailAndCode(e,n.code,n.tenantId)}}Op.PROVIDER_ID="password";Op.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Op.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class y2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class jm extends y2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ph extends jm{constructor(){super("facebook.com")}static credential(e){return Kd._fromParams({providerId:Ph.PROVIDER_ID,signInMethod:Ph.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ph.credentialFromTaggedObject(e)}static credentialFromError(e){return Ph.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ph.credential(e.oauthAccessToken)}catch{return null}}}Ph.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ph.PROVIDER_ID="facebook.com";class jc extends jm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Kd._fromParams({providerId:jc.PROVIDER_ID,signInMethod:jc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return jc.credentialFromTaggedObject(e)}static credentialFromError(e){return jc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return jc.credential(t,n)}catch{return null}}}jc.GOOGLE_SIGN_IN_METHOD="google.com";jc.PROVIDER_ID="google.com";class Oh extends jm{constructor(){super("github.com")}static credential(e){return Kd._fromParams({providerId:Oh.PROVIDER_ID,signInMethod:Oh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oh.credentialFromTaggedObject(e)}static credentialFromError(e){return Oh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oh.credential(e.oauthAccessToken)}catch{return null}}}Oh.GITHUB_SIGN_IN_METHOD="github.com";Oh.PROVIDER_ID="github.com";class Mh extends jm{constructor(){super("twitter.com")}static credential(e,t){return Kd._fromParams({providerId:Mh.PROVIDER_ID,signInMethod:Mh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Mh.credentialFromTaggedObject(e)}static credentialFromError(e){return Mh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Mh.credential(t,n)}catch{return null}}}Mh.TWITTER_SIGN_IN_METHOD="twitter.com";Mh.PROVIDER_ID="twitter.com";async function HC(i,e){return Fm(i,"POST","/v1/accounts:signUp",ud(i,e))}class Jc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await Cu._fromIdTokenResponse(e,n,r),l=ZT(n);return new Jc({user:s,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ZT(n);return new Jc({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ZT(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}async function g8(i){if(Po(i.app))return Promise.reject(ec(i));const e=nh(i);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Jc({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await HC(e,{returnSecureToken:!0}),n=await Jc._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(n.user),n}class G0 extends oc{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,G0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new G0(e,t,n,r)}}function KC(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?G0._fromErrorAndOperation(i,s,e,n):s})}async function m8(i,e,t=!1){const n=await sm(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Jc._forOperation(i,"link",n)}async function y8(i,e,t=!1){const{auth:n}=i;if(Po(n.app))return Promise.reject(ec(n));const r="reauthenticate";try{const s=await sm(i,KC(n,r,e,i),t);ti(s.idToken,n,"internal-error");const l=f2(s.idToken);ti(l,n,"internal-error");const{sub:u}=l;return ti(i.uid===u,n,"user-mismatch"),Jc._forOperation(i,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&uu(n,"user-mismatch"),s}}async function WC(i,e,t=!1){if(Po(i.app))return Promise.reject(ec(i));const n="signIn",r=await KC(i,n,e),s=await Jc._fromIdTokenResponse(i,n,r);return t||await i._updateCurrentUser(s.user),s}async function v8(i,e){return WC(nh(i),e)}async function qC(i){const e=nh(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _8(i,e,t){if(Po(i.app))return Promise.reject(ec(i));const n=nh(i),l=await Kb(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",HC).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&qC(i),h}),u=await Jc._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function b8(i,e,t){return Po(i.app)?Promise.reject(ec(i)):v8(Ss(i),Op.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&qC(i),n})}function x8(i,e,t,n){return Ss(i).onIdTokenChanged(e,t,n)}function w8(i,e,t){return Ss(i).beforeAuthStateChanged(e,t)}function S8(i,e,t,n){return Ss(i).onAuthStateChanged(e,t,n)}function T8(i){return Ss(i).signOut()}const H0="__sak";class YC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(H0,"1"),this.storage.removeItem(H0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const A8=1e3,E8=10;class XC extends YC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},s=this.storage.getItem(n);$M()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,E8):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},A8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}XC.type="LOCAL";const I8=XC;class JC extends YC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}JC.type="SESSION";const QC=JC;function k8(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class B1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const n=new B1(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,l=this.handlersMap[r];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const u=Array.from(l).map(async f=>f(t.origin,s)),h=await k8(u);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}B1.receivers=[];function v2(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}class C8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,l;return new Promise((u,h)=>{const f=v2("",20);r.port1.start();const x=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:r,onMessage(g){const w=g;if(w.data.eventId===f)switch(w.data.status){case"ack":clearTimeout(x),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(w.data.response);break;default:clearTimeout(x),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(l),r.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[r.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function tc(){return window}function R8(i){tc().location.href=i}function ZC(){return typeof tc().WorkerGlobalScope<"u"&&typeof tc().importScripts=="function"}async function L8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function D8(){return navigator?.serviceWorker?.controller||null}function N8(){return ZC()?self:null}const e3="firebaseLocalStorageDb",P8=1,K0="firebaseLocalStorage",t3="fbase_key";class Vm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $1(i,e){return i.transaction([K0],e?"readwrite":"readonly").objectStore(K0)}function O8(){const i=indexedDB.deleteDatabase(e3);return new Vm(i).toPromise()}function Wb(){const i=indexedDB.open(e3,P8);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(K0,{keyPath:t3})}catch(r){t(r)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(K0)?e(n):(n.close(),await O8(),e(await Wb()))})})}async function eA(i,e,t){const n=$1(i,!0).put({[t3]:e,value:t});return new Vm(n).toPromise()}async function M8(i,e){const t=$1(i,!1).get(e),n=await new Vm(t).toPromise();return n===void 0?null:n.value}function tA(i,e){const t=$1(i,!0).delete(e);return new Vm(t).toPromise()}const F8=800,j8=3;class n3{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>j8)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ZC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=B1._getInstance(N8()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await L8(),!this.activeServiceWorker)return;this.sender=new C8(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||D8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wb();return await eA(e,H0,"1"),await tA(e,H0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>eA(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>M8(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=$1(r,!1).getAll();return new Vm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),F8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}n3.type="LOCAL";const V8=n3;new Mm(3e4,6e4);function i3(i,e){return e?zc(e):(ti(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}class _2 extends g2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ep(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ep(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ep(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function z8(i){return WC(i.auth,new _2(i),i.bypassAuthState)}function U8(i){const{auth:e,user:t}=i;return ti(t,e,"internal-error"),y8(t,new _2(i),i.bypassAuthState)}async function B8(i){const{auth:e,user:t}=i;return ti(t,e,"internal-error"),m8(t,new _2(i),i.bypassAuthState)}class r3{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return z8;case"linkViaPopup":case"linkViaRedirect":return B8;case"reauthViaPopup":case"reauthViaRedirect":return U8;default:uu(this.auth,"internal-error")}}resolve(e){Xc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $8=new Mm(2e3,1e4);async function G8(i,e,t){if(Po(i.app))return Promise.reject(Lu(i,"operation-not-supported-in-this-environment"));const n=nh(i);SM(i,e,y2);const r=i3(n,t);return new Fd(n,"signInViaPopup",e,r).executeNotNull()}class Fd extends r3{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Fd.currentPopupAction&&Fd.currentPopupAction.cancel(),Fd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ti(e,this.auth,"internal-error"),e}async onExecution(){Xc(this.filter.length===1,"Popup operations only handle one event");const e=v2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Lu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Lu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fd.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Lu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$8.get())};e()}}Fd.currentPopupAction=null;const H8="pendingRedirect",h0=new Map;class K8 extends r3{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=h0.get(this.auth._key());if(!e){try{const n=await W8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}h0.set(this.auth._key(),e)}return this.bypassAuthState||h0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function W8(i,e){const t=X8(e),n=Y8(i);if(!await n._isAvailable())return!1;const r=await n._get(t)==="true";return await n._remove(t),r}function q8(i,e){h0.set(i._key(),e)}function Y8(i){return zc(i._redirectPersistence)}function X8(i){return c0(H8,i.config.apiKey,i.name)}async function J8(i,e,t=!1){if(Po(i.app))return Promise.reject(ec(i));const n=nh(i),r=i3(n,e),l=await new K8(n,r,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const Q8=600*1e3;class Z8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eF(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!s3(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Lu(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Q8&&this.cachedEventUids.clear(),this.cachedEventUids.has(nA(e))}saveEventToCache(e){this.cachedEventUids.add(nA(e)),this.lastProcessedEventTime=Date.now()}}function nA(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function s3({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function eF(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return s3(i);default:return!1}}async function tF(i,e={}){return cd(i,"GET","/v1/projects",e)}const nF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iF=/^https?/;async function rF(i){if(i.config.emulator)return;const{authorizedDomains:e}=await tF(i);for(const t of e)try{if(sF(t))return}catch{}uu(i,"unauthorized-domain")}function sF(i){const e=Gb(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!iF.test(t))return!1;if(nF.test(i))return n===i;const r=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(n)}const aF=new Mm(3e4,6e4);function iA(){const i=tc().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function oF(i){return new Promise((e,t)=>{function n(){iA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iA(),t(Lu(i,"network-request-failed"))},timeout:aF.get()})}if(tc().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(tc().gapi?.load)n();else{const r=QM("iframefcb");return tc()[r]=()=>{gapi.load?n():t(Lu(i,"network-request-failed"))},BC(`${JM()}?onload=${r}`).catch(s=>t(s))}}).catch(e=>{throw d0=null,e})}let d0=null;function lF(i){return d0=d0||oF(i),d0}const uF=new Mm(5e3,15e3),cF="__/auth/iframe",hF="emulator/auth/iframe",dF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pF(i){const e=i.config;ti(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?d2(e,hF):`https://${i.config.authDomain}/${cF}`,n={apiKey:e.apiKey,appName:i.name,v:ld},r=fF.get(i.config.apiHost);r&&(n.eid=r);const s=i._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${Pp(n).slice(1)}`}async function gF(i){const e=await lF(i),t=tc().gapi;return ti(t,i,"internal-error"),e.open({where:document.body,url:pF(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dF,dontclear:!0},n=>new Promise(async(r,s)=>{await n.restyle({setHideOnLeave:!1});const l=Lu(i,"network-request-failed"),u=tc().setTimeout(()=>{s(l)},uF.get());function h(){tc().clearTimeout(u),r(n)}n.ping(h).then(h,()=>{s(l)})}))}const mF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yF=500,vF=600,_F="_blank",bF="http://localhost";class rA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xF(i,e,t,n=yF,r=vF){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...mF,width:n.toString(),height:r.toString(),top:s,left:l},f=Fa().toLowerCase();t&&(u=OC(f)?_F:t),NC(f)&&(e=e||bF,h.scrollbars="yes");const x=Object.entries(h).reduce((w,[A,B])=>`${w}${A}=${B},`,"");if(BM(f)&&u!=="_self")return wF(e||"",u),new rA(null);const g=window.open(e||"",u,x);ti(g,i,"popup-blocked");try{g.focus()}catch{}return new rA(g)}function wF(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}const SF="__/auth/handler",TF="emulator/auth/handler",AF=encodeURIComponent("fac");async function sA(i,e,t,n,r,s){ti(i.config.authDomain,i,"auth-domain-config-required"),ti(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:ld,eventId:r};if(e instanceof y2){e.setDefaultLanguage(i.languageCode),l.providerId=e.providerId||"",jb(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,g]of Object.entries({}))l[x]=g}if(e instanceof jm){const x=e.getScopes().filter(g=>g!=="");x.length>0&&(l.scopes=x.join(","))}i.tenantId&&(l.tid=i.tenantId);const u=l;for(const x of Object.keys(u))u[x]===void 0&&delete u[x];const h=await i._getAppCheckToken(),f=h?`#${AF}=${encodeURIComponent(h)}`:"";return`${EF(i)}?${Pp(u).slice(1)}${f}`}function EF({config:i}){return i.emulator?d2(i,TF):`https://${i.authDomain}/${SF}`}const G_="webStorageSupport";class IF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=QC,this._completeRedirectFn=J8,this._overrideRedirectResult=q8}async _openPopup(e,t,n,r){Xc(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await sA(e,t,n,Gb(),r);return xF(e,s,v2())}async _openRedirect(e,t,n,r){await this._originValidation(e);const s=await sA(e,t,n,Gb(),r);return R8(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Xc(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await gF(e),n=new Z8(e);return t.register("authEvent",r=>(ti(r?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(G_,{type:G_},r=>{const s=r?.[0]?.[G_];s!==void 0&&t(!!s),uu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zC()||PC()||p2()}}const kF=IF;var aA="@firebase/auth",oA="1.11.1";class CF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ti(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function RF(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function LF(i){Qh(new qc("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;ti(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:u,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:UC(i)},f=new qM(n,r,s,h);return r8(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Qh(new qc("auth-internal",e=>{const t=nh(e.getProvider("auth").getImmediate());return(n=>new CF(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),au(aA,oA,RF(i)),au(aA,oA,"esm2020")}const DF=300,NF=gC("authIdTokenMaxAge")||DF;let lA=null;const PF=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>NF)return;const r=t?.token;lA!==r&&(lA=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function b2(i=z1()){const e=Om(i,"auth");if(e.isInitialized())return e.getImmediate();const t=i8(i,{popupRedirectResolver:kF,persistence:[V8,I8,QC]}),n=gC("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const l=PF(s.toString());w8(t,l,()=>l(t.currentUser)),x8(t,u=>l(u))}}const r=fC("auth");return r&&s8(t,`http://${r}`),t}function OF(){return document.getElementsByTagName("head")?.[0]??document}YM({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=r=>{const s=Lu("internal-error");s.customData=r,t(s)},n.type="text/javascript",n.charset="UTF-8",OF().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LF("Browser");var uA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Hh,a3;(function(){var i;function e(pe,ee){function J(){}J.prototype=ee.prototype,pe.F=ee.prototype,pe.prototype=new J,pe.prototype.constructor=pe,pe.D=function(ye,X,ae){for(var le=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)le[ze-2]=arguments[ze];return ee.prototype[X].apply(ye,le)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(pe,ee,J){J||(J=0);const ye=Array(16);if(typeof ee=="string")for(var X=0;X<16;++X)ye[X]=ee.charCodeAt(J++)|ee.charCodeAt(J++)<<8|ee.charCodeAt(J++)<<16|ee.charCodeAt(J++)<<24;else for(X=0;X<16;++X)ye[X]=ee[J++]|ee[J++]<<8|ee[J++]<<16|ee[J++]<<24;ee=pe.g[0],J=pe.g[1],X=pe.g[2];let ae=pe.g[3],le;le=ee+(ae^J&(X^ae))+ye[0]+3614090360&4294967295,ee=J+(le<<7&4294967295|le>>>25),le=ae+(X^ee&(J^X))+ye[1]+3905402710&4294967295,ae=ee+(le<<12&4294967295|le>>>20),le=X+(J^ae&(ee^J))+ye[2]+606105819&4294967295,X=ae+(le<<17&4294967295|le>>>15),le=J+(ee^X&(ae^ee))+ye[3]+3250441966&4294967295,J=X+(le<<22&4294967295|le>>>10),le=ee+(ae^J&(X^ae))+ye[4]+4118548399&4294967295,ee=J+(le<<7&4294967295|le>>>25),le=ae+(X^ee&(J^X))+ye[5]+1200080426&4294967295,ae=ee+(le<<12&4294967295|le>>>20),le=X+(J^ae&(ee^J))+ye[6]+2821735955&4294967295,X=ae+(le<<17&4294967295|le>>>15),le=J+(ee^X&(ae^ee))+ye[7]+4249261313&4294967295,J=X+(le<<22&4294967295|le>>>10),le=ee+(ae^J&(X^ae))+ye[8]+1770035416&4294967295,ee=J+(le<<7&4294967295|le>>>25),le=ae+(X^ee&(J^X))+ye[9]+2336552879&4294967295,ae=ee+(le<<12&4294967295|le>>>20),le=X+(J^ae&(ee^J))+ye[10]+4294925233&4294967295,X=ae+(le<<17&4294967295|le>>>15),le=J+(ee^X&(ae^ee))+ye[11]+2304563134&4294967295,J=X+(le<<22&4294967295|le>>>10),le=ee+(ae^J&(X^ae))+ye[12]+1804603682&4294967295,ee=J+(le<<7&4294967295|le>>>25),le=ae+(X^ee&(J^X))+ye[13]+4254626195&4294967295,ae=ee+(le<<12&4294967295|le>>>20),le=X+(J^ae&(ee^J))+ye[14]+2792965006&4294967295,X=ae+(le<<17&4294967295|le>>>15),le=J+(ee^X&(ae^ee))+ye[15]+1236535329&4294967295,J=X+(le<<22&4294967295|le>>>10),le=ee+(X^ae&(J^X))+ye[1]+4129170786&4294967295,ee=J+(le<<5&4294967295|le>>>27),le=ae+(J^X&(ee^J))+ye[6]+3225465664&4294967295,ae=ee+(le<<9&4294967295|le>>>23),le=X+(ee^J&(ae^ee))+ye[11]+643717713&4294967295,X=ae+(le<<14&4294967295|le>>>18),le=J+(ae^ee&(X^ae))+ye[0]+3921069994&4294967295,J=X+(le<<20&4294967295|le>>>12),le=ee+(X^ae&(J^X))+ye[5]+3593408605&4294967295,ee=J+(le<<5&4294967295|le>>>27),le=ae+(J^X&(ee^J))+ye[10]+38016083&4294967295,ae=ee+(le<<9&4294967295|le>>>23),le=X+(ee^J&(ae^ee))+ye[15]+3634488961&4294967295,X=ae+(le<<14&4294967295|le>>>18),le=J+(ae^ee&(X^ae))+ye[4]+3889429448&4294967295,J=X+(le<<20&4294967295|le>>>12),le=ee+(X^ae&(J^X))+ye[9]+568446438&4294967295,ee=J+(le<<5&4294967295|le>>>27),le=ae+(J^X&(ee^J))+ye[14]+3275163606&4294967295,ae=ee+(le<<9&4294967295|le>>>23),le=X+(ee^J&(ae^ee))+ye[3]+4107603335&4294967295,X=ae+(le<<14&4294967295|le>>>18),le=J+(ae^ee&(X^ae))+ye[8]+1163531501&4294967295,J=X+(le<<20&4294967295|le>>>12),le=ee+(X^ae&(J^X))+ye[13]+2850285829&4294967295,ee=J+(le<<5&4294967295|le>>>27),le=ae+(J^X&(ee^J))+ye[2]+4243563512&4294967295,ae=ee+(le<<9&4294967295|le>>>23),le=X+(ee^J&(ae^ee))+ye[7]+1735328473&4294967295,X=ae+(le<<14&4294967295|le>>>18),le=J+(ae^ee&(X^ae))+ye[12]+2368359562&4294967295,J=X+(le<<20&4294967295|le>>>12),le=ee+(J^X^ae)+ye[5]+4294588738&4294967295,ee=J+(le<<4&4294967295|le>>>28),le=ae+(ee^J^X)+ye[8]+2272392833&4294967295,ae=ee+(le<<11&4294967295|le>>>21),le=X+(ae^ee^J)+ye[11]+1839030562&4294967295,X=ae+(le<<16&4294967295|le>>>16),le=J+(X^ae^ee)+ye[14]+4259657740&4294967295,J=X+(le<<23&4294967295|le>>>9),le=ee+(J^X^ae)+ye[1]+2763975236&4294967295,ee=J+(le<<4&4294967295|le>>>28),le=ae+(ee^J^X)+ye[4]+1272893353&4294967295,ae=ee+(le<<11&4294967295|le>>>21),le=X+(ae^ee^J)+ye[7]+4139469664&4294967295,X=ae+(le<<16&4294967295|le>>>16),le=J+(X^ae^ee)+ye[10]+3200236656&4294967295,J=X+(le<<23&4294967295|le>>>9),le=ee+(J^X^ae)+ye[13]+681279174&4294967295,ee=J+(le<<4&4294967295|le>>>28),le=ae+(ee^J^X)+ye[0]+3936430074&4294967295,ae=ee+(le<<11&4294967295|le>>>21),le=X+(ae^ee^J)+ye[3]+3572445317&4294967295,X=ae+(le<<16&4294967295|le>>>16),le=J+(X^ae^ee)+ye[6]+76029189&4294967295,J=X+(le<<23&4294967295|le>>>9),le=ee+(J^X^ae)+ye[9]+3654602809&4294967295,ee=J+(le<<4&4294967295|le>>>28),le=ae+(ee^J^X)+ye[12]+3873151461&4294967295,ae=ee+(le<<11&4294967295|le>>>21),le=X+(ae^ee^J)+ye[15]+530742520&4294967295,X=ae+(le<<16&4294967295|le>>>16),le=J+(X^ae^ee)+ye[2]+3299628645&4294967295,J=X+(le<<23&4294967295|le>>>9),le=ee+(X^(J|~ae))+ye[0]+4096336452&4294967295,ee=J+(le<<6&4294967295|le>>>26),le=ae+(J^(ee|~X))+ye[7]+1126891415&4294967295,ae=ee+(le<<10&4294967295|le>>>22),le=X+(ee^(ae|~J))+ye[14]+2878612391&4294967295,X=ae+(le<<15&4294967295|le>>>17),le=J+(ae^(X|~ee))+ye[5]+4237533241&4294967295,J=X+(le<<21&4294967295|le>>>11),le=ee+(X^(J|~ae))+ye[12]+1700485571&4294967295,ee=J+(le<<6&4294967295|le>>>26),le=ae+(J^(ee|~X))+ye[3]+2399980690&4294967295,ae=ee+(le<<10&4294967295|le>>>22),le=X+(ee^(ae|~J))+ye[10]+4293915773&4294967295,X=ae+(le<<15&4294967295|le>>>17),le=J+(ae^(X|~ee))+ye[1]+2240044497&4294967295,J=X+(le<<21&4294967295|le>>>11),le=ee+(X^(J|~ae))+ye[8]+1873313359&4294967295,ee=J+(le<<6&4294967295|le>>>26),le=ae+(J^(ee|~X))+ye[15]+4264355552&4294967295,ae=ee+(le<<10&4294967295|le>>>22),le=X+(ee^(ae|~J))+ye[6]+2734768916&4294967295,X=ae+(le<<15&4294967295|le>>>17),le=J+(ae^(X|~ee))+ye[13]+1309151649&4294967295,J=X+(le<<21&4294967295|le>>>11),le=ee+(X^(J|~ae))+ye[4]+4149444226&4294967295,ee=J+(le<<6&4294967295|le>>>26),le=ae+(J^(ee|~X))+ye[11]+3174756917&4294967295,ae=ee+(le<<10&4294967295|le>>>22),le=X+(ee^(ae|~J))+ye[2]+718787259&4294967295,X=ae+(le<<15&4294967295|le>>>17),le=J+(ae^(X|~ee))+ye[9]+3951481745&4294967295,pe.g[0]=pe.g[0]+ee&4294967295,pe.g[1]=pe.g[1]+(X+(le<<21&4294967295|le>>>11))&4294967295,pe.g[2]=pe.g[2]+X&4294967295,pe.g[3]=pe.g[3]+ae&4294967295}n.prototype.v=function(pe,ee){ee===void 0&&(ee=pe.length);const J=ee-this.blockSize,ye=this.C;let X=this.h,ae=0;for(;ae<ee;){if(X==0)for(;ae<=J;)r(this,pe,ae),ae+=this.blockSize;if(typeof pe=="string"){for(;ae<ee;)if(ye[X++]=pe.charCodeAt(ae++),X==this.blockSize){r(this,ye),X=0;break}}else for(;ae<ee;)if(ye[X++]=pe[ae++],X==this.blockSize){r(this,ye),X=0;break}}this.h=X,this.o+=ee},n.prototype.A=function(){var pe=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);pe[0]=128;for(var ee=1;ee<pe.length-8;++ee)pe[ee]=0;ee=this.o*8;for(var J=pe.length-8;J<pe.length;++J)pe[J]=ee&255,ee/=256;for(this.v(pe),pe=Array(16),ee=0,J=0;J<4;++J)for(let ye=0;ye<32;ye+=8)pe[ee++]=this.g[J]>>>ye&255;return pe};function s(pe,ee){var J=u;return Object.prototype.hasOwnProperty.call(J,pe)?J[pe]:J[pe]=ee(pe)}function l(pe,ee){this.h=ee;const J=[];let ye=!0;for(let X=pe.length-1;X>=0;X--){const ae=pe[X]|0;ye&&ae==ee||(J[X]=ae,ye=!1)}this.g=J}var u={};function h(pe){return-128<=pe&&pe<128?s(pe,function(ee){return new l([ee|0],ee<0?-1:0)}):new l([pe|0],pe<0?-1:0)}function f(pe){if(isNaN(pe)||!isFinite(pe))return g;if(pe<0)return W(f(-pe));const ee=[];let J=1;for(let ye=0;pe>=J;ye++)ee[ye]=pe/J|0,J*=4294967296;return new l(ee,0)}function x(pe,ee){if(pe.length==0)throw Error("number format error: empty string");if(ee=ee||10,ee<2||36<ee)throw Error("radix out of range: "+ee);if(pe.charAt(0)=="-")return W(x(pe.substring(1),ee));if(pe.indexOf("-")>=0)throw Error('number format error: interior "-" character');const J=f(Math.pow(ee,8));let ye=g;for(let ae=0;ae<pe.length;ae+=8){var X=Math.min(8,pe.length-ae);const le=parseInt(pe.substring(ae,ae+X),ee);X<8?(X=f(Math.pow(ee,X)),ye=ye.j(X).add(f(le))):(ye=ye.j(J),ye=ye.add(f(le)))}return ye}var g=h(0),w=h(1),A=h(16777216);i=l.prototype,i.m=function(){if($(this))return-W(this).m();let pe=0,ee=1;for(let J=0;J<this.g.length;J++){const ye=this.i(J);pe+=(ye>=0?ye:4294967296+ye)*ee,ee*=4294967296}return pe},i.toString=function(pe){if(pe=pe||10,pe<2||36<pe)throw Error("radix out of range: "+pe);if(B(this))return"0";if($(this))return"-"+W(this).toString(pe);const ee=f(Math.pow(pe,6));var J=this;let ye="";for(;;){const X=me(J,ee).g;J=q(J,X.j(ee));let ae=((J.g.length>0?J.g[0]:J.h)>>>0).toString(pe);if(J=X,B(J))return ae+ye;for(;ae.length<6;)ae="0"+ae;ye=ae+ye}},i.i=function(pe){return pe<0?0:pe<this.g.length?this.g[pe]:this.h};function B(pe){if(pe.h!=0)return!1;for(let ee=0;ee<pe.g.length;ee++)if(pe.g[ee]!=0)return!1;return!0}function $(pe){return pe.h==-1}i.l=function(pe){return pe=q(this,pe),$(pe)?-1:B(pe)?0:1};function W(pe){const ee=pe.g.length,J=[];for(let ye=0;ye<ee;ye++)J[ye]=~pe.g[ye];return new l(J,~pe.h).add(w)}i.abs=function(){return $(this)?W(this):this},i.add=function(pe){const ee=Math.max(this.g.length,pe.g.length),J=[];let ye=0;for(let X=0;X<=ee;X++){let ae=ye+(this.i(X)&65535)+(pe.i(X)&65535),le=(ae>>>16)+(this.i(X)>>>16)+(pe.i(X)>>>16);ye=le>>>16,ae&=65535,le&=65535,J[X]=le<<16|ae}return new l(J,J[J.length-1]&-2147483648?-1:0)};function q(pe,ee){return pe.add(W(ee))}i.j=function(pe){if(B(this)||B(pe))return g;if($(this))return $(pe)?W(this).j(W(pe)):W(W(this).j(pe));if($(pe))return W(this.j(W(pe)));if(this.l(A)<0&&pe.l(A)<0)return f(this.m()*pe.m());const ee=this.g.length+pe.g.length,J=[];for(var ye=0;ye<2*ee;ye++)J[ye]=0;for(ye=0;ye<this.g.length;ye++)for(let X=0;X<pe.g.length;X++){const ae=this.i(ye)>>>16,le=this.i(ye)&65535,ze=pe.i(X)>>>16,nt=pe.i(X)&65535;J[2*ye+2*X]+=le*nt,ge(J,2*ye+2*X),J[2*ye+2*X+1]+=ae*nt,ge(J,2*ye+2*X+1),J[2*ye+2*X+1]+=le*ze,ge(J,2*ye+2*X+1),J[2*ye+2*X+2]+=ae*ze,ge(J,2*ye+2*X+2)}for(pe=0;pe<ee;pe++)J[pe]=J[2*pe+1]<<16|J[2*pe];for(pe=ee;pe<2*ee;pe++)J[pe]=0;return new l(J,0)};function ge(pe,ee){for(;(pe[ee]&65535)!=pe[ee];)pe[ee+1]+=pe[ee]>>>16,pe[ee]&=65535,ee++}function he(pe,ee){this.g=pe,this.h=ee}function me(pe,ee){if(B(ee))throw Error("division by zero");if(B(pe))return new he(g,g);if($(pe))return ee=me(W(pe),ee),new he(W(ee.g),W(ee.h));if($(ee))return ee=me(pe,W(ee)),new he(W(ee.g),ee.h);if(pe.g.length>30){if($(pe)||$(ee))throw Error("slowDivide_ only works with positive integers.");for(var J=w,ye=ee;ye.l(pe)<=0;)J=Ce(J),ye=Ce(ye);var X=Ve(J,1),ae=Ve(ye,1);for(ye=Ve(ye,2),J=Ve(J,2);!B(ye);){var le=ae.add(ye);le.l(pe)<=0&&(X=X.add(J),ae=le),ye=Ve(ye,1),J=Ve(J,1)}return ee=q(pe,X.j(ee)),new he(X,ee)}for(X=g;pe.l(ee)>=0;){for(J=Math.max(1,Math.floor(pe.m()/ee.m())),ye=Math.ceil(Math.log(J)/Math.LN2),ye=ye<=48?1:Math.pow(2,ye-48),ae=f(J),le=ae.j(ee);$(le)||le.l(pe)>0;)J-=ye,ae=f(J),le=ae.j(ee);B(ae)&&(ae=w),X=X.add(ae),pe=q(pe,le)}return new he(X,pe)}i.B=function(pe){return me(this,pe).h},i.and=function(pe){const ee=Math.max(this.g.length,pe.g.length),J=[];for(let ye=0;ye<ee;ye++)J[ye]=this.i(ye)&pe.i(ye);return new l(J,this.h&pe.h)},i.or=function(pe){const ee=Math.max(this.g.length,pe.g.length),J=[];for(let ye=0;ye<ee;ye++)J[ye]=this.i(ye)|pe.i(ye);return new l(J,this.h|pe.h)},i.xor=function(pe){const ee=Math.max(this.g.length,pe.g.length),J=[];for(let ye=0;ye<ee;ye++)J[ye]=this.i(ye)^pe.i(ye);return new l(J,this.h^pe.h)};function Ce(pe){const ee=pe.g.length+1,J=[];for(let ye=0;ye<ee;ye++)J[ye]=pe.i(ye)<<1|pe.i(ye-1)>>>31;return new l(J,pe.h)}function Ve(pe,ee){const J=ee>>5;ee%=32;const ye=pe.g.length-J,X=[];for(let ae=0;ae<ye;ae++)X[ae]=ee>0?pe.i(ae+J)>>>ee|pe.i(ae+J+1)<<32-ee:pe.i(ae+J);return new l(X,pe.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,a3=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=x,Hh=l}).apply(typeof uA<"u"?uA:typeof self<"u"?self:typeof window<"u"?window:{});var jy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var o3,Lg,l3,f0,qb,u3,c3,h3;(function(){var i,e=Object.defineProperty;function t(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof jy=="object"&&jy];for(var K=0;K<E.length;++K){var ne=E[K];if(ne&&ne.Math==Math)return ne}throw Error("Cannot find global object")}var n=t(this);function r(E,K){if(K)e:{var ne=n;E=E.split(".");for(var Ie=0;Ie<E.length-1;Ie++){var st=E[Ie];if(!(st in ne))break e;ne=ne[st]}E=E[E.length-1],Ie=ne[E],K=K(Ie),K!=Ie&&K!=null&&e(ne,E,{configurable:!0,writable:!0,value:K})}}r("Symbol.dispose",function(E){return E||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(E){return E||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(E){return E||function(K){var ne=[],Ie;for(Ie in K)Object.prototype.hasOwnProperty.call(K,Ie)&&ne.push([Ie,K[Ie]]);return ne}});var s=s||{},l=this||self;function u(E){var K=typeof E;return K=="object"&&E!=null||K=="function"}function h(E,K,ne){return E.call.apply(E.bind,arguments)}function f(E,K,ne){return f=h,f.apply(null,arguments)}function x(E,K){var ne=Array.prototype.slice.call(arguments,1);return function(){var Ie=ne.slice();return Ie.push.apply(Ie,arguments),E.apply(this,Ie)}}function g(E,K){function ne(){}ne.prototype=K.prototype,E.Z=K.prototype,E.prototype=new ne,E.prototype.constructor=E,E.Ob=function(Ie,st,ft){for(var jt=Array(arguments.length-2),Zn=2;Zn<arguments.length;Zn++)jt[Zn-2]=arguments[Zn];return K.prototype[st].apply(Ie,jt)}}var w=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?E=>E&&AsyncContext.Snapshot.wrap(E):E=>E;function A(E){const K=E.length;if(K>0){const ne=Array(K);for(let Ie=0;Ie<K;Ie++)ne[Ie]=E[Ie];return ne}return[]}function B(E,K){for(let Ie=1;Ie<arguments.length;Ie++){const st=arguments[Ie];var ne=typeof st;if(ne=ne!="object"?ne:st?Array.isArray(st)?"array":ne:"null",ne=="array"||ne=="object"&&typeof st.length=="number"){ne=E.length||0;const ft=st.length||0;E.length=ne+ft;for(let jt=0;jt<ft;jt++)E[ne+jt]=st[jt]}else E.push(st)}}class ${constructor(K,ne){this.i=K,this.j=ne,this.h=0,this.g=null}get(){let K;return this.h>0?(this.h--,K=this.g,this.g=K.next,K.next=null):K=this.i(),K}}function W(E){l.setTimeout(()=>{throw E},0)}function q(){var E=pe;let K=null;return E.g&&(K=E.g,E.g=E.g.next,E.g||(E.h=null),K.next=null),K}class ge{constructor(){this.h=this.g=null}add(K,ne){const Ie=he.get();Ie.set(K,ne),this.h?this.h.next=Ie:this.g=Ie,this.h=Ie}}var he=new $(()=>new me,E=>E.reset());class me{constructor(){this.next=this.g=this.h=null}set(K,ne){this.h=K,this.g=ne,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,Ve=!1,pe=new ge,ee=()=>{const E=Promise.resolve(void 0);Ce=()=>{E.then(J)}};function J(){for(var E;E=q();){try{E.h.call(E.g)}catch(ne){W(ne)}var K=he;K.j(E),K.h<100&&(K.h++,E.next=K.g,K.g=E)}Ve=!1}function ye(){this.u=this.u,this.C=this.C}ye.prototype.u=!1,ye.prototype.dispose=function(){this.u||(this.u=!0,this.N())},ye.prototype[Symbol.dispose]=function(){this.dispose()},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(E,K){this.type=E,this.g=this.target=K,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var ae=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var E=!1,K=Object.defineProperty({},"passive",{get:function(){E=!0}});try{const ne=()=>{};l.addEventListener("test",ne,K),l.removeEventListener("test",ne,K)}catch{}return E})();function le(E){return/^[\s\xa0]*$/.test(E)}function ze(E,K){X.call(this,E?E.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,E&&this.init(E,K)}g(ze,X),ze.prototype.init=function(E,K){const ne=this.type=E.type,Ie=E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:null;this.target=E.target||E.srcElement,this.g=K,K=E.relatedTarget,K||(ne=="mouseover"?K=E.fromElement:ne=="mouseout"&&(K=E.toElement)),this.relatedTarget=K,Ie?(this.clientX=Ie.clientX!==void 0?Ie.clientX:Ie.pageX,this.clientY=Ie.clientY!==void 0?Ie.clientY:Ie.pageY,this.screenX=Ie.screenX||0,this.screenY=Ie.screenY||0):(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0),this.button=E.button,this.key=E.key||"",this.ctrlKey=E.ctrlKey,this.altKey=E.altKey,this.shiftKey=E.shiftKey,this.metaKey=E.metaKey,this.pointerId=E.pointerId||0,this.pointerType=E.pointerType,this.state=E.state,this.i=E,E.defaultPrevented&&ze.Z.h.call(this)},ze.prototype.h=function(){ze.Z.h.call(this);const E=this.i;E.preventDefault?E.preventDefault():E.returnValue=!1};var nt="closure_listenable_"+(Math.random()*1e6|0),je=0;function Je(E,K,ne,Ie,st){this.listener=E,this.proxy=null,this.src=K,this.type=ne,this.capture=!!Ie,this.ha=st,this.key=++je,this.da=this.fa=!1}function qe(E){E.da=!0,E.listener=null,E.proxy=null,E.src=null,E.ha=null}function ot(E,K,ne){for(const Ie in E)K.call(ne,E[Ie],Ie,E)}function St(E,K){for(const ne in E)K.call(void 0,E[ne],ne,E)}function Ne(E){const K={};for(const ne in E)K[ne]=E[ne];return K}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ee(E,K){let ne,Ie;for(let st=1;st<arguments.length;st++){Ie=arguments[st];for(ne in Ie)E[ne]=Ie[ne];for(let ft=0;ft<se.length;ft++)ne=se[ft],Object.prototype.hasOwnProperty.call(Ie,ne)&&(E[ne]=Ie[ne])}}function De(E){this.src=E,this.g={},this.h=0}De.prototype.add=function(E,K,ne,Ie,st){const ft=E.toString();E=this.g[ft],E||(E=this.g[ft]=[],this.h++);const jt=$e(E,K,Ie,st);return jt>-1?(K=E[jt],ne||(K.fa=!1)):(K=new Je(K,this.src,ft,!!Ie,st),K.fa=ne,E.push(K)),K};function Be(E,K){const ne=K.type;if(ne in E.g){var Ie=E.g[ne],st=Array.prototype.indexOf.call(Ie,K,void 0),ft;(ft=st>=0)&&Array.prototype.splice.call(Ie,st,1),ft&&(qe(K),E.g[ne].length==0&&(delete E.g[ne],E.h--))}}function $e(E,K,ne,Ie){for(let st=0;st<E.length;++st){const ft=E[st];if(!ft.da&&ft.listener==K&&ft.capture==!!ne&&ft.ha==Ie)return st}return-1}var Ye="closure_lm_"+(Math.random()*1e6|0),ct={};function ut(E,K,ne,Ie,st){if(Array.isArray(K)){for(let ft=0;ft<K.length;ft++)ut(E,K[ft],ne,Ie,st);return null}return ne=wn(ne),E&&E[nt]?E.J(K,ne,u(Ie)?!!Ie.capture:!1,st):Tt(E,K,ne,!1,Ie,st)}function Tt(E,K,ne,Ie,st,ft){if(!K)throw Error("Invalid event type");const jt=u(st)?!!st.capture:!!st;let Zn=$t(E);if(Zn||(E[Ye]=Zn=new De(E)),ne=Zn.add(K,ne,Ie,jt,ft),ne.proxy)return ne;if(Ie=Ft(),ne.proxy=Ie,Ie.src=E,Ie.listener=ne,E.addEventListener)ae||(st=jt),st===void 0&&(st=!1),E.addEventListener(K.toString(),Ie,st);else if(E.attachEvent)E.attachEvent(Et(K.toString()),Ie);else if(E.addListener&&E.removeListener)E.addListener(Ie);else throw Error("addEventListener and attachEvent are unavailable.");return ne}function Ft(){function E(ne){return K.call(E.src,E.listener,ne)}const K=Pe;return E}function Wt(E,K,ne,Ie,st){if(Array.isArray(K))for(var ft=0;ft<K.length;ft++)Wt(E,K[ft],ne,Ie,st);else Ie=u(Ie)?!!Ie.capture:!!Ie,ne=wn(ne),E&&E[nt]?(E=E.i,ft=String(K).toString(),ft in E.g&&(K=E.g[ft],ne=$e(K,ne,Ie,st),ne>-1&&(qe(K[ne]),Array.prototype.splice.call(K,ne,1),K.length==0&&(delete E.g[ft],E.h--)))):E&&(E=$t(E))&&(K=E.g[K.toString()],E=-1,K&&(E=$e(K,ne,Ie,st)),(ne=E>-1?K[E]:null)&&qt(ne))}function qt(E){if(typeof E!="number"&&E&&!E.da){var K=E.src;if(K&&K[nt])Be(K.i,E);else{var ne=E.type,Ie=E.proxy;K.removeEventListener?K.removeEventListener(ne,Ie,E.capture):K.detachEvent?K.detachEvent(Et(ne),Ie):K.addListener&&K.removeListener&&K.removeListener(Ie),(ne=$t(K))?(Be(ne,E),ne.h==0&&(ne.src=null,K[Ye]=null)):qe(E)}}}function Et(E){return E in ct?ct[E]:ct[E]="on"+E}function Pe(E,K){if(E.da)E=!0;else{K=new ze(K,this);const ne=E.listener,Ie=E.ha||E.src;E.fa&&qt(E),E=ne.call(Ie,K)}return E}function $t(E){return E=E[Ye],E instanceof De?E:null}var Dt="__closure_events_fn_"+(Math.random()*1e9>>>0);function wn(E){return typeof E=="function"?E:(E[Dt]||(E[Dt]=function(K){return E.handleEvent(K)}),E[Dt])}function _t(){ye.call(this),this.i=new De(this),this.M=this,this.G=null}g(_t,ye),_t.prototype[nt]=!0,_t.prototype.removeEventListener=function(E,K,ne,Ie){Wt(this,E,K,ne,Ie)};function en(E,K){var ne,Ie=E.G;if(Ie)for(ne=[];Ie;Ie=Ie.G)ne.push(Ie);if(E=E.M,Ie=K.type||K,typeof K=="string")K=new X(K,E);else if(K instanceof X)K.target=K.target||E;else{var st=K;K=new X(Ie,E),Ee(K,st)}st=!0;let ft,jt;if(ne)for(jt=ne.length-1;jt>=0;jt--)ft=K.g=ne[jt],st=Xt(ft,Ie,!0,K)&&st;if(ft=K.g=E,st=Xt(ft,Ie,!0,K)&&st,st=Xt(ft,Ie,!1,K)&&st,ne)for(jt=0;jt<ne.length;jt++)ft=K.g=ne[jt],st=Xt(ft,Ie,!1,K)&&st}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var E=this.i;for(const K in E.g){const ne=E.g[K];for(let Ie=0;Ie<ne.length;Ie++)qe(ne[Ie]);delete E.g[K],E.h--}}this.G=null},_t.prototype.J=function(E,K,ne,Ie){return this.i.add(String(E),K,!1,ne,Ie)},_t.prototype.K=function(E,K,ne,Ie){return this.i.add(String(E),K,!0,ne,Ie)};function Xt(E,K,ne,Ie){if(K=E.i.g[String(K)],!K)return!0;K=K.concat();let st=!0;for(let ft=0;ft<K.length;++ft){const jt=K[ft];if(jt&&!jt.da&&jt.capture==ne){const Zn=jt.listener,lr=jt.ha||jt.src;jt.fa&&Be(E.i,jt),st=Zn.call(lr,Ie)!==!1&&st}}return st&&!Ie.defaultPrevented}function Tn(E,K){if(typeof E!="function")if(E&&typeof E.handleEvent=="function")E=f(E.handleEvent,E);else throw Error("Invalid listener argument");return Number(K)>2147483647?-1:l.setTimeout(E,K||0)}function bn(E){E.g=Tn(()=>{E.g=null,E.i&&(E.i=!1,bn(E))},E.l);const K=E.h;E.h=null,E.m.apply(null,K)}class Un extends ye{constructor(K,ne){super(),this.m=K,this.l=ne,this.h=null,this.i=!1,this.g=null}j(K){this.h=arguments,this.g?this.i=!0:bn(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ii(E){ye.call(this),this.h=E,this.g={}}g(ii,ye);var Bn=[];function li(E){ot(E.g,function(K,ne){this.g.hasOwnProperty(ne)&&qt(K)},E),E.g={}}ii.prototype.N=function(){ii.Z.N.call(this),li(this)},ii.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xn=l.JSON.stringify,ln=l.JSON.parse,$n=class{stringify(E){return l.JSON.stringify(E,void 0)}parse(E){return l.JSON.parse(E,void 0)}};function cn(){}function er(){}var Jn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function mn(){X.call(this,"d")}g(mn,X);function On(){X.call(this,"c")}g(On,X);var qn={},on=null;function Ni(){return on=on||new _t}qn.Ia="serverreachability";function Mn(E){X.call(this,qn.Ia,E)}g(Mn,X);function xn(E){const K=Ni();en(K,new Mn(K))}qn.STAT_EVENT="statevent";function Qn(E,K){X.call(this,qn.STAT_EVENT,E),this.stat=K}g(Qn,X);function Qt(E){const K=Ni();en(K,new Qn(K,E))}qn.Ja="timingevent";function Ht(E,K){X.call(this,qn.Ja,E),this.size=K}g(Ht,X);function Kn(E,K){if(typeof E!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){E()},K)}function kr(){this.g=!0}kr.prototype.ua=function(){this.g=!1};function vr(E,K,ne,Ie,st,ft){E.info(function(){if(E.g)if(ft){var jt="",Zn=ft.split("&");for(let ui=0;ui<Zn.length;ui++){var lr=Zn[ui].split("=");if(lr.length>1){const nr=lr[0];lr=lr[1];const $s=nr.split("_");jt=$s.length>=2&&$s[1]=="type"?jt+(nr+"="+lr+"&"):jt+(nr+"=redacted&")}}}else jt=null;else jt=ft;return"XMLHTTP REQ ("+Ie+") [attempt "+st+"]: "+K+`
`+ne+`
`+jt})}function Cr(E,K,ne,Ie,st,ft,jt){E.info(function(){return"XMLHTTP RESP ("+Ie+") [ attempt "+st+"]: "+K+`
`+ne+`
`+ft+" "+jt})}function Ci(E,K,ne,Ie){E.info(function(){return"XMLHTTP TEXT ("+K+"): "+Aa(E,ne)+(Ie?" "+Ie:"")})}function dn(E,K){E.info(function(){return"TIMEOUT: "+K})}kr.prototype.info=function(){};function Aa(E,K){if(!E.g)return K;if(!K)return null;try{const ft=JSON.parse(K);if(ft){for(E=0;E<ft.length;E++)if(Array.isArray(ft[E])){var ne=ft[E];if(!(ne.length<2)){var Ie=ne[1];if(Array.isArray(Ie)&&!(Ie.length<1)){var st=Ie[0];if(st!="noop"&&st!="stop"&&st!="close")for(let jt=1;jt<Ie.length;jt++)Ie[jt]=""}}}}return Xn(ft)}catch{return K}}var ta={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Rr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ms;function Pi(){}g(Pi,cn),Pi.prototype.g=function(){return new XMLHttpRequest},ms=new Pi;function tr(E){return encodeURIComponent(String(E))}function cr(E){var K=1;E=E.split(":");const ne=[];for(;K>0&&E.length;)ne.push(E.shift()),K--;return E.length&&ne.push(E.join(":")),ne}function os(E,K,ne,Ie){this.j=E,this.i=K,this.l=ne,this.S=Ie||1,this.V=new ii(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Zr}function Zr(){this.i=null,this.g="",this.h=!1}var qi={},Yi={};function Kr(E,K,ne){E.M=1,E.A=za(_r(K)),E.u=ne,E.R=!0,ls(E,null)}function ls(E,K){E.F=Date.now(),es(E),E.B=_r(E.A);var ne=E.B,Ie=E.S;Array.isArray(Ie)||(Ie=[String(Ie)]),zo(ne.i,"t",Ie),E.C=0,ne=E.j.L,E.h=new Zr,E.g=an(E.j,ne?K:null,!E.u),E.P>0&&(E.O=new Un(f(E.Y,E,E.g),E.P)),K=E.V,ne=E.g,Ie=E.ba;var st="readystatechange";Array.isArray(st)||(st&&(Bn[0]=st.toString()),st=Bn);for(let ft=0;ft<st.length;ft++){const jt=ut(ne,st[ft],Ie||K.handleEvent,!1,K.h||K);if(!jt)break;K.g[jt.key]=jt}K=E.J?Ne(E.J):{},E.u?(E.v||(E.v="POST"),K["Content-Type"]="application/x-www-form-urlencoded",E.g.ea(E.B,E.v,E.u,K)):(E.v="GET",E.g.ea(E.B,E.v,null,K)),xn(),vr(E.i,E.v,E.B,E.l,E.S,E.u)}os.prototype.ba=function(E){E=E.target;const K=this.O;K&&qr(E)==3?K.j():this.Y(E)},os.prototype.Y=function(E){try{if(E==this.g)e:{const Zn=qr(this.g),lr=this.g.ya(),ui=this.g.ca();if(!(Zn<3)&&(Zn!=3||this.g&&(this.h.h||this.g.la()||Tr(this.g)))){this.K||Zn!=4||lr==7||(lr==8||ui<=0?xn(3):xn(2)),Ps(this);var K=this.g.ca();this.X=K;var ne=da(this);if(this.o=K==200,Cr(this.i,this.v,this.B,this.l,this.S,Zn,K),this.o){if(this.U&&!this.L){t:{if(this.g){var Ie,st=this.g;if((Ie=st.g?st.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!le(Ie)){var ft=Ie;break t}}ft=null}if(E=ft)Ci(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ms(this,E);else{this.o=!1,this.m=3,Qt(12),na(this),Os(this);break e}}if(this.R){E=!0;let nr;for(;!this.K&&this.C<ne.length;)if(nr=ys(this,ne),nr==Yi){Zn==4&&(this.m=4,Qt(14),E=!1),Ci(this.i,this.l,null,"[Incomplete Response]");break}else if(nr==qi){this.m=4,Qt(15),Ci(this.i,this.l,ne,"[Invalid Chunk]"),E=!1;break}else Ci(this.i,this.l,nr,null),Ms(this,nr);if(Va(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zn!=4||ne.length!=0||this.h.h||(this.m=1,Qt(16),E=!1),this.o=this.o&&E,!E)Ci(this.i,this.l,ne,"[Invalid Chunked Response]"),na(this),Os(this);else if(ne.length>0&&!this.W){this.W=!0;var jt=this.j;jt.g==this&&jt.aa&&!jt.P&&(jt.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),bl(jt),jt.P=!0,Qt(11))}}else Ci(this.i,this.l,ne,null),Ms(this,ne);Zn==4&&na(this),this.o&&!this.K&&(Zn==4?Me(this.j,this):(this.o=!1,es(this)))}else ka(this.g),K==400&&ne.indexOf("Unknown SID")>0?(this.m=3,Qt(12)):(this.m=0,Qt(13)),na(this),Os(this)}}}catch{}finally{}};function da(E){if(!Va(E))return E.g.la();const K=Tr(E.g);if(K==="")return"";let ne="";const Ie=K.length,st=qr(E.g)==4;if(!E.h.i){if(typeof TextDecoder>"u")return na(E),Os(E),"";E.h.i=new l.TextDecoder}for(let ft=0;ft<Ie;ft++)E.h.h=!0,ne+=E.h.i.decode(K[ft],{stream:!(st&&ft==Ie-1)});return K.length=0,E.h.g+=ne,E.C=0,E.h.g}function Va(E){return E.g?E.v=="GET"&&E.M!=2&&E.j.Aa:!1}function ys(E,K){var ne=E.C,Ie=K.indexOf(`
`,ne);return Ie==-1?Yi:(ne=Number(K.substring(ne,Ie)),isNaN(ne)?qi:(Ie+=1,Ie+ne>K.length?Yi:(K=K.slice(Ie,Ie+ne),E.C=Ie+ne,K)))}os.prototype.cancel=function(){this.K=!0,na(this)};function es(E){E.T=Date.now()+E.H,to(E,E.H)}function to(E,K){if(E.D!=null)throw Error("WatchDog timer not null");E.D=Kn(f(E.aa,E),K)}function Ps(E){E.D&&(l.clearTimeout(E.D),E.D=null)}os.prototype.aa=function(){this.D=null;const E=Date.now();E-this.T>=0?(dn(this.i,this.B),this.M!=2&&(xn(),Qt(17)),na(this),this.m=2,Os(this)):to(this,this.T-E)};function Os(E){E.j.I==0||E.K||Me(E.j,E)}function na(E){Ps(E);var K=E.O;K&&typeof K.dispose=="function"&&K.dispose(),E.O=null,li(E.V),E.g&&(K=E.g,E.g=null,K.abort(),K.dispose())}function Ms(E,K){try{var ne=E.j;if(ne.I!=0&&(ne.g==E||Ts(ne.h,E))){if(!E.L&&Ts(ne.h,E)&&ne.I==3){try{var Ie=ne.Ba.g.parse(K)}catch{Ie=null}if(Array.isArray(Ie)&&Ie.length==3){var st=Ie;if(st[0]==0){e:if(!ne.v){if(ne.g)if(ne.g.F+3e3<E.F)fe(ne),us(ne);else break e;ro(ne),Qt(18)}}else ne.xa=st[1],0<ne.xa-ne.K&&st[2]<37500&&ne.F&&ne.A==0&&!ne.C&&(ne.C=Kn(f(ne.Va,ne),6e3));fa(ne.h)<=1&&ne.ta&&(ne.ta=void 0)}else tt(ne,11)}else if((E.L||ne.g==E)&&fe(ne),!le(K))for(st=ne.Ba.g.parse(K),K=0;K<st.length;K++){let ui=st[K];const nr=ui[0];if(!(nr<=ne.K))if(ne.K=nr,ui=ui[1],ne.I==2)if(ui[0]=="c"){ne.M=ui[1],ne.ba=ui[2];const $s=ui[3];$s!=null&&(ne.ka=$s,ne.j.info("VER="+ne.ka));const ra=ui[4];ra!=null&&(ne.za=ra,ne.j.info("SVER="+ne.za));const xr=ui[5];xr!=null&&typeof xr=="number"&&xr>0&&(Ie=1.5*xr,ne.O=Ie,ne.j.info("backChannelRequestTimeoutMs_="+Ie)),Ie=ne;const sa=E.g;if(sa){const Ga=sa.g?sa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ga){var ft=Ie.h;ft.g||Ga.indexOf("spdy")==-1&&Ga.indexOf("quic")==-1&&Ga.indexOf("h2")==-1||(ft.j=ft.l,ft.g=new Set,ft.h&&(Mo(ft,ft.h),ft.h=null))}if(Ie.G){const Uo=sa.g?sa.g.getResponseHeader("X-HTTP-Session-Id"):null;Uo&&(Ie.wa=Uo,gi(Ie.J,Ie.G,Uo))}}ne.I=3,ne.l&&ne.l.ra(),ne.aa&&(ne.T=Date.now()-E.F,ne.j.info("Handshake RTT: "+ne.T+"ms")),Ie=ne;var jt=E;if(Ie.na=Pt(Ie,Ie.L?Ie.ba:null,Ie.W),jt.L){el(Ie.h,jt);var Zn=jt,lr=Ie.O;lr&&(Zn.H=lr),Zn.D&&(Ps(Zn),es(Zn)),Ie.g=jt}else du(Ie);ne.i.length>0&&Ri(ne)}else ui[0]!="stop"&&ui[0]!="close"||tt(ne,7);else ne.I==3&&(ui[0]=="stop"||ui[0]=="close"?ui[0]=="stop"?tt(ne,7):ma(ne):ui[0]!="noop"&&ne.l&&ne.l.qa(ui),ne.A=0)}}xn(4)}catch{}}var hr=class{constructor(E,K){this.g=E,this.map=K}};function ml(E){this.l=E||10,l.PerformanceNavigationTiming?(E=l.performance.getEntriesByType("navigation"),E=E.length>0&&(E[0].nextHopProtocol=="hq"||E[0].nextHopProtocol=="h2")):E=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=E?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Fs(E){return E.h?!0:E.g?E.g.size>=E.j:!1}function fa(E){return E.h?1:E.g?E.g.size:0}function Ts(E,K){return E.h?E.h==K:E.g?E.g.has(K):!1}function Mo(E,K){E.g?E.g.add(K):E.h=K}function el(E,K){E.h&&E.h==K?E.h=null:E.g&&E.g.has(K)&&E.g.delete(K)}ml.prototype.cancel=function(){if(this.i=tl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const E of this.g.values())E.cancel();this.g.clear()}};function tl(E){if(E.h!=null)return E.i.concat(E.h.G);if(E.g!=null&&E.g.size!==0){let K=E.i;for(const ne of E.g.values())K=K.concat(ne.G);return K}return A(E.i)}var Fo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oi(E,K){if(E){E=E.split("&");for(let ne=0;ne<E.length;ne++){const Ie=E[ne].indexOf("=");let st,ft=null;Ie>=0?(st=E[ne].substring(0,Ie),ft=E[ne].substring(Ie+1)):st=E[ne],K(st,ft?decodeURIComponent(ft.replace(/\+/g," ")):"")}}}function jr(E){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let K;E instanceof jr?(this.l=E.l,hn(this,E.j),this.o=E.o,this.g=E.g,Ea(this,E.u),this.h=E.h,js(this,Ua(E.i)),this.m=E.m):E&&(K=String(E).match(Fo))?(this.l=!1,hn(this,K[1]||"",!0),this.o=ri(K[2]||""),this.g=ri(K[3]||"",!0),Ea(this,K[4]),this.h=ri(K[5]||"",!0),js(this,K[6]||"",!0),this.m=ri(K[7]||"")):(this.l=!1,this.i=new ia(null,this.l))}jr.prototype.toString=function(){const E=[];var K=this.j;K&&E.push(dr(K,jo,!0),":");var ne=this.g;return(ne||K=="file")&&(E.push("//"),(K=this.o)&&E.push(dr(K,jo,!0),"@"),E.push(tr(ne).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ne=this.u,ne!=null&&E.push(":",String(ne))),(ne=this.h)&&(this.g&&ne.charAt(0)!="/"&&E.push("/"),E.push(dr(ne,ne.charAt(0)=="/"?Vo:Bl,!0))),(ne=this.i.toString())&&E.push("?",ne),(ne=this.m)&&E.push("#",dr(ne,yl)),E.join("")},jr.prototype.resolve=function(E){const K=_r(this);let ne=!!E.j;ne?hn(K,E.j):ne=!!E.o,ne?K.o=E.o:ne=!!E.g,ne?K.g=E.g:ne=E.u!=null;var Ie=E.h;if(ne)Ea(K,E.u);else if(ne=!!E.h){if(Ie.charAt(0)!="/")if(this.g&&!this.h)Ie="/"+Ie;else{var st=K.h.lastIndexOf("/");st!=-1&&(Ie=K.h.slice(0,st+1)+Ie)}if(st=Ie,st==".."||st==".")Ie="";else if(st.indexOf("./")!=-1||st.indexOf("/.")!=-1){Ie=st.lastIndexOf("/",0)==0,st=st.split("/");const ft=[];for(let jt=0;jt<st.length;){const Zn=st[jt++];Zn=="."?Ie&&jt==st.length&&ft.push(""):Zn==".."?((ft.length>1||ft.length==1&&ft[0]!="")&&ft.pop(),Ie&&jt==st.length&&ft.push("")):(ft.push(Zn),Ie=!0)}Ie=ft.join("/")}else Ie=st}return ne?K.h=Ie:ne=E.i.toString()!=="",ne?js(K,Ua(E.i)):ne=!!E.m,ne&&(K.m=E.m),K};function _r(E){return new jr(E)}function hn(E,K,ne){E.j=ne?ri(K,!0):K,E.j&&(E.j=E.j.replace(/:$/,""))}function Ea(E,K){if(K){if(K=Number(K),isNaN(K)||K<0)throw Error("Bad port number "+K);E.u=K}else E.u=null}function js(E,K,ne){K instanceof ia?(E.i=K,Mt(E.i,E.l)):(ne||(K=dr(K,br)),E.i=new ia(K,E.l))}function gi(E,K,ne){E.i.set(K,ne)}function za(E){return gi(E,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),E}function ri(E,K){return E?K?decodeURI(E.replace(/%25/g,"%2525")):decodeURIComponent(E):""}function dr(E,K,ne){return typeof E=="string"?(E=encodeURI(E).replace(K,Lr),ne&&(E=E.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E):null}function Lr(E){return E=E.charCodeAt(0),"%"+(E>>4&15).toString(16)+(E&15).toString(16)}var jo=/[#\/\?@]/g,Bl=/[#\?:]/g,Vo=/[#\?]/g,br=/[#\?@]/g,yl=/#/g;function ia(E,K){this.h=this.g=null,this.i=E||null,this.j=!!K}function Oi(E){E.g||(E.g=new Map,E.h=0,E.i&&oi(E.i,function(K,ne){E.add(decodeURIComponent(K.replace(/\+/g," ")),ne)}))}i=ia.prototype,i.add=function(E,K){Oi(this),this.i=null,E=It(this,E);let ne=this.g.get(E);return ne||this.g.set(E,ne=[]),ne.push(K),this.h+=1,this};function no(E,K){Oi(E),K=It(E,K),E.g.has(K)&&(E.i=null,E.h-=E.g.get(K).length,E.g.delete(K))}function vl(E,K){return Oi(E),K=It(E,K),E.g.has(K)}i.forEach=function(E,K){Oi(this),this.g.forEach(function(ne,Ie){ne.forEach(function(st){E.call(K,st,Ie,this)},this)},this)};function _l(E,K){Oi(E);let ne=[];if(typeof K=="string")vl(E,K)&&(ne=ne.concat(E.g.get(It(E,K))));else for(E=Array.from(E.g.values()),K=0;K<E.length;K++)ne=ne.concat(E[K]);return ne}i.set=function(E,K){return Oi(this),this.i=null,E=It(this,E),vl(this,E)&&(this.h-=this.g.get(E).length),this.g.set(E,[K]),this.h+=1,this},i.get=function(E,K){return E?(E=_l(this,E),E.length>0?String(E[0]):K):K};function zo(E,K,ne){no(E,K),ne.length>0&&(E.i=null,E.g.set(It(E,K),A(ne)),E.h+=ne.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const E=[],K=Array.from(this.g.keys());for(let Ie=0;Ie<K.length;Ie++){var ne=K[Ie];const st=tr(ne);ne=_l(this,ne);for(let ft=0;ft<ne.length;ft++){let jt=st;ne[ft]!==""&&(jt+="="+tr(ne[ft])),E.push(jt)}}return this.i=E.join("&")};function Ua(E){const K=new ia;return K.i=E.i,E.g&&(K.g=new Map(E.g),K.h=E.h),K}function It(E,K){return K=String(K),E.j&&(K=K.toLowerCase()),K}function Mt(E,K){K&&!E.j&&(Oi(E),E.i=null,E.g.forEach(function(ne,Ie){const st=Ie.toLowerCase();Ie!=st&&(no(this,Ie),zo(this,st,ne))},E)),E.j=K}function kn(E,K){const ne=new kr;if(l.Image){const Ie=new Image;Ie.onload=x(or,ne,"TestLoadImage: loaded",!0,K,Ie),Ie.onerror=x(or,ne,"TestLoadImage: error",!1,K,Ie),Ie.onabort=x(or,ne,"TestLoadImage: abort",!1,K,Ie),Ie.ontimeout=x(or,ne,"TestLoadImage: timeout",!1,K,Ie),l.setTimeout(function(){Ie.ontimeout&&Ie.ontimeout()},1e4),Ie.src=E}else K(!1)}function xi(E,K){const ne=new kr,Ie=new AbortController,st=setTimeout(()=>{Ie.abort(),or(ne,"TestPingServer: timeout",!1,K)},1e4);fetch(E,{signal:Ie.signal}).then(ft=>{clearTimeout(st),ft.ok?or(ne,"TestPingServer: ok",!0,K):or(ne,"TestPingServer: server error",!1,K)}).catch(()=>{clearTimeout(st),or(ne,"TestPingServer: error",!1,K)})}function or(E,K,ne,Ie,st){try{st&&(st.onload=null,st.onerror=null,st.onabort=null,st.ontimeout=null),Ie(ne)}catch{}}function Mi(){this.g=new $n}function rn(E){this.i=E.Sb||null,this.h=E.ab||!1}g(rn,cn),rn.prototype.g=function(){return new Vs(this.i,this.h)};function Vs(E,K){_t.call(this),this.H=E,this.o=K,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Vs,_t),i=Vs.prototype,i.open=function(E,K){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=E,this.D=K,this.readyState=1,Wr(this)},i.send=function(E){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const K={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};E&&(K.body=E),(this.H||l).fetch(new Request(this.D,K)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,pa(this)),this.readyState=0},i.Pa=function(E){if(this.g&&(this.l=E,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=E.headers,this.readyState=2,Wr(this)),this.g&&(this.readyState=3,Wr(this),this.g)))if(this.responseType==="arraybuffer")E.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in E){if(this.j=E.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;io(this)}else E.text().then(this.Oa.bind(this),this.ga.bind(this))};function io(E){E.j.read().then(E.Ma.bind(E)).catch(E.ga.bind(E))}i.Ma=function(E){if(this.g){if(this.o&&E.value)this.response.push(E.value);else if(!this.o){var K=E.value?E.value:new Uint8Array(0);(K=this.B.decode(K,{stream:!E.done}))&&(this.response=this.responseText+=K)}E.done?pa(this):Wr(this),this.readyState==3&&io(this)}},i.Oa=function(E){this.g&&(this.response=this.responseText=E,pa(this))},i.Na=function(E){this.g&&(this.response=E,pa(this))},i.ga=function(){this.g&&pa(this)};function pa(E){E.readyState=4,E.l=null,E.j=null,E.B=null,Wr(E)}i.setRequestHeader=function(E,K){this.A.append(E,K)},i.getResponseHeader=function(E){return this.h&&this.h.get(E.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const E=[],K=this.h.entries();for(var ne=K.next();!ne.done;)ne=ne.value,E.push(ne[0]+": "+ne[1]),ne=K.next();return E.join(`\r
`)};function Wr(E){E.onreadystatechange&&E.onreadystatechange.call(E)}Object.defineProperty(Vs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(E){this.m=E?"include":"same-origin"}});function wi(E){let K="";return ot(E,function(ne,Ie){K+=Ie,K+=":",K+=ne,K+=`\r
`}),K}function ga(E,K,ne){e:{for(Ie in ne){var Ie=!1;break e}Ie=!0}Ie||(ne=wi(ne),typeof E=="string"?ne!=null&&tr(ne):gi(E,K,ne))}function ki(E){_t.call(this),this.headers=new Map,this.L=E||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ki,_t);var zs=/^https?$/i,Ba=["POST","PUT"];i=ki.prototype,i.Fa=function(E){this.H=E},i.ea=function(E,K,ne,Ie){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+E);K=K?K.toUpperCase():"GET",this.D=E,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ms.g(),this.g.onreadystatechange=w(f(this.Ca,this));try{this.B=!0,this.g.open(K,String(E),!0),this.B=!1}catch(ft){Us(this,ft);return}if(E=ne||"",ne=new Map(this.headers),Ie)if(Object.getPrototypeOf(Ie)===Object.prototype)for(var st in Ie)ne.set(st,Ie[st]);else if(typeof Ie.keys=="function"&&typeof Ie.get=="function")for(const ft of Ie.keys())ne.set(ft,Ie.get(ft));else throw Error("Unknown input type for opt_headers: "+String(Ie));Ie=Array.from(ne.keys()).find(ft=>ft.toLowerCase()=="content-type"),st=l.FormData&&E instanceof l.FormData,!(Array.prototype.indexOf.call(Ba,K,void 0)>=0)||Ie||st||ne.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ft,jt]of ne)this.g.setRequestHeader(ft,jt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(E),this.v=!1}catch(ft){Us(this,ft)}};function Us(E,K){E.h=!1,E.g&&(E.j=!0,E.g.abort(),E.j=!1),E.l=K,E.o=5,fn(E),Ia(E)}function fn(E){E.A||(E.A=!0,en(E,"complete"),en(E,"error"))}i.abort=function(E){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=E||7,en(this,"complete"),en(this,"abort"),Ia(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ia(this,!0)),ki.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?As(this):this.Xa())},i.Xa=function(){As(this)};function As(E){if(E.h&&typeof s<"u"){if(E.v&&qr(E)==4)setTimeout(E.Ca.bind(E),0);else if(en(E,"readystatechange"),qr(E)==4){E.h=!1;try{const ft=E.ca();e:switch(ft){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var K=!0;break e;default:K=!1}var ne;if(!(ne=K)){var Ie;if(Ie=ft===0){let jt=String(E.D).match(Fo)[1]||null;!jt&&l.self&&l.self.location&&(jt=l.self.location.protocol.slice(0,-1)),Ie=!zs.test(jt?jt.toLowerCase():"")}ne=Ie}if(ne)en(E,"complete"),en(E,"success");else{E.o=6;try{var st=qr(E)>2?E.g.statusText:""}catch{st=""}E.l=st+" ["+E.ca()+"]",fn(E)}}finally{Ia(E)}}}}function Ia(E,K){if(E.g){E.m&&(clearTimeout(E.m),E.m=null);const ne=E.g;E.g=null,K||en(E,"ready");try{ne.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function qr(E){return E.g?E.g.readyState:0}i.ca=function(){try{return qr(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(E){if(this.g){var K=this.g.responseText;return E&&K.indexOf(E)==0&&(K=K.substring(E.length)),ln(K)}};function Tr(E){try{if(!E.g)return null;if("response"in E.g)return E.g.response;switch(E.F){case"":case"text":return E.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in E.g)return E.g.mozResponseArrayBuffer}return null}catch{return null}}function ka(E){const K={};E=(E.g&&qr(E)>=2&&E.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ie=0;Ie<E.length;Ie++){if(le(E[Ie]))continue;var ne=cr(E[Ie]);const st=ne[0];if(ne=ne[1],typeof ne!="string")continue;ne=ne.trim();const ft=K[st]||[];K[st]=ft,ft.push(ne)}St(K,function(Ie){return Ie.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vr(E,K,ne){return ne&&ne.internalChannelParams&&ne.internalChannelParams[E]||K}function Ca(E){this.za=0,this.i=[],this.j=new kr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vr("failFast",!1,E),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vr("baseRetryDelayMs",5e3,E),this.Za=Vr("retryDelaySeedMs",1e4,E),this.Ta=Vr("forwardChannelMaxRetries",2,E),this.va=Vr("forwardChannelRequestTimeoutMs",2e4,E),this.ma=E&&E.xmlHttpFactory||void 0,this.Ua=E&&E.Rb||void 0,this.Aa=E&&E.useFetchStreams||!1,this.O=void 0,this.L=E&&E.supportsCrossDomainXhr||!1,this.M="",this.h=new ml(E&&E.concurrentRequestLimit),this.Ba=new Mi,this.S=E&&E.fastHandshake||!1,this.R=E&&E.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=E&&E.Pb||!1,E&&E.ua&&this.j.ua(),E&&E.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&E&&E.detectBufferingProxy||!1,this.ia=void 0,E&&E.longPollingTimeout&&E.longPollingTimeout>0&&(this.ia=E.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Ca.prototype,i.ka=8,i.I=1,i.connect=function(E,K,ne,Ie){Qt(0),this.W=E,this.H=K||{},ne&&Ie!==void 0&&(this.H.OSID=ne,this.H.OAID=Ie),this.F=this.X,this.J=Pt(this,null,this.W),Ri(this)};function ma(E){if(Cn(E),E.I==3){var K=E.V++,ne=_r(E.J);if(gi(ne,"SID",E.M),gi(ne,"RID",K),gi(ne,"TYPE","terminate"),Bs(E,ne),K=new os(E,E.j,K),K.M=2,K.A=za(_r(ne)),ne=!1,l.navigator&&l.navigator.sendBeacon)try{ne=l.navigator.sendBeacon(K.A.toString(),"")}catch{}!ne&&l.Image&&(new Image().src=K.A,ne=!0),ne||(K.g=an(K.j,null),K.g.ea(K.A)),K.F=Date.now(),es(K)}At(E)}function us(E){E.g&&(bl(E),E.g.cancel(),E.g=null)}function Cn(E){us(E),E.v&&(l.clearTimeout(E.v),E.v=null),fe(E),E.h.cancel(),E.m&&(typeof E.m=="number"&&l.clearTimeout(E.m),E.m=null)}function Ri(E){if(!Fs(E.h)&&!E.m){E.m=!0;var K=E.Ea;Ce||ee(),Ve||(Ce(),Ve=!0),pe.add(K,E),E.D=0}}function Es(E,K){return fa(E.h)>=E.h.j-(E.m?1:0)?!1:E.m?(E.i=K.G.concat(E.i),!0):E.I==1||E.I==2||E.D>=(E.Sa?0:E.Ta)?!1:(E.m=Kn(f(E.Ea,E,K),We(E,E.D)),E.D++,!0)}i.Ea=function(E){if(this.m)if(this.m=null,this.I==1){if(!E){this.V=Math.floor(Math.random()*1e5),E=this.V++;const st=new os(this,this.j,E);let ft=this.o;if(this.U&&(ft?(ft=Ne(ft),Ee(ft,this.U)):ft=this.U),this.u!==null||this.R||(st.J=ft,ft=null),this.S)e:{for(var K=0,ne=0;ne<this.i.length;ne++){t:{var Ie=this.i[ne];if("__data__"in Ie.map&&(Ie=Ie.map.__data__,typeof Ie=="string")){Ie=Ie.length;break t}Ie=void 0}if(Ie===void 0)break;if(K+=Ie,K>4096){K=ne;break e}if(K===4096||ne===this.i.length-1){K=ne+1;break e}}K=1e3}else K=1e3;K=wo(this,st,K),ne=_r(this.J),gi(ne,"RID",E),gi(ne,"CVER",22),this.G&&gi(ne,"X-HTTP-Session-Id",this.G),Bs(this,ne),ft&&(this.R?K="headers="+tr(wi(ft))+"&"+K:this.u&&ga(ne,this.u,ft)),Mo(this.h,st),this.Ra&&gi(ne,"TYPE","init"),this.S?(gi(ne,"$req",K),gi(ne,"SID","null"),st.U=!0,Kr(st,ne,null)):Kr(st,ne,K),this.I=2}}else this.I==3&&(E?$a(this,E):this.i.length==0||Fs(this.h)||$a(this))};function $a(E,K){var ne;K?ne=K.l:ne=E.V++;const Ie=_r(E.J);gi(Ie,"SID",E.M),gi(Ie,"RID",ne),gi(Ie,"AID",E.K),Bs(E,Ie),E.u&&E.o&&ga(Ie,E.u,E.o),ne=new os(E,E.j,ne,E.D+1),E.u===null&&(ne.J=E.o),K&&(E.i=K.G.concat(E.i)),K=wo(E,ne,1e3),ne.H=Math.round(E.va*.5)+Math.round(E.va*.5*Math.random()),Mo(E.h,ne),Kr(ne,Ie,K)}function Bs(E,K){E.H&&ot(E.H,function(ne,Ie){gi(K,Ie,ne)}),E.l&&ot({},function(ne,Ie){gi(K,Ie,ne)})}function wo(E,K,ne){ne=Math.min(E.i.length,ne);const Ie=E.l?f(E.l.Ka,E.l,E):null;e:{var st=E.i;let Zn=-1;for(;;){const lr=["count="+ne];Zn==-1?ne>0?(Zn=st[0].g,lr.push("ofs="+Zn)):Zn=0:lr.push("ofs="+Zn);let ui=!0;for(let nr=0;nr<ne;nr++){var ft=st[nr].g;const $s=st[nr].map;if(ft-=Zn,ft<0)Zn=Math.max(0,st[nr].g-100),ui=!1;else try{ft="req"+ft+"_"||"";try{var jt=$s instanceof Map?$s:Object.entries($s);for(const[ra,xr]of jt){let sa=xr;u(xr)&&(sa=Xn(xr)),lr.push(ft+ra+"="+encodeURIComponent(sa))}}catch(ra){throw lr.push(ft+"type="+encodeURIComponent("_badmap")),ra}}catch{Ie&&Ie($s)}}if(ui){jt=lr.join("&");break e}}jt=void 0}return E=E.i.splice(0,ne),K.G=E,jt}function du(E){if(!E.g&&!E.v){E.Y=1;var K=E.Da;Ce||ee(),Ve||(Ce(),Ve=!0),pe.add(K,E),E.A=0}}function ro(E){return E.g||E.v||E.A>=3?!1:(E.Y++,E.v=Kn(f(E.Da,E),We(E,E.A)),E.A++,!0)}i.Da=function(){if(this.v=null,j(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var E=4*this.T;this.j.info("BP detection timer enabled: "+E),this.B=Kn(f(this.Wa,this),E)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Qt(10),us(this),j(this))};function bl(E){E.B!=null&&(l.clearTimeout(E.B),E.B=null)}function j(E){E.g=new os(E,E.j,"rpc",E.Y),E.u===null&&(E.g.J=E.o),E.g.P=0;var K=_r(E.na);gi(K,"RID","rpc"),gi(K,"SID",E.M),gi(K,"AID",E.K),gi(K,"CI",E.F?"0":"1"),!E.F&&E.ia&&gi(K,"TO",E.ia),gi(K,"TYPE","xmlhttp"),Bs(E,K),E.u&&E.o&&ga(K,E.u,E.o),E.O&&(E.g.H=E.O);var ne=E.g;E=E.ba,ne.M=1,ne.A=za(_r(K)),ne.u=null,ne.R=!0,ls(ne,E)}i.Va=function(){this.C!=null&&(this.C=null,us(this),ro(this),Qt(19))};function fe(E){E.C!=null&&(l.clearTimeout(E.C),E.C=null)}function Me(E,K){var ne=null;if(E.g==K){fe(E),bl(E),E.g=null;var Ie=2}else if(Ts(E.h,K))ne=K.G,el(E.h,K),Ie=1;else return;if(E.I!=0){if(K.o)if(Ie==1){ne=K.u?K.u.length:0,K=Date.now()-K.F;var st=E.D;Ie=Ni(),en(Ie,new Ht(Ie,ne)),Ri(E)}else du(E);else if(st=K.m,st==3||st==0&&K.X>0||!(Ie==1&&Es(E,K)||Ie==2&&ro(E)))switch(ne&&ne.length>0&&(K=E.h,K.i=K.i.concat(ne)),st){case 1:tt(E,5);break;case 4:tt(E,10);break;case 3:tt(E,6);break;default:tt(E,2)}}}function We(E,K){let ne=E.Qa+Math.floor(Math.random()*E.Za);return E.isActive()||(ne*=2),ne*K}function tt(E,K){if(E.j.info("Error code "+K),K==2){var ne=f(E.bb,E),Ie=E.Ua;const st=!Ie;Ie=new jr(Ie||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||hn(Ie,"https"),za(Ie),st?kn(Ie.toString(),ne):xi(Ie.toString(),ne)}else Qt(2);E.I=0,E.l&&E.l.pa(K),At(E),Cn(E)}i.bb=function(E){E?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function At(E){if(E.I=0,E.ja=[],E.l){const K=tl(E.h);(K.length!=0||E.i.length!=0)&&(B(E.ja,K),B(E.ja,E.i),E.h.i.length=0,A(E.i),E.i.length=0),E.l.oa()}}function Pt(E,K,ne){var Ie=ne instanceof jr?_r(ne):new jr(ne);if(Ie.g!="")K&&(Ie.g=K+"."+Ie.g),Ea(Ie,Ie.u);else{var st=l.location;Ie=st.protocol,K=K?K+"."+st.hostname:st.hostname,st=+st.port;const ft=new jr(null);Ie&&hn(ft,Ie),K&&(ft.g=K),st&&Ea(ft,st),ne&&(ft.h=ne),Ie=ft}return ne=E.G,K=E.wa,ne&&K&&gi(Ie,ne,K),gi(Ie,"VER",E.ka),Bs(E,Ie),Ie}function an(E,K,ne){if(K&&!E.L)throw Error("Can't create secondary domain capable XhrIo object.");return K=E.Aa&&!E.ma?new ki(new rn({ab:ne})):new ki(E.ma),K.Fa(E.L),K}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function pn(){}i=pn.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Vn(){}Vn.prototype.g=function(E,K){return new Rn(E,K)};function Rn(E,K){_t.call(this),this.g=new Ca(K),this.l=E,this.h=K&&K.messageUrlParams||null,E=K&&K.messageHeaders||null,K&&K.clientProtocolHeaderRequired&&(E?E["X-Client-Protocol"]="webchannel":E={"X-Client-Protocol":"webchannel"}),this.g.o=E,E=K&&K.initMessageHeaders||null,K&&K.messageContentType&&(E?E["X-WebChannel-Content-Type"]=K.messageContentType:E={"X-WebChannel-Content-Type":K.messageContentType}),K&&K.sa&&(E?E["X-WebChannel-Client-Profile"]=K.sa:E={"X-WebChannel-Client-Profile":K.sa}),this.g.U=E,(E=K&&K.Qb)&&!le(E)&&(this.g.u=E),this.A=K&&K.supportsCrossDomainXhr||!1,this.v=K&&K.sendRawJson||!1,(K=K&&K.httpSessionIdParam)&&!le(K)&&(this.g.G=K,E=this.h,E!==null&&K in E&&(E=this.h,K in E&&delete E[K])),this.j=new fr(this)}g(Rn,_t),Rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){ma(this.g)},Rn.prototype.o=function(E){var K=this.g;if(typeof E=="string"){var ne={};ne.__data__=E,E=ne}else this.v&&(ne={},ne.__data__=Xn(E),E=ne);K.i.push(new hr(K.Ya++,E)),K.I==3&&Ri(K)},Rn.prototype.N=function(){this.g.l=null,delete this.j,ma(this.g),delete this.g,Rn.Z.N.call(this)};function Si(E){mn.call(this),E.__headers__&&(this.headers=E.__headers__,this.statusCode=E.__status__,delete E.__headers__,delete E.__status__);var K=E.__sm__;if(K){e:{for(const ne in K){E=ne;break e}E=void 0}(this.i=E)&&(E=this.i,K=K!==null&&E in K?K[E]:void 0),this.data=K}else this.data=E}g(Si,mn);function Ar(){On.call(this),this.status=1}g(Ar,On);function fr(E){this.g=E}g(fr,pn),fr.prototype.ra=function(){en(this.g,"a")},fr.prototype.qa=function(E){en(this.g,new Si(E))},fr.prototype.pa=function(E){en(this.g,new Ar)},fr.prototype.oa=function(){en(this.g,"b")},Vn.prototype.createWebChannel=Vn.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,h3=function(){return new Vn},c3=function(){return Ni()},u3=qn,qb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ta.NO_ERROR=0,ta.TIMEOUT=8,ta.HTTP_ERROR=6,f0=ta,Rr.COMPLETE="complete",l3=Rr,er.EventType=Jn,Jn.OPEN="a",Jn.CLOSE="b",Jn.ERROR="c",Jn.MESSAGE="d",_t.prototype.listen=_t.prototype.J,Lg=er,ki.prototype.listenOnce=ki.prototype.K,ki.prototype.getLastError=ki.prototype.Ha,ki.prototype.getLastErrorCode=ki.prototype.ya,ki.prototype.getStatus=ki.prototype.ca,ki.prototype.getResponseJson=ki.prototype.La,ki.prototype.getResponseText=ki.prototype.la,ki.prototype.send=ki.prototype.ea,ki.prototype.setWithCredentials=ki.prototype.Fa,o3=ki}).apply(typeof jy<"u"?jy:typeof self<"u"?self:typeof window<"u"?window:{});const cA="@firebase/firestore",hA="4.9.2";class vo{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vo.UNAUTHENTICATED=new vo(null),vo.GOOGLE_CREDENTIALS=new vo("google-credentials-uid"),vo.FIRST_PARTY=new vo("first-party-uid"),vo.MOCK_USER=new vo("mock-user");let Mp="12.3.0";const Wd=new j1("@firebase/firestore");function zf(){return Wd.logLevel}function zt(i,...e){if(Wd.logLevel<=Ki.DEBUG){const t=e.map(x2);Wd.debug(`Firestore (${Mp}): ${i}`,...t)}}function Xo(i,...e){if(Wd.logLevel<=Ki.ERROR){const t=e.map(x2);Wd.error(`Firestore (${Mp}): ${i}`,...t)}}function qd(i,...e){if(Wd.logLevel<=Ki.WARN){const t=e.map(x2);Wd.warn(`Firestore (${Mp}): ${i}`,...t)}}function x2(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}function _n(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,d3(i,n,t)}function d3(i,e,t){let n=`FIRESTORE (${Mp}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Xo(n),new Error(n)}function jn(i,e,t,n){let r="Unexpected state";typeof t=="string"?r=t:n=t,i||d3(e,r,n)}function hi(i,e){return i}const Ot={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class un extends oc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Hc{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class f3{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class MF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(vo.UNAUTHENTICATED)))}shutdown(){}}class FF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class jF{constructor(e){this.t=e,this.currentUser=vo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){jn(this.o===void 0,42304);let n=this.i;const r=h=>this.i!==n?(n=this.i,t(h)):Promise.resolve();let s=new Hc;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Hc,e.enqueueRetryable((()=>r(this.currentUser)))};const l=()=>{const h=s;e.enqueueRetryable((async()=>{await h.promise,await r(this.currentUser)}))},u=h=>{zt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(zt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Hc)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(zt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(jn(typeof n.accessToken=="string",31837,{l:n}),new f3(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jn(e===null||typeof e=="string",2055,{h:e}),new vo(e)}}class VF{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=vo.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zF{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new VF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(vo.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class UF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Po(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){jn(this.o===void 0,3512);const n=s=>{s.error!=null&&zt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.m;return this.m=s.token,zt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>n(s)))};const r=s=>{zt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):zt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(jn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function BF(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}class w2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=BF(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function ci(i,e){return i<e?-1:i>e?1:0}function Yb(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const r=i.charAt(n),s=e.charAt(n);if(r!==s)return H_(r)===H_(s)?ci(r,s):H_(r)?1:-1}return ci(i.length,e.length)}const $F=55296,GF=57343;function H_(i){const e=i.charCodeAt(0);return e>=$F&&e<=GF}function cp(i,e,t){return i.length===e.length&&i.every(((n,r)=>t(n,e[r])))}function p3(i){return i+"\0"}const fA="__name__";class Yu{constructor(e,t,n){t===void 0?t=0:t>e.length&&_n(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&_n(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Yu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yu?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=Yu.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return ci(e.length,t.length)}static compareSegments(e,t){const n=Yu.isNumericId(e),r=Yu.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Yu.extractNumericId(e).compare(Yu.extractNumericId(t)):Yb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hh.fromString(e.substring(4,e.length-2))}}class $r extends Yu{construct(e,t,n){return new $r(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new un(Ot.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((r=>r.length>0)))}return new $r(t)}static emptyPath(){return new $r([])}}const HF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ds extends Yu{construct(e,t,n){return new Ds(e,t,n)}static isValidIdentifier(e){return HF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ds.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fA}static keyField(){return new Ds([fA])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(n.length===0)throw new un(Ot.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;r<e.length;){const u=e[r];if(u==="\\"){if(r+1===e.length)throw new un(Ot.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[r+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new un(Ot.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,r+=2}else u==="`"?(l=!l,r++):u!=="."||l?(n+=u,r++):(s(),r++)}if(s(),l)throw new un(Ot.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ds(t)}static emptyPath(){return new Ds([])}}class tn{constructor(e){this.path=e}static fromPath(e){return new tn($r.fromString(e))}static fromName(e){return new tn($r.fromString(e).popFirst(5))}static empty(){return new tn($r.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$r.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $r.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tn(new $r(e.slice()))}}function KF(i,e,t){if(!t)throw new un(Ot.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function WF(i,e,t,n){if(e===!0&&n===!0)throw new un(Ot.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function pA(i){if(!tn.isDocumentKey(i))throw new un(Ot.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function g3(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function S2(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":_n(12329,{type:typeof i})}function hp(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new un(Ot.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=S2(i);throw new un(Ot.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function Sa(i,e){const t={typeString:i};return e&&(t.value=e),t}function zm(i,e){if(!g3(i))throw new un(Ot.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const r=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const l=i[n];if(r&&typeof l!==r){t=`JSON field '${n}' must be a ${r}.`;break}if(s!==void 0&&l!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new un(Ot.INVALID_ARGUMENT,t);return!0}const gA=-62135596800,mA=1e6;class Mr{static now(){return Mr.fromMillis(Date.now())}static fromDate(e){return Mr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*mA);return new Mr(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new un(Ot.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new un(Ot.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gA)throw new un(Ot.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new un(Ot.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mA}_compareTo(e){return this.seconds===e.seconds?ci(this.nanoseconds,e.nanoseconds):ci(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Mr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zm(e,Mr._jsonSchema))return new Mr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Mr._jsonSchemaVersion="firestore/timestamp/1.0",Mr._jsonSchema={type:Sa("string",Mr._jsonSchemaVersion),seconds:Sa("number"),nanoseconds:Sa("number")};class Hn{static fromTimestamp(e){return new Hn(e)}static min(){return new Hn(new Mr(0,0))}static max(){return new Hn(new Mr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const om=-1;class W0{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Xb(i){return i.fields.find((e=>e.kind===2))}function Ed(i){return i.fields.filter((e=>e.kind!==2))}W0.UNKNOWN_ID=-1;class p0{constructor(e,t){this.fieldPath=e,this.kind=t}}class lm{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new lm(0,zl.min())}}function qF(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=Hn.fromTimestamp(n===1e9?new Mr(t+1,0):new Mr(t,n));return new zl(r,tn.empty(),e)}function m3(i){return new zl(i.readTime,i.key,om)}class zl{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new zl(Hn.min(),tn.empty(),om)}static max(){return new zl(Hn.max(),tn.empty(),om)}}function T2(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=tn.comparator(i.documentKey,e.documentKey),t!==0?t:ci(i.largestBatchId,e.largestBatchId))}const y3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class v3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function lf(i){if(i.code!==Ot.FAILED_PRECONDITION||i.message!==y3)throw i;zt("LocalStore","Unexpectedly lost primary lease")}class lt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_n(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new lt(((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof lt?t:lt.resolve(t)}catch(t){return lt.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):lt.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):lt.reject(t)}static resolve(e){return new lt(((t,n)=>{t(e)}))}static reject(e){return new lt(((t,n)=>{n(e)}))}static waitFor(e){return new lt(((t,n)=>{let r=0,s=0,l=!1;e.forEach((u=>{++r,u.next((()=>{++s,l&&s===r&&t()}),(h=>n(h)))})),l=!0,s===r&&t()}))}static or(e){let t=lt.resolve(!1);for(const n of e)t=t.next((r=>r?lt.resolve(r):n()));return t}static forEach(e,t){const n=[];return e.forEach(((r,s)=>{n.push(t.call(this,r,s))})),this.waitFor(n)}static mapArray(e,t){return new lt(((n,r)=>{const s=e.length,l=new Array(s);let u=0;for(let h=0;h<s;h++){const f=h;t(e[f]).next((x=>{l[f]=x,++u,u===s&&n(l)}),(x=>r(x)))}}))}static doWhile(e,t){return new lt(((n,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):n()};s()}))}}const Ol="SimpleDb";class G1{static open(e,t,n,r){try{return new G1(t,e.transaction(r,n))}catch(s){throw new Vg(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Hc,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Vg(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const r=A2(n.target.error);this.S.reject(new Vg(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(zt(Ol,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new XF(t)}}class Kh{static delete(e){return zt(Ol,"Removing database:",e),Ld(dC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!bC())return!1;if(Kh.F())return!0;const e=Fa(),t=Kh.M(e),n=0<t&&t<10,r=_3(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,Kh.M(Fa())===12.2&&Xo("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(zt(Ol,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const l=s.target.result;t(l)},r.onblocked=()=>{n(new Vg(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const l=s.target.error;l.name==="VersionError"?n(new un(Ot.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?n(new un(Ot.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):n(new Vg(e,l))},r.onupgradeneeded=s=>{zt(Ol,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const l=s.target.result;this.N.k(l,r.transaction,s.oldVersion,this.version).next((()=>{zt(Ol,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const s=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=G1.open(this.db,e,s?"readonly":"readwrite",n),h=r(u).next((f=>(u.C(),f))).catch((f=>(u.abort(f),lt.reject(f)))).toPromise();return h.catch((()=>{})),await u.D,h}catch(u){const h=u,f=h.name!=="FirebaseError"&&l<3;if(zt(Ol,"Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function _3(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class YF{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ld(this.U.delete())}}class Vg extends un{constructor(e,t){super(Ot.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function hd(i){return i.name==="IndexedDbTransactionError"}class XF{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(zt(Ol,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(zt(Ol,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ld(n)}add(e){return zt(Ol,"ADD",this.store.name,e,e),Ld(this.store.add(e))}get(e){return Ld(this.store.get(e)).next((t=>(t===void 0&&(t=null),zt(Ol,"GET",this.store.name,e,t),t)))}delete(e){return zt(Ol,"DELETE",this.store.name,e),Ld(this.store.delete(e))}count(){return zt(Ol,"COUNT",this.store.name),Ld(this.store.count())}J(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(n.range);return new lt(((l,u)=>{s.onerror=h=>{u(h.target.error)},s.onsuccess=h=>{l(h.target.result)}}))}{const s=this.cursor(n),l=[];return this.H(s,((u,h)=>{l.push(h)})).next((()=>l))}}Y(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new lt(((r,s)=>{n.onerror=l=>{s(l.target.error)},n.onsuccess=l=>{r(l.target.result)}}))}Z(e,t){zt(Ol,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const r=this.cursor(n);return this.H(r,((s,l,u)=>u.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.H(r,t)}te(e){const t=this.cursor({});return new lt(((n,r)=>{t.onerror=s=>{const l=A2(s.target.error);r(l)},t.onsuccess=s=>{const l=s.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():n()})):n()}}))}H(e,t){const n=[];return new lt(((r,s)=>{e.onerror=l=>{s(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void r();const h=new YF(u),f=t(u.primaryKey,u.value,h);if(f instanceof lt){const x=f.catch((g=>(h.done(),lt.reject(g))));n.push(x)}h.isDone?r():h.G===null?u.continue():u.continue(h.G)}})).next((()=>lt.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ld(i){return new lt(((e,t)=>{i.onsuccess=n=>{const r=n.target.result;e(r)},i.onerror=n=>{const r=A2(n.target.error);t(r)}}))}let yA=!1;function A2(i){const e=Kh.M(Fa());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){const n=new un("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yA||(yA=!0,setTimeout((()=>{throw n}),0)),n}}return i}const zg="IndexBackfiller";class JF{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){zt(zg,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();zt(zg,`Documents written: ${t}`)}catch(t){hd(t)?zt(zg,"Ignoring IndexedDB error during index backfill: ",t):await lf(t)}await this.re(6e4)}))}}class QF{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let r=t,s=!0;return lt.doWhile((()=>s===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!n.has(l))return zt(zg,`Processing collection: ${l}`),this.oe(e,l,r).next((u=>{r-=u,n.add(l)}));s=!1})))).next((()=>t-r))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((s=>{const l=s.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(r,s))).next((u=>(zt(zg,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((r,s)=>{const l=m3(s);T2(l,n)>0&&(n=l)})),new zl(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class iu{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}iu.ce=-1;const zd=-1;function H1(i){return i==null}function um(i){return i===0&&1/i==-1/0}function ZF(i){return typeof i=="number"&&Number.isInteger(i)&&!um(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const q0="";function Oo(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=vA(e)),e=ej(i.get(t),e);return vA(e)}function ej(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="";break;case q0:t+="";break;default:t+=s}}return t}function vA(i){return i+q0+""}function Xu(i){const e=i.length;if(jn(e>=2,64408,{path:i}),e===2)return jn(i.charAt(0)===q0&&i.charAt(1)==="",56145,{path:i}),$r.emptyPath();const t=e-2,n=[];let r="";for(let s=0;s<e;){const l=i.indexOf(q0,s);switch((l<0||l>t)&&_n(50515,{path:i}),i.charAt(l+1)){case"":const u=i.substring(s,l);let h;r.length===0?h=u:(r+=u,h=r,r=""),n.push(h);break;case"":r+=i.substring(s,l),r+="\0";break;case"":r+=i.substring(s,l+1);break;default:_n(61167,{path:i})}s=l+2}return new $r(n)}const Id="remoteDocuments",Um="owner",Rf="owner",cm="mutationQueues",tj="userId",Iu="mutations",_A="batchId",jd="userMutationsIndex",bA=["userId","batchId"];function g0(i,e){return[i,Oo(e)]}function b3(i,e,t){return[i,Oo(e),t]}const nj={},dp="documentMutations",Y0="remoteDocumentsV14",ij=["prefixPath","collectionGroup","readTime","documentId"],m0="documentKeyIndex",rj=["prefixPath","collectionGroup","documentId"],x3="collectionGroupIndex",sj=["collectionGroup","readTime","prefixPath","documentId"],hm="remoteDocumentGlobal",Jb="remoteDocumentGlobalKey",fp="targets",w3="queryTargetsIndex",aj=["canonicalId","targetId"],pp="targetDocuments",oj=["targetId","path"],E2="documentTargetsIndex",lj=["path","targetId"],X0="targetGlobalKey",Ud="targetGlobal",dm="collectionParents",uj=["collectionId","parent"],gp="clientMetadata",cj="clientId",K1="bundles",hj="bundleId",W1="namedQueries",dj="name",I2="indexConfiguration",fj="indexId",Qb="collectionGroupIndex",pj="collectionGroup",Ug="indexState",gj=["indexId","uid"],S3="sequenceNumberIndex",mj=["uid","sequenceNumber"],Bg="indexEntries",yj=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],T3="documentKeyIndex",vj=["indexId","uid","orderedDocumentKey"],q1="documentOverlays",_j=["userId","collectionPath","documentId"],Zb="collectionPathOverlayIndex",bj=["userId","collectionPath","largestBatchId"],A3="collectionGroupOverlayIndex",xj=["userId","collectionGroup","largestBatchId"],k2="globals",wj="name",E3=[cm,Iu,dp,Id,fp,Um,Ud,pp,gp,hm,dm,K1,W1],Sj=[...E3,q1],I3=[cm,Iu,dp,Y0,fp,Um,Ud,pp,gp,hm,dm,K1,W1,q1],k3=I3,C2=[...k3,I2,Ug,Bg],Tj=C2,C3=[...C2,k2],Aj=C3;class ex extends v3{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ja(i,e){const t=hi(i);return Kh.O(t.le,e)}function xA(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function uf(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function R3(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}let ha=class tx{constructor(e,t){this.comparator=e,this.root=t||Wh.EMPTY}insert(e,t){return new tx(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wh.BLACK,null,null))}remove(e){return new tx(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wh.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vy(this.root,e,this.comparator,!0)}},Vy=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Wh=class Mc{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??Mc.RED,this.left=r??Mc.EMPTY,this.right=s??Mc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Mc(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Mc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Mc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _n(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _n(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _n(27949);return e+(this.isRed()?0:1)}};Wh.EMPTY=null,Wh.RED=!0,Wh.BLACK=!1;Wh.EMPTY=new class{constructor(){this.size=0}get key(){throw _n(57766)}get value(){throw _n(16141)}get color(){throw _n(16727)}get left(){throw _n(29726)}get right(){throw _n(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new Wh(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Fr{constructor(e){this.comparator=e,this.data=new ha(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wA(this.data.getIterator())}getIteratorFrom(e){return new wA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof Fr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Fr(this.comparator);return t.data=e,t}}class wA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Lf(i){return i.hasNext()?i.getNext():void 0}class ru{constructor(e){this.fields=e,e.sort(Ds.comparator)}static empty(){return new ru([])}unionWith(e){let t=new Fr(Ds.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ru(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cp(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}class L3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ta{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new L3("Invalid base64 string: "+s):s}})(e);return new Ta(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let l=0;l<r.length;++l)s+=String.fromCharCode(r[l]);return s})(e);return new Ta(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ci(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ta.EMPTY_BYTE_STRING=new Ta("");const Ej=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qc(i){if(jn(!!i,39018),typeof i=="string"){let e=0;const t=Ej.exec(i);if(jn(!!t,46558,{timestamp:i}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ws(i.seconds),nanos:ws(i.nanos)}}function ws(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Zc(i){return typeof i=="string"?Ta.fromBase64String(i):Ta.fromUint8Array(i)}const D3="server_timestamp",N3="__type__",P3="__previous_value__",O3="__local_write_time__";function R2(i){return(i?.mapValue?.fields||{})[N3]?.stringValue===D3}function Y1(i){const e=i.mapValue.fields[P3];return R2(e)?Y1(e):e}function fm(i){const e=Qc(i.mapValue.fields[O3].timestampValue);return new Mr(e.seconds,e.nanos)}class Ij{constructor(e,t,n,r,s,l,u,h,f,x){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=x}}const J0="(default)";class Yd{constructor(e,t){this.projectId=e,this.database=t||J0}static empty(){return new Yd("","")}get isDefaultDatabase(){return this.database===J0}isEqual(e){return e instanceof Yd&&e.projectId===this.projectId&&e.database===this.database}}const L2="__type__",M3="__max__",Vh={mapValue:{fields:{__type__:{stringValue:M3}}}},D2="__vector__",mp="value",y0={nullValue:"NULL_VALUE"};function Zh(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?R2(i)?4:F3(i)?9007199254740991:X1(i)?10:11:_n(28295,{value:i})}function rc(i,e){if(i===e)return!0;const t=Zh(i);if(t!==Zh(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return fm(i).isEqual(fm(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const l=Qc(r.timestampValue),u=Qc(s.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(r,s){return Zc(r.bytesValue).isEqual(Zc(s.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(r,s){return ws(r.geoPointValue.latitude)===ws(s.geoPointValue.latitude)&&ws(r.geoPointValue.longitude)===ws(s.geoPointValue.longitude)})(i,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return ws(r.integerValue)===ws(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const l=ws(r.doubleValue),u=ws(s.doubleValue);return l===u?um(l)===um(u):isNaN(l)&&isNaN(u)}return!1})(i,e);case 9:return cp(i.arrayValue.values||[],e.arrayValue.values||[],rc);case 10:case 11:return(function(r,s){const l=r.mapValue.fields||{},u=s.mapValue.fields||{};if(xA(l)!==xA(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!rc(l[h],u[h])))return!1;return!0})(i,e);default:return _n(52216,{left:i})}}function pm(i,e){return(i.values||[]).find((t=>rc(t,e)))!==void 0}function ed(i,e){if(i===e)return 0;const t=Zh(i),n=Zh(e);if(t!==n)return ci(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ci(i.booleanValue,e.booleanValue);case 2:return(function(s,l){const u=ws(s.integerValue||s.doubleValue),h=ws(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(i,e);case 3:return SA(i.timestampValue,e.timestampValue);case 4:return SA(fm(i),fm(e));case 5:return Yb(i.stringValue,e.stringValue);case 6:return(function(s,l){const u=Zc(s),h=Zc(l);return u.compareTo(h)})(i.bytesValue,e.bytesValue);case 7:return(function(s,l){const u=s.split("/"),h=l.split("/");for(let f=0;f<u.length&&f<h.length;f++){const x=ci(u[f],h[f]);if(x!==0)return x}return ci(u.length,h.length)})(i.referenceValue,e.referenceValue);case 8:return(function(s,l){const u=ci(ws(s.latitude),ws(l.latitude));return u!==0?u:ci(ws(s.longitude),ws(l.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return TA(i.arrayValue,e.arrayValue);case 10:return(function(s,l){const u=s.fields||{},h=l.fields||{},f=u[mp]?.arrayValue,x=h[mp]?.arrayValue,g=ci(f?.values?.length||0,x?.values?.length||0);return g!==0?g:TA(f,x)})(i.mapValue,e.mapValue);case 11:return(function(s,l){if(s===Vh.mapValue&&l===Vh.mapValue)return 0;if(s===Vh.mapValue)return 1;if(l===Vh.mapValue)return-1;const u=s.fields||{},h=Object.keys(u),f=l.fields||{},x=Object.keys(f);h.sort(),x.sort();for(let g=0;g<h.length&&g<x.length;++g){const w=Yb(h[g],x[g]);if(w!==0)return w;const A=ed(u[h[g]],f[x[g]]);if(A!==0)return A}return ci(h.length,x.length)})(i.mapValue,e.mapValue);default:throw _n(23264,{he:t})}}function SA(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return ci(i,e);const t=Qc(i),n=Qc(e),r=ci(t.seconds,n.seconds);return r!==0?r:ci(t.nanos,n.nanos)}function TA(i,e){const t=i.values||[],n=e.values||[];for(let r=0;r<t.length&&r<n.length;++r){const s=ed(t[r],n[r]);if(s)return s}return ci(t.length,n.length)}function yp(i){return nx(i)}function nx(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const n=Qc(t);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return Zc(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return tn.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let n="[",r=!0;for(const s of t.values||[])r?r=!1:n+=",",n+=nx(s);return n+"]"})(i.arrayValue):"mapValue"in i?(function(t){const n=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const l of n)s?s=!1:r+=",",r+=`${l}:${nx(t.fields[l])}`;return r+"}"})(i.mapValue):_n(61005,{value:i})}function v0(i){switch(Zh(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Y1(i);return e?16+v0(e):16;case 5:return 2*i.stringValue.length;case 6:return Zc(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((r,s)=>r+v0(s)),0)})(i.arrayValue);case 10:case 11:return(function(n){let r=0;return uf(n.fields,((s,l)=>{r+=s.length+v0(l)})),r})(i.mapValue);default:throw _n(13486,{value:i})}}function N2(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function ix(i){return!!i&&"integerValue"in i}function gm(i){return!!i&&"arrayValue"in i}function AA(i){return!!i&&"nullValue"in i}function EA(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function _0(i){return!!i&&"mapValue"in i}function X1(i){return(i?.mapValue?.fields||{})[L2]?.stringValue===D2}function $g(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return uf(i.mapValue.fields,((t,n)=>e.mapValue.fields[t]=$g(n))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$g(i.arrayValue.values[t]);return e}return{...i}}function F3(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===M3}const j3={mapValue:{fields:{[L2]:{stringValue:D2},[mp]:{arrayValue:{}}}}};function kj(i){return"nullValue"in i?y0:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?N2(Yd.empty(),tn.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?X1(i)?j3:{mapValue:{}}:_n(35942,{value:i})}function Cj(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?N2(Yd.empty(),tn.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?j3:"mapValue"in i?X1(i)?{mapValue:{}}:Vh:_n(61959,{value:i})}function IA(i,e){const t=ed(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function kA(i,e){const t=ed(i.value,e.value);return t!==0?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}class fl{constructor(e){this.value=e}static empty(){return new fl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!_0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$g(t)}setAll(e){let t=Ds.emptyPath(),n={},r=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const h=this.getFieldsMap(t);this.applyChanges(h,n,r),n={},r=[],t=u.popLast()}l?n[u.lastSegment()]=$g(l):r.push(u.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());_0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];_0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){uf(t,((r,s)=>e[r]=s));for(const r of n)delete e[r]}clone(){return new fl($g(this.value))}}function V3(i){const e=[];return uf(i.fields,((t,n)=>{const r=new Ds([t]);if(_0(n)){const s=V3(n.mapValue).fields;if(s.length===0)e.push(r);else for(const l of s)e.push(r.child(l))}else e.push(r)})),new ru(e)}class Xs{constructor(e,t,n,r,s,l,u){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Xs(e,0,Hn.min(),Hn.min(),Hn.min(),fl.empty(),0)}static newFoundDocument(e,t,n,r){return new Xs(e,1,t,Hn.min(),n,r,0)}static newNoDocument(e,t){return new Xs(e,2,t,Hn.min(),Hn.min(),fl.empty(),0)}static newUnknownDocument(e,t){return new Xs(e,3,t,Hn.min(),Hn.min(),fl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Hn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Hn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class vp{constructor(e,t){this.position=e,this.inclusive=t}}function CA(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],l=i.position[r];if(s.field.isKeyField()?n=tn.comparator(tn.fromName(l.referenceValue),t.key):n=ed(l,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function RA(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!rc(i.position[t],e.position[t]))return!1;return!0}class Q0{constructor(e,t="asc"){this.field=e,this.dir=t}}function Rj(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}class z3{}class rr extends z3{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Lj(e,t,n):t==="array-contains"?new Pj(e,n):t==="in"?new K3(e,n):t==="not-in"?new Oj(e,n):t==="array-contains-any"?new Mj(e,n):new rr(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Dj(e,n):new Nj(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ed(t,this.value)):t!==null&&Zh(this.value)===Zh(t)&&this.matchesComparison(ed(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _n(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Gr extends z3{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Gr(e,t)}matches(e){return _p(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function _p(i){return i.op==="and"}function rx(i){return i.op==="or"}function P2(i){return U3(i)&&_p(i)}function U3(i){for(const e of i.filters)if(e instanceof Gr)return!1;return!0}function sx(i){if(i instanceof rr)return i.field.canonicalString()+i.op.toString()+yp(i.value);if(P2(i))return i.filters.map((e=>sx(e))).join(",");{const e=i.filters.map((t=>sx(t))).join(",");return`${i.op}(${e})`}}function B3(i,e){return i instanceof rr?(function(n,r){return r instanceof rr&&n.op===r.op&&n.field.isEqual(r.field)&&rc(n.value,r.value)})(i,e):i instanceof Gr?(function(n,r){return r instanceof Gr&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce(((s,l,u)=>s&&B3(l,r.filters[u])),!0):!1})(i,e):void _n(19439)}function $3(i,e){const t=i.filters.concat(e);return Gr.create(t,i.op)}function G3(i){return i instanceof rr?(function(t){return`${t.field.canonicalString()} ${t.op} ${yp(t.value)}`})(i):i instanceof Gr?(function(t){return t.op.toString()+" {"+t.getFilters().map(G3).join(" ,")+"}"})(i):"Filter"}class Lj extends rr{constructor(e,t,n){super(e,t,n),this.key=tn.fromName(n.referenceValue)}matches(e){const t=tn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Dj extends rr{constructor(e,t){super(e,"in",t),this.keys=H3("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Nj extends rr{constructor(e,t){super(e,"not-in",t),this.keys=H3("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function H3(i,e){return(e.arrayValue?.values||[]).map((t=>tn.fromName(t.referenceValue)))}class Pj extends rr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return gm(t)&&pm(t.arrayValue,this.value)}}class K3 extends rr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&pm(this.value.arrayValue,t)}}class Oj extends rr{constructor(e,t){super(e,"not-in",t)}matches(e){if(pm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!pm(this.value.arrayValue,t)}}class Mj extends rr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!gm(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>pm(this.value.arrayValue,n)))}}class Fj{constructor(e,t=null,n=[],r=[],s=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=l,this.endAt=u,this.Te=null}}function ax(i,e=null,t=[],n=[],r=null,s=null,l=null){return new Fj(i,e,t,n,r,s,l)}function Xd(i){const e=hi(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>sx(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(s){return s.field.canonicalString()+s.dir})(n))).join(","),H1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>yp(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>yp(n))).join(",")),e.Te=t}return e.Te}function Bm(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!Rj(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!B3(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!RA(i.startAt,e.startAt)&&RA(i.endAt,e.endAt)}function Z0(i){return tn.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function e1(i,e){return i.filters.filter((t=>t instanceof rr&&t.field.isEqual(e)))}function LA(i,e,t){let n=y0,r=!0;for(const s of e1(i,e)){let l=y0,u=!0;switch(s.op){case"<":case"<=":l=kj(s.value);break;case"==":case"in":case">=":l=s.value;break;case">":l=s.value,u=!1;break;case"!=":case"not-in":l=y0}IA({value:n,inclusive:r},{value:l,inclusive:u})<0&&(n=l,r=u)}if(t!==null){for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const l=t.position[s];IA({value:n,inclusive:r},{value:l,inclusive:t.inclusive})<0&&(n=l,r=t.inclusive);break}}return{value:n,inclusive:r}}function DA(i,e,t){let n=Vh,r=!0;for(const s of e1(i,e)){let l=Vh,u=!0;switch(s.op){case">=":case">":l=Cj(s.value),u=!1;break;case"==":case"in":case"<=":l=s.value;break;case"<":l=s.value,u=!1;break;case"!=":case"not-in":l=Vh}kA({value:n,inclusive:r},{value:l,inclusive:u})>0&&(n=l,r=u)}if(t!==null){for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const l=t.position[s];kA({value:n,inclusive:r},{value:l,inclusive:t.inclusive})>0&&(n=l,r=t.inclusive);break}}return{value:n,inclusive:r}}class J1{constructor(e,t=null,n=[],r=[],s=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function jj(i,e,t,n,r,s,l,u){return new J1(i,e,t,n,r,s,l,u)}function Q1(i){return new J1(i)}function NA(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function Vj(i){return i.collectionGroup!==null}function Gg(i){const e=hi(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new Fr(Ds.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((f=>{f.isInequality()&&(u=u.add(f.field))}))})),u})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Q0(s,n))})),t.has(Ds.keyField().canonicalString())||e.Ie.push(new Q0(Ds.keyField(),n))}return e.Ie}function ou(i){const e=hi(i);return e.Ee||(e.Ee=zj(e,Gg(i))),e.Ee}function zj(i,e){if(i.limitType==="F")return ax(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new Q0(r.field,s)}));const t=i.endAt?new vp(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new vp(i.startAt.position,i.startAt.inclusive):null;return ax(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function ox(i,e,t){return new J1(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Z1(i,e){return Bm(ou(i),ou(e))&&i.limitType===e.limitType}function W3(i){return`${Xd(ou(i))}|lt:${i.limitType}`}function Uf(i){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((r=>G3(r))).join(", ")}]`),H1(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((r=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(r))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((r=>yp(r))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((r=>yp(r))).join(",")),`Target(${n})`})(ou(i))}; limitType=${i.limitType})`}function $m(i,e){return e.isFoundDocument()&&(function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):tn.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)})(i,e)&&(function(n,r){for(const s of Gg(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(i,e)&&(function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0})(i,e)&&(function(n,r){return!(n.startAt&&!(function(l,u,h){const f=CA(l,u,h);return l.inclusive?f<=0:f<0})(n.startAt,Gg(n),r)||n.endAt&&!(function(l,u,h){const f=CA(l,u,h);return l.inclusive?f>=0:f>0})(n.endAt,Gg(n),r))})(i,e)}function Uj(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function q3(i){return(e,t)=>{let n=!1;for(const r of Gg(i)){const s=Bj(r,e,t);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function Bj(i,e,t){const n=i.field.isKeyField()?tn.comparator(e.key,t.key):(function(s,l,u){const h=l.data.field(s),f=u.data.field(s);return h!==null&&f!==null?ed(h,f):_n(42886)})(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return _n(19790,{direction:i.dir})}}class ih{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){uf(this.inner,((t,n)=>{for(const[r,s]of n)e(r,s)}))}isEmpty(){return R3(this.inner)}size(){return this.innerSize}}const $j=new ha(tn.comparator);function Ml(){return $j}const Y3=new ha(tn.comparator);function Dg(...i){let e=Y3;for(const t of i)e=e.insert(t.key,t);return e}function X3(i){let e=Y3;return i.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Ju(){return Hg()}function J3(){return Hg()}function Hg(){return new ih((i=>i.toString()),((i,e)=>i.isEqual(e)))}const Gj=new ha(tn.comparator),Hj=new Fr(tn.comparator);function Di(...i){let e=Hj;for(const t of i)e=e.add(t);return e}const Kj=new Fr(ci);function Wj(){return Kj}function O2(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:um(e)?"-0":e}}function Q3(i){return{integerValue:""+i}}function qj(i,e){return ZF(e)?Q3(e):O2(i,e)}class ev{constructor(){this._=void 0}}function Yj(i,e,t){return i instanceof mm?(function(r,s){const l={fields:{[N3]:{stringValue:D3},[O3]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&R2(s)&&(s=Y1(s)),s&&(l.fields[P3]=s),{mapValue:l}})(t,e):i instanceof bp?eR(i,e):i instanceof xp?tR(i,e):(function(r,s){const l=Z3(r,s),u=PA(l)+PA(r.Ae);return ix(l)&&ix(r.Ae)?Q3(u):O2(r.serializer,u)})(i,e)}function Xj(i,e,t){return i instanceof bp?eR(i,e):i instanceof xp?tR(i,e):t}function Z3(i,e){return i instanceof ym?(function(n){return ix(n)||(function(s){return!!s&&"doubleValue"in s})(n)})(e)?e:{integerValue:0}:null}class mm extends ev{}class bp extends ev{constructor(e){super(),this.elements=e}}function eR(i,e){const t=nR(e);for(const n of i.elements)t.some((r=>rc(r,n)))||t.push(n);return{arrayValue:{values:t}}}class xp extends ev{constructor(e){super(),this.elements=e}}function tR(i,e){let t=nR(e);for(const n of i.elements)t=t.filter((r=>!rc(r,n)));return{arrayValue:{values:t}}}class ym extends ev{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function PA(i){return ws(i.integerValue||i.doubleValue)}function nR(i){return gm(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class Jj{constructor(e,t){this.field=e,this.transform=t}}function Qj(i,e){return i.field.isEqual(e.field)&&(function(n,r){return n instanceof bp&&r instanceof bp||n instanceof xp&&r instanceof xp?cp(n.elements,r.elements,rc):n instanceof ym&&r instanceof ym?rc(n.Ae,r.Ae):n instanceof mm&&r instanceof mm})(i.transform,e.transform)}class Zj{constructor(e,t){this.version=e,this.transformResults=t}}class Fl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Fl}static exists(e){return new Fl(void 0,e)}static updateTime(e){return new Fl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function b0(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class tv{}function iR(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new M2(i.key,Fl.none()):new Fp(i.key,i.data,Fl.none());{const t=i.data,n=fl.empty();let r=new Fr(Ds.comparator);for(let s of e.fields)if(!r.has(s)){let l=t.field(s);l===null&&s.length>1&&(s=s.popLast(),l=t.field(s)),l===null?n.delete(s):n.set(s,l),r=r.add(s)}return new dd(i.key,n,new ru(r.toArray()),Fl.none())}}function e7(i,e,t){i instanceof Fp?(function(r,s,l){const u=r.value.clone(),h=MA(r.fieldTransforms,s,l.transformResults);u.setAll(h),s.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(i,e,t):i instanceof dd?(function(r,s,l){if(!b0(r.precondition,s))return void s.convertToUnknownDocument(l.version);const u=MA(r.fieldTransforms,s,l.transformResults),h=s.data;h.setAll(rR(r)),h.setAll(u),s.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(i,e,t):(function(r,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Kg(i,e,t,n){return i instanceof Fp?(function(s,l,u,h){if(!b0(s.precondition,l))return u;const f=s.value.clone(),x=FA(s.fieldTransforms,h,l);return f.setAll(x),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null})(i,e,t,n):i instanceof dd?(function(s,l,u,h){if(!b0(s.precondition,l))return u;const f=FA(s.fieldTransforms,h,l),x=l.data;return x.setAll(rR(s)),x.setAll(f),l.convertToFoundDocument(l.version,x).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((g=>g.field)))})(i,e,t,n):(function(s,l,u){return b0(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(i,e,t)}function t7(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=Z3(n.transform,r||null);s!=null&&(t===null&&(t=fl.empty()),t.set(n.field,s))}return t||null}function OA(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&cp(n,r,((s,l)=>Qj(s,l)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class Fp extends tv{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class dd extends tv{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rR(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}})),e}function MA(i,e,t){const n=new Map;jn(i.length===t.length,32656,{Re:t.length,Ve:i.length});for(let r=0;r<t.length;r++){const s=i[r],l=s.transform,u=e.data.field(s.field);n.set(s.field,Xj(l,u,t[r]))}return n}function FA(i,e,t){const n=new Map;for(const r of i){const s=r.transform,l=t.data.field(r.field);n.set(r.field,Yj(s,l,e))}return n}class M2 extends tv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sR extends tv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class F2{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&e7(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Kg(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Kg(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=J3();return this.mutations.forEach((r=>{const s=e.get(r.key),l=s.overlayedDocument;let u=this.applyToLocalView(l,s.mutatedFields);u=t.has(r.key)?null:u;const h=iR(l,u);h!==null&&n.set(r.key,h),l.isValidDocument()||l.convertToNoDocument(Hn.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Di())}isEqual(e){return this.batchId===e.batchId&&cp(this.mutations,e.mutations,((t,n)=>OA(t,n)))&&cp(this.baseMutations,e.baseMutations,((t,n)=>OA(t,n)))}}class j2{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){jn(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=(function(){return Gj})();const s=e.mutations;for(let l=0;l<s.length;l++)r=r.insert(s[l].key,n[l].version);return new j2(e,t,n,r)}}class V2{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class n7{constructor(e,t){this.count=e,this.unchangedNames=t}}var wa,sr;function i7(i){switch(i){case Ot.OK:return _n(64938);case Ot.CANCELLED:case Ot.UNKNOWN:case Ot.DEADLINE_EXCEEDED:case Ot.RESOURCE_EXHAUSTED:case Ot.INTERNAL:case Ot.UNAVAILABLE:case Ot.UNAUTHENTICATED:return!1;case Ot.INVALID_ARGUMENT:case Ot.NOT_FOUND:case Ot.ALREADY_EXISTS:case Ot.PERMISSION_DENIED:case Ot.FAILED_PRECONDITION:case Ot.ABORTED:case Ot.OUT_OF_RANGE:case Ot.UNIMPLEMENTED:case Ot.DATA_LOSS:return!0;default:return _n(15467,{code:i})}}function aR(i){if(i===void 0)return Xo("GRPC error has no .code"),Ot.UNKNOWN;switch(i){case wa.OK:return Ot.OK;case wa.CANCELLED:return Ot.CANCELLED;case wa.UNKNOWN:return Ot.UNKNOWN;case wa.DEADLINE_EXCEEDED:return Ot.DEADLINE_EXCEEDED;case wa.RESOURCE_EXHAUSTED:return Ot.RESOURCE_EXHAUSTED;case wa.INTERNAL:return Ot.INTERNAL;case wa.UNAVAILABLE:return Ot.UNAVAILABLE;case wa.UNAUTHENTICATED:return Ot.UNAUTHENTICATED;case wa.INVALID_ARGUMENT:return Ot.INVALID_ARGUMENT;case wa.NOT_FOUND:return Ot.NOT_FOUND;case wa.ALREADY_EXISTS:return Ot.ALREADY_EXISTS;case wa.PERMISSION_DENIED:return Ot.PERMISSION_DENIED;case wa.FAILED_PRECONDITION:return Ot.FAILED_PRECONDITION;case wa.ABORTED:return Ot.ABORTED;case wa.OUT_OF_RANGE:return Ot.OUT_OF_RANGE;case wa.UNIMPLEMENTED:return Ot.UNIMPLEMENTED;case wa.DATA_LOSS:return Ot.DATA_LOSS;default:return _n(39323,{code:i})}}(sr=wa||(wa={}))[sr.OK=0]="OK",sr[sr.CANCELLED=1]="CANCELLED",sr[sr.UNKNOWN=2]="UNKNOWN",sr[sr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",sr[sr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",sr[sr.NOT_FOUND=5]="NOT_FOUND",sr[sr.ALREADY_EXISTS=6]="ALREADY_EXISTS",sr[sr.PERMISSION_DENIED=7]="PERMISSION_DENIED",sr[sr.UNAUTHENTICATED=16]="UNAUTHENTICATED",sr[sr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",sr[sr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",sr[sr.ABORTED=10]="ABORTED",sr[sr.OUT_OF_RANGE=11]="OUT_OF_RANGE",sr[sr.UNIMPLEMENTED=12]="UNIMPLEMENTED",sr[sr.INTERNAL=13]="INTERNAL",sr[sr.UNAVAILABLE=14]="UNAVAILABLE",sr[sr.DATA_LOSS=15]="DATA_LOSS";function r7(){return new TextEncoder}const s7=new Hh([4294967295,4294967295],0);function jA(i){const e=r7().encode(i),t=new a3;return t.update(e),new Uint8Array(t.digest())}function VA(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Hh([t,n],0),new Hh([r,s],0)]}class z2{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ng(`Invalid padding: ${t}`);if(n<0)throw new Ng(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ng(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ng(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Hh.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Hh.fromNumber(n)));return r.compare(s7)===1&&(r=new Hh([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=jA(e),[n,r]=VA(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,r,s);if(!this.we(l))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new z2(s,r,t);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=jA(e),[n,r]=VA(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,r,s);this.Se(l)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ng extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nv{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Gm.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new nv(Hn.min(),r,new ha(ci),Ml(),Di())}}class Gm{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Gm(n,t,Di(),Di(),Di())}}class x0{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class oR{constructor(e,t){this.targetId=e,this.Ce=t}}class lR{constructor(e,t,n=Ta.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class zA{constructor(){this.ve=0,this.Fe=UA(),this.Me=Ta.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Di(),t=Di(),n=Di();return this.Fe.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:_n(38017,{changeType:s})}})),new Gm(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=UA()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,jn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class a7{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ml(),this.Je=zy(),this.He=zy(),this.Ye=new ha(ci)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:_n(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(Z0(s))if(n===0){const l=new tn(s.path);this.et(t,l,Xs.newNoDocument(l,Hn.min()))}else jn(n===1,20013,{expectedCount:n});else{const l=this._t(t);if(l!==n){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,f)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let l,u;try{l=Zc(n).toUint8Array()}catch(h){if(h instanceof L3)return qd("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new z2(l,r,s)}catch(h){return qd(h instanceof Ng?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach((s=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(t,s,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((s,l)=>{const u=this.ot(l);if(u){if(s.current&&Z0(u.target)){const h=new tn(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Xs.newNoDocument(h,e))}s.Be&&(t.set(l,s.ke()),s.qe())}}));let n=Di();this.He.forEach(((s,l)=>{let u=!0;l.forEachWhile((h=>{const f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(s))})),this.je.forEach(((s,l)=>l.setReadTime(e)));const r=new nv(e,t,this.Ye,this.je,n);return this.je=Ml(),this.Je=zy(),this.He=zy(),this.Ye=new ha(ci),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new zA,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Fr(ci),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Fr(ci),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||zt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zA),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zy(){return new ha(tn.comparator)}function UA(){return new ha(tn.comparator)}const o7={asc:"ASCENDING",desc:"DESCENDING"},l7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},u7={and:"AND",or:"OR"};class c7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function lx(i,e){return i.useProto3Json||H1(e)?e:{value:e}}function wp(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uR(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function h7(i,e){return wp(i,e.toTimestamp())}function Qo(i){return jn(!!i,49232),Hn.fromTimestamp((function(t){const n=Qc(t);return new Mr(n.seconds,n.nanos)})(i))}function U2(i,e){return ux(i,e).canonicalString()}function ux(i,e){const t=(function(r){return new $r(["projects",r.projectId,"databases",r.database])})(i).child("documents");return e===void 0?t:t.child(e)}function cR(i){const e=$r.fromString(i);return jn(_R(e),10190,{key:e.toString()}),e}function t1(i,e){return U2(i.databaseId,e.path)}function Bd(i,e){const t=cR(e);if(t.get(1)!==i.databaseId.projectId)throw new un(Ot.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new un(Ot.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new tn(fR(t))}function hR(i,e){return U2(i.databaseId,e)}function dR(i){const e=cR(i);return e.length===4?$r.emptyPath():fR(e)}function cx(i){return new $r(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function fR(i){return jn(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function BA(i,e,t){return{name:t1(i,e),fields:t.value.mapValue.fields}}function d7(i,e,t){const n=Bd(i,e.name),r=Qo(e.updateTime),s=e.createTime?Qo(e.createTime):Hn.min(),l=new fl({mapValue:{fields:e.fields}}),u=Xs.newFoundDocument(n,r,s,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function f7(i,e){let t;if("targetChange"in e){e.targetChange;const n=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:_n(39313,{state:f})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(f,x){return f.useProto3Json?(jn(x===void 0||typeof x=="string",58123),Ta.fromBase64String(x||"")):(jn(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Ta.fromUint8Array(x||new Uint8Array))})(i,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(f){const x=f.code===void 0?Ot.UNKNOWN:aR(f.code);return new un(x,f.message||"")})(l);t=new lR(n,r,s,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=Bd(i,n.document.name),s=Qo(n.document.updateTime),l=n.document.createTime?Qo(n.document.createTime):Hn.min(),u=new fl({mapValue:{fields:n.document.fields}}),h=Xs.newFoundDocument(r,s,l,u),f=n.targetIds||[],x=n.removedTargetIds||[];t=new x0(f,x,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=Bd(i,n.document),s=n.readTime?Qo(n.readTime):Hn.min(),l=Xs.newNoDocument(r,s),u=n.removedTargetIds||[];t=new x0([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=Bd(i,n.document),s=n.removedTargetIds||[];t=new x0([],s,r,null)}else{if(!("filter"in e))return _n(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:s}=n,l=new n7(r,s),u=n.targetId;t=new oR(u,l)}}return t}function n1(i,e){let t;if(e instanceof Fp)t={update:BA(i,e.key,e.value)};else if(e instanceof M2)t={delete:t1(i,e.key)};else if(e instanceof dd)t={update:BA(i,e.key,e.data),updateMask:_7(e.fieldMask)};else{if(!(e instanceof sR))return _n(16599,{Vt:e.type});t={verify:t1(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(s,l){const u=l.transform;if(u instanceof mm)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof bp)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof xp)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ym)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw _n(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:h7(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:_n(27497)})(i,e.precondition)),t}function hx(i,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Fl.updateTime(Qo(s.updateTime)):s.exists!==void 0?Fl.exists(s.exists):Fl.none()})(e.currentDocument):Fl.none(),n=e.updateTransforms?e.updateTransforms.map((r=>(function(l,u){let h=null;if("setToServerValue"in u)jn(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),h=new mm;else if("appendMissingElements"in u){const x=u.appendMissingElements.values||[];h=new bp(x)}else if("removeAllFromArray"in u){const x=u.removeAllFromArray.values||[];h=new xp(x)}else"increment"in u?h=new ym(l,u.increment):_n(16584,{proto:u});const f=Ds.fromServerFormat(u.fieldPath);return new Jj(f,h)})(i,r))):[];if(e.update){e.update.name;const r=Bd(i,e.update.name),s=new fl({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(h){const f=h.fieldPaths||[];return new ru(f.map((x=>Ds.fromServerFormat(x))))})(e.updateMask);return new dd(r,s,l,t,n)}return new Fp(r,s,t,n)}if(e.delete){const r=Bd(i,e.delete);return new M2(r,t)}if(e.verify){const r=Bd(i,e.verify);return new sR(r,t)}return _n(1463,{proto:e})}function p7(i,e){return i&&i.length>0?(jn(e!==void 0,14353),i.map((t=>(function(r,s){let l=r.updateTime?Qo(r.updateTime):Qo(s);return l.isEqual(Hn.min())&&(l=Qo(s)),new Zj(l,r.transformResults||[])})(t,e)))):[]}function pR(i,e){return{documents:[hR(i,e.path)]}}function gR(i,e){const t={structuredQuery:{}},n=e.path;let r;e.collectionGroup!==null?(r=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=hR(i,r);const s=(function(f){if(f.length!==0)return vR(Gr.create(f,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const l=(function(f){if(f.length!==0)return f.map((x=>(function(w){return{field:Bf(w.field),direction:m7(w.dir)}})(x)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=lx(i,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(e.endAt)),{ft:t,parent:r}}function mR(i){let e=dR(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){jn(n===1,65062);const x=t.from[0];x.allDescendants?r=x.collectionId:e=e.child(x.collectionId)}let s=[];t.where&&(s=(function(g){const w=yR(g);return w instanceof Gr&&P2(w)?w.getFilters():[w]})(t.where));let l=[];t.orderBy&&(l=(function(g){return g.map((w=>(function(B){return new Q0($f(B.field),(function(W){switch(W){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(w)))})(t.orderBy));let u=null;t.limit&&(u=(function(g){let w;return w=typeof g=="object"?g.value:g,H1(w)?null:w})(t.limit));let h=null;t.startAt&&(h=(function(g){const w=!!g.before,A=g.values||[];return new vp(A,w)})(t.startAt));let f=null;return t.endAt&&(f=(function(g){const w=!g.before,A=g.values||[];return new vp(A,w)})(t.endAt)),jj(e,r,l,s,u,"F",h,f)}function g7(i,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _n(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function yR(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=$f(t.unaryFilter.field);return rr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=$f(t.unaryFilter.field);return rr.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=$f(t.unaryFilter.field);return rr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=$f(t.unaryFilter.field);return rr.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _n(61313);default:return _n(60726)}})(i):i.fieldFilter!==void 0?(function(t){return rr.create($f(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _n(58110);default:return _n(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return Gr.create(t.compositeFilter.filters.map((n=>yR(n))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return _n(1026)}})(t.compositeFilter.op))})(i):_n(30097,{filter:i})}function m7(i){return o7[i]}function y7(i){return l7[i]}function v7(i){return u7[i]}function Bf(i){return{fieldPath:i.canonicalString()}}function $f(i){return Ds.fromServerFormat(i.fieldPath)}function vR(i){return i instanceof rr?(function(t){if(t.op==="=="){if(EA(t.value))return{unaryFilter:{field:Bf(t.field),op:"IS_NAN"}};if(AA(t.value))return{unaryFilter:{field:Bf(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(EA(t.value))return{unaryFilter:{field:Bf(t.field),op:"IS_NOT_NAN"}};if(AA(t.value))return{unaryFilter:{field:Bf(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bf(t.field),op:y7(t.op),value:t.value}}})(i):i instanceof Gr?(function(t){const n=t.getFilters().map((r=>vR(r)));return n.length===1?n[0]:{compositeFilter:{op:v7(t.op),filters:n}}})(i):_n(54877,{filter:i})}function _7(i){const e=[];return i.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function _R(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}class Uc{constructor(e,t,n,r,s=Hn.min(),l=Hn.min(),u=Ta.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Uc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Uc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Uc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Uc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bR{constructor(e){this.yt=e}}function b7(i,e){let t;if(e.document)t=d7(i.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=tn.fromSegments(e.noDocument.path),r=Qd(e.noDocument.readTime);t=Xs.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return _n(56709);{const n=tn.fromSegments(e.unknownDocument.path),r=Qd(e.unknownDocument.version);t=Xs.newUnknownDocument(n,r)}}return e.readTime&&t.setReadTime((function(r){const s=new Mr(r[0],r[1]);return Hn.fromTimestamp(s)})(e.readTime)),t}function $A(i,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:i1(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(s,l){return{name:t1(s,l.key),fields:l.data.value.mapValue.fields,updateTime:wp(s,l.version.toTimestamp()),createTime:wp(s,l.createTime.toTimestamp())}})(i.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Jd(e.version)};else{if(!e.isUnknownDocument())return _n(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:Jd(e.version)}}return n}function i1(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function Jd(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Qd(i){const e=new Mr(i.seconds,i.nanoseconds);return Hn.fromTimestamp(e)}function Dd(i,e){const t=(e.baseMutations||[]).map((s=>hx(i.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const l=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const u=e.mutations[s+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map((s=>hx(i.yt,s))),r=Mr.fromMillis(e.localWriteTimeMs);return new F2(e.batchId,r,t,n)}function Pg(i){const e=Qd(i.readTime),t=i.lastLimboFreeSnapshotVersion!==void 0?Qd(i.lastLimboFreeSnapshotVersion):Hn.min();let n;return n=(function(s){return s.documents!==void 0})(i.query)?(function(s){const l=s.documents.length;return jn(l===1,1966,{count:l}),ou(Q1(dR(s.documents[0])))})(i.query):(function(s){return ou(mR(s))})(i.query),new Uc(n,i.targetId,"TargetPurposeListen",i.lastListenSequenceNumber,e,t,Ta.fromBase64String(i.resumeToken))}function xR(i,e){const t=Jd(e.snapshotVersion),n=Jd(e.lastLimboFreeSnapshotVersion);let r;r=Z0(e.target)?pR(i.yt,e.target):gR(i.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Xd(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function wR(i){const e=mR({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?ox(e,e.limit,"L"):e}function K_(i,e){return new V2(e.largestBatchId,hx(i.yt,e.overlayMutation))}function GA(i,e){const t=e.path.lastSegment();return[i,Oo(e.path.popLast()),t]}function HA(i,e,t,n){return{indexId:i,uid:e,sequenceNumber:t,readTime:Jd(n.readTime),documentKey:Oo(n.documentKey.path),largestBatchId:n.largestBatchId}}class x7{getBundleMetadata(e,t){return KA(e).get(t).next((n=>{if(n)return(function(s){return{id:s.bundleId,createTime:Qd(s.createTime),version:s.version}})(n)}))}saveBundleMetadata(e,t){return KA(e).put((function(r){return{bundleId:r.id,createTime:Jd(Qo(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return WA(e).get(t).next((n=>{if(n)return(function(s){return{name:s.name,query:wR(s.bundledQuery),readTime:Qd(s.readTime)}})(n)}))}saveNamedQuery(e,t){return WA(e).put((function(r){return{name:r.name,readTime:Jd(Qo(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function KA(i){return ja(i,K1)}function WA(i){return ja(i,W1)}class iv{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new iv(e,n)}getOverlay(e,t){return pg(e).get(GA(this.userId,t)).next((n=>n?K_(this.serializer,n):null))}getOverlays(e,t){const n=Ju();return lt.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&n.set(r,s)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((s,l)=>{const u=new V2(t,l);r.push(this.St(e,u))})),lt.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((l=>r.add(Oo(l.getCollectionPath()))));const s=[];return r.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,n+1],!1,!0);s.push(pg(e).Z(Zb,u))})),lt.waitFor(s)}getOverlaysForCollection(e,t,n){const r=Ju(),s=Oo(t),l=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return pg(e).J(Zb,l).next((u=>{for(const h of u){const f=K_(this.serializer,h);r.set(f.getKey(),f)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const s=Ju();let l;const u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return pg(e).ee({index:A3,range:u},((h,f,x)=>{const g=K_(this.serializer,f);s.size()<r||g.largestBatchId===l?(s.set(g.getKey(),g),l=g.largestBatchId):x.done()})).next((()=>s))}St(e,t){return pg(e).put((function(r,s,l){const[u,h,f]=GA(s,l.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:n1(r.yt,l.mutation)}})(this.serializer,this.userId,t))}}function pg(i){return ja(i,q1)}class w7{bt(e){return ja(e,k2)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const n=t?.value;return n?Ta.fromUint8Array(n):Ta.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Nd{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ws(e.integerValue));else if("doubleValue"in e){const n=ws(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),um(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=Qc(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Zc(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?F3(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):X1(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):_n(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=mp,s=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ws(s)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),tn.fromName(e).path.forEach((n=>{this.Ft(t,60),this.Ut(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Nd.Kt=new Nd;const Df=255;function S7(i){if(i===0)return 8;let e=0;return i>>4||(e+=4,i<<=4),i>>6||(e+=2,i<<=2),i>>7||(e+=1),e}function qA(i){const e=64-(function(n){let r=0;for(let s=0;s<8;++s){const l=S7(255&n[s]);if(r+=l,l!==8)break}return r})(i);return Math.ceil(e/8)}class T7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),n=qA(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),n=qA(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Df),this.sn(255)}_n(){this.an(Df),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,s,!1),new Uint8Array(l.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Df?(this.sn(Df),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Df?(this.an(Df),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class A7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class E7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class gg{constructor(){this.cn=new T7,this.ln=new A7(this.cn),this.hn=new E7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Pd{constructor(e,t,n,r){this.Tn=e,this.In=t,this.En=n,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new Pd(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:w0(this.En),directionalValue:w0(this.dn),orderedDocumentKey:w0(t),documentKey:n.path.toArray()}}Vn(e,t,n){const r=this.Rn(e,t,n);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Ih(i,e){let t=i.Tn-e.Tn;return t!==0?t:(t=YA(i.En,e.En),t!==0?t:(t=YA(i.dn,e.dn),t!==0?t:tn.comparator(i.In,e.In)))}function YA(i,e){for(let t=0;t<i.length&&t<e.length;++t){const n=i[t]-e[t];if(n!==0)return n}return i.length-e.length}function w0(i){return _C()?(function(t){let n="";for(let r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n})(i):i}function XA(i){return typeof i!="string"?i:(function(t){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n})(i)}class JA{constructor(e){this.mn=new Fr(((t,n)=>Ds.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(jn(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Xb(e);if(t!==void 0&&!this.wn(t))return!1;const n=Ed(e);let r=new Set,s=0,l=0;for(;s<n.length&&this.wn(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!r.has(u.field.canonicalString())){const h=n[s];if(!this.Sn(u,h)||!this.bn(this.fn[l++],h))return!1}++s}for(;s<n.length;++s){const u=n[s];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new Fr(Ds.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new p0(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new p0(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new p0(n.field,n.dir==="asc"?0:1)));return new W0(W0.UNKNOWN_ID,this.collectionId,t,lm.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function SR(i){if(jn(i instanceof rr||i instanceof Gr,20012),i instanceof rr){if(i instanceof K3){const t=i.value.arrayValue?.values?.map((n=>rr.create(i.field,"==",n)))||[];return Gr.create(t,"or")}return i}const e=i.filters.map((t=>SR(t)));return Gr.create(e,i.op)}function I7(i){if(i.getFilters().length===0)return[];const e=px(SR(i));return jn(TR(e),7391),dx(e)||fx(e)?[e]:e.getFilters()}function dx(i){return i instanceof rr}function fx(i){return i instanceof Gr&&P2(i)}function TR(i){return dx(i)||fx(i)||(function(t){if(t instanceof Gr&&rx(t)){for(const n of t.getFilters())if(!dx(n)&&!fx(n))return!1;return!0}return!1})(i)}function px(i){if(jn(i instanceof rr||i instanceof Gr,34018),i instanceof rr)return i;if(i.filters.length===1)return px(i.filters[0]);const e=i.filters.map((n=>px(n)));let t=Gr.create(e,i.op);return t=r1(t),TR(t)?t:(jn(t instanceof Gr,64498),jn(_p(t),40251),jn(t.filters.length>1,57927),t.filters.reduce(((n,r)=>B2(n,r))))}function B2(i,e){let t;return jn(i instanceof rr||i instanceof Gr,38388),jn(e instanceof rr||e instanceof Gr,25473),t=i instanceof rr?e instanceof rr?(function(r,s){return Gr.create([r,s],"and")})(i,e):QA(i,e):e instanceof rr?QA(e,i):(function(r,s){if(jn(r.filters.length>0&&s.filters.length>0,48005),_p(r)&&_p(s))return $3(r,s.getFilters());const l=rx(r)?r:s,u=rx(r)?s:r,h=l.filters.map((f=>B2(f,u)));return Gr.create(h,"or")})(i,e),r1(t)}function QA(i,e){if(_p(e))return $3(e,i.getFilters());{const t=e.filters.map((n=>B2(i,n)));return Gr.create(t,"or")}}function r1(i){if(jn(i instanceof rr||i instanceof Gr,11850),i instanceof rr)return i;const e=i.getFilters();if(e.length===1)return r1(e[0]);if(U3(i))return i;const t=e.map((r=>r1(r))),n=[];return t.forEach((r=>{r instanceof rr?n.push(r):r instanceof Gr&&(r.op===i.op?n.push(...r.filters):n.push(r))})),n.length===1?n[0]:Gr.create(n,i.op)}class k7{constructor(){this.Cn=new $2}addToCollectionParentIndex(e,t){return this.Cn.add(t),lt.resolve()}getCollectionParents(e,t){return lt.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return lt.resolve()}deleteFieldIndex(e,t){return lt.resolve()}deleteAllFieldIndexes(e){return lt.resolve()}createTargetIndexes(e,t){return lt.resolve()}getDocumentsMatchingTarget(e,t){return lt.resolve(null)}getIndexType(e,t){return lt.resolve(0)}getFieldIndexes(e,t){return lt.resolve([])}getNextCollectionGroupToUpdate(e){return lt.resolve(null)}getMinOffset(e,t){return lt.resolve(zl.min())}getMinOffsetFromCollectionGroup(e,t){return lt.resolve(zl.min())}updateCollectionGroup(e,t,n){return lt.resolve()}updateIndexEntries(e,t){return lt.resolve()}}class $2{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Fr($r.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Fr($r.comparator)).toArray()}}const ZA="IndexedDbIndexManager",Uy=new Uint8Array(0);class C7{constructor(e,t){this.databaseId=t,this.vn=new $2,this.Fn=new ih((n=>Xd(n)),((n,r)=>Bm(n,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:n,parent:Oo(r)};return eE(e).put(s)}return lt.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[p3(t),""],!1,!0);return eE(e).J(r).next((s=>{for(const l of s){if(l.collectionId!==t)break;n.push(Xu(l.parent))}return n}))}addFieldIndex(e,t){const n=mg(e),r=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(t);delete r.indexId;const s=n.add(r);if(t.indexState){const l=Pf(e);return s.next((u=>{l.put(HA(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const n=mg(e),r=Pf(e),s=Nf(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=mg(e),n=Nf(e),r=Pf(e);return t.Z().next((()=>n.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return lt.forEach(this.Mn(t),(n=>this.getIndexType(e,n).next((r=>{if(r===0||r===1){const s=new JA(n).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const n=Nf(e);let r=!0;const s=new Map;return lt.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{r&&(r=!!u),s.set(l,u)})))).next((()=>{if(r){let l=Di();const u=[];return lt.forEach(s,((h,f)=>{zt(ZA,`Using index ${(function(he){return`id=${he.indexId}|cg=${he.collectionGroup}|f=${he.fields.map((me=>`${me.fieldPath}:${me.kind}`)).join(",")}`})(h)} to execute ${Xd(t)}`);const x=(function(he,me){const Ce=Xb(me);if(Ce===void 0)return null;for(const Ve of e1(he,Ce.fieldPath))switch(Ve.op){case"array-contains-any":return Ve.value.arrayValue.values||[];case"array-contains":return[Ve.value]}return null})(f,h),g=(function(he,me){const Ce=new Map;for(const Ve of Ed(me))for(const pe of e1(he,Ve.fieldPath))switch(pe.op){case"==":case"in":Ce.set(Ve.fieldPath.canonicalString(),pe.value);break;case"not-in":case"!=":return Ce.set(Ve.fieldPath.canonicalString(),pe.value),Array.from(Ce.values())}return null})(f,h),w=(function(he,me){const Ce=[];let Ve=!0;for(const pe of Ed(me)){const ee=pe.kind===0?LA(he,pe.fieldPath,he.startAt):DA(he,pe.fieldPath,he.startAt);Ce.push(ee.value),Ve&&(Ve=ee.inclusive)}return new vp(Ce,Ve)})(f,h),A=(function(he,me){const Ce=[];let Ve=!0;for(const pe of Ed(me)){const ee=pe.kind===0?DA(he,pe.fieldPath,he.endAt):LA(he,pe.fieldPath,he.endAt);Ce.push(ee.value),Ve&&(Ve=ee.inclusive)}return new vp(Ce,Ve)})(f,h),B=this.On(h,f,w),$=this.On(h,f,A),W=this.Nn(h,f,g),q=this.Bn(h.indexId,x,B,w.inclusive,$,A.inclusive,W);return lt.forEach(q,(ge=>n.Y(ge,t.limit).next((he=>{he.forEach((me=>{const Ce=tn.fromSegments(me.documentKey);l.has(Ce)||(l=l.add(Ce),u.push(Ce))}))}))))})).next((()=>u))}return lt.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=I7(Gr.create(e.filters,"and")).map((n=>ax(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,n,r,s,l,u){const h=(t!=null?t.length:1)*Math.max(n.length,s.length),f=h/(t!=null?t.length:1),x=[];for(let g=0;g<h;++g){const w=t?this.Ln(t[g/f]):Uy,A=this.kn(e,w,n[g%f],r),B=this.qn(e,w,s[g%f],l),$=u.map((W=>this.kn(e,w,W,!0)));x.push(...this.createRange(A,B,$))}return x}kn(e,t,n,r){const s=new Pd(e,tn.empty(),t,n);return r?s:s.An()}qn(e,t,n,r){const s=new Pd(e,tn.empty(),t,n);return r?s.An():s}xn(e,t){const n=new JA(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((s=>{let l=null;for(const u of s)n.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let n=2;const r=this.Mn(t);return lt.forEach(r,(s=>this.xn(e,s).next((l=>{l?n!==0&&l.fields.length<(function(h){let f=new Fr(Ds.comparator),x=!1;for(const g of h.filters)for(const w of g.getFlattenedFilters())w.field.isKeyField()||(w.op==="array-contains"||w.op==="array-contains-any"?x=!0:f=f.add(w.field));for(const g of h.orderBy)g.field.isKeyField()||(f=f.add(g.field));return f.size+(x?1:0)})(s)&&(n=1):n=0})))).next((()=>(function(l){return l.limit!==null})(t)&&r.length>1&&n===2?1:n))}Qn(e,t){const n=new gg;for(const r of Ed(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const l=n.Pn(r.kind);Nd.Kt.Dt(s,l)}return n.un()}Ln(e){const t=new gg;return Nd.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new gg;return Nd.Kt.Dt(N2(this.databaseId,t),n.Pn((function(s){const l=Ed(s);return l.length===0?0:l[l.length-1].kind})(e))),n.un()}Nn(e,t,n){if(n===null)return[];let r=[];r.push(new gg);let s=0;for(const l of Ed(e)){const u=n[s++];for(const h of r)if(this.Un(t,l.fieldPath)&&gm(u))r=this.Kn(r,l,u);else{const f=h.Pn(l.kind);Nd.Kt.Dt(u,f)}}return this.Wn(r)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const r=[...e],s=[];for(const l of n.arrayValue.values||[])for(const u of r){const h=new gg;h.seed(u.un()),Nd.Kt.Dt(l,h.Pn(t.kind)),s.push(h)}return s}Un(e,t){return!!e.filters.find((n=>n instanceof rr&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=mg(e),r=Pf(e);return(t?n.J(Qb,IDBKeyRange.bound(t,t)):n.J()).next((s=>{const l=[];return lt.forEach(s,(u=>r.get([u.indexId,this.uid]).next((h=>{l.push((function(x,g){const w=g?new lm(g.sequenceNumber,new zl(Qd(g.readTime),new tn(Xu(g.documentKey)),g.largestBatchId)):lm.empty(),A=x.fields.map((([B,$])=>new p0(Ds.fromServerFormat(B),$)));return new W0(x.indexId,x.collectionGroup,A,w)})(u,h))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,r)=>{const s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:ci(n.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=mg(e),s=Pf(e);return this.Gn(e).next((l=>r.J(Qb,IDBKeyRange.bound(t,t)).next((u=>lt.forEach(u,(h=>s.put(HA(h.indexId,this.uid,l,n))))))))}updateIndexEntries(e,t){const n=new Map;return lt.forEach(t,((r,s)=>{const l=n.get(r.collectionGroup);return(l?lt.resolve(l):this.getFieldIndexes(e,r.collectionGroup)).next((u=>(n.set(r.collectionGroup,u),lt.forEach(u,(h=>this.zn(e,r,h).next((f=>{const x=this.jn(s,h);return f.isEqual(x)?lt.resolve():this.Jn(e,s,h,f,x)})))))))}))}Hn(e,t,n,r){return Nf(e).put(r.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,r){return Nf(e).delete(r.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const r=Nf(e);let s=new Fr(Ih);return r.ee({index:T3,range:IDBKeyRange.only([n.indexId,this.uid,w0(this.$n(n,t))])},((l,u)=>{s=s.add(new Pd(n.indexId,t,XA(u.arrayValue),XA(u.directionalValue)))})).next((()=>s))}jn(e,t){let n=new Fr(Ih);const r=this.Qn(t,e);if(r==null)return n;const s=Xb(t);if(s!=null){const l=e.data.field(s.fieldPath);if(gm(l))for(const u of l.arrayValue.values||[])n=n.add(new Pd(t.indexId,e.key,this.Ln(u),r))}else n=n.add(new Pd(t.indexId,e.key,Uy,r));return n}Jn(e,t,n,r,s){zt(ZA,"Updating index entries for document '%s'",t.key);const l=[];return(function(h,f,x,g,w){const A=h.getIterator(),B=f.getIterator();let $=Lf(A),W=Lf(B);for(;$||W;){let q=!1,ge=!1;if($&&W){const he=x($,W);he<0?ge=!0:he>0&&(q=!0)}else $!=null?ge=!0:q=!0;q?(g(W),W=Lf(B)):ge?(w($),$=Lf(A)):($=Lf(A),W=Lf(B))}})(r,s,Ih,(u=>{l.push(this.Hn(e,t,n,u))}),(u=>{l.push(this.Yn(e,t,n,u))})),lt.waitFor(l)}Gn(e){let t=1;return Pf(e).ee({index:S3,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,r,s)=>{s.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((l,u)=>Ih(l,u))).filter(((l,u,h)=>!u||Ih(l,h[u-1])!==0));const r=[];r.push(e);for(const l of n){const u=Ih(l,e),h=Ih(l,t);if(u===0)r[0]=e.An();else if(u>0&&h<0)r.push(l),r.push(l.An());else if(h>0)break}r.push(t);const s=[];for(let l=0;l<r.length;l+=2){if(this.Zn(r[l],r[l+1]))return[];const u=r[l].Vn(this.uid,Uy,tn.empty()),h=r[l+1].Vn(this.uid,Uy,tn.empty());s.push(IDBKeyRange.bound(u,h))}return s}Zn(e,t){return Ih(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(tE)}getMinOffset(e,t){return lt.mapArray(this.Mn(t),(n=>this.xn(e,n).next((r=>r||_n(44426))))).next(tE)}}function eE(i){return ja(i,dm)}function Nf(i){return ja(i,Bg)}function mg(i){return ja(i,I2)}function Pf(i){return ja(i,Ug)}function tE(i){jn(i.length!==0,28825);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){const r=i[n].indexState.offset;T2(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new zl(e.readTime,e.documentKey,t)}const nE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},AR=41943040;class No{static withCacheSize(e){return new No(e,No.DEFAULT_COLLECTION_PERCENTILE,No.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}function ER(i,e,t){const n=i.store(Iu),r=i.store(dp),s=[],l=IDBKeyRange.only(t.batchId);let u=0;const h=n.ee({range:l},((x,g,w)=>(u++,w.delete())));s.push(h.next((()=>{jn(u===1,47070,{batchId:t.batchId})})));const f=[];for(const x of t.mutations){const g=b3(e,x.key.path,t.batchId);s.push(r.delete(g)),f.push(x.key)}return lt.waitFor(s).next((()=>f))}function s1(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw _n(14731);e=i.noDocument}return JSON.stringify(e).length}No.DEFAULT_COLLECTION_PERCENTILE=10,No.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,No.DEFAULT=new No(AR,No.DEFAULT_COLLECTION_PERCENTILE,No.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),No.DISABLED=new No(-1,0,0);class rv{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Xn={}}static wt(e,t,n,r){jn(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new rv(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kh(e).ee({index:jd,range:n},((r,s,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const s=Gf(e),l=kh(e);return l.add({}).next((u=>{jn(typeof u=="number",49019);const h=new F2(u,t,n,r),f=(function(A,B,$){const W=$.baseMutations.map((ge=>n1(A.yt,ge))),q=$.mutations.map((ge=>n1(A.yt,ge)));return{userId:B,batchId:$.batchId,localWriteTimeMs:$.localWriteTime.toMillis(),baseMutations:W,mutations:q}})(this.serializer,this.userId,h),x=[];let g=new Fr(((w,A)=>ci(w.canonicalString(),A.canonicalString())));for(const w of r){const A=b3(this.userId,w.key.path,u);g=g.add(w.key.path.popLast()),x.push(l.put(f)),x.push(s.put(A,nj))}return g.forEach((w=>{x.push(this.indexManager.addToCollectionParentIndex(e,w))})),e.addOnCommittedListener((()=>{this.Xn[u]=h.keys()})),lt.waitFor(x).next((()=>h))}))}lookupMutationBatch(e,t){return kh(e).get(t).next((n=>n?(jn(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Dd(this.serializer,n)):null))}er(e,t){return this.Xn[t]?lt.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const r=n.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return kh(e).ee({index:jd,range:r},((l,u,h)=>{u.userId===this.userId&&(jn(u.batchId>=n,47524,{tr:n}),s=Dd(this.serializer,u)),h.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=zd;return kh(e).ee({index:jd,range:t,reverse:!0},((r,s,l)=>{n=s.batchId,l.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,zd],[this.userId,Number.POSITIVE_INFINITY]);return kh(e).J(jd,t).next((n=>n.map((r=>Dd(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=g0(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return Gf(e).ee({range:r},((l,u,h)=>{const[f,x,g]=l,w=Xu(x);if(f===this.userId&&t.path.isEqual(w))return kh(e).get(g).next((A=>{if(!A)throw _n(61480,{nr:l,batchId:g});jn(A.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:A.userId,batchId:g}),s.push(Dd(this.serializer,A))}));h.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Fr(ci);const r=[];return t.forEach((s=>{const l=g0(this.userId,s.path),u=IDBKeyRange.lowerBound(l),h=Gf(e).ee({range:u},((f,x,g)=>{const[w,A,B]=f,$=Xu(A);w===this.userId&&s.path.isEqual($)?n=n.add(B):g.done()}));r.push(h)})),lt.waitFor(r).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=g0(this.userId,n),l=IDBKeyRange.lowerBound(s);let u=new Fr(ci);return Gf(e).ee({range:l},((h,f,x)=>{const[g,w,A]=h,B=Xu(w);g===this.userId&&n.isPrefixOf(B)?B.length===r&&(u=u.add(A)):x.done()})).next((()=>this.rr(e,u)))}rr(e,t){const n=[],r=[];return t.forEach((s=>{r.push(kh(e).get(s).next((l=>{if(l===null)throw _n(35274,{batchId:s});jn(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:s}),n.push(Dd(this.serializer,l))})))})),lt.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return ER(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),lt.forEach(n,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return lt.resolve();const n=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),r=[];return Gf(e).ee({range:n},((s,l,u)=>{if(s[0]===this.userId){const h=Xu(s[1]);r.push(h)}else u.done()})).next((()=>{jn(r.length===0,56720,{sr:r.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return IR(e,this.userId,t)}_r(e){return kR(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:zd,lastStreamToken:""}))}}function IR(i,e,t){const n=g0(e,t.path),r=n[1],s=IDBKeyRange.lowerBound(n);let l=!1;return Gf(i).ee({range:s,X:!0},((u,h,f)=>{const[x,g,w]=u;x===e&&g===r&&(l=!0),f.done()})).next((()=>l))}function kh(i){return ja(i,Iu)}function Gf(i){return ja(i,dp)}function kR(i){return ja(i,cm)}class Zd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zd(0)}static cr(){return new Zd(-1)}}class R7{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const n=new Zd(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Hn.fromTimestamp(new Mr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Of(e).delete(t.targetId))).next((()=>this.lr(e))).next((n=>(jn(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,t,n){let r=0;const s=[];return Of(e).ee(((l,u)=>{const h=Pg(u);h.sequenceNumber<=t&&n.get(h.targetId)===null&&(r++,s.push(this.removeTargetData(e,h)))})).next((()=>lt.waitFor(s))).next((()=>r))}forEachTarget(e,t){return Of(e).ee(((n,r)=>{const s=Pg(r);t(s)}))}lr(e){return iE(e).get(X0).next((t=>(jn(t!==null,2888),t)))}hr(e,t){return iE(e).put(X0,t)}Pr(e,t){return Of(e).put(xR(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const n=Xd(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return Of(e).ee({range:r,index:w3},((l,u,h)=>{const f=Pg(u);Bm(t,f.target)&&(s=f,h.done())})).next((()=>s))}addMatchingKeys(e,t,n){const r=[],s=Fh(e);return t.forEach((l=>{const u=Oo(l.path);r.push(s.put({targetId:n,path:u})),r.push(this.referenceDelegate.addReference(e,n,l))})),lt.waitFor(r)}removeMatchingKeys(e,t,n){const r=Fh(e);return lt.forEach(t,(s=>{const l=Oo(s.path);return lt.waitFor([r.delete([n,l]),this.referenceDelegate.removeReference(e,n,s)])}))}removeMatchingKeysForTargetId(e,t){const n=Fh(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Fh(e);let s=Di();return r.ee({range:n,X:!0},((l,u,h)=>{const f=Xu(l[1]),x=new tn(f);s=s.add(x)})).next((()=>s))}containsKey(e,t){const n=Oo(t.path),r=IDBKeyRange.bound([n],[p3(n)],!1,!0);let s=0;return Fh(e).ee({index:E2,X:!0,range:r},(([l,u],h,f)=>{l!==0&&(s++,f.done())})).next((()=>s>0))}At(e,t){return Of(e).get(t).next((n=>n?Pg(n):null))}}function Of(i){return ja(i,fp)}function iE(i){return ja(i,Ud)}function Fh(i){return ja(i,pp)}const rE="LruGarbageCollector",L7=1048576;function sE([i,e],[t,n]){const r=ci(i,t);return r===0?ci(e,n):r}class D7{constructor(e){this.Ir=e,this.buffer=new Fr(sE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();sE(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class CR{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){zt(rE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hd(t)?zt(rE,"Ignoring IndexedDB error during garbage collection: ",t):await lf(t)}await this.Vr(3e5)}))}}class N7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return lt.resolve(iu.ce);const n=new D7(t);return this.mr.forEachTarget(e,(r=>n.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>n.Ar(r))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(zt("LruGarbageCollector","Garbage collection skipped; disabled"),lt.resolve(nE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(zt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nE):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,s,l,u,h,f;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(zt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,l=Date.now(),this.nthSequenceNumber(e,r)))).next((g=>(n=g,u=Date.now(),this.removeTargets(e,n,t)))).next((g=>(s=g,h=Date.now(),this.removeOrphanedDocuments(e,n)))).next((g=>(f=Date.now(),zf()<=Ki.DEBUG&&zt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-x}ms
	Determined least recently used ${r} in `+(u-l)+`ms
	Removed ${s} targets in `+(h-u)+`ms
	Removed ${g} documents in `+(f-h)+`ms
Total Duration: ${f-x}ms`),lt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g}))))}}function RR(i,e){return new N7(i,e)}class P7{constructor(e,t){this.db=e,this.garbageCollector=RR(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((r=>n+r))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((n,r)=>t(r)))}addReference(e,t,n){return By(e,n)}removeReference(e,t,n){return By(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return By(e,t)}br(e,t){return(function(r,s){let l=!1;return kR(r).te((u=>IR(r,u,s).next((h=>(h&&(l=!0),lt.resolve(!h)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Sr(e,((l,u)=>{if(u<=t){const h=this.br(e,l).next((f=>{if(!f)return s++,n.getEntry(e,l).next((()=>(n.removeEntry(l,Hn.min()),Fh(e).delete((function(g){return[0,Oo(g.path)]})(l)))))}));r.push(h)}})).next((()=>lt.waitFor(r))).next((()=>n.apply(e))).next((()=>s))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return By(e,t)}Sr(e,t){const n=Fh(e);let r,s=iu.ce;return n.ee({index:E2},(([l,u],{path:h,sequenceNumber:f})=>{l===0?(s!==iu.ce&&t(new tn(Xu(r)),s),s=f,r=h):s=iu.ce})).next((()=>{s!==iu.ce&&t(new tn(Xu(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function By(i,e){return Fh(i).put((function(n,r){return{targetId:0,path:Oo(n.path),sequenceNumber:r}})(e,i.currentSequenceNumber))}class LR{constructor(){this.changes=new ih((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?lt.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class O7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Td(e).put(n)}removeEntry(e,t,n){return Td(e).delete((function(s,l){const u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],i1(l),u[u.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Dr(e,n))))}getEntry(e,t){let n=Xs.newInvalidDocument(t);return Td(e).ee({index:m0,range:IDBKeyRange.only(yg(t))},((r,s)=>{n=this.Cr(t,s)})).next((()=>n))}vr(e,t){let n={size:0,document:Xs.newInvalidDocument(t)};return Td(e).ee({index:m0,range:IDBKeyRange.only(yg(t))},((r,s)=>{n={document:this.Cr(t,s),size:s1(s)}})).next((()=>n))}getEntries(e,t){let n=Ml();return this.Fr(e,t,((r,s)=>{const l=this.Cr(r,s);n=n.insert(r,l)})).next((()=>n))}Mr(e,t){let n=Ml(),r=new ha(tn.comparator);return this.Fr(e,t,((s,l)=>{const u=this.Cr(s,l);n=n.insert(s,u),r=r.insert(s,s1(l))})).next((()=>({documents:n,Or:r})))}Fr(e,t,n){if(t.isEmpty())return lt.resolve();let r=new Fr(lE);t.forEach((h=>r=r.add(h)));const s=IDBKeyRange.bound(yg(r.first()),yg(r.last())),l=r.getIterator();let u=l.getNext();return Td(e).ee({index:m0,range:s},((h,f,x)=>{const g=tn.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;u&&lE(u,g)<0;)n(u,null),u=l.getNext();u&&u.isEqual(g)&&(n(u,f),u=l.hasNext()?l.getNext():null),u?x.j(yg(u)):x.done()})).next((()=>{for(;u;)n(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,s){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),i1(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],h=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Td(e).J(IDBKeyRange.bound(u,h,!0)).next((f=>{s?.incrementDocumentReadCount(f.length);let x=Ml();for(const g of f){const w=this.Cr(tn.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);w.isFoundDocument()&&($m(t,w)||r.has(w.key))&&(x=x.insert(w.key,w))}return x}))}getAllFromCollectionGroup(e,t,n,r){let s=Ml();const l=oE(t,n),u=oE(t,zl.max());return Td(e).ee({index:x3,range:IDBKeyRange.bound(l,u,!0)},((h,f,x)=>{const g=this.Cr(tn.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(g.key,g),s.size===r&&x.done()})).next((()=>s))}newChangeBuffer(e){return new M7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return aE(e).get(Jb).next((t=>(jn(!!t,20021),t)))}Dr(e,t){return aE(e).put(Jb,t)}Cr(e,t){if(t){const n=b7(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Hn.min())))return n}return Xs.newInvalidDocument(e)}}function DR(i){return new O7(i)}class M7 extends LR{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ih((n=>n.toString()),((n,r)=>n.isEqual(r)))}applyChanges(e){const t=[];let n=0,r=new Fr(((s,l)=>ci(s.canonicalString(),l.canonicalString())));return this.changes.forEach(((s,l)=>{const u=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,u.readTime)),l.isValidDocument()){const h=$A(this.Nr.serializer,l);r=r.add(s.path.popLast());const f=s1(h);n+=f-u.size,t.push(this.Nr.addEntry(e,s,h))}else if(n-=u.size,this.trackRemovals){const h=$A(this.Nr.serializer,l.convertToNoDocument(Hn.min()));t.push(this.Nr.addEntry(e,s,h))}})),r.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,n)),lt.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:n,Or:r})=>(r.forEach(((s,l)=>{this.Br.set(s,{size:l,readTime:n.get(s).readTime})})),n)))}}function aE(i){return ja(i,hm)}function Td(i){return ja(i,Y0)}function yg(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function oE(i,e){const t=e.documentKey.path.toArray();return[i,i1(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function lE(i,e){const t=i.path.toArray(),n=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(r=ci(t[s],n[s]),r)return r;return r=ci(t.length,n.length),r||(r=ci(t[t.length-2],n[n.length-2]),r||ci(t[t.length-1],n[n.length-1]))}class F7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class NR{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(n!==null&&Kg(n.mutation,r,ru.empty(),Mr.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Di()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Di()){const r=Ju();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((s=>{let l=Dg();return s.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const n=Ju();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Di())))}populateOverlays(e,t,n){const r=[];return n.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,n,r){let s=Ml();const l=Hg(),u=(function(){return Hg()})();return t.forEach(((h,f)=>{const x=n.get(f.key);r.has(f.key)&&(x===void 0||x.mutation instanceof dd)?s=s.insert(f.key,f):x!==void 0?(l.set(f.key,x.mutation.getFieldMask()),Kg(x.mutation,f,x.mutation.getFieldMask(),Mr.now())):l.set(f.key,ru.empty())})),this.recalculateAndSaveOverlays(e,s).next((h=>(h.forEach(((f,x)=>l.set(f,x))),t.forEach(((f,x)=>u.set(f,new F7(x,l.get(f)??null)))),u)))}recalculateAndSaveOverlays(e,t){const n=Hg();let r=new ha(((l,u)=>l-u)),s=Di();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((h=>{const f=t.get(h);if(f===null)return;let x=n.get(h)||ru.empty();x=u.applyToLocalView(f,x),n.set(h,x);const g=(r.get(u.batchId)||Di()).add(h);r=r.insert(u.batchId,g)}))})).next((()=>{const l=[],u=r.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),f=h.key,x=h.value,g=J3();x.forEach((w=>{if(!s.has(w)){const A=iR(t.get(w),n.get(w));A!==null&&g.set(w,A),s=s.add(w)}})),l.push(this.documentOverlayCache.saveOverlays(e,f,g))}return lt.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,r){return(function(l){return tn.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((s=>{const l=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):lt.resolve(Ju());let u=om,h=s;return l.next((f=>lt.forEach(f,((x,g)=>(u<g.largestBatchId&&(u=g.largestBatchId),s.get(x)?lt.resolve():this.remoteDocumentCache.getEntry(e,x).next((w=>{h=h.insert(x,w)}))))).next((()=>this.populateOverlays(e,f,s))).next((()=>this.computeViews(e,h,f,Di()))).next((x=>({batchId:u,changes:X3(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new tn(t)).next((n=>{let r=Dg();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let l=Dg();return this.indexManager.getCollectionParents(e,s).next((u=>lt.forEach(u,(h=>{const f=(function(g,w){return new J1(w,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,n,r).next((x=>{x.forEach(((g,w)=>{l=l.insert(g,w)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r)))).next((l=>{s.forEach(((h,f)=>{const x=f.getKey();l.get(x)===null&&(l=l.insert(x,Xs.newInvalidDocument(x)))}));let u=Dg();return l.forEach(((h,f)=>{const x=s.get(h);x!==void 0&&Kg(x.mutation,f,ru.empty(),Mr.now()),$m(t,f)&&(u=u.insert(h,f))})),u}))}}class j7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return lt.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Qo(r.createTime)}})(t)),lt.resolve()}getNamedQuery(e,t){return lt.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:wR(r.bundledQuery),readTime:Qo(r.readTime)}})(t)),lt.resolve()}}class V7{constructor(){this.overlays=new ha(tn.comparator),this.qr=new Map}getOverlay(e,t){return lt.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ju();return lt.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&n.set(r,s)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((r,s)=>{this.St(e,t,s)})),lt.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(n)),lt.resolve()}getOverlaysForCollection(e,t,n){const r=Ju(),s=t.length+1,l=new tn(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>n&&r.set(h.getKey(),h)}return lt.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new ha(((f,x)=>f-x));const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>n){let x=s.get(f.largestBatchId);x===null&&(x=Ju(),s=s.insert(f.largestBatchId,x)),x.set(f.getKey(),f)}}const u=Ju(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((f,x)=>u.set(f,x))),!(u.size()>=r)););return lt.resolve(u)}St(e,t,n){const r=this.overlays.get(n.key);if(r!==null){const l=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new V2(t,n));let s=this.qr.get(t);s===void 0&&(s=Di(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class z7{constructor(){this.sessionToken=Ta.EMPTY_BYTE_STRING}getSessionToken(e){return lt.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,lt.resolve()}}class G2{constructor(){this.Qr=new Fr(Ja.$r),this.Ur=new Fr(Ja.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Ja(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new Ja(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new tn(new $r([])),n=new Ja(t,e),r=new Ja(t,e+1),s=[];return this.Ur.forEachInRange([n,r],(l=>{this.Gr(l),s.push(l.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new tn(new $r([])),n=new Ja(t,e),r=new Ja(t,e+1);let s=Di();return this.Ur.forEachInRange([n,r],(l=>{s=s.add(l.key)})),s}containsKey(e){const t=new Ja(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Ja{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return tn.comparator(e.key,t.key)||ci(e.Yr,t.Yr)}static Kr(e,t){return ci(e.Yr,t.Yr)||tn.comparator(e.key,t.key)}}class U7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Fr(Ja.$r)}checkEmpty(e){return lt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new F2(s,t,n,r);this.mutationQueue.push(l);for(const u of r)this.Zr=this.Zr.add(new Ja(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return lt.resolve(l)}lookupMutationBatch(e,t){return lt.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),s=r<0?0:r;return lt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return lt.resolve(this.mutationQueue.length===0?zd:this.tr-1)}getAllMutationBatches(e){return lt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ja(t,0),r=new Ja(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,r],(l=>{const u=this.Xr(l.Yr);s.push(u)})),lt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Fr(ci);return t.forEach((r=>{const s=new Ja(r,0),l=new Ja(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,l],(u=>{n=n.add(u.Yr)}))})),lt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;tn.isDocumentKey(s)||(s=s.child(""));const l=new Ja(new tn(s),0);let u=new Fr(ci);return this.Zr.forEachWhile((h=>{const f=h.key.path;return!!n.isPrefixOf(f)&&(f.length===r&&(u=u.add(h.Yr)),!0)}),l),lt.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((n=>{const r=this.Xr(n);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){jn(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return lt.forEach(t.mutations,(r=>{const s=new Ja(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new Ja(t,0),r=this.Zr.firstAfterOrEqual(n);return lt.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,lt.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class B7{constructor(e){this.ri=e,this.docs=(function(){return new ha(tn.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,l=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return lt.resolve(n?n.document.mutableCopy():Xs.newInvalidDocument(t))}getEntries(e,t){let n=Ml();return t.forEach((r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():Xs.newInvalidDocument(r))})),lt.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Ml();const l=t.path,u=new tn(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:f,value:{document:x}}=h.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||T2(m3(x),n)<=0||(r.has(x.key)||$m(t,x))&&(s=s.insert(x.key,x.mutableCopy()))}return lt.resolve(s)}getAllFromCollectionGroup(e,t,n,r){_n(9500)}ii(e,t){return lt.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new $7(this)}getSize(e){return lt.resolve(this.size)}}class $7 extends LR{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)})),lt.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class G7{constructor(e){this.persistence=e,this.si=new ih((t=>Xd(t)),Bm),this.lastRemoteSnapshotVersion=Hn.min(),this.highestTargetId=0,this.oi=0,this._i=new G2,this.targetCount=0,this.ai=Zd.ur()}forEachTarget(e,t){return this.si.forEach(((n,r)=>t(r))),lt.resolve()}getLastRemoteSnapshotVersion(e){return lt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return lt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),lt.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),lt.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Zd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,lt.resolve()}updateTargetData(e,t){return this.Pr(t),lt.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,lt.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.si.delete(l),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),r++)})),lt.waitFor(s).next((()=>r))}getTargetCount(e){return lt.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return lt.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),lt.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((l=>{s.push(r.markPotentiallyOrphaned(e,l))})),lt.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),lt.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return lt.resolve(n)}containsKey(e,t){return lt.resolve(this._i.containsKey(t))}}class H2{constructor(e,t){this.ui={},this.overlays={},this.ci=new iu(0),this.li=!1,this.li=!0,this.hi=new z7,this.referenceDelegate=e(this),this.Pi=new G7(this),this.indexManager=new k7,this.remoteDocumentCache=(function(r){return new B7(r)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new bR(t),this.Ii=new j7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new V7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new U7(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){zt("MemoryPersistence","Starting transaction:",e);const r=new H7(this.ci.next());return this.referenceDelegate.Ei(),n(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ai(e,t){return lt.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class H7 extends v3{constructor(e){super(),this.currentSequenceNumber=e}}class sv{constructor(e){this.persistence=e,this.Ri=new G2,this.Vi=null}static mi(e){return new sv(e)}get fi(){if(this.Vi)return this.Vi;throw _n(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),lt.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),lt.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),lt.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.fi.add(s.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return lt.forEach(this.fi,(n=>{const r=tn.fromPath(n);return this.gi(e,r).next((s=>{s||t.removeEntry(r,Hn.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return lt.or([()=>lt.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class a1{constructor(e,t){this.persistence=e,this.pi=new ih((n=>Oo(n.path)),((n,r)=>n.isEqual(r))),this.garbageCollector=RR(this,t)}static mi(e,t){return new a1(e,t)}Ei(){}di(e){return lt.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((r=>n+r))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return lt.forEach(this.pi,((n,r)=>this.br(e,n,r).next((s=>s?lt.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,(l=>this.br(e,l,t).next((u=>{u||(n++,s.removeEntry(l,Hn.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),lt.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),lt.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),lt.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),lt.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=v0(e.data.value)),t}br(e,t,n){return lt.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return lt.resolve(r!==void 0&&r>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class K7{constructor(e){this.serializer=e}k(e,t,n,r){const s=new G1("createOrUpgrade",t);n<1&&r>=1&&((function(h){h.createObjectStore(Um)})(e),(function(h){h.createObjectStore(cm,{keyPath:tj}),h.createObjectStore(Iu,{keyPath:_A,autoIncrement:!0}).createIndex(jd,bA,{unique:!0}),h.createObjectStore(dp)})(e),uE(e),(function(h){h.createObjectStore(Id)})(e));let l=lt.resolve();return n<3&&r>=3&&(n!==0&&((function(h){h.deleteObjectStore(pp),h.deleteObjectStore(fp),h.deleteObjectStore(Ud)})(e),uE(e)),l=l.next((()=>(function(h){const f=h.store(Ud),x={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Hn.min().toTimestamp(),targetCount:0};return f.put(X0,x)})(s)))),n<4&&r>=4&&(n!==0&&(l=l.next((()=>(function(h,f){return f.store(Iu).J().next((g=>{h.deleteObjectStore(Iu),h.createObjectStore(Iu,{keyPath:_A,autoIncrement:!0}).createIndex(jd,bA,{unique:!0});const w=f.store(Iu),A=g.map((B=>w.put(B)));return lt.waitFor(A)}))})(e,s)))),l=l.next((()=>{(function(h){h.createObjectStore(gp,{keyPath:cj})})(e)}))),n<5&&r>=5&&(l=l.next((()=>this.yi(s)))),n<6&&r>=6&&(l=l.next((()=>((function(h){h.createObjectStore(hm)})(e),this.wi(s))))),n<7&&r>=7&&(l=l.next((()=>this.Si(s)))),n<8&&r>=8&&(l=l.next((()=>this.bi(e,s)))),n<9&&r>=9&&(l=l.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&r>=10&&(l=l.next((()=>this.Di(s)))),n<11&&r>=11&&(l=l.next((()=>{(function(h){h.createObjectStore(K1,{keyPath:hj})})(e),(function(h){h.createObjectStore(W1,{keyPath:dj})})(e)}))),n<12&&r>=12&&(l=l.next((()=>{(function(h){const f=h.createObjectStore(q1,{keyPath:_j});f.createIndex(Zb,bj,{unique:!1}),f.createIndex(A3,xj,{unique:!1})})(e)}))),n<13&&r>=13&&(l=l.next((()=>(function(h){const f=h.createObjectStore(Y0,{keyPath:ij});f.createIndex(m0,rj),f.createIndex(x3,sj)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(Id)))),n<14&&r>=14&&(l=l.next((()=>this.Fi(e,s)))),n<15&&r>=15&&(l=l.next((()=>(function(h){h.createObjectStore(I2,{keyPath:fj,autoIncrement:!0}).createIndex(Qb,pj,{unique:!1}),h.createObjectStore(Ug,{keyPath:gj}).createIndex(S3,mj,{unique:!1}),h.createObjectStore(Bg,{keyPath:yj}).createIndex(T3,vj,{unique:!1})})(e)))),n<16&&r>=16&&(l=l.next((()=>{t.objectStore(Ug).clear()})).next((()=>{t.objectStore(Bg).clear()}))),n<17&&r>=17&&(l=l.next((()=>{(function(h){h.createObjectStore(k2,{keyPath:wj})})(e)}))),n<18&&r>=18&&_C()&&(l=l.next((()=>{t.objectStore(Ug).clear()})).next((()=>{t.objectStore(Bg).clear()}))),l}wi(e){let t=0;return e.store(Id).ee(((n,r)=>{t+=s1(r)})).next((()=>{const n={byteSize:t};return e.store(hm).put(Jb,n)}))}yi(e){const t=e.store(cm),n=e.store(Iu);return t.J().next((r=>lt.forEach(r,(s=>{const l=IDBKeyRange.bound([s.userId,zd],[s.userId,s.lastAcknowledgedBatchId]);return n.J(jd,l).next((u=>lt.forEach(u,(h=>{jn(h.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const f=Dd(this.serializer,h);return ER(e,s.userId,f).next((()=>{}))}))))}))))}Si(e){const t=e.store(pp),n=e.store(Id);return e.store(Ud).get(X0).next((r=>{const s=[];return n.ee(((l,u)=>{const h=new $r(l),f=(function(g){return[0,Oo(g)]})(h);s.push(t.get(f).next((x=>x?lt.resolve():(g=>t.put({targetId:0,path:Oo(g),sequenceNumber:r.highestListenSequenceNumber}))(h))))})).next((()=>lt.waitFor(s)))}))}bi(e,t){e.createObjectStore(dm,{keyPath:uj});const n=t.store(dm),r=new $2,s=l=>{if(r.add(l)){const u=l.lastSegment(),h=l.popLast();return n.put({collectionId:u,parent:Oo(h)})}};return t.store(Id).ee({X:!0},((l,u)=>{const h=new $r(l);return s(h.popLast())})).next((()=>t.store(dp).ee({X:!0},(([l,u,h],f)=>{const x=Xu(u);return s(x.popLast())}))))}Di(e){const t=e.store(fp);return t.ee(((n,r)=>{const s=Pg(r),l=xR(this.serializer,s);return t.put(l)}))}Ci(e,t){const n=t.store(Id),r=[];return n.ee(((s,l)=>{const u=t.store(Y0),h=(function(g){return g.document?new tn($r.fromString(g.document.name).popFirst(5)):g.noDocument?tn.fromSegments(g.noDocument.path):g.unknownDocument?tn.fromSegments(g.unknownDocument.path):_n(36783)})(l).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};r.push(u.put(f))})).next((()=>lt.waitFor(r)))}Fi(e,t){const n=t.store(Iu),r=DR(this.serializer),s=new H2(sv.mi,this.serializer.yt);return n.J().next((l=>{const u=new Map;return l.forEach((h=>{let f=u.get(h.userId)??Di();Dd(this.serializer,h).keys().forEach((x=>f=f.add(x))),u.set(h.userId,f)})),lt.forEach(u,((h,f)=>{const x=new vo(f),g=iv.wt(this.serializer,x),w=s.getIndexManager(x),A=rv.wt(x,this.serializer,w,s.referenceDelegate);return new NR(r,A,g,w).recalculateAndSaveOverlaysForDocumentKeys(new ex(t,iu.ce),h).next()}))}))}}function uE(i){i.createObjectStore(pp,{keyPath:oj}).createIndex(E2,lj,{unique:!0}),i.createObjectStore(fp,{keyPath:"targetId"}).createIndex(w3,aj,{unique:!0}),i.createObjectStore(Ud)}const Ch="IndexedDbPersistence",W_=18e5,q_=5e3,Y_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",W7="main";class K2{constructor(e,t,n,r,s,l,u,h,f,x,g=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=s,this.window=l,this.document=u,this.xi=f,this.Oi=x,this.Ni=g,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=w=>Promise.resolve(),!K2.v())throw new un(Ot.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new P7(this,r),this.$i=t+W7,this.serializer=new bR(h),this.Ui=new Kh(this.$i,this.Ni,new K7(this.serializer)),this.hi=new w7,this.Pi=new R7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=DR(this.serializer),this.Ii=new x7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,x===!1&&Xo(Ch,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new un(Ot.FAILED_PRECONDITION,Y_);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new iu(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>$y(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(hd(e))return zt(Ch,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return zt(Ch,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return vg(e).get(Rf).next((t=>lt.resolve(this.es(t))))}ts(e){return $y(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,W_)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=ja(t,gp);return n.J().next((r=>{const s=this.ss(r,W_),l=r.filter((u=>s.indexOf(u)===-1));return lt.forEach(l,(u=>n.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?lt.resolve(!0):vg(e).get(Rf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,q_)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new un(Ot.FAILED_PRECONDITION,Y_);return!1}}return!(!this.networkEnabled||!this.inForeground)||$y(e).J().next((n=>this.ss(n,q_).find((r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,l=!this.inForeground&&r.inForeground,u=this.networkEnabled===r.networkEnabled;if(s||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&zt(Ch,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Um,gp],(e=>{const t=new ex(e,iu.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>$y(e).J().next((t=>this.ss(t,W_).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return rv.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new C7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return iv.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){zt(Ch,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=(function(h){return h===18?Aj:h===17?C3:h===16?Tj:h===15?C2:h===14?k3:h===13?I3:h===12?Sj:h===11?E3:void _n(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,r,s,(u=>(l=new ex(u,this.ci?this.ci.next():iu.ce),t==="readwrite-primary"?this.Hi(l).next((h=>!!h||this.Yi(l))).next((h=>{if(!h)throw Xo(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new un(Ot.FAILED_PRECONDITION,y3);return n(l)})).next((h=>this.Xi(l).next((()=>h)))):this.Is(l).next((()=>n(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return vg(e).get(Rf).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,q_)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new un(Ot.FAILED_PRECONDITION,Y_)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vg(e).put(Rf,t)}static v(){return Kh.v()}Zi(e){const t=vg(e);return t.get(Rf).next((n=>this.es(n)?(zt(Ch,"Releasing primary lease."),t.delete(Rf)):lt.resolve()))}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Xo(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;vC()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return zt(Ch,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Xo(Ch,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Xo("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vg(i){return ja(i,Um)}function $y(i){return ja(i,gp)}function q7(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}class W2{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Di(),r=Di();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new W2(e,t.fromCache,n,r)}}class Y7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class PR{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return vC()?8:_3(Fa())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ys(e,t).next((l=>{s.result=l})).next((()=>{if(!s.result)return this.ws(e,t,r,n).next((l=>{s.result=l}))})).next((()=>{if(s.result)return;const l=new Y7;return this.Ss(e,t,l).next((u=>{if(s.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>s.result))}bs(e,t,n,r){return n.documentReadCount<this.fs?(zf()<=Ki.DEBUG&&zt("QueryEngine","SDK will not create cache indexes for query:",Uf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),lt.resolve()):(zf()<=Ki.DEBUG&&zt("QueryEngine","Query:",Uf(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(zf()<=Ki.DEBUG&&zt("QueryEngine","The SDK decides to create cache indexes for query:",Uf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ou(t))):lt.resolve())}ys(e,t){if(NA(t))return lt.resolve(null);let n=ou(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=ox(t,null,"F"),n=ou(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const l=Di(...s);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((h=>{const f=this.Ds(t,u);return this.Cs(t,f,l,h.readTime)?this.ys(e,ox(t,null,"F")):this.vs(e,f,t,h)}))))})))))}ws(e,t,n,r){return NA(t)||r.isEqual(Hn.min())?lt.resolve(null):this.ps.getDocuments(e,n).next((s=>{const l=this.Ds(t,s);return this.Cs(t,l,n,r)?lt.resolve(null):(zf()<=Ki.DEBUG&&zt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Uf(t)),this.vs(e,l,t,qF(r,om)).next((u=>u)))}))}Ds(e,t){let n=new Fr(q3(e));return t.forEach(((r,s)=>{$m(e,s)&&(n=n.add(s))})),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,n){return zf()<=Ki.DEBUG&&zt("QueryEngine","Using full collection scan to execute query:",Uf(t)),this.ps.getDocumentsMatchingQuery(e,t,zl.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next((s=>(t.forEach((l=>{s=s.insert(l.key,l)})),s)))}}const q2="LocalStore",X7=3e8;class J7{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ha(ci),this.xs=new ih((s=>Xd(s)),Bm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new NR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function OR(i,e,t,n){return new J7(i,e,t,n)}async function MR(i,e){const t=hi(i);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next((s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((s=>{const l=[],u=[];let h=Di();for(const f of r){l.push(f.batchId);for(const x of f.mutations)h=h.add(x.key)}for(const f of s){u.push(f.batchId);for(const x of f.mutations)h=h.add(x.key)}return t.localDocuments.getDocuments(n,h).next((f=>({Ls:f,removedBatchIds:l,addedBatchIds:u})))}))}))}function Q7(i,e){const t=hi(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,f,x){const g=f.batch,w=g.keys();let A=lt.resolve();return w.forEach((B=>{A=A.next((()=>x.getEntry(h,B))).next(($=>{const W=f.docVersions.get(B);jn(W!==null,48541),$.version.compareTo(W)<0&&(g.applyToRemoteDocument($,f),$.isValidDocument()&&($.setReadTime(f.commitVersion),x.addEntry($)))}))})),A.next((()=>u.mutationQueue.removeMutationBatch(h,g)))})(t,n,e,s).next((()=>s.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=Di();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(n,r)))}))}function FR(i){const e=hi(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Z7(i,e){const t=hi(i),n=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const u=[];e.targetChanges.forEach(((x,g)=>{const w=r.get(g);if(!w)return;u.push(t.Pi.removeMatchingKeys(s,x.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(s,x.addedDocuments,g))));let A=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?A=A.withResumeToken(Ta.EMPTY_BYTE_STRING,Hn.min()).withLastLimboFreeSnapshotVersion(Hn.min()):x.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(x.resumeToken,n)),r=r.insert(g,A),(function($,W,q){return $.resumeToken.approximateByteSize()===0||W.snapshotVersion.toMicroseconds()-$.snapshotVersion.toMicroseconds()>=X7?!0:q.addedDocuments.size+q.modifiedDocuments.size+q.removedDocuments.size>0})(w,A,x)&&u.push(t.Pi.updateTargetData(s,A))}));let h=Ml(),f=Di();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,x))})),u.push(eV(s,l,e.documentUpdates).next((x=>{h=x.ks,f=x.qs}))),!n.isEqual(Hn.min())){const x=t.Pi.getLastRemoteSnapshotVersion(s).next((g=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n)));u.push(x)}return lt.waitFor(u).next((()=>l.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,h,f))).next((()=>h))})).then((s=>(t.Ms=r,s)))}function eV(i,e,t){let n=Di(),r=Di();return t.forEach((s=>n=n.add(s))),e.getEntries(i,n).next((s=>{let l=Ml();return t.forEach(((u,h)=>{const f=s.get(u);h.isFoundDocument()!==f.isFoundDocument()&&(r=r.add(u)),h.isNoDocument()&&h.version.isEqual(Hn.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):zt(q2,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",h.version)})),{ks:l,qs:r}}))}function tV(i,e){const t=hi(i);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=zd),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function nV(i,e){const t=hi(i);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let r;return t.Pi.getTargetData(n,e).next((s=>s?(r=s,lt.resolve(r)):t.Pi.allocateTargetId(n).next((l=>(r=new Uc(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,r).next((()=>r)))))))})).then((n=>{const r=t.Ms.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function gx(i,e,t){const n=hi(i),r=n.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,(l=>n.persistence.referenceDelegate.removeTarget(l,r)))}catch(l){if(!hd(l))throw l;zt(q2,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(r.target)}function cE(i,e,t){const n=hi(i);let r=Hn.min(),s=Di();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,f,x){const g=hi(h),w=g.xs.get(x);return w!==void 0?lt.resolve(g.Ms.get(w)):g.Pi.getTargetData(f,x)})(n,l,ou(e)).next((u=>{if(u)return r=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{s=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,t?r:Hn.min(),t?s:Di()))).next((u=>(iV(n,Uj(e),u),{documents:u,Qs:s})))))}function iV(i,e,t){let n=i.Os.get(e)||Hn.min();t.forEach(((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)})),i.Os.set(e,n)}class hE{constructor(){this.activeTargetIds=Wj()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jR{constructor(){this.Mo=new hE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new hE,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class rV{Oo(e){}shutdown(){}}const dE="ConnectivityMonitor";class fE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){zt(dE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){zt(dE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Gy=null;function mx(){return Gy===null?Gy=(function(){return 268435456+Math.round(2147483648*Math.random())})():Gy++,"0x"+Gy.toString(16)}const X_="RestConnection",sV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===J0?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,s){const l=mx(),u=this.zo(e,t.toUriEncodedString());zt(X_,`Sending RPC '${e}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,r,s);const{host:f}=new URL(u),x=ac(f);return this.Jo(e,u,h,n,x).then((g=>(zt(X_,`Received RPC '${e}' ${l}: `,g),g)),(g=>{throw qd(X_,`RPC '${e}' ${l} failed with error: `,g,"url: ",u,"request:",n),g}))}Ho(e,t,n,r,s,l){return this.Go(e,t,n,r,s)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mp})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),n&&n.headers.forEach(((r,s)=>e[s]=r))}zo(e,t){const n=sV[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class oV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ko="WebChannelConnection";class lV extends aV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,s){const l=mx();return new Promise(((u,h)=>{const f=new o3;f.setWithCredentials(!0),f.listenOnce(l3.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case f0.NO_ERROR:const g=f.getResponseJson();zt(ko,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(g)),u(g);break;case f0.TIMEOUT:zt(ko,`RPC '${e}' ${l} timed out`),h(new un(Ot.DEADLINE_EXCEEDED,"Request time out"));break;case f0.HTTP_ERROR:const w=f.getStatus();if(zt(ko,`RPC '${e}' ${l} failed with status:`,w,"response text:",f.getResponseText()),w>0){let A=f.getResponseJson();Array.isArray(A)&&(A=A[0]);const B=A?.error;if(B&&B.status&&B.message){const $=(function(q){const ge=q.toLowerCase().replace(/_/g,"-");return Object.values(Ot).indexOf(ge)>=0?ge:Ot.UNKNOWN})(B.status);h(new un($,B.message))}else h(new un(Ot.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new un(Ot.UNAVAILABLE,"Connection failed."));break;default:_n(9055,{l_:e,streamId:l,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{zt(ko,`RPC '${e}' ${l} completed.`)}}));const x=JSON.stringify(r);zt(ko,`RPC '${e}' ${l} sending request:`,r),f.send(t,"POST",x,n,15)}))}T_(e,t,n){const r=mx(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=h3(),u=c3(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,n),h.encodeInitMessageHeaders=!0;const x=s.join("");zt(ko,`Creating RPC '${e}' stream ${r}: ${x}`,h);const g=l.createWebChannel(x,h);this.I_(g);let w=!1,A=!1;const B=new oV({Yo:W=>{A?zt(ko,`Not sending because RPC '${e}' stream ${r} is closed:`,W):(w||(zt(ko,`Opening RPC '${e}' stream ${r} transport.`),g.open(),w=!0),zt(ko,`RPC '${e}' stream ${r} sending:`,W),g.send(W))},Zo:()=>g.close()}),$=(W,q,ge)=>{W.listen(q,(he=>{try{ge(he)}catch(me){setTimeout((()=>{throw me}),0)}}))};return $(g,Lg.EventType.OPEN,(()=>{A||(zt(ko,`RPC '${e}' stream ${r} transport opened.`),B.o_())})),$(g,Lg.EventType.CLOSE,(()=>{A||(A=!0,zt(ko,`RPC '${e}' stream ${r} transport closed`),B.a_(),this.E_(g))})),$(g,Lg.EventType.ERROR,(W=>{A||(A=!0,qd(ko,`RPC '${e}' stream ${r} transport errored. Name:`,W.name,"Message:",W.message),B.a_(new un(Ot.UNAVAILABLE,"The operation could not be completed")))})),$(g,Lg.EventType.MESSAGE,(W=>{if(!A){const q=W.data[0];jn(!!q,16349);const ge=q,he=ge?.error||ge[0]?.error;if(he){zt(ko,`RPC '${e}' stream ${r} received error:`,he);const me=he.status;let Ce=(function(ee){const J=wa[ee];if(J!==void 0)return aR(J)})(me),Ve=he.message;Ce===void 0&&(Ce=Ot.INTERNAL,Ve="Unknown error status: "+me+" with message "+he.message),A=!0,B.a_(new un(Ce,Ve)),g.close()}else zt(ko,`RPC '${e}' stream ${r} received:`,q),B.u_(q)}})),$(u,u3.STAT_EVENT,(W=>{W.stat===qb.PROXY?zt(ko,`RPC '${e}' stream ${r} detected buffering proxy`):W.stat===qb.NOPROXY&&zt(ko,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{B.__()}),0),B}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function uV(){return typeof window<"u"?window:null}function S0(){return typeof document<"u"?document:null}function av(i){return new c7(i,!0)}class VR{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&zt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const pE="PersistentStream";class zR{constructor(e,t,n,r,s,l,u,h){this.Mi=e,this.S_=n,this.b_=r,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new VR(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ot.RESOURCE_EXHAUSTED?(Xo(t.toString()),Xo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ot.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,r])=>{this.D_===t&&this.G_(n,r)}),(n=>{e((()=>{const r=new un(Ot.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(r)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{n((()=>this.z_(r)))})),this.stream.onMessage((r=>{n((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return zt(pE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(zt(pE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class cV extends zR{constructor(e,t,n,r,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,l),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=f7(this.serializer,e),n=(function(s){if(!("targetChange"in s))return Hn.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?Hn.min():l.readTime?Qo(l.readTime):Hn.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=cx(this.serializer),t.addTarget=(function(s,l){let u;const h=l.target;if(u=Z0(h)?{documents:pR(s,h)}:{query:gR(s,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=uR(s,l.resumeToken);const f=lx(s,l.expectedCount);f!==null&&(u.expectedCount=f)}else if(l.snapshotVersion.compareTo(Hn.min())>0){u.readTime=wp(s,l.snapshotVersion.toTimestamp());const f=lx(s,l.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,e);const n=g7(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=cx(this.serializer),t.removeTarget=e,this.q_(t)}}class hV extends zR{constructor(e,t,n,r,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,l),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return jn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,jn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){jn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=p7(e.writeResults,e.commitTime),n=Qo(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=cx(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>n1(this.serializer,n)))};this.q_(t)}}class dV{}class fV extends dV{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new un(Ot.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,l])=>this.connection.Go(e,ux(t,n),r,s,l))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Ot.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new un(Ot.UNKNOWN,s.toString())}))}Ho(e,t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,ux(t,n),r,l,u,s))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Ot.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new un(Ot.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class pV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xo(t),this.aa=!1):zt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ef="RemoteStore";class gV{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{cf(this)&&(zt(ef,"Restarting streams for network reachability change."),await(async function(h){const f=hi(h);f.Ea.add(4),await Hm(f),f.Ra.set("Unknown"),f.Ea.delete(4),await ov(f)})(this))}))})),this.Ra=new pV(n,r)}}async function ov(i){if(cf(i))for(const e of i.da)await e(!0)}async function Hm(i){for(const e of i.da)await e(!1)}function UR(i,e){const t=hi(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Q2(t)?J2(t):jp(t).O_()&&X2(t,e))}function Y2(i,e){const t=hi(i),n=jp(t);t.Ia.delete(e),n.O_()&&BR(t,e),t.Ia.size===0&&(n.O_()?n.L_():cf(t)&&t.Ra.set("Unknown"))}function X2(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Hn.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jp(i).Y_(e)}function BR(i,e){i.Va.Ue(e),jp(i).Z_(e)}function J2(i){i.Va=new a7({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),jp(i).start(),i.Ra.ua()}function Q2(i){return cf(i)&&!jp(i).x_()&&i.Ia.size>0}function cf(i){return hi(i).Ea.size===0}function $R(i){i.Va=void 0}async function mV(i){i.Ra.set("Online")}async function yV(i){i.Ia.forEach(((e,t)=>{X2(i,e)}))}async function vV(i,e){$R(i),Q2(i)?(i.Ra.ha(e),J2(i)):i.Ra.set("Unknown")}async function _V(i,e,t){if(i.Ra.set("Online"),e instanceof lR&&e.state===2&&e.cause)try{await(async function(r,s){const l=s.cause;for(const u of s.targetIds)r.Ia.has(u)&&(await r.remoteSyncer.rejectListen(u,l),r.Ia.delete(u),r.Va.removeTarget(u))})(i,e)}catch(n){zt(ef,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await o1(i,n)}else if(e instanceof x0?i.Va.Ze(e):e instanceof oR?i.Va.st(e):i.Va.tt(e),!t.isEqual(Hn.min()))try{const n=await FR(i.localStore);t.compareTo(n)>=0&&await(function(s,l){const u=s.Va.Tt(l);return u.targetChanges.forEach(((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const x=s.Ia.get(f);x&&s.Ia.set(f,x.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,f)=>{const x=s.Ia.get(h);if(!x)return;s.Ia.set(h,x.withResumeToken(Ta.EMPTY_BYTE_STRING,x.snapshotVersion)),BR(s,h);const g=new Uc(x.target,h,f,x.sequenceNumber);X2(s,g)})),s.remoteSyncer.applyRemoteEvent(u)})(i,t)}catch(n){zt(ef,"Failed to raise snapshot:",n),await o1(i,n)}}async function o1(i,e,t){if(!hd(e))throw e;i.Ea.add(1),await Hm(i),i.Ra.set("Offline"),t||(t=()=>FR(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{zt(ef,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await ov(i)}))}function GR(i,e){return e().catch((t=>o1(i,t,e)))}async function Km(i){const e=hi(i),t=td(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:zd;for(;bV(e);)try{const r=await tV(e.localStore,n);if(r===null){e.Ta.length===0&&t.L_();break}n=r.batchId,xV(e,r)}catch(r){await o1(e,r)}HR(e)&&KR(e)}function bV(i){return cf(i)&&i.Ta.length<10}function xV(i,e){i.Ta.push(e);const t=td(i);t.O_()&&t.X_&&t.ea(e.mutations)}function HR(i){return cf(i)&&!td(i).x_()&&i.Ta.length>0}function KR(i){td(i).start()}async function wV(i){td(i).ra()}async function SV(i){const e=td(i);for(const t of i.Ta)e.ea(t.mutations)}async function TV(i,e,t){const n=i.Ta.shift(),r=j2.from(n,e,t);await GR(i,(()=>i.remoteSyncer.applySuccessfulWrite(r))),await Km(i)}async function AV(i,e){e&&td(i).X_&&await(async function(n,r){if((function(l){return i7(l)&&l!==Ot.ABORTED})(r.code)){const s=n.Ta.shift();td(n).B_(),await GR(n,(()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r))),await Km(n)}})(i,e),HR(i)&&KR(i)}async function gE(i,e){const t=hi(i);t.asyncQueue.verifyOperationInProgress(),zt(ef,"RemoteStore received new credentials");const n=cf(t);t.Ea.add(3),await Hm(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ov(t)}async function EV(i,e){const t=hi(i);e?(t.Ea.delete(2),await ov(t)):e||(t.Ea.add(2),await Hm(t),t.Ra.set("Unknown"))}function jp(i){return i.ma||(i.ma=(function(t,n,r){const s=hi(t);return s.sa(),new cV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(i.datastore,i.asyncQueue,{Xo:mV.bind(null,i),t_:yV.bind(null,i),r_:vV.bind(null,i),H_:_V.bind(null,i)}),i.da.push((async e=>{e?(i.ma.B_(),Q2(i)?J2(i):i.Ra.set("Unknown")):(await i.ma.stop(),$R(i))}))),i.ma}function td(i){return i.fa||(i.fa=(function(t,n,r){const s=hi(t);return s.sa(),new hV(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:wV.bind(null,i),r_:AV.bind(null,i),ta:SV.bind(null,i),na:TV.bind(null,i)}),i.da.push((async e=>{e?(i.fa.B_(),await Km(i)):(await i.fa.stop(),i.Ta.length>0&&(zt(ef,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}class Z2{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new Hc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const l=Date.now()+n,u=new Z2(e,t,l,r,s);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new un(Ot.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ew(i,e){if(Xo("AsyncQueue",`${e}: ${i}`),hd(i))return new un(Ot.UNAVAILABLE,`${e}: ${i}`);throw i}class tp{static emptySet(e){return new tp(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||tn.comparator(t.key,n.key):(t,n)=>tn.comparator(t.key,n.key),this.keyedMap=Dg(),this.sortedSet=new ha(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof tp)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new tp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class mE{constructor(){this.ga=new ha(tn.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_n(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Sp{constructor(e,t,n,r,s,l,u,h,f){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,n,r,s){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new Sp(e,t,tp.emptySet(t),l,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Z1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class IV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class kV{constructor(){this.queries=yE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const r=hi(t),s=r.queries;r.queries=yE(),s.forEach(((l,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new un(Ot.ABORTED,"Firestore shutting down"))}}function yE(){return new ih((i=>W3(i)),Z1)}async function CV(i,e){const t=hi(i);let n=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(n=2):(s=new IV,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(l){const u=ew(l,`Initialization of query '${Uf(e.query)}' failed`);return void e.onError(u)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&tw(t)}async function RV(i,e){const t=hi(i),n=e.query;let r=3;const s=t.queries.get(n);if(s){const l=s.Sa.indexOf(e);l>=0&&(s.Sa.splice(l,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function LV(i,e){const t=hi(i);let n=!1;for(const r of e){const s=r.query,l=t.queries.get(s);if(l){for(const u of l.Sa)u.Fa(r)&&(n=!0);l.wa=r}}n&&tw(t)}function DV(i,e,t){const n=hi(i),r=n.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);n.queries.delete(e)}function tw(i){i.Ca.forEach((e=>{e.next()}))}var yx,vE;(vE=yx||(yx={})).Ma="default",vE.Cache="cache";class NV{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Sp(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Sp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yx.Cache}}class WR{constructor(e){this.key=e}}class qR{constructor(e){this.key=e}}class PV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Di(),this.mutatedKeys=Di(),this.eu=q3(e),this.tu=new tp(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new mE,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,l=r,u=!1;const h=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,f=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((x,g)=>{const w=r.get(x),A=$m(this.query,g)?g:null,B=!!w&&this.mutatedKeys.has(w.key),$=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let W=!1;w&&A?w.data.isEqual(A.data)?B!==$&&(n.track({type:3,doc:A}),W=!0):this.su(w,A)||(n.track({type:2,doc:A}),W=!0,(h&&this.eu(A,h)>0||f&&this.eu(A,f)<0)&&(u=!0)):!w&&A?(n.track({type:0,doc:A}),W=!0):w&&!A&&(n.track({type:1,doc:w}),W=!0,(h||f)&&(u=!0)),W&&(A?(l=l.add(A),s=$?s.add(x):s.delete(x)):(l=l.delete(x),s=s.delete(x)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const x=this.query.limitType==="F"?l.last():l.first();l=l.delete(x.key),s=s.delete(x.key),n.track({type:1,doc:x})}return{tu:l,iu:n,Cs:u,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((x,g)=>(function(A,B){const $=W=>{switch(W){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _n(20277,{Rt:W})}};return $(A)-$(B)})(x.type,g.type)||this.eu(x.doc,g.doc))),this.ou(n),r=r??!1;const u=t&&!r?this._u():[],h=this.Xa.size===0&&this.current&&!r?1:0,f=h!==this.Za;return this.Za=h,l.length!==0||f?{snapshot:new Sp(this.query,e.tu,s,l,e.mutatedKeys,h===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new mE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Di(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new qR(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new WR(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=Di();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Sp.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const nw="SyncEngine";class OV{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class MV{constructor(e){this.key=e,this.hu=!1}}class FV{constructor(e,t,n,r,s,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new ih((u=>W3(u)),Z1),this.Iu=new Map,this.Eu=new Set,this.du=new ha(tn.comparator),this.Au=new Map,this.Ru=new G2,this.Vu={},this.mu=new Map,this.fu=Zd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jV(i,e,t=!0){const n=eL(i);let r;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await YR(n,e,t,!0),r}async function VV(i,e){const t=eL(i);await YR(t,e,!0,!1)}async function YR(i,e,t,n){const r=await nV(i.localStore,ou(e)),s=r.targetId,l=i.sharedClientState.addLocalQueryTarget(s,t);let u;return n&&(u=await zV(i,e,s,l==="current",r.resumeToken)),i.isPrimaryClient&&t&&UR(i.remoteStore,r),u}async function zV(i,e,t,n,r){i.pu=(g,w,A)=>(async function($,W,q,ge){let he=W.view.ru(q);he.Cs&&(he=await cE($.localStore,W.query,!1).then((({documents:pe})=>W.view.ru(pe,he))));const me=ge&&ge.targetChanges.get(W.targetId),Ce=ge&&ge.targetMismatches.get(W.targetId)!=null,Ve=W.view.applyChanges(he,$.isPrimaryClient,me,Ce);return bE($,W.targetId,Ve.au),Ve.snapshot})(i,g,w,A);const s=await cE(i.localStore,e,!0),l=new PV(e,s.Qs),u=l.ru(s.documents),h=Gm.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",r),f=l.applyChanges(u,i.isPrimaryClient,h);bE(i,t,f.au);const x=new OV(e,t,l);return i.Tu.set(e,x),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),f.snapshot}async function UV(i,e,t){const n=hi(i),r=n.Tu.get(e),s=n.Iu.get(r.targetId);if(s.length>1)return n.Iu.set(r.targetId,s.filter((l=>!Z1(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await gx(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),t&&Y2(n.remoteStore,r.targetId),vx(n,r.targetId)})).catch(lf)):(vx(n,r.targetId),await gx(n.localStore,r.targetId,!0))}async function BV(i,e){const t=hi(i),n=t.Tu.get(e),r=t.Iu.get(n.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Y2(t.remoteStore,n.targetId))}async function $V(i,e,t){const n=tL(i);try{const r=await(function(l,u){const h=hi(l),f=Mr.now(),x=u.reduce(((A,B)=>A.add(B.key)),Di());let g,w;return h.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let B=Ml(),$=Di();return h.Ns.getEntries(A,x).next((W=>{B=W,B.forEach(((q,ge)=>{ge.isValidDocument()||($=$.add(q))}))})).next((()=>h.localDocuments.getOverlayedDocuments(A,B))).next((W=>{g=W;const q=[];for(const ge of u){const he=t7(ge,g.get(ge.key).overlayedDocument);he!=null&&q.push(new dd(ge.key,he,V3(he.value.mapValue),Fl.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,q,u)})).next((W=>{w=W;const q=W.applyToLocalDocumentSet(g,$);return h.documentOverlayCache.saveOverlays(A,W.batchId,q)}))})).then((()=>({batchId:w.batchId,changes:X3(g)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),(function(l,u,h){let f=l.Vu[l.currentUser.toKey()];f||(f=new ha(ci)),f=f.insert(u,h),l.Vu[l.currentUser.toKey()]=f})(n,r.batchId,t),await Wm(n,r.changes),await Km(n.remoteStore)}catch(r){const s=ew(r,"Failed to persist write");t.reject(s)}}async function XR(i,e){const t=hi(i);try{const n=await Z7(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const l=t.Au.get(s);l&&(jn(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?l.hu=!0:r.modifiedDocuments.size>0?jn(l.hu,14607):r.removedDocuments.size>0&&(jn(l.hu,42227),l.hu=!1))})),await Wm(t,n,e)}catch(n){await lf(n)}}function _E(i,e,t){const n=hi(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const r=[];n.Tu.forEach(((s,l)=>{const u=l.view.va(e);u.snapshot&&r.push(u.snapshot)})),(function(l,u){const h=hi(l);h.onlineState=u;let f=!1;h.queries.forEach(((x,g)=>{for(const w of g.Sa)w.va(u)&&(f=!0)})),f&&tw(h)})(n.eventManager,e),r.length&&n.Pu.H_(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function GV(i,e,t){const n=hi(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.Au.get(e),s=r&&r.key;if(s){let l=new ha(tn.comparator);l=l.insert(s,Xs.newNoDocument(s,Hn.min()));const u=Di().add(s),h=new nv(Hn.min(),new Map,new ha(ci),l,u);await XR(n,h),n.du=n.du.remove(s),n.Au.delete(e),iw(n)}else await gx(n.localStore,e,!1).then((()=>vx(n,e,t))).catch(lf)}async function HV(i,e){const t=hi(i),n=e.batch.batchId;try{const r=await Q7(t.localStore,e);QR(t,n,null),JR(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Wm(t,r)}catch(r){await lf(r)}}async function KV(i,e,t){const n=hi(i);try{const r=await(function(l,u){const h=hi(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let x;return h.mutationQueue.lookupMutationBatch(f,u).next((g=>(jn(g!==null,37113),x=g.keys(),h.mutationQueue.removeMutationBatch(f,g)))).next((()=>h.mutationQueue.performConsistencyCheck(f))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(f,x,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,x))).next((()=>h.localDocuments.getDocuments(f,x)))}))})(n.localStore,e);QR(n,e,t),JR(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Wm(n,r)}catch(r){await lf(r)}}function JR(i,e){(i.mu.get(e)||[]).forEach((t=>{t.resolve()})),i.mu.delete(e)}function QR(i,e,t){const n=hi(i);let r=n.Vu[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.Vu[n.currentUser.toKey()]=r}}function vx(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach((n=>{i.Ru.containsKey(n)||ZR(i,n)}))}function ZR(i,e){i.Eu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(Y2(i.remoteStore,t),i.du=i.du.remove(e),i.Au.delete(t),iw(i))}function bE(i,e,t){for(const n of t)n instanceof WR?(i.Ru.addReference(n.key,e),WV(i,n)):n instanceof qR?(zt(nw,"Document no longer in limbo: "+n.key),i.Ru.removeReference(n.key,e),i.Ru.containsKey(n.key)||ZR(i,n.key)):_n(19791,{wu:n})}function WV(i,e){const t=e.key,n=t.path.canonicalString();i.du.get(t)||i.Eu.has(n)||(zt(nw,"New document in limbo: "+t),i.Eu.add(n),iw(i))}function iw(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new tn($r.fromString(e)),n=i.fu.next();i.Au.set(n,new MV(t)),i.du=i.du.insert(t,n),UR(i.remoteStore,new Uc(ou(Q1(t.path)),n,"TargetPurposeLimboResolution",iu.ce))}}async function Wm(i,e,t){const n=hi(i),r=[],s=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{l.push(n.pu(h,e,t).then((f=>{if((f||t)&&n.isPrimaryClient){const x=f?!f.fromCache:t?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,x?"current":"not-current")}if(f){r.push(f);const x=W2.As(h.targetId,f);s.push(x)}})))})),await Promise.all(l),n.Pu.H_(r),await(async function(h,f){const x=hi(h);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>lt.forEach(f,(w=>lt.forEach(w.Es,(A=>x.persistence.referenceDelegate.addReference(g,w.targetId,A))).next((()=>lt.forEach(w.ds,(A=>x.persistence.referenceDelegate.removeReference(g,w.targetId,A)))))))))}catch(g){if(!hd(g))throw g;zt(q2,"Failed to update sequence numbers: "+g)}for(const g of f){const w=g.targetId;if(!g.fromCache){const A=x.Ms.get(w),B=A.snapshotVersion,$=A.withLastLimboFreeSnapshotVersion(B);x.Ms=x.Ms.insert(w,$)}}})(n.localStore,s))}async function qV(i,e){const t=hi(i);if(!t.currentUser.isEqual(e)){zt(nw,"User change. New user:",e.toKey());const n=await MR(t.localStore,e);t.currentUser=e,(function(s,l){s.mu.forEach((u=>{u.forEach((h=>{h.reject(new un(Ot.CANCELLED,l))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Wm(t,n.Ls)}}function YV(i,e){const t=hi(i),n=t.Au.get(e);if(n&&n.hu)return Di().add(n.key);{let r=Di();const s=t.Iu.get(e);if(!s)return r;for(const l of s){const u=t.Tu.get(l);r=r.unionWith(u.view.nu)}return r}}function eL(i){const e=hi(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=XR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GV.bind(null,e),e.Pu.H_=LV.bind(null,e.eventManager),e.Pu.yu=DV.bind(null,e.eventManager),e}function tL(i){const e=hi(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KV.bind(null,e),e}class vm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=av(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return OR(this.persistence,new PR,e.initialUser,this.serializer)}Cu(e){return new H2(sv.mi,this.serializer)}Du(e){return new jR}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vm.provider={build:()=>new vm};class XV extends vm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){jn(this.persistence.referenceDelegate instanceof a1,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new CR(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?No.withCacheSize(this.cacheSizeBytes):No.DEFAULT;return new H2((n=>a1.mi(n,t)),this.serializer)}}class JV extends vm{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await tL(this.xu.syncEngine),await Km(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return OR(this.persistence,new PR,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new CR(n,e.asyncQueue,t)}Mu(e,t){const n=new QF(t,this.persistence);return new JF(e.asyncQueue,n)}Cu(e){const t=q7(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?No.withCacheSize(this.cacheSizeBytes):No.DEFAULT;return new K2(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,uV(),S0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new jR}}class l1{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>_E(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=qV.bind(null,this.syncEngine),await EV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new kV})()}createDatastore(e){const t=av(e.databaseInfo.databaseId),n=(function(s){return new lV(s)})(e.databaseInfo);return(function(s,l,u,h){return new fV(s,l,u,h)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,r,s,l,u){return new gV(n,r,s,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>_E(this.syncEngine,t,0)),(function(){return fE.v()?new fE:new rV})())}createSyncEngine(e,t){return(function(r,s,l,u,h,f,x){const g=new FV(r,s,l,u,h,f);return x&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=hi(t);zt(ef,"RemoteStore shutting down."),n.Ea.add(5),await Hm(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}l1.provider={build:()=>new l1};class QV{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const nd="FirestoreClient";class ZV{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=vo.UNAUTHENTICATED,this.clientId=w2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async l=>{zt(nd,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(zt(nd,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ew(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function J_(i,e){i.asyncQueue.verifyOperationInProgress(),zt(nd,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener((async r=>{n.isEqual(r)||(await MR(e.localStore,r),n=r)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function xE(i,e){i.asyncQueue.verifyOperationInProgress();const t=await e9(i);zt(nd,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((n=>gE(e.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,r)=>gE(e.remoteStore,r))),i._onlineComponents=e}async function e9(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){zt(nd,"Using user provided OfflineComponentProvider");try{await J_(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Ot.FAILED_PRECONDITION||r.code===Ot.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;qd("Error using user provided cache. Falling back to memory cache: "+t),await J_(i,new vm)}}else zt(nd,"Using default OfflineComponentProvider"),await J_(i,new XV(void 0));return i._offlineComponents}async function nL(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(zt(nd,"Using user provided OnlineComponentProvider"),await xE(i,i._uninitializedComponentsProvider._online)):(zt(nd,"Using default OnlineComponentProvider"),await xE(i,new l1))),i._onlineComponents}function t9(i){return nL(i).then((e=>e.syncEngine))}async function n9(i){const e=await nL(i),t=e.eventManager;return t.onListen=jV.bind(null,e.syncEngine),t.onUnlisten=UV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=BV.bind(null,e.syncEngine),t}function i9(i,e,t={}){const n=new Hc;return i.asyncQueue.enqueueAndForget((async()=>(function(s,l,u,h,f){const x=new QV({next:w=>{x.Nu(),l.enqueueAndForget((()=>RV(s,g)));const A=w.docs.has(u);!A&&w.fromCache?f.reject(new un(Ot.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&w.fromCache&&h&&h.source==="server"?f.reject(new un(Ot.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(w)},error:w=>f.reject(w)}),g=new NV(Q1(u.path),x,{includeMetadataChanges:!0,qa:!0});return CV(s,g)})(await n9(i),i.asyncQueue,e,t,n))),n.promise}function iL(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}const wE=new Map;const rL="firestore.googleapis.com",SE=!0;class TE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new un(Ot.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rL,this.ssl=SE}else this.host=e.host,this.ssl=e.ssl??SE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=AR;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<L7)throw new un(Ot.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iL(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new un(Ot.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new un(Ot.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new un(Ot.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,r){return n.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rw{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new TE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new un(Ot.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new un(Ot.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new TE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new MF;switch(n.type){case"firstParty":return new zF(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new un(Ot.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=wE.get(t);n&&(zt("ComponentProvider","Removing Datastore"),wE.delete(t),n.terminate())})(this),Promise.resolve()}}function r9(i,e,t,n={}){i=hp(i,rw);const r=ac(e),s=i._getSettings(),l={...s,emulatorOptions:i._getEmulatorOptions()},u=`${e}:${t}`;r&&(P1(`https://${u}`),O1("Firestore",!0)),s.host!==rL&&s.host!==u&&qd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...s,host:u,ssl:r,emulatorOptions:n};if(!Jh(h,l)&&(i._setSettings(h),n.mockUserToken)){let f,x;if(typeof n.mockUserToken=="string")f=n.mockUserToken,x=vo.MOCK_USER;else{f=o2(n.mockUserToken,i._app?.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new un(Ot.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new vo(g)}i._authCredentials=new FF(new f3(f,x))}}class sw{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new sw(this.firestore,e,this._query)}}class eo{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _m(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new eo(this.firestore,e,this._key)}toJSON(){return{type:eo._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(zm(t,eo._jsonSchema))return new eo(e,n||null,new tn($r.fromString(t.referencePath)))}}eo._jsonSchemaVersion="firestore/documentReference/1.0",eo._jsonSchema={type:Sa("string",eo._jsonSchemaVersion),referencePath:Sa("string")};class _m extends sw{constructor(e,t,n){super(e,t,Q1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new eo(this.firestore,null,new tn(e))}withConverter(e){return new _m(this.firestore,e,this._path)}}function AE(i,e,...t){if(i=Ss(i),arguments.length===1&&(e=w2.newId()),KF("doc","path",e),i instanceof rw){const n=$r.fromString(e,...t);return pA(n),new eo(i,null,new tn(n))}{if(!(i instanceof eo||i instanceof _m))throw new un(Ot.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child($r.fromString(e,...t));return pA(n),new eo(i.firestore,i instanceof _m?i.converter:null,new tn(n))}}const EE="AsyncQueue";class IE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new VR(this,"async_queue_retry"),this._c=()=>{const n=S0();n&&zt(EE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=S0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=S0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Hc;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hd(e))throw e;zt(EE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Xo("INTERNAL UNHANDLED ERROR: ",kE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Z2.createAndSchedule(this,e,t,n,(s=>this.hc(s)));return this.tc.push(r),r}uc(){this.nc&&_n(47125,{Pc:kE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function kE(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class lv extends rw{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new IE,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new IE(e),this._firestoreClient=void 0,await e}}}function sL(i,e){const t=typeof i=="object"?i:z1(),n=typeof i=="string"?i:J0,r=Om(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=a2("firestore");s&&r9(r,...s)}return r}function aL(i){if(i._terminated)throw new un(Ot.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||oL(i),i._firestoreClient}function oL(i){const e=i._freezeSettings(),t=(function(r,s,l,u){return new Ij(r,s,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,iL(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new ZV(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(r){const s=r?._online.build();return{_offline:r?._offline.build(s),_online:s}})(i._componentsProvider))}function s9(i,e){qd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=i._freezeSettings();return a9(i,l1.provider,{build:n=>new JV(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function a9(i,e,t){if((i=hp(i,lv))._firestoreClient||i._terminated)throw new un(Ot.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(i._componentsProvider||i._getSettings().localCache)throw new un(Ot.FAILED_PRECONDITION,"SDK cache is already specified.");i._componentsProvider={_online:e,_offline:t},oL(i)}class nu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nu(Ta.fromBase64String(e))}catch(t){throw new un(Ot.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new nu(Ta.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zm(e,nu._jsonSchema))return nu.fromBase64String(e.bytes)}}nu._jsonSchemaVersion="firestore/bytes/1.0",nu._jsonSchema={type:Sa("string",nu._jsonSchemaVersion),bytes:Sa("string")};class aw{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new un(Ot.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ds(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class lL{constructor(e){this._methodName=e}}class nc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new un(Ot.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new un(Ot.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ci(this._lat,e._lat)||ci(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:nc._jsonSchemaVersion}}static fromJSON(e){if(zm(e,nc._jsonSchema))return new nc(e.latitude,e.longitude)}}nc._jsonSchemaVersion="firestore/geoPoint/1.0",nc._jsonSchema={type:Sa("string",nc._jsonSchemaVersion),latitude:Sa("number"),longitude:Sa("number")};class ic{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,r){if(n.length!==r.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ic._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zm(e,ic._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ic(e.vectorValues);throw new un(Ot.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ic._jsonSchemaVersion="firestore/vectorValue/1.0",ic._jsonSchema={type:Sa("string",ic._jsonSchemaVersion),vectorValues:Sa("object")};const o9=/^__.*__$/;class l9{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new dd(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fp(e,this.data,t,this.fieldTransforms)}}function uL(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _n(40011,{Ac:i})}}class ow{constructor(e,t,n,r,s,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ow({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return u1(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(uL(this.Ac)&&o9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class u9{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||av(e)}Cc(e,t,n,r=!1){return new ow({Ac:e,methodName:t,Dc:n,path:Ds.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function c9(i){const e=i._freezeSettings(),t=av(i._databaseId);return new u9(i._databaseId,!!e.ignoreUndefinedProperties,t)}function h9(i,e,t,n,r,s={}){const l=i.Cc(s.merge||s.mergeFields?2:0,e,t,r);fL("Data must be an object, but it was:",l,n);const u=hL(n,l);let h,f;if(s.merge)h=new ru(l.fieldMask),f=l.fieldTransforms;else if(s.mergeFields){const x=[];for(const g of s.mergeFields){const w=d9(e,g,t);if(!l.contains(w))throw new un(Ot.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);p9(x,w)||x.push(w)}h=new ru(x),f=l.fieldTransforms.filter((g=>h.covers(g.field)))}else h=null,f=l.fieldTransforms;return new l9(new fl(u),h,f)}function cL(i,e){if(dL(i=Ss(i)))return fL("Unsupported field value:",e,i),hL(i,e);if(i instanceof lL)return(function(n,r){if(!uL(r.Ac))throw r.Sc(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,r){const s=[];let l=0;for(const u of n){let h=cL(u,r.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),l++}return{arrayValue:{values:s}}})(i,e)}return(function(n,r){if((n=Ss(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return qj(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Mr.fromDate(n);return{timestampValue:wp(r.serializer,s)}}if(n instanceof Mr){const s=new Mr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:wp(r.serializer,s)}}if(n instanceof nc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof nu)return{bytesValue:uR(r.serializer,n._byteString)};if(n instanceof eo){const s=r.databaseId,l=n.firestore._databaseId;if(!l.isEqual(s))throw r.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:U2(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof ic)return(function(l,u){return{mapValue:{fields:{[L2]:{stringValue:D2},[mp]:{arrayValue:{values:l.toArray().map((f=>{if(typeof f!="number")throw u.Sc("VectorValues must only contain numeric values.");return O2(u.serializer,f)}))}}}}}})(n,r);throw r.Sc(`Unsupported field value: ${S2(n)}`)})(i,e)}function hL(i,e){const t={};return R3(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):uf(i,((n,r)=>{const s=cL(r,e.mc(n));s!=null&&(t[n]=s)})),{mapValue:{fields:t}}}function dL(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Mr||i instanceof nc||i instanceof nu||i instanceof eo||i instanceof lL||i instanceof ic)}function fL(i,e,t){if(!dL(t)||!g3(t)){const n=S2(t);throw n==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+n)}}function d9(i,e,t){if((e=Ss(e))instanceof aw)return e._internalPath;if(typeof e=="string")return pL(i,e);throw u1("Field path arguments must be of type string or ",i,!1,void 0,t)}const f9=new RegExp("[~\\*/\\[\\]]");function pL(i,e,t){if(e.search(f9)>=0)throw u1(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new aw(...e.split("."))._internalPath}catch{throw u1(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function u1(i,e,t,n,r){const s=n&&!n.isEmpty(),l=r!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(s||l)&&(h+=" (found",s&&(h+=` in field ${n}`),l&&(h+=` in document ${r}`),h+=")"),new un(Ot.INVALID_ARGUMENT,u+i+h)}function p9(i,e){return i.some((t=>t.isEqual(e)))}class gL{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new eo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new g9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mL("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class g9 extends gL{data(){return super.data()}}function mL(i,e){return typeof e=="string"?pL(i,e):e instanceof aw?e._internalPath:e._delegate._internalPath}class m9{convertValue(e,t="none"){switch(Zh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ws(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _n(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return uf(e,((r,s)=>{n[r]=this.convertValue(s,t)})),n}convertVectorValue(e){const t=e.fields?.[mp].arrayValue?.values?.map((n=>ws(n.doubleValue)));return new ic(t)}convertGeoPoint(e){return new nc(ws(e.latitude),ws(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Y1(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(fm(e));default:return null}}convertTimestamp(e){const t=Qc(e);return new Mr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=$r.fromString(e);jn(_R(n),9688,{name:e});const r=new Yd(n.get(1),n.get(3)),s=new tn(n.popFirst(5));return r.isEqual(t)||Xo(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function y9(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}class Og{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $d extends gL{constructor(e,t,n,r,s,l){super(e,t,n,r,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new T0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(mL("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new un(Ot.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=$d._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}$d._jsonSchemaVersion="firestore/documentSnapshot/1.0",$d._jsonSchema={type:Sa("string",$d._jsonSchemaVersion),bundleSource:Sa("string","DocumentSnapshot"),bundleName:Sa("string"),bundle:Sa("string")};class T0 extends $d{data(e={}){return super.data(e)}}class Wg{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Og(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new T0(this._firestore,this._userDataWriter,n.key,n,new Og(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new un(Ot.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let l=0;return r._snapshot.docChanges.map((u=>{const h=new T0(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Og(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((u=>s||u.type!==3)).map((u=>{const h=new T0(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Og(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let f=-1,x=-1;return u.type!==0&&(f=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),x=l.indexOf(u.doc.key)),{type:v9(u.type),doc:h,oldIndex:f,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new un(Ot.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wg._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=w2.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function v9(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _n(61501,{type:i})}}function _9(i){i=hp(i,eo);const e=hp(i.firestore,lv);return i9(aL(e),i._key).then((t=>S9(e,i,t)))}Wg._jsonSchemaVersion="firestore/querySnapshot/1.0",Wg._jsonSchema={type:Sa("string",Wg._jsonSchemaVersion),bundleSource:Sa("string","QuerySnapshot"),bundleName:Sa("string"),bundle:Sa("string")};class b9 extends m9{constructor(e){super(),this.firestore=e}convertBytes(e){return new nu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new eo(this.firestore,null,t)}}function x9(i,e,t){i=hp(i,eo);const n=hp(i.firestore,lv),r=y9(i.converter,e,t);return w9(n,[h9(c9(n),"setDoc",i._key,r,i.converter!==null,t).toMutation(i._key,Fl.none())])}function w9(i,e){return(function(n,r){const s=new Hc;return n.asyncQueue.enqueueAndForget((async()=>$V(await t9(n),r,s))),s.promise})(aL(i),e)}function S9(i,e,t){const n=t.docs.get(e._key),r=new b9(i);return new $d(i,r,e._key,n,new Og(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){Mp=r})(ld),Qh(new qc("firestore",((n,{instanceIdentifier:r,options:s})=>{const l=n.getProvider("app").getImmediate(),u=new lv(new jF(n.getProvider("auth-internal")),new UF(l,n.getProvider("app-check-internal")),(function(f,x){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new un(Ot.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yd(f.options.projectId,x)})(l,r),l);return s={useFetchStreams:t,...s},u._setSettings(s),u}),"PUBLIC").setMultipleInstances(!0)),au(cA,hA,e),au(cA,hA,"esm2020")})();const T9={apiKey:"AIzaSyAUv69QXH4MNNR2wkr_wcVH_cbsYrc3wjo",authDomain:"wellnessai-app-e01be.firebaseapp.com",databaseURL:"https://wellnessai-app-e01be-default-rtdb.europe-west1.firebasedatabase.app",projectId:"wellnessai-app-e01be",storageBucket:"wellnessai-app-e01be.firebasestorage.app",messagingSenderId:"863551474584",appId:"1:863551474584:web:a34f3f77742b7be4e7f9ed",measurementId:"G-CB4C84PTJ3"},yL=V1(T9),lw=b2(yL);sL(yL);const A9="https://helio-wellness-app-production.up.railway.app";async function uw(i,e){try{const t=lw.currentUser;if(!t)throw new Error("User must be logged in to subscribe");const n=await fetch(`${A9}/api/stripe/create-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.uid,priceId:i,plan:e})});if(!n.ok)throw new Error("Failed to create checkout session");const r=await n.json();window.location.href=r.url}catch(t){console.error("Error creating checkout:",t),alert("Failed to start checkout. Please try again.")}}const E9=()=>{uw("prod_TZhdMJIuUuIxOP","essential")},I9=()=>{uw("prod_TZhulmjk69SvVX","premium")},k9=()=>{uw("prod_TZhmpYUG5KqUaK","vip")};var Tp;(function(i){i.Unimplemented="UNIMPLEMENTED",i.Unavailable="UNAVAILABLE"})(Tp||(Tp={}));class Q_ extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const C9=i=>{var e,t;return i?.androidBridge?"android":!((t=(e=i?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},R9=i=>{const e=i.CapacitorCustomPlatform||null,t=i.Capacitor||{},n=t.Plugins=t.Plugins||{},r=()=>e!==null?e.name:C9(i),s=()=>r()!=="web",l=g=>{const w=f.get(g);return!!(w?.platforms.has(r())||u(g))},u=g=>{var w;return(w=t.PluginHeaders)===null||w===void 0?void 0:w.find(A=>A.name===g)},h=g=>i.console.error(g),f=new Map,x=(g,w={})=>{const A=f.get(g);if(A)return console.warn(`Capacitor plugin "${g}" already registered. Cannot register plugins twice.`),A.proxy;const B=r(),$=u(g);let W;const q=async()=>(!W&&B in w?W=typeof w[B]=="function"?W=await w[B]():W=w[B]:e!==null&&!W&&"web"in w&&(W=typeof w.web=="function"?W=await w.web():W=w.web),W),ge=(ee,J)=>{var ye,X;if($){const ae=$?.methods.find(le=>J===le.name);if(ae)return ae.rtype==="promise"?le=>t.nativePromise(g,J.toString(),le):(le,ze)=>t.nativeCallback(g,J.toString(),le,ze);if(ee)return(ye=ee[J])===null||ye===void 0?void 0:ye.bind(ee)}else{if(ee)return(X=ee[J])===null||X===void 0?void 0:X.bind(ee);throw new Q_(`"${g}" plugin is not implemented on ${B}`,Tp.Unimplemented)}},he=ee=>{let J;const ye=(...X)=>{const ae=q().then(le=>{const ze=ge(le,ee);if(ze){const nt=ze(...X);return J=nt?.remove,nt}else throw new Q_(`"${g}.${ee}()" is not implemented on ${B}`,Tp.Unimplemented)});return ee==="addListener"&&(ae.remove=async()=>J()),ae};return ye.toString=()=>`${ee.toString()}() { [capacitor code] }`,Object.defineProperty(ye,"name",{value:ee,writable:!1,configurable:!1}),ye},me=he("addListener"),Ce=he("removeListener"),Ve=(ee,J)=>{const ye=me({eventName:ee},J),X=async()=>{const le=await ye;Ce({eventName:ee,callbackId:le},J)},ae=new Promise(le=>ye.then(()=>le({remove:X})));return ae.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await X()},ae},pe=new Proxy({},{get(ee,J){switch(J){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return $?Ve:me;case"removeListener":return Ce;default:return he(J)}}});return n[g]=pe,f.set(g,{name:g,proxy:pe,platforms:new Set([...Object.keys(w),...$?[B]:[]])}),pe};return t.convertFileSrc||(t.convertFileSrc=g=>g),t.getPlatform=r,t.handleError=h,t.isNativePlatform=s,t.isPluginAvailable=l,t.registerPlugin=x,t.Exception=Q_,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},L9=i=>i.Capacitor=R9(i),bo=L9(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ul=bo.registerPlugin;class vL{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),n&&this.sendRetainedArgumentsForEvent(e);const l=async()=>this.removeListener(e,t);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const r=this.listeners[e];if(!r){if(n){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}r.forEach(s=>s(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:n=>{this.notifyListeners(t,n)}}}unimplemented(e="not implemented"){return new bo.Exception(e,Tp.Unimplemented)}unavailable(e="not available"){return new bo.Exception(e,Tp.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const r=n.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(n=>{this.notifyListeners(e,n)}))}}const CE=i=>encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),RE=i=>i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class D9 extends vL{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[r,s]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=RE(r).trim(),s=RE(s).trim(),t[r]=s}),t}async setCookie(e){try{const t=CE(e.key),n=CE(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),l=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${r}; path=${s}; ${l};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Ul("CapacitorCookies",{web:()=>new D9});const N9=async i=>new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const r=n.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},n.onerror=r=>t(r),n.readAsDataURL(i)}),P9=(i={})=>{const e=Object.keys(i);return Object.keys(i).map(r=>r.toLocaleLowerCase()).reduce((r,s,l)=>(r[s]=i[e[l]],r),{})},O9=(i,e=!0)=>i?Object.entries(i).reduce((n,r)=>{const[s,l]=r;let u,h;return Array.isArray(l)?(h="",l.forEach(f=>{u=e?encodeURIComponent(f):f,h+=`${s}=${u}&`}),h.slice(0,-1)):(u=e?encodeURIComponent(l):l,h=`${s}=${u}`),`${n}&${h}`},"").substr(1):null,M9=(i,e={})=>{const t=Object.assign({method:i.method||"GET",headers:i.headers},e),r=P9(i.headers)["content-type"]||"";if(typeof i.data=="string")t.body=i.data;else if(r.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[l,u]of Object.entries(i.data||{}))s.set(l,u);t.body=s.toString()}else if(r.includes("multipart/form-data")||i.data instanceof FormData){const s=new FormData;if(i.data instanceof FormData)i.data.forEach((u,h)=>{s.append(h,u)});else for(const u of Object.keys(i.data))s.append(u,i.data[u]);t.body=s;const l=new Headers(t.headers);l.delete("content-type"),t.headers=l}else(r.includes("application/json")||typeof i.data=="object")&&(t.body=JSON.stringify(i.data));return t};class F9 extends vL{async request(e){const t=M9(e,e.webFetchExtra),n=O9(e.params,e.shouldEncodeUrlParams),r=n?`${e.url}?${n}`:e.url,s=await fetch(r,t),l=s.headers.get("content-type")||"";let{responseType:u="text"}=s.ok?e:{};l.includes("application/json")&&(u="json");let h,f;switch(u){case"arraybuffer":case"blob":f=await s.blob(),h=await N9(f);break;case"json":h=await s.json();break;case"document":case"text":default:h=await s.text()}const x={};return s.headers.forEach((g,w)=>{x[w]=g}),{data:h,headers:x,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Ul("CapacitorHttp",{web:()=>new F9});const j9="modulepreload",V9=function(i){return"/"+i},LE={},Vt=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let h=function(f){return Promise.all(f.map(x=>Promise.resolve(x).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");r=h(t.map(f=>{if(f=V9(f),f in LE)return;LE[f]=!0;const x=f.endsWith(".css"),g=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const w=document.createElement("link");if(w.rel=x?"stylesheet":j9,x||(w.as="script"),w.crossOrigin="",w.href=f,u&&w.setAttribute("nonce",u),document.head.appendChild(w),x)return new Promise((A,B)=>{w.addEventListener("load",A),w.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return r.then(l=>{for(const u of l||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})},Hf=Ul("Device",{web:()=>Vt(()=>import("./chunk-1765759384263-web.js"),[]).then(i=>new i.DeviceWeb)}),gn=Ul("Preferences",{web:()=>Vt(()=>import("./chunk-1765759384263-web2.js"),[]).then(i=>new i.PreferencesWeb)}),_L=Object.freeze(Object.defineProperty({__proto__:null,Preferences:gn},Symbol.toStringTag,{value:"Module"}));var DE={};const NE="@firebase/database",PE="1.1.0";let bL="";function z9(i){bL=i}class U9{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ma(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:im(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class B9{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return lc(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const xL=function(i){try{if(typeof window<"u"&&typeof window[i]<"u"){const e=window[i];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new U9(e)}}catch{}return new B9},Vd=xL("localStorage"),$9=xL("sessionStorage");const np=new j1("@firebase/database"),G9=(function(){let i=1;return function(){return i++}})(),wL=function(i){const e=c6(i),t=new a6;t.update(e);const n=t.digest();return s2.encodeByteArray(n)},qm=function(...i){let e="";for(let t=0;t<i.length;t++){const n=i[t];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=qm.apply(null,n):typeof n=="object"?e+=Ma(n):e+=n,e+=" "}return e};let qg=null,OE=!0;const H9=function(i,e){Kt(!0,"Can't turn on custom loggers persistently."),np.logLevel=Ki.VERBOSE,qg=np.log.bind(np)},_o=function(...i){if(OE===!0&&(OE=!1,qg===null&&$9.get("logging_enabled")===!0&&H9()),qg){const e=qm.apply(null,i);qg(e)}},Ym=function(i){return function(...e){_o(i,...e)}},_x=function(...i){const e="FIREBASE INTERNAL ERROR: "+qm(...i);np.error(e)},eh=function(...i){const e=`FIREBASE FATAL ERROR: ${qm(...i)}`;throw np.error(e),new Error(e)},Zo=function(...i){const e="FIREBASE WARNING: "+qm(...i);np.warn(e)},K9=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Zo("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},cw=function(i){return typeof i=="number"&&(i!==i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)},W9=function(i){if(document.readyState==="complete")i();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,i())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ap="[MIN_NAME]",tf="[MAX_NAME]",hf=function(i,e){if(i===e)return 0;if(i===Ap||e===tf)return-1;if(e===Ap||i===tf)return 1;{const t=ME(i),n=ME(e);return t!==null?n!==null?t-n===0?i.length-e.length:t-n:-1:n!==null?1:i<e?-1:1}},q9=function(i,e){return i===e?0:i<e?-1:1},_g=function(i,e){if(e&&i in e)return e[i];throw new Error("Missing required key ("+i+") in object: "+Ma(e))},hw=function(i){if(typeof i!="object"||i===null)return Ma(i);const e=[];for(const n in i)e.push(n);e.sort();let t="{";for(let n=0;n<e.length;n++)n!==0&&(t+=","),t+=Ma(e[n]),t+=":",t+=hw(i[e[n]]);return t+="}",t},SL=function(i,e){const t=i.length;if(t<=e)return[i];const n=[];for(let r=0;r<t;r+=e)r+e>t?n.push(i.substring(r,t)):n.push(i.substring(r,r+e));return n};function xo(i,e){for(const t in i)i.hasOwnProperty(t)&&e(t,i[t])}const TL=function(i){Kt(!cw(i),"Invalid JSON number");const e=11,t=52,n=(1<<e-1)-1;let r,s,l,u,h;i===0?(s=0,l=0,r=1/i===-1/0?1:0):(r=i<0,i=Math.abs(i),i>=Math.pow(2,1-n)?(u=Math.min(Math.floor(Math.log(i)/Math.LN2),n),s=u+n,l=Math.round(i*Math.pow(2,t-u)-Math.pow(2,t))):(s=0,l=Math.round(i/Math.pow(2,1-n-t))));const f=[];for(h=t;h;h-=1)f.push(l%2?1:0),l=Math.floor(l/2);for(h=e;h;h-=1)f.push(s%2?1:0),s=Math.floor(s/2);f.push(r?1:0),f.reverse();const x=f.join("");let g="";for(h=0;h<64;h+=8){let w=parseInt(x.substr(h,8),2).toString(16);w.length===1&&(w="0"+w),g=g+w}return g.toLowerCase()},Y9=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},X9=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function J9(i,e){let t="Unknown Error";i==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":i==="permission_denied"?t="Client doesn't have permission to access the desired data.":i==="unavailable"&&(t="The service is unavailable");const n=new Error(i+" at "+e._path.toString()+": "+t);return n.code=i.toUpperCase(),n}const Q9=new RegExp("^-?(0*)\\d{1,10}$"),Z9=-2147483648,ez=2147483647,ME=function(i){if(Q9.test(i)){const e=Number(i);if(e>=Z9&&e<=ez)return e}return null},Vp=function(i){try{i()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Zo("Exception was thrown by user callback.",t),e},Math.floor(0))}},tz=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Yg=function(i,e){const t=setTimeout(i,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};class nz{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Po(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(n=>this.appCheck=n)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){Zo(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class iz{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(_o("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Zo(e)}}class A0{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}A0.OWNER="owner";const dw="5",AL="v",EL="s",IL="r",kL="f",CL=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,RL="ls",LL="p",bx="ac",DL="websocket",NL="long_polling";class PL{constructor(e,t,n,r,s=!1,l="",u=!1,h=!1,f=null){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=l,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=h,this.emulatorOptions=f,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vd.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function rz(i){return i.host!==i.internalHost||i.isCustomHost()||i.includeNamespaceInQueryParams}function OL(i,e,t){Kt(typeof e=="string","typeof type must == string"),Kt(typeof t=="object","typeof params must == object");let n;if(e===DL)n=(i.secure?"wss://":"ws://")+i.internalHost+"/.ws?";else if(e===NL)n=(i.secure?"https://":"http://")+i.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);rz(i)&&(t.ns=i.namespace);const r=[];return xo(t,(s,l)=>{r.push(s+"="+l)}),n+r.join("&")}class sz{constructor(){this.counters_={}}incrementCounter(e,t=1){lc(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return $O(this.counters_)}}const Z_={},eb={};function fw(i){const e=i.toString();return Z_[e]||(Z_[e]=new sz),Z_[e]}function az(i,e){const t=i.toString();return eb[t]||(eb[t]=e()),eb[t]}class oz{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<n.length;++r)n[r]&&Vp(()=>{this.onMessage_(n[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const FE="start",lz="close",uz="pLPCommand",cz="pRTLPCB",ML="id",FL="pw",jL="ser",hz="cb",dz="seg",fz="ts",pz="d",gz="dframe",VL=1870,zL=30,mz=VL-zL,yz=25e3,vz=3e4;class qf{constructor(e,t,n,r,s,l,u){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.transportSessionId=l,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ym(e),this.stats_=fw(t),this.urlFn=h=>(this.appCheckToken&&(h[bx]=this.appCheckToken),OL(t,NL,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new oz(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(vz)),W9(()=>{if(this.isClosed_)return;this.scriptTagHolder=new pw((...s)=>{const[l,u,h,f,x]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,l===FE)this.id=u,this.password=h;else if(l===lz)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+l)},(...s)=>{const[l,u]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(l,u)},()=>{this.onClosed_()},this.urlFn);const n={};n[FE]="t",n[jL]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[hz]=this.scriptTagHolder.uniqueCallbackIdentifier),n[AL]=dw,this.transportSessionId&&(n[EL]=this.transportSessionId),this.lastSessionId&&(n[RL]=this.lastSessionId),this.applicationId&&(n[LL]=this.applicationId),this.appCheckToken&&(n[bx]=this.appCheckToken),typeof location<"u"&&location.hostname&&CL.test(location.hostname)&&(n[IL]=kL);const r=this.urlFn(n);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){qf.forceAllow_=!0}static forceDisallow(){qf.forceDisallow_=!0}static isAvailable(){return qf.forceAllow_?!0:!qf.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Y9()&&!X9()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Ma(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=cC(t),r=SL(n,mz);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={};n[gz]="t",n[ML]=e,n[FL]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Ma(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class pw{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=G9(),window[uz+this.uniqueCallbackIdentifier]=e,window[cz+this.uniqueCallbackIdentifier]=t,this.myIFrame=pw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(u){_o("frame writing exception"),u.stack&&_o(u.stack),_o(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_o("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[ML]=this.myID,e[FL]=this.myPW,e[jL]=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+zL+n.length<=VL;){const l=this.pendingSegs.shift();n=n+"&"+dz+r+"="+l.seg+"&"+fz+r+"="+l.ts+"&"+pz+r+"="+l.d,r++}return t=t+n,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(yz)),s=()=>{clearTimeout(r),n()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const r=n.readyState;(!r||r==="loaded"||r==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{_o("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}const _z=16384,bz=45e3;let c1=null;typeof MozWebSocket<"u"?c1=MozWebSocket:typeof WebSocket<"u"&&(c1=WebSocket);class ku{constructor(e,t,n,r,s,l,u){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ym(this.connId),this.stats_=fw(t),this.connURL=ku.connectionURL_(t,l,u,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,s){const l={};return l[AL]=dw,typeof location<"u"&&location.hostname&&CL.test(location.hostname)&&(l[IL]=kL),t&&(l[EL]=t),n&&(l[RL]=n),r&&(l[bx]=r),s&&(l[LL]=s),OL(e,DL,l)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vd.set("previous_websocket_failure",!0);try{let n;ZO(),this.mySock=new c1(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const r=n.message||n.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const r=n.message||n.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){ku.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&c1!==null&&!ku.forceDisallow_}static previouslyFailed(){return Vd.isInMemoryStorage||Vd.get("previous_websocket_failure")===!0}markConnectionHealthy(){Vd.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const n=im(t);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Kt(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const n=this.extractFrameCount_(t);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const t=Ma(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=SL(t,_z);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(bz))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ku.responsesRequiredToBeHealthy=2;ku.healthyTimeout=3e4;class bm{static get ALL_TRANSPORTS(){return[qf,ku]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=ku&&ku.isAvailable();let n=t&&!ku.previouslyFailed();if(e.webSocketOnly&&(t||Zo("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[ku];else{const r=this.transports_=[];for(const s of bm.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);bm.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}bm.globalTransportInitialized_=!1;const xz=6e4,wz=5e3,Sz=10*1024,Tz=100*1024,tb="t",jE="d",Az="s",VE="r",Ez="e",zE="o",UE="a",BE="n",$E="p",Iz="h";class kz{constructor(e,t,n,r,s,l,u,h,f,x){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=l,this.onReady_=u,this.onDisconnect_=h,this.onKill_=f,this.lastSessionId=x,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ym("c:"+this.id+":"),this.transportManager_=new bm(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Yg(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Tz?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Sz?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(tb in e){const t=e[tb];t===UE?this.upgradeIfSecondaryHealthy_():t===VE?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===zE&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=_g("t",e),n=_g("d",e);if(t==="c")this.onSecondaryControl_(n);else if(t==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:$E,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:UE,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:BE,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=_g("t",e),n=_g("d",e);t==="c"?this.onControl_(n):t==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=_g(tb,e);if(jE in e){const n=e[jE];if(t===Iz){const r={...n};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===BE){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Az?this.onConnectionShutdown_(n):t===VE?this.onReset_(n):t===Ez?_x("Server Error: "+n):t===zE?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):_x("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),dw!==n&&Zo("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Yg(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(xz))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Yg(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(wz))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:$E,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class UL{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class BL{constructor(e){this.allowedEvents_=e,this.listeners_={},Kt(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let r=0;r<n.length;r++)n[r].callback.apply(n[r].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!n||n===r[s].context)){r.splice(s,1);return}}validateEventType_(e){Kt(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class h1 extends BL{static getInstance(){return new h1}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!l2()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Kt(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const GE=32,HE=768;class Hr{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let n=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function yr(){return new Hr("")}function ji(i){return i.pieceNum_>=i.pieces_.length?null:i.pieces_[i.pieceNum_]}function id(i){return i.pieces_.length-i.pieceNum_}function as(i){let e=i.pieceNum_;return e<i.pieces_.length&&e++,new Hr(i.pieces_,e)}function gw(i){return i.pieceNum_<i.pieces_.length?i.pieces_[i.pieces_.length-1]:null}function Cz(i){let e="";for(let t=i.pieceNum_;t<i.pieces_.length;t++)i.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(i.pieces_[t])));return e||"/"}function xm(i,e=0){return i.pieces_.slice(i.pieceNum_+e)}function $L(i){if(i.pieceNum_>=i.pieces_.length)return null;const e=[];for(let t=i.pieceNum_;t<i.pieces_.length-1;t++)e.push(i.pieces_[t]);return new Hr(e,0)}function Js(i,e){const t=[];for(let n=i.pieceNum_;n<i.pieces_.length;n++)t.push(i.pieces_[n]);if(e instanceof Hr)for(let n=e.pieceNum_;n<e.pieces_.length;n++)t.push(e.pieces_[n]);else{const n=e.split("/");for(let r=0;r<n.length;r++)n[r].length>0&&t.push(n[r])}return new Hr(t,0)}function Wi(i){return i.pieceNum_>=i.pieces_.length}function Jo(i,e){const t=ji(i),n=ji(e);if(t===null)return e;if(t===n)return Jo(as(i),as(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+i+")")}function Rz(i,e){const t=xm(i,0),n=xm(e,0);for(let r=0;r<t.length&&r<n.length;r++){const s=hf(t[r],n[r]);if(s!==0)return s}return t.length===n.length?0:t.length<n.length?-1:1}function mw(i,e){if(id(i)!==id(e))return!1;for(let t=i.pieceNum_,n=e.pieceNum_;t<=i.pieces_.length;t++,n++)if(i.pieces_[t]!==e.pieces_[n])return!1;return!0}function su(i,e){let t=i.pieceNum_,n=e.pieceNum_;if(id(i)>id(e))return!1;for(;t<i.pieces_.length;){if(i.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0}class Lz{constructor(e,t){this.errorPrefix_=t,this.parts_=xm(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=F1(this.parts_[n]);GL(this)}}function Dz(i,e){i.parts_.length>0&&(i.byteLength_+=1),i.parts_.push(e),i.byteLength_+=F1(e),GL(i)}function Nz(i){const e=i.parts_.pop();i.byteLength_-=F1(e),i.parts_.length>0&&(i.byteLength_-=1)}function GL(i){if(i.byteLength_>HE)throw new Error(i.errorPrefix_+"has a key path longer than "+HE+" bytes ("+i.byteLength_+").");if(i.parts_.length>GE)throw new Error(i.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+GE+") or object contains a cycle "+kd(i))}function kd(i){return i.parts_.length===0?"":"in property '"+i.parts_.join(".")+"'"}class yw extends BL{static getInstance(){return new yw}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(e){return Kt(e==="visible","Unknown event type: "+e),[this.visible_]}}const bg=1e3,Pz=300*1e3,KE=30*1e3,Oz=1.3,Mz=3e4,Fz="server_kill",WE=3;class Kc extends UL{constructor(e,t,n,r,s,l,u,h){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=l,this.appCheckTokenProvider_=u,this.authOverride_=h,this.id=Kc.nextPersistentConnectionId_++,this.log_=Ym("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=bg,this.maxReconnectDelay_=Pz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yw.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&h1.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,s={r,a:e,b:t};this.log_(Ma(s)),Kt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Nm,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:l=>{const u=l.d;l.s==="ok"?t.resolve(u):t.reject(u)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,n,r){this.initConnection_();const s=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+s),this.listens.has(l)||this.listens.set(l,new Map),Kt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Kt(!this.listens.get(l).has(s),"listen() called twice for same path/queryId.");const u={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(l).set(s,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const s={p:n},l="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(l,s,u=>{const h=u.d,f=u.s;Kc.warnOnListenWarnings_(h,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",u),f!=="ok"&&this.removeListen_(n,r),e.onComplete&&e.onComplete(f,h))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&lc(e,"w")){const n=up(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Zo(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||s6(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=KE)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=r6(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(t,n,r=>{const s=r.s,l=r.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Kt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const s={p:e},l="n";r&&(s.q=n,s.t=r),this.sendRequest(l,s)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const s={p:t,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,l=>{r&&setTimeout(()=>{r(l.s,l.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,s){this.initConnection_();const l={p:t,d:n};s!==void 0&&(l.h=s),this.outstandingPuts_.push({action:e,request:l,onComplete:r}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,n=>{if(n.s!=="ok"){const s=n.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ma(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):_x("Unrecognized action received from server: "+Ma(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Kt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=bg,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=bg,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Mz&&(this.reconnectDelay_=bg),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Oz)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Kc.nextConnectionId_++,s=this.lastSessionId;let l=!1,u=null;const h=function(){u?u.close():(l=!0,n())},f=function(g){Kt(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(g)};this.realtime_={close:h,sendRequest:f};const x=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[g,w]=await Promise.all([this.authTokenProvider_.getToken(x),this.appCheckTokenProvider_.getToken(x)]);l?_o("getToken() completed but was canceled"):(_o("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=w&&w.token,u=new kz(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,A=>{Zo(A+" ("+this.repoInfo_.toString()+")"),this.interrupt(Fz)},s))}catch(g){this.log_("Failed to get token: "+g),l||(this.repoInfo_.nodeAdmin&&Zo(g),h())}}}interrupt(e){_o("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){_o("Resuming connection for reason: "+e),delete this.interruptReasons_[e],jb(this.interruptReasons_)&&(this.reconnectDelay_=bg,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;t?n=t.map(s=>hw(s)).join("$"):n="default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Hr(e).toString();let r;if(this.listens.has(n)){const s=this.listens.get(n);r=s.get(t),s.delete(t),s.size===0&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){_o("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=WE&&(this.reconnectDelay_=KE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){_o("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=WE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+bL.replace(/\./g,"-")]=1,l2()?e["framework.cordova"]=1:yC()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=h1.getInstance().currentlyOnline();return jb(this.interruptReasons_)&&e}}Kc.nextPersistentConnectionId_=0;Kc.nextConnectionId_=0;class Vi{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Vi(e,t)}}class uv{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Vi(Ap,e),r=new Vi(Ap,t);return this.compare(n,r)!==0}minPost(){return Vi.MIN}}let Hy;class HL extends uv{static get __EMPTY_NODE(){return Hy}static set __EMPTY_NODE(e){Hy=e}compare(e,t){return hf(e.name,t.name)}isDefinedOn(e){throw Np("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Vi.MIN}maxPost(){return new Vi(tf,Hy)}makePost(e,t){return Kt(typeof e=="string","KeyIndex indexValue must always be a string."),new Vi(e,Hy)}toString(){return".key"}}const ip=new HL;class Ky{constructor(e,t,n,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(e=e,l=t?n(e.key,t):1,r&&(l*=-1),l<0)this.isReverse_?e=e.left:e=e.right;else if(l===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Qa{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=n??Qa.RED,this.left=r??pl.EMPTY_NODE,this.right=s??pl.EMPTY_NODE}copy(e,t,n,r,s){return new Qa(e??this.key,t??this.value,n??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(e,t,n),null):s===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return pl.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),t(e,n.key)===0){if(n.right.isEmpty())return pl.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Qa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Qa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Qa.RED=!0;Qa.BLACK=!1;class jz{copy(e,t,n,r,s){return this}insert(e,t,n){return new Qa(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class pl{constructor(e,t=pl.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new pl(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Qa.BLACK,null,null))}remove(e){return new pl(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Qa.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),t===0)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();)if(t=this.comparator_(e,n.key),t===0){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else t<0?n=n.left:t>0&&(r=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ky(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ky(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ky(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ky(this.root_,null,this.comparator_,!0,e)}}pl.EMPTY_NODE=new jz;function Vz(i,e){return hf(i.name,e.name)}function vw(i,e){return hf(i,e)}let xx;function zz(i){xx=i}const KL=function(i){return typeof i=="number"?"number:"+TL(i):"string:"+i},WL=function(i){if(i.isLeafNode()){const e=i.val();Kt(typeof e=="string"||typeof e=="number"||typeof e=="object"&&lc(e,".sv"),"Priority must be a string or number.")}else Kt(i===xx||i.isEmpty(),"priority of unexpected type.");Kt(i===xx||i.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let qE;class Xa{static set __childrenNodeConstructor(e){qE=e}static get __childrenNodeConstructor(){return qE}constructor(e,t=Xa.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Kt(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),WL(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Xa(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Xa.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Wi(e)?this:ji(e)===".priority"?this.priorityNode_:Xa.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Xa.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=ji(e);return n===null?t:t.isEmpty()&&n!==".priority"?this:(Kt(n!==".priority"||id(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,Xa.__childrenNodeConstructor.EMPTY_NODE.updateChild(as(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+KL(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=TL(this.value_):e+=this.value_,this.lazyHash_=wL(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Xa.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Xa.__childrenNodeConstructor?-1:(Kt(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Xa.VALUE_TYPE_ORDER.indexOf(t),s=Xa.VALUE_TYPE_ORDER.indexOf(n);return Kt(r>=0,"Unknown leaf type: "+t),Kt(s>=0,"Unknown leaf type: "+n),r===s?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Xa.VALUE_TYPE_ORDER=["object","boolean","number","string"];let qL,YL;function Uz(i){qL=i}function Bz(i){YL=i}class $z extends uv{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),s=n.compareTo(r);return s===0?hf(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Vi.MIN}maxPost(){return new Vi(tf,new Xa("[PRIORITY-POST]",YL))}makePost(e,t){const n=qL(e);return new Vi(t,new Xa("[PRIORITY-POST]",n))}toString(){return".priority"}}const Qs=new $z;const Gz=Math.log(2);class Hz{constructor(e){const t=s=>parseInt(Math.log(s)/Gz,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=n(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const d1=function(i,e,t,n){i.sort(e);const r=function(h,f){const x=f-h;let g,w;if(x===0)return null;if(x===1)return g=i[h],w=t?t(g):g,new Qa(w,g.node,Qa.BLACK,null,null);{const A=parseInt(x/2,10)+h,B=r(h,A),$=r(A+1,f);return g=i[A],w=t?t(g):g,new Qa(w,g.node,Qa.BLACK,B,$)}},s=function(h){let f=null,x=null,g=i.length;const w=function(B,$){const W=g-B,q=g;g-=B;const ge=r(W+1,q),he=i[W],me=t?t(he):he;A(new Qa(me,he.node,$,null,ge))},A=function(B){f?(f.left=B,f=B):(x=B,f=B)};for(let B=0;B<h.count;++B){const $=h.nextBitIsOne(),W=Math.pow(2,h.count-(B+1));$?w(W,Qa.BLACK):(w(W,Qa.BLACK),w(W,Qa.RED))}return x},l=new Hz(i.length),u=s(l);return new pl(n||e,u)};let nb;const Mf={};class Bc{static get Default(){return Kt(Mf&&Qs,"ChildrenNode.ts has not been loaded"),nb=nb||new Bc({".priority":Mf},{".priority":Qs}),nb}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=up(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof pl?t:null}hasIndex(e){return lc(this.indexSet_,e.toString())}addIndex(e,t){Kt(e!==ip,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const s=t.getIterator(Vi.Wrap);let l=s.getNext();for(;l;)r=r||e.isDefinedOn(l.node),n.push(l),l=s.getNext();let u;r?u=d1(n,e.getCompare()):u=Mf;const h=e.toString(),f={...this.indexSet_};f[h]=e;const x={...this.indexes_};return x[h]=u,new Bc(x,f)}addToIndexes(e,t){const n=V0(this.indexes_,(r,s)=>{const l=up(this.indexSet_,s);if(Kt(l,"Missing index implementation for "+s),r===Mf)if(l.isDefinedOn(e.node)){const u=[],h=t.getIterator(Vi.Wrap);let f=h.getNext();for(;f;)f.name!==e.name&&u.push(f),f=h.getNext();return u.push(e),d1(u,l.getCompare())}else return Mf;else{const u=t.get(e.name);let h=r;return u&&(h=h.remove(new Vi(e.name,u))),h.insert(e,e.node)}});return new Bc(n,this.indexSet_)}removeFromIndexes(e,t){const n=V0(this.indexes_,r=>{if(r===Mf)return r;{const s=t.get(e.name);return s?r.remove(new Vi(e.name,s)):r}});return new Bc(n,this.indexSet_)}}let xg;class ni{static get EMPTY_NODE(){return xg||(xg=new ni(new pl(vw),null,Bc.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&WL(this.priorityNode_),this.children_.isEmpty()&&Kt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xg}updatePriority(e){return this.children_.isEmpty()?this:new ni(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?xg:t}}getChild(e){const t=ji(e);return t===null?this:this.getImmediateChild(t).getChild(as(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(Kt(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const n=new Vi(e,t);let r,s;t.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(n,this.children_));const l=r.isEmpty()?xg:this.priorityNode_;return new ni(r,l,s)}}updateChild(e,t){const n=ji(e);if(n===null)return t;{Kt(ji(e)!==".priority"||id(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(as(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,s=!0;if(this.forEachChild(Qs,(l,u)=>{t[l]=u.val(e),n++,s&&ni.INTEGER_REGEXP_.test(l)?r=Math.max(r,Number(l)):s=!1}),!e&&s&&r<2*n){const l=[];for(const u in t)l[u]=t[u];return l}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+KL(this.getPriority().val())+":"),this.forEachChild(Qs,(t,n)=>{const r=n.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":wL(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const s=r.getPredecessorKey(new Vi(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const n=t.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Vi(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const n=t.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Vi(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Vi.Wrap);let s=r.peek();for(;s!=null&&t.compare(s,e)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Vi.Wrap);let s=r.peek();for(;s!=null&&t.compare(s,e)>0;)r.getNext(),s=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xm?-1:0}withIndex(e){if(e===ip||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ni(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===ip||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const n=this.getIterator(Qs),r=t.getIterator(Qs);let s=n.getNext(),l=r.getNext();for(;s&&l;){if(s.name!==l.name||!s.node.equals(l.node))return!1;s=n.getNext(),l=r.getNext()}return s===null&&l===null}else return!1;else return!1}}resolveIndex_(e){return e===ip?null:this.indexMap_.get(e.toString())}}ni.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Kz extends ni{constructor(){super(new pl(vw),ni.EMPTY_NODE,Bc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ni.EMPTY_NODE}isEmpty(){return!1}}const Xm=new Kz;Object.defineProperties(Vi,{MIN:{value:new Vi(Ap,ni.EMPTY_NODE)},MAX:{value:new Vi(tf,Xm)}});HL.__EMPTY_NODE=ni.EMPTY_NODE;Xa.__childrenNodeConstructor=ni;zz(Xm);Bz(Xm);const Wz=!0;function Oa(i,e=null){if(i===null)return ni.EMPTY_NODE;if(typeof i=="object"&&".priority"in i&&(e=i[".priority"]),Kt(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof i=="object"&&".value"in i&&i[".value"]!==null&&(i=i[".value"]),typeof i!="object"||".sv"in i){const t=i;return new Xa(t,Oa(e))}if(!(i instanceof Array)&&Wz){const t=[];let n=!1;if(xo(i,(l,u)=>{if(l.substring(0,1)!=="."){const h=Oa(u);h.isEmpty()||(n=n||!h.getPriority().isEmpty(),t.push(new Vi(l,h)))}}),t.length===0)return ni.EMPTY_NODE;const s=d1(t,Vz,l=>l.name,vw);if(n){const l=d1(t,Qs.getCompare());return new ni(s,Oa(e),new Bc({".priority":l},{".priority":Qs}))}else return new ni(s,Oa(e),Bc.Default)}else{let t=ni.EMPTY_NODE;return xo(i,(n,r)=>{if(lc(i,n)&&n.substring(0,1)!=="."){const s=Oa(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(n,s))}}),t.updatePriority(Oa(e))}}Uz(Oa);class qz extends uv{constructor(e){super(),this.indexPath_=e,Kt(!Wi(e)&&ji(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),s=n.compareTo(r);return s===0?hf(e.name,t.name):s}makePost(e,t){const n=Oa(e),r=ni.EMPTY_NODE.updateChild(this.indexPath_,n);return new Vi(t,r)}maxPost(){const e=ni.EMPTY_NODE.updateChild(this.indexPath_,Xm);return new Vi(tf,e)}toString(){return xm(this.indexPath_,0).join("/")}}class Yz extends uv{compare(e,t){const n=e.node.compareTo(t.node);return n===0?hf(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Vi.MIN}maxPost(){return Vi.MAX}makePost(e,t){const n=Oa(e);return new Vi(t,n)}toString(){return".value"}}const Xz=new Yz;function XL(i){return{type:"value",snapshotNode:i}}function Ep(i,e){return{type:"child_added",snapshotNode:e,childName:i}}function wm(i,e){return{type:"child_removed",snapshotNode:e,childName:i}}function Sm(i,e,t){return{type:"child_changed",snapshotNode:e,childName:i,oldSnap:t}}function Jz(i,e){return{type:"child_moved",snapshotNode:e,childName:i}}class _w{constructor(e){this.index_=e}updateChild(e,t,n,r,s,l){Kt(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(t);return u.getChild(r).equals(n.getChild(r))&&u.isEmpty()===n.isEmpty()||(l!=null&&(n.isEmpty()?e.hasChild(t)?l.trackChildChange(wm(t,u)):Kt(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?l.trackChildChange(Ep(t,n)):l.trackChildChange(Sm(t,n,u))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(t,n).withIndex(this.index_)}updateFullNode(e,t,n){return n!=null&&(e.isLeafNode()||e.forEachChild(Qs,(r,s)=>{t.hasChild(r)||n.trackChildChange(wm(r,s))}),t.isLeafNode()||t.forEachChild(Qs,(r,s)=>{if(e.hasChild(r)){const l=e.getImmediateChild(r);l.equals(s)||n.trackChildChange(Sm(r,s,l))}else n.trackChildChange(Ep(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ni.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Tm{constructor(e){this.indexedFilter_=new _w(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Tm.getStartPost_(e),this.endPost_=Tm.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,s,l){return this.matches(new Vi(t,n))||(n=ni.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,s,l)}updateFullNode(e,t,n){t.isLeafNode()&&(t=ni.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(ni.EMPTY_NODE);const s=this;return t.forEachChild(Qs,(l,u)=>{s.matches(new Vi(l,u))||(r=r.updateImmediateChild(l,ni.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}class Qz{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=t=>{const n=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new Tm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,s,l){return this.rangedFilter_.matches(new Vi(t,n))||(n=ni.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,s,l):this.fullLimitUpdateChild_(e,t,n,s,l)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=ni.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=ni.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;s.hasNext()&&l<this.limit_;){const u=s.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))r=r.updateImmediateChild(u.name,u.node),l++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(ni.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let l=0;for(;s.hasNext();){const u=s.getNext();l<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?l++:r=r.updateImmediateChild(u.name,ni.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,s){let l;if(this.reverse_){const g=this.index_.getCompare();l=(w,A)=>g(A,w)}else l=this.index_.getCompare();const u=e;Kt(u.numChildren()===this.limit_,"");const h=new Vi(t,n),f=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),x=this.rangedFilter_.matches(h);if(u.hasChild(t)){const g=u.getImmediateChild(t);let w=r.getChildAfterChild(this.index_,f,this.reverse_);for(;w!=null&&(w.name===t||u.hasChild(w.name));)w=r.getChildAfterChild(this.index_,w,this.reverse_);const A=w==null?1:l(w,h);if(x&&!n.isEmpty()&&A>=0)return s?.trackChildChange(Sm(t,n,g)),u.updateImmediateChild(t,n);{s?.trackChildChange(wm(t,g));const $=u.updateImmediateChild(t,ni.EMPTY_NODE);return w!=null&&this.rangedFilter_.matches(w)?(s?.trackChildChange(Ep(w.name,w.node)),$.updateImmediateChild(w.name,w.node)):$}}else return n.isEmpty()?e:x&&l(f,h)>=0?(s!=null&&(s.trackChildChange(wm(f.name,f.node)),s.trackChildChange(Ep(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(f.name,ni.EMPTY_NODE)):e}}class bw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qs}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Kt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Kt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ap}hasEnd(){return this.endSet_}getIndexEndValue(){return Kt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Kt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:tf}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Kt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Qs}copy(){const e=new bw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Zz(i){return i.loadsAllData()?new _w(i.getIndex()):i.hasLimit()?new Qz(i):new Tm(i)}function YE(i){const e={};if(i.isDefault())return e;let t;if(i.index_===Qs?t="$priority":i.index_===Xz?t="$value":i.index_===ip?t="$key":(Kt(i.index_ instanceof qz,"Unrecognized index type!"),t=i.index_.toString()),e.orderBy=Ma(t),i.startSet_){const n=i.startAfterSet_?"startAfter":"startAt";e[n]=Ma(i.indexStartValue_),i.startNameSet_&&(e[n]+=","+Ma(i.indexStartName_))}if(i.endSet_){const n=i.endBeforeSet_?"endBefore":"endAt";e[n]=Ma(i.indexEndValue_),i.endNameSet_&&(e[n]+=","+Ma(i.indexEndName_))}return i.limitSet_&&(i.isViewFromLeft()?e.limitToFirst=i.limit_:e.limitToLast=i.limit_),e}function XE(i){const e={};if(i.startSet_&&(e.sp=i.indexStartValue_,i.startNameSet_&&(e.sn=i.indexStartName_),e.sin=!i.startAfterSet_),i.endSet_&&(e.ep=i.indexEndValue_,i.endNameSet_&&(e.en=i.indexEndName_),e.ein=!i.endBeforeSet_),i.limitSet_){e.l=i.limit_;let t=i.viewFrom_;t===""&&(i.isViewFromLeft()?t="l":t="r"),e.vf=t}return i.index_!==Qs&&(e.i=i.index_.toString()),e}class f1 extends UL{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Kt(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Ym("p:rest:"),this.listens_={}}listen(e,t,n,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const l=f1.getListenId_(e,n),u={};this.listens_[l]=u;const h=YE(e._queryParams);this.restRequest_(s+".json",h,(f,x)=>{let g=x;if(f===404&&(g=null,f=null),f===null&&this.onDataUpdate_(s,g,!1,n),up(this.listens_,l)===u){let w;f?f===401?w="permission_denied":w="rest_error:"+f:w="ok",r(w,null)}})}unlisten(e,t){const n=f1.getListenId_(e,t);delete this.listens_[n]}get(e){const t=YE(e._queryParams),n=e._path.toString(),r=new Nm;return this.restRequest_(n+".json",t,(s,l)=>{let u=l;s===404&&(u=null,s=null),s===null?(this.onDataUpdate_(n,u,!1,null),r.resolve(u)):r.reject(new Error(u))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Pp(t);this.log_("Sending REST request for "+l);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(n&&u.readyState===4){this.log_("REST Response for "+l+" received. status:",u.status,"response:",u.responseText);let h=null;if(u.status>=200&&u.status<300){try{h=im(u.responseText)}catch{Zo("Failed to parse JSON response for "+l+": "+u.responseText)}n(null,h)}else u.status!==401&&u.status!==404&&Zo("Got unsuccessful REST response for "+l+" Status: "+u.status),n(u.status);n=null}},u.open("GET",l,!0),u.send()})}}class eU{constructor(){this.rootNode_=ni.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function p1(){return{value:null,children:new Map}}function JL(i,e,t){if(Wi(e))i.value=t,i.children.clear();else if(i.value!==null)i.value=i.value.updateChild(e,t);else{const n=ji(e);i.children.has(n)||i.children.set(n,p1());const r=i.children.get(n);e=as(e),JL(r,e,t)}}function wx(i,e,t){i.value!==null?t(e,i.value):tU(i,(n,r)=>{const s=new Hr(e.toString()+"/"+n);wx(r,s,t)})}function tU(i,e){i.children.forEach((t,n)=>{e(n,t)})}class nU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&xo(this.last_,(n,r)=>{t[n]=t[n]-r}),this.last_=e,t}}const JE=10*1e3,iU=30*1e3,rU=300*1e3;class sU{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new nU(e);const n=JE+(iU-JE)*Math.random();Yg(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;xo(e,(r,s)=>{s>0&&lc(this.statsToReport_,r)&&(t[r]=s,n=!0)}),n&&this.server_.reportStats(t),Yg(this.reportStats_.bind(this),Math.floor(Math.random()*2*rU))}}var Ru;(function(i){i[i.OVERWRITE=0]="OVERWRITE",i[i.MERGE=1]="MERGE",i[i.ACK_USER_WRITE=2]="ACK_USER_WRITE",i[i.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ru||(Ru={}));function xw(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ww(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Sw(i){return{fromUser:!1,fromServer:!0,queryId:i,tagged:!0}}class g1{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Ru.ACK_USER_WRITE,this.source=xw()}operationForChild(e){if(Wi(this.path)){if(this.affectedTree.value!=null)return Kt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Hr(e));return new g1(yr(),t,this.revert)}}else return Kt(ji(this.path)===e,"operationForChild called for unrelated child."),new g1(as(this.path),this.affectedTree,this.revert)}}class Am{constructor(e,t){this.source=e,this.path=t,this.type=Ru.LISTEN_COMPLETE}operationForChild(e){return Wi(this.path)?new Am(this.source,yr()):new Am(this.source,as(this.path))}}class nf{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Ru.OVERWRITE}operationForChild(e){return Wi(this.path)?new nf(this.source,yr(),this.snap.getImmediateChild(e)):new nf(this.source,as(this.path),this.snap)}}class Ip{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Ru.MERGE}operationForChild(e){if(Wi(this.path)){const t=this.children.subtree(new Hr(e));return t.isEmpty()?null:t.value?new nf(this.source,yr(),t.value):new Ip(this.source,yr(),t)}else return Kt(ji(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ip(this.source,as(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class rd{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Wi(e))return this.isFullyInitialized()&&!this.filtered_;const t=ji(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class aU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function oU(i,e,t,n){const r=[],s=[];return e.forEach(l=>{l.type==="child_changed"&&i.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&s.push(Jz(l.childName,l.snapshotNode))}),wg(i,r,"child_removed",e,n,t),wg(i,r,"child_added",e,n,t),wg(i,r,"child_moved",s,n,t),wg(i,r,"child_changed",e,n,t),wg(i,r,"value",e,n,t),r}function wg(i,e,t,n,r,s){const l=n.filter(u=>u.type===t);l.sort((u,h)=>uU(i,u,h)),l.forEach(u=>{const h=lU(i,u,s);r.forEach(f=>{f.respondsTo(u.type)&&e.push(f.createEvent(h,i.query_))})})}function lU(i,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,i.index_)),e}function uU(i,e,t){if(e.childName==null||t.childName==null)throw Np("Should only compare child_ events.");const n=new Vi(e.childName,e.snapshotNode),r=new Vi(t.childName,t.snapshotNode);return i.index_.compare(n,r)}function cv(i,e){return{eventCache:i,serverCache:e}}function Xg(i,e,t,n){return cv(new rd(e,t,n),i.serverCache)}function QL(i,e,t,n){return cv(i.eventCache,new rd(e,t,n))}function m1(i){return i.eventCache.isFullyInitialized()?i.eventCache.getNode():null}function rf(i){return i.serverCache.isFullyInitialized()?i.serverCache.getNode():null}let ib;const cU=()=>(ib||(ib=new pl(q9)),ib);class ss{static fromObject(e){let t=new ss(null);return xo(e,(n,r)=>{t=t.set(new Hr(n),r)}),t}constructor(e,t=cU()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:yr(),value:this.value};if(Wi(e))return null;{const n=ji(e),r=this.children.get(n);if(r!==null){const s=r.findRootMostMatchingPathAndValue(as(e),t);return s!=null?{path:Js(new Hr(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Wi(e))return this;{const t=ji(e),n=this.children.get(t);return n!==null?n.subtree(as(e)):new ss(null)}}set(e,t){if(Wi(e))return new ss(t,this.children);{const n=ji(e),s=(this.children.get(n)||new ss(null)).set(as(e),t),l=this.children.insert(n,s);return new ss(this.value,l)}}remove(e){if(Wi(e))return this.children.isEmpty()?new ss(null):new ss(null,this.children);{const t=ji(e),n=this.children.get(t);if(n){const r=n.remove(as(e));let s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new ss(null):new ss(this.value,s)}else return this}}get(e){if(Wi(e))return this.value;{const t=ji(e),n=this.children.get(t);return n?n.get(as(e)):null}}setTree(e,t){if(Wi(e))return t;{const n=ji(e),s=(this.children.get(n)||new ss(null)).setTree(as(e),t);let l;return s.isEmpty()?l=this.children.remove(n):l=this.children.insert(n,s),new ss(this.value,l)}}fold(e){return this.fold_(yr(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((r,s)=>{n[r]=s.fold_(Js(e,r),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,yr(),t)}findOnPath_(e,t,n){const r=this.value?n(t,this.value):!1;if(r)return r;if(Wi(e))return null;{const s=ji(e),l=this.children.get(s);return l?l.findOnPath_(as(e),Js(t,s),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,yr(),t)}foreachOnPath_(e,t,n){if(Wi(e))return this;{this.value&&n(t,this.value);const r=ji(e),s=this.children.get(r);return s?s.foreachOnPath_(as(e),Js(t,r),n):new ss(null)}}foreach(e){this.foreach_(yr(),e)}foreach_(e,t){this.children.inorderTraversal((n,r)=>{r.foreach_(Js(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class Du{constructor(e){this.writeTree_=e}static empty(){return new Du(new ss(null))}}function Jg(i,e,t){if(Wi(e))return new Du(new ss(t));{const n=i.writeTree_.findRootMostValueAndPath(e);if(n!=null){const r=n.path;let s=n.value;const l=Jo(r,e);return s=s.updateChild(l,t),new Du(i.writeTree_.set(r,s))}else{const r=new ss(t),s=i.writeTree_.setTree(e,r);return new Du(s)}}}function Sx(i,e,t){let n=i;return xo(t,(r,s)=>{n=Jg(n,Js(e,r),s)}),n}function QE(i,e){if(Wi(e))return Du.empty();{const t=i.writeTree_.setTree(e,new ss(null));return new Du(t)}}function Tx(i,e){return df(i,e)!=null}function df(i,e){const t=i.writeTree_.findRootMostValueAndPath(e);return t!=null?i.writeTree_.get(t.path).getChild(Jo(t.path,e)):null}function ZE(i){const e=[],t=i.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Qs,(n,r)=>{e.push(new Vi(n,r))}):i.writeTree_.children.inorderTraversal((n,r)=>{r.value!=null&&e.push(new Vi(n,r.value))}),e}function qh(i,e){if(Wi(e))return i;{const t=df(i,e);return t!=null?new Du(new ss(t)):new Du(i.writeTree_.subtree(e))}}function Ax(i){return i.writeTree_.isEmpty()}function kp(i,e){return ZL(yr(),i.writeTree_,e)}function ZL(i,e,t){if(e.value!=null)return t.updateChild(i,e.value);{let n=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(Kt(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):t=ZL(Js(i,r),s,t)}),!t.getChild(i).isEmpty()&&n!==null&&(t=t.updateChild(Js(i,".priority"),n)),t}}function hv(i,e){return i4(e,i)}function hU(i,e,t,n,r){Kt(n>i.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),i.allWrites.push({path:e,snap:t,writeId:n,visible:r}),r&&(i.visibleWrites=Jg(i.visibleWrites,e,t)),i.lastWriteId=n}function dU(i,e,t,n){Kt(n>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:e,children:t,writeId:n,visible:!0}),i.visibleWrites=Sx(i.visibleWrites,e,t),i.lastWriteId=n}function fU(i,e){for(let t=0;t<i.allWrites.length;t++){const n=i.allWrites[t];if(n.writeId===e)return n}return null}function pU(i,e){const t=i.allWrites.findIndex(u=>u.writeId===e);Kt(t>=0,"removeWrite called with nonexistent writeId.");const n=i.allWrites[t];i.allWrites.splice(t,1);let r=n.visible,s=!1,l=i.allWrites.length-1;for(;r&&l>=0;){const u=i.allWrites[l];u.visible&&(l>=t&&gU(u,n.path)?r=!1:su(n.path,u.path)&&(s=!0)),l--}if(r){if(s)return mU(i),!0;if(n.snap)i.visibleWrites=QE(i.visibleWrites,n.path);else{const u=n.children;xo(u,h=>{i.visibleWrites=QE(i.visibleWrites,Js(n.path,h))})}return!0}else return!1}function gU(i,e){if(i.snap)return su(i.path,e);for(const t in i.children)if(i.children.hasOwnProperty(t)&&su(Js(i.path,t),e))return!0;return!1}function mU(i){i.visibleWrites=e4(i.allWrites,yU,yr()),i.allWrites.length>0?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1}function yU(i){return i.visible}function e4(i,e,t){let n=Du.empty();for(let r=0;r<i.length;++r){const s=i[r];if(e(s)){const l=s.path;let u;if(s.snap)su(t,l)?(u=Jo(t,l),n=Jg(n,u,s.snap)):su(l,t)&&(u=Jo(l,t),n=Jg(n,yr(),s.snap.getChild(u)));else if(s.children){if(su(t,l))u=Jo(t,l),n=Sx(n,u,s.children);else if(su(l,t))if(u=Jo(l,t),Wi(u))n=Sx(n,yr(),s.children);else{const h=up(s.children,ji(u));if(h){const f=h.getChild(as(u));n=Jg(n,yr(),f)}}}else throw Np("WriteRecord should have .snap or .children")}}return n}function t4(i,e,t,n,r){if(!n&&!r){const s=df(i.visibleWrites,e);if(s!=null)return s;{const l=qh(i.visibleWrites,e);if(Ax(l))return t;if(t==null&&!Tx(l,yr()))return null;{const u=t||ni.EMPTY_NODE;return kp(l,u)}}}else{const s=qh(i.visibleWrites,e);if(!r&&Ax(s))return t;if(!r&&t==null&&!Tx(s,yr()))return null;{const l=function(f){return(f.visible||r)&&(!n||!~n.indexOf(f.writeId))&&(su(f.path,e)||su(e,f.path))},u=e4(i.allWrites,l,e),h=t||ni.EMPTY_NODE;return kp(u,h)}}}function vU(i,e,t){let n=ni.EMPTY_NODE;const r=df(i.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Qs,(s,l)=>{n=n.updateImmediateChild(s,l)}),n;if(t){const s=qh(i.visibleWrites,e);return t.forEachChild(Qs,(l,u)=>{const h=kp(qh(s,new Hr(l)),u);n=n.updateImmediateChild(l,h)}),ZE(s).forEach(l=>{n=n.updateImmediateChild(l.name,l.node)}),n}else{const s=qh(i.visibleWrites,e);return ZE(s).forEach(l=>{n=n.updateImmediateChild(l.name,l.node)}),n}}function _U(i,e,t,n,r){Kt(n||r,"Either existingEventSnap or existingServerSnap must exist");const s=Js(e,t);if(Tx(i.visibleWrites,s))return null;{const l=qh(i.visibleWrites,s);return Ax(l)?r.getChild(t):kp(l,r.getChild(t))}}function bU(i,e,t,n){const r=Js(e,t),s=df(i.visibleWrites,r);if(s!=null)return s;if(n.isCompleteForChild(t)){const l=qh(i.visibleWrites,r);return kp(l,n.getNode().getImmediateChild(t))}else return null}function xU(i,e){return df(i.visibleWrites,e)}function wU(i,e,t,n,r,s,l){let u;const h=qh(i.visibleWrites,e),f=df(h,yr());if(f!=null)u=f;else if(t!=null)u=kp(h,t);else return[];if(u=u.withIndex(l),!u.isEmpty()&&!u.isLeafNode()){const x=[],g=l.getCompare(),w=s?u.getReverseIteratorFrom(n,l):u.getIteratorFrom(n,l);let A=w.getNext();for(;A&&x.length<r;)g(A,n)!==0&&x.push(A),A=w.getNext();return x}else return[]}function SU(){return{visibleWrites:Du.empty(),allWrites:[],lastWriteId:-1}}function y1(i,e,t,n){return t4(i.writeTree,i.treePath,e,t,n)}function Tw(i,e){return vU(i.writeTree,i.treePath,e)}function eI(i,e,t,n){return _U(i.writeTree,i.treePath,e,t,n)}function v1(i,e){return xU(i.writeTree,Js(i.treePath,e))}function TU(i,e,t,n,r,s){return wU(i.writeTree,i.treePath,e,t,n,r,s)}function Aw(i,e,t){return bU(i.writeTree,i.treePath,e,t)}function n4(i,e){return i4(Js(i.treePath,e),i.writeTree)}function i4(i,e){return{treePath:i,writeTree:e}}class AU{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Kt(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Kt(n!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(n,Sm(n,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(n,wm(n,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(n,Ep(n,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(n,Sm(n,e.snapshotNode,r.oldSnap));else throw Np("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}class EU{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}}const r4=new EU;class Ew{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new rd(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Aw(this.writes_,e,n)}}getChildAfterChild(e,t,n){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:rf(this.viewCache_),s=TU(this.writes_,r,t,1,n,e);return s.length===0?null:s[0]}}function IU(i){return{filter:i}}function kU(i,e){Kt(e.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),Kt(e.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed")}function CU(i,e,t,n,r){const s=new AU;let l,u;if(t.type===Ru.OVERWRITE){const f=t;f.source.fromUser?l=Ex(i,e,f.path,f.snap,n,r,s):(Kt(f.source.fromServer,"Unknown source."),u=f.source.tagged||e.serverCache.isFiltered()&&!Wi(f.path),l=_1(i,e,f.path,f.snap,n,r,u,s))}else if(t.type===Ru.MERGE){const f=t;f.source.fromUser?l=LU(i,e,f.path,f.children,n,r,s):(Kt(f.source.fromServer,"Unknown source."),u=f.source.tagged||e.serverCache.isFiltered(),l=Ix(i,e,f.path,f.children,n,r,u,s))}else if(t.type===Ru.ACK_USER_WRITE){const f=t;f.revert?l=PU(i,e,f.path,n,r,s):l=DU(i,e,f.path,f.affectedTree,n,r,s)}else if(t.type===Ru.LISTEN_COMPLETE)l=NU(i,e,t.path,n,s);else throw Np("Unknown operation type: "+t.type);const h=s.getChanges();return RU(e,l,h),{viewCache:l,changes:h}}function RU(i,e,t){const n=e.eventCache;if(n.isFullyInitialized()){const r=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=m1(i);(t.length>0||!i.eventCache.isFullyInitialized()||r&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&t.push(XL(m1(e)))}}function s4(i,e,t,n,r,s){const l=e.eventCache;if(v1(n,t)!=null)return e;{let u,h;if(Wi(t))if(Kt(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const f=rf(e),x=f instanceof ni?f:ni.EMPTY_NODE,g=Tw(n,x);u=i.filter.updateFullNode(e.eventCache.getNode(),g,s)}else{const f=y1(n,rf(e));u=i.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const f=ji(t);if(f===".priority"){Kt(id(t)===1,"Can't have a priority with additional path components");const x=l.getNode();h=e.serverCache.getNode();const g=eI(n,t,x,h);g!=null?u=i.filter.updatePriority(x,g):u=l.getNode()}else{const x=as(t);let g;if(l.isCompleteForChild(f)){h=e.serverCache.getNode();const w=eI(n,t,l.getNode(),h);w!=null?g=l.getNode().getImmediateChild(f).updateChild(x,w):g=l.getNode().getImmediateChild(f)}else g=Aw(n,f,e.serverCache);g!=null?u=i.filter.updateChild(l.getNode(),f,g,x,r,s):u=l.getNode()}}return Xg(e,u,l.isFullyInitialized()||Wi(t),i.filter.filtersNodes())}}function _1(i,e,t,n,r,s,l,u){const h=e.serverCache;let f;const x=l?i.filter:i.filter.getIndexedFilter();if(Wi(t))f=x.updateFullNode(h.getNode(),n,null);else if(x.filtersNodes()&&!h.isFiltered()){const A=h.getNode().updateChild(t,n);f=x.updateFullNode(h.getNode(),A,null)}else{const A=ji(t);if(!h.isCompleteForPath(t)&&id(t)>1)return e;const B=as(t),W=h.getNode().getImmediateChild(A).updateChild(B,n);A===".priority"?f=x.updatePriority(h.getNode(),W):f=x.updateChild(h.getNode(),A,W,B,r4,null)}const g=QL(e,f,h.isFullyInitialized()||Wi(t),x.filtersNodes()),w=new Ew(r,g,s);return s4(i,g,t,r,w,u)}function Ex(i,e,t,n,r,s,l){const u=e.eventCache;let h,f;const x=new Ew(r,e,s);if(Wi(t))f=i.filter.updateFullNode(e.eventCache.getNode(),n,l),h=Xg(e,f,!0,i.filter.filtersNodes());else{const g=ji(t);if(g===".priority")f=i.filter.updatePriority(e.eventCache.getNode(),n),h=Xg(e,f,u.isFullyInitialized(),u.isFiltered());else{const w=as(t),A=u.getNode().getImmediateChild(g);let B;if(Wi(w))B=n;else{const $=x.getCompleteChild(g);$!=null?gw(w)===".priority"&&$.getChild($L(w)).isEmpty()?B=$:B=$.updateChild(w,n):B=ni.EMPTY_NODE}if(A.equals(B))h=e;else{const $=i.filter.updateChild(u.getNode(),g,B,w,x,l);h=Xg(e,$,u.isFullyInitialized(),i.filter.filtersNodes())}}}return h}function tI(i,e){return i.eventCache.isCompleteForChild(e)}function LU(i,e,t,n,r,s,l){let u=e;return n.foreach((h,f)=>{const x=Js(t,h);tI(e,ji(x))&&(u=Ex(i,u,x,f,r,s,l))}),n.foreach((h,f)=>{const x=Js(t,h);tI(e,ji(x))||(u=Ex(i,u,x,f,r,s,l))}),u}function nI(i,e,t){return t.foreach((n,r)=>{e=e.updateChild(n,r)}),e}function Ix(i,e,t,n,r,s,l,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,f;Wi(t)?f=n:f=new ss(null).setTree(t,n);const x=e.serverCache.getNode();return f.children.inorderTraversal((g,w)=>{if(x.hasChild(g)){const A=e.serverCache.getNode().getImmediateChild(g),B=nI(i,A,w);h=_1(i,h,new Hr(g),B,r,s,l,u)}}),f.children.inorderTraversal((g,w)=>{const A=!e.serverCache.isCompleteForChild(g)&&w.value===null;if(!x.hasChild(g)&&!A){const B=e.serverCache.getNode().getImmediateChild(g),$=nI(i,B,w);h=_1(i,h,new Hr(g),$,r,s,l,u)}}),h}function DU(i,e,t,n,r,s,l){if(v1(r,t)!=null)return e;const u=e.serverCache.isFiltered(),h=e.serverCache;if(n.value!=null){if(Wi(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return _1(i,e,t,h.getNode().getChild(t),r,s,u,l);if(Wi(t)){let f=new ss(null);return h.getNode().forEachChild(ip,(x,g)=>{f=f.set(new Hr(x),g)}),Ix(i,e,t,f,r,s,u,l)}else return e}else{let f=new ss(null);return n.foreach((x,g)=>{const w=Js(t,x);h.isCompleteForPath(w)&&(f=f.set(x,h.getNode().getChild(w)))}),Ix(i,e,t,f,r,s,u,l)}}function NU(i,e,t,n,r){const s=e.serverCache,l=QL(e,s.getNode(),s.isFullyInitialized()||Wi(t),s.isFiltered());return s4(i,l,t,n,r4,r)}function PU(i,e,t,n,r,s){let l;if(v1(n,t)!=null)return e;{const u=new Ew(n,e,r),h=e.eventCache.getNode();let f;if(Wi(t)||ji(t)===".priority"){let x;if(e.serverCache.isFullyInitialized())x=y1(n,rf(e));else{const g=e.serverCache.getNode();Kt(g instanceof ni,"serverChildren would be complete if leaf node"),x=Tw(n,g)}x=x,f=i.filter.updateFullNode(h,x,s)}else{const x=ji(t);let g=Aw(n,x,e.serverCache);g==null&&e.serverCache.isCompleteForChild(x)&&(g=h.getImmediateChild(x)),g!=null?f=i.filter.updateChild(h,x,g,as(t),u,s):e.eventCache.getNode().hasChild(x)?f=i.filter.updateChild(h,x,ni.EMPTY_NODE,as(t),u,s):f=h,f.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=y1(n,rf(e)),l.isLeafNode()&&(f=i.filter.updateFullNode(f,l,s)))}return l=e.serverCache.isFullyInitialized()||v1(n,yr())!=null,Xg(e,f,l,i.filter.filtersNodes())}}class OU{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new _w(n.getIndex()),s=Zz(n);this.processor_=IU(s);const l=t.serverCache,u=t.eventCache,h=r.updateFullNode(ni.EMPTY_NODE,l.getNode(),null),f=s.updateFullNode(ni.EMPTY_NODE,u.getNode(),null),x=new rd(h,l.isFullyInitialized(),r.filtersNodes()),g=new rd(f,u.isFullyInitialized(),s.filtersNodes());this.viewCache_=cv(g,x),this.eventGenerator_=new aU(this.query_)}get query(){return this.query_}}function MU(i){return i.viewCache_.serverCache.getNode()}function FU(i){return m1(i.viewCache_)}function jU(i,e){const t=rf(i.viewCache_);return t&&(i.query._queryParams.loadsAllData()||!Wi(e)&&!t.getImmediateChild(ji(e)).isEmpty())?t.getChild(e):null}function iI(i){return i.eventRegistrations_.length===0}function VU(i,e){i.eventRegistrations_.push(e)}function rI(i,e,t){const n=[];if(t){Kt(e==null,"A cancel should cancel all event registrations.");const r=i.query._path;i.eventRegistrations_.forEach(s=>{const l=s.createCancelEvent(t,r);l&&n.push(l)})}if(e){let r=[];for(let s=0;s<i.eventRegistrations_.length;++s){const l=i.eventRegistrations_[s];if(!l.matches(e))r.push(l);else if(e.hasAnyCallback()){r=r.concat(i.eventRegistrations_.slice(s+1));break}}i.eventRegistrations_=r}else i.eventRegistrations_=[];return n}function sI(i,e,t,n){e.type===Ru.MERGE&&e.source.queryId!==null&&(Kt(rf(i.viewCache_),"We should always have a full cache before handling merges"),Kt(m1(i.viewCache_),"Missing event cache, even though we have a server cache"));const r=i.viewCache_,s=CU(i.processor_,r,e,t,n);return kU(i.processor_,s.viewCache),Kt(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),i.viewCache_=s.viewCache,a4(i,s.changes,s.viewCache.eventCache.getNode(),null)}function zU(i,e){const t=i.viewCache_.eventCache,n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Qs,(s,l)=>{n.push(Ep(s,l))}),t.isFullyInitialized()&&n.push(XL(t.getNode())),a4(i,n,t.getNode(),e)}function a4(i,e,t,n){const r=n?[n]:i.eventRegistrations_;return oU(i.eventGenerator_,e,t,r)}let b1;class o4{constructor(){this.views=new Map}}function UU(i){Kt(!b1,"__referenceConstructor has already been defined"),b1=i}function BU(){return Kt(b1,"Reference.ts has not been loaded"),b1}function $U(i){return i.views.size===0}function Iw(i,e,t,n){const r=e.source.queryId;if(r!==null){const s=i.views.get(r);return Kt(s!=null,"SyncTree gave us an op for an invalid query."),sI(s,e,t,n)}else{let s=[];for(const l of i.views.values())s=s.concat(sI(l,e,t,n));return s}}function l4(i,e,t,n,r){const s=e._queryIdentifier,l=i.views.get(s);if(!l){let u=y1(t,r?n:null),h=!1;u?h=!0:n instanceof ni?(u=Tw(t,n),h=!1):(u=ni.EMPTY_NODE,h=!1);const f=cv(new rd(u,h,!1),new rd(n,r,!1));return new OU(e,f)}return l}function GU(i,e,t,n,r,s){const l=l4(i,e,n,r,s);return i.views.has(e._queryIdentifier)||i.views.set(e._queryIdentifier,l),VU(l,t),zU(l,t)}function HU(i,e,t,n){const r=e._queryIdentifier,s=[];let l=[];const u=sd(i);if(r==="default")for(const[h,f]of i.views.entries())l=l.concat(rI(f,t,n)),iI(f)&&(i.views.delete(h),f.query._queryParams.loadsAllData()||s.push(f.query));else{const h=i.views.get(r);h&&(l=l.concat(rI(h,t,n)),iI(h)&&(i.views.delete(r),h.query._queryParams.loadsAllData()||s.push(h.query)))}return u&&!sd(i)&&s.push(new(BU())(e._repo,e._path)),{removed:s,events:l}}function u4(i){const e=[];for(const t of i.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Yh(i,e){let t=null;for(const n of i.views.values())t=t||jU(n,e);return t}function c4(i,e){if(e._queryParams.loadsAllData())return dv(i);{const n=e._queryIdentifier;return i.views.get(n)}}function h4(i,e){return c4(i,e)!=null}function sd(i){return dv(i)!=null}function dv(i){for(const e of i.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let x1;function KU(i){Kt(!x1,"__referenceConstructor has already been defined"),x1=i}function WU(){return Kt(x1,"Reference.ts has not been loaded"),x1}let qU=1;class aI{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ss(null),this.pendingWriteTree_=SU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function d4(i,e,t,n,r){return hU(i.pendingWriteTree_,e,t,n,r),r?zp(i,new nf(xw(),e,t)):[]}function YU(i,e,t,n){dU(i.pendingWriteTree_,e,t,n);const r=ss.fromObject(t);return zp(i,new Ip(xw(),e,r))}function zh(i,e,t=!1){const n=fU(i.pendingWriteTree_,e);if(pU(i.pendingWriteTree_,e)){let s=new ss(null);return n.snap!=null?s=s.set(yr(),!0):xo(n.children,l=>{s=s.set(new Hr(l),!0)}),zp(i,new g1(n.path,s,t))}else return[]}function Jm(i,e,t){return zp(i,new nf(ww(),e,t))}function XU(i,e,t){const n=ss.fromObject(t);return zp(i,new Ip(ww(),e,n))}function JU(i,e){return zp(i,new Am(ww(),e))}function QU(i,e,t){const n=Cw(i,t);if(n){const r=Rw(n),s=r.path,l=r.queryId,u=Jo(s,e),h=new Am(Sw(l),u);return Lw(i,s,h)}else return[]}function w1(i,e,t,n,r=!1){const s=e._path,l=i.syncPointTree_.get(s);let u=[];if(l&&(e._queryIdentifier==="default"||h4(l,e))){const h=HU(l,e,t,n);$U(l)&&(i.syncPointTree_=i.syncPointTree_.remove(s));const f=h.removed;if(u=h.events,!r){const x=f.findIndex(w=>w._queryParams.loadsAllData())!==-1,g=i.syncPointTree_.findOnPath(s,(w,A)=>sd(A));if(x&&!g){const w=i.syncPointTree_.subtree(s);if(!w.isEmpty()){const A=tB(w);for(let B=0;B<A.length;++B){const $=A[B],W=$.query,q=m4(i,$);i.listenProvider_.startListening(Qg(W),Em(i,W),q.hashFn,q.onComplete)}}}!g&&f.length>0&&!n&&(x?i.listenProvider_.stopListening(Qg(e),null):f.forEach(w=>{const A=i.queryToTagMap.get(fv(w));i.listenProvider_.stopListening(Qg(w),A)}))}nB(i,f)}return u}function f4(i,e,t,n){const r=Cw(i,n);if(r!=null){const s=Rw(r),l=s.path,u=s.queryId,h=Jo(l,e),f=new nf(Sw(u),h,t);return Lw(i,l,f)}else return[]}function ZU(i,e,t,n){const r=Cw(i,n);if(r){const s=Rw(r),l=s.path,u=s.queryId,h=Jo(l,e),f=ss.fromObject(t),x=new Ip(Sw(u),h,f);return Lw(i,l,x)}else return[]}function kx(i,e,t,n=!1){const r=e._path;let s=null,l=!1;i.syncPointTree_.foreachOnPath(r,(w,A)=>{const B=Jo(w,r);s=s||Yh(A,B),l=l||sd(A)});let u=i.syncPointTree_.get(r);u?(l=l||sd(u),s=s||Yh(u,yr())):(u=new o4,i.syncPointTree_=i.syncPointTree_.set(r,u));let h;s!=null?h=!0:(h=!1,s=ni.EMPTY_NODE,i.syncPointTree_.subtree(r).foreachChild((A,B)=>{const $=Yh(B,yr());$&&(s=s.updateImmediateChild(A,$))}));const f=h4(u,e);if(!f&&!e._queryParams.loadsAllData()){const w=fv(e);Kt(!i.queryToTagMap.has(w),"View does not exist, but we have a tag");const A=iB();i.queryToTagMap.set(w,A),i.tagToQueryMap.set(A,w)}const x=hv(i.pendingWriteTree_,r);let g=GU(u,e,t,x,s,h);if(!f&&!l&&!n){const w=c4(u,e);g=g.concat(rB(i,e,w))}return g}function kw(i,e,t){const r=i.pendingWriteTree_,s=i.syncPointTree_.findOnPath(e,(l,u)=>{const h=Jo(l,e),f=Yh(u,h);if(f)return f});return t4(r,e,s,t,!0)}function eB(i,e){const t=e._path;let n=null;i.syncPointTree_.foreachOnPath(t,(f,x)=>{const g=Jo(f,t);n=n||Yh(x,g)});let r=i.syncPointTree_.get(t);r?n=n||Yh(r,yr()):(r=new o4,i.syncPointTree_=i.syncPointTree_.set(t,r));const s=n!=null,l=s?new rd(n,!0,!1):null,u=hv(i.pendingWriteTree_,e._path),h=l4(r,e,u,s?l.getNode():ni.EMPTY_NODE,s);return FU(h)}function zp(i,e){return p4(e,i.syncPointTree_,null,hv(i.pendingWriteTree_,yr()))}function p4(i,e,t,n){if(Wi(i.path))return g4(i,e,t,n);{const r=e.get(yr());t==null&&r!=null&&(t=Yh(r,yr()));let s=[];const l=ji(i.path),u=i.operationForChild(l),h=e.children.get(l);if(h&&u){const f=t?t.getImmediateChild(l):null,x=n4(n,l);s=s.concat(p4(u,h,f,x))}return r&&(s=s.concat(Iw(r,i,n,t))),s}}function g4(i,e,t,n){const r=e.get(yr());t==null&&r!=null&&(t=Yh(r,yr()));let s=[];return e.children.inorderTraversal((l,u)=>{const h=t?t.getImmediateChild(l):null,f=n4(n,l),x=i.operationForChild(l);x&&(s=s.concat(g4(x,u,h,f)))}),r&&(s=s.concat(Iw(r,i,n,t))),s}function m4(i,e){const t=e.query,n=Em(i,t);return{hashFn:()=>(MU(e)||ni.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return n?QU(i,t._path,n):JU(i,t._path);{const s=J9(r,t);return w1(i,t,null,s)}}}}function Em(i,e){const t=fv(e);return i.queryToTagMap.get(t)}function fv(i){return i._path.toString()+"$"+i._queryIdentifier}function Cw(i,e){return i.tagToQueryMap.get(e)}function Rw(i){const e=i.indexOf("$");return Kt(e!==-1&&e<i.length-1,"Bad queryKey."),{queryId:i.substr(e+1),path:new Hr(i.substr(0,e))}}function Lw(i,e,t){const n=i.syncPointTree_.get(e);Kt(n,"Missing sync point for query tag that we're tracking");const r=hv(i.pendingWriteTree_,e);return Iw(n,t,r,null)}function tB(i){return i.fold((e,t,n)=>{if(t&&sd(t))return[dv(t)];{let r=[];return t&&(r=u4(t)),xo(n,(s,l)=>{r=r.concat(l)}),r}})}function Qg(i){return i._queryParams.loadsAllData()&&!i._queryParams.isDefault()?new(WU())(i._repo,i._path):i}function nB(i,e){for(let t=0;t<e.length;++t){const n=e[t];if(!n._queryParams.loadsAllData()){const r=fv(n),s=i.queryToTagMap.get(r);i.queryToTagMap.delete(r),i.tagToQueryMap.delete(s)}}}function iB(){return qU++}function rB(i,e,t){const n=e._path,r=Em(i,e),s=m4(i,t),l=i.listenProvider_.startListening(Qg(e),r,s.hashFn,s.onComplete),u=i.syncPointTree_.subtree(n);if(r)Kt(!sd(u.value),"If we're adding a query, it shouldn't be shadowed");else{const h=u.fold((f,x,g)=>{if(!Wi(f)&&x&&sd(x))return[dv(x).query];{let w=[];return x&&(w=w.concat(u4(x).map(A=>A.query))),xo(g,(A,B)=>{w=w.concat(B)}),w}});for(let f=0;f<h.length;++f){const x=h[f];i.listenProvider_.stopListening(Qg(x),Em(i,x))}}return l}class Dw{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Dw(t)}node(){return this.node_}}class Nw{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Js(this.path_,e);return new Nw(this.syncTree_,t)}node(){return kw(this.syncTree_,this.path_)}}const sB=function(i){return i=i||{},i.timestamp=i.timestamp||new Date().getTime(),i},oI=function(i,e,t){if(!i||typeof i!="object")return i;if(Kt(".sv"in i,"Unexpected leaf node or priority contents"),typeof i[".sv"]=="string")return aB(i[".sv"],e,t);if(typeof i[".sv"]=="object")return oB(i[".sv"],e);Kt(!1,"Unexpected server value: "+JSON.stringify(i,null,2))},aB=function(i,e,t){switch(i){case"timestamp":return t.timestamp;default:Kt(!1,"Unexpected server value: "+i)}},oB=function(i,e,t){i.hasOwnProperty("increment")||Kt(!1,"Unexpected server value: "+JSON.stringify(i,null,2));const n=i.increment;typeof n!="number"&&Kt(!1,"Unexpected increment value: "+n);const r=e.node();if(Kt(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return n;const l=r.getValue();return typeof l!="number"?n:l+n},y4=function(i,e,t,n){return Pw(e,new Nw(t,i),n)},v4=function(i,e,t){return Pw(i,new Dw(e),t)};function Pw(i,e,t){const n=i.getPriority().val(),r=oI(n,e.getImmediateChild(".priority"),t);let s;if(i.isLeafNode()){const l=i,u=oI(l.getValue(),e,t);return u!==l.getValue()||r!==l.getPriority().val()?new Xa(u,Oa(r)):i}else{const l=i;return s=l,r!==l.getPriority().val()&&(s=s.updatePriority(new Xa(r))),l.forEachChild(Qs,(u,h)=>{const f=Pw(h,e.getImmediateChild(u),t);f!==h&&(s=s.updateImmediateChild(u,f))}),s}}class Ow{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Mw(i,e){let t=e instanceof Hr?e:new Hr(e),n=i,r=ji(t);for(;r!==null;){const s=up(n.node.children,r)||{children:{},childCount:0};n=new Ow(r,n,s),t=as(t),r=ji(t)}return n}function Up(i){return i.node.value}function _4(i,e){i.node.value=e,Cx(i)}function b4(i){return i.node.childCount>0}function lB(i){return Up(i)===void 0&&!b4(i)}function pv(i,e){xo(i.node.children,(t,n)=>{e(new Ow(t,i,n))})}function x4(i,e,t,n){t&&e(i),pv(i,r=>{x4(r,e,!0)})}function uB(i,e,t){let n=i.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function Qm(i){return new Hr(i.parent===null?i.name:Qm(i.parent)+"/"+i.name)}function Cx(i){i.parent!==null&&cB(i.parent,i.name,i)}function cB(i,e,t){const n=lB(t),r=lc(i.node.children,e);n&&r?(delete i.node.children[e],i.node.childCount--,Cx(i)):!n&&!r&&(i.node.children[e]=t.node,i.node.childCount++,Cx(i))}const hB=/[\[\].#$\/\u0000-\u001F\u007F]/,dB=/[\[\].#$\u0000-\u001F\u007F]/,rb=10*1024*1024,Fw=function(i){return typeof i=="string"&&i.length!==0&&!hB.test(i)},w4=function(i){return typeof i=="string"&&i.length!==0&&!dB.test(i)},fB=function(i){return i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),w4(i)},pB=function(i){return i===null||typeof i=="string"||typeof i=="number"&&!cw(i)||i&&typeof i=="object"&&lc(i,".sv")},gB=function(i,e,t,n){gv(M1(i,"value"),e,t)},gv=function(i,e,t){const n=t instanceof Hr?new Lz(t,i):t;if(e===void 0)throw new Error(i+"contains undefined "+kd(n));if(typeof e=="function")throw new Error(i+"contains a function "+kd(n)+" with contents = "+e.toString());if(cw(e))throw new Error(i+"contains "+e.toString()+" "+kd(n));if(typeof e=="string"&&e.length>rb/3&&F1(e)>rb)throw new Error(i+"contains a string greater than "+rb+" utf8 bytes "+kd(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(xo(e,(l,u)=>{if(l===".value")r=!0;else if(l!==".priority"&&l!==".sv"&&(s=!0,!Fw(l)))throw new Error(i+" contains an invalid key ("+l+") "+kd(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Dz(n,l),gv(i,u,n),Nz(n)}),r&&s)throw new Error(i+' contains ".value" child '+kd(n)+" in addition to actual children.")}},mB=function(i,e){let t,n;for(t=0;t<e.length;t++){n=e[t];const s=xm(n);for(let l=0;l<s.length;l++)if(!(s[l]===".priority"&&l===s.length-1)){if(!Fw(s[l]))throw new Error(i+"contains an invalid key ("+s[l]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(Rz);let r=null;for(t=0;t<e.length;t++){if(n=e[t],r!==null&&su(r,n))throw new Error(i+"contains a path "+r.toString()+" that is ancestor of another path "+n.toString());r=n}},yB=function(i,e,t,n){const r=M1(i,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const s=[];xo(e,(l,u)=>{const h=new Hr(l);if(gv(r,u,Js(t,h)),gw(h)===".priority"&&!pB(u))throw new Error(r+"contains an invalid value for '"+h.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(h)}),mB(r,s)},S4=function(i,e,t,n){if(!w4(t))throw new Error(M1(i,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},vB=function(i,e,t,n){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),S4(i,e,t)},T4=function(i,e){if(ji(e)===".info")throw new Error(i+" failed = Can't modify data under /.info/")},_B=function(i,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Fw(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!fB(t))throw new Error(M1(i,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class bB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function mv(i,e){let t=null;for(let n=0;n<e.length;n++){const r=e[n],s=r.getPath();t!==null&&!mw(s,t.path)&&(i.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&i.eventLists_.push(t)}function A4(i,e,t){mv(i,t),E4(i,n=>mw(n,e))}function cu(i,e,t){mv(i,t),E4(i,n=>su(n,e)||su(e,n))}function E4(i,e){i.recursionDepth_++;let t=!0;for(let n=0;n<i.eventLists_.length;n++){const r=i.eventLists_[n];if(r){const s=r.path;e(s)?(xB(i.eventLists_[n]),i.eventLists_[n]=null):t=!1}}t&&(i.eventLists_=[]),i.recursionDepth_--}function xB(i){for(let e=0;e<i.events.length;e++){const t=i.events[e];if(t!==null){i.events[e]=null;const n=t.getEventRunner();qg&&_o("event: "+t.toString()),Vp(n)}}}const wB="repo_interrupt",SB=25;class TB{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new bB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=p1(),this.transactionQueueTree_=new Ow,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function AB(i,e,t){if(i.stats_=fw(i.repoInfo_),i.forceRestClient_||tz())i.server_=new f1(i.repoInfo_,(n,r,s,l)=>{lI(i,n,r,s,l)},i.authTokenProvider_,i.appCheckProvider_),setTimeout(()=>uI(i,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ma(t)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}i.persistentConnection_=new Kc(i.repoInfo_,e,(n,r,s,l)=>{lI(i,n,r,s,l)},n=>{uI(i,n)},n=>{IB(i,n)},i.authTokenProvider_,i.appCheckProvider_,t),i.server_=i.persistentConnection_}i.authTokenProvider_.addTokenChangeListener(n=>{i.server_.refreshAuthToken(n)}),i.appCheckProvider_.addTokenChangeListener(n=>{i.server_.refreshAppCheckToken(n.token)}),i.statsReporter_=az(i.repoInfo_,()=>new sU(i.stats_,i.server_)),i.infoData_=new eU,i.infoSyncTree_=new aI({startListening:(n,r,s,l)=>{let u=[];const h=i.infoData_.getNode(n._path);return h.isEmpty()||(u=Jm(i.infoSyncTree_,n._path,h),setTimeout(()=>{l("ok")},0)),u},stopListening:()=>{}}),jw(i,"connected",!1),i.serverSyncTree_=new aI({startListening:(n,r,s,l)=>(i.server_.listen(n,s,r,(u,h)=>{const f=l(u,h);cu(i.eventQueue_,n._path,f)}),[]),stopListening:(n,r)=>{i.server_.unlisten(n,r)}})}function EB(i){const t=i.infoData_.getNode(new Hr(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function yv(i){return sB({timestamp:EB(i)})}function lI(i,e,t,n,r){i.dataUpdateCount++;const s=new Hr(e);t=i.interceptServerDataCallback_?i.interceptServerDataCallback_(e,t):t;let l=[];if(r)if(n){const h=V0(t,f=>Oa(f));l=ZU(i.serverSyncTree_,s,h,r)}else{const h=Oa(t);l=f4(i.serverSyncTree_,s,h,r)}else if(n){const h=V0(t,f=>Oa(f));l=XU(i.serverSyncTree_,s,h)}else{const h=Oa(t);l=Jm(i.serverSyncTree_,s,h)}let u=s;l.length>0&&(u=Cp(i,s)),cu(i.eventQueue_,u,l)}function uI(i,e){jw(i,"connected",e),e===!1&&LB(i)}function IB(i,e){xo(e,(t,n)=>{jw(i,t,n)})}function jw(i,e,t){const n=new Hr("/.info/"+e),r=Oa(t);i.infoData_.updateSnapshot(n,r);const s=Jm(i.infoSyncTree_,n,r);cu(i.eventQueue_,n,s)}function Vw(i){return i.nextWriteId_++}function kB(i,e,t){const n=eB(i.serverSyncTree_,e);return n!=null?Promise.resolve(n):i.server_.get(e).then(r=>{const s=Oa(r).withIndex(e._queryParams.getIndex());kx(i.serverSyncTree_,e,t,!0);let l;if(e._queryParams.loadsAllData())l=Jm(i.serverSyncTree_,e._path,s);else{const u=Em(i.serverSyncTree_,e);l=f4(i.serverSyncTree_,e._path,s,u)}return cu(i.eventQueue_,e._path,l),w1(i.serverSyncTree_,e,t,null,!0),s},r=>(Zm(i,"get for query "+Ma(e)+" failed: "+r),Promise.reject(new Error(r))))}function CB(i,e,t,n,r){Zm(i,"set",{path:e.toString(),value:t,priority:n});const s=yv(i),l=Oa(t,n),u=kw(i.serverSyncTree_,e),h=v4(l,u,s),f=Vw(i),x=d4(i.serverSyncTree_,e,h,f,!0);mv(i.eventQueue_,x),i.server_.put(e.toString(),l.val(!0),(w,A)=>{const B=w==="ok";B||Zo("set at "+e+" failed: "+w);const $=zh(i.serverSyncTree_,f,!B);cu(i.eventQueue_,e,$),Rx(i,r,w,A)});const g=Uw(i,e);Cp(i,g),cu(i.eventQueue_,g,[])}function RB(i,e,t,n){Zm(i,"update",{path:e.toString(),value:t});let r=!0;const s=yv(i),l={};if(xo(t,(u,h)=>{r=!1,l[u]=y4(Js(e,u),Oa(h),i.serverSyncTree_,s)}),r)_o("update() called with empty data.  Don't do anything."),Rx(i,n,"ok",void 0);else{const u=Vw(i),h=YU(i.serverSyncTree_,e,l,u);mv(i.eventQueue_,h),i.server_.merge(e.toString(),t,(f,x)=>{const g=f==="ok";g||Zo("update at "+e+" failed: "+f);const w=zh(i.serverSyncTree_,u,!g),A=w.length>0?Cp(i,e):e;cu(i.eventQueue_,A,w),Rx(i,n,f,x)}),xo(t,f=>{const x=Uw(i,Js(e,f));Cp(i,x)}),cu(i.eventQueue_,e,[])}}function LB(i){Zm(i,"onDisconnectEvents");const e=yv(i),t=p1();wx(i.onDisconnect_,yr(),(r,s)=>{const l=y4(r,s,i.serverSyncTree_,e);JL(t,r,l)});let n=[];wx(t,yr(),(r,s)=>{n=n.concat(Jm(i.serverSyncTree_,r,s));const l=Uw(i,r);Cp(i,l)}),i.onDisconnect_=p1(),cu(i.eventQueue_,yr(),n)}function DB(i,e,t){let n;ji(e._path)===".info"?n=kx(i.infoSyncTree_,e,t):n=kx(i.serverSyncTree_,e,t),A4(i.eventQueue_,e._path,n)}function NB(i,e,t){let n;ji(e._path)===".info"?n=w1(i.infoSyncTree_,e,t):n=w1(i.serverSyncTree_,e,t),A4(i.eventQueue_,e._path,n)}function PB(i){i.persistentConnection_&&i.persistentConnection_.interrupt(wB)}function Zm(i,...e){let t="";i.persistentConnection_&&(t=i.persistentConnection_.id+":"),_o(t,...e)}function Rx(i,e,t,n){e&&Vp(()=>{if(t==="ok")e(null);else{const r=(t||"error").toUpperCase();let s=r;n&&(s+=": "+n);const l=new Error(s);l.code=r,e(l)}})}function I4(i,e,t){return kw(i.serverSyncTree_,e,t)||ni.EMPTY_NODE}function zw(i,e=i.transactionQueueTree_){if(e||vv(i,e),Up(e)){const t=C4(i,e);Kt(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&OB(i,Qm(e),t)}else b4(e)&&pv(e,t=>{zw(i,t)})}function OB(i,e,t){const n=t.map(f=>f.currentWriteId),r=I4(i,e,n);let s=r;const l=r.hash();for(let f=0;f<t.length;f++){const x=t[f];Kt(x.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),x.status=1,x.retryCount++;const g=Jo(e,x.path);s=s.updateChild(g,x.currentOutputSnapshotRaw)}const u=s.val(!0),h=e;i.server_.put(h.toString(),u,f=>{Zm(i,"transaction put response",{path:h.toString(),status:f});let x=[];if(f==="ok"){const g=[];for(let w=0;w<t.length;w++)t[w].status=2,x=x.concat(zh(i.serverSyncTree_,t[w].currentWriteId)),t[w].onComplete&&g.push(()=>t[w].onComplete(null,!0,t[w].currentOutputSnapshotResolved)),t[w].unwatcher();vv(i,Mw(i.transactionQueueTree_,e)),zw(i,i.transactionQueueTree_),cu(i.eventQueue_,e,x);for(let w=0;w<g.length;w++)Vp(g[w])}else{if(f==="datastale")for(let g=0;g<t.length;g++)t[g].status===3?t[g].status=4:t[g].status=0;else{Zo("transaction at "+h.toString()+" failed: "+f);for(let g=0;g<t.length;g++)t[g].status=4,t[g].abortReason=f}Cp(i,e)}},l)}function Cp(i,e){const t=k4(i,e),n=Qm(t),r=C4(i,t);return MB(i,r,n),n}function MB(i,e,t){if(e.length===0)return;const n=[];let r=[];const l=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const h=e[u],f=Jo(t,h.path);let x=!1,g;if(Kt(f!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)x=!0,g=h.abortReason,r=r.concat(zh(i.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=SB)x=!0,g="maxretry",r=r.concat(zh(i.serverSyncTree_,h.currentWriteId,!0));else{const w=I4(i,h.path,l);h.currentInputSnapshot=w;const A=e[u].update(w.val());if(A!==void 0){gv("transaction failed: Data returned ",A,h.path);let B=Oa(A);typeof A=="object"&&A!=null&&lc(A,".priority")||(B=B.updatePriority(w.getPriority()));const W=h.currentWriteId,q=yv(i),ge=v4(B,w,q);h.currentOutputSnapshotRaw=B,h.currentOutputSnapshotResolved=ge,h.currentWriteId=Vw(i),l.splice(l.indexOf(W),1),r=r.concat(d4(i.serverSyncTree_,h.path,ge,h.currentWriteId,h.applyLocally)),r=r.concat(zh(i.serverSyncTree_,W,!0))}else x=!0,g="nodata",r=r.concat(zh(i.serverSyncTree_,h.currentWriteId,!0))}cu(i.eventQueue_,t,r),r=[],x&&(e[u].status=2,(function(w){setTimeout(w,Math.floor(0))})(e[u].unwatcher),e[u].onComplete&&(g==="nodata"?n.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):n.push(()=>e[u].onComplete(new Error(g),!1,null))))}vv(i,i.transactionQueueTree_);for(let u=0;u<n.length;u++)Vp(n[u]);zw(i,i.transactionQueueTree_)}function k4(i,e){let t,n=i.transactionQueueTree_;for(t=ji(e);t!==null&&Up(n)===void 0;)n=Mw(n,t),e=as(e),t=ji(e);return n}function C4(i,e){const t=[];return R4(i,e,t),t.sort((n,r)=>n.order-r.order),t}function R4(i,e,t){const n=Up(e);if(n)for(let r=0;r<n.length;r++)t.push(n[r]);pv(e,r=>{R4(i,r,t)})}function vv(i,e){const t=Up(e);if(t){let n=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[n]=t[r],n++);t.length=n,_4(e,t.length>0?t:void 0)}pv(e,n=>{vv(i,n)})}function Uw(i,e){const t=Qm(k4(i,e)),n=Mw(i.transactionQueueTree_,e);return uB(n,r=>{sb(i,r)}),sb(i,n),x4(n,r=>{sb(i,r)}),t}function sb(i,e){const t=Up(e);if(t){const n=[];let r=[],s=-1;for(let l=0;l<t.length;l++)t[l].status===3||(t[l].status===1?(Kt(s===l-1,"All SENT items should be at beginning of queue."),s=l,t[l].status=3,t[l].abortReason="set"):(Kt(t[l].status===0,"Unexpected transaction status in abort"),t[l].unwatcher(),r=r.concat(zh(i.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&n.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));s===-1?_4(e,void 0):t.length=s+1,cu(i.eventQueue_,Qm(e),r);for(let l=0;l<n.length;l++)Vp(n[l])}}function FB(i){let e="";const t=i.split("/");for(let n=0;n<t.length;n++)if(t[n].length>0){let r=t[n];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function jB(i){const e={};i.charAt(0)==="?"&&(i=i.substring(1));for(const t of i.split("&")){if(t.length===0)continue;const n=t.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):Zo(`Invalid query segment '${t}' in query '${i}'`)}return e}const cI=function(i,e){const t=VB(i),n=t.namespace;t.domain==="firebase.com"&&eh(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&t.domain!=="localhost"&&eh("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||K9();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new PL(t.host,t.secure,n,r,e,"",n!==t.subdomain),path:new Hr(t.pathString)}},VB=function(i){let e="",t="",n="",r="",s="",l=!0,u="https",h=443;if(typeof i=="string"){let f=i.indexOf("//");f>=0&&(u=i.substring(0,f-1),i=i.substring(f+2));let x=i.indexOf("/");x===-1&&(x=i.length);let g=i.indexOf("?");g===-1&&(g=i.length),e=i.substring(0,Math.min(x,g)),x<g&&(r=FB(i.substring(x,g)));const w=jB(i.substring(Math.min(i.length,g)));f=e.indexOf(":"),f>=0?(l=u==="https"||u==="wss",h=parseInt(e.substring(f+1),10)):f=e.length;const A=e.slice(0,f);if(A.toLowerCase()==="localhost")t="localhost";else if(A.split(".").length<=2)t=A;else{const B=e.indexOf(".");n=e.substring(0,B).toLowerCase(),t=e.substring(B+1),s=n}"ns"in w&&(s=w.ns)}return{host:e,port:h,domain:t,subdomain:n,secure:l,scheme:u,pathString:r,namespace:s}};class zB{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ma(this.snapshot.exportVal())}}class UB{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class L4{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Kt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Bw{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Wi(this._path)?null:gw(this._path)}get ref(){return new rh(this._repo,this._path)}get _queryIdentifier(){const e=XE(this._queryParams),t=hw(e);return t==="{}"?"default":t}get _queryObject(){return XE(this._queryParams)}isEqual(e){if(e=Ss(e),!(e instanceof Bw))return!1;const t=this._repo===e._repo,n=mw(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+Cz(this._path)}}class rh extends Bw{constructor(e,t){super(e,t,new bw,!1)}get parent(){const e=$L(this._path);return e===null?null:new rh(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Im{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Hr(e),n=Lx(this.ref,e);return new Im(this._node.getChild(t),n,Qs)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,r)=>e(new Im(r,Lx(this.ref,n),Qs)))}hasChild(e){const t=new Hr(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Yo(i,e){return i=Ss(i),i._checkNotDeleted("ref"),e!==void 0?Lx(i._root,e):i._root}function Lx(i,e){return i=Ss(i),ji(i._path)===null?vB("child","path",e):S4("child","path",e),new rh(i._repo,Js(i._path,e))}function BB(i){return T4("remove",i._path),Yf(i,null)}function Yf(i,e){i=Ss(i),T4("set",i._path),gB("set",e,i._path);const t=new Nm;return CB(i._repo,i._path,e,null,t.wrapCallback(()=>{})),t.promise}function $B(i,e){yB("update",e,i._path);const t=new Nm;return RB(i._repo,i._path,e,t.wrapCallback(()=>{})),t.promise}function Nh(i){i=Ss(i);const e=new L4(()=>{}),t=new _v(e);return kB(i._repo,i,t).then(n=>new Im(n,new rh(i._repo,i._path),i._queryParams.getIndex()))}class _v{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const n=t._queryParams.getIndex();return new zB("value",this,new Im(e.snapshotNode,new rh(t._repo,t._path),n))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new UB(this,e,t):null}matches(e){return e instanceof _v?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function GB(i,e,t,n,r){const s=new L4(t,void 0),l=new _v(s);return DB(i._repo,i,l),()=>NB(i._repo,i,l)}function HB(i,e,t,n){return GB(i,"value",e)}UU(rh);KU(rh);const KB="FIREBASE_DATABASE_EMULATOR_HOST",Dx={};let WB=!1;function qB(i,e,t,n){const r=e.lastIndexOf(":"),s=e.substring(0,r),l=ac(s);i.repoInfo_=new PL(e,l,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams,!0,t),n&&(i.authTokenProvider_=n)}function YB(i,e,t,n,r){let s=n||i.options.databaseURL;s===void 0&&(i.options.projectId||eh("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_o("Using default host for project ",i.options.projectId),s=`${i.options.projectId}-default-rtdb.firebaseio.com`);let l=cI(s,r),u=l.repoInfo,h;typeof process<"u"&&DE&&(h=DE[KB]),h?(s=`http://${h}?ns=${u.namespace}`,l=cI(s,r),u=l.repoInfo):l.repoInfo.secure;const f=new iz(i.name,i.options,e);_B("Invalid Firebase Database URL",l),Wi(l.path)||eh("Database URL must point to the root of a Firebase Database (not including a child path).");const x=JB(u,i,f,new nz(i,t));return new QB(x,i)}function XB(i,e){const t=Dx[e];(!t||t[i.key]!==i)&&eh(`Database ${e}(${i.repoInfo_}) has already been deleted.`),PB(i),delete t[i.key]}function JB(i,e,t,n){let r=Dx[e.name];r||(r={},Dx[e.name]=r);let s=r[i.toURLString()];return s&&eh("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new TB(i,WB,t,n),r[i.toURLString()]=s,s}class QB{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(AB(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new rh(this._repo,yr())),this._rootInternal}_delete(){return this._rootInternal!==null&&(XB(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&eh("Cannot call "+e+" on a deleted database.")}}function D4(i=z1(),e){const t=Om(i,"database").getImmediate({identifier:e});if(!t._instanceStarted){const n=a2("database");n&&ZB(t,...n)}return t}function ZB(i,e,t,n={}){i=Ss(i),i._checkNotDeleted("useEmulator");const r=`${e}:${t}`,s=i._repoInternal;if(i._instanceStarted){if(r===i._repoInternal.repoInfo_.host&&Jh(n,s.repoInfo_.emulatorOptions))return;eh("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let l;if(s.repoInfo_.nodeAdmin)n.mockUserToken&&eh('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new A0(A0.OWNER);else if(n.mockUserToken){const u=typeof n.mockUserToken=="string"?n.mockUserToken:o2(n.mockUserToken,i.app.options.projectId);l=new A0(u)}ac(e)&&(P1(e),O1("Database",!0)),qB(s,r,n,l)}function e$(i){z9(ld),Qh(new qc("database",(e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return YB(n,r,s,t)},"PUBLIC").setMultipleInstances(!0)),au(NE,PE,i),au(NE,PE,"esm2020")}Kc.prototype.simpleListen=function(i,e){this.sendRequest("q",{p:i},e)};Kc.prototype.echo=function(i,e){this.sendRequest("echo",{d:i},e)};e$();const N4="firebasestorage.googleapis.com",P4="storageBucket",t$=120*1e3,n$=600*1e3;class ea extends oc{constructor(e,t,n=0){super(ab(e),`Firebase Storage: ${t} (${ab(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ea.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ab(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zs;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zs||(Zs={}));function ab(i){return"storage/"+i}function $w(){const i="An unknown error occurred, please check the error payload for server response.";return new ea(Zs.UNKNOWN,i)}function i$(i){return new ea(Zs.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}function r$(i){return new ea(Zs.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s$(){const i="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ea(Zs.UNAUTHENTICATED,i)}function a$(){return new ea(Zs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function o$(i){return new ea(Zs.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}function l$(){return new ea(Zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function u$(){return new ea(Zs.CANCELED,"User canceled the upload/download.")}function c$(i){return new ea(Zs.INVALID_URL,"Invalid URL '"+i+"'.")}function h$(i){return new ea(Zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function d$(){return new ea(Zs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+P4+"' property when initializing the app?")}function f$(){return new ea(Zs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function p$(){return new ea(Zs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function g$(i){return new ea(Zs.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Nx(i){return new ea(Zs.INVALID_ARGUMENT,i)}function O4(){return new ea(Zs.APP_DELETED,"The Firebase app was deleted.")}function m$(i){return new ea(Zs.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Zg(i,e){return new ea(Zs.INVALID_FORMAT,"String does not match format '"+i+"': "+e)}function Sg(i){throw new ea(Zs.INTERNAL_ERROR,"Internal error: "+i)}class jl{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=jl.makeFromUrl(e,t)}catch{return new jl(e,"")}if(n.path==="")return n;throw h$(e)}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";function s(me){me.path.charAt(me.path.length-1)==="/"&&(me.path_=me.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+r+l,"i"),h={bucket:1,path:3};function f(me){me.path_=decodeURIComponent(me.path)}const x="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",A=new RegExp(`^https?://${g}/${x}/b/${r}/o${w}`,"i"),B={bucket:1,path:3},$=t===N4?"(?:storage.googleapis.com|storage.cloud.google.com)":t,W="([^?#]*)",q=new RegExp(`^https?://${$}/${r}/${W}`,"i"),he=[{regex:u,indices:h,postModify:s},{regex:A,indices:B,postModify:f},{regex:q,indices:{bucket:1,path:2},postModify:f}];for(let me=0;me<he.length;me++){const Ce=he[me],Ve=Ce.regex.exec(e);if(Ve){const pe=Ve[Ce.indices.bucket];let ee=Ve[Ce.indices.path];ee||(ee=""),n=new jl(pe,ee),Ce.postModify(n);break}}if(n==null)throw c$(e);return n}}class y${constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function v$(i,e,t){let n=1,r=null,s=null,l=!1,u=0;function h(){return u===2}let f=!1;function x(...W){f||(f=!0,e.apply(null,W))}function g(W){r=setTimeout(()=>{r=null,i(A,h())},W)}function w(){s&&clearTimeout(s)}function A(W,...q){if(f){w();return}if(W){w(),x.call(null,W,...q);return}if(h()||l){w(),x.call(null,W,...q);return}n<64&&(n*=2);let he;u===1?(u=2,he=0):he=(n+Math.random())*1e3,g(he)}let B=!1;function $(W){B||(B=!0,w(),!f&&(r!==null?(W||(u=2),clearTimeout(r),g(0)):W||(u=1)))}return g(0),s=setTimeout(()=>{l=!0,$(!0)},t),$}function _$(i){i(!1)}function b$(i){return i!==void 0}function x$(i){return typeof i=="object"&&!Array.isArray(i)}function Gw(i){return typeof i=="string"||i instanceof String}function hI(i){return Hw()&&i instanceof Blob}function Hw(){return typeof Blob<"u"}function dI(i,e,t,n){if(n<e)throw Nx(`Invalid value for '${i}'. Expected ${e} or greater.`);if(n>t)throw Nx(`Invalid value for '${i}'. Expected ${t} or less.`)}function bv(i,e,t){let n=e;return t==null&&(n=`https://${e}`),`${t}://${n}/v0${i}`}function M4(i){const e=encodeURIComponent;let t="?";for(const n in i)if(i.hasOwnProperty(n)){const r=e(n)+"="+e(i[n]);t=t+r+"&"}return t=t.slice(0,-1),t}var Gd;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(Gd||(Gd={}));function w$(i,e){const t=i>=500&&i<600,r=[408,429].indexOf(i)!==-1,s=e.indexOf(i)!==-1;return t||r||s}class S${constructor(e,t,n,r,s,l,u,h,f,x,g,w=!0,A=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=h,this.timeout_=f,this.progressCallback_=x,this.connectionFactory_=g,this.retry=w,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,$)=>{this.resolve_=B,this.reject_=$,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new Wy(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const l=u=>{const h=u.loaded,f=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,f)};this.progressCallback_!==null&&s.addUploadProgressListener(l),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(l),this.pendingConnection_=null;const u=s.getErrorCode()===Gd.NO_ERROR,h=s.getStatus();if(!u||w$(h,this.additionalRetryCodes_)&&this.retry){const x=s.getErrorCode()===Gd.ABORT;n(!1,new Wy(!1,null,x));return}const f=this.successCodes_.indexOf(h)!==-1;n(!0,new Wy(f,s))})},t=(n,r)=>{const s=this.resolve_,l=this.reject_,u=r.connection;if(r.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());b$(h)?s(h):s()}catch(h){l(h)}else if(u!==null){const h=$w();h.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,h)):l(h)}else if(r.canceled){const h=this.appDelete_?O4():u$();l(h)}else{const h=l$();l(h)}};this.canceled_?t(!1,new Wy(!1,null,!0)):this.backoffId_=v$(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&_$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wy{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function T$(i,e){e!==null&&e.length>0&&(i.Authorization="Firebase "+e)}function A$(i,e){i["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function E$(i,e){e&&(i["X-Firebase-GMPID"]=e)}function I$(i,e){e!==null&&(i["X-Firebase-AppCheck"]=e)}function k$(i,e,t,n,r,s,l=!0,u=!1){const h=M4(i.urlParams),f=i.url+h,x=Object.assign({},i.headers);return E$(x,e),T$(x,t),A$(x,s),I$(x,n),new S$(f,i.method,x,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,r,l,u)}function C$(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function R$(...i){const e=C$();if(e!==void 0){const t=new e;for(let n=0;n<i.length;n++)t.append(i[n]);return t.getBlob()}else{if(Hw())return new Blob(i);throw new ea(Zs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function L$(i,e,t){return i.webkitSlice?i.webkitSlice(e,t):i.mozSlice?i.mozSlice(e,t):i.slice?i.slice(e,t):null}function D$(i){if(typeof atob>"u")throw g$("base-64");return atob(i)}const Qu={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ob{constructor(e,t){this.data=e,this.contentType=t||null}}function N$(i,e){switch(i){case Qu.RAW:return new ob(F4(e));case Qu.BASE64:case Qu.BASE64URL:return new ob(j4(i,e));case Qu.DATA_URL:return new ob(O$(e),M$(e))}throw $w()}function F4(i){const e=[];for(let t=0;t<i.length;t++){let n=i.charCodeAt(t);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(t<i.length-1&&(i.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const s=n,l=i.charCodeAt(++t);n=65536|(s&1023)<<10|l&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function P$(i){let e;try{e=decodeURIComponent(i)}catch{throw Zg(Qu.DATA_URL,"Malformed data URL.")}return F4(e)}function j4(i,e){switch(i){case Qu.BASE64:{const r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw Zg(i,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Qu.BASE64URL:{const r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw Zg(i,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=D$(e)}catch(r){throw r.message.includes("polyfill")?r:Zg(i,"Invalid character found")}const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}class V4{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Zg(Qu.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;n!=null&&(this.base64=F$(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function O$(i){const e=new V4(i);return e.base64?j4(Qu.BASE64,e.rest):P$(e.rest)}function M$(i){return new V4(i).contentType}function F$(i,e){return i.length>=e.length?i.substring(i.length-e.length)===e:!1}class jh{constructor(e,t){let n=0,r="";hI(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(hI(this.data_)){const n=this.data_,r=L$(n,e,t);return r===null?null:new jh(r)}else{const n=new Uint8Array(this.data_.buffer,e,t-e);return new jh(n,!0)}}static getBlob(...e){if(Hw()){const t=e.map(n=>n instanceof jh?n.data_:n);return new jh(R$.apply(null,t))}else{const t=e.map(l=>Gw(l)?N$(Qu.RAW,l).data:l.data_);let n=0;t.forEach(l=>{n+=l.byteLength});const r=new Uint8Array(n);let s=0;return t.forEach(l=>{for(let u=0;u<l.length;u++)r[s++]=l[u]}),new jh(r,!0)}}uploadData(){return this.data_}}function z4(i){let e;try{e=JSON.parse(i)}catch{return null}return x$(e)?e:null}function j$(i){if(i.length===0)return null;const e=i.lastIndexOf("/");return e===-1?"":i.slice(0,e)}function V$(i,e){const t=e.split("/").filter(n=>n.length>0).join("/");return i.length===0?t:i+"/"+t}function U4(i){const e=i.lastIndexOf("/",i.length-2);return e===-1?i:i.slice(e+1)}function z$(i,e){return e}class qo{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||z$}}let qy=null;function U$(i){return!Gw(i)||i.length<2?i:U4(i)}function B4(){if(qy)return qy;const i=[];i.push(new qo("bucket")),i.push(new qo("generation")),i.push(new qo("metageneration")),i.push(new qo("name","fullPath",!0));function e(s,l){return U$(l)}const t=new qo("name");t.xform=e,i.push(t);function n(s,l){return l!==void 0?Number(l):l}const r=new qo("size");return r.xform=n,i.push(r),i.push(new qo("timeCreated")),i.push(new qo("updated")),i.push(new qo("md5Hash",null,!0)),i.push(new qo("cacheControl",null,!0)),i.push(new qo("contentDisposition",null,!0)),i.push(new qo("contentEncoding",null,!0)),i.push(new qo("contentLanguage",null,!0)),i.push(new qo("contentType",null,!0)),i.push(new qo("metadata","customMetadata",!0)),qy=i,qy}function B$(i,e){function t(){const n=i.bucket,r=i.fullPath,s=new jl(n,r);return e._makeStorageReference(s)}Object.defineProperty(i,"ref",{get:t})}function $$(i,e,t){const n={};n.type="file";const r=t.length;for(let s=0;s<r;s++){const l=t[s];n[l.local]=l.xform(n,e[l.server])}return B$(n,i),n}function $4(i,e,t){const n=z4(e);return n===null?null:$$(i,n,t)}function G$(i,e,t,n){const r=z4(e);if(r===null||!Gw(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const l=encodeURIComponent;return s.split(",").map(f=>{const x=i.bucket,g=i.fullPath,w="/b/"+l(x)+"/o/"+l(g),A=bv(w,t,n),B=M4({alt:"media",token:f});return A+B})[0]}function H$(i,e){const t={},n=e.length;for(let r=0;r<n;r++){const s=e[r];s.writable&&(t[s.server]=i[s.local])}return JSON.stringify(t)}class Kw{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function G4(i){if(!i)throw $w()}function K$(i,e){function t(n,r){const s=$4(i,r,e);return G4(s!==null),s}return t}function W$(i,e){function t(n,r){const s=$4(i,r,e);return G4(s!==null),G$(s,r,i.host,i._protocol)}return t}function H4(i){function e(t,n){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=a$():r=s$():t.getStatus()===402?r=r$(i.bucket):t.getStatus()===403?r=o$(i.path):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}return e}function K4(i){const e=H4(i);function t(n,r){let s=e(n,r);return n.getStatus()===404&&(s=i$(i.path)),s.serverResponse=r.serverResponse,s}return t}function q$(i,e,t){const n=e.fullServerUrl(),r=bv(n,i.host,i._protocol),s="GET",l=i.maxOperationRetryTime,u=new Kw(r,s,W$(i,t),l);return u.errorHandler=K4(e),u}function Y$(i,e){const t=e.fullServerUrl(),n=bv(t,i.host,i._protocol),r="DELETE",s=i.maxOperationRetryTime;function l(h,f){}const u=new Kw(n,r,l,s);return u.successCodes=[200,204],u.errorHandler=K4(e),u}function X$(i,e){return i&&i.contentType||e&&e.type()||"application/octet-stream"}function J$(i,e,t){const n=Object.assign({},t);return n.fullPath=i.path,n.size=e.size(),n.contentType||(n.contentType=X$(null,e)),n}function Q$(i,e,t,n,r){const s=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let he="";for(let me=0;me<2;me++)he=he+Math.random().toString().slice(2);return he}const h=u();l["Content-Type"]="multipart/related; boundary="+h;const f=J$(e,n,r),x=H$(f,t),g="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+h+`\r
Content-Type: `+f.contentType+`\r
\r
`,w=`\r
--`+h+"--",A=jh.getBlob(g,n,w);if(A===null)throw f$();const B={name:f.fullPath},$=bv(s,i.host,i._protocol),W="POST",q=i.maxUploadRetryTime,ge=new Kw($,W,K$(i,t),q);return ge.urlParams=B,ge.headers=l,ge.body=A.uploadData(),ge.errorHandler=H4(e),ge}class Z${constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Gd.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Gd.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Gd.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,s){if(this.sent_)throw Sg("cannot .send() more than once");if(ac(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const l in s)s.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,s[l].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sg("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sg("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sg("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sg("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class eG extends Z${initXhr(){this.xhr_.responseType="text"}}function Ww(){return new eG}class sf{constructor(e,t){this._service=e,t instanceof jl?this._location=t:this._location=jl.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new sf(e,t)}get root(){const e=new jl(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return U4(this._location.path)}get storage(){return this._service}get parent(){const e=j$(this._location.path);if(e===null)return null;const t=new jl(this._location.bucket,e);return new sf(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw m$(e)}}function tG(i,e,t){i._throwIfRoot("uploadBytes");const n=Q$(i.storage,i._location,B4(),new jh(e,!0),t);return i.storage.makeRequestWithTokens(n,Ww).then(r=>({metadata:r,ref:i}))}function nG(i){i._throwIfRoot("getDownloadURL");const e=q$(i.storage,i._location,B4());return i.storage.makeRequestWithTokens(e,Ww).then(t=>{if(t===null)throw p$();return t})}function iG(i){i._throwIfRoot("deleteObject");const e=Y$(i.storage,i._location);return i.storage.makeRequestWithTokens(e,Ww)}function rG(i,e){const t=V$(i._location.path,e),n=new jl(i._location.bucket,t);return new sf(i.storage,n)}function sG(i){return/^[A-Za-z]+:\/\//.test(i)}function aG(i,e){return new sf(i,e)}function W4(i,e){if(i instanceof qw){const t=i;if(t._bucket==null)throw d$();const n=new sf(t,t._bucket);return e!=null?W4(n,e):n}else return e!==void 0?rG(i,e):i}function oG(i,e){if(e&&sG(e)){if(i instanceof qw)return aG(i,e);throw Nx("To use ref(service, url), the first argument must be a Storage instance.")}else return W4(i,e)}function fI(i,e){const t=e?.[P4];return t==null?null:jl.makeFromBucketSpec(t,i)}function lG(i,e,t,n={}){i.host=`${e}:${t}`;const r=ac(e);r&&(P1(`https://${i.host}/b`),O1("Storage",!0)),i._isUsingEmulator=!0,i._protocol=r?"https":"http";const{mockUserToken:s}=n;s&&(i._overrideAuthToken=typeof s=="string"?s:o2(s,i.app.options.projectId))}class qw{constructor(e,t,n,r,s,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=l,this._bucket=null,this._host=N4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=t$,this._maxUploadRetryTime=n$,this._requests=new Set,r!=null?this._bucket=jl.makeFromBucketSpec(r,this._host):this._bucket=fI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=jl.makeFromBucketSpec(this._url,e):this._bucket=fI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dI("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dI("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Po(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new sf(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new y$(O4());{const l=k$(e,this._appId,n,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const pI="@firebase/storage",gI="0.14.0";const q4="storage";function uG(i,e,t){return i=Ss(i),tG(i,e,t)}function mI(i){return i=Ss(i),nG(i)}function cG(i){return i=Ss(i),iG(i)}function lb(i,e){return i=Ss(i),oG(i,e)}function hG(i=z1(),e){i=Ss(i);const n=Om(i,q4).getImmediate({identifier:e}),r=a2("storage");return r&&dG(n,...r),n}function dG(i,e,t,n={}){lG(i,e,t,n)}function fG(i,{instanceIdentifier:e}){const t=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),r=i.getProvider("app-check-internal");return new qw(t,n,r,e,ld)}function pG(){Qh(new qc(q4,fG,"PUBLIC").setMultipleInstances(!0)),au(pI,gI,""),au(pI,gI,"esm2020")}pG();const ub={apiKey:"AIzaSyAUv69QXH4MNNR2wkr_wcVH_cbsYrc3wjo",authDomain:"wellnessai-app-e01be.firebaseapp.com",databaseURL:"https://wellnessai-app-e01be-default-rtdb.europe-west1.firebasedatabase.app",projectId:"wellnessai-app-e01be",storageBucket:"wellnessai-app-e01be.firebasestorage.app",messagingSenderId:"863551474584",appId:"1:863551474584:web:a34f3f77742b7be4e7f9ed",measurementId:"G-CB4C84PTJ3"};class gG{constructor(){this.app=null,this.auth=null,this.database=null,this.storage=null,this.currentUser=null,this.isInitialized=!1}initialize(){try{return this.isInitialized?!0:!ub.apiKey||ub.apiKey==="YOUR_API_KEY_HERE"?!1:(this.app=V1(ub),this.auth=b2(this.app),this.database=D4(this.app),this.storage=hG(this.app),S8(this.auth,e=>{e?this.currentUser=e:this.currentUser=null}),this.isInitialized=!0,!0)}catch{return!1}}async signUp(e,t,n){try{const s=(await _8(this.auth,e,t)).user;return await this.createUserProfile(s.uid,{email:e,displayName:n,createdAt:new Date().toISOString(),profile:{age:null,gender:null,height:null,weight:null,goalSteps:1e4,notifications:!0}}),{success:!0,user:s}}catch(r){return{success:!1,error:r.message}}}async signIn(e,t){try{return{success:!0,user:(await b8(this.auth,e,t)).user}}catch(n){return{success:!1,error:n.message}}}async signInWithGoogle(){try{const e=new jc,n=(await G8(this.auth,e)).user;return await this.getUserProfile(n.uid)||await this.createUserProfile(n.uid,{email:n.email,displayName:n.displayName,photoURL:n.photoURL,createdAt:new Date().toISOString(),profile:{goalSteps:1e4,notifications:!0}}),{success:!0,user:n}}catch(e){return{success:!1,error:e.message}}}async signOut(){try{return await T8(this.auth),{success:!0}}catch(e){return{success:!1,error:e.message}}}getCurrentUser(){return this.auth.currentUser}getCurrentUserId(){return this.auth.currentUser?.uid||null}async createUserProfile(e,t){try{const n=Yo(this.database,`users/${e}`);return await Yf(n,t),{success:!0}}catch(n){return{success:!1,error:n.message}}}async getUserProfile(e){try{const t=Yo(this.database,`users/${e}`),n=await Nh(t);return n.exists()?n.val():null}catch{return null}}async updateUserProfile(e,t){try{const n=Yo(this.database,`users/${e}`);return await $B(n,t),{success:!0}}catch(n){return{success:!1,error:n.message}}}async saveHealthData(e,t,n,r){try{const s=Yo(this.database,`users/${e}/healthData/${n}/${t}`);return await Yf(s,r),{success:!0}}catch(s){return{success:!1,error:s.message}}}async getHealthData(e,t,n){try{const r=Yo(this.database,`users/${e}/healthData/${n}/${t}`),s=await Nh(r);return s.exists()?s.val():null}catch{return null}}async addToLog(e,t,n){try{const r=new Date().toISOString().split("T")[0],s=Yo(this.database,`users/${e}/healthData/${t}/${r}`),l=await Nh(s),u=l.exists()?l.val():[],h=Array.isArray(u)?[...u,n]:[n];return await Yf(s,h),{success:!0}}catch(r){return{success:!1,error:r.message}}}async getLogRange(e,t,n,r){try{const s=Yo(this.database,`users/${e}/healthData/${t}`),l=await Nh(s);if(!l.exists())return{};const u=l.val(),h={};return Object.keys(u).forEach(f=>{f>=n&&f<=r&&(h[f]=u[f])}),h}catch{return{}}}listenToHealthData(e,t,n,r){const s=Yo(this.database,`users/${e}/healthData/${n}/${t}`);return HB(s,l=>{const u=l.exists()?l.val():null;r(u)})}async saveSettings(e,t){try{const n=Yo(this.database,`users/${e}/settings`);return await Yf(n,t),{success:!0}}catch(n){return{success:!1,error:n.message}}}async getSettings(e){try{const t=Yo(this.database,`users/${e}/settings`),n=await Nh(t);return n.exists()?n.val():{}}catch{return{}}}async uploadFile(e,t,n){try{const r=lb(this.storage,`users/${e}/${t}`),s=await uG(r,n);return{success:!0,url:await mI(s.ref)}}catch(r){return{success:!1,error:r.message}}}async getFileURL(e,t){try{const n=lb(this.storage,`users/${e}/${t}`);return await mI(n)}catch{return null}}async deleteFile(e,t){try{const n=lb(this.storage,`users/${e}/${t}`);return await cG(n),{success:!0}}catch(n){return{success:!1,error:n.message}}}isAuthenticated(){return this.auth.currentUser!==null}getUserEmail(){return this.auth.currentUser?.email||null}async deleteAccount(e){try{const t=Yo(this.database,`users/${e}`);return await BB(t),await this.auth.currentUser.delete(),{success:!0}}catch(t){return{success:!1,error:t.message}}}async exportUserData(e){try{const t=Yo(this.database,`users/${e}`),n=await Nh(t);return n.exists()?{success:!0,data:n.val()}:{success:!1,error:"No data found"}}catch(t){return{success:!1,error:t.message}}}}const Fi=new gG;class mG{constructor(){this.isSyncing=!1,this.syncQueue=[],this.isOnline=navigator.onLine,this.lastSyncTime=null,this.retryTimer=null,this.authCheckInterval=null,this.maxRetries=10,this.database=null,this.criticalKeys=["stepBaseline","stepBaselineDate","weeklySteps","todaySteps","stepHistory","step_counter_baseline","step_counter_date","water_daily_goal","water_today_intake","water_intake_history","water_reminders","waterLog","foodLog","meal_plans","meal_preferences","saved_recipes","workoutHistory","workoutLog","activityLog","rep_history","exercise_preferences","heart_rate_history","hr_device_name","heartRateData","sleepLog","sleep_history","current_sleep_session","meditationLog","meditation_history","gratitudeLog","journalEntries","gratitude_entries","stressLog","mood_history","user_profile","profile_data","user_preferences","allergens","dietary_restrictions","health_goals","health_avatar_data","avatar_predictions","avatar_history","emergency_data","emergency_contacts","emergencyHistory","medical_info","dnaAnalysis","dnaRawData","dna_last_tip","dna_last_tip_date","genetic_predictions","battles_data","battle_history","battle_stats","meal_automation_settings","automated_meals","meal_schedule","loginHistory","social_login_provider","social_login_data","user_credentials","gamification_data","achievements","level_data","xp_history","streaks","workoutHistory","rep_counter_data","exercise_history","exported_pdfs_metadata","pdf_file_paths","last_export_dates","breathing_history","breathing_voice_preference","locationHistory","knownLocations","detectedHabits","ai_memory_data","user_context","ai_learned_preferences","analytics_events","error_logs","user_feedback","subscription_plan","subscription_status","subscription_period_end","sync_queue","healthMetrics","health_data","health_history","ml_user_patterns","notificationSettings","themeSettings","dark_mode","dark_mode_auto","onboardingCompleted","subscription_plan","paywall_interactions"],window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),this.startAuthChecker()}startAuthChecker(){this.authCheckInterval||(console.log(" SYNC SERVICE: Auth checker started (checks every 2s)"),this.authCheckInterval=setInterval(async()=>{Fi.isAuthenticated()&&this.syncQueue.length>0&&(console.log(" SYNC SERVICE: Auth ready! Processing",this.syncQueue.length,"queued items"),await this.processSyncQueue())},2e3))}stopAuthChecker(){this.authCheckInterval&&(clearInterval(this.authCheckInterval),this.authCheckInterval=null)}async initialize(){try{if(console.log(" SYNC SERVICE: Initializing..."),!Fi.initialize())return console.warn(" SYNC SERVICE: Firebase not configured, offline-only mode"),!1;console.log(" SYNC SERVICE: Firebase initialized"),this.database=D4();try{const{value:n}=await gn.get({key:"wellnessai_migration_v1"});if(n)console.log(" Migration already completed, skipping");else{console.log(" First app start after update, running data migration...");const r=Fi.getCurrentUser();await this.migrateStepDataToAndroidKeys(r?.uid||null),await gn.set({key:"wellnessai_migration_v1",value:"true"}),console.log(" Migration flag set, will not run again")}}catch(n){console.error(" Migration failed but continuing:",n)}const t=Fi.getCurrentUser();return t?(console.log(" SYNC SERVICE: Initialized for user:",t.email||t.uid),console.log(" SYNC SERVICE: Queue has",this.syncQueue.length,"pending items"),this.isOnline?(console.log(" SYNC SERVICE: Online, starting aggressive sync..."),await this.aggressiveSyncAllData()):console.log(" SYNC SERVICE: Offline, will sync when online"),!0):(console.log(" SYNC SERVICE: No user logged in yet, waiting for auth..."),console.log(" SYNC SERVICE: Auth checker running (checks every 2s)"),!1)}catch(e){return console.error(" SYNC SERVICE: Initialization failed:",e),!1}}async handleOnline(){this.isOnline=!0,await this.aggressiveSyncAllData()}handleOffline(){this.isOnline=!1}async saveData(e,t,n=null){try{const r=this.criticalKeys.includes(e);if(localStorage.setItem(e,JSON.stringify(t)),console.log(` SYNC: Saved to localStorage: ${e}`),r&&(await gn.set({key:`wellnessai_${e}`,value:JSON.stringify(t)}),console.log(` SYNC: Saved to Preferences (permanent): ${e}`)),this.isOnline&&Fi.isAuthenticated()){const s=n||Fi.getCurrentUserId();if(s)try{return await Fi.updateUserProfile(s,{[e]:t}),console.log(`  SYNC: Firebase synced: ${e}`),{success:!0}}catch(l){console.error(`  SYNC: Firebase failed for ${e}:`,l.message),this.addToSyncQueue({key:e,value:t,action:"save",userId:s})}else console.log(` SYNC: No user ID, queuing: ${e}`),this.addToSyncQueue({key:e,value:t,action:"save"})}else console.log(` SYNC: Queued: ${e} (auth: ${Fi.isAuthenticated()}, online: ${this.isOnline})`),this.addToSyncQueue({key:e,value:t,action:"save",userId:n}),this.startAggressiveRetry();return{success:!0}}catch(r){return this.addToSyncQueue({key:e,value:t,action:"save",userId:n}),{success:!1,error:r.message}}}async getData(e,t=null){try{const n=this.criticalKeys.includes(e);if(n){const{value:s}=await gn.get({key:`wellnessai_${e}`});if(s)try{const l=JSON.parse(s);return localStorage.setItem(e,JSON.stringify(l)),l}catch{}}if(this.isOnline&&Fi.isAuthenticated()){const s=t||Fi.getCurrentUserId();if(s){const l=await Fi.getUserProfile(s);if(l&&l[e])return n&&await gn.set({key:`wellnessai_${e}`,value:JSON.stringify(l[e])}),localStorage.setItem(e,JSON.stringify(l[e])),l[e]}}const r=localStorage.getItem(e);if(r)try{const s=JSON.parse(r);return n&&await gn.set({key:`wellnessai_${e}`,value:r}),s}catch{return localStorage.removeItem(e),n&&await gn.remove({key:`wellnessai_${e}`}),e==="weeklySteps"?[{steps:0,date:null},{steps:0,date:null},{steps:0,date:null},{steps:0,date:null},{steps:0,date:null},{steps:0,date:null},{steps:0,date:null}]:null}return null}catch{try{const r=localStorage.getItem(e);if(r)return JSON.parse(r)}catch{localStorage.removeItem(e)}return null}}async saveHealthData(e,t,n){try{const r=`${e}_${t}`;if(localStorage.setItem(r,JSON.stringify(n)),this.isOnline&&Fi.isAuthenticated()){const s=Fi.getCurrentUserId();s&&await Fi.saveHealthData(s,t,e,n)}else this.addToSyncQueue({dataType:e,date:t,data:n,action:"saveHealth"});return{success:!0}}catch(r){return{success:!1,error:r.message}}}async getHealthData(e,t){try{if(this.isOnline&&Fi.isAuthenticated()){const s=Fi.getCurrentUserId();if(s){const l=await Fi.getHealthData(s,t,e);if(l){const u=`${e}_${t}`;return localStorage.setItem(u,JSON.stringify(l)),l}}}const n=`${e}_${t}`,r=localStorage.getItem(n);return r?JSON.parse(r):null}catch{const r=`${e}_${t}`,s=localStorage.getItem(r);return s?JSON.parse(s):null}}addToSyncQueue(e){const t=this.syncQueue.findIndex(n=>n.key===e.key&&n.action===e.action);t>=0?this.syncQueue[t]={...e,timestamp:Date.now(),retryCount:this.syncQueue[t].retryCount||0}:this.syncQueue.push({...e,timestamp:Date.now(),retryCount:0}),this.startAggressiveRetry()}startAggressiveRetry(){if(this.retryTimer)return;console.log(" SYNC: Starting aggressive retry timer");let e=5e3;const t=6e4,n=async()=>{if(this.syncQueue.length===0){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null,console.log(" SYNC: Queue empty, stopping retry timer"));return}Fi.isAuthenticated()&&this.isOnline?(console.log(" SYNC: Retry attempt -",this.syncQueue.length,"items in queue"),await this.processSyncQueue(),e=5e3):(console.log(" SYNC: Waiting... (auth:",Fi.isAuthenticated(),", online:",this.isOnline,")"),e=Math.min(e*1.5,t)),this.retryTimer=setTimeout(n,e)};this.retryTimer=setTimeout(n,e)}async processSyncQueue(){if(this.syncQueue.length===0||!Fi.isAuthenticated()||!this.isOnline)return;const e=Fi.getCurrentUserId();if(!e)return;const t=[],n=[];for(const r of this.syncQueue)try{r.action==="save"?(await Fi.updateUserProfile(r.userId||e,{[r.key]:r.value}),console.log(`  SYNC: Firebase synced queued item: ${r.key}`),t.push(r)):r.action==="saveHealth"&&(await Fi.saveHealthData(e,r.date,r.dataType,r.data),console.log(`  SYNC: Firebase synced health data: ${r.dataType}`),t.push(r))}catch(s){console.error(`  SYNC: Failed to sync ${r.key||r.dataType}:`,s.message);const l=(r.retryCount||0)+1;l<this.maxRetries?(n.push({...r,retryCount:l}),console.log(` SYNC: Will retry ${r.key||r.dataType} (attempt ${l}/${this.maxRetries})`)):(console.error(` SYNC: Max retries reached for ${r.key||r.dataType}, giving up`),console.error("CRITICAL: Failed to sync after max retries:",r.key||r.dataType,r.value||r.data))}this.syncQueue=n,console.log(` SYNC: Processed ${t.length} items, ${n.length} failed`),this.lastSyncTime=new Date().toISOString()}async aggressiveSyncAllData(){if(!this.isSyncing)try{this.isSyncing=!0,console.log(" SYNC: Starting AGGRESSIVE full data sync...");const e=Fi.getCurrentUserId();if(!e){console.log(" SYNC: No user logged in, will retry"),this.isSyncing=!1,this.startAggressiveRetry();return}await this.processSyncQueue(),console.log(" SYNC: Queue processed, now syncing all critical keys...");const t=["stepBaseline","stepBaselineDate","weeklySteps","todaySteps","stepHistory","step_counter_baseline","step_counter_date","waterLog","water_daily_goal","water_today_intake","water_intake_history","water_reminders","foodLog","meal_plans","meal_preferences","saved_recipes","workoutLog","workoutHistory","activityLog","rep_history","exercise_preferences","heart_rate_history","hr_device_name","heartRateData","sleepLog","sleep_history","current_sleep_session","meditationLog","meditation_history","gratitudeLog","journalEntries","gratitude_entries","stressLog","mood_history","user_profile","profile_data","user_preferences","allergens","dietary_restrictions","health_goals","health_avatar_data","avatar_predictions","avatar_history","emergency_data","emergency_contacts","emergencyHistory","medical_info","dnaAnalysis","dnaRawData","dna_last_tip","dna_last_tip_date","genetic_predictions","battles_data","battle_history","battle_stats","meal_automation_settings","automated_meals","meal_schedule","loginHistory","social_login_provider","social_login_data","gamification_data","achievements","level_data","xp_history","streaks","healthMetrics","health_data","health_history","ml_user_patterns","notificationSettings","themeSettings","dark_mode","dark_mode_auto","onboardingCompleted","subscription_plan","paywall_interactions"];let n=0,r=0;for(const s of t)try{let l=null;if(this.criticalKeys.includes(s)){const{value:u}=await gn.get({key:`wellnessai_${s}`});u&&(l=JSON.parse(u))}if(l===null){const u=localStorage.getItem(s);u&&(l=JSON.parse(u))}l!=null&&(await Fi.updateUserProfile(e,{[s]:l}),n++,console.log(`  SYNC: Synced ${s} to Firebase`))}catch(l){r++,console.error(`  SYNC: Failed to sync ${s}:`,l.message),this.criticalKeys.includes(s)&&this.addToSyncQueue({key:s,value:null,action:"save"})}console.log(` SYNC: Aggressive sync complete - ${n} synced, ${r} failed`),console.log(" SYNC: Aggressive full sync complete"),this.lastSyncTime=new Date().toISOString()}catch{this.startAggressiveRetry()}finally{this.isSyncing=!1}}async syncAllData(){return this.aggressiveSyncAllData()}async pullFromFirebase(){try{const e=Fi.getCurrentUserId();if(!e)return;console.log(" RESTORATION: Pulling all data from Firebase cloud...");const t=await Fi.getUserProfile(e);t&&Object.keys(t).forEach(r=>{(typeof t[r]!="object"||Array.isArray(t[r]))&&localStorage.setItem(r,JSON.stringify(t[r]))});let n=0;for(const r of this.criticalKeys)try{const s=Yo(this.database,`users/${e}/${r}`),l=await Nh(s);if(l.exists()){const u=l.val();localStorage.setItem(r,JSON.stringify(u)),console.log(` Pulled from Firebase: ${r}`),n++}}catch{}console.log(` RESTORATION: Pulled ${n} items from Firebase cloud`)}catch(e){console.error(" RESTORATION: Pull from Firebase failed:",e)}}async migrateStepDataToAndroidKeys(e){try{console.log(" MIGRATION: Starting step data migration to Android keys...");let t=[];try{const u=localStorage.getItem("stepHistory");u&&(t=JSON.parse(u),console.log(` Found ${t.length} entries in localStorage`))}catch{console.warn(" Could not read old stepHistory from localStorage")}let n=[];try{const{value:u}=await gn.get({key:"wellnessai_stepHistory"});u&&(n=JSON.parse(u),console.log(` Found ${n.length} entries in Android CapacitorStorage`))}catch{console.warn(" Could not read wellnessai_stepHistory from Preferences")}const r=[...t];let s=0,l=0;for(const u of n){const h=r.findIndex(f=>f.date===u.date);h>=0?(r[h]=u,s++):(r.push(u),l++)}if(console.log(` MERGE: ${r.length} total entries (${s} updated, ${l} added)`),await gn.set({key:"wellnessai_stepHistory",value:JSON.stringify(r)}),console.log(` Saved ${r.length} entries to wellnessai_stepHistory`),localStorage.setItem("stepHistory",JSON.stringify(r)),e&&Fi.isAuthenticated())try{await Fi.updateUserProfile(e,{stepHistory:r}),console.log(" Synced merged data to Firebase")}catch{console.warn(" Firebase sync failed, will retry later")}return console.log(" MIGRATION: Step data migration complete!"),{success:!0,entriesCount:r.length}}catch(t){return console.error(" MIGRATION: Failed:",t),{success:!1,error:t.message}}}async onUserLogin(e){try{console.log(" RESTORATION: User logged in, restoring all data...");let t=0;for(const n of this.criticalKeys)try{const{value:r}=await gn.get({key:`wellnessai_${n}`});if(r){const s=JSON.parse(r);localStorage.setItem(n,JSON.stringify(s)),t++,console.log(` Restored from Preferences: ${n}`)}}catch{}return console.log(` RESTORATION: Restored ${t} items from Preferences`),await this.pullFromFirebase(),console.log(" RESTORATION: Syncing current state to cloud..."),await this.syncAllData(),console.log(" RESTORATION: Complete! All your data has been restored."),{success:!0}}catch(t){return console.error(" RESTORATION: User login sync failed:",t),{success:!1,error:t.message}}}async onUserLogout(){try{return await this.syncAllData(),{success:!0}}catch(e){return{success:!1,error:e.message}}}getSyncStatus(){return{isOnline:this.isOnline,isSyncing:this.isSyncing,queueSize:this.syncQueue.length,lastSyncTime:this.lastSyncTime,isAuthenticated:Fi.isAuthenticated()}}async forceSync(){return await this.syncAllData()}async cleanupOldData(){try{const e=Date.now()-15552e6,t=JSON.parse(localStorage.getItem("stepHistory")||"[]");if(Array.isArray(t)){const l=Date.now()-7776e6,u=t.filter(h=>{try{return new Date(h.date).getTime()>=l}catch{return!1}});u.length<t.length&&localStorage.setItem("stepHistory",JSON.stringify(u))}const n=JSON.parse(localStorage.getItem("foodLog")||"[]");if(Array.isArray(n)){const l=Date.now()-7776e6,u=n.filter(h=>{try{return new Date(h.timestamp||h.date).getTime()>=l}catch{return!1}});u.length<n.length&&localStorage.setItem("foodLog",JSON.stringify(u))}let r=0;for(let l in localStorage)localStorage.hasOwnProperty(l)&&(r+=localStorage[l].length+l.length);const s=(r/1024/1024).toFixed(2);return r>4*1024*1024&&console.warn(" localStorage usage high:",s,"MB - consider additional cleanup"),{totalSize:r,sizeMB:s}}catch{return{totalSize:0,sizeMB:"0"}}}async manualBackupToCloud(){try{console.log(" MANUAL BACKUP: Starting full backup to cloud...");const e=Fi.getCurrentUserId();if(!e)throw new Error("Not logged in");let t=0,n=0;for(const s of this.criticalKeys)try{const l=localStorage.getItem(s);if(l){await gn.set({key:`wellnessai_${s}`,value:l});const u=Yo(this.database,`users/${e}/${s}`);await Yf(u,JSON.parse(l)),t++}}catch(l){console.error(` Backup failed for ${s}:`,l.message),n++}const r=new Date().toISOString();return await gn.set({key:"last_backup_timestamp",value:r}),console.log(` MANUAL BACKUP: Complete! ${t} items backed up, ${n} failed`),{success:!0,backedUpCount:t,failedCount:n,timestamp:r}}catch(e){return console.error(" MANUAL BACKUP: Failed:",e),{success:!1,error:e.message}}}async manualRestoreFromCloud(){try{console.log(" MANUAL RESTORE: Starting restore from cloud...");const e=Fi.getCurrentUserId();if(!e)throw new Error("Not logged in");let t=0,n=0;for(const r of this.criticalKeys)try{const s=Yo(this.database,`users/${e}/${r}`),l=await Nh(s);if(l.exists()){const u=l.val();localStorage.setItem(r,JSON.stringify(u)),await gn.set({key:`wellnessai_${r}`,value:JSON.stringify(u)}),console.log(` Restored from cloud: ${r}`),t++}}catch(s){console.error(` Restore failed for ${r}:`,s.message),n++}return console.log(` MANUAL RESTORE: Complete! ${t} items restored, ${n} failed`),{success:!0,restoredCount:t,failedCount:n}}catch(e){return console.error(" MANUAL RESTORE: Failed:",e),{success:!1,error:e.message}}}async getLastBackupTime(){try{const{value:e}=await gn.get({key:"last_backup_timestamp"});return e||null}catch{return null}}getStorageStats(){try{let e=0;const t={};for(let n in localStorage)if(localStorage.hasOwnProperty(n)){const r=localStorage[n].length+n.length;e+=r,t[n]=(r/1024).toFixed(2)+" KB"}return{totalSize:(e/1024/1024).toFixed(2)+" MB",percentUsed:(e/(5*1024*1024)*100).toFixed(1)+"%",itemSizes:t}}catch{return null}}}const Xh=new mG,Yy=Object.freeze(Object.defineProperty({__proto__:null,default:Xh},Symbol.toStringTag,{value:"Module"})),yG={apiKey:"AIzaSyAUv69QXH4MNNR2wkr_wcVH_cbsYrc3wjo",authDomain:"wellnessai-app-e01be.firebaseapp.com",databaseURL:"https://wellnessai-app-e01be-default-rtdb.europe-west1.firebasedatabase.app",projectId:"wellnessai-app-e01be",storageBucket:"wellnessai-app-e01be.firebasestorage.app",messagingSenderId:"863551474584",appId:"1:863551474584:web:a34f3f77742b7be4e7f9ed"},Y4=V1(yG,"firestoreApp"),Px=sL(Y4),Tg=b2(Y4);try{s9(Px).catch(i=>{i.code==="failed-precondition"?console.warn(" Firestore persistence: Multiple tabs open"):i.code==="unimplemented"&&console.warn(" Firestore persistence: Browser not supported")}),console.log(" Firestore offline persistence enabled")}catch(i){console.warn(" Firestore persistence setup failed:",i)}class vG{constructor(){this.cache=new Map,this.saveQueue=[],this.isOnline=navigator.onLine,this.authInitialized=!1,window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),this.initAuth()}async initAuth(){try{Tg.currentUser||(await g8(Tg),console.log(" Firebase Auth initialized (anonymous)")),this.authInitialized=!0}catch(e){console.error(" Firebase Auth init failed:",e),this.authInitialized=!0}}async getDeviceId(){try{const{Preferences:e}=await Vt(async()=>{const{Preferences:r}=await Promise.resolve().then(()=>_L);return{Preferences:r}},void 0),{value:t}=await e.get({key:"device_id"});if(t)return t;const n="device_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);return await e.set({key:"device_id",value:n}),console.log(" Generated device ID:",n),n}catch{return"device_"+Date.now()}}async save(e,t,n=null){try{this.authInitialized||await this.initAuth();let r=n||Tg.currentUser?.uid;r||(r=await this.getDeviceId(),console.log(` Using device ID: ${r}`)),this.cache.set(e,t),localStorage.setItem(e,JSON.stringify(t));const s=AE(Px,"users",r,"data",e);return await x9(s,{value:t,updatedAt:new Date().toISOString(),key:e},{merge:!0}),this.cache.delete(e),console.log(` Firestore saved [${r.substring(0,20)}...]: ${e}`),{success:!0}}catch(r){console.error(` Firestore save error for ${e}:`,r);try{localStorage.setItem(e,JSON.stringify(t)),console.log(` Fallback to localStorage: ${e}`)}catch(s){console.error(" localStorage fallback failed:",s)}return{success:!1,error:r.message}}}async get(e,t=null){try{if(this.cache.has(e))return this.cache.get(e);const n=localStorage.getItem(e);if(n)try{const s=JSON.parse(n);this.cache.set(e,s)}catch{this.cache.set(e,n)}this.authInitialized||await this.initAuth();let r=t||Tg.currentUser?.uid;if(r||(r=await this.getDeviceId()),r){const s=AE(Px,"users",r,"data",e),l=await _9(s);if(l.exists()){const u=l.data().value;return this.cache.set(e,u),localStorage.setItem(e,JSON.stringify(u)),console.log(` Firestore loaded: ${e}`),u}}return this.cache.get(e)||null}catch(n){console.error(` Firestore get error for ${e}:`,n);const r=localStorage.getItem(e);if(r)try{return JSON.parse(r)}catch{return r}return null}}async saveHealthData(e,t,n){const r=`${e}_${t}`;return this.save(r,n)}async getHealthData(e,t){const n=`${e}_${t}`;return this.get(n)}async handleOnline(){for(console.log(" Firestore: Device online, syncing..."),this.isOnline=!0;this.saveQueue.length>0;){const e=this.saveQueue.shift();await this.save(e.key,e.value,e.userId)}}handleOffline(){console.log(" Firestore: Device offline, will sync when online"),this.isOnline=!1}clearCache(){this.cache.clear(),console.log(" Firestore cache cleared")}getStatus(){return{online:this.isOnline,authenticated:!!Tg.currentUser,cacheSize:this.cache.size,queueSize:this.saveQueue.length}}}const Ei=new vG,hY=Object.freeze(Object.defineProperty({__proto__:null,default:Ei},Symbol.toStringTag,{value:"Module"}));var Mg={exports:{}},_G=Mg.exports,yI;function bG(){return yI||(yI=1,(function(i,e){(function(t,n){n(e)})(_G,(function(t){function n(O){return Math.max(0,O)}function r(O,d){return O<=0?0:d}var s=Object.freeze({__proto__:null,activate:n,measure:r});function l(O){return 1/(1+Math.exp(-O))}function u(O,d){return O*(1-O)*d}var h=Object.freeze({__proto__:null,activate:l,measure:u});function f(O){return Math.tanh(O)}function x(O,d){return(1-O*O)*d}var g=Object.freeze({__proto__:null,activate:f,measure:x});function w(O){return O>0?O:.01*O}function A(O,d){return O>0?d:.01*d}var B=Object.freeze({__proto__:null,activate:w,measure:A}),$=Object.freeze({__proto__:null,relu:s,sigmoid:h,tanh:g,leakyRelu:B}),W=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Rd<"u"?Rd:typeof self<"u"?self:{};function q(O,d,p){return p={path:d,exports:{},require:function(y,N){return ge(y,N??p.path)}},O(p,p.exports),p.exports}function ge(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var he=q(function(O,d){(function(p){O.exports=p()})(function(){return(function(){function p(y,N,L){function F(k,R){if(!N[k]){if(!y[k]){var S=typeof ge=="function"&&ge;if(!R&&S)return S(k,!0);if(z)return z(k,!0);var T=new Error("Cannot find module '"+k+"'");throw T.code="MODULE_NOT_FOUND",T}var H=N[k]={exports:{}};y[k][0].call(H.exports,function(te){var Se=y[k][1][te];return F(Se||te)},H,H.exports,p,y,N,L)}return N[k].exports}for(var z=typeof ge=="function"&&ge,P=0;P<L.length;P++)F(L[P]);return F}return p})()({1:[function(p,y,N){(function(L,F){typeof N=="object"&&typeof y<"u"?F(N):(L=L||self,F(L.acorn={}))})(this,function(L){var F={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},z="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",P={5:z,"5module":z+" export import",6:z+" const class extends export import super"},k=/^in(stanceof)?$/,R="---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",S="--------------------------------------------------------------------------------------------------------------------------------------------------",T=new RegExp("["+R+"]"),H=new RegExp("["+R+S+"]");R=S=null;var te=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,477,28,11,0,9,21,155,22,13,52,76,44,33,24,27,35,30,0,12,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,0,33,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,0,161,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,270,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,754,9486,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,15,7472,3104,541],Se=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,525,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,4,9,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,232,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,792487,239];function ie(_,V){for(var ce=65536,Le=0;Le<V.length;Le+=2){if(ce+=V[Le],ce>_)return!1;if(ce+=V[Le+1],ce>=_)return!0}}function _e(_,V){return _<65?_===36:_<91?!0:_<97?_===95:_<123?!0:_<=65535?_>=170&&T.test(String.fromCharCode(_)):V===!1?!1:ie(_,te)}function Y(_,V){return _<48?_===36:_<58?!0:_<65?!1:_<91?!0:_<97?_===95:_<123?!0:_<=65535?_>=170&&H.test(String.fromCharCode(_)):V===!1?!1:ie(_,te)||ie(_,Se)}var re=function(V,ce){ce===void 0&&(ce={}),this.label=V,this.keyword=ce.keyword,this.beforeExpr=!!ce.beforeExpr,this.startsExpr=!!ce.startsExpr,this.isLoop=!!ce.isLoop,this.isAssign=!!ce.isAssign,this.prefix=!!ce.prefix,this.postfix=!!ce.postfix,this.binop=ce.binop||null,this.updateContext=null};function be(_,V){return new re(_,{beforeExpr:!0,binop:V})}var ke={beforeExpr:!0},it={startsExpr:!0},vt={};function Q(_,V){return V===void 0&&(V={}),V.keyword=_,vt[_]=new re(_,V)}var U={num:new re("num",it),regexp:new re("regexp",it),string:new re("string",it),name:new re("name",it),eof:new re("eof"),bracketL:new re("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new re("]"),braceL:new re("{",{beforeExpr:!0,startsExpr:!0}),braceR:new re("}"),parenL:new re("(",{beforeExpr:!0,startsExpr:!0}),parenR:new re(")"),comma:new re(",",ke),semi:new re(";",ke),colon:new re(":",ke),dot:new re("."),question:new re("?",ke),arrow:new re("=>",ke),template:new re("template"),invalidTemplate:new re("invalidTemplate"),ellipsis:new re("...",ke),backQuote:new re("`",it),dollarBraceL:new re("${",{beforeExpr:!0,startsExpr:!0}),eq:new re("=",{beforeExpr:!0,isAssign:!0}),assign:new re("_=",{beforeExpr:!0,isAssign:!0}),incDec:new re("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new re("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:be("||",1),logicalAND:be("&&",2),bitwiseOR:be("|",3),bitwiseXOR:be("^",4),bitwiseAND:be("&",5),equality:be("==/!=/===/!==",6),relational:be("</>/<=/>=",7),bitShift:be("<</>>/>>>",8),plusMin:new re("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:be("%",10),star:be("*",10),slash:be("/",10),starstar:new re("**",{beforeExpr:!0}),_break:Q("break"),_case:Q("case",ke),_catch:Q("catch"),_continue:Q("continue"),_debugger:Q("debugger"),_default:Q("default",ke),_do:Q("do",{isLoop:!0,beforeExpr:!0}),_else:Q("else",ke),_finally:Q("finally"),_for:Q("for",{isLoop:!0}),_function:Q("function",it),_if:Q("if"),_return:Q("return",ke),_switch:Q("switch"),_throw:Q("throw",ke),_try:Q("try"),_var:Q("var"),_const:Q("const"),_while:Q("while",{isLoop:!0}),_with:Q("with"),_new:Q("new",{beforeExpr:!0,startsExpr:!0}),_this:Q("this",it),_super:Q("super",it),_class:Q("class",it),_extends:Q("extends",ke),_export:Q("export"),_import:Q("import",it),_null:Q("null",it),_true:Q("true",it),_false:Q("false",it),_in:Q("in",{beforeExpr:!0,binop:7}),_instanceof:Q("instanceof",{beforeExpr:!0,binop:7}),_typeof:Q("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Q("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Q("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Oe=/\r\n?|\n|\u2028|\u2029/,Fe=new RegExp(Oe.source,"g");function bt(_,V){return _===10||_===13||!V&&(_===8232||_===8233)}var v=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,I=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,M=Object.prototype,G=M.hasOwnProperty,oe=M.toString;function de(_,V){return G.call(_,V)}var ue=Array.isArray||(function(_){return oe.call(_)==="[object Array]"});function ve(_){return new RegExp("^(?:"+_.replace(/ /g,"|")+")$")}var xe=function(V,ce){this.line=V,this.column=ce};xe.prototype.offset=function(V){return new xe(this.line,this.column+V)};var Re=function(V,ce,Le){this.start=ce,this.end=Le,V.sourceFile!==null&&(this.source=V.sourceFile)};function Ue(_,V){for(var ce=1,Le=0;;){Fe.lastIndex=Le;var Ge=Fe.exec(_);if(Ge&&Ge.index<V)++ce,Le=Ge.index+Ge[0].length;else return new xe(ce,V-Le)}}var Xe={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Ae(_){var V={};for(var ce in Xe)V[ce]=_&&de(_,ce)?_[ce]:Xe[ce];if(V.ecmaVersion>=2015&&(V.ecmaVersion-=2009),V.allowReserved==null&&(V.allowReserved=V.ecmaVersion<5),ue(V.onToken)){var Le=V.onToken;V.onToken=function(Ge){return Le.push(Ge)}}return ue(V.onComment)&&(V.onComment=He(V,V.onComment)),V}function He(_,V){return function(ce,Le,Ge,mt,Ct,Jt){var Dn={type:ce?"Block":"Line",value:Le,start:Ge,end:mt};_.locations&&(Dn.loc=new Re(this,Ct,Jt)),_.ranges&&(Dn.range=[Ge,mt]),V.push(Dn)}}var et=1,at=2,Ze=et|at,gt=4,wt=8,Lt=16,ht=32,Ut=64,Bt=128;function An(_,V){return at|(_?gt:0)|(V?wt:0)}var Zt=0,vi=1,Ui=2,si=3,nn=4,Gt=5,ei=function(V,ce,Le){this.options=V=Ae(V),this.sourceFile=V.sourceFile,this.keywords=ve(P[V.ecmaVersion>=6?6:V.sourceType==="module"?"5module":5]);var Ge="";if(V.allowReserved!==!0){for(var mt=V.ecmaVersion;!(Ge=F[mt]);mt--);V.sourceType==="module"&&(Ge+=" await")}this.reservedWords=ve(Ge);var Ct=(Ge?Ge+" ":"")+F.strict;this.reservedWordsStrict=ve(Ct),this.reservedWordsStrictBind=ve(Ct+" "+F.strictBind),this.input=String(ce),this.containsEsc=!1,Le?(this.pos=Le,this.lineStart=this.input.lastIndexOf(`
`,Le-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Oe).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=U.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=V.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&V.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(et),this.regexpState=null},Ln={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};ei.prototype.parse=function(){var V=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(V)},Ln.inFunction.get=function(){return(this.currentVarScope().flags&at)>0},Ln.inGenerator.get=function(){return(this.currentVarScope().flags&wt)>0},Ln.inAsync.get=function(){return(this.currentVarScope().flags&gt)>0},Ln.allowSuper.get=function(){return(this.currentThisScope().flags&Ut)>0},Ln.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Bt)>0},Ln.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},ei.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&at)>0},ei.extend=function(){for(var V=[],ce=arguments.length;ce--;)V[ce]=arguments[ce];for(var Le=this,Ge=0;Ge<V.length;Ge++)Le=V[Ge](Le);return Le},ei.parse=function(V,ce){return new this(ce,V).parse()},ei.parseExpressionAt=function(V,ce,Le){var Ge=new this(Le,V,ce);return Ge.nextToken(),Ge.parseExpression()},ei.tokenizer=function(V,ce){return new this(ce,V)},Object.defineProperties(ei.prototype,Ln);var Nn=ei.prototype,ur=/^(?:'((?:\\.|[^'])*?)'|"((?:\\.|[^"])*?)")/;Nn.strictDirective=function(_){for(;;){I.lastIndex=_,_+=I.exec(this.input)[0].length;var V=ur.exec(this.input.slice(_));if(!V)return!1;if((V[1]||V[2])==="use strict")return!0;_+=V[0].length,I.lastIndex=_,_+=I.exec(this.input)[0].length,this.input[_]===";"&&_++}},Nn.eat=function(_){return this.type===_?(this.next(),!0):!1},Nn.isContextual=function(_){return this.type===U.name&&this.value===_&&!this.containsEsc},Nn.eatContextual=function(_){return this.isContextual(_)?(this.next(),!0):!1},Nn.expectContextual=function(_){this.eatContextual(_)||this.unexpected()},Nn.canInsertSemicolon=function(){return this.type===U.eof||this.type===U.braceR||Oe.test(this.input.slice(this.lastTokEnd,this.start))},Nn.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Nn.semicolon=function(){!this.eat(U.semi)&&!this.insertSemicolon()&&this.unexpected()},Nn.afterTrailingComma=function(_,V){if(this.type===_)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),V||this.next(),!0},Nn.expect=function(_){this.eat(_)||this.unexpected()},Nn.unexpected=function(_){this.raise(_??this.start,"Unexpected token")};function is(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Nn.checkPatternErrors=function(_,V){if(_){_.trailingComma>-1&&this.raiseRecoverable(_.trailingComma,"Comma is not permitted after the rest element");var ce=V?_.parenthesizedAssign:_.parenthesizedBind;ce>-1&&this.raiseRecoverable(ce,"Parenthesized pattern")}},Nn.checkExpressionErrors=function(_,V){if(!_)return!1;var ce=_.shorthandAssign,Le=_.doubleProto;if(!V)return ce>=0||Le>=0;ce>=0&&this.raise(ce,"Shorthand property assignments are valid only in destructuring patterns"),Le>=0&&this.raiseRecoverable(Le,"Redefinition of __proto__ property")},Nn.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Nn.isSimpleAssignTarget=function(_){return _.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(_.expression):_.type==="Identifier"||_.type==="MemberExpression"};var Sn=ei.prototype;Sn.parseTopLevel=function(_){var V={};for(_.body||(_.body=[]);this.type!==U.eof;){var ce=this.parseStatement(null,!0,V);_.body.push(ce)}if(this.inModule)for(var Le=0,Ge=Object.keys(this.undefinedExports);Le<Ge.length;Le+=1){var mt=Ge[Le];this.raiseRecoverable(this.undefinedExports[mt].start,"Export '"+mt+"' is not defined")}return this.adaptDirectivePrologue(_.body),this.next(),_.sourceType=this.options.sourceType,this.finishNode(_,"Program")};var pr={kind:"loop"},vs={kind:"switch"};Sn.isLet=function(_){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;I.lastIndex=this.pos;var V=I.exec(this.input),ce=this.pos+V[0].length,Le=this.input.charCodeAt(ce);if(Le===91)return!0;if(_)return!1;if(Le===123)return!0;if(_e(Le,!0)){for(var Ge=ce+1;Y(this.input.charCodeAt(Ge),!0);)++Ge;var mt=this.input.slice(ce,Ge);if(!k.test(mt))return!0}return!1},Sn.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;I.lastIndex=this.pos;var _=I.exec(this.input),V=this.pos+_[0].length;return!Oe.test(this.input.slice(this.pos,V))&&this.input.slice(V,V+8)==="function"&&(V+8===this.input.length||!Y(this.input.charAt(V+8)))},Sn.parseStatement=function(_,V,ce){var Le=this.type,Ge=this.startNode(),mt;switch(this.isLet(_)&&(Le=U._var,mt="let"),Le){case U._break:case U._continue:return this.parseBreakContinueStatement(Ge,Le.keyword);case U._debugger:return this.parseDebuggerStatement(Ge);case U._do:return this.parseDoStatement(Ge);case U._for:return this.parseForStatement(Ge);case U._function:return _&&(this.strict||_!=="if"&&_!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(Ge,!1,!_);case U._class:return _&&this.unexpected(),this.parseClass(Ge,!0);case U._if:return this.parseIfStatement(Ge);case U._return:return this.parseReturnStatement(Ge);case U._switch:return this.parseSwitchStatement(Ge);case U._throw:return this.parseThrowStatement(Ge);case U._try:return this.parseTryStatement(Ge);case U._const:case U._var:return mt=mt||this.value,_&&mt!=="var"&&this.unexpected(),this.parseVarStatement(Ge,mt);case U._while:return this.parseWhileStatement(Ge);case U._with:return this.parseWithStatement(Ge);case U.braceL:return this.parseBlock(!0,Ge);case U.semi:return this.parseEmptyStatement(Ge);case U._export:case U._import:if(this.options.ecmaVersion>10&&Le===U._import){I.lastIndex=this.pos;var Ct=I.exec(this.input),Jt=this.pos+Ct[0].length,Dn=this.input.charCodeAt(Jt);if(Dn===40)return this.parseExpressionStatement(Ge,this.parseExpression())}return this.options.allowImportExportEverywhere||(V||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),Le===U._import?this.parseImport(Ge):this.parseExport(Ge,ce);default:if(this.isAsyncFunction())return _&&this.unexpected(),this.next(),this.parseFunctionStatement(Ge,!0,!_);var $i=this.value,Ks=this.parseExpression();return Le===U.name&&Ks.type==="Identifier"&&this.eat(U.colon)?this.parseLabeledStatement(Ge,$i,Ks,_):this.parseExpressionStatement(Ge,Ks)}},Sn.parseBreakContinueStatement=function(_,V){var ce=V==="break";this.next(),this.eat(U.semi)||this.insertSemicolon()?_.label=null:this.type!==U.name?this.unexpected():(_.label=this.parseIdent(),this.semicolon());for(var Le=0;Le<this.labels.length;++Le){var Ge=this.labels[Le];if((_.label==null||Ge.name===_.label.name)&&(Ge.kind!=null&&(ce||Ge.kind==="loop")||_.label&&ce))break}return Le===this.labels.length&&this.raise(_.start,"Unsyntactic "+V),this.finishNode(_,ce?"BreakStatement":"ContinueStatement")},Sn.parseDebuggerStatement=function(_){return this.next(),this.semicolon(),this.finishNode(_,"DebuggerStatement")},Sn.parseDoStatement=function(_){return this.next(),this.labels.push(pr),_.body=this.parseStatement("do"),this.labels.pop(),this.expect(U._while),_.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(U.semi):this.semicolon(),this.finishNode(_,"DoWhileStatement")},Sn.parseForStatement=function(_){this.next();var V=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(pr),this.enterScope(0),this.expect(U.parenL),this.type===U.semi)return V>-1&&this.unexpected(V),this.parseFor(_,null);var ce=this.isLet();if(this.type===U._var||this.type===U._const||ce){var Le=this.startNode(),Ge=ce?"let":this.value;return this.next(),this.parseVar(Le,!0,Ge),this.finishNode(Le,"VariableDeclaration"),(this.type===U._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&Le.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===U._in?V>-1&&this.unexpected(V):_.await=V>-1),this.parseForIn(_,Le)):(V>-1&&this.unexpected(V),this.parseFor(_,Le))}var mt=new is,Ct=this.parseExpression(!0,mt);return this.type===U._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===U._in?V>-1&&this.unexpected(V):_.await=V>-1),this.toAssignable(Ct,!1,mt),this.checkLVal(Ct),this.parseForIn(_,Ct)):(this.checkExpressionErrors(mt,!0),V>-1&&this.unexpected(V),this.parseFor(_,Ct))},Sn.parseFunctionStatement=function(_,V,ce){return this.next(),this.parseFunction(_,zr|(ce?0:di),!1,V)},Sn.parseIfStatement=function(_){return this.next(),_.test=this.parseParenExpression(),_.consequent=this.parseStatement("if"),_.alternate=this.eat(U._else)?this.parseStatement("if"):null,this.finishNode(_,"IfStatement")},Sn.parseReturnStatement=function(_){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(U.semi)||this.insertSemicolon()?_.argument=null:(_.argument=this.parseExpression(),this.semicolon()),this.finishNode(_,"ReturnStatement")},Sn.parseSwitchStatement=function(_){this.next(),_.discriminant=this.parseParenExpression(),_.cases=[],this.expect(U.braceL),this.labels.push(vs),this.enterScope(0);for(var V,ce=!1;this.type!==U.braceR;)if(this.type===U._case||this.type===U._default){var Le=this.type===U._case;V&&this.finishNode(V,"SwitchCase"),_.cases.push(V=this.startNode()),V.consequent=[],this.next(),Le?V.test=this.parseExpression():(ce&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),ce=!0,V.test=null),this.expect(U.colon)}else V||this.unexpected(),V.consequent.push(this.parseStatement(null));return this.exitScope(),V&&this.finishNode(V,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(_,"SwitchStatement")},Sn.parseThrowStatement=function(_){return this.next(),Oe.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),_.argument=this.parseExpression(),this.semicolon(),this.finishNode(_,"ThrowStatement")};var va=[];Sn.parseTryStatement=function(_){if(this.next(),_.block=this.parseBlock(),_.handler=null,this.type===U._catch){var V=this.startNode();if(this.next(),this.eat(U.parenL)){V.param=this.parseBindingAtom();var ce=V.param.type==="Identifier";this.enterScope(ce?ht:0),this.checkLVal(V.param,ce?nn:Ui),this.expect(U.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),V.param=null,this.enterScope(0);V.body=this.parseBlock(!1),this.exitScope(),_.handler=this.finishNode(V,"CatchClause")}return _.finalizer=this.eat(U._finally)?this.parseBlock():null,!_.handler&&!_.finalizer&&this.raise(_.start,"Missing catch or finally clause"),this.finishNode(_,"TryStatement")},Sn.parseVarStatement=function(_,V){return this.next(),this.parseVar(_,!1,V),this.semicolon(),this.finishNode(_,"VariableDeclaration")},Sn.parseWhileStatement=function(_){return this.next(),_.test=this.parseParenExpression(),this.labels.push(pr),_.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(_,"WhileStatement")},Sn.parseWithStatement=function(_){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),_.object=this.parseParenExpression(),_.body=this.parseStatement("with"),this.finishNode(_,"WithStatement")},Sn.parseEmptyStatement=function(_){return this.next(),this.finishNode(_,"EmptyStatement")},Sn.parseLabeledStatement=function(_,V,ce,Le){for(var Ge=0,mt=this.labels;Ge<mt.length;Ge+=1){var Ct=mt[Ge];Ct.name===V&&this.raise(ce.start,"Label '"+V+"' is already declared")}for(var Jt=this.type.isLoop?"loop":this.type===U._switch?"switch":null,Dn=this.labels.length-1;Dn>=0;Dn--){var $i=this.labels[Dn];if($i.statementStart===_.start)$i.statementStart=this.start,$i.kind=Jt;else break}return this.labels.push({name:V,kind:Jt,statementStart:this.start}),_.body=this.parseStatement(Le?Le.indexOf("label")===-1?Le+"label":Le:"label"),this.labels.pop(),_.label=ce,this.finishNode(_,"LabeledStatement")},Sn.parseExpressionStatement=function(_,V){return _.expression=V,this.semicolon(),this.finishNode(_,"ExpressionStatement")},Sn.parseBlock=function(_,V){for(_===void 0&&(_=!0),V===void 0&&(V=this.startNode()),V.body=[],this.expect(U.braceL),_&&this.enterScope(0);!this.eat(U.braceR);){var ce=this.parseStatement(null);V.body.push(ce)}return _&&this.exitScope(),this.finishNode(V,"BlockStatement")},Sn.parseFor=function(_,V){return _.init=V,this.expect(U.semi),_.test=this.type===U.semi?null:this.parseExpression(),this.expect(U.semi),_.update=this.type===U.parenR?null:this.parseExpression(),this.expect(U.parenR),_.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(_,"ForStatement")},Sn.parseForIn=function(_,V){var ce=this.type===U._in;return this.next(),V.type==="VariableDeclaration"&&V.declarations[0].init!=null&&(!ce||this.options.ecmaVersion<8||this.strict||V.kind!=="var"||V.declarations[0].id.type!=="Identifier")?this.raise(V.start,(ce?"for-in":"for-of")+" loop variable declaration may not have an initializer"):V.type==="AssignmentPattern"&&this.raise(V.start,"Invalid left-hand side in for-loop"),_.left=V,_.right=ce?this.parseExpression():this.parseMaybeAssign(),this.expect(U.parenR),_.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(_,ce?"ForInStatement":"ForOfStatement")},Sn.parseVar=function(_,V,ce){for(_.declarations=[],_.kind=ce;;){var Le=this.startNode();if(this.parseVarId(Le,ce),this.eat(U.eq)?Le.init=this.parseMaybeAssign(V):ce==="const"&&!(this.type===U._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():Le.id.type!=="Identifier"&&!(V&&(this.type===U._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):Le.init=null,_.declarations.push(this.finishNode(Le,"VariableDeclarator")),!this.eat(U.comma))break}return _},Sn.parseVarId=function(_,V){_.id=this.parseBindingAtom(),this.checkLVal(_.id,V==="var"?vi:Ui,!1)};var zr=1,di=2,Bi=4;Sn.parseFunction=function(_,V,ce,Le){this.initFunction(_),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!Le)&&(this.type===U.star&&V&di&&this.unexpected(),_.generator=this.eat(U.star)),this.options.ecmaVersion>=8&&(_.async=!!Le),V&zr&&(_.id=V&Bi&&this.type!==U.name?null:this.parseIdent(),_.id&&!(V&di)&&this.checkLVal(_.id,this.strict||_.generator||_.async?this.treatFunctionsAsVar?vi:Ui:si));var Ge=this.yieldPos,mt=this.awaitPos,Ct=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(An(_.async,_.generator)),V&zr||(_.id=this.type===U.name?this.parseIdent():null),this.parseFunctionParams(_),this.parseFunctionBody(_,ce,!1),this.yieldPos=Ge,this.awaitPos=mt,this.awaitIdentPos=Ct,this.finishNode(_,V&zr?"FunctionDeclaration":"FunctionExpression")},Sn.parseFunctionParams=function(_){this.expect(U.parenL),_.params=this.parseBindingList(U.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Sn.parseClass=function(_,V){this.next();var ce=this.strict;this.strict=!0,this.parseClassId(_,V),this.parseClassSuper(_);var Le=this.startNode(),Ge=!1;for(Le.body=[],this.expect(U.braceL);!this.eat(U.braceR);){var mt=this.parseClassElement(_.superClass!==null);mt&&(Le.body.push(mt),mt.type==="MethodDefinition"&&mt.kind==="constructor"&&(Ge&&this.raise(mt.start,"Duplicate constructor in the same class"),Ge=!0))}return _.body=this.finishNode(Le,"ClassBody"),this.strict=ce,this.finishNode(_,V?"ClassDeclaration":"ClassExpression")},Sn.parseClassElement=function(_){var V=this;if(this.eat(U.semi))return null;var ce=this.startNode(),Le=function(Dn,$i){$i===void 0&&($i=!1);var Ks=V.start,Ws=V.startLoc;return V.eatContextual(Dn)?V.type!==U.parenL&&(!$i||!V.canInsertSemicolon())?!0:(ce.key&&V.unexpected(),ce.computed=!1,ce.key=V.startNodeAt(Ks,Ws),ce.key.name=Dn,V.finishNode(ce.key,"Identifier"),!1):!1};ce.kind="method",ce.static=Le("static");var Ge=this.eat(U.star),mt=!1;Ge||(this.options.ecmaVersion>=8&&Le("async",!0)?(mt=!0,Ge=this.options.ecmaVersion>=9&&this.eat(U.star)):Le("get")?ce.kind="get":Le("set")&&(ce.kind="set")),ce.key||this.parsePropertyName(ce);var Ct=ce.key,Jt=!1;return!ce.computed&&!ce.static&&(Ct.type==="Identifier"&&Ct.name==="constructor"||Ct.type==="Literal"&&Ct.value==="constructor")?(ce.kind!=="method"&&this.raise(Ct.start,"Constructor can't have get/set modifier"),Ge&&this.raise(Ct.start,"Constructor can't be a generator"),mt&&this.raise(Ct.start,"Constructor can't be an async method"),ce.kind="constructor",Jt=_):ce.static&&Ct.type==="Identifier"&&Ct.name==="prototype"&&this.raise(Ct.start,"Classes may not have a static property named prototype"),this.parseClassMethod(ce,Ge,mt,Jt),ce.kind==="get"&&ce.value.params.length!==0&&this.raiseRecoverable(ce.value.start,"getter should have no params"),ce.kind==="set"&&ce.value.params.length!==1&&this.raiseRecoverable(ce.value.start,"setter should have exactly one param"),ce.kind==="set"&&ce.value.params[0].type==="RestElement"&&this.raiseRecoverable(ce.value.params[0].start,"Setter cannot use rest params"),ce},Sn.parseClassMethod=function(_,V,ce,Le){return _.value=this.parseMethod(V,ce,Le),this.finishNode(_,"MethodDefinition")},Sn.parseClassId=function(_,V){this.type===U.name?(_.id=this.parseIdent(),V&&this.checkLVal(_.id,Ui,!1)):(V===!0&&this.unexpected(),_.id=null)},Sn.parseClassSuper=function(_){_.superClass=this.eat(U._extends)?this.parseExprSubscripts():null},Sn.parseExport=function(_,V){if(this.next(),this.eat(U.star))return this.expectContextual("from"),this.type!==U.string&&this.unexpected(),_.source=this.parseExprAtom(),this.semicolon(),this.finishNode(_,"ExportAllDeclaration");if(this.eat(U._default)){this.checkExport(V,"default",this.lastTokStart);var ce;if(this.type===U._function||(ce=this.isAsyncFunction())){var Le=this.startNode();this.next(),ce&&this.next(),_.declaration=this.parseFunction(Le,zr|Bi,!1,ce)}else if(this.type===U._class){var Ge=this.startNode();_.declaration=this.parseClass(Ge,"nullableID")}else _.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(_,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())_.declaration=this.parseStatement(null),_.declaration.type==="VariableDeclaration"?this.checkVariableExport(V,_.declaration.declarations):this.checkExport(V,_.declaration.id.name,_.declaration.id.start),_.specifiers=[],_.source=null;else{if(_.declaration=null,_.specifiers=this.parseExportSpecifiers(V),this.eatContextual("from"))this.type!==U.string&&this.unexpected(),_.source=this.parseExprAtom();else{for(var mt=0,Ct=_.specifiers;mt<Ct.length;mt+=1){var Jt=Ct[mt];this.checkUnreserved(Jt.local),this.checkLocalExport(Jt.local)}_.source=null}this.semicolon()}return this.finishNode(_,"ExportNamedDeclaration")},Sn.checkExport=function(_,V,ce){_&&(de(_,V)&&this.raiseRecoverable(ce,"Duplicate export '"+V+"'"),_[V]=!0)},Sn.checkPatternExport=function(_,V){var ce=V.type;if(ce==="Identifier")this.checkExport(_,V.name,V.start);else if(ce==="ObjectPattern")for(var Le=0,Ge=V.properties;Le<Ge.length;Le+=1){var mt=Ge[Le];this.checkPatternExport(_,mt)}else if(ce==="ArrayPattern")for(var Ct=0,Jt=V.elements;Ct<Jt.length;Ct+=1){var Dn=Jt[Ct];Dn&&this.checkPatternExport(_,Dn)}else ce==="Property"?this.checkPatternExport(_,V.value):ce==="AssignmentPattern"?this.checkPatternExport(_,V.left):ce==="RestElement"?this.checkPatternExport(_,V.argument):ce==="ParenthesizedExpression"&&this.checkPatternExport(_,V.expression)},Sn.checkVariableExport=function(_,V){if(_)for(var ce=0,Le=V;ce<Le.length;ce+=1){var Ge=Le[ce];this.checkPatternExport(_,Ge.id)}},Sn.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},Sn.parseExportSpecifiers=function(_){var V=[],ce=!0;for(this.expect(U.braceL);!this.eat(U.braceR);){if(ce)ce=!1;else if(this.expect(U.comma),this.afterTrailingComma(U.braceR))break;var Le=this.startNode();Le.local=this.parseIdent(!0),Le.exported=this.eatContextual("as")?this.parseIdent(!0):Le.local,this.checkExport(_,Le.exported.name,Le.exported.start),V.push(this.finishNode(Le,"ExportSpecifier"))}return V},Sn.parseImport=function(_){return this.next(),this.type===U.string?(_.specifiers=va,_.source=this.parseExprAtom()):(_.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),_.source=this.type===U.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(_,"ImportDeclaration")},Sn.parseImportSpecifiers=function(){var _=[],V=!0;if(this.type===U.name){var ce=this.startNode();if(ce.local=this.parseIdent(),this.checkLVal(ce.local,Ui),_.push(this.finishNode(ce,"ImportDefaultSpecifier")),!this.eat(U.comma))return _}if(this.type===U.star){var Le=this.startNode();return this.next(),this.expectContextual("as"),Le.local=this.parseIdent(),this.checkLVal(Le.local,Ui),_.push(this.finishNode(Le,"ImportNamespaceSpecifier")),_}for(this.expect(U.braceL);!this.eat(U.braceR);){if(V)V=!1;else if(this.expect(U.comma),this.afterTrailingComma(U.braceR))break;var Ge=this.startNode();Ge.imported=this.parseIdent(!0),this.eatContextual("as")?Ge.local=this.parseIdent():(this.checkUnreserved(Ge.imported),Ge.local=Ge.imported),this.checkLVal(Ge.local,Ui),_.push(this.finishNode(Ge,"ImportSpecifier"))}return _},Sn.adaptDirectivePrologue=function(_){for(var V=0;V<_.length&&this.isDirectiveCandidate(_[V]);++V)_[V].directive=_[V].expression.raw.slice(1,-1)},Sn.isDirectiveCandidate=function(_){return _.type==="ExpressionStatement"&&_.expression.type==="Literal"&&typeof _.expression.value=="string"&&(this.input[_.start]==='"'||this.input[_.start]==="'")};var ir=ei.prototype;ir.toAssignable=function(_,V,ce){if(this.options.ecmaVersion>=6&&_)switch(_.type){case"Identifier":this.inAsync&&_.name==="await"&&this.raise(_.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":_.type="ObjectPattern",ce&&this.checkPatternErrors(ce,!0);for(var Le=0,Ge=_.properties;Le<Ge.length;Le+=1){var mt=Ge[Le];this.toAssignable(mt,V),mt.type==="RestElement"&&(mt.argument.type==="ArrayPattern"||mt.argument.type==="ObjectPattern")&&this.raise(mt.argument.start,"Unexpected token")}break;case"Property":_.kind!=="init"&&this.raise(_.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(_.value,V);break;case"ArrayExpression":_.type="ArrayPattern",ce&&this.checkPatternErrors(ce,!0),this.toAssignableList(_.elements,V);break;case"SpreadElement":_.type="RestElement",this.toAssignable(_.argument,V),_.argument.type==="AssignmentPattern"&&this.raise(_.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":_.operator!=="="&&this.raise(_.left.end,"Only '=' operator can be used for specifying default value."),_.type="AssignmentPattern",delete _.operator,this.toAssignable(_.left,V);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(_.expression,V,ce);break;case"MemberExpression":if(!V)break;default:this.raise(_.start,"Assigning to rvalue")}else ce&&this.checkPatternErrors(ce,!0);return _},ir.toAssignableList=function(_,V){for(var ce=_.length,Le=0;Le<ce;Le++){var Ge=_[Le];Ge&&this.toAssignable(Ge,V)}if(ce){var mt=_[ce-1];this.options.ecmaVersion===6&&V&&mt&&mt.type==="RestElement"&&mt.argument.type!=="Identifier"&&this.unexpected(mt.argument.start)}return _},ir.parseSpread=function(_){var V=this.startNode();return this.next(),V.argument=this.parseMaybeAssign(!1,_),this.finishNode(V,"SpreadElement")},ir.parseRestBinding=function(){var _=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==U.name&&this.unexpected(),_.argument=this.parseBindingAtom(),this.finishNode(_,"RestElement")},ir.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case U.bracketL:var _=this.startNode();return this.next(),_.elements=this.parseBindingList(U.bracketR,!0,!0),this.finishNode(_,"ArrayPattern");case U.braceL:return this.parseObj(!0)}return this.parseIdent()},ir.parseBindingList=function(_,V,ce){for(var Le=[],Ge=!0;!this.eat(_);)if(Ge?Ge=!1:this.expect(U.comma),V&&this.type===U.comma)Le.push(null);else{if(ce&&this.afterTrailingComma(_))break;if(this.type===U.ellipsis){var mt=this.parseRestBinding();this.parseBindingListItem(mt),Le.push(mt),this.type===U.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(_);break}else{var Ct=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(Ct),Le.push(Ct)}}return Le},ir.parseBindingListItem=function(_){return _},ir.parseMaybeDefault=function(_,V,ce){if(ce=ce||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(U.eq))return ce;var Le=this.startNodeAt(_,V);return Le.left=ce,Le.right=this.parseMaybeAssign(),this.finishNode(Le,"AssignmentPattern")},ir.checkLVal=function(_,V,ce){switch(V===void 0&&(V=Zt),_.type){case"Identifier":V===Ui&&_.name==="let"&&this.raiseRecoverable(_.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(_.name)&&this.raiseRecoverable(_.start,(V?"Binding ":"Assigning to ")+_.name+" in strict mode"),ce&&(de(ce,_.name)&&this.raiseRecoverable(_.start,"Argument name clash"),ce[_.name]=!0),V!==Zt&&V!==Gt&&this.declareName(_.name,V,_.start);break;case"MemberExpression":V&&this.raiseRecoverable(_.start,"Binding member expression");break;case"ObjectPattern":for(var Le=0,Ge=_.properties;Le<Ge.length;Le+=1){var mt=Ge[Le];this.checkLVal(mt,V,ce)}break;case"Property":this.checkLVal(_.value,V,ce);break;case"ArrayPattern":for(var Ct=0,Jt=_.elements;Ct<Jt.length;Ct+=1){var Dn=Jt[Ct];Dn&&this.checkLVal(Dn,V,ce)}break;case"AssignmentPattern":this.checkLVal(_.left,V,ce);break;case"RestElement":this.checkLVal(_.argument,V,ce);break;case"ParenthesizedExpression":this.checkLVal(_.expression,V,ce);break;default:this.raise(_.start,(V?"Binding":"Assigning to")+" rvalue")}};var sn=ei.prototype;sn.checkPropClash=function(_,V,ce){if(!(this.options.ecmaVersion>=9&&_.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(_.computed||_.method||_.shorthand))){var Le=_.key,Ge;switch(Le.type){case"Identifier":Ge=Le.name;break;case"Literal":Ge=String(Le.value);break;default:return}var mt=_.kind;if(this.options.ecmaVersion>=6){Ge==="__proto__"&&mt==="init"&&(V.proto&&(ce?ce.doubleProto<0&&(ce.doubleProto=Le.start):this.raiseRecoverable(Le.start,"Redefinition of __proto__ property")),V.proto=!0);return}Ge="$"+Ge;var Ct=V[Ge];if(Ct){var Jt;mt==="init"?Jt=this.strict&&Ct.init||Ct.get||Ct.set:Jt=Ct.init||Ct[mt],Jt&&this.raiseRecoverable(Le.start,"Redefinition of property")}else Ct=V[Ge]={init:!1,get:!1,set:!1};Ct[mt]=!0}},sn.parseExpression=function(_,V){var ce=this.start,Le=this.startLoc,Ge=this.parseMaybeAssign(_,V);if(this.type===U.comma){var mt=this.startNodeAt(ce,Le);for(mt.expressions=[Ge];this.eat(U.comma);)mt.expressions.push(this.parseMaybeAssign(_,V));return this.finishNode(mt,"SequenceExpression")}return Ge},sn.parseMaybeAssign=function(_,V,ce){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(_);this.exprAllowed=!1}var Le=!1,Ge=-1,mt=-1;V?(Ge=V.parenthesizedAssign,mt=V.trailingComma,V.parenthesizedAssign=V.trailingComma=-1):(V=new is,Le=!0);var Ct=this.start,Jt=this.startLoc;(this.type===U.parenL||this.type===U.name)&&(this.potentialArrowAt=this.start);var Dn=this.parseMaybeConditional(_,V);if(ce&&(Dn=ce.call(this,Dn,Ct,Jt)),this.type.isAssign){var $i=this.startNodeAt(Ct,Jt);return $i.operator=this.value,$i.left=this.type===U.eq?this.toAssignable(Dn,!1,V):Dn,Le||(V.parenthesizedAssign=V.trailingComma=V.doubleProto=-1),V.shorthandAssign>=$i.left.start&&(V.shorthandAssign=-1),this.checkLVal(Dn),this.next(),$i.right=this.parseMaybeAssign(_),this.finishNode($i,"AssignmentExpression")}else Le&&this.checkExpressionErrors(V,!0);return Ge>-1&&(V.parenthesizedAssign=Ge),mt>-1&&(V.trailingComma=mt),Dn},sn.parseMaybeConditional=function(_,V){var ce=this.start,Le=this.startLoc,Ge=this.parseExprOps(_,V);if(this.checkExpressionErrors(V))return Ge;if(this.eat(U.question)){var mt=this.startNodeAt(ce,Le);return mt.test=Ge,mt.consequent=this.parseMaybeAssign(),this.expect(U.colon),mt.alternate=this.parseMaybeAssign(_),this.finishNode(mt,"ConditionalExpression")}return Ge},sn.parseExprOps=function(_,V){var ce=this.start,Le=this.startLoc,Ge=this.parseMaybeUnary(V,!1);return this.checkExpressionErrors(V)||Ge.start===ce&&Ge.type==="ArrowFunctionExpression"?Ge:this.parseExprOp(Ge,ce,Le,-1,_)},sn.parseExprOp=function(_,V,ce,Le,Ge){var mt=this.type.binop;if(mt!=null&&(!Ge||this.type!==U._in)&&mt>Le){var Ct=this.type===U.logicalOR||this.type===U.logicalAND,Jt=this.value;this.next();var Dn=this.start,$i=this.startLoc,Ks=this.parseExprOp(this.parseMaybeUnary(null,!1),Dn,$i,mt,Ge),Ws=this.buildBinary(V,ce,_,Ks,Jt,Ct);return this.parseExprOp(Ws,V,ce,Le,Ge)}return _},sn.buildBinary=function(_,V,ce,Le,Ge,mt){var Ct=this.startNodeAt(_,V);return Ct.left=ce,Ct.operator=Ge,Ct.right=Le,this.finishNode(Ct,mt?"LogicalExpression":"BinaryExpression")},sn.parseMaybeUnary=function(_,V){var ce=this.start,Le=this.startLoc,Ge;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))Ge=this.parseAwait(),V=!0;else if(this.type.prefix){var mt=this.startNode(),Ct=this.type===U.incDec;mt.operator=this.value,mt.prefix=!0,this.next(),mt.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(_,!0),Ct?this.checkLVal(mt.argument):this.strict&&mt.operator==="delete"&&mt.argument.type==="Identifier"?this.raiseRecoverable(mt.start,"Deleting local variable in strict mode"):V=!0,Ge=this.finishNode(mt,Ct?"UpdateExpression":"UnaryExpression")}else{if(Ge=this.parseExprSubscripts(_),this.checkExpressionErrors(_))return Ge;for(;this.type.postfix&&!this.canInsertSemicolon();){var Jt=this.startNodeAt(ce,Le);Jt.operator=this.value,Jt.prefix=!1,Jt.argument=Ge,this.checkLVal(Ge),this.next(),Ge=this.finishNode(Jt,"UpdateExpression")}}return!V&&this.eat(U.starstar)?this.buildBinary(ce,Le,Ge,this.parseMaybeUnary(null,!1),"**",!1):Ge},sn.parseExprSubscripts=function(_){var V=this.start,ce=this.startLoc,Le=this.parseExprAtom(_);if(Le.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return Le;var Ge=this.parseSubscripts(Le,V,ce);return _&&Ge.type==="MemberExpression"&&(_.parenthesizedAssign>=Ge.start&&(_.parenthesizedAssign=-1),_.parenthesizedBind>=Ge.start&&(_.parenthesizedBind=-1)),Ge},sn.parseSubscripts=function(_,V,ce,Le){for(var Ge=this.options.ecmaVersion>=8&&_.type==="Identifier"&&_.name==="async"&&this.lastTokEnd===_.end&&!this.canInsertSemicolon()&&this.input.slice(_.start,_.end)==="async";;){var mt=this.parseSubscript(_,V,ce,Le,Ge);if(mt===_||mt.type==="ArrowFunctionExpression")return mt;_=mt}},sn.parseSubscript=function(_,V,ce,Le,Ge){var mt=this.eat(U.bracketL);if(mt||this.eat(U.dot)){var Ct=this.startNodeAt(V,ce);Ct.object=_,Ct.property=mt?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),Ct.computed=!!mt,mt&&this.expect(U.bracketR),_=this.finishNode(Ct,"MemberExpression")}else if(!Le&&this.eat(U.parenL)){var Jt=new is,Dn=this.yieldPos,$i=this.awaitPos,Ks=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Ws=this.parseExprList(U.parenR,this.options.ecmaVersion>=8,!1,Jt);if(Ge&&!this.canInsertSemicolon()&&this.eat(U.arrow))return this.checkPatternErrors(Jt,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Dn,this.awaitPos=$i,this.awaitIdentPos=Ks,this.parseArrowExpression(this.startNodeAt(V,ce),Ws,!0);this.checkExpressionErrors(Jt,!0),this.yieldPos=Dn||this.yieldPos,this.awaitPos=$i||this.awaitPos,this.awaitIdentPos=Ks||this.awaitIdentPos;var qa=this.startNodeAt(V,ce);qa.callee=_,qa.arguments=Ws,_=this.finishNode(qa,"CallExpression")}else if(this.type===U.backQuote){var Na=this.startNodeAt(V,ce);Na.tag=_,Na.quasi=this.parseTemplate({isTagged:!0}),_=this.finishNode(Na,"TaggedTemplateExpression")}return _},sn.parseExprAtom=function(_){this.type===U.slash&&this.readRegexp();var V,ce=this.potentialArrowAt===this.start;switch(this.type){case U._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),V=this.startNode(),this.next(),this.type===U.parenL&&!this.allowDirectSuper&&this.raise(V.start,"super() call outside constructor of a subclass"),this.type!==U.dot&&this.type!==U.bracketL&&this.type!==U.parenL&&this.unexpected(),this.finishNode(V,"Super");case U._this:return V=this.startNode(),this.next(),this.finishNode(V,"ThisExpression");case U.name:var Le=this.start,Ge=this.startLoc,mt=this.containsEsc,Ct=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!mt&&Ct.name==="async"&&!this.canInsertSemicolon()&&this.eat(U._function))return this.parseFunction(this.startNodeAt(Le,Ge),0,!1,!0);if(ce&&!this.canInsertSemicolon()){if(this.eat(U.arrow))return this.parseArrowExpression(this.startNodeAt(Le,Ge),[Ct],!1);if(this.options.ecmaVersion>=8&&Ct.name==="async"&&this.type===U.name&&!mt)return Ct=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(U.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Le,Ge),[Ct],!0)}return Ct;case U.regexp:var Jt=this.value;return V=this.parseLiteral(Jt.value),V.regex={pattern:Jt.pattern,flags:Jt.flags},V;case U.num:case U.string:return this.parseLiteral(this.value);case U._null:case U._true:case U._false:return V=this.startNode(),V.value=this.type===U._null?null:this.type===U._true,V.raw=this.type.keyword,this.next(),this.finishNode(V,"Literal");case U.parenL:var Dn=this.start,$i=this.parseParenAndDistinguishExpression(ce);return _&&(_.parenthesizedAssign<0&&!this.isSimpleAssignTarget($i)&&(_.parenthesizedAssign=Dn),_.parenthesizedBind<0&&(_.parenthesizedBind=Dn)),$i;case U.bracketL:return V=this.startNode(),this.next(),V.elements=this.parseExprList(U.bracketR,!0,!0,_),this.finishNode(V,"ArrayExpression");case U.braceL:return this.parseObj(!1,_);case U._function:return V=this.startNode(),this.next(),this.parseFunction(V,0);case U._class:return this.parseClass(this.startNode(),!1);case U._new:return this.parseNew();case U.backQuote:return this.parseTemplate();case U._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},sn.parseExprImport=function(){var _=this.startNode();switch(this.next(),this.type){case U.parenL:return this.parseDynamicImport(_);default:this.unexpected()}},sn.parseDynamicImport=function(_){if(this.next(),_.source=this.parseMaybeAssign(),!this.eat(U.parenR)){var V=this.start;this.eat(U.comma)&&this.eat(U.parenR)?this.raiseRecoverable(V,"Trailing comma is not allowed in import()"):this.unexpected(V)}return this.finishNode(_,"ImportExpression")},sn.parseLiteral=function(_){var V=this.startNode();return V.value=_,V.raw=this.input.slice(this.start,this.end),V.raw.charCodeAt(V.raw.length-1)===110&&(V.bigint=V.raw.slice(0,-1)),this.next(),this.finishNode(V,"Literal")},sn.parseParenExpression=function(){this.expect(U.parenL);var _=this.parseExpression();return this.expect(U.parenR),_},sn.parseParenAndDistinguishExpression=function(_){var V=this.start,ce=this.startLoc,Le,Ge=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var mt=this.start,Ct=this.startLoc,Jt=[],Dn=!0,$i=!1,Ks=new is,Ws=this.yieldPos,qa=this.awaitPos,Na;for(this.yieldPos=0,this.awaitPos=0;this.type!==U.parenR;)if(Dn?Dn=!1:this.expect(U.comma),Ge&&this.afterTrailingComma(U.parenR,!0)){$i=!0;break}else if(this.type===U.ellipsis){Na=this.start,Jt.push(this.parseParenItem(this.parseRestBinding())),this.type===U.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else Jt.push(this.parseMaybeAssign(!1,Ks,this.parseParenItem));var uh=this.start,ch=this.startLoc;if(this.expect(U.parenR),_&&!this.canInsertSemicolon()&&this.eat(U.arrow))return this.checkPatternErrors(Ks,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Ws,this.awaitPos=qa,this.parseParenArrowList(V,ce,Jt);(!Jt.length||$i)&&this.unexpected(this.lastTokStart),Na&&this.unexpected(Na),this.checkExpressionErrors(Ks,!0),this.yieldPos=Ws||this.yieldPos,this.awaitPos=qa||this.awaitPos,Jt.length>1?(Le=this.startNodeAt(mt,Ct),Le.expressions=Jt,this.finishNodeAt(Le,"SequenceExpression",uh,ch)):Le=Jt[0]}else Le=this.parseParenExpression();if(this.options.preserveParens){var Ql=this.startNodeAt(V,ce);return Ql.expression=Le,this.finishNode(Ql,"ParenthesizedExpression")}else return Le},sn.parseParenItem=function(_){return _},sn.parseParenArrowList=function(_,V,ce){return this.parseArrowExpression(this.startNodeAt(_,V),ce)};var Cs=[];sn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var _=this.startNode(),V=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(U.dot)){_.meta=V;var ce=this.containsEsc;return _.property=this.parseIdent(!0),(_.property.name!=="target"||ce)&&this.raiseRecoverable(_.property.start,"The only valid meta property for new is new.target"),this.inNonArrowFunction()||this.raiseRecoverable(_.start,"new.target can only be used in functions"),this.finishNode(_,"MetaProperty")}var Le=this.start,Ge=this.startLoc,mt=this.type===U._import;return _.callee=this.parseSubscripts(this.parseExprAtom(),Le,Ge,!0),mt&&_.callee.type==="ImportExpression"&&this.raise(Le,"Cannot use new with import()"),this.eat(U.parenL)?_.arguments=this.parseExprList(U.parenR,this.options.ecmaVersion>=8,!1):_.arguments=Cs,this.finishNode(_,"NewExpression")},sn.parseTemplateElement=function(_){var V=_.isTagged,ce=this.startNode();return this.type===U.invalidTemplate?(V||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),ce.value={raw:this.value,cooked:null}):ce.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),ce.tail=this.type===U.backQuote,this.finishNode(ce,"TemplateElement")},sn.parseTemplate=function(_){_===void 0&&(_={});var V=_.isTagged;V===void 0&&(V=!1);var ce=this.startNode();this.next(),ce.expressions=[];var Le=this.parseTemplateElement({isTagged:V});for(ce.quasis=[Le];!Le.tail;)this.type===U.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(U.dollarBraceL),ce.expressions.push(this.parseExpression()),this.expect(U.braceR),ce.quasis.push(Le=this.parseTemplateElement({isTagged:V}));return this.next(),this.finishNode(ce,"TemplateLiteral")},sn.isAsyncProp=function(_){return!_.computed&&_.key.type==="Identifier"&&_.key.name==="async"&&(this.type===U.name||this.type===U.num||this.type===U.string||this.type===U.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===U.star)&&!Oe.test(this.input.slice(this.lastTokEnd,this.start))},sn.parseObj=function(_,V){var ce=this.startNode(),Le=!0,Ge={};for(ce.properties=[],this.next();!this.eat(U.braceR);){if(Le)Le=!1;else if(this.expect(U.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(U.braceR))break;var mt=this.parseProperty(_,V);_||this.checkPropClash(mt,Ge,V),ce.properties.push(mt)}return this.finishNode(ce,_?"ObjectPattern":"ObjectExpression")},sn.parseProperty=function(_,V){var ce=this.startNode(),Le,Ge,mt,Ct;if(this.options.ecmaVersion>=9&&this.eat(U.ellipsis))return _?(ce.argument=this.parseIdent(!1),this.type===U.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(ce,"RestElement")):(this.type===U.parenL&&V&&(V.parenthesizedAssign<0&&(V.parenthesizedAssign=this.start),V.parenthesizedBind<0&&(V.parenthesizedBind=this.start)),ce.argument=this.parseMaybeAssign(!1,V),this.type===U.comma&&V&&V.trailingComma<0&&(V.trailingComma=this.start),this.finishNode(ce,"SpreadElement"));this.options.ecmaVersion>=6&&(ce.method=!1,ce.shorthand=!1,(_||V)&&(mt=this.start,Ct=this.startLoc),_||(Le=this.eat(U.star)));var Jt=this.containsEsc;return this.parsePropertyName(ce),!_&&!Jt&&this.options.ecmaVersion>=8&&!Le&&this.isAsyncProp(ce)?(Ge=!0,Le=this.options.ecmaVersion>=9&&this.eat(U.star),this.parsePropertyName(ce,V)):Ge=!1,this.parsePropertyValue(ce,_,Le,Ge,mt,Ct,V,Jt),this.finishNode(ce,"Property")},sn.parsePropertyValue=function(_,V,ce,Le,Ge,mt,Ct,Jt){if((ce||Le)&&this.type===U.colon&&this.unexpected(),this.eat(U.colon))_.value=V?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Ct),_.kind="init";else if(this.options.ecmaVersion>=6&&this.type===U.parenL)V&&this.unexpected(),_.kind="init",_.method=!0,_.value=this.parseMethod(ce,Le);else if(!V&&!Jt&&this.options.ecmaVersion>=5&&!_.computed&&_.key.type==="Identifier"&&(_.key.name==="get"||_.key.name==="set")&&this.type!==U.comma&&this.type!==U.braceR){(ce||Le)&&this.unexpected(),_.kind=_.key.name,this.parsePropertyName(_),_.value=this.parseMethod(!1);var Dn=_.kind==="get"?0:1;if(_.value.params.length!==Dn){var $i=_.value.start;_.kind==="get"?this.raiseRecoverable($i,"getter should have no params"):this.raiseRecoverable($i,"setter should have exactly one param")}else _.kind==="set"&&_.value.params[0].type==="RestElement"&&this.raiseRecoverable(_.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!_.computed&&_.key.type==="Identifier"?((ce||Le)&&this.unexpected(),this.checkUnreserved(_.key),_.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Ge),_.kind="init",V?_.value=this.parseMaybeDefault(Ge,mt,_.key):this.type===U.eq&&Ct?(Ct.shorthandAssign<0&&(Ct.shorthandAssign=this.start),_.value=this.parseMaybeDefault(Ge,mt,_.key)):_.value=_.key,_.shorthand=!0):this.unexpected()},sn.parsePropertyName=function(_){if(this.options.ecmaVersion>=6){if(this.eat(U.bracketL))return _.computed=!0,_.key=this.parseMaybeAssign(),this.expect(U.bracketR),_.key;_.computed=!1}return _.key=this.type===U.num||this.type===U.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},sn.initFunction=function(_){_.id=null,this.options.ecmaVersion>=6&&(_.generator=_.expression=!1),this.options.ecmaVersion>=8&&(_.async=!1)},sn.parseMethod=function(_,V,ce){var Le=this.startNode(),Ge=this.yieldPos,mt=this.awaitPos,Ct=this.awaitIdentPos;return this.initFunction(Le),this.options.ecmaVersion>=6&&(Le.generator=_),this.options.ecmaVersion>=8&&(Le.async=!!V),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(An(V,Le.generator)|Ut|(ce?Bt:0)),this.expect(U.parenL),Le.params=this.parseBindingList(U.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(Le,!1,!0),this.yieldPos=Ge,this.awaitPos=mt,this.awaitIdentPos=Ct,this.finishNode(Le,"FunctionExpression")},sn.parseArrowExpression=function(_,V,ce){var Le=this.yieldPos,Ge=this.awaitPos,mt=this.awaitIdentPos;return this.enterScope(An(ce,!1)|Lt),this.initFunction(_),this.options.ecmaVersion>=8&&(_.async=!!ce),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,_.params=this.toAssignableList(V,!0),this.parseFunctionBody(_,!0,!1),this.yieldPos=Le,this.awaitPos=Ge,this.awaitIdentPos=mt,this.finishNode(_,"ArrowFunctionExpression")},sn.parseFunctionBody=function(_,V,ce){var Le=V&&this.type!==U.braceL,Ge=this.strict,mt=!1;if(Le)_.body=this.parseMaybeAssign(),_.expression=!0,this.checkParams(_,!1);else{var Ct=this.options.ecmaVersion>=7&&!this.isSimpleParamList(_.params);(!Ge||Ct)&&(mt=this.strictDirective(this.end),mt&&Ct&&this.raiseRecoverable(_.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Jt=this.labels;this.labels=[],mt&&(this.strict=!0),this.checkParams(_,!Ge&&!mt&&!V&&!ce&&this.isSimpleParamList(_.params)),_.body=this.parseBlock(!1),_.expression=!1,this.adaptDirectivePrologue(_.body.body),this.labels=Jt}this.exitScope(),this.strict&&_.id&&this.checkLVal(_.id,Gt),this.strict=Ge},sn.isSimpleParamList=function(_){for(var V=0,ce=_;V<ce.length;V+=1){var Le=ce[V];if(Le.type!=="Identifier")return!1}return!0},sn.checkParams=function(_,V){for(var ce={},Le=0,Ge=_.params;Le<Ge.length;Le+=1){var mt=Ge[Le];this.checkLVal(mt,vi,V?null:ce)}},sn.parseExprList=function(_,V,ce,Le){for(var Ge=[],mt=!0;!this.eat(_);){if(mt)mt=!1;else if(this.expect(U.comma),V&&this.afterTrailingComma(_))break;var Ct=void 0;ce&&this.type===U.comma?Ct=null:this.type===U.ellipsis?(Ct=this.parseSpread(Le),Le&&this.type===U.comma&&Le.trailingComma<0&&(Le.trailingComma=this.start)):Ct=this.parseMaybeAssign(!1,Le),Ge.push(Ct)}return Ge},sn.checkUnreserved=function(_){var V=_.start,ce=_.end,Le=_.name;if(this.inGenerator&&Le==="yield"&&this.raiseRecoverable(V,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&Le==="await"&&this.raiseRecoverable(V,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(Le)&&this.raise(V,"Unexpected keyword '"+Le+"'"),!(this.options.ecmaVersion<6&&this.input.slice(V,ce).indexOf("\\")!==-1)){var Ge=this.strict?this.reservedWordsStrict:this.reservedWords;Ge.test(Le)&&(!this.inAsync&&Le==="await"&&this.raiseRecoverable(V,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(V,"The keyword '"+Le+"' is reserved"))}},sn.parseIdent=function(_,V){var ce=this.startNode();return this.type===U.name?ce.name=this.value:this.type.keyword?(ce.name=this.type.keyword,(ce.name==="class"||ce.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!_),this.finishNode(ce,"Identifier"),_||(this.checkUnreserved(ce),ce.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=ce.start)),ce},sn.parseYield=function(_){this.yieldPos||(this.yieldPos=this.start);var V=this.startNode();return this.next(),this.type===U.semi||this.canInsertSemicolon()||this.type!==U.star&&!this.type.startsExpr?(V.delegate=!1,V.argument=null):(V.delegate=this.eat(U.star),V.argument=this.parseMaybeAssign(_)),this.finishNode(V,"YieldExpression")},sn.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var _=this.startNode();return this.next(),_.argument=this.parseMaybeUnary(null,!1),this.finishNode(_,"AwaitExpression")};var Ir=ei.prototype;Ir.raise=function(_,V){var ce=Ue(this.input,_);V+=" ("+ce.line+":"+ce.column+")";var Le=new SyntaxError(V);throw Le.pos=_,Le.loc=ce,Le.raisedAt=this.pos,Le},Ir.raiseRecoverable=Ir.raise,Ir.curPosition=function(){if(this.options.locations)return new xe(this.curLine,this.pos-this.lineStart)};var mi=ei.prototype,ds=function(V){this.flags=V,this.var=[],this.lexical=[],this.functions=[]};mi.enterScope=function(_){this.scopeStack.push(new ds(_))},mi.exitScope=function(){this.scopeStack.pop()},mi.treatFunctionsAsVarInScope=function(_){return _.flags&at||!this.inModule&&_.flags&et},mi.declareName=function(_,V,ce){var Le=!1;if(V===Ui){var Ge=this.currentScope();Le=Ge.lexical.indexOf(_)>-1||Ge.functions.indexOf(_)>-1||Ge.var.indexOf(_)>-1,Ge.lexical.push(_),this.inModule&&Ge.flags&et&&delete this.undefinedExports[_]}else if(V===nn){var mt=this.currentScope();mt.lexical.push(_)}else if(V===si){var Ct=this.currentScope();this.treatFunctionsAsVar?Le=Ct.lexical.indexOf(_)>-1:Le=Ct.lexical.indexOf(_)>-1||Ct.var.indexOf(_)>-1,Ct.functions.push(_)}else for(var Jt=this.scopeStack.length-1;Jt>=0;--Jt){var Dn=this.scopeStack[Jt];if(Dn.lexical.indexOf(_)>-1&&!(Dn.flags&ht&&Dn.lexical[0]===_)||!this.treatFunctionsAsVarInScope(Dn)&&Dn.functions.indexOf(_)>-1){Le=!0;break}if(Dn.var.push(_),this.inModule&&Dn.flags&et&&delete this.undefinedExports[_],Dn.flags&Ze)break}Le&&this.raiseRecoverable(ce,"Identifier '"+_+"' has already been declared")},mi.checkLocalExport=function(_){this.scopeStack[0].lexical.indexOf(_.name)===-1&&this.scopeStack[0].var.indexOf(_.name)===-1&&(this.undefinedExports[_.name]=_)},mi.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},mi.currentVarScope=function(){for(var _=this.scopeStack.length-1;;_--){var V=this.scopeStack[_];if(V.flags&Ze)return V}},mi.currentThisScope=function(){for(var _=this.scopeStack.length-1;;_--){var V=this.scopeStack[_];if(V.flags&Ze&&!(V.flags&Lt))return V}};var Xi=function(V,ce,Le){this.type="",this.start=ce,this.end=0,V.options.locations&&(this.loc=new Re(V,Le)),V.options.directSourceFile&&(this.sourceFile=V.options.directSourceFile),V.options.ranges&&(this.range=[ce,0])},Yr=ei.prototype;Yr.startNode=function(){return new Xi(this,this.start,this.startLoc)},Yr.startNodeAt=function(_,V){return new Xi(this,_,V)};function fs(_,V,ce,Le){return _.type=V,_.end=ce,this.options.locations&&(_.loc.end=Le),this.options.ranges&&(_.range[1]=ce),_}Yr.finishNode=function(_,V){return fs.call(this,_,V,this.lastTokEnd,this.lastTokEndLoc)},Yr.finishNodeAt=function(_,V,ce,Le){return fs.call(this,_,V,ce,Le)};var _i=function(V,ce,Le,Ge,mt){this.token=V,this.isExpr=!!ce,this.preserveSpace=!!Le,this.override=Ge,this.generator=!!mt},Fn={b_stat:new _i("{",!1),b_expr:new _i("{",!0),b_tmpl:new _i("${",!1),p_stat:new _i("(",!1),p_expr:new _i("(",!0),q_tmpl:new _i("`",!0,!0,function(_){return _.tryReadTemplateToken()}),f_stat:new _i("function",!1),f_expr:new _i("function",!0),f_expr_gen:new _i("function",!0,!1,null,!0),f_gen:new _i("function",!1,!1,null,!0)},Rs=ei.prototype;Rs.initialContext=function(){return[Fn.b_stat]},Rs.braceIsBlock=function(_){var V=this.curContext();return V===Fn.f_expr||V===Fn.f_stat?!0:_===U.colon&&(V===Fn.b_stat||V===Fn.b_expr)?!V.isExpr:_===U._return||_===U.name&&this.exprAllowed?Oe.test(this.input.slice(this.lastTokEnd,this.start)):_===U._else||_===U.semi||_===U.eof||_===U.parenR||_===U.arrow?!0:_===U.braceL?V===Fn.b_stat:_===U._var||_===U._const||_===U.name?!1:!this.exprAllowed},Rs.inGeneratorContext=function(){for(var _=this.context.length-1;_>=1;_--){var V=this.context[_];if(V.token==="function")return V.generator}return!1},Rs.updateContext=function(_){var V,ce=this.type;ce.keyword&&_===U.dot?this.exprAllowed=!1:(V=ce.updateContext)?V.call(this,_):this.exprAllowed=ce.beforeExpr},U.parenR.updateContext=U.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var _=this.context.pop();_===Fn.b_stat&&this.curContext().token==="function"&&(_=this.context.pop()),this.exprAllowed=!_.isExpr},U.braceL.updateContext=function(_){this.context.push(this.braceIsBlock(_)?Fn.b_stat:Fn.b_expr),this.exprAllowed=!0},U.dollarBraceL.updateContext=function(){this.context.push(Fn.b_tmpl),this.exprAllowed=!0},U.parenL.updateContext=function(_){var V=_===U._if||_===U._for||_===U._with||_===U._while;this.context.push(V?Fn.p_stat:Fn.p_expr),this.exprAllowed=!0},U.incDec.updateContext=function(){},U._function.updateContext=U._class.updateContext=function(_){_.beforeExpr&&_!==U.semi&&_!==U._else&&!(_===U._return&&Oe.test(this.input.slice(this.lastTokEnd,this.start)))&&!((_===U.colon||_===U.braceL)&&this.curContext()===Fn.b_stat)?this.context.push(Fn.f_expr):this.context.push(Fn.f_stat),this.exprAllowed=!1},U.backQuote.updateContext=function(){this.curContext()===Fn.q_tmpl?this.context.pop():this.context.push(Fn.q_tmpl),this.exprAllowed=!1},U.star.updateContext=function(_){if(_===U._function){var V=this.context.length-1;this.context[V]===Fn.f_expr?this.context[V]=Fn.f_expr_gen:this.context[V]=Fn.f_gen}this.exprAllowed=!0},U.name.updateContext=function(_){var V=!1;this.options.ecmaVersion>=6&&_!==U.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(V=!0),this.exprAllowed=V};var Xr="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Pn=Xr+" Extended_Pictographic",zn=Pn,Ji={9:Xr,10:Pn,11:zn},Da="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",po="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",_a=po+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",_s=_a+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ql={9:po,10:_a,11:_s},Il={};function Bu(_){var V=Il[_]={binary:ve(Ji[_]+" "+Da),nonBinary:{General_Category:ve(Da),Script:ve(ql[_])}};V.nonBinary.Script_Extensions=V.nonBinary.Script,V.nonBinary.gc=V.nonBinary.General_Category,V.nonBinary.sc=V.nonBinary.Script,V.nonBinary.scx=V.nonBinary.Script_Extensions}Bu(9),Bu(10),Bu(11);var Yt=ei.prototype,Wo=function(V){this.parser=V,this.validFlags="gim"+(V.options.ecmaVersion>=6?"uy":"")+(V.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Il[V.options.ecmaVersion>=11?11:V.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Wo.prototype.reset=function(V,ce,Le){var Ge=Le.indexOf("u")!==-1;this.start=V|0,this.source=ce+"",this.flags=Le,this.switchU=Ge&&this.parser.options.ecmaVersion>=6,this.switchN=Ge&&this.parser.options.ecmaVersion>=9},Wo.prototype.raise=function(V){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+V)},Wo.prototype.at=function(V){var ce=this.source,Le=ce.length;if(V>=Le)return-1;var Ge=ce.charCodeAt(V);if(!this.switchU||Ge<=55295||Ge>=57344||V+1>=Le)return Ge;var mt=ce.charCodeAt(V+1);return mt>=56320&&mt<=57343?(Ge<<10)+mt-56613888:Ge},Wo.prototype.nextIndex=function(V){var ce=this.source,Le=ce.length;if(V>=Le)return Le;var Ge=ce.charCodeAt(V),mt;return!this.switchU||Ge<=55295||Ge>=57344||V+1>=Le||(mt=ce.charCodeAt(V+1))<56320||mt>57343?V+1:V+2},Wo.prototype.current=function(){return this.at(this.pos)},Wo.prototype.lookahead=function(){return this.at(this.nextIndex(this.pos))},Wo.prototype.advance=function(){this.pos=this.nextIndex(this.pos)},Wo.prototype.eat=function(V){return this.current()===V?(this.advance(),!0):!1};function $u(_){return _<=65535?String.fromCharCode(_):(_-=65536,String.fromCharCode((_>>10)+55296,(_&1023)+56320))}Yt.validateRegExpFlags=function(_){for(var V=_.validFlags,ce=_.flags,Le=0;Le<ce.length;Le++){var Ge=ce.charAt(Le);V.indexOf(Ge)===-1&&this.raise(_.start,"Invalid regular expression flag"),ce.indexOf(Ge,Le+1)>-1&&this.raise(_.start,"Duplicate regular expression flag")}},Yt.validateRegExpPattern=function(_){this.regexp_pattern(_),!_.switchN&&this.options.ecmaVersion>=9&&_.groupNames.length>0&&(_.switchN=!0,this.regexp_pattern(_))},Yt.regexp_pattern=function(_){_.pos=0,_.lastIntValue=0,_.lastStringValue="",_.lastAssertionIsQuantifiable=!1,_.numCapturingParens=0,_.maxBackReference=0,_.groupNames.length=0,_.backReferenceNames.length=0,this.regexp_disjunction(_),_.pos!==_.source.length&&(_.eat(41)&&_.raise("Unmatched ')'"),(_.eat(93)||_.eat(125))&&_.raise("Lone quantifier brackets")),_.maxBackReference>_.numCapturingParens&&_.raise("Invalid escape");for(var V=0,ce=_.backReferenceNames;V<ce.length;V+=1){var Le=ce[V];_.groupNames.indexOf(Le)===-1&&_.raise("Invalid named capture referenced")}},Yt.regexp_disjunction=function(_){for(this.regexp_alternative(_);_.eat(124);)this.regexp_alternative(_);this.regexp_eatQuantifier(_,!0)&&_.raise("Nothing to repeat"),_.eat(123)&&_.raise("Lone quantifier brackets")},Yt.regexp_alternative=function(_){for(;_.pos<_.source.length&&this.regexp_eatTerm(_););},Yt.regexp_eatTerm=function(_){return this.regexp_eatAssertion(_)?(_.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(_)&&_.switchU&&_.raise("Invalid quantifier"),!0):(_.switchU?this.regexp_eatAtom(_):this.regexp_eatExtendedAtom(_))?(this.regexp_eatQuantifier(_),!0):!1},Yt.regexp_eatAssertion=function(_){var V=_.pos;if(_.lastAssertionIsQuantifiable=!1,_.eat(94)||_.eat(36))return!0;if(_.eat(92)){if(_.eat(66)||_.eat(98))return!0;_.pos=V}if(_.eat(40)&&_.eat(63)){var ce=!1;if(this.options.ecmaVersion>=9&&(ce=_.eat(60)),_.eat(61)||_.eat(33))return this.regexp_disjunction(_),_.eat(41)||_.raise("Unterminated group"),_.lastAssertionIsQuantifiable=!ce,!0}return _.pos=V,!1},Yt.regexp_eatQuantifier=function(_,V){return V===void 0&&(V=!1),this.regexp_eatQuantifierPrefix(_,V)?(_.eat(63),!0):!1},Yt.regexp_eatQuantifierPrefix=function(_,V){return _.eat(42)||_.eat(43)||_.eat(63)||this.regexp_eatBracedQuantifier(_,V)},Yt.regexp_eatBracedQuantifier=function(_,V){var ce=_.pos;if(_.eat(123)){var Le=0,Ge=-1;if(this.regexp_eatDecimalDigits(_)&&(Le=_.lastIntValue,_.eat(44)&&this.regexp_eatDecimalDigits(_)&&(Ge=_.lastIntValue),_.eat(125)))return Ge!==-1&&Ge<Le&&!V&&_.raise("numbers out of order in {} quantifier"),!0;_.switchU&&!V&&_.raise("Incomplete quantifier"),_.pos=ce}return!1},Yt.regexp_eatAtom=function(_){return this.regexp_eatPatternCharacters(_)||_.eat(46)||this.regexp_eatReverseSolidusAtomEscape(_)||this.regexp_eatCharacterClass(_)||this.regexp_eatUncapturingGroup(_)||this.regexp_eatCapturingGroup(_)},Yt.regexp_eatReverseSolidusAtomEscape=function(_){var V=_.pos;if(_.eat(92)){if(this.regexp_eatAtomEscape(_))return!0;_.pos=V}return!1},Yt.regexp_eatUncapturingGroup=function(_){var V=_.pos;if(_.eat(40)){if(_.eat(63)&&_.eat(58)){if(this.regexp_disjunction(_),_.eat(41))return!0;_.raise("Unterminated group")}_.pos=V}return!1},Yt.regexp_eatCapturingGroup=function(_){if(_.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(_):_.current()===63&&_.raise("Invalid group"),this.regexp_disjunction(_),_.eat(41))return _.numCapturingParens+=1,!0;_.raise("Unterminated group")}return!1},Yt.regexp_eatExtendedAtom=function(_){return _.eat(46)||this.regexp_eatReverseSolidusAtomEscape(_)||this.regexp_eatCharacterClass(_)||this.regexp_eatUncapturingGroup(_)||this.regexp_eatCapturingGroup(_)||this.regexp_eatInvalidBracedQuantifier(_)||this.regexp_eatExtendedPatternCharacter(_)},Yt.regexp_eatInvalidBracedQuantifier=function(_){return this.regexp_eatBracedQuantifier(_,!0)&&_.raise("Nothing to repeat"),!1},Yt.regexp_eatSyntaxCharacter=function(_){var V=_.current();return xc(V)?(_.lastIntValue=V,_.advance(),!0):!1};function xc(_){return _===36||_>=40&&_<=43||_===46||_===63||_>=91&&_<=94||_>=123&&_<=125}Yt.regexp_eatPatternCharacters=function(_){for(var V=_.pos,ce=0;(ce=_.current())!==-1&&!xc(ce);)_.advance();return _.pos!==V},Yt.regexp_eatExtendedPatternCharacter=function(_){var V=_.current();return V!==-1&&V!==36&&!(V>=40&&V<=43)&&V!==46&&V!==63&&V!==91&&V!==94&&V!==124?(_.advance(),!0):!1},Yt.regexp_groupSpecifier=function(_){if(_.eat(63)){if(this.regexp_eatGroupName(_)){_.groupNames.indexOf(_.lastStringValue)!==-1&&_.raise("Duplicate capture group name"),_.groupNames.push(_.lastStringValue);return}_.raise("Invalid group")}},Yt.regexp_eatGroupName=function(_){if(_.lastStringValue="",_.eat(60)){if(this.regexp_eatRegExpIdentifierName(_)&&_.eat(62))return!0;_.raise("Invalid capture group name")}return!1},Yt.regexp_eatRegExpIdentifierName=function(_){if(_.lastStringValue="",this.regexp_eatRegExpIdentifierStart(_)){for(_.lastStringValue+=$u(_.lastIntValue);this.regexp_eatRegExpIdentifierPart(_);)_.lastStringValue+=$u(_.lastIntValue);return!0}return!1},Yt.regexp_eatRegExpIdentifierStart=function(_){var V=_.pos,ce=_.current();return _.advance(),ce===92&&this.regexp_eatRegExpUnicodeEscapeSequence(_)&&(ce=_.lastIntValue),kl(ce)?(_.lastIntValue=ce,!0):(_.pos=V,!1)};function kl(_){return _e(_,!0)||_===36||_===95}Yt.regexp_eatRegExpIdentifierPart=function(_){var V=_.pos,ce=_.current();return _.advance(),ce===92&&this.regexp_eatRegExpUnicodeEscapeSequence(_)&&(ce=_.lastIntValue),$p(ce)?(_.lastIntValue=ce,!0):(_.pos=V,!1)};function $p(_){return Y(_,!0)||_===36||_===95||_===8204||_===8205}Yt.regexp_eatAtomEscape=function(_){return this.regexp_eatBackReference(_)||this.regexp_eatCharacterClassEscape(_)||this.regexp_eatCharacterEscape(_)||_.switchN&&this.regexp_eatKGroupName(_)?!0:(_.switchU&&(_.current()===99&&_.raise("Invalid unicode escape"),_.raise("Invalid escape")),!1)},Yt.regexp_eatBackReference=function(_){var V=_.pos;if(this.regexp_eatDecimalEscape(_)){var ce=_.lastIntValue;if(_.switchU)return ce>_.maxBackReference&&(_.maxBackReference=ce),!0;if(ce<=_.numCapturingParens)return!0;_.pos=V}return!1},Yt.regexp_eatKGroupName=function(_){if(_.eat(107)){if(this.regexp_eatGroupName(_))return _.backReferenceNames.push(_.lastStringValue),!0;_.raise("Invalid named reference")}return!1},Yt.regexp_eatCharacterEscape=function(_){return this.regexp_eatControlEscape(_)||this.regexp_eatCControlLetter(_)||this.regexp_eatZero(_)||this.regexp_eatHexEscapeSequence(_)||this.regexp_eatRegExpUnicodeEscapeSequence(_)||!_.switchU&&this.regexp_eatLegacyOctalEscapeSequence(_)||this.regexp_eatIdentityEscape(_)},Yt.regexp_eatCControlLetter=function(_){var V=_.pos;if(_.eat(99)){if(this.regexp_eatControlLetter(_))return!0;_.pos=V}return!1},Yt.regexp_eatZero=function(_){return _.current()===48&&!Yl(_.lookahead())?(_.lastIntValue=0,_.advance(),!0):!1},Yt.regexp_eatControlEscape=function(_){var V=_.current();return V===116?(_.lastIntValue=9,_.advance(),!0):V===110?(_.lastIntValue=10,_.advance(),!0):V===118?(_.lastIntValue=11,_.advance(),!0):V===102?(_.lastIntValue=12,_.advance(),!0):V===114?(_.lastIntValue=13,_.advance(),!0):!1},Yt.regexp_eatControlLetter=function(_){var V=_.current();return oh(V)?(_.lastIntValue=V%32,_.advance(),!0):!1};function oh(_){return _>=65&&_<=90||_>=97&&_<=122}Yt.regexp_eatRegExpUnicodeEscapeSequence=function(_){var V=_.pos;if(_.eat(117)){if(this.regexp_eatFixedHexDigits(_,4)){var ce=_.lastIntValue;if(_.switchU&&ce>=55296&&ce<=56319){var Le=_.pos;if(_.eat(92)&&_.eat(117)&&this.regexp_eatFixedHexDigits(_,4)){var Ge=_.lastIntValue;if(Ge>=56320&&Ge<=57343)return _.lastIntValue=(ce-55296)*1024+(Ge-56320)+65536,!0}_.pos=Le,_.lastIntValue=ce}return!0}if(_.switchU&&_.eat(123)&&this.regexp_eatHexDigits(_)&&_.eat(125)&&vd(_.lastIntValue))return!0;_.switchU&&_.raise("Invalid unicode escape"),_.pos=V}return!1};function vd(_){return _>=0&&_<=1114111}Yt.regexp_eatIdentityEscape=function(_){if(_.switchU)return this.regexp_eatSyntaxCharacter(_)?!0:_.eat(47)?(_.lastIntValue=47,!0):!1;var V=_.current();return V!==99&&(!_.switchN||V!==107)?(_.lastIntValue=V,_.advance(),!0):!1},Yt.regexp_eatDecimalEscape=function(_){_.lastIntValue=0;var V=_.current();if(V>=49&&V<=57){do _.lastIntValue=10*_.lastIntValue+(V-48),_.advance();while((V=_.current())>=48&&V<=57);return!0}return!1},Yt.regexp_eatCharacterClassEscape=function(_){var V=_.current();if(lh(V))return _.lastIntValue=-1,_.advance(),!0;if(_.switchU&&this.options.ecmaVersion>=9&&(V===80||V===112)){if(_.lastIntValue=-1,_.advance(),_.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(_)&&_.eat(125))return!0;_.raise("Invalid property name")}return!1};function lh(_){return _===100||_===68||_===115||_===83||_===119||_===87}Yt.regexp_eatUnicodePropertyValueExpression=function(_){var V=_.pos;if(this.regexp_eatUnicodePropertyName(_)&&_.eat(61)){var ce=_.lastStringValue;if(this.regexp_eatUnicodePropertyValue(_)){var Le=_.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(_,ce,Le),!0}}if(_.pos=V,this.regexp_eatLoneUnicodePropertyNameOrValue(_)){var Ge=_.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(_,Ge),!0}return!1},Yt.regexp_validateUnicodePropertyNameAndValue=function(_,V,ce){de(_.unicodeProperties.nonBinary,V)||_.raise("Invalid property name"),_.unicodeProperties.nonBinary[V].test(ce)||_.raise("Invalid property value")},Yt.regexp_validateUnicodePropertyNameOrValue=function(_,V){_.unicodeProperties.binary.test(V)||_.raise("Invalid property name")},Yt.regexp_eatUnicodePropertyName=function(_){var V=0;for(_.lastStringValue="";Ls(V=_.current());)_.lastStringValue+=$u(V),_.advance();return _.lastStringValue!==""};function Ls(_){return oh(_)||_===95}Yt.regexp_eatUnicodePropertyValue=function(_){var V=0;for(_.lastStringValue="";rs(V=_.current());)_.lastStringValue+=$u(V),_.advance();return _.lastStringValue!==""};function rs(_){return Ls(_)||Yl(_)}Yt.regexp_eatLoneUnicodePropertyNameOrValue=function(_){return this.regexp_eatUnicodePropertyValue(_)},Yt.regexp_eatCharacterClass=function(_){if(_.eat(91)){if(_.eat(94),this.regexp_classRanges(_),_.eat(93))return!0;_.raise("Unterminated character class")}return!1},Yt.regexp_classRanges=function(_){for(;this.regexp_eatClassAtom(_);){var V=_.lastIntValue;if(_.eat(45)&&this.regexp_eatClassAtom(_)){var ce=_.lastIntValue;_.switchU&&(V===-1||ce===-1)&&_.raise("Invalid character class"),V!==-1&&ce!==-1&&V>ce&&_.raise("Range out of order in character class")}}},Yt.regexp_eatClassAtom=function(_){var V=_.pos;if(_.eat(92)){if(this.regexp_eatClassEscape(_))return!0;if(_.switchU){var ce=_.current();(ce===99||Xl(ce))&&_.raise("Invalid class escape"),_.raise("Invalid escape")}_.pos=V}var Le=_.current();return Le!==93?(_.lastIntValue=Le,_.advance(),!0):!1},Yt.regexp_eatClassEscape=function(_){var V=_.pos;if(_.eat(98))return _.lastIntValue=8,!0;if(_.switchU&&_.eat(45))return _.lastIntValue=45,!0;if(!_.switchU&&_.eat(99)){if(this.regexp_eatClassControlLetter(_))return!0;_.pos=V}return this.regexp_eatCharacterClassEscape(_)||this.regexp_eatCharacterEscape(_)},Yt.regexp_eatClassControlLetter=function(_){var V=_.current();return Yl(V)||V===95?(_.lastIntValue=V%32,_.advance(),!0):!1},Yt.regexp_eatHexEscapeSequence=function(_){var V=_.pos;if(_.eat(120)){if(this.regexp_eatFixedHexDigits(_,2))return!0;_.switchU&&_.raise("Invalid escape"),_.pos=V}return!1},Yt.regexp_eatDecimalDigits=function(_){var V=_.pos,ce=0;for(_.lastIntValue=0;Yl(ce=_.current());)_.lastIntValue=10*_.lastIntValue+(ce-48),_.advance();return _.pos!==V};function Yl(_){return _>=48&&_<=57}Yt.regexp_eatHexDigits=function(_){var V=_.pos,ce=0;for(_.lastIntValue=0;Cl(ce=_.current());)_.lastIntValue=16*_.lastIntValue+xu(ce),_.advance();return _.pos!==V};function Cl(_){return _>=48&&_<=57||_>=65&&_<=70||_>=97&&_<=102}function xu(_){return _>=65&&_<=70?10+(_-65):_>=97&&_<=102?10+(_-97):_-48}Yt.regexp_eatLegacyOctalEscapeSequence=function(_){if(this.regexp_eatOctalDigit(_)){var V=_.lastIntValue;if(this.regexp_eatOctalDigit(_)){var ce=_.lastIntValue;V<=3&&this.regexp_eatOctalDigit(_)?_.lastIntValue=V*64+ce*8+_.lastIntValue:_.lastIntValue=V*8+ce}else _.lastIntValue=V;return!0}return!1},Yt.regexp_eatOctalDigit=function(_){var V=_.current();return Xl(V)?(_.lastIntValue=V-48,_.advance(),!0):(_.lastIntValue=0,!1)};function Xl(_){return _>=48&&_<=55}Yt.regexp_eatFixedHexDigits=function(_,V){var ce=_.pos;_.lastIntValue=0;for(var Le=0;Le<V;++Le){var Ge=_.current();if(!Cl(Ge))return _.pos=ce,!1;_.lastIntValue=16*_.lastIntValue+xu(Ge),_.advance()}return!0};var go=function(V){this.type=V.type,this.value=V.value,this.start=V.start,this.end=V.end,V.options.locations&&(this.loc=new Re(V,V.startLoc,V.endLoc)),V.options.ranges&&(this.range=[V.start,V.end])},bi=ei.prototype;bi.next=function(_){!_&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new go(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},bi.getToken=function(){return this.next(),new go(this)},typeof Symbol<"u"&&(bi[Symbol.iterator]=function(){var _=this;return{next:function(){var V=_.getToken();return{done:V.type===U.eof,value:V}}}}),bi.curContext=function(){return this.context[this.context.length-1]},bi.nextToken=function(){var _=this.curContext();if((!_||!_.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(U.eof);if(_.override)return _.override(this);this.readToken(this.fullCharCodeAtPos())},bi.readToken=function(_){return _e(_,this.options.ecmaVersion>=6)||_===92?this.readWord():this.getTokenFromCode(_)},bi.fullCharCodeAtPos=function(){var _=this.input.charCodeAt(this.pos);if(_<=55295||_>=57344)return _;var V=this.input.charCodeAt(this.pos+1);return(_<<10)+V-56613888},bi.skipBlockComment=function(){var _=this.options.onComment&&this.curPosition(),V=this.pos,ce=this.input.indexOf("*/",this.pos+=2);if(ce===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=ce+2,this.options.locations){Fe.lastIndex=V;for(var Le;(Le=Fe.exec(this.input))&&Le.index<this.pos;)++this.curLine,this.lineStart=Le.index+Le[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(V+2,ce),V,this.pos,_,this.curPosition())},bi.skipLineComment=function(_){for(var V=this.pos,ce=this.options.onComment&&this.curPosition(),Le=this.input.charCodeAt(this.pos+=_);this.pos<this.input.length&&!bt(Le);)Le=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(V+_,this.pos),V,this.pos,ce,this.curPosition())},bi.skipSpace=function(){e:for(;this.pos<this.input.length;){var _=this.input.charCodeAt(this.pos);switch(_){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(_>8&&_<14||_>=5760&&v.test(String.fromCharCode(_)))++this.pos;else break e}}},bi.finishToken=function(_,V){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var ce=this.type;this.type=_,this.value=V,this.updateContext(ce)},bi.readToken_dot=function(){var _=this.input.charCodeAt(this.pos+1);if(_>=48&&_<=57)return this.readNumber(!0);var V=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&_===46&&V===46?(this.pos+=3,this.finishToken(U.ellipsis)):(++this.pos,this.finishToken(U.dot))},bi.readToken_slash=function(){var _=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):_===61?this.finishOp(U.assign,2):this.finishOp(U.slash,1)},bi.readToken_mult_modulo_exp=function(_){var V=this.input.charCodeAt(this.pos+1),ce=1,Le=_===42?U.star:U.modulo;return this.options.ecmaVersion>=7&&_===42&&V===42&&(++ce,Le=U.starstar,V=this.input.charCodeAt(this.pos+2)),V===61?this.finishOp(U.assign,ce+1):this.finishOp(Le,ce)},bi.readToken_pipe_amp=function(_){var V=this.input.charCodeAt(this.pos+1);return V===_?this.finishOp(_===124?U.logicalOR:U.logicalAND,2):V===61?this.finishOp(U.assign,2):this.finishOp(_===124?U.bitwiseOR:U.bitwiseAND,1)},bi.readToken_caret=function(){var _=this.input.charCodeAt(this.pos+1);return _===61?this.finishOp(U.assign,2):this.finishOp(U.bitwiseXOR,1)},bi.readToken_plus_min=function(_){var V=this.input.charCodeAt(this.pos+1);return V===_?V===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Oe.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(U.incDec,2):V===61?this.finishOp(U.assign,2):this.finishOp(U.plusMin,1)},bi.readToken_lt_gt=function(_){var V=this.input.charCodeAt(this.pos+1),ce=1;return V===_?(ce=_===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+ce)===61?this.finishOp(U.assign,ce+1):this.finishOp(U.bitShift,ce)):V===33&&_===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(V===61&&(ce=2),this.finishOp(U.relational,ce))},bi.readToken_eq_excl=function(_){var V=this.input.charCodeAt(this.pos+1);return V===61?this.finishOp(U.equality,this.input.charCodeAt(this.pos+2)===61?3:2):_===61&&V===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(U.arrow)):this.finishOp(_===61?U.eq:U.prefix,1)},bi.getTokenFromCode=function(_){switch(_){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(U.parenL);case 41:return++this.pos,this.finishToken(U.parenR);case 59:return++this.pos,this.finishToken(U.semi);case 44:return++this.pos,this.finishToken(U.comma);case 91:return++this.pos,this.finishToken(U.bracketL);case 93:return++this.pos,this.finishToken(U.bracketR);case 123:return++this.pos,this.finishToken(U.braceL);case 125:return++this.pos,this.finishToken(U.braceR);case 58:return++this.pos,this.finishToken(U.colon);case 63:return++this.pos,this.finishToken(U.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(U.backQuote);case 48:var V=this.input.charCodeAt(this.pos+1);if(V===120||V===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(V===111||V===79)return this.readRadixNumber(8);if(V===98||V===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(_);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(_);case 124:case 38:return this.readToken_pipe_amp(_);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(_);case 60:case 62:return this.readToken_lt_gt(_);case 61:case 33:return this.readToken_eq_excl(_);case 126:return this.finishOp(U.prefix,1)}this.raise(this.pos,"Unexpected character '"+Jl(_)+"'")},bi.finishOp=function(_,V){var ce=this.input.slice(this.pos,this.pos+V);return this.pos+=V,this.finishToken(_,ce)},bi.readRegexp=function(){for(var _,V,ce=this.pos;;){this.pos>=this.input.length&&this.raise(ce,"Unterminated regular expression");var Le=this.input.charAt(this.pos);if(Oe.test(Le)&&this.raise(ce,"Unterminated regular expression"),_)_=!1;else{if(Le==="[")V=!0;else if(Le==="]"&&V)V=!1;else if(Le==="/"&&!V)break;_=Le==="\\"}++this.pos}var Ge=this.input.slice(ce,this.pos);++this.pos;var mt=this.pos,Ct=this.readWord1();this.containsEsc&&this.unexpected(mt);var Jt=this.regexpState||(this.regexpState=new Wo(this));Jt.reset(ce,Ge,Ct),this.validateRegExpFlags(Jt),this.validateRegExpPattern(Jt);var Dn=null;try{Dn=new RegExp(Ge,Ct)}catch{}return this.finishToken(U.regexp,{pattern:Ge,flags:Ct,value:Dn})},bi.readInt=function(_,V){for(var ce=this.pos,Le=0,Ge=0,mt=V??1/0;Ge<mt;++Ge){var Ct=this.input.charCodeAt(this.pos),Jt=void 0;if(Ct>=97?Jt=Ct-97+10:Ct>=65?Jt=Ct-65+10:Ct>=48&&Ct<=57?Jt=Ct-48:Jt=1/0,Jt>=_)break;++this.pos,Le=Le*_+Jt}return this.pos===ce||V!=null&&this.pos-ce!==V?null:Le},bi.readRadixNumber=function(_){var V=this.pos;this.pos+=2;var ce=this.readInt(_);return ce==null&&this.raise(this.start+2,"Expected number in radix "+_),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(ce=typeof BigInt<"u"?BigInt(this.input.slice(V,this.pos)):null,++this.pos):_e(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(U.num,ce)},bi.readNumber=function(_){var V=this.pos;!_&&this.readInt(10)===null&&this.raise(V,"Invalid number");var ce=this.pos-V>=2&&this.input.charCodeAt(V)===48;ce&&this.strict&&this.raise(V,"Invalid number");var Le=this.input.charCodeAt(this.pos);if(!ce&&!_&&this.options.ecmaVersion>=11&&Le===110){var Ge=this.input.slice(V,this.pos),mt=typeof BigInt<"u"?BigInt(Ge):null;return++this.pos,_e(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(U.num,mt)}ce&&/[89]/.test(this.input.slice(V,this.pos))&&(ce=!1),Le===46&&!ce&&(++this.pos,this.readInt(10),Le=this.input.charCodeAt(this.pos)),(Le===69||Le===101)&&!ce&&(Le=this.input.charCodeAt(++this.pos),(Le===43||Le===45)&&++this.pos,this.readInt(10)===null&&this.raise(V,"Invalid number")),_e(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ct=this.input.slice(V,this.pos),Jt=ce?parseInt(Ct,8):parseFloat(Ct);return this.finishToken(U.num,Jt)},bi.readCodePoint=function(){var _=this.input.charCodeAt(this.pos),V;if(_===123){this.options.ecmaVersion<6&&this.unexpected();var ce=++this.pos;V=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,V>1114111&&this.invalidStringToken(ce,"Code point out of bounds")}else V=this.readHexChar(4);return V};function Jl(_){return _<=65535?String.fromCharCode(_):(_-=65536,String.fromCharCode((_>>10)+55296,(_&1023)+56320))}bi.readString=function(_){for(var V="",ce=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var Le=this.input.charCodeAt(this.pos);if(Le===_)break;Le===92?(V+=this.input.slice(ce,this.pos),V+=this.readEscapedChar(!1),ce=this.pos):(bt(Le,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return V+=this.input.slice(ce,this.pos++),this.finishToken(U.string,V)};var wc={};bi.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(_){if(_===wc)this.readInvalidTemplateToken();else throw _}this.inTemplateElement=!1},bi.invalidStringToken=function(_,V){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw wc;this.raise(_,V)},bi.readTmplToken=function(){for(var _="",V=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var ce=this.input.charCodeAt(this.pos);if(ce===96||ce===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===U.template||this.type===U.invalidTemplate)?ce===36?(this.pos+=2,this.finishToken(U.dollarBraceL)):(++this.pos,this.finishToken(U.backQuote)):(_+=this.input.slice(V,this.pos),this.finishToken(U.template,_));if(ce===92)_+=this.input.slice(V,this.pos),_+=this.readEscapedChar(!0),V=this.pos;else if(bt(ce)){switch(_+=this.input.slice(V,this.pos),++this.pos,ce){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:_+=`
`;break;default:_+=String.fromCharCode(ce);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),V=this.pos}else++this.pos}},bi.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(U.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},bi.readEscapedChar=function(_){var V=this.input.charCodeAt(++this.pos);switch(++this.pos,V){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Jl(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(_){var ce=this.pos-1;return this.invalidStringToken(ce,"Invalid escape sequence in template string"),null}default:if(V>=48&&V<=55){var Le=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],Ge=parseInt(Le,8);return Ge>255&&(Le=Le.slice(0,-1),Ge=parseInt(Le,8)),this.pos+=Le.length-1,V=this.input.charCodeAt(this.pos),(Le!=="0"||V===56||V===57)&&(this.strict||_)&&this.invalidStringToken(this.pos-1-Le.length,_?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(Ge)}return bt(V)?"":String.fromCharCode(V)}},bi.readHexChar=function(_){var V=this.pos,ce=this.readInt(16,_);return ce===null&&this.invalidStringToken(V,"Bad character escape sequence"),ce},bi.readWord1=function(){this.containsEsc=!1;for(var _="",V=!0,ce=this.pos,Le=this.options.ecmaVersion>=6;this.pos<this.input.length;){var Ge=this.fullCharCodeAtPos();if(Y(Ge,Le))this.pos+=Ge<=65535?1:2;else if(Ge===92){this.containsEsc=!0,_+=this.input.slice(ce,this.pos);var mt=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Ct=this.readCodePoint();(V?_e:Y)(Ct,Le)||this.invalidStringToken(mt,"Invalid Unicode escape"),_+=Jl(Ct),ce=this.pos}else break;V=!1}return _+this.input.slice(ce,this.pos)},bi.readWord=function(){var _=this.readWord1(),V=U.name;return this.keywords.test(_)&&(V=vt[_]),this.finishToken(V,_)};var Sc="7.1.0";ei.acorn={Parser:ei,version:Sc,defaultOptions:Xe,Position:xe,SourceLocation:Re,getLineInfo:Ue,Node:Xi,TokenType:re,tokTypes:U,keywordTypes:vt,TokContext:_i,tokContexts:Fn,isIdentifierChar:Y,isIdentifierStart:_e,Token:go,isNewLine:bt,lineBreak:Oe,lineBreakG:Fe,nonASCIIwhitespace:v};function Rl(_,V){return ei.parse(_,V)}function _d(_,V,ce){return ei.parseExpressionAt(_,V,ce)}function bd(_,V){return ei.tokenizer(_,V)}L.Node=Xi,L.Parser=ei,L.Position=xe,L.SourceLocation=Re,L.TokContext=_i,L.Token=go,L.TokenType=re,L.defaultOptions=Xe,L.getLineInfo=Ue,L.isIdentifierChar=Y,L.isIdentifierStart=_e,L.isNewLine=bt,L.keywordTypes=vt,L.lineBreak=Oe,L.lineBreakG=Fe,L.nonASCIIwhitespace=v,L.parse=Rl,L.parseExpressionAt=_d,L.tokContexts=Fn,L.tokTypes=U,L.tokenizer=bd,L.version=Sc,Object.defineProperty(L,"__esModule",{value:!0})})},{}],2:[function(p,y,N){},{}],3:[function(p,y,N){function L(R,S={}){const{contextName:T="gl",throwGetError:H,useTrackablePrimitives:te,readPixelsFile:Se,recording:ie=[],variables:_e={},onReadPixels:Y,onUnrecognizedArgumentLookup:re}=S,be=new Proxy(R,{get:Oe}),ke=[],it={};let vt=0,Q="",U;return be;function Oe(Ue,Xe){switch(Xe){case"addComment":return de;case"checkThrowError":return ue;case"getReadPixelsVariableName":return U;case"insertVariable":return v;case"reset":return bt;case"setIndent":return M;case"toString":return Fe;case"getContextVariableName":return Re}return typeof R[Xe]=="function"?function(){switch(Xe){case"getError":return H?ie.push(`${Q}if (${T}.getError() !== ${T}.NONE) throw new Error('error');`):ie.push(`${Q}${T}.getError();`),R.getError();case"getExtension":{const Ze=`${T}Variables${ke.length}`;ie.push(`${Q}const ${Ze} = ${T}.getExtension('${arguments[0]}');`);const gt=R.getExtension(arguments[0]);if(gt&&typeof gt=="object"){const wt=F(gt,{getEntity:I,useTrackablePrimitives:te,recording:ie,contextName:Ze,contextVariables:ke,variables:_e,indent:Q,onUnrecognizedArgumentLookup:re});return ke.push(wt),wt}else ke.push(null);return gt}case"readPixels":const He=ke.indexOf(arguments[6]);let et;if(He===-1){const Ze=xe(arguments[6]);Ze?(et=Ze,ie.push(`${Q}${Ze}`)):(et=`${T}Variable${ke.length}`,ke.push(arguments[6]),ie.push(`${Q}const ${et} = new ${arguments[6].constructor.name}(${arguments[6].length});`))}else et=`${T}Variable${He}`;U=et;const at=[arguments[0],arguments[1],arguments[2],arguments[3],I(arguments[4]),I(arguments[5]),et];return ie.push(`${Q}${T}.readPixels(${at.join(", ")});`),Se&&oe(arguments[2],arguments[3]),Y&&Y(et,at),R.readPixels.apply(R,arguments);case"drawBuffers":return ie.push(`${Q}${T}.drawBuffers([${z(arguments[0],{contextName:T,contextVariables:ke,getEntity:I,addVariable:G,variables:_e,onUnrecognizedArgumentLookup:re})}]);`),R.drawBuffers(arguments[0])}let Ae=R[Xe].apply(R,arguments);switch(typeof Ae){case"undefined":ie.push(`${Q}${ve(Xe,arguments)};`);return;case"number":case"boolean":if(te&&ke.indexOf(k(Ae))===-1){ie.push(`${Q}const ${T}Variable${ke.length} = ${ve(Xe,arguments)};`),ke.push(Ae=k(Ae));break}default:Ae===null?ie.push(`${ve(Xe,arguments)};`):ie.push(`${Q}const ${T}Variable${ke.length} = ${ve(Xe,arguments)};`),ke.push(Ae)}return Ae}:(it[R[Xe]]=Xe,R[Xe])}function Fe(){return ie.join(`
`)}function bt(){for(;ie.length>0;)ie.pop()}function v(Ue,Xe){_e[Ue]=Xe}function I(Ue){const Xe=it[Ue];return Xe?T+"."+Xe:Ue}function M(Ue){Q=" ".repeat(Ue)}function G(Ue,Xe){const Ae=`${T}Variable${ke.length}`;return ie.push(`${Q}const ${Ae} = ${Xe};`),ke.push(Ue),Ae}function oe(Ue,Xe){const Ae=`${T}Variable${ke.length}`,He=`imageDatum${vt}`;ie.push(`${Q}let ${He} = ["P3\\n# ${Se}.ppm\\n", ${Ue}, ' ', ${Xe}, "\\n255\\n"].join("");`),ie.push(`${Q}for (let i = 0; i < ${He}.length; i += 4) {`),ie.push(`${Q}  ${He} += ${Ae}[i] + ' ' + ${Ae}[i + 1] + ' ' + ${Ae}[i + 2] + ' ';`),ie.push(`${Q}}`),ie.push(`${Q}if (typeof require !== "undefined") {`),ie.push(`${Q}  require('fs').writeFileSync('./${Se}.ppm', ${He});`),ie.push(`${Q}}`),vt++}function de(Ue){ie.push(`${Q}// ${Ue}`)}function ue(){ie.push(`${Q}(() => {
${Q}const error = ${T}.getError();
${Q}if (error !== ${T}.NONE) {
${Q}  const names = Object.getOwnPropertyNames(gl);
${Q}  for (let i = 0; i < names.length; i++) {
${Q}    const name = names[i];
${Q}    if (${T}[name] === error) {
${Q}      throw new Error('${T} threw ' + name);
${Q}    }
${Q}  }
${Q}}
${Q}})();`)}function ve(Ue,Xe){return`${T}.${Ue}(${z(Xe,{contextName:T,contextVariables:ke,getEntity:I,addVariable:G,variables:_e,onUnrecognizedArgumentLookup:re})})`}function xe(Ue){if(_e){for(const Xe in _e)if(_e[Xe]===Ue)return Xe}return null}function Re(Ue){const Xe=ke.indexOf(Ue);return Xe!==-1?`${T}Variable${Xe}`:null}}function F(R,S){const T=new Proxy(R,{get:it}),H={},{contextName:te,contextVariables:Se,getEntity:ie,useTrackablePrimitives:_e,recording:Y,variables:re,indent:be,onUnrecognizedArgumentLookup:ke}=S;return T;function it(Oe,Fe){return typeof Oe[Fe]=="function"?function(){switch(Fe){case"drawBuffersWEBGL":return Y.push(`${be}${te}.drawBuffersWEBGL([${z(arguments[0],{contextName:te,contextVariables:Se,getEntity:vt,addVariable:U,variables:re,onUnrecognizedArgumentLookup:ke})}]);`),R.drawBuffersWEBGL(arguments[0])}let bt=R[Fe].apply(R,arguments);switch(typeof bt){case"undefined":Y.push(`${be}${Q(Fe,arguments)};`);return;case"number":case"boolean":_e&&Se.indexOf(k(bt))===-1?(Y.push(`${be}const ${te}Variable${Se.length} = ${Q(Fe,arguments)};`),Se.push(bt=k(bt))):(Y.push(`${be}const ${te}Variable${Se.length} = ${Q(Fe,arguments)};`),Se.push(bt));break;default:bt===null?Y.push(`${Q(Fe,arguments)};`):Y.push(`${be}const ${te}Variable${Se.length} = ${Q(Fe,arguments)};`),Se.push(bt)}return bt}:(H[R[Fe]]=Fe,R[Fe])}function vt(Oe){return H.hasOwnProperty(Oe)?`${te}.${H[Oe]}`:ie(Oe)}function Q(Oe,Fe){return`${te}.${Oe}(${z(Fe,{contextName:te,contextVariables:Se,getEntity:vt,addVariable:U,variables:re,onUnrecognizedArgumentLookup:ke})})`}function U(Oe,Fe){const bt=`${te}Variable${Se.length}`;return Se.push(Oe),Y.push(`${be}const ${bt} = ${Fe};`),bt}}function z(R,S){const{variables:T,onUnrecognizedArgumentLookup:H}=S;return Array.from(R).map(Se=>{const ie=te(Se);return ie||P(Se,S)}).join(", ");function te(Se){if(T){for(const ie in T)if(T.hasOwnProperty(ie)&&T[ie]===Se)return ie}return H?H(Se):null}}function P(R,S){const{contextName:T,contextVariables:H,getEntity:te,addVariable:Se,onUnrecognizedArgumentLookup:ie}=S;if(typeof R>"u")return"undefined";if(R===null)return"null";const _e=H.indexOf(R);if(_e>-1)return`${T}Variable${_e}`;switch(R.constructor.name){case"String":const Y=/\n/.test(R),re=/'/.test(R),be=/"/.test(R);return Y?"`"+R+"`":re&&!be?'"'+R+'"':"'"+R+"'";case"Number":return te(R);case"Boolean":return te(R);case"Array":return Se(R,`new ${R.constructor.name}([${Array.from(R).join(",")}])`);case"Float32Array":case"Uint8Array":case"Uint16Array":case"Int32Array":return Se(R,`new ${R.constructor.name}(${JSON.stringify(Array.from(R))})`);default:if(ie){const ke=ie(R);if(ke)return ke}throw new Error(`unrecognized argument type ${R.constructor.name}`)}}function k(R){return new R.constructor(R)}typeof y<"u"&&(y.exports={glWiretap:L,glExtensionWiretap:F}),typeof window<"u"&&(L.glExtensionWiretap=F,window.glWiretap=L)},{}],4:[function(p,y,N){function L(Se){const ie=new Array(Se.length);for(let _e=0;_e<Se.length;_e++){const Y=Se[_e];Y.toArray?ie[_e]=Y.toArray():ie[_e]=Y}return ie}function F(){const Se=L(arguments),ie=new Float32Array(this.output.x);for(let _e=0;_e<this.output.x;_e++)this.thread.x=_e,this.thread.y=0,this.thread.z=0,ie[_e]=this._fn.apply(this,Se);return ie}function z(){const Se=L(arguments),ie=new Array(this.output.y);for(let _e=0;_e<this.output.y;_e++){const Y=new Float32Array(this.output.x);for(let re=0;re<this.output.x;re++)this.thread.x=re,this.thread.y=_e,this.thread.z=0,Y[re]=this._fn.apply(this,Se);ie[_e]=Y}return ie}function P(){const Se=L(arguments);for(let ie=0;ie<this.output.y;ie++)for(let _e=0;_e<this.output.x;_e++)this.thread.x=_e,this.thread.y=ie,this.thread.z=0,this._fn.apply(this,Se)}function k(){const Se=L(arguments),ie=new Array(this.output.z);for(let _e=0;_e<this.output.z;_e++){const Y=new Array(this.output.y);for(let re=0;re<this.output.y;re++){const be=new Float32Array(this.output.x);for(let ke=0;ke<this.output.x;ke++)this.thread.x=ke,this.thread.y=re,this.thread.z=_e,be[ke]=this._fn.apply(this,Se);Y[re]=be}ie[_e]=Y}return ie}function R(Se){Se.setOutput=Y=>{Se.output=T(Y),Se.graphical&&S(Se)},Se.toJSON=()=>{throw new Error("Not usable with gpuMock")},Se.setConstants=Y=>(Se.constants=Y,Se),Se.setGraphical=Y=>(Se.graphical=Y,Se),Se.setCanvas=Y=>(Se.canvas=Y,Se),Se.setContext=Y=>(Se.context=Y,Se),Se.destroy=()=>{},Se.validateSettings=()=>{},Se.graphical&&Se.output&&S(Se),Se.exec=function(){return new Promise((Y,re)=>{try{Y(Se.apply(Se,arguments))}catch(be){re(be)}})},Se.getPixels=Y=>{const{x:re,y:be}=Se.output;return Y?te(Se._imageData.data,re,be):Se._imageData.data.slice(0)},Se.color=function(Y,re,be,ke){typeof ke>"u"&&(ke=1),Y=Math.floor(Y*255),re=Math.floor(re*255),be=Math.floor(be*255),ke=Math.floor(ke*255);const it=Se.output.x,vt=Se.output.y,Q=Se.thread.x,U=vt-Se.thread.y-1,Oe=Q+U*it;Se._colorData[Oe*4+0]=Y,Se._colorData[Oe*4+1]=re,Se._colorData[Oe*4+2]=be,Se._colorData[Oe*4+3]=ke};const ie=()=>Se,_e=["setWarnVarUsage","setArgumentTypes","setTactic","setOptimizeFloatMemory","setDebug","setLoopMaxIterations","setConstantTypes","setFunctions","setNativeFunctions","setInjectedNative","setPipeline","setPrecision","setOutputToTexture","setImmutable","setStrictIntegers","setDynamicOutput","setHardcodeConstants","setDynamicArguments","setUseLegacyEncoder","setWarnVarUsage","addSubKernel"];for(let Y=0;Y<_e.length;Y++)Se[_e[Y]]=ie;return Se}function S(Se){const{x:ie,y:_e}=Se.output;if(Se.context&&Se.context.createImageData){const Y=new Uint8ClampedArray(ie*_e*4);Se._imageData=Se.context.createImageData(ie,_e),Se._colorData=Y}else{const Y=new Uint8ClampedArray(ie*_e*4);Se._imageData={data:Y},Se._colorData=Y}}function T(Se){let ie=null;if(Se.length)if(Se.length===3){const[_e,Y,re]=Se;ie={x:_e,y:Y,z:re}}else if(Se.length===2){const[_e,Y]=Se;ie={x:_e,y:Y}}else{const[_e]=Se;ie={x:_e}}else ie=Se;return ie}function H(Se,ie={}){const _e=ie.output?T(ie.output):null;function Y(){return Y.output.z?k.apply(Y,arguments):Y.output.y?Y.graphical?P.apply(Y,arguments):z.apply(Y,arguments):F.apply(Y,arguments)}return Y._fn=Se,Y.constants=ie.constants||null,Y.context=ie.context||null,Y.canvas=ie.canvas||null,Y.graphical=ie.graphical||!1,Y._imageData=null,Y._colorData=null,Y.output=_e,Y.thread={x:0,y:0,z:0},R(Y)}function te(Se,ie,_e){const Y=_e/2|0,re=ie*4,be=new Uint8ClampedArray(ie*4),ke=Se.slice(0);for(let it=0;it<Y;++it){const vt=it*re,Q=(_e-it-1)*re;be.set(ke.subarray(vt,vt+re)),ke.copyWithin(vt,Q,Q+re),ke.set(be,Q)}return ke}y.exports={gpuMock:H}},{}],5:[function(p,y,N){const{utils:L}=p("./utils");function F(z,P){const k=P.toString();return new Function(`return function ${z} (${L.getArgumentNamesFromString(k).join(", ")}) {
  ${L.getFunctionBodyFromString(k)}
}`)()}y.exports={alias:F}},{"./utils":114}],6:[function(p,y,N){const{FunctionNode:L}=p("../function-node");class F extends L{astFunction(P,k){if(!this.isRootKernel){k.push("function"),k.push(" "),k.push(this.name),k.push("(");for(let R=0;R<this.argumentNames.length;++R){const S=this.argumentNames[R];R>0&&k.push(", "),k.push("user_"),k.push(S)}k.push(`) {
`)}for(let R=0;R<P.body.body.length;++R)this.astGeneric(P.body.body[R],k),k.push(`
`);return this.isRootKernel||k.push(`}
`),k}astReturnStatement(P,k){const R=this.returnType||this.getType(P.argument);return this.returnType||(this.returnType=R),this.isRootKernel?(k.push(this.leadingReturnStatement),this.astGeneric(P.argument,k),k.push(`;
`),k.push(this.followingReturnStatement),k.push(`continue;
`)):this.isSubKernel?(k.push(`subKernelResult_${this.name} = `),this.astGeneric(P.argument,k),k.push(";"),k.push(`return subKernelResult_${this.name};`)):(k.push("return "),this.astGeneric(P.argument,k),k.push(";")),k}astLiteral(P,k){if(isNaN(P.value))throw this.astErrorOutput("Non-numeric literal not supported : "+P.value,P);return k.push(P.value),k}astBinaryExpression(P,k){return k.push("("),this.astGeneric(P.left,k),k.push(P.operator),this.astGeneric(P.right,k),k.push(")"),k}astIdentifierExpression(P,k){if(P.type!=="Identifier")throw this.astErrorOutput("IdentifierExpression - not an Identifier",P);switch(P.name){case"Infinity":k.push("Infinity");break;default:this.constants&&this.constants.hasOwnProperty(P.name)?k.push("constants_"+P.name):k.push("user_"+P.name)}return k}astForStatement(P,k){if(P.type!=="ForStatement")throw this.astErrorOutput("Invalid for statement",P);const R=[],S=[],T=[],H=[];let te=null;if(P.init){this.pushState("in-for-loop-init"),this.astGeneric(P.init,R);for(let Se=0;Se<R.length;Se++)R[Se].includes&&R[Se].includes(",")&&(te=!1);this.popState("in-for-loop-init")}else te=!1;if(P.test?this.astGeneric(P.test,S):te=!1,P.update?this.astGeneric(P.update,T):te=!1,P.body&&(this.pushState("loop-body"),this.astGeneric(P.body,H),this.popState("loop-body")),te===null&&(te=this.isSafe(P.init)&&this.isSafe(P.test)),te)k.push(`for (${R.join("")};${S.join("")};${T.join("")}){
`),k.push(H.join("")),k.push(`}
`);else{const Se=this.getInternalVariableName("safeI");R.length>0&&k.push(R.join(""),`;
`),k.push(`for (let ${Se}=0;${Se}<LOOP_MAX;${Se}++){
`),S.length>0&&k.push(`if (!${S.join("")}) break;
`),k.push(H.join("")),k.push(`
${T.join("")};`),k.push(`}
`)}return k}astWhileStatement(P,k){if(P.type!=="WhileStatement")throw this.astErrorOutput("Invalid while statement",P);return k.push("for (let i = 0; i < LOOP_MAX; i++) {"),k.push("if ("),this.astGeneric(P.test,k),k.push(`) {
`),this.astGeneric(P.body,k),k.push(`} else {
`),k.push(`break;
`),k.push(`}
`),k.push(`}
`),k}astDoWhileStatement(P,k){if(P.type!=="DoWhileStatement")throw this.astErrorOutput("Invalid while statement",P);return k.push("for (let i = 0; i < LOOP_MAX; i++) {"),this.astGeneric(P.body,k),k.push("if (!"),this.astGeneric(P.test,k),k.push(`) {
`),k.push(`break;
`),k.push(`}
`),k.push(`}
`),k}astAssignmentExpression(P,k){const R=this.getDeclaration(P.left);if(R&&!R.assignable)throw this.astErrorOutput(`Variable ${P.left.name} is not assignable here`,P);return this.astGeneric(P.left,k),k.push(P.operator),this.astGeneric(P.right,k),k}astBlockStatement(P,k){if(this.isState("loop-body")){this.pushState("block-body");for(let R=0;R<P.body.length;R++)this.astGeneric(P.body[R],k);this.popState("block-body")}else{k.push(`{
`);for(let R=0;R<P.body.length;R++)this.astGeneric(P.body[R],k);k.push(`}
`)}return k}astVariableDeclaration(P,k){k.push(`${P.kind} `);const{declarations:R}=P;for(let S=0;S<R.length;S++){S>0&&k.push(",");const T=R[S],H=this.getDeclaration(T.id);H.valueType||(H.valueType=this.getType(T.init)),this.astGeneric(T,k)}return this.isState("in-for-loop-init")||k.push(";"),k}astIfStatement(P,k){return k.push("if ("),this.astGeneric(P.test,k),k.push(")"),P.consequent.type==="BlockStatement"?this.astGeneric(P.consequent,k):(k.push(` {
`),this.astGeneric(P.consequent,k),k.push(`
}
`)),P.alternate&&(k.push("else "),P.alternate.type==="BlockStatement"||P.alternate.type==="IfStatement"?this.astGeneric(P.alternate,k):(k.push(` {
`),this.astGeneric(P.alternate,k),k.push(`
}
`))),k}astSwitchStatement(P,k){const{discriminant:R,cases:S}=P;k.push("switch ("),this.astGeneric(R,k),k.push(`) {
`);for(let T=0;T<S.length;T++){if(S[T].test===null){k.push(`default:
`),this.astGeneric(S[T].consequent,k),S[T].consequent&&S[T].consequent.length>0&&k.push(`break;
`);continue}k.push("case "),this.astGeneric(S[T].test,k),k.push(`:
`),S[T].consequent&&S[T].consequent.length>0&&(this.astGeneric(S[T].consequent,k),k.push(`break;
`))}k.push(`
}`)}astThisExpression(P,k){return k.push("_this"),k}astMemberExpression(P,k){const{signature:R,type:S,property:T,xProperty:H,yProperty:te,zProperty:Se,name:ie,origin:_e}=this.getMemberExpressionDetails(P);switch(R){case"this.thread.value":return k.push(`_this.thread.${ie}`),k;case"this.output.value":switch(ie){case"x":k.push("outputX");break;case"y":k.push("outputY");break;case"z":k.push("outputZ");break;default:throw this.astErrorOutput("Unexpected expression",P)}return k;case"value":throw this.astErrorOutput("Unexpected expression",P);case"value[]":case"value[][]":case"value[][][]":case"value.value":if(_e==="Math")return k.push(Math[ie]),k;switch(T){case"r":return k.push(`user_${ie}[0]`),k;case"g":return k.push(`user_${ie}[1]`),k;case"b":return k.push(`user_${ie}[2]`),k;case"a":return k.push(`user_${ie}[3]`),k}break;case"this.constants.value":case"this.constants.value[]":case"this.constants.value[][]":case"this.constants.value[][][]":break;case"fn()[]":return this.astGeneric(P.object,k),k.push("["),this.astGeneric(P.property,k),k.push("]"),k;case"fn()[][]":return this.astGeneric(P.object.object,k),k.push("["),this.astGeneric(P.object.property,k),k.push("]"),k.push("["),this.astGeneric(P.property,k),k.push("]"),k;default:throw this.astErrorOutput("Unexpected expression",P)}if(!P.computed)switch(S){case"Number":case"Integer":case"Float":case"Boolean":return k.push(`${_e}_${ie}`),k}const Y=`${_e}_${ie}`;switch(S){case"Array(2)":case"Array(3)":case"Array(4)":case"Matrix(2)":case"Matrix(3)":case"Matrix(4)":case"HTMLImageArray":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":case"HTMLImage":default:let re,be;if(_e==="constants"){const ke=this.constants[ie];be=this.constantTypes[ie]==="Input",re=be?ke.size:null}else be=this.isInput(ie),re=be?this.argumentSizes[this.argumentNames.indexOf(ie)]:null;k.push(`${Y}`),Se&&te?be?(k.push("[("),this.astGeneric(Se,k),k.push(`*${this.dynamicArguments?"(outputY * outputX)":re[1]*re[0]})+(`),this.astGeneric(te,k),k.push(`*${this.dynamicArguments?"outputX":re[0]})+`),this.astGeneric(H,k),k.push("]")):(k.push("["),this.astGeneric(Se,k),k.push("]"),k.push("["),this.astGeneric(te,k),k.push("]"),k.push("["),this.astGeneric(H,k),k.push("]")):te?be?(k.push("[("),this.astGeneric(te,k),k.push(`*${this.dynamicArguments?"outputX":re[0]})+`),this.astGeneric(H,k),k.push("]")):(k.push("["),this.astGeneric(te,k),k.push("]"),k.push("["),this.astGeneric(H,k),k.push("]")):typeof H<"u"&&(k.push("["),this.astGeneric(H,k),k.push("]"))}return k}astCallExpression(P,k){if(P.type!=="CallExpression")throw this.astErrorOutput("Unknown CallExpression",P);let R=this.astMemberExpressionUnroll(P.callee);this.calledFunctions.indexOf(R)<0&&this.calledFunctions.push(R),this.isAstMathFunction(P),this.onFunctionCall&&this.onFunctionCall(this.name,R,P.arguments),k.push(R),k.push("(");const S=this.lookupFunctionArgumentTypes(R)||[];for(let T=0;T<P.arguments.length;++T){const H=P.arguments[T];let te=this.getType(H);S[T]||this.triggerImplyArgumentType(R,T,te,this),T>0&&k.push(", "),this.astGeneric(H,k)}return k.push(")"),k}astArrayExpression(P,k){const R=this.getType(P),S=P.elements.length,T=[];for(let H=0;H<S;++H){const te=[];this.astGeneric(P.elements[H],te),T.push(te.join(""))}switch(R){case"Matrix(2)":case"Matrix(3)":case"Matrix(4)":k.push(`[${T.join(", ")}]`);break;default:k.push(`new Float32Array([${T.join(", ")}])`)}return k}astDebuggerStatement(P,k){return k.push("debugger;"),k}}y.exports={CPUFunctionNode:F}},{"../function-node":10}],7:[function(p,y,N){const{utils:L}=p("../../utils");function F(P,k){const R=[];for(const S in k){if(!k.hasOwnProperty(S))continue;const T=k[S],H=P[S];switch(T){case"Number":case"Integer":case"Float":case"Boolean":R.push(`${S}:${H}`);break;case"Array(2)":case"Array(3)":case"Array(4)":case"Matrix(2)":case"Matrix(3)":case"Matrix(4)":R.push(`${S}:new ${H.constructor.name}(${JSON.stringify(Array.from(H))})`);break}}return`{ ${R.join()} }`}function z(P,k){const R=[],S=[],T=[],H=!/^function/.test(P.color.toString());if(R.push("  const { context, canvas, constants: incomingConstants } = settings;",`  const output = new Int32Array(${JSON.stringify(Array.from(P.output))});`,`  const _constantTypes = ${JSON.stringify(P.constantTypes)};`,`  const _constants = ${F(P.constants,P.constantTypes)};`),S.push("    constants: _constants,","    context,","    output,","    thread: {x: 0, y: 0, z: 0},"),P.graphical){R.push(`  const _imageData = context.createImageData(${P.output[0]}, ${P.output[1]});`),R.push(`  const _colorData = new Uint8ClampedArray(${P.output[0]} * ${P.output[1]} * 4);`);const ie=L.flattenFunctionToString((H?"function ":"")+P.color.toString(),{thisLookup:Y=>{switch(Y){case"_colorData":return"_colorData";case"_imageData":return"_imageData";case"output":return"output";case"thread":return"this.thread"}return JSON.stringify(P[Y])},findDependency:(Y,re)=>null}),_e=L.flattenFunctionToString((H?"function ":"")+P.getPixels.toString(),{thisLookup:Y=>{switch(Y){case"_colorData":return"_colorData";case"_imageData":return"_imageData";case"output":return"output";case"thread":return"this.thread"}return JSON.stringify(P[Y])},findDependency:()=>null});S.push("    _imageData,","    _colorData,",`    color: ${ie},`),T.push(`  kernel.getPixels = ${_e};`)}const te=[],Se=Object.keys(P.constantTypes);for(let ie=0;ie<Se.length;ie++)te.push(P.constantTypes[Se]);if(P.argumentTypes.indexOf("HTMLImageArray")!==-1||te.indexOf("HTMLImageArray")!==-1){const ie=L.flattenFunctionToString((H?"function ":"")+P._imageTo3DArray.toString(),{doNotDefine:["canvas"],findDependency:(_e,Y)=>_e==="this"?(H?"function ":"")+P[Y].toString():null,thisLookup:_e=>{switch(_e){case"canvas":return;case"context":return"context"}}});T.push(ie),S.push("    _mediaTo2DArray,"),S.push("    _imageTo3DArray,")}else if(P.argumentTypes.indexOf("HTMLImage")!==-1||te.indexOf("HTMLImage")!==-1){const ie=L.flattenFunctionToString((H?"function ":"")+P._mediaTo2DArray.toString(),{findDependency:(_e,Y)=>null,thisLookup:_e=>{switch(_e){case"canvas":return"settings.canvas";case"context":return"settings.context"}throw new Error("unhandled thisLookup")}});T.push(ie),S.push("    _mediaTo2DArray,")}return`function(settings) {
${R.join(`
`)}
  for (const p in _constantTypes) {
    if (!_constantTypes.hasOwnProperty(p)) continue;
    const type = _constantTypes[p];
    switch (type) {
      case 'Number':
      case 'Integer':
      case 'Float':
      case 'Boolean':
      case 'Array(2)':
      case 'Array(3)':
      case 'Array(4)':
      case 'Matrix(2)':
      case 'Matrix(3)':
      case 'Matrix(4)':
        if (incomingConstants.hasOwnProperty(p)) {
          console.warn('constant ' + p + ' of type ' + type + ' cannot be resigned');
        }
        continue;
    }
    if (!incomingConstants.hasOwnProperty(p)) {
      throw new Error('constant ' + p + ' not found');
    }
    _constants[p] = incomingConstants[p];
  }
  const kernel = (function() {
${P._kernelString}
  })
    .apply({ ${S.join(`
`)} });
  ${T.join(`
`)}
  return kernel;
}`}y.exports={cpuKernelString:z}},{"../../utils":114}],8:[function(p,y,N){const{Kernel:L}=p("../kernel"),{FunctionBuilder:F}=p("../function-builder"),{CPUFunctionNode:z}=p("./function-node"),{utils:P}=p("../../utils"),{cpuKernelString:k}=p("./kernel-string");class R extends L{static getFeatures(){return this.features}static get features(){return Object.freeze({kernelMap:!0,isIntegerDivisionAccurate:!0})}static get isSupported(){return!0}static isContextMatch(T){return!1}static get mode(){return"cpu"}static nativeFunctionArguments(){return null}static nativeFunctionReturnType(){throw new Error(`Looking up native function return type not supported on ${this.name}`)}static combineKernels(T){return T}static getSignature(T,H){return"cpu"+(H.length>0?":"+H.join(","):"")}constructor(T,H){super(T,H),this.mergeSettings(T.settings||H),this._imageData=null,this._colorData=null,this._kernelString=null,this._prependedString=[],this.thread={x:0,y:0,z:0},this.translatedSources=null}initCanvas(){if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(0,0)}initContext(){return this.canvas?this.canvas.getContext("2d"):null}initPlugins(T){return[]}validateSettings(T){if(!this.output||this.output.length===0){if(T.length!==1)throw new Error("Auto output only supported for kernels with only one input");const H=P.getVariableType(T[0],this.strictIntegers);if(H==="Array")this.output=P.getDimensions(H);else if(H==="NumberTexture"||H==="ArrayTexture(4)")this.output=T[0].output;else throw new Error("Auto output not supported for input type: "+H)}if(this.graphical&&this.output.length!==2)throw new Error("Output must have 2 dimensions on graphical mode");this.checkOutput()}translateSource(){if(this.leadingReturnStatement=this.output.length>1?"resultX[x] = ":"result[x] = ",this.subKernels){const H=[];for(let te=0;te<this.subKernels.length;te++){const{name:Se}=this.subKernels[te];H.push(this.output.length>1?`resultX_${Se}[x] = subKernelResult_${Se};
`:`result_${Se}[x] = subKernelResult_${Se};
`)}this.followingReturnStatement=H.join("")}const T=F.fromKernel(this,z);this.translatedSources=T.getPrototypes("kernel"),!this.graphical&&!this.returnType&&(this.returnType=T.getKernelResultType())}build(){if(this.built)return;if(this.setupConstants(),this.setupArguments(arguments),this.validateSettings(arguments),this.translateSource(),this.graphical){const{canvas:H,output:te}=this;if(!H)throw new Error("no canvas available for using graphical output");const Se=te[0],ie=te[1]||1;H.width=Se,H.height=ie,this._imageData=this.context.createImageData(Se,ie),this._colorData=new Uint8ClampedArray(Se*ie*4)}const T=this.getKernelString();this.kernelString=T,this.debug&&(console.log("Function output:"),console.log(T));try{this.run=new Function([],T).bind(this)()}catch(H){console.error("An error occurred compiling the javascript: ",H)}this.buildSignature(arguments),this.built=!0}color(T,H,te,Se){typeof Se>"u"&&(Se=1),T=Math.floor(T*255),H=Math.floor(H*255),te=Math.floor(te*255),Se=Math.floor(Se*255);const ie=this.output[0],_e=this.output[1],Y=this.thread.x,re=_e-this.thread.y-1,be=Y+re*ie;this._colorData[be*4+0]=T,this._colorData[be*4+1]=H,this._colorData[be*4+2]=te,this._colorData[be*4+3]=Se}getKernelString(){if(this._kernelString!==null)return this._kernelString;let T=null,{translatedSources:H}=this;return H.length>1?H=H.filter(te=>/^function/.test(te)?te:(T=te,!1)):T=H.shift(),this._kernelString=`  const LOOP_MAX = ${this._getLoopMaxString()};
  ${this.injectedNative||""}
  const _this = this;
  ${this._resultKernelHeader()}
  ${this._processConstants()}
  return (${this.argumentNames.map(te=>"user_"+te).join(", ")}) => {
    ${this._prependedString.join("")}
    ${this._earlyThrows()}
    ${this._processArguments()}
    ${this.graphical?this._graphicalKernelBody(T):this._resultKernelBody(T)}
    ${H.length>0?H.join(`
`):""}
  };`}toString(){return k(this)}_getLoopMaxString(){return this.loopMaxIterations?` ${parseInt(this.loopMaxIterations)};`:" 1000;"}_processConstants(){if(!this.constants)return"";const T=[];for(let H in this.constants)switch(this.constantTypes[H]){case"HTMLCanvas":case"OffscreenCanvas":case"HTMLImage":case"ImageBitmap":case"ImageData":case"HTMLVideo":T.push(`    const constants_${H} = this._mediaTo2DArray(this.constants.${H});
`);break;case"HTMLImageArray":T.push(`    const constants_${H} = this._imageTo3DArray(this.constants.${H});
`);break;case"Input":T.push(`    const constants_${H} = this.constants.${H}.value;
`);break;default:T.push(`    const constants_${H} = this.constants.${H};
`)}return T.join("")}_earlyThrows(){if(this.graphical||this.immutable||!this.pipeline)return"";const T=[];for(let te=0;te<this.argumentTypes.length;te++)this.argumentTypes[te]==="Array"&&T.push(this.argumentNames[te]);if(T.length===0)return"";const H=[];for(let te=0;te<T.length;te++){const Se=T[te],ie=this._mapSubKernels(_e=>`user_${Se} === result_${_e.name}`).join(" || ");H.push(`user_${Se} === result${ie?` || ${ie}`:""}`)}return`if (${H.join(" || ")}) throw new Error('Source and destination arrays are the same.  Use immutable = true');`}_processArguments(){const T=[];for(let H=0;H<this.argumentTypes.length;H++){const te=`user_${this.argumentNames[H]}`;switch(this.argumentTypes[H]){case"HTMLCanvas":case"OffscreenCanvas":case"HTMLImage":case"ImageBitmap":case"ImageData":case"HTMLVideo":T.push(`    ${te} = this._mediaTo2DArray(${te});
`);break;case"HTMLImageArray":T.push(`    ${te} = this._imageTo3DArray(${te});
`);break;case"Input":T.push(`    ${te} = ${te}.value;
`);break;case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":case"NumberTexture":case"MemoryOptimizedNumberTexture":T.push(`
    if (${te}.toArray) {
      if (!_this.textureCache) {
        _this.textureCache = [];
        _this.arrayCache = [];
      }
      const textureIndex = _this.textureCache.indexOf(${te});
      if (textureIndex !== -1) {
        ${te} = _this.arrayCache[textureIndex];
      } else {
        _this.textureCache.push(${te});
        ${te} = ${te}.toArray();
        _this.arrayCache.push(${te});
      }
    }`);break}}return T.join("")}_mediaTo2DArray(T){const H=this.canvas,te=T.width>0?T.width:T.videoWidth,Se=T.height>0?T.height:T.videoHeight;H.width<te&&(H.width=te),H.height<Se&&(H.height=Se);const ie=this.context;let _e;T.constructor===ImageData?_e=T.data:(ie.drawImage(T,0,0,te,Se),_e=ie.getImageData(0,0,te,Se).data);const Y=new Array(Se);let re=0;for(let be=Se-1;be>=0;be--){const ke=Y[be]=new Array(te);for(let it=0;it<te;it++){const vt=new Float32Array(4);vt[0]=_e[re++]/255,vt[1]=_e[re++]/255,vt[2]=_e[re++]/255,vt[3]=_e[re++]/255,ke[it]=vt}}return Y}getPixels(T){const[H,te]=this.output;return T?P.flipPixels(this._imageData.data,H,te):this._imageData.data.slice(0)}_imageTo3DArray(T){const H=new Array(T.length);for(let te=0;te<T.length;te++)H[te]=this._mediaTo2DArray(T[te]);return H}_resultKernelHeader(){if(this.graphical||this.immutable||!this.pipeline)return"";switch(this.output.length){case 1:return this._mutableKernel1DResults();case 2:return this._mutableKernel2DResults();case 3:return this._mutableKernel3DResults()}}_resultKernelBody(T){switch(this.output.length){case 1:return(!this.immutable&&this.pipeline?this._resultMutableKernel1DLoop(T):this._resultImmutableKernel1DLoop(T))+this._kernelOutput();case 2:return(!this.immutable&&this.pipeline?this._resultMutableKernel2DLoop(T):this._resultImmutableKernel2DLoop(T))+this._kernelOutput();case 3:return(!this.immutable&&this.pipeline?this._resultMutableKernel3DLoop(T):this._resultImmutableKernel3DLoop(T))+this._kernelOutput();default:throw new Error("unsupported size kernel")}}_graphicalKernelBody(T){switch(this.output.length){case 2:return this._graphicalKernel2DLoop(T)+this._graphicalOutput();default:throw new Error("unsupported size kernel")}}_graphicalOutput(){return`
    this._imageData.data.set(this._colorData);
    this.context.putImageData(this._imageData, 0, 0);
    return;`}_getKernelResultTypeConstructorString(){switch(this.returnType){case"LiteralInteger":case"Number":case"Integer":case"Float":return"Float32Array";case"Array(2)":case"Array(3)":case"Array(4)":return"Array";default:if(this.graphical)return"Float32Array";throw new Error(`unhandled returnType ${this.returnType}`)}}_resultImmutableKernel1DLoop(T){const H=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const result = new ${H}(outputX);
    ${this._mapSubKernels(te=>`const result_${te.name} = new ${H}(outputX);
`).join("    ")}
    ${this._mapSubKernels(te=>`let subKernelResult_${te.name};
`).join("    ")}
    for (let x = 0; x < outputX; x++) {
      this.thread.x = x;
      this.thread.y = 0;
      this.thread.z = 0;
      ${T}
    }`}_mutableKernel1DResults(){const T=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const result = new ${T}(outputX);
    ${this._mapSubKernels(H=>`const result_${H.name} = new ${T}(outputX);
`).join("    ")}
    ${this._mapSubKernels(H=>`let subKernelResult_${H.name};
`).join("    ")}`}_resultMutableKernel1DLoop(T){return`  const outputX = _this.output[0];
    for (let x = 0; x < outputX; x++) {
      this.thread.x = x;
      this.thread.y = 0;
      this.thread.z = 0;
      ${T}
    }`}_resultImmutableKernel2DLoop(T){const H=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    const result = new Array(outputY);
    ${this._mapSubKernels(te=>`const result_${te.name} = new Array(outputY);
`).join("    ")}
    ${this._mapSubKernels(te=>`let subKernelResult_${te.name};
`).join("    ")}
    for (let y = 0; y < outputY; y++) {
      this.thread.z = 0;
      this.thread.y = y;
      const resultX = result[y] = new ${H}(outputX);
      ${this._mapSubKernels(te=>`const resultX_${te.name} = result_${te.name}[y] = new ${H}(outputX);
`).join("")}
      for (let x = 0; x < outputX; x++) {
        this.thread.x = x;
        ${T}
      }
    }`}_mutableKernel2DResults(){const T=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    const result = new Array(outputY);
    ${this._mapSubKernels(H=>`const result_${H.name} = new Array(outputY);
`).join("    ")}
    ${this._mapSubKernels(H=>`let subKernelResult_${H.name};
`).join("    ")}
    for (let y = 0; y < outputY; y++) {
      const resultX = result[y] = new ${T}(outputX);
      ${this._mapSubKernels(H=>`const resultX_${H.name} = result_${H.name}[y] = new ${T}(outputX);
`).join("")}
    }`}_resultMutableKernel2DLoop(T){const H=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    for (let y = 0; y < outputY; y++) {
      this.thread.z = 0;
      this.thread.y = y;
      const resultX = result[y];
      ${this._mapSubKernels(te=>`const resultX_${te.name} = result_${te.name}[y] = new ${H}(outputX);
`).join("")}
      for (let x = 0; x < outputX; x++) {
        this.thread.x = x;
        ${T}
      }
    }`}_graphicalKernel2DLoop(T){return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    for (let y = 0; y < outputY; y++) {
      this.thread.z = 0;
      this.thread.y = y;
      for (let x = 0; x < outputX; x++) {
        this.thread.x = x;
        ${T}
      }
    }`}_resultImmutableKernel3DLoop(T){const H=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    const outputZ = _this.output[2];
    const result = new Array(outputZ);
    ${this._mapSubKernels(te=>`const result_${te.name} = new Array(outputZ);
`).join("    ")}
    ${this._mapSubKernels(te=>`let subKernelResult_${te.name};
`).join("    ")}
    for (let z = 0; z < outputZ; z++) {
      this.thread.z = z;
      const resultY = result[z] = new Array(outputY);
      ${this._mapSubKernels(te=>`const resultY_${te.name} = result_${te.name}[z] = new Array(outputY);
`).join("      ")}
      for (let y = 0; y < outputY; y++) {
        this.thread.y = y;
        const resultX = resultY[y] = new ${H}(outputX);
        ${this._mapSubKernels(te=>`const resultX_${te.name} = resultY_${te.name}[y] = new ${H}(outputX);
`).join("        ")}
        for (let x = 0; x < outputX; x++) {
          this.thread.x = x;
          ${T}
        }
      }
    }`}_mutableKernel3DResults(){const T=this._getKernelResultTypeConstructorString();return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    const outputZ = _this.output[2];
    const result = new Array(outputZ);
    ${this._mapSubKernels(H=>`const result_${H.name} = new Array(outputZ);
`).join("    ")}
    ${this._mapSubKernels(H=>`let subKernelResult_${H.name};
`).join("    ")}
    for (let z = 0; z < outputZ; z++) {
      const resultY = result[z] = new Array(outputY);
      ${this._mapSubKernels(H=>`const resultY_${H.name} = result_${H.name}[z] = new Array(outputY);
`).join("      ")}
      for (let y = 0; y < outputY; y++) {
        const resultX = resultY[y] = new ${T}(outputX);
        ${this._mapSubKernels(H=>`const resultX_${H.name} = resultY_${H.name}[y] = new ${T}(outputX);
`).join("        ")}
      }
    }`}_resultMutableKernel3DLoop(T){return`  const outputX = _this.output[0];
    const outputY = _this.output[1];
    const outputZ = _this.output[2];
    for (let z = 0; z < outputZ; z++) {
      this.thread.z = z;
      const resultY = result[z];
      for (let y = 0; y < outputY; y++) {
        this.thread.y = y;
        const resultX = resultY[y];
        for (let x = 0; x < outputX; x++) {
          this.thread.x = x;
          ${T}
        }
      }
    }`}_kernelOutput(){return this.subKernels?`
    return {
      result: result,
      ${this.subKernels.map(T=>`${T.property}: result_${T.name}`).join(`,
      `)}
    };`:`
    return result;`}_mapSubKernels(T){return this.subKernels===null?[""]:this.subKernels.map(T)}destroy(T){T&&delete this.canvas}static destroyContext(T){}toJSON(){const T=super.toJSON();return T.functionNodes=F.fromKernel(this,z).toJSON(),T}setOutput(T){super.setOutput(T);const[H,te]=this.output;this.graphical&&(this._imageData=this.context.createImageData(H,te),this._colorData=new Uint8ClampedArray(H*te*4))}prependString(T){if(this._kernelString)throw new Error("Kernel already built");this._prependedString.push(T)}hasPrependString(T){return this._prependedString.indexOf(T)>-1}}y.exports={CPUKernel:R}},{"../../utils":114,"../function-builder":9,"../kernel":36,"./function-node":6,"./kernel-string":7}],9:[function(p,y,N){class L{static fromKernel(z,P,k){const{kernelArguments:R,kernelConstants:S,argumentNames:T,argumentSizes:H,argumentBitRatios:te,constants:Se,constantBitRatios:ie,debug:_e,loopMaxIterations:Y,nativeFunctions:re,output:be,optimizeFloatMemory:ke,precision:it,plugins:vt,source:Q,subKernels:U,functions:Oe,leadingReturnStatement:Fe,followingReturnStatement:bt,dynamicArguments:v,dynamicOutput:I}=z,M=new Array(R.length),G={};for(let ht=0;ht<R.length;ht++)M[ht]=R[ht].type;for(let ht=0;ht<S.length;ht++){const Ut=S[ht];G[Ut.name]=Ut.type}const oe=(ht,Ut)=>Lt.needsArgumentType(ht,Ut),de=(ht,Ut,Bt)=>{Lt.assignArgumentType(ht,Ut,Bt)},ue=(ht,Ut,Bt)=>Lt.lookupReturnType(ht,Ut,Bt),ve=ht=>Lt.lookupFunctionArgumentTypes(ht),xe=(ht,Ut)=>Lt.lookupFunctionArgumentName(ht,Ut),Re=(ht,Ut)=>Lt.lookupFunctionArgumentBitRatio(ht,Ut),Ue=(ht,Ut,Bt,An)=>{Lt.assignArgumentType(ht,Ut,Bt,An)},Xe=(ht,Ut,Bt,An)=>{Lt.assignArgumentBitRatio(ht,Ut,Bt,An)},Ae=(ht,Ut,Bt)=>{Lt.trackFunctionCall(ht,Ut,Bt)},He=(ht,Ut)=>{const Bt=[];for(let Zt=0;Zt<ht.params.length;Zt++)Bt.push(ht.params[Zt].name);const An=new P(Ut,Object.assign({},et,{returnType:null,ast:ht,name:ht.id.name,argumentNames:Bt,lookupReturnType:ue,lookupFunctionArgumentTypes:ve,lookupFunctionArgumentName:xe,lookupFunctionArgumentBitRatio:Re,needsArgumentType:oe,assignArgumentType:de,triggerImplyArgumentType:Ue,triggerImplyArgumentBitRatio:Xe,onFunctionCall:Ae}));An.traceFunctionAST(ht),Lt.addFunctionNode(An)},et=Object.assign({isRootKernel:!1,onNestedFunction:He,lookupReturnType:ue,lookupFunctionArgumentTypes:ve,lookupFunctionArgumentName:xe,lookupFunctionArgumentBitRatio:Re,needsArgumentType:oe,assignArgumentType:de,triggerImplyArgumentType:Ue,triggerImplyArgumentBitRatio:Xe,onFunctionCall:Ae,optimizeFloatMemory:ke,precision:it,constants:Se,constantTypes:G,constantBitRatios:ie,debug:_e,loopMaxIterations:Y,output:be,plugins:vt,dynamicArguments:v,dynamicOutput:I},k||{}),at=Object.assign({},et,{isRootKernel:!0,name:"kernel",argumentNames:T,argumentTypes:M,argumentSizes:H,argumentBitRatios:te,leadingReturnStatement:Fe,followingReturnStatement:bt});if(typeof Q=="object"&&Q.functionNodes)return new L().fromJSON(Q.functionNodes,P);const Ze=new P(Q,at);let gt=null;Oe&&(gt=Oe.map(ht=>new P(ht.source,{returnType:ht.returnType,argumentTypes:ht.argumentTypes,output:be,plugins:vt,constants:Se,constantTypes:G,constantBitRatios:ie,optimizeFloatMemory:ke,precision:it,lookupReturnType:ue,lookupFunctionArgumentTypes:ve,lookupFunctionArgumentName:xe,lookupFunctionArgumentBitRatio:Re,needsArgumentType:oe,assignArgumentType:de,triggerImplyArgumentType:Ue,triggerImplyArgumentBitRatio:Xe,onFunctionCall:Ae,onNestedFunction:He})));let wt=null;U&&(wt=U.map(ht=>{const{name:Ut,source:Bt}=ht;return new P(Bt,Object.assign({},et,{name:Ut,isSubKernel:!0,isRootKernel:!1}))}));const Lt=new L({kernel:z,rootNode:Ze,functionNodes:gt,nativeFunctions:re,subKernelNodes:wt});return Lt}constructor(z){if(z=z||{},this.kernel=z.kernel,this.rootNode=z.rootNode,this.functionNodes=z.functionNodes||[],this.subKernelNodes=z.subKernelNodes||[],this.nativeFunctions=z.nativeFunctions||[],this.functionMap={},this.nativeFunctionNames=[],this.lookupChain=[],this.functionNodeDependencies={},this.functionCalls={},this.rootNode&&(this.functionMap.kernel=this.rootNode),this.functionNodes)for(let P=0;P<this.functionNodes.length;P++)this.functionMap[this.functionNodes[P].name]=this.functionNodes[P];if(this.subKernelNodes)for(let P=0;P<this.subKernelNodes.length;P++)this.functionMap[this.subKernelNodes[P].name]=this.subKernelNodes[P];if(this.nativeFunctions)for(let P=0;P<this.nativeFunctions.length;P++){const k=this.nativeFunctions[P];this.nativeFunctionNames.push(k.name)}}addFunctionNode(z){if(!z.name)throw new Error("functionNode.name needs set");this.functionMap[z.name]=z,z.isRootKernel&&(this.rootNode=z)}traceFunctionCalls(z,P){if(z=z||"kernel",P=P||[],this.nativeFunctionNames.indexOf(z)>-1){const R=P.indexOf(z);if(R===-1)P.push(z);else{const S=P.splice(R,1)[0];P.push(S)}return P}const k=this.functionMap[z];if(k){const R=P.indexOf(z);if(R===-1){P.push(z),k.toString();for(let S=0;S<k.calledFunctions.length;++S)this.traceFunctionCalls(k.calledFunctions[S],P)}else{const S=P.splice(R,1)[0];P.push(S)}}return P}getPrototypeString(z){return this.getPrototypes(z).join(`
`)}getPrototypes(z){return this.rootNode&&this.rootNode.toString(),z?this.getPrototypesFromFunctionNames(this.traceFunctionCalls(z,[]).reverse()):this.getPrototypesFromFunctionNames(Object.keys(this.functionMap))}getStringFromFunctionNames(z){const P=[];for(let k=0;k<z.length;++k)this.functionMap[z[k]]&&P.push(this.functionMap[z[k]].toString());return P.join(`
`)}getPrototypesFromFunctionNames(z){const P=[];for(let k=0;k<z.length;++k){const R=z[k],S=this.nativeFunctionNames.indexOf(R);if(S>-1){P.push(this.nativeFunctions[S].source);continue}const T=this.functionMap[R];T&&P.push(T.toString())}return P}toJSON(){return this.traceFunctionCalls(this.rootNode.name).reverse().map(z=>{const P=this.nativeFunctions.indexOf(z);if(P>-1)return{name:z,source:this.nativeFunctions[P].source};if(this.functionMap[z])return this.functionMap[z].toJSON();throw new Error(`function ${z} not found`)})}fromJSON(z,P){this.functionMap={};for(let k=0;k<z.length;k++){const R=z[k];this.functionMap[R.settings.name]=new P(R.ast,R.settings)}return this}getString(z){return z?this.getStringFromFunctionNames(this.traceFunctionCalls(z).reverse()):this.getStringFromFunctionNames(Object.keys(this.functionMap))}lookupReturnType(z,P,k){if(P.type!=="CallExpression")throw new Error(`expected ast type of "CallExpression", but is ${P.type}`);if(this._isNativeFunction(z))return this._lookupNativeFunctionReturnType(z);if(this._isFunction(z)){const R=this._getFunction(z);if(R.returnType)return R.returnType;{for(let T=0;T<this.lookupChain.length;T++)if(this.lookupChain[T].ast===P){if(R.argumentTypes.length===0&&P.arguments.length>0){const H=P.arguments;for(let te=0;te<H.length;te++)this.lookupChain.push({name:k.name,ast:H[T],requestingNode:k}),R.argumentTypes[te]=k.getType(H[te]),this.lookupChain.pop();return R.returnType=R.getType(R.getJsAST())}throw new Error("circlical logic detected!")}this.lookupChain.push({name:k.name,ast:P,requestingNode:k});const S=R.getType(R.getJsAST());return this.lookupChain.pop(),R.returnType=S}}return null}_getFunction(z){return this._isFunction(z),this.functionMap[z]}_isFunction(z){return!!this.functionMap[z]}_getNativeFunction(z){for(let P=0;P<this.nativeFunctions.length;P++)if(this.nativeFunctions[P].name===z)return this.nativeFunctions[P];return null}_isNativeFunction(z){return!!this._getNativeFunction(z)}_lookupNativeFunctionReturnType(z){let P=this._getNativeFunction(z);if(P)return P.returnType;throw new Error(`Native function ${z} not found`)}lookupFunctionArgumentTypes(z){return this._isNativeFunction(z)?this._getNativeFunction(z).argumentTypes:this._isFunction(z)?this._getFunction(z).argumentTypes:null}lookupFunctionArgumentName(z,P){return this._getFunction(z).argumentNames[P]}lookupFunctionArgumentBitRatio(z,P){if(!this._isFunction(z))throw new Error("function not found");if(this.rootNode.name===z){const T=this.rootNode.argumentNames.indexOf(P);if(T!==-1)return this.rootNode.argumentBitRatios[T]}const k=this._getFunction(z),R=k.argumentNames.indexOf(P);if(R===-1)throw new Error("argument not found");const S=k.argumentBitRatios[R];if(typeof S!="number")throw new Error("argument bit ratio not found");return S}needsArgumentType(z,P){return this._isFunction(z)?!this._getFunction(z).argumentTypes[P]:!1}assignArgumentType(z,P,k,R){if(!this._isFunction(z))return;const S=this._getFunction(z);S.argumentTypes[P]||(S.argumentTypes[P]=k)}assignArgumentBitRatio(z,P,k,R){const S=this._getFunction(z);if(this._isNativeFunction(k))return null;const T=this._getFunction(k),H=S.argumentNames.indexOf(P);if(H===-1)throw new Error(`Argument ${P} not found in arguments from function ${z}`);const te=S.argumentBitRatios[H];if(typeof te!="number")throw new Error(`Bit ratio for argument ${P} not found in function ${z}`);T.argumentBitRatios||(T.argumentBitRatios=new Array(T.argumentNames.length));const Se=T.argumentBitRatios[H];if(typeof Se=="number"){if(Se!==te)throw new Error(`Incompatible bit ratio found at function ${z} at argument ${P}`);return Se}return T.argumentBitRatios[H]=te,te}trackFunctionCall(z,P,k){this.functionNodeDependencies[z]||(this.functionNodeDependencies[z]=new Set,this.functionCalls[z]=[]),this.functionNodeDependencies[z].add(P),this.functionCalls[z].push(k)}getKernelResultType(){return this.rootNode.returnType||this.rootNode.getType(this.rootNode.ast)}getSubKernelResultType(z){const P=this.subKernelNodes[z];let k=!1;for(let R=0;R<this.rootNode.functionCalls.length;R++)this.rootNode.functionCalls[R].ast.callee.name===P.name&&(k=!0);if(!k)throw new Error(`SubKernel ${P.name} never called by kernel`);return P.returnType||P.getType(P.getJsAST())}getReturnTypes(){const z={[this.rootNode.name]:this.rootNode.getType(this.rootNode.ast)},P=this.traceFunctionCalls(this.rootNode.name);for(let k=0;k<P.length;k++){const R=P[k],S=this.functionMap[R];z[R]=S.getType(S.ast)}return z}}y.exports={FunctionBuilder:L}},{}],10:[function(p,y,N){const L=p("acorn"),{utils:F}=p("../utils"),{FunctionTracer:z}=p("./function-tracer");class P{constructor(S,T){if(!S&&!T.ast)throw new Error("source parameter is missing");if(T=T||{},this.source=S,this.ast=null,this.name=typeof S=="string"?T.isRootKernel?"kernel":T.name||F.getFunctionNameFromString(S):null,this.calledFunctions=[],this.constants={},this.constantTypes={},this.constantBitRatios={},this.isRootKernel=!1,this.isSubKernel=!1,this.debug=null,this.functions=null,this.identifiers=null,this.contexts=null,this.functionCalls=null,this.states=[],this.needsArgumentType=null,this.assignArgumentType=null,this.lookupReturnType=null,this.lookupFunctionArgumentTypes=null,this.lookupFunctionArgumentBitRatio=null,this.triggerImplyArgumentType=null,this.triggerImplyArgumentBitRatio=null,this.onNestedFunction=null,this.onFunctionCall=null,this.optimizeFloatMemory=null,this.precision=null,this.loopMaxIterations=null,this.argumentNames=typeof this.source=="string"?F.getArgumentNamesFromString(this.source):null,this.argumentTypes=[],this.argumentSizes=[],this.argumentBitRatios=null,this.returnType=null,this.output=[],this.plugins=null,this.leadingReturnStatement=null,this.followingReturnStatement=null,this.dynamicOutput=null,this.dynamicArguments=null,this.strictTypingChecking=!1,this.fixIntegerDivisionAccuracy=null,T)for(const H in T)T.hasOwnProperty(H)&&this.hasOwnProperty(H)&&(this[H]=T[H]);this.literalTypes={},this.validate(),this._string=null,this._internalVariableNames={}}validate(){if(typeof this.source!="string"&&!this.ast)throw new Error("this.source not a string");if(!this.ast&&!F.isFunctionString(this.source))throw new Error("this.source not a function string");if(!this.name)throw new Error("this.name could not be set");if(this.argumentTypes.length>0&&this.argumentTypes.length!==this.argumentNames.length)throw new Error(`argumentTypes count of ${this.argumentTypes.length} exceeds ${this.argumentNames.length}`);if(this.output.length<1)throw new Error("this.output is not big enough")}isIdentifierConstant(S){return this.constants?this.constants.hasOwnProperty(S):!1}isInput(S){return this.argumentTypes[this.argumentNames.indexOf(S)]==="Input"}pushState(S){this.states.push(S)}popState(S){if(this.state!==S)throw new Error(`Cannot popState ${S} when in ${this.state}`);this.states.pop()}isState(S){return this.state===S}get state(){return this.states[this.states.length-1]}astMemberExpressionUnroll(S){if(S.type==="Identifier")return S.name;if(S.type==="ThisExpression")return"this";if(S.type==="MemberExpression"&&S.object&&S.property)return S.object.hasOwnProperty("name")&&S.object.name!=="Math"?this.astMemberExpressionUnroll(S.property):this.astMemberExpressionUnroll(S.object)+"."+this.astMemberExpressionUnroll(S.property);if(S.hasOwnProperty("expressions")){const T=S.expressions[0];if(T.type==="Literal"&&T.value===0&&S.expressions.length===2)return this.astMemberExpressionUnroll(S.expressions[1])}throw this.astErrorOutput("Unknown astMemberExpressionUnroll",S)}getJsAST(S){if(this.ast)return this.ast;if(typeof this.source=="object")return this.traceFunctionAST(this.source),this.ast=this.source;if(S=S||L,S===null)throw new Error("Missing JS to AST parser");const T=Object.freeze(S.parse(`const parser_${this.name} = ${this.source};`,{locations:!0})),H=T.body[0].declarations[0].init;if(this.traceFunctionAST(H),!T)throw new Error("Failed to parse JS code");return this.ast=H}traceFunctionAST(S){const{contexts:T,declarations:H,functions:te,identifiers:Se,functionCalls:ie}=new z(S);this.contexts=T,this.identifiers=Se,this.functionCalls=ie,this.functions=te;for(let _e=0;_e<H.length;_e++){const Y=H[_e],{ast:re,inForLoopInit:be,inForLoopTest:ke}=Y,{init:it}=re,vt=this.getDependencies(it);let Q=null;if(be&&ke)Q="Integer";else if(it){const U=this.getType(it);switch(U){case"Integer":case"Float":case"Number":it.type==="MemberExpression"?Q=U:Q="Number";break;case"LiteralInteger":Q="Number";break;default:Q=U}}Y.valueType=Q,Y.dependencies=vt,Y.isSafe=this.isSafeDependencies(vt)}for(let _e=0;_e<te.length;_e++)this.onNestedFunction(te[_e],this.source)}getDeclaration(S){for(let T=0;T<this.identifiers.length;T++){const H=this.identifiers[T];if(S===H.ast)return H.declaration}return null}getVariableType(S){if(S.type!=="Identifier")throw new Error(`ast of ${S.type} not "Identifier"`);let T=null;const H=this.argumentNames.indexOf(S.name);if(H===-1){const te=this.getDeclaration(S);if(te)return te.valueType}else{const te=this.argumentTypes[H];te&&(T=te)}if(!T&&this.strictTypingChecking)throw new Error(`Declaration of ${name} not found`);return T}getLookupType(S){if(!k.hasOwnProperty(S))throw new Error(`unknown typeLookupMap ${S}`);return k[S]}getConstantType(S){if(this.constantTypes[S]){const T=this.constantTypes[S];return T==="Float"?"Number":T}throw new Error(`Type for constant "${S}" not declared`)}toString(){return this._string?this._string:this._string=this.astGeneric(this.getJsAST(),[]).join("").trim()}toJSON(){const S={source:this.source,name:this.name,constants:this.constants,constantTypes:this.constantTypes,isRootKernel:this.isRootKernel,isSubKernel:this.isSubKernel,debug:this.debug,output:this.output,loopMaxIterations:this.loopMaxIterations,argumentNames:this.argumentNames,argumentTypes:this.argumentTypes,argumentSizes:this.argumentSizes,returnType:this.returnType,leadingReturnStatement:this.leadingReturnStatement,followingReturnStatement:this.followingReturnStatement};return{ast:this.ast,settings:S}}getType(S){if(Array.isArray(S))return this.getType(S[S.length-1]);switch(S.type){case"BlockStatement":return this.getType(S.body);case"ArrayExpression":switch(this.getType(S.elements[0])){case"Array(2)":case"Array(3)":case"Array(4)":return`Matrix(${S.elements.length})`}return`Array(${S.elements.length})`;case"Literal":const H=this.astKey(S);return this.literalTypes[H]?this.literalTypes[H]:Number.isInteger(S.value)?"LiteralInteger":S.value===!0||S.value===!1?"Boolean":"Number";case"AssignmentExpression":return this.getType(S.left);case"CallExpression":if(this.isAstMathFunction(S))return"Number";if(!S.callee||!S.callee.name){if(S.callee.type==="SequenceExpression"&&S.callee.expressions[S.callee.expressions.length-1].property.name){const Y=S.callee.expressions[S.callee.expressions.length-1].property.name;return this.inferArgumentTypesIfNeeded(Y,S.arguments),this.lookupReturnType(Y,S,this)}if(this.getVariableSignature(S.callee,!0)==="this.color")return null;if(S.callee.type==="MemberExpression"&&S.callee.object&&S.callee.property&&S.callee.property.name&&S.arguments){const Y=S.callee.property.name;return this.inferArgumentTypesIfNeeded(Y,S.arguments),this.lookupReturnType(Y,S,this)}throw this.astErrorOutput("Unknown call expression",S)}if(S.callee&&S.callee.name){const Y=S.callee.name;return this.inferArgumentTypesIfNeeded(Y,S.arguments),this.lookupReturnType(Y,S,this)}throw this.astErrorOutput(`Unhandled getType Type "${S.type}"`,S);case"LogicalExpression":return"Boolean";case"BinaryExpression":switch(S.operator){case"%":case"/":if(this.fixIntegerDivisionAccuracy)return"Number";break;case">":case"<":return"Boolean";case"&":case"|":case"^":case"<<":case">>":case">>>":return"Integer"}const te=this.getType(S.left);if(this.isState("skip-literal-correction"))return te;if(te==="LiteralInteger"){const Y=this.getType(S.right);return Y==="LiteralInteger"?S.left.value%1===0?"Integer":"Float":Y}return k[te]||te;case"UpdateExpression":return this.getType(S.argument);case"UnaryExpression":return S.operator==="~"?"Integer":this.getType(S.argument);case"VariableDeclaration":{const Y=S.declarations;let re;for(let be=0;be<Y.length;be++){const ke=Y[be];re=this.getType(ke)}if(!re)throw this.astErrorOutput("Unable to find type for declaration",S);return re}case"VariableDeclarator":const Se=this.getDeclaration(S.id);if(!Se)throw this.astErrorOutput("Unable to find declarator",S);if(!Se.valueType)throw this.astErrorOutput("Unable to find declarator valueType",S);return Se.valueType;case"Identifier":if(S.name==="Infinity")return"Number";if(this.isAstVariable(S)&&this.getVariableSignature(S)==="value")return this.getCheckVariableType(S);const ie=this.findIdentifierOrigin(S);return ie&&ie.init?this.getType(ie.init):null;case"ReturnStatement":return this.getType(S.argument);case"MemberExpression":if(this.isAstMathFunction(S)){switch(S.property.name){case"ceil":return"Integer";case"floor":return"Integer";case"round":return"Integer"}return"Number"}if(this.isAstVariable(S)){switch(this.getVariableSignature(S)){case"value[]":return this.getLookupType(this.getCheckVariableType(S.object));case"value[][]":return this.getLookupType(this.getCheckVariableType(S.object.object));case"value[][][]":return this.getLookupType(this.getCheckVariableType(S.object.object.object));case"value[][][][]":return this.getLookupType(this.getCheckVariableType(S.object.object.object.object));case"value.thread.value":case"this.thread.value":return"Integer";case"this.output.value":return this.dynamicOutput?"Integer":"LiteralInteger";case"this.constants.value":return this.getConstantType(S.property.name);case"this.constants.value[]":return this.getLookupType(this.getConstantType(S.object.property.name));case"this.constants.value[][]":return this.getLookupType(this.getConstantType(S.object.object.property.name));case"this.constants.value[][][]":return this.getLookupType(this.getConstantType(S.object.object.object.property.name));case"this.constants.value[][][][]":return this.getLookupType(this.getConstantType(S.object.object.object.object.property.name));case"fn()[]":case"fn()[][]":case"fn()[][][]":return this.getLookupType(this.getType(S.object));case"value.value":if(this.isAstMathVariable(S))return"Number";switch(S.property.name){case"r":case"g":case"b":case"a":return this.getLookupType(this.getCheckVariableType(S.object))}case"[][]":return"Number"}throw this.astErrorOutput("Unhandled getType MemberExpression",S)}throw this.astErrorOutput("Unhandled getType MemberExpression",S);case"ConditionalExpression":return this.getType(S.consequent);case"FunctionDeclaration":case"FunctionExpression":const _e=this.findLastReturn(S.body);return _e?this.getType(_e):null;case"IfStatement":return this.getType(S.consequent);case"SequenceExpression":return this.getType(S.expressions[S.expressions.length-1]);default:throw this.astErrorOutput(`Unhandled getType Type "${S.type}"`,S)}}getCheckVariableType(S){const T=this.getVariableType(S);if(!T)throw this.astErrorOutput(`${S.type} is not defined`,S);return T}inferArgumentTypesIfNeeded(S,T){for(let H=0;H<T.length;H++){if(!this.needsArgumentType(S,H))continue;const te=this.getType(T[H]);if(!te)throw this.astErrorOutput(`Unable to infer argument ${H}`,T[H]);this.assignArgumentType(S,H,te)}}isAstMathVariable(S){const T=["E","PI","SQRT2","SQRT1_2","LN2","LN10","LOG2E","LOG10E"];return S.type==="MemberExpression"&&S.object&&S.object.type==="Identifier"&&S.object.name==="Math"&&S.property&&S.property.type==="Identifier"&&T.indexOf(S.property.name)>-1}isAstMathFunction(S){const T=["abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","expm1","exp","floor","fround","imul","log","log2","log10","log1p","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc"];return S.type==="CallExpression"&&S.callee&&S.callee.type==="MemberExpression"&&S.callee.object&&S.callee.object.type==="Identifier"&&S.callee.object.name==="Math"&&S.callee.property&&S.callee.property.type==="Identifier"&&T.indexOf(S.callee.property.name)>-1}isAstVariable(S){return S.type==="Identifier"||S.type==="MemberExpression"}isSafe(S){return this.isSafeDependencies(this.getDependencies(S))}isSafeDependencies(S){return S&&S.every?S.every(T=>T.isSafe):!0}getDependencies(S,T,H){if(T||(T=[]),!S)return null;if(Array.isArray(S)){for(let te=0;te<S.length;te++)this.getDependencies(S[te],T,H);return T}switch(S.type){case"AssignmentExpression":return this.getDependencies(S.left,T,H),this.getDependencies(S.right,T,H),T;case"ConditionalExpression":return this.getDependencies(S.test,T,H),this.getDependencies(S.alternate,T,H),this.getDependencies(S.consequent,T,H),T;case"Literal":T.push({origin:"literal",value:S.value,isSafe:H===!0?!1:S.value>-1/0&&S.value<1/0&&!isNaN(S.value)});break;case"VariableDeclarator":return this.getDependencies(S.init,T,H);case"Identifier":const te=this.getDeclaration(S);if(te)T.push({name:S.name,origin:"declaration",isSafe:H?!1:this.isSafeDependencies(te.dependencies)});else if(this.argumentNames.indexOf(S.name)>-1)T.push({name:S.name,origin:"argument",isSafe:!1});else if(this.strictTypingChecking)throw new Error(`Cannot find identifier origin "${S.name}"`);break;case"FunctionDeclaration":return this.getDependencies(S.body.body[S.body.body.length-1],T,H);case"ReturnStatement":return this.getDependencies(S.argument,T);case"BinaryExpression":case"LogicalExpression":return H=S.operator==="/"||S.operator==="*",this.getDependencies(S.left,T,H),this.getDependencies(S.right,T,H),T;case"UnaryExpression":case"UpdateExpression":return this.getDependencies(S.argument,T,H);case"VariableDeclaration":return this.getDependencies(S.declarations,T,H);case"ArrayExpression":return T.push({origin:"declaration",isSafe:!0}),T;case"CallExpression":return T.push({origin:"function",isSafe:!0}),T;case"MemberExpression":const Se=this.getMemberExpressionDetails(S);switch(Se.signature){case"value[]":this.getDependencies(S.object,T,H);break;case"value[][]":this.getDependencies(S.object.object,T,H);break;case"value[][][]":this.getDependencies(S.object.object.object,T,H);break;case"this.output.value":this.dynamicOutput&&T.push({name:Se.name,origin:"output",isSafe:!1});break}if(Se)return Se.property&&this.getDependencies(Se.property,T,H),Se.xProperty&&this.getDependencies(Se.xProperty,T,H),Se.yProperty&&this.getDependencies(Se.yProperty,T,H),Se.zProperty&&this.getDependencies(Se.zProperty,T,H),T;case"SequenceExpression":return this.getDependencies(S.expressions,T,H);default:throw this.astErrorOutput(`Unhandled type ${S.type} in getDependencies`,S)}return T}getVariableSignature(S,T){if(!this.isAstVariable(S))throw new Error(`ast of type "${S.type}" is not a variable signature`);if(S.type==="Identifier")return"value";const H=[];for(;S;)S.computed?H.push("[]"):S.type==="ThisExpression"?H.unshift("this"):S.property&&S.property.name?S.property.name==="x"||S.property.name==="y"||S.property.name==="z"?H.unshift(T?"."+S.property.name:".value"):S.property.name==="constants"||S.property.name==="thread"||S.property.name==="output"?H.unshift("."+S.property.name):H.unshift(T?"."+S.property.name:".value"):S.name?H.unshift(T?S.name:"value"):S.callee&&S.callee.name?H.unshift(T?S.callee.name+"()":"fn()"):S.elements?H.unshift("[]"):H.unshift("unknown"),S=S.object;const te=H.join("");return T||["value","value[]","value[][]","value[][][]","value[][][][]","value.value","value.thread.value","this.thread.value","this.output.value","this.constants.value","this.constants.value[]","this.constants.value[][]","this.constants.value[][][]","this.constants.value[][][][]","fn()[]","fn()[][]","fn()[][][]","[][]"].indexOf(te)>-1?te:null}build(){return this.toString().length>0}astGeneric(S,T){if(S===null)throw this.astErrorOutput("NULL ast",S);if(Array.isArray(S)){for(let H=0;H<S.length;H++)this.astGeneric(S[H],T);return T}switch(S.type){case"FunctionDeclaration":return this.astFunctionDeclaration(S,T);case"FunctionExpression":return this.astFunctionExpression(S,T);case"ReturnStatement":return this.astReturnStatement(S,T);case"Literal":return this.astLiteral(S,T);case"BinaryExpression":return this.astBinaryExpression(S,T);case"Identifier":return this.astIdentifierExpression(S,T);case"AssignmentExpression":return this.astAssignmentExpression(S,T);case"ExpressionStatement":return this.astExpressionStatement(S,T);case"EmptyStatement":return this.astEmptyStatement(S,T);case"BlockStatement":return this.astBlockStatement(S,T);case"IfStatement":return this.astIfStatement(S,T);case"SwitchStatement":return this.astSwitchStatement(S,T);case"BreakStatement":return this.astBreakStatement(S,T);case"ContinueStatement":return this.astContinueStatement(S,T);case"ForStatement":return this.astForStatement(S,T);case"WhileStatement":return this.astWhileStatement(S,T);case"DoWhileStatement":return this.astDoWhileStatement(S,T);case"VariableDeclaration":return this.astVariableDeclaration(S,T);case"VariableDeclarator":return this.astVariableDeclarator(S,T);case"ThisExpression":return this.astThisExpression(S,T);case"SequenceExpression":return this.astSequenceExpression(S,T);case"UnaryExpression":return this.astUnaryExpression(S,T);case"UpdateExpression":return this.astUpdateExpression(S,T);case"LogicalExpression":return this.astLogicalExpression(S,T);case"MemberExpression":return this.astMemberExpression(S,T);case"CallExpression":return this.astCallExpression(S,T);case"ArrayExpression":return this.astArrayExpression(S,T);case"DebuggerStatement":return this.astDebuggerStatement(S,T);case"ConditionalExpression":return this.astConditionalExpression(S,T)}throw this.astErrorOutput("Unknown ast type : "+S.type,S)}astErrorOutput(S,T){if(typeof this.source!="string")return new Error(S);const H=F.getAstString(this.source,T),Se=this.source.substr(T.start).split(/\n/),ie=Se.length>0?Se[Se.length-1]:0;return new Error(`${S} on line ${Se.length}, position ${ie.length}:
 ${H}`)}astDebuggerStatement(S,T){return T}astConditionalExpression(S,T){if(S.type!=="ConditionalExpression")throw this.astErrorOutput("Not a conditional expression",S);return T.push("("),this.astGeneric(S.test,T),T.push("?"),this.astGeneric(S.consequent,T),T.push(":"),this.astGeneric(S.alternate,T),T.push(")"),T}astFunction(S,T){throw new Error(`"astFunction" not defined on ${this.constructor.name}`)}astFunctionDeclaration(S,T){return this.isChildFunction(S)?T:this.astFunction(S,T)}astFunctionExpression(S,T){return this.isChildFunction(S)?T:this.astFunction(S,T)}isChildFunction(S){for(let T=0;T<this.functions.length;T++)if(this.functions[T]===S)return!0;return!1}astReturnStatement(S,T){return T}astLiteral(S,T){return this.literalTypes[this.astKey(S)]="Number",T}astBinaryExpression(S,T){return T}astIdentifierExpression(S,T){return T}astAssignmentExpression(S,T){return T}astExpressionStatement(S,T){return this.astGeneric(S.expression,T),T.push(";"),T}astEmptyStatement(S,T){return T}astBlockStatement(S,T){return T}astIfStatement(S,T){return T}astSwitchStatement(S,T){return T}astBreakStatement(S,T){return T.push("break;"),T}astContinueStatement(S,T){return T.push(`continue;
`),T}astForStatement(S,T){return T}astWhileStatement(S,T){return T}astDoWhileStatement(S,T){return T}astVariableDeclarator(S,T){return this.astGeneric(S.id,T),S.init!==null&&(T.push("="),this.astGeneric(S.init,T)),T}astThisExpression(S,T){return T}astSequenceExpression(S,T){const{expressions:H}=S,te=[];for(let Se=0;Se<H.length;Se++){const ie=H[Se],_e=[];this.astGeneric(ie,_e),te.push(_e.join(""))}return te.length>1?T.push("(",te.join(","),")"):T.push(te[0]),T}astUnaryExpression(S,T){return this.checkAndUpconvertBitwiseUnary(S,T)||(S.prefix?(T.push(S.operator),this.astGeneric(S.argument,T)):(this.astGeneric(S.argument,T),T.push(S.operator))),T}checkAndUpconvertBitwiseUnary(S,T){}astUpdateExpression(S,T){return S.prefix?(T.push(S.operator),this.astGeneric(S.argument,T)):(this.astGeneric(S.argument,T),T.push(S.operator)),T}astLogicalExpression(S,T){return T.push("("),this.astGeneric(S.left,T),T.push(S.operator),this.astGeneric(S.right,T),T.push(")"),T}astMemberExpression(S,T){return T}astCallExpression(S,T){return T}astArrayExpression(S,T){return T}getMemberExpressionDetails(S){if(S.type!=="MemberExpression")throw this.astErrorOutput(`Expression ${S.type} not a MemberExpression`,S);let T=null,H=null;const te=this.getVariableSignature(S);switch(te){case"value":return null;case"value.thread.value":case"this.thread.value":case"this.output.value":return{signature:te,type:"Integer",name:S.property.name};case"value[]":if(typeof S.object.name!="string")throw this.astErrorOutput("Unexpected expression",S);return T=S.object.name,{name:T,origin:"user",signature:te,type:this.getVariableType(S.object),xProperty:S.property};case"value[][]":if(typeof S.object.object.name!="string")throw this.astErrorOutput("Unexpected expression",S);return T=S.object.object.name,{name:T,origin:"user",signature:te,type:this.getVariableType(S.object.object),yProperty:S.object.property,xProperty:S.property};case"value[][][]":if(typeof S.object.object.object.name!="string")throw this.astErrorOutput("Unexpected expression",S);return T=S.object.object.object.name,{name:T,origin:"user",signature:te,type:this.getVariableType(S.object.object.object),zProperty:S.object.object.property,yProperty:S.object.property,xProperty:S.property};case"value[][][][]":if(typeof S.object.object.object.object.name!="string")throw this.astErrorOutput("Unexpected expression",S);return T=S.object.object.object.object.name,{name:T,origin:"user",signature:te,type:this.getVariableType(S.object.object.object.object),zProperty:S.object.object.property,yProperty:S.object.property,xProperty:S.property};case"value.value":if(typeof S.property.name!="string")throw this.astErrorOutput("Unexpected expression",S);if(this.isAstMathVariable(S))return T=S.property.name,{name:T,origin:"Math",type:"Number",signature:te};switch(S.property.name){case"r":case"g":case"b":case"a":return T=S.object.name,{name:T,property:S.property.name,origin:"user",signature:te,type:"Number"};default:throw this.astErrorOutput("Unexpected expression",S)}case"this.constants.value":if(typeof S.property.name!="string")throw this.astErrorOutput("Unexpected expression",S);if(T=S.property.name,H=this.getConstantType(T),!H)throw this.astErrorOutput("Constant has no type",S);return{name:T,type:H,origin:"constants",signature:te};case"this.constants.value[]":if(typeof S.object.property.name!="string")throw this.astErrorOutput("Unexpected expression",S);if(T=S.object.property.name,H=this.getConstantType(T),!H)throw this.astErrorOutput("Constant has no type",S);return{name:T,type:H,origin:"constants",signature:te,xProperty:S.property};case"this.constants.value[][]":{if(typeof S.object.object.property.name!="string")throw this.astErrorOutput("Unexpected expression",S);if(T=S.object.object.property.name,H=this.getConstantType(T),!H)throw this.astErrorOutput("Constant has no type",S);return{name:T,type:H,origin:"constants",signature:te,yProperty:S.object.property,xProperty:S.property}}case"this.constants.value[][][]":{if(typeof S.object.object.object.property.name!="string")throw this.astErrorOutput("Unexpected expression",S);if(T=S.object.object.object.property.name,H=this.getConstantType(T),!H)throw this.astErrorOutput("Constant has no type",S);return{name:T,type:H,origin:"constants",signature:te,zProperty:S.object.object.property,yProperty:S.object.property,xProperty:S.property}}case"fn()[]":case"fn()[][]":case"[][]":return{signature:te,property:S.property};default:throw this.astErrorOutput("Unexpected expression",S)}}findIdentifierOrigin(S){const T=[this.ast];for(;T.length>0;){const H=T[0];if(H.type==="VariableDeclarator"&&H.id&&H.id.name&&H.id.name===S.name)return H;if(T.shift(),H.argument)T.push(H.argument);else if(H.body)T.push(H.body);else if(H.declarations)T.push(H.declarations);else if(Array.isArray(H))for(let te=0;te<H.length;te++)T.push(H[te])}return null}findLastReturn(S){const T=[S||this.ast];for(;T.length>0;){const H=T.pop();if(H.type==="ReturnStatement")return H;if(H.type!=="FunctionDeclaration")if(H.argument)T.push(H.argument);else if(H.body)T.push(H.body);else if(H.declarations)T.push(H.declarations);else if(Array.isArray(H))for(let te=0;te<H.length;te++)T.push(H[te]);else H.consequent?T.push(H.consequent):H.cases&&T.push(H.cases)}return null}getInternalVariableName(S){return this._internalVariableNames.hasOwnProperty(S)||(this._internalVariableNames[S]=0),this._internalVariableNames[S]++,this._internalVariableNames[S]===1?S:S+this._internalVariableNames[S]}astKey(S,T=","){if(!S.start||!S.end)throw new Error("AST start and end needed");return`${S.start}${T}${S.end}`}}const k={Number:"Number",Float:"Float",Integer:"Integer",Array:"Number","Array(2)":"Number","Array(3)":"Number","Array(4)":"Number","Matrix(2)":"Number","Matrix(3)":"Number","Matrix(4)":"Number",Array2D:"Number",Array3D:"Number",Input:"Number",HTMLCanvas:"Array(4)",OffscreenCanvas:"Array(4)",HTMLImage:"Array(4)",ImageBitmap:"Array(4)",ImageData:"Array(4)",HTMLVideo:"Array(4)",HTMLImageArray:"Array(4)",NumberTexture:"Number",MemoryOptimizedNumberTexture:"Number","Array1D(2)":"Array(2)","Array1D(3)":"Array(3)","Array1D(4)":"Array(4)","Array2D(2)":"Array(2)","Array2D(3)":"Array(3)","Array2D(4)":"Array(4)","Array3D(2)":"Array(2)","Array3D(3)":"Array(3)","Array3D(4)":"Array(4)","ArrayTexture(1)":"Number","ArrayTexture(2)":"Array(2)","ArrayTexture(3)":"Array(3)","ArrayTexture(4)":"Array(4)"};y.exports={FunctionNode:P}},{"../utils":114,"./function-tracer":11,acorn:1}],11:[function(p,y,N){const{utils:L}=p("../utils");function F(k){return k.length>0?k[k.length-1]:null}const z={trackIdentifiers:"trackIdentifiers",memberExpression:"memberExpression",inForLoopInit:"inForLoopInit"};class P{constructor(R){this.runningContexts=[],this.functionContexts=[],this.contexts=[],this.functionCalls=[],this.declarations=[],this.identifiers=[],this.functions=[],this.returnStatements=[],this.trackedIdentifiers=null,this.states=[],this.newFunctionContext(),this.scan(R)}isState(R){return this.states[this.states.length-1]===R}hasState(R){return this.states.indexOf(R)>-1}pushState(R){this.states.push(R)}popState(R){if(this.isState(R))this.states.pop();else throw new Error(`Cannot pop the non-active state "${R}"`)}get currentFunctionContext(){return F(this.functionContexts)}get currentContext(){return F(this.runningContexts)}newFunctionContext(){const R={"@contextType":"function"};this.contexts.push(R),this.functionContexts.push(R)}newContext(R){const S=Object.assign({"@contextType":"const/let"},this.currentContext);this.contexts.push(S),this.runningContexts.push(S),R();const{currentFunctionContext:T}=this;for(const H in T)!T.hasOwnProperty(H)||S.hasOwnProperty(H)||(S[H]=T[H]);return this.runningContexts.pop(),S}useFunctionContext(R){const S=F(this.functionContexts);this.runningContexts.push(S),R(),this.runningContexts.pop()}getIdentifiers(R){const S=this.trackedIdentifiers=[];return this.pushState(z.trackIdentifiers),R(),this.trackedIdentifiers=null,this.popState(z.trackIdentifiers),S}getDeclaration(R){const{currentContext:S,currentFunctionContext:T,runningContexts:H}=this,te=S[R]||T[R]||null;if(!te&&S===T&&H.length>0){const Se=H[H.length-2];if(Se[R])return Se[R]}return te}scan(R){if(R){if(Array.isArray(R)){for(let S=0;S<R.length;S++)this.scan(R[S]);return}switch(R.type){case"Program":this.useFunctionContext(()=>{this.scan(R.body)});break;case"BlockStatement":this.newContext(()=>{this.scan(R.body)});break;case"AssignmentExpression":case"LogicalExpression":this.scan(R.left),this.scan(R.right);break;case"BinaryExpression":this.scan(R.left),this.scan(R.right);break;case"UpdateExpression":if(R.operator==="++"){const S=this.getDeclaration(R.argument.name);S&&(S.suggestedType="Integer")}this.scan(R.argument);break;case"UnaryExpression":this.scan(R.argument);break;case"VariableDeclaration":R.kind==="var"?this.useFunctionContext(()=>{R.declarations=L.normalizeDeclarations(R),this.scan(R.declarations)}):(R.declarations=L.normalizeDeclarations(R),this.scan(R.declarations));break;case"VariableDeclarator":{const{currentContext:S}=this,T=this.hasState(z.inForLoopInit),H={ast:R,context:S,name:R.id.name,origin:"declaration",inForLoopInit:T,inForLoopTest:null,assignable:S===this.currentFunctionContext||!T&&!S.hasOwnProperty(R.id.name),suggestedType:null,valueType:null,dependencies:null,isSafe:null};S[R.id.name]||(S[R.id.name]=H),this.declarations.push(H),this.scan(R.id),this.scan(R.init);break}case"FunctionExpression":case"FunctionDeclaration":this.runningContexts.length===0?this.scan(R.body):this.functions.push(R);break;case"IfStatement":this.scan(R.test),this.scan(R.consequent),R.alternate&&this.scan(R.alternate);break;case"ForStatement":{let S;const T=this.newContext(()=>{this.pushState(z.inForLoopInit),this.scan(R.init),this.popState(z.inForLoopInit),S=this.getIdentifiers(()=>{this.scan(R.test)}),this.scan(R.update),this.newContext(()=>{this.scan(R.body)})});if(S)for(const H in T)H!=="@contextType"&&S.indexOf(H)>-1&&(T[H].inForLoopTest=!0);break}case"DoWhileStatement":case"WhileStatement":this.newContext(()=>{this.scan(R.body),this.scan(R.test)});break;case"Identifier":{this.isState(z.trackIdentifiers)&&this.trackedIdentifiers.push(R.name),this.identifiers.push({context:this.currentContext,declaration:this.getDeclaration(R.name),ast:R});break}case"ReturnStatement":this.returnStatements.push(R),this.scan(R.argument);break;case"MemberExpression":this.pushState(z.memberExpression),this.scan(R.object),this.scan(R.property),this.popState(z.memberExpression);break;case"ExpressionStatement":this.scan(R.expression);break;case"SequenceExpression":this.scan(R.expressions);break;case"CallExpression":this.functionCalls.push({context:this.currentContext,ast:R}),this.scan(R.arguments);break;case"ArrayExpression":this.scan(R.elements);break;case"ConditionalExpression":this.scan(R.test),this.scan(R.alternate),this.scan(R.consequent);break;case"SwitchStatement":this.scan(R.discriminant),this.scan(R.cases);break;case"SwitchCase":this.scan(R.test),this.scan(R.consequent);break;case"ThisExpression":case"Literal":case"DebuggerStatement":case"EmptyStatement":case"BreakStatement":case"ContinueStatement":break;default:throw new Error(`unhandled type "${R.type}"`)}}}}y.exports={FunctionTracer:P}},{"../utils":114}],12:[function(p,y,N){const{glWiretap:L}=p("gl-wiretap"),{utils:F}=p("../../utils");function z(H){return H.toString().replace("=>","").replace(/^function /,"").replace(/utils[.]/g,"/*utils.*/")}function P(H,te,Se,ie,_e){Se.built||Se.build.apply(Se,te),te=te?Array.from(te).map(at=>{switch(typeof at){case"boolean":return new Boolean(at);case"number":return new Number(at);default:return at}}):null;const Y=[],re=L(Se.context,{useTrackablePrimitives:!0,onReadPixels:at=>{if(Ae.subKernels){if(!be)Y.push(`    const result = { result: ${k(at,Ae)} };`),be=!0;else{const Ze=Ae.subKernels[ke++].property;Y.push(`    result${isNaN(Ze)?"."+Ze:`[${Ze}]`} = ${k(at,Ae)};`)}ke===Ae.subKernels.length&&Y.push("    return result;");return}at?Y.push(`    return ${k(at,Ae)};`):Y.push("    return null;")},onUnrecognizedArgumentLookup:at=>{const Ze=T(at,Ae.kernelArguments,[],re);if(Ze)return Ze;const gt=T(at,Ae.kernelConstants,bt?Object.keys(bt).map(wt=>bt[wt]):[],re);return gt||null}});let be=!1,ke=0;const{source:it,canvas:vt,output:Q,pipeline:U,graphical:Oe,loopMaxIterations:Fe,constants:bt,optimizeFloatMemory:v,precision:I,fixIntegerDivisionAccuracy:M,functions:G,nativeFunctions:oe,subKernels:de,immutable:ue,argumentTypes:ve,constantTypes:xe,kernelArguments:Re,kernelConstants:Ue,tactic:Xe}=Se,Ae=new H(it,{canvas:vt,context:re,checkContext:!1,output:Q,pipeline:U,graphical:Oe,loopMaxIterations:Fe,constants:bt,optimizeFloatMemory:v,precision:I,fixIntegerDivisionAccuracy:M,functions:G,nativeFunctions:oe,subKernels:de,immutable:ue,argumentTypes:ve,constantTypes:xe,tactic:Xe});let He=[];if(re.setIndent(2),Ae.build.apply(Ae,te),He.push(re.toString()),re.reset(),Ae.kernelArguments.forEach((at,Ze)=>{switch(at.type){case"Integer":case"Boolean":case"Number":case"Float":case"Array":case"Array(2)":case"Array(3)":case"Array(4)":case"HTMLCanvas":case"HTMLImage":case"HTMLVideo":re.insertVariable(`uploadValue_${at.name}`,at.uploadValue);break;case"HTMLImageArray":for(let gt=0;gt<te[Ze].length;gt++){const wt=te[Ze];re.insertVariable(`uploadValue_${at.name}[${gt}]`,wt[gt])}break;case"Input":re.insertVariable(`uploadValue_${at.name}`,at.uploadValue);break;case"MemoryOptimizedNumberTexture":case"NumberTexture":case"Array1D(2)":case"Array1D(3)":case"Array1D(4)":case"Array2D(2)":case"Array2D(3)":case"Array2D(4)":case"Array3D(2)":case"Array3D(3)":case"Array3D(4)":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":re.insertVariable(`uploadValue_${at.name}`,te[Ze].texture);break;default:throw new Error(`unhandled kernelArgumentType insertion for glWiretap of type ${at.type}`)}}),He.push("/** start of injected functions **/"),He.push(`function ${z(F.flattenTo)}`),He.push(`function ${z(F.flatten2dArrayTo)}`),He.push(`function ${z(F.flatten3dArrayTo)}`),He.push(`function ${z(F.flatten4dArrayTo)}`),He.push(`function ${z(F.isArray)}`),Ae.renderOutput!==Ae.renderTexture&&Ae.formatValues&&He.push(`  const renderOutput = function ${z(Ae.formatValues)};`),He.push("/** end of injected functions **/"),He.push(`  const innerKernel = function (${Ae.kernelArguments.map(at=>at.varName).join(", ")}) {`),re.setIndent(4),Ae.run.apply(Ae,te),Ae.renderKernels?Ae.renderKernels():Ae.renderOutput&&Ae.renderOutput(),He.push("    /** start setup uploads for kernel values **/"),Ae.kernelArguments.forEach(at=>{He.push("    "+at.getStringValueHandler().split(`
`).join(`
    `))}),He.push("    /** end setup uploads for kernel values **/"),He.push(re.toString()),Ae.renderOutput===Ae.renderTexture){re.reset();const at=re.getContextVariableName(Ae.framebuffer);if(Ae.renderKernels){const Ze=Ae.renderKernels(),gt=re.getContextVariableName(Ae.texture.texture);He.push(`    return {
      result: {
        texture: ${gt},
        type: '${Ze.result.type}',
        toArray: ${S(Ze.result,gt,at)}
      },`);const{subKernels:wt,mappedTextures:Lt}=Ae;for(let ht=0;ht<wt.length;ht++){const Ut=Lt[ht],Bt=wt[ht],An=Ze[Bt.property],Zt=re.getContextVariableName(Ut.texture);He.push(`
      ${Bt.property}: {
        texture: ${Zt},
        type: '${An.type}',
        toArray: ${S(An,Zt,at)}
      },`)}He.push("    };")}else{const Ze=Ae.renderOutput(),gt=re.getContextVariableName(Ae.texture.texture);He.push(`    return {
        texture: ${gt},
        type: '${Ze.type}',
        toArray: ${S(Ze,gt,at)}
      };`)}}He.push(`    ${_e?`
`+_e+"    ":""}`),He.push(Y.join(`
`)),He.push("  };"),Ae.graphical&&(He.push(R(Ae)),He.push("  innerKernel.getPixels = getPixels;")),He.push("  return innerKernel;");let et=[];return Ue.forEach(at=>{et.push(`${at.getStringValueHandler()}`)}),`function kernel(settings) {
  const { context, constants } = settings;
  ${et.join("")}
  ${ie||""}
${He.join(`
`)}
}`}function k(H,te){const Se=te.precision==="single"?H:`new Float32Array(${H}.buffer)`;return te.output[2]?`renderOutput(${Se}, ${te.output[0]}, ${te.output[1]}, ${te.output[2]})`:te.output[1]?`renderOutput(${Se}, ${te.output[0]}, ${te.output[1]})`:`renderOutput(${Se}, ${te.output[0]})`}function R(H){const te=H.getPixels.toString(),Se=!/^function/.test(te);return F.flattenFunctionToString(`${Se?"function ":""}${te}`,{findDependency:(ie,_e)=>ie==="utils"?`const ${_e} = ${F[_e].toString()};`:null,thisLookup:ie=>{if(ie==="context")return null;if(H.hasOwnProperty(ie))return JSON.stringify(H[ie]);throw new Error(`unhandled thisLookup ${ie}`)}})}function S(H,te,Se){const ie=H.toArray.toString(),_e=!/^function/.test(ie),Y=F.flattenFunctionToString(`${_e?"function ":""}${ie}`,{findDependency:(re,be)=>{if(re==="utils")return`const ${be} = ${F[be].toString()};`;if(re==="this")return be==="framebuffer"?"":`${_e?"function ":""}${H[be].toString()}`;throw new Error("unhandled fromObject")},thisLookup:(re,be)=>{if(re==="texture")return te;if(re==="context")return be?null:"gl";if(H.hasOwnProperty(re))return JSON.stringify(H[re]);throw new Error(`unhandled thisLookup ${re}`)}});return`() => {
  function framebuffer() { return ${Se}; };
  ${Y}
  return toArray();
  }`}function T(H,te,Se,ie,_e){if(H===null||te===null)return null;switch(typeof H){case"boolean":case"number":return null}if(typeof HTMLImageElement<"u"&&H instanceof HTMLImageElement)for(let Y=0;Y<te.length;Y++){const re=te[Y];if(re.type!=="HTMLImageArray"&&re||re.uploadValue!==H)continue;const be=Se[Y].indexOf(H);if(be===-1)continue;const ke=`uploadValue_${re.name}[${be}]`;return ie.insertVariable(ke,H),ke}for(let Y=0;Y<te.length;Y++){const re=te[Y];if(H!==re.uploadValue)continue;const be=`uploadValue_${re.name}`;return ie.insertVariable(be,re),be}return null}y.exports={glKernelString:P}},{"../../utils":114,"gl-wiretap":3}],13:[function(p,y,N){const{Kernel:L}=p("../kernel"),{utils:F}=p("../../utils"),{GLTextureArray2Float:z}=p("./texture/array-2-float"),{GLTextureArray2Float2D:P}=p("./texture/array-2-float-2d"),{GLTextureArray2Float3D:k}=p("./texture/array-2-float-3d"),{GLTextureArray3Float:R}=p("./texture/array-3-float"),{GLTextureArray3Float2D:S}=p("./texture/array-3-float-2d"),{GLTextureArray3Float3D:T}=p("./texture/array-3-float-3d"),{GLTextureArray4Float:H}=p("./texture/array-4-float"),{GLTextureArray4Float2D:te}=p("./texture/array-4-float-2d"),{GLTextureArray4Float3D:Se}=p("./texture/array-4-float-3d"),{GLTextureFloat:ie}=p("./texture/float"),{GLTextureFloat2D:_e}=p("./texture/float-2d"),{GLTextureFloat3D:Y}=p("./texture/float-3d"),{GLTextureMemoryOptimized:re}=p("./texture/memory-optimized"),{GLTextureMemoryOptimized2D:be}=p("./texture/memory-optimized-2d"),{GLTextureMemoryOptimized3D:ke}=p("./texture/memory-optimized-3d"),{GLTextureUnsigned:it}=p("./texture/unsigned"),{GLTextureUnsigned2D:vt}=p("./texture/unsigned-2d"),{GLTextureUnsigned3D:Q}=p("./texture/unsigned-3d"),{GLTextureGraphical:U}=p("./texture/graphical");class Oe extends L{static get mode(){return"gpu"}static getIsFloatRead(){const v=`function kernelFunction() {
      return 1;
    }`,I=new this(v,{context:this.testContext,canvas:this.testCanvas,validate:!1,output:[1],precision:"single",returnType:"Number",tactic:"speed"});I.build(),I.run();const M=I.renderOutput();return I.destroy(!0),M[0]===1}static getIsIntegerDivisionAccurate(){function v(oe,de){return oe[this.thread.x]/de[this.thread.x]}const I=new this(v.toString(),{context:this.testContext,canvas:this.testCanvas,validate:!1,output:[2],returnType:"Number",precision:"unsigned",tactic:"speed"}),M=[[6,6030401],[3,3991]];I.build.apply(I,M),I.run.apply(I,M);const G=I.renderOutput();return I.destroy(!0),G[0]===2&&G[1]===1511}static getIsSpeedTacticSupported(){function v(oe){return oe[this.thread.x]}const I=new this(v.toString(),{context:this.testContext,canvas:this.testCanvas,validate:!1,output:[4],returnType:"Number",precision:"unsigned",tactic:"speed"}),M=[[0,1,2,3]];I.build.apply(I,M),I.run.apply(I,M);const G=I.renderOutput();return I.destroy(!0),Math.round(G[0])===0&&Math.round(G[1])===1&&Math.round(G[2])===2&&Math.round(G[3])===3}static get testCanvas(){throw new Error(`"testCanvas" not defined on ${this.name}`)}static get testContext(){throw new Error(`"testContext" not defined on ${this.name}`)}static getFeatures(){const v=this.testContext,I=this.getIsDrawBuffers();return Object.freeze({isFloatRead:this.getIsFloatRead(),isIntegerDivisionAccurate:this.getIsIntegerDivisionAccurate(),isSpeedTacticSupported:this.getIsSpeedTacticSupported(),isTextureFloat:this.getIsTextureFloat(),isDrawBuffers:I,kernelMap:I,channelCount:this.getChannelCount(),maxTextureSize:this.getMaxTextureSize(),lowIntPrecision:v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.LOW_INT),lowFloatPrecision:v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.LOW_FLOAT),mediumIntPrecision:v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.MEDIUM_INT),mediumFloatPrecision:v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.MEDIUM_FLOAT),highIntPrecision:v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.HIGH_INT),highFloatPrecision:v.getShaderPrecisionFormat(v.FRAGMENT_SHADER,v.HIGH_FLOAT)})}static setupFeatureChecks(){throw new Error(`"setupFeatureChecks" not defined on ${this.name}`)}static getSignature(v,I){return v.getVariablePrecisionString()+(I.length>0?":"+I.join(","):"")}setFixIntegerDivisionAccuracy(v){return this.fixIntegerDivisionAccuracy=v,this}setPrecision(v){return this.precision=v,this}setFloatTextures(v){return F.warnDeprecated("method","setFloatTextures","setOptimizeFloatMemory"),this.floatTextures=v,this}static nativeFunctionArguments(v){const I=[],M=[],G=[],oe=/^[a-zA-Z_]/,de=/[a-zA-Z_0-9]/;let ue=0,ve=null,xe=null;for(;ue<v.length;){const Re=v[ue],Ue=v[ue+1],Xe=G.length>0?G[G.length-1]:null;if(Xe==="FUNCTION_ARGUMENTS"&&Re==="/"&&Ue==="*"){G.push("MULTI_LINE_COMMENT"),ue+=2;continue}else if(Xe==="MULTI_LINE_COMMENT"&&Re==="*"&&Ue==="/"){G.pop(),ue+=2;continue}else if(Xe==="FUNCTION_ARGUMENTS"&&Re==="/"&&Ue==="/"){G.push("COMMENT"),ue+=2;continue}else if(Xe==="COMMENT"&&Re===`
`){G.pop(),ue++;continue}else if(Xe===null&&Re==="("){G.push("FUNCTION_ARGUMENTS"),ue++;continue}else if(Xe==="FUNCTION_ARGUMENTS"){if(Re===")"){G.pop();break}if(Re==="f"&&Ue==="l"&&v[ue+2]==="o"&&v[ue+3]==="a"&&v[ue+4]==="t"&&v[ue+5]===" "){G.push("DECLARE_VARIABLE"),xe="float",ve="",ue+=6;continue}else if(Re==="i"&&Ue==="n"&&v[ue+2]==="t"&&v[ue+3]===" "){G.push("DECLARE_VARIABLE"),xe="int",ve="",ue+=4;continue}else if(Re==="v"&&Ue==="e"&&v[ue+2]==="c"&&v[ue+3]==="2"&&v[ue+4]===" "){G.push("DECLARE_VARIABLE"),xe="vec2",ve="",ue+=5;continue}else if(Re==="v"&&Ue==="e"&&v[ue+2]==="c"&&v[ue+3]==="3"&&v[ue+4]===" "){G.push("DECLARE_VARIABLE"),xe="vec3",ve="",ue+=5;continue}else if(Re==="v"&&Ue==="e"&&v[ue+2]==="c"&&v[ue+3]==="4"&&v[ue+4]===" "){G.push("DECLARE_VARIABLE"),xe="vec4",ve="",ue+=5;continue}}else if(Xe==="DECLARE_VARIABLE"){if(ve===""){if(Re===" "){ue++;continue}if(!oe.test(Re))throw new Error("variable name is not expected string")}ve+=Re,de.test(Ue)||(G.pop(),M.push(ve),I.push(Fe[xe]))}ue++}if(G.length>0)throw new Error("GLSL function was not parsable");return{argumentNames:M,argumentTypes:I}}static nativeFunctionReturnType(v){return Fe[v.match(/int|float|vec[2-4]/)[0]]}static combineKernels(v,I){v.apply(null,arguments);const{texSize:M,context:G,threadDim:oe}=I.texSize;let de;if(I.precision==="single"){const ue=M[0],ve=Math.ceil(M[1]/4);de=new Float32Array(ue*ve*4*4),G.readPixels(0,0,ue,ve*4,G.RGBA,G.FLOAT,de)}else{const ue=new Uint8Array(M[0]*M[1]*4);G.readPixels(0,0,M[0],M[1],G.RGBA,G.UNSIGNED_BYTE,ue),de=new Float32Array(ue.buffer)}if(de=de.subarray(0,oe[0]*oe[1]*oe[2]),I.output.length===1)return de;if(I.output.length===2)return F.splitArray(de,I.output[0]);if(I.output.length===3)return F.splitArray(de,I.output[0]*I.output[1]).map(function(ve){return F.splitArray(ve,I.output[0])})}constructor(v,I){super(v,I),this.transferValues=null,this.formatValues=null,this.TextureConstructor=null,this.renderOutput=null,this.renderRawOutput=null,this.texSize=null,this.translatedSource=null,this.compiledFragmentShader=null,this.compiledVertexShader=null,this.switchingKernels=null,this._textureSwitched=null,this._mappedTextureSwitched=null}checkTextureSize(){const{features:v}=this.constructor;if(this.texSize[0]>v.maxTextureSize||this.texSize[1]>v.maxTextureSize)throw new Error(`Texture size [${this.texSize[0]},${this.texSize[1]}] generated by kernel is larger than supported size [${v.maxTextureSize},${v.maxTextureSize}]`)}translateSource(){throw new Error(`"translateSource" not defined on ${this.constructor.name}`)}pickRenderStrategy(v){if(this.graphical)return this.renderRawOutput=this.readPackedPixelsToUint8Array,this.transferValues=I=>I,this.TextureConstructor=U,null;if(this.precision==="unsigned")if(this.renderRawOutput=this.readPackedPixelsToUint8Array,this.transferValues=this.readPackedPixelsToFloat32Array,this.pipeline)switch(this.renderOutput=this.renderTexture,this.subKernels!==null&&(this.renderKernels=this.renderKernelsToTextures),this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.output[2]>0?(this.TextureConstructor=Q,null):this.output[1]>0?(this.TextureConstructor=vt,null):(this.TextureConstructor=it,null);case"Array(2)":case"Array(3)":case"Array(4)":return this.requestFallback(v)}else switch(this.subKernels!==null&&(this.renderKernels=this.renderKernelsToArrays),this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.renderOutput=this.renderValues,this.output[2]>0?(this.TextureConstructor=Q,this.formatValues=F.erect3DPackedFloat,null):this.output[1]>0?(this.TextureConstructor=vt,this.formatValues=F.erect2DPackedFloat,null):(this.TextureConstructor=it,this.formatValues=F.erectPackedFloat,null);case"Array(2)":case"Array(3)":case"Array(4)":return this.requestFallback(v)}else if(this.precision==="single"){if(this.renderRawOutput=this.readFloatPixelsToFloat32Array,this.transferValues=this.readFloatPixelsToFloat32Array,this.pipeline)switch(this.renderOutput=this.renderTexture,this.subKernels!==null&&(this.renderKernels=this.renderKernelsToTextures),this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.optimizeFloatMemory?this.output[2]>0?(this.TextureConstructor=ke,null):this.output[1]>0?(this.TextureConstructor=be,null):(this.TextureConstructor=re,null):this.output[2]>0?(this.TextureConstructor=Y,null):this.output[1]>0?(this.TextureConstructor=_e,null):(this.TextureConstructor=ie,null);case"Array(2)":return this.output[2]>0?(this.TextureConstructor=k,null):this.output[1]>0?(this.TextureConstructor=P,null):(this.TextureConstructor=z,null);case"Array(3)":return this.output[2]>0?(this.TextureConstructor=T,null):this.output[1]>0?(this.TextureConstructor=S,null):(this.TextureConstructor=R,null);case"Array(4)":return this.output[2]>0?(this.TextureConstructor=Se,null):this.output[1]>0?(this.TextureConstructor=te,null):(this.TextureConstructor=H,null)}if(this.renderOutput=this.renderValues,this.subKernels!==null&&(this.renderKernels=this.renderKernelsToArrays),this.optimizeFloatMemory)switch(this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.output[2]>0?(this.TextureConstructor=ke,this.formatValues=F.erectMemoryOptimized3DFloat,null):this.output[1]>0?(this.TextureConstructor=be,this.formatValues=F.erectMemoryOptimized2DFloat,null):(this.TextureConstructor=re,this.formatValues=F.erectMemoryOptimizedFloat,null);case"Array(2)":return this.output[2]>0?(this.TextureConstructor=k,this.formatValues=F.erect3DArray2,null):this.output[1]>0?(this.TextureConstructor=P,this.formatValues=F.erect2DArray2,null):(this.TextureConstructor=z,this.formatValues=F.erectArray2,null);case"Array(3)":return this.output[2]>0?(this.TextureConstructor=T,this.formatValues=F.erect3DArray3,null):this.output[1]>0?(this.TextureConstructor=S,this.formatValues=F.erect2DArray3,null):(this.TextureConstructor=R,this.formatValues=F.erectArray3,null);case"Array(4)":return this.output[2]>0?(this.TextureConstructor=Se,this.formatValues=F.erect3DArray4,null):this.output[1]>0?(this.TextureConstructor=te,this.formatValues=F.erect2DArray4,null):(this.TextureConstructor=H,this.formatValues=F.erectArray4,null)}else switch(this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.output[2]>0?(this.TextureConstructor=Y,this.formatValues=F.erect3DFloat,null):this.output[1]>0?(this.TextureConstructor=_e,this.formatValues=F.erect2DFloat,null):(this.TextureConstructor=ie,this.formatValues=F.erectFloat,null);case"Array(2)":return this.output[2]>0?(this.TextureConstructor=k,this.formatValues=F.erect3DArray2,null):this.output[1]>0?(this.TextureConstructor=P,this.formatValues=F.erect2DArray2,null):(this.TextureConstructor=z,this.formatValues=F.erectArray2,null);case"Array(3)":return this.output[2]>0?(this.TextureConstructor=T,this.formatValues=F.erect3DArray3,null):this.output[1]>0?(this.TextureConstructor=S,this.formatValues=F.erect2DArray3,null):(this.TextureConstructor=R,this.formatValues=F.erectArray3,null);case"Array(4)":return this.output[2]>0?(this.TextureConstructor=Se,this.formatValues=F.erect3DArray4,null):this.output[1]>0?(this.TextureConstructor=te,this.formatValues=F.erect2DArray4,null):(this.TextureConstructor=H,this.formatValues=F.erectArray4,null)}}else throw new Error(`unhandled precision of "${this.precision}"`);throw new Error(`unhandled return type "${this.returnType}"`)}getKernelString(){throw new Error("abstract method call")}getMainResultTexture(){switch(this.returnType){case"LiteralInteger":case"Float":case"Integer":case"Number":return this.getMainResultNumberTexture();case"Array(2)":return this.getMainResultArray2Texture();case"Array(3)":return this.getMainResultArray3Texture();case"Array(4)":return this.getMainResultArray4Texture();default:throw new Error(`unhandled returnType type ${this.returnType}`)}}getMainResultKernelNumberTexture(){throw new Error("abstract method call")}getMainResultSubKernelNumberTexture(){throw new Error("abstract method call")}getMainResultKernelArray2Texture(){throw new Error("abstract method call")}getMainResultSubKernelArray2Texture(){throw new Error("abstract method call")}getMainResultKernelArray3Texture(){throw new Error("abstract method call")}getMainResultSubKernelArray3Texture(){throw new Error("abstract method call")}getMainResultKernelArray4Texture(){throw new Error("abstract method call")}getMainResultSubKernelArray4Texture(){throw new Error("abstract method call")}getMainResultGraphical(){throw new Error("abstract method call")}getMainResultMemoryOptimizedFloats(){throw new Error("abstract method call")}getMainResultPackedPixels(){throw new Error("abstract method call")}getMainResultString(){return this.graphical?this.getMainResultGraphical():this.precision==="single"?this.optimizeFloatMemory?this.getMainResultMemoryOptimizedFloats():this.getMainResultTexture():this.getMainResultPackedPixels()}getMainResultNumberTexture(){return F.linesToString(this.getMainResultKernelNumberTexture())+F.linesToString(this.getMainResultSubKernelNumberTexture())}getMainResultArray2Texture(){return F.linesToString(this.getMainResultKernelArray2Texture())+F.linesToString(this.getMainResultSubKernelArray2Texture())}getMainResultArray3Texture(){return F.linesToString(this.getMainResultKernelArray3Texture())+F.linesToString(this.getMainResultSubKernelArray3Texture())}getMainResultArray4Texture(){return F.linesToString(this.getMainResultKernelArray4Texture())+F.linesToString(this.getMainResultSubKernelArray4Texture())}getFloatTacticDeclaration(){return`precision ${this.getVariablePrecisionString(this.texSize,this.tactic)} float;
`}getIntTacticDeclaration(){return`precision ${this.getVariablePrecisionString(this.texSize,this.tactic,!0)} int;
`}getSampler2DTacticDeclaration(){return`precision ${this.getVariablePrecisionString(this.texSize,this.tactic)} sampler2D;
`}getSampler2DArrayTacticDeclaration(){return`precision ${this.getVariablePrecisionString(this.texSize,this.tactic)} sampler2DArray;
`}renderTexture(){return this.immutable?this.texture.clone():this.texture}readPackedPixelsToUint8Array(){if(this.precision!=="unsigned")throw new Error('Requires this.precision to be "unsigned"');const{texSize:v,context:I}=this,M=new Uint8Array(v[0]*v[1]*4);return I.readPixels(0,0,v[0],v[1],I.RGBA,I.UNSIGNED_BYTE,M),M}readPackedPixelsToFloat32Array(){return new Float32Array(this.readPackedPixelsToUint8Array().buffer)}readFloatPixelsToFloat32Array(){if(this.precision!=="single")throw new Error('Requires this.precision to be "single"');const{texSize:v,context:I}=this,M=v[0],G=v[1],oe=new Float32Array(M*G*4);return I.readPixels(0,0,M,G,I.RGBA,I.FLOAT,oe),oe}getPixels(v){const{context:I,output:M}=this,[G,oe]=M,de=new Uint8Array(G*oe*4);return I.readPixels(0,0,G,oe,I.RGBA,I.UNSIGNED_BYTE,de),new Uint8ClampedArray((v?de:F.flipPixels(de,G,oe)).buffer)}renderKernelsToArrays(){const v={result:this.renderOutput()};for(let I=0;I<this.subKernels.length;I++)v[this.subKernels[I].property]=this.mappedTextures[I].toArray();return v}renderKernelsToTextures(){const v={result:this.renderOutput()};if(this.immutable)for(let I=0;I<this.subKernels.length;I++)v[this.subKernels[I].property]=this.mappedTextures[I].clone();else for(let I=0;I<this.subKernels.length;I++)v[this.subKernels[I].property]=this.mappedTextures[I];return v}resetSwitchingKernels(){const v=this.switchingKernels;return this.switchingKernels=null,v}setOutput(v){const I=this.toKernelOutput(v);if(this.program){if(!this.dynamicOutput)throw new Error("Resizing a kernel with dynamicOutput: false is not possible");const M=[I[0],I[1]||1,I[2]||1],G=F.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},M),oe=this.texSize;if(oe){const ue=this.getVariablePrecisionString(oe,this.tactic),ve=this.getVariablePrecisionString(G,this.tactic);if(ue!==ve){this.debug&&console.warn("Precision requirement changed, asking GPU instance to recompile"),this.switchKernels({type:"outputPrecisionMismatch",precision:ve,needed:v});return}}this.output=I,this.threadDim=M,this.texSize=G;const{context:de}=this;if(de.bindFramebuffer(de.FRAMEBUFFER,this.framebuffer),this.updateMaxTexSize(),this.framebuffer.width=this.texSize[0],this.framebuffer.height=this.texSize[1],de.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),this.canvas.width=this.maxTexSize[0],this.canvas.height=this.maxTexSize[1],this.texture&&this.texture.delete(),this.texture=null,this._setupOutputTexture(),this.mappedTextures&&this.mappedTextures.length>0){for(let ue=0;ue<this.mappedTextures.length;ue++)this.mappedTextures[ue].delete();this.mappedTextures=null,this._setupSubOutputTextures()}}else this.output=I;return this}renderValues(){return this.formatValues(this.transferValues(),this.output[0],this.output[1],this.output[2])}switchKernels(v){this.switchingKernels?this.switchingKernels.push(v):this.switchingKernels=[v]}getVariablePrecisionString(v=this.texSize,I=this.tactic,M=!1){if(!I){if(!this.constructor.features.isSpeedTacticSupported)return"highp";const G=this.constructor.features[M?"lowIntPrecision":"lowFloatPrecision"],oe=this.constructor.features[M?"mediumIntPrecision":"mediumFloatPrecision"],de=this.constructor.features[M?"highIntPrecision":"highFloatPrecision"],ue=Math.log2(v[0]*v[1]);if(ue<=G.rangeMax)return"lowp";if(ue<=oe.rangeMax)return"mediump";if(ue<=de.rangeMax)return"highp";throw new Error("The required size exceeds that of the ability of your system")}switch(I){case"speed":return"lowp";case"balanced":return"mediump";case"precision":return"highp";default:throw new Error(`Unknown tactic "${I}" use "speed", "balanced", "precision", or empty for auto`)}}updateTextureArgumentRefs(v,I){if(this.immutable){if(this.texture.texture===I.texture){const{prevArg:M}=v;M&&(M.texture._refs===1&&(this.texture.delete(),this.texture=M.clone(),this._textureSwitched=!0),M.delete()),v.prevArg=I.clone()}else if(this.mappedTextures&&this.mappedTextures.length>0){const{mappedTextures:M}=this;for(let G=0;G<M.length;G++){const oe=M[G];if(oe.texture===I.texture){const{prevArg:de}=v;de&&(de.texture._refs===1&&(oe.delete(),M[G]=de.clone(),this._mappedTextureSwitched[G]=!0),de.delete()),v.prevArg=I.clone();return}}}}}onActivate(v){if(this._textureSwitched=!0,this.texture=v.texture,this.mappedTextures){for(let I=0;I<this.mappedTextures.length;I++)this._mappedTextureSwitched[I]=!0;this.mappedTextures=v.mappedTextures}}initCanvas(){}}const Fe={int:"Integer",float:"Number",vec2:"Array(2)",vec3:"Array(3)",vec4:"Array(4)"};y.exports={GLKernel:Oe}},{"../../utils":114,"../kernel":36,"./texture/array-2-float":16,"./texture/array-2-float-2d":14,"./texture/array-2-float-3d":15,"./texture/array-3-float":19,"./texture/array-3-float-2d":17,"./texture/array-3-float-3d":18,"./texture/array-4-float":22,"./texture/array-4-float-2d":20,"./texture/array-4-float-3d":21,"./texture/float":25,"./texture/float-2d":23,"./texture/float-3d":24,"./texture/graphical":26,"./texture/memory-optimized":30,"./texture/memory-optimized-2d":28,"./texture/memory-optimized-3d":29,"./texture/unsigned":33,"./texture/unsigned-2d":31,"./texture/unsigned-3d":32}],14:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(2)"}toArray(){return L.erect2DArray2(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureArray2Float2D:z}},{"../../../utils":114,"./float":25}],15:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(2)"}toArray(){return L.erect3DArray2(this.renderValues(),this.output[0],this.output[1],this.output[2])}}y.exports={GLTextureArray2Float3D:z}},{"../../../utils":114,"./float":25}],16:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(2)"}toArray(){return L.erectArray2(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureArray2Float:z}},{"../../../utils":114,"./float":25}],17:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(3)"}toArray(){return L.erect2DArray3(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureArray3Float2D:z}},{"../../../utils":114,"./float":25}],18:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(3)"}toArray(){return L.erect3DArray3(this.renderValues(),this.output[0],this.output[1],this.output[2])}}y.exports={GLTextureArray3Float3D:z}},{"../../../utils":114,"./float":25}],19:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(3)"}toArray(){return L.erectArray3(this.renderValues(),this.output[0])}}y.exports={GLTextureArray3Float:z}},{"../../../utils":114,"./float":25}],20:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(4)"}toArray(){return L.erect2DArray4(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureArray4Float2D:z}},{"../../../utils":114,"./float":25}],21:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(4)"}toArray(){return L.erect3DArray4(this.renderValues(),this.output[0],this.output[1],this.output[2])}}y.exports={GLTextureArray4Float3D:z}},{"../../../utils":114,"./float":25}],22:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(4)"}toArray(){return L.erectArray4(this.renderValues(),this.output[0])}}y.exports={GLTextureArray4Float:z}},{"../../../utils":114,"./float":25}],23:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(1)"}toArray(){return L.erect2DFloat(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureFloat2D:z}},{"../../../utils":114,"./float":25}],24:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="ArrayTexture(1)"}toArray(){return L.erect3DFloat(this.renderValues(),this.output[0],this.output[1],this.output[2])}}y.exports={GLTextureFloat3D:z}},{"../../../utils":114,"./float":25}],25:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTexture:F}=p("./index");class z extends F{get textureType(){return this.context.FLOAT}constructor(k){super(k),this.type="ArrayTexture(1)"}renderRawOutput(){const k=this.context,R=this.size;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer()),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,this.texture,0);const S=new Float32Array(R[0]*R[1]*4);return k.readPixels(0,0,R[0],R[1],k.RGBA,k.FLOAT,S),S}renderValues(){return this._deleted?null:this.renderRawOutput()}toArray(){return L.erectFloat(this.renderValues(),this.output[0])}}y.exports={GLTextureFloat:z}},{"../../../utils":114,"./index":27}],26:[function(p,y,N){const{GLTextureUnsigned:L}=p("./unsigned");class F extends L{constructor(P){super(P),this.type="ArrayTexture(4)"}toArray(){return this.renderValues()}}y.exports={GLTextureGraphical:F}},{"./unsigned":33}],27:[function(p,y,N){const{Texture:L}=p("../../../texture");class F extends L{get textureType(){throw new Error(`"textureType" not implemented on ${this.name}`)}clone(){return new this.constructor(this)}beforeMutate(){return this.texture._refs>1?(this.newTexture(),!0):!1}cloneTexture(){this.texture._refs--;const{context:k,size:R,texture:S,kernel:T}=this;T.debug&&console.warn("cloning internal texture"),k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer()),z(k,S),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,S,0);const H=k.createTexture();z(k,H),k.texImage2D(k.TEXTURE_2D,0,this.internalFormat,R[0],R[1],0,this.textureFormat,this.textureType,null),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,R[0],R[1]),H._refs=1,this.texture=H}newTexture(){this.texture._refs--;const k=this.context,R=this.size;this.kernel.debug&&console.warn("new internal texture");const T=k.createTexture();z(k,T),k.texImage2D(k.TEXTURE_2D,0,this.internalFormat,R[0],R[1],0,this.textureFormat,this.textureType,null),T._refs=1,this.texture=T}clear(){if(this.texture._refs){this.texture._refs--;const S=this.context,T=this.texture=S.createTexture();z(S,T);const H=this.size;T._refs=1,S.texImage2D(S.TEXTURE_2D,0,this.internalFormat,H[0],H[1],0,this.textureFormat,this.textureType,null)}const{context:k,texture:R}=this;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer()),k.bindTexture(k.TEXTURE_2D,R),z(k,R),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,R,0),k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)}delete(){this._deleted||(this._deleted=!0,!(this.texture._refs&&(this.texture._refs--,this.texture._refs))&&this.context.deleteTexture(this.texture))}framebuffer(){return this._framebuffer||(this._framebuffer=this.kernel.getRawValueFramebuffer(this.size[0],this.size[1])),this._framebuffer}}function z(P,k){P.activeTexture(P.TEXTURE15),P.bindTexture(P.TEXTURE_2D,k),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.NEAREST),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.NEAREST)}y.exports={GLTexture:F}},{"../../../texture":113}],28:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="MemoryOptimizedNumberTexture"}toArray(){return L.erectMemoryOptimized2DFloat(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureMemoryOptimized2D:z}},{"../../../utils":114,"./float":25}],29:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="MemoryOptimizedNumberTexture"}toArray(){return L.erectMemoryOptimized3DFloat(this.renderValues(),this.output[0],this.output[1],this.output[2])}}y.exports={GLTextureMemoryOptimized3D:z}},{"../../../utils":114,"./float":25}],30:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureFloat:F}=p("./float");class z extends F{constructor(k){super(k),this.type="MemoryOptimizedNumberTexture"}toArray(){return L.erectMemoryOptimizedFloat(this.renderValues(),this.output[0])}}y.exports={GLTextureMemoryOptimized:z}},{"../../../utils":114,"./float":25}],31:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureUnsigned:F}=p("./unsigned");class z extends F{constructor(k){super(k),this.type="NumberTexture"}toArray(){return L.erect2DPackedFloat(this.renderValues(),this.output[0],this.output[1])}}y.exports={GLTextureUnsigned2D:z}},{"../../../utils":114,"./unsigned":33}],32:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTextureUnsigned:F}=p("./unsigned");class z extends F{constructor(k){super(k),this.type="NumberTexture"}toArray(){return L.erect3DPackedFloat(this.renderValues(),this.output[0],this.output[1],this.output[2])}}y.exports={GLTextureUnsigned3D:z}},{"../../../utils":114,"./unsigned":33}],33:[function(p,y,N){const{utils:L}=p("../../../utils"),{GLTexture:F}=p("./index");class z extends F{get textureType(){return this.context.UNSIGNED_BYTE}constructor(k){super(k),this.type="NumberTexture"}renderRawOutput(){const{context:k}=this;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer()),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,this.texture,0);const R=new Uint8Array(this.size[0]*this.size[1]*4);return k.readPixels(0,0,this.size[0],this.size[1],k.RGBA,k.UNSIGNED_BYTE,R),R}renderValues(){return this._deleted?null:new Float32Array(this.renderRawOutput().buffer)}toArray(){return L.erectPackedFloat(this.renderValues(),this.output[0])}}y.exports={GLTextureUnsigned:z}},{"../../../utils":114,"./index":27}],34:[function(p,y,N){const L=p("gl"),{WebGLKernel:F}=p("../web-gl/kernel"),{glKernelString:z}=p("../gl/kernel-string");let P=null,k=null,R=null,S=null,T=null;class H extends F{static get isSupported(){return P!==null||(this.setupFeatureChecks(),P=R!==null),P}static setupFeatureChecks(){if(k=null,S=null,typeof L=="function")try{if(R=L(2,2,{preserveDrawingBuffer:!0}),!R||!R.getExtension)return;S={STACKGL_resize_drawingbuffer:R.getExtension("STACKGL_resize_drawingbuffer"),STACKGL_destroy_context:R.getExtension("STACKGL_destroy_context"),OES_texture_float:R.getExtension("OES_texture_float"),OES_texture_float_linear:R.getExtension("OES_texture_float_linear"),OES_element_index_uint:R.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:R.getExtension("WEBGL_draw_buffers"),WEBGL_color_buffer_float:R.getExtension("WEBGL_color_buffer_float")},T=this.getFeatures()}catch(Se){console.warn(Se)}}static isContextMatch(Se){try{return Se.getParameter(Se.RENDERER)==="ANGLE"}catch{return!1}}static getIsTextureFloat(){return!!S.OES_texture_float}static getIsDrawBuffers(){return!!S.WEBGL_draw_buffers}static getChannelCount(){return S.WEBGL_draw_buffers?R.getParameter(S.WEBGL_draw_buffers.MAX_DRAW_BUFFERS_WEBGL):1}static getMaxTextureSize(){return R.getParameter(R.MAX_TEXTURE_SIZE)}static get testCanvas(){return k}static get testContext(){return R}static get features(){return T}initCanvas(){return{}}initContext(){return L(2,2,{preserveDrawingBuffer:!0})}initExtensions(){this.extensions={STACKGL_resize_drawingbuffer:this.context.getExtension("STACKGL_resize_drawingbuffer"),STACKGL_destroy_context:this.context.getExtension("STACKGL_destroy_context"),OES_texture_float:this.context.getExtension("OES_texture_float"),OES_texture_float_linear:this.context.getExtension("OES_texture_float_linear"),OES_element_index_uint:this.context.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:this.context.getExtension("WEBGL_draw_buffers")}}build(){super.build.apply(this,arguments),this.fallbackRequested||this.extensions.STACKGL_resize_drawingbuffer.resize(this.maxTexSize[0],this.maxTexSize[1])}destroyExtensions(){this.extensions.STACKGL_resize_drawingbuffer=null,this.extensions.STACKGL_destroy_context=null,this.extensions.OES_texture_float=null,this.extensions.OES_texture_float_linear=null,this.extensions.OES_element_index_uint=null,this.extensions.WEBGL_draw_buffers=null}static destroyContext(Se){const ie=Se.getExtension("STACKGL_destroy_context");ie&&ie.destroy&&ie.destroy()}toString(){return z(this.constructor,arguments,this,`const gl = context || require('gl')(1, 1);
`,`    if (!context) { gl.getExtension('STACKGL_destroy_context').destroy(); }
`)}setOutput(Se){return super.setOutput(Se),this.graphical&&this.extensions.STACKGL_resize_drawingbuffer&&this.extensions.STACKGL_resize_drawingbuffer.resize(this.maxTexSize[0],this.maxTexSize[1]),this}}y.exports={HeadlessGLKernel:H}},{"../gl/kernel-string":12,"../web-gl/kernel":70,gl:2}],35:[function(p,y,N){class L{constructor(z,P){const{name:k,kernel:R,context:S,checkContext:T,onRequestContextHandle:H,onUpdateValueMismatch:te,origin:Se,strictIntegers:ie,type:_e,tactic:Y}=P;if(!k)throw new Error("name not set");if(!_e)throw new Error("type not set");if(!Se)throw new Error("origin not set");if(Se!=="user"&&Se!=="constants")throw new Error(`origin must be "user" or "constants" value is "${Se}"`);if(!H)throw new Error("onRequestContextHandle is not set");this.name=k,this.origin=Se,this.tactic=Y,this.varName=Se==="constants"?`constants.${k}`:k,this.kernel=R,this.strictIntegers=ie,this.type=z.type||_e,this.size=z.size||null,this.index=null,this.context=S,this.checkContext=T??!0,this.contextHandle=null,this.onRequestContextHandle=H,this.onUpdateValueMismatch=te,this.forceUploadEachRun=null}get id(){return`${this.origin}_${name}`}getSource(){throw new Error(`"getSource" not defined on ${this.constructor.name}`)}updateValue(z){throw new Error(`"updateValue" not defined on ${this.constructor.name}`)}}y.exports={KernelValue:L}},{}],36:[function(p,y,N){const{utils:L}=p("../utils"),{Input:F}=p("../input");class z{static get isSupported(){throw new Error(`"isSupported" not implemented on ${this.name}`)}static isContextMatch(R){throw new Error(`"isContextMatch" not implemented on ${this.name}`)}static getFeatures(){throw new Error(`"getFeatures" not implemented on ${this.name}`)}static destroyContext(R){throw new Error(`"destroyContext" called on ${this.name}`)}static nativeFunctionArguments(){throw new Error(`"nativeFunctionArguments" called on ${this.name}`)}static nativeFunctionReturnType(){throw new Error(`"nativeFunctionReturnType" called on ${this.name}`)}static combineKernels(){throw new Error(`"combineKernels" called on ${this.name}`)}constructor(R,S){if(typeof R!="object"){if(typeof R!="string")throw new Error("source not a string");if(!L.isFunctionString(R))throw new Error("source not a function string")}this.useLegacyEncoder=!1,this.fallbackRequested=!1,this.onRequestFallback=null,this.argumentNames=typeof R=="string"?L.getArgumentNamesFromString(R):null,this.argumentTypes=null,this.argumentSizes=null,this.argumentBitRatios=null,this.kernelArguments=null,this.kernelConstants=null,this.forceUploadKernelConstants=null,this.source=R,this.output=null,this.debug=!1,this.graphical=!1,this.loopMaxIterations=0,this.constants=null,this.constantTypes=null,this.constantBitRatios=null,this.dynamicArguments=!1,this.dynamicOutput=!1,this.canvas=null,this.context=null,this.checkContext=null,this.gpu=null,this.functions=null,this.nativeFunctions=null,this.injectedNative=null,this.subKernels=null,this.validate=!0,this.immutable=!1,this.pipeline=!1,this.precision=null,this.tactic=null,this.plugins=null,this.returnType=null,this.leadingReturnStatement=null,this.followingReturnStatement=null,this.optimizeFloatMemory=null,this.strictIntegers=!1,this.fixIntegerDivisionAccuracy=null,this.built=!1,this.signature=null}mergeSettings(R){for(let S in R)if(!(!R.hasOwnProperty(S)||!this.hasOwnProperty(S))){switch(S){case"output":if(!Array.isArray(R.output)){this.setOutput(R.output);continue}break;case"functions":this.functions=[];for(let T=0;T<R.functions.length;T++)this.addFunction(R.functions[T]);continue;case"graphical":R[S]&&!R.hasOwnProperty("precision")&&(this.precision="unsigned"),this[S]=R[S];continue;case"nativeFunctions":if(!R.nativeFunctions)continue;this.nativeFunctions=[];for(let T=0;T<R.nativeFunctions.length;T++){const H=R.nativeFunctions[T],{name:te,source:Se}=H;this.addNativeFunction(te,Se,H)}continue}this[S]=R[S]}this.canvas||(this.canvas=this.initCanvas()),this.context||(this.context=this.initContext()),this.plugins||(this.plugins=this.initPlugins(R))}build(){throw new Error(`"build" not defined on ${this.constructor.name}`)}run(){throw new Error(`"run" not defined on ${this.constructor.name}`)}initCanvas(){throw new Error(`"initCanvas" not defined on ${this.constructor.name}`)}initContext(){throw new Error(`"initContext" not defined on ${this.constructor.name}`)}initPlugins(R){throw new Error(`"initPlugins" not defined on ${this.constructor.name}`)}addFunction(R,S={}){if(R.name&&R.source&&R.argumentTypes&&"returnType"in R)this.functions.push(R);else if("settings"in R&&"source"in R)this.functions.push(this.functionToIGPUFunction(R.source,R.settings));else if(typeof R=="string"||typeof R=="function")this.functions.push(this.functionToIGPUFunction(R,S));else throw new Error("function not properly defined");return this}addNativeFunction(R,S,T={}){const{argumentTypes:H,argumentNames:te}=T.argumentTypes?P(T.argumentTypes):this.constructor.nativeFunctionArguments(S)||{};return this.nativeFunctions.push({name:R,source:S,settings:T,argumentTypes:H,argumentNames:te,returnType:T.returnType||this.constructor.nativeFunctionReturnType(S)}),this}setupArguments(R){if(this.kernelArguments=[],this.argumentTypes)for(let S=0;S<this.argumentTypes.length;S++)this.kernelArguments.push({type:this.argumentTypes[S]});else if(!this.argumentTypes){this.argumentTypes=[];for(let S=0;S<R.length;S++){const T=L.getVariableType(R[S],this.strictIntegers),H=T==="Integer"?"Number":T;this.argumentTypes.push(H),this.kernelArguments.push({type:H})}}this.argumentSizes=new Array(R.length),this.argumentBitRatios=new Int32Array(R.length);for(let S=0;S<R.length;S++){const T=R[S];this.argumentSizes[S]=T.constructor===F?T.size:null,this.argumentBitRatios[S]=this.getBitRatio(T)}if(this.argumentNames.length!==R.length)throw new Error("arguments are miss-aligned")}setupConstants(){this.kernelConstants=[];let R=this.constantTypes===null;if(R&&(this.constantTypes={}),this.constantBitRatios={},this.constants)for(let S in this.constants){if(R){const T=L.getVariableType(this.constants[S],this.strictIntegers);this.constantTypes[S]=T,this.kernelConstants.push({name:S,type:T})}else this.kernelConstants.push({name:S,type:this.constantTypes[S]});this.constantBitRatios[S]=this.getBitRatio(this.constants[S])}}setOptimizeFloatMemory(R){return this.optimizeFloatMemory=R,this}toKernelOutput(R){return R.hasOwnProperty("x")?R.hasOwnProperty("y")?R.hasOwnProperty("z")?[R.x,R.y,R.z]:[R.x,R.y]:[R.x]:R}setOutput(R){return this.output=this.toKernelOutput(R),this}setDebug(R){return this.debug=R,this}setGraphical(R){return this.graphical=R,this.precision="unsigned",this}setLoopMaxIterations(R){return this.loopMaxIterations=R,this}setConstants(R){return this.constants=R,this}setConstantTypes(R){return this.constantTypes=R,this}setFunctions(R){for(let S=0;S<R.length;S++)this.addFunction(R[S]);return this}setNativeFunctions(R){for(let S=0;S<R.length;S++){const T=R[S],{name:H,source:te}=T;this.addNativeFunction(H,te,T)}return this}setInjectedNative(R){return this.injectedNative=R,this}setPipeline(R){return this.pipeline=R,this}setPrecision(R){return this.precision=R,this}setDimensions(R){return L.warnDeprecated("method","setDimensions","setOutput"),this.output=R,this}setOutputToTexture(R){return L.warnDeprecated("method","setOutputToTexture","setPipeline"),this.pipeline=R,this}setImmutable(R){return this.immutable=R,this}setCanvas(R){return this.canvas=R,this}setStrictIntegers(R){return this.strictIntegers=R,this}setDynamicOutput(R){return this.dynamicOutput=R,this}setHardcodeConstants(R){return L.warnDeprecated("method","setHardcodeConstants"),this.setDynamicOutput(R),this.setDynamicArguments(R),this}setDynamicArguments(R){return this.dynamicArguments=R,this}setUseLegacyEncoder(R){return this.useLegacyEncoder=R,this}setWarnVarUsage(R){return L.warnDeprecated("method","setWarnVarUsage"),this}getCanvas(){return L.warnDeprecated("method","getCanvas"),this.canvas}getWebGl(){return L.warnDeprecated("method","getWebGl"),this.context}setContext(R){return this.context=R,this}setArgumentTypes(R){if(Array.isArray(R))this.argumentTypes=R;else{this.argumentTypes=[];for(const S in R){if(!R.hasOwnProperty(S))continue;const T=this.argumentNames.indexOf(S);if(T===-1)throw new Error(`unable to find argument ${S}`);this.argumentTypes[T]=R[S]}}return this}setTactic(R){return this.tactic=R,this}requestFallback(R){if(!this.onRequestFallback)throw new Error(`"onRequestFallback" not defined on ${this.constructor.name}`);return this.fallbackRequested=!0,this.onRequestFallback(R)}validateSettings(){throw new Error(`"validateSettings" not defined on ${this.constructor.name}`)}addSubKernel(R){if(this.subKernels===null&&(this.subKernels=[]),!R.source)throw new Error('subKernel missing "source" property');if(!R.property&&isNaN(R.property))throw new Error('subKernel missing "property" property');if(!R.name)throw new Error('subKernel missing "name" property');return this.subKernels.push(R),this}destroy(R){throw new Error(`"destroy" called on ${this.constructor.name}`)}getBitRatio(R){if(this.precision==="single")return 4;if(Array.isArray(R[0]))return this.getBitRatio(R[0]);if(R.constructor===F)return this.getBitRatio(R.value);switch(R.constructor){case Uint8ClampedArray:case Uint8Array:case Int8Array:return 1;case Uint16Array:case Int16Array:return 2;case Float32Array:case Int32Array:default:return 4}}getPixels(R){throw new Error(`"getPixels" called on ${this.constructor.name}`)}checkOutput(){if(!this.output||!L.isArray(this.output))throw new Error("kernel.output not an array");if(this.output.length<1)throw new Error("kernel.output is empty, needs at least 1 value");for(let R=0;R<this.output.length;R++)if(isNaN(this.output[R])||this.output[R]<1)throw new Error(`${this.constructor.name}.output[${R}] incorrectly defined as \`${this.output[R]}\`, needs to be numeric, and greater than 0`)}prependString(R){throw new Error(`"prependString" called on ${this.constructor.name}`)}hasPrependString(R){throw new Error(`"hasPrependString" called on ${this.constructor.name}`)}toJSON(){return{settings:{output:this.output,pipeline:this.pipeline,argumentNames:this.argumentNames,argumentsTypes:this.argumentTypes,constants:this.constants,pluginNames:this.plugins?this.plugins.map(R=>R.name):null,returnType:this.returnType}}}buildSignature(R){const S=this.constructor;this.signature=S.getSignature(this,S.getArgumentTypes(this,R))}static getArgumentTypes(R,S){const T=new Array(S.length);for(let H=0;H<S.length;H++){const te=S[H],Se=R.argumentTypes[H];if(te.type)T[H]=te.type;else switch(Se){case"Number":case"Integer":case"Float":case"ArrayTexture(1)":T[H]=L.getVariableType(te);break;default:T[H]=Se}}return T}static getSignature(R,S){throw new Error(`"getSignature" not implemented on ${this.name}`)}functionToIGPUFunction(R,S={}){if(typeof R!="string"&&typeof R!="function")throw new Error("source not a string or function");const T=typeof R=="string"?R:R.toString();let H=[];return Array.isArray(S.argumentTypes)?H=S.argumentTypes:typeof S.argumentTypes=="object"?H=L.getArgumentNamesFromString(T).map(te=>S.argumentTypes[te])||[]:H=S.argumentTypes||[],{name:L.getFunctionNameFromString(T)||null,source:T,argumentTypes:H,returnType:S.returnType||null}}onActivate(R){}}function P(k){const R=Object.keys(k),S=[];for(let T=0;T<R.length;T++){const H=R[T];S.push(k[H])}return{argumentTypes:S,argumentNames:R}}y.exports={Kernel:z}},{"../input":110,"../utils":114}],37:[function(p,y,N){const L=`__HEADER__;
__FLOAT_TACTIC_DECLARATION__;
__INT_TACTIC_DECLARATION__;
__SAMPLER_2D_TACTIC_DECLARATION__;

const int LOOP_MAX = __LOOP_MAX__;

__PLUGINS__;
__CONSTANTS__;

varying vec2 vTexCoord;

float acosh(float x) {
  return log(x + sqrt(x * x - 1.0));
}

float sinh(float x) {
  return (pow(${Math.E}, x) - pow(${Math.E}, -x)) / 2.0;
}

float asinh(float x) {
  return log(x + sqrt(x * x + 1.0));
}

float atan2(float v1, float v2) {
  if (v1 == 0.0 || v2 == 0.0) return 0.0;
  return atan(v1 / v2);
}

float atanh(float x) {
  x = (x + 1.0) / (x - 1.0);
  if (x < 0.0) {
    return 0.5 * log(-x);
  }
  return 0.5 * log(x);
}

float cbrt(float x) {
  if (x >= 0.0) {
    return pow(x, 1.0 / 3.0);
  } else {
    return -pow(x, 1.0 / 3.0);
  }
}

float cosh(float x) {
  return (pow(${Math.E}, x) + pow(${Math.E}, -x)) / 2.0; 
}

float expm1(float x) {
  return pow(${Math.E}, x) - 1.0; 
}

float fround(highp float x) {
  return x;
}

float imul(float v1, float v2) {
  return float(int(v1) * int(v2));
}

float log10(float x) {
  return log2(x) * (1.0 / log2(10.0));
}

float log1p(float x) {
  return log(1.0 + x);
}

float _pow(float v1, float v2) {
  if (v2 == 0.0) return 1.0;
  return pow(v1, v2);
}

float tanh(float x) {
  float e = exp(2.0 * x);
  return (e - 1.0) / (e + 1.0);
}

float trunc(float x) {
  if (x >= 0.0) {
    return floor(x); 
  } else {
    return ceil(x);
  }
}

vec4 _round(vec4 x) {
  return floor(x + 0.5);
}

float _round(float x) {
  return floor(x + 0.5);
}

const int BIT_COUNT = 32;
int modi(int x, int y) {
  return x - y * (x / y);
}

int bitwiseOr(int a, int b) {
  int result = 0;
  int n = 1;
  
  for (int i = 0; i < BIT_COUNT; i++) {
    if ((modi(a, 2) == 1) || (modi(b, 2) == 1)) {
      result += n;
    }
    a = a / 2;
    b = b / 2;
    n = n * 2;
    if(!(a > 0 || b > 0)) {
      break;
    }
  }
  return result;
}
int bitwiseXOR(int a, int b) {
  int result = 0;
  int n = 1;
  
  for (int i = 0; i < BIT_COUNT; i++) {
    if ((modi(a, 2) == 1) != (modi(b, 2) == 1)) {
      result += n;
    }
    a = a / 2;
    b = b / 2;
    n = n * 2;
    if(!(a > 0 || b > 0)) {
      break;
    }
  }
  return result;
}
int bitwiseAnd(int a, int b) {
  int result = 0;
  int n = 1;
  for (int i = 0; i < BIT_COUNT; i++) {
    if ((modi(a, 2) == 1) && (modi(b, 2) == 1)) {
      result += n;
    }
    a = a / 2;
    b = b / 2;
    n = n * 2;
    if(!(a > 0 && b > 0)) {
      break;
    }
  }
  return result;
}
int bitwiseNot(int a) {
  int result = 0;
  int n = 1;
  
  for (int i = 0; i < BIT_COUNT; i++) {
    if (modi(a, 2) == 0) {
      result += n;    
    }
    a = a / 2;
    n = n * 2;
  }
  return result;
}
int bitwiseZeroFillLeftShift(int n, int shift) {
  int maxBytes = BIT_COUNT;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (maxBytes >= n) {
      break;
    }
    maxBytes *= 2;
  }
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= shift) {
      break;
    }
    n *= 2;
  }

  int result = 0;
  int byteVal = 1;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= maxBytes) break;
    if (modi(n, 2) > 0) { result += byteVal; }
    n = int(n / 2);
    byteVal *= 2;
  }
  return result;
}

int bitwiseSignedRightShift(int num, int shifts) {
  return int(floor(float(num) / pow(2.0, float(shifts))));
}

int bitwiseZeroFillRightShift(int n, int shift) {
  int maxBytes = BIT_COUNT;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (maxBytes >= n) {
      break;
    }
    maxBytes *= 2;
  }
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= shift) {
      break;
    }
    n /= 2;
  }
  int result = 0;
  int byteVal = 1;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= maxBytes) break;
    if (modi(n, 2) > 0) { result += byteVal; }
    n = int(n / 2);
    byteVal *= 2;
  }
  return result;
}

vec2 integerMod(vec2 x, float y) {
  vec2 res = floor(mod(x, y));
  return res * step(1.0 - floor(y), -res);
}

vec3 integerMod(vec3 x, float y) {
  vec3 res = floor(mod(x, y));
  return res * step(1.0 - floor(y), -res);
}

vec4 integerMod(vec4 x, vec4 y) {
  vec4 res = floor(mod(x, y));
  return res * step(1.0 - floor(y), -res);
}

float integerMod(float x, float y) {
  float res = floor(mod(x, y));
  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);
}

int integerMod(int x, int y) {
  return x - (y * int(x / y));
}

__DIVIDE_WITH_INTEGER_CHECK__;

// Here be dragons!
// DO NOT OPTIMIZE THIS CODE
// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE
// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME
const vec2 MAGIC_VEC = vec2(1.0, -256.0);
const vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);
const vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536
float decode32(vec4 texel) {
  __DECODE32_ENDIANNESS__;
  texel *= 255.0;
  vec2 gte128;
  gte128.x = texel.b >= 128.0 ? 1.0 : 0.0;
  gte128.y = texel.a >= 128.0 ? 1.0 : 0.0;
  float exponent = 2.0 * texel.a - 127.0 + dot(gte128, MAGIC_VEC);
  float res = exp2(_round(exponent));
  texel.b = texel.b - 128.0 * gte128.x;
  res = dot(texel, SCALE_FACTOR) * exp2(_round(exponent-23.0)) + res;
  res *= gte128.y * -2.0 + 1.0;
  return res;
}

float decode16(vec4 texel, int index) {
  int channel = integerMod(index, 2);
  if (channel == 0) return texel.r * 255.0 + texel.g * 65280.0;
  if (channel == 1) return texel.b * 255.0 + texel.a * 65280.0;
  return 0.0;
}

float decode8(vec4 texel, int index) {
  int channel = integerMod(index, 4);
  if (channel == 0) return texel.r * 255.0;
  if (channel == 1) return texel.g * 255.0;
  if (channel == 2) return texel.b * 255.0;
  if (channel == 3) return texel.a * 255.0;
  return 0.0;
}

vec4 legacyEncode32(float f) {
  float F = abs(f);
  float sign = f < 0.0 ? 1.0 : 0.0;
  float exponent = floor(log2(F));
  float mantissa = (exp2(-exponent) * F);
  // exponent += floor(log2(mantissa));
  vec4 texel = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;
  texel.rg = integerMod(texel.rg, 256.0);
  texel.b = integerMod(texel.b, 128.0);
  texel.a = exponent*0.5 + 63.5;
  texel.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;
  texel = floor(texel);
  texel *= 0.003921569; // 1/255
  __ENCODE32_ENDIANNESS__;
  return texel;
}

// https://github.com/gpujs/gpu.js/wiki/Encoder-details
vec4 encode32(float value) {
  if (value == 0.0) return vec4(0, 0, 0, 0);

  float exponent;
  float mantissa;
  vec4  result;
  float sgn;

  sgn = step(0.0, -value);
  value = abs(value);

  exponent = floor(log2(value));

  mantissa = value*pow(2.0, -exponent)-1.0;
  exponent = exponent+127.0;
  result   = vec4(0,0,0,0);

  result.a = floor(exponent/2.0);
  exponent = exponent - result.a*2.0;
  result.a = result.a + 128.0*sgn;

  result.b = floor(mantissa * 128.0);
  mantissa = mantissa - result.b / 128.0;
  result.b = result.b + exponent*128.0;

  result.g = floor(mantissa*32768.0);
  mantissa = mantissa - result.g/32768.0;

  result.r = floor(mantissa*8388608.0);
  return result/255.0;
}
// Dragons end here

int index;
ivec3 threadId;

ivec3 indexTo3D(int idx, ivec3 texDim) {
  int z = int(idx / (texDim.x * texDim.y));
  idx -= z * int(texDim.x * texDim.y);
  int y = int(idx / texDim.x);
  int x = int(integerMod(idx, texDim.x));
  return ivec3(x, y, z);
}

float get32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture2D(tex, st / vec2(texSize));
  return decode32(texel);
}

float get16(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x * 2;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture2D(tex, st / vec2(texSize.x * 2, texSize.y));
  return decode16(texel, index);
}

float get8(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x * 4;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture2D(tex, st / vec2(texSize.x * 4, texSize.y));
  return decode8(texel, index);
}

float getMemoryOptimized32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int channel = integerMod(index, 4);
  index = index / 4;
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture2D(tex, st / vec2(texSize));
  if (channel == 0) return texel.r;
  if (channel == 1) return texel.g;
  if (channel == 2) return texel.b;
  if (channel == 3) return texel.a;
  return 0.0;
}

vec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  return texture2D(tex, st / vec2(texSize));
}

float getFloatFromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);
  return result[0];
}

vec2 getVec2FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);
  return vec2(result[0], result[1]);
}

vec2 getMemoryOptimizedVec2(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + (texDim.x * (y + (texDim.y * z)));
  int channel = integerMod(index, 2);
  index = index / 2;
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture2D(tex, st / vec2(texSize));
  if (channel == 0) return vec2(texel.r, texel.g);
  if (channel == 1) return vec2(texel.b, texel.a);
  return vec2(0.0, 0.0);
}

vec3 getVec3FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);
  return vec3(result[0], result[1], result[2]);
}

vec3 getMemoryOptimizedVec3(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int fieldIndex = 3 * (x + texDim.x * (y + texDim.y * z));
  int vectorIndex = fieldIndex / 4;
  int vectorOffset = fieldIndex - vectorIndex * 4;
  int readY = vectorIndex / texSize.x;
  int readX = vectorIndex - readY * texSize.x;
  vec4 tex1 = texture2D(tex, (vec2(readX, readY) + 0.5) / vec2(texSize));
  
  if (vectorOffset == 0) {
    return tex1.xyz;
  } else if (vectorOffset == 1) {
    return tex1.yzw;
  } else {
    readX++;
    if (readX >= texSize.x) {
      readX = 0;
      readY++;
    }
    vec4 tex2 = texture2D(tex, vec2(readX, readY) / vec2(texSize));
    if (vectorOffset == 2) {
      return vec3(tex1.z, tex1.w, tex2.x);
    } else {
      return vec3(tex1.w, tex2.x, tex2.y);
    }
  }
}

vec4 getVec4FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  return getImage2D(tex, texSize, texDim, z, y, x);
}

vec4 getMemoryOptimizedVec4(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int channel = integerMod(index, 2);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture2D(tex, st / vec2(texSize));
  return vec4(texel.r, texel.g, texel.b, texel.a);
}

vec4 actualColor;
void color(float r, float g, float b, float a) {
  actualColor = vec4(r,g,b,a);
}

void color(float r, float g, float b) {
  color(r,g,b,1.0);
}

void color(sampler2D image) {
  actualColor = texture2D(image, vTexCoord);
}

float modulo(float number, float divisor) {
  if (number < 0.0) {
    number = abs(number);
    if (divisor < 0.0) {
      divisor = abs(divisor);
    }
    return -mod(number, divisor);
  }
  if (divisor < 0.0) {
    divisor = abs(divisor);
  }
  return mod(number, divisor);
}

__INJECTED_NATIVE__;
__MAIN_CONSTANTS__;
__MAIN_ARGUMENTS__;
__KERNEL__;

void main(void) {
  index = int(vTexCoord.s * float(uTexSize.x)) + int(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;
  __MAIN_RESULT__;
}`;y.exports={fragmentShader:L}},{}],38:[function(p,y,N){const{utils:L}=p("../../utils"),{FunctionNode:F}=p("../function-node");class z extends F{constructor(S,T){super(S,T),T&&T.hasOwnProperty("fixIntegerDivisionAccuracy")&&(this.fixIntegerDivisionAccuracy=T.fixIntegerDivisionAccuracy)}astConditionalExpression(S,T){if(S.type!=="ConditionalExpression")throw this.astErrorOutput("Not a conditional expression",S);const H=this.getType(S.consequent),te=this.getType(S.alternate);return H===null&&te===null?(T.push("if ("),this.astGeneric(S.test,T),T.push(") {"),this.astGeneric(S.consequent,T),T.push(";"),T.push("} else {"),this.astGeneric(S.alternate,T),T.push(";"),T.push("}"),T):(T.push("("),this.astGeneric(S.test,T),T.push("?"),this.astGeneric(S.consequent,T),T.push(":"),this.astGeneric(S.alternate,T),T.push(")"),T)}astFunction(S,T){if(this.isRootKernel)T.push("void");else{this.returnType||this.findLastReturn()&&(this.returnType=this.getType(S.body),this.returnType==="LiteralInteger"&&(this.returnType="Number"));const{returnType:H}=this;if(!H)T.push("void");else{const te=P[H];if(!te)throw new Error(`unknown type ${H}`);T.push(te)}}if(T.push(" "),T.push(this.name),T.push("("),!this.isRootKernel)for(let H=0;H<this.argumentNames.length;++H){const te=this.argumentNames[H];H>0&&T.push(", ");let Se=this.argumentTypes[this.argumentNames.indexOf(te)];if(!Se)throw this.astErrorOutput(`Unknown argument ${te} type`,S);Se==="LiteralInteger"&&(this.argumentTypes[H]=Se="Number");const ie=P[Se];if(!ie)throw this.astErrorOutput("Unexpected expression",S);const _e=L.sanitizeName(te);ie==="sampler2D"||ie==="sampler2DArray"?T.push(`${ie} user_${_e},ivec2 user_${_e}Size,ivec3 user_${_e}Dim`):T.push(`${ie} user_${_e}`)}T.push(`) {
`);for(let H=0;H<S.body.body.length;++H)this.astGeneric(S.body.body[H],T),T.push(`
`);return T.push(`}
`),T}astReturnStatement(S,T){if(!S.argument)throw this.astErrorOutput("Unexpected return statement",S);this.pushState("skip-literal-correction");const H=this.getType(S.argument);this.popState("skip-literal-correction");const te=[];switch(this.returnType||(H==="LiteralInteger"||H==="Integer"?this.returnType="Number":this.returnType=H),this.returnType){case"LiteralInteger":case"Number":case"Float":switch(H){case"Integer":te.push("float("),this.astGeneric(S.argument,te),te.push(")");break;case"LiteralInteger":this.castLiteralToFloat(S.argument,te),this.getType(S)==="Integer"&&(te.unshift("float("),te.push(")"));break;default:this.astGeneric(S.argument,te)}break;case"Integer":switch(H){case"Float":case"Number":this.castValueToInteger(S.argument,te);break;case"LiteralInteger":this.castLiteralToInteger(S.argument,te);break;default:this.astGeneric(S.argument,te)}break;case"Array(4)":case"Array(3)":case"Array(2)":case"Matrix(2)":case"Matrix(3)":case"Matrix(4)":case"Input":this.astGeneric(S.argument,te);break;default:throw this.astErrorOutput(`unhandled return type ${this.returnType}`,S)}return this.isRootKernel?(T.push(`kernelResult = ${te.join("")};`),T.push("return;")):this.isSubKernel?(T.push(`subKernelResult_${this.name} = ${te.join("")};`),T.push(`return subKernelResult_${this.name};`)):T.push(`return ${te.join("")};`),T}astLiteral(S,T){if(isNaN(S.value))throw this.astErrorOutput("Non-numeric literal not supported : "+S.value,S);const H=this.astKey(S);return Number.isInteger(S.value)?this.isState("casting-to-integer")||this.isState("building-integer")?(this.literalTypes[H]="Integer",T.push(`${S.value}`)):this.isState("casting-to-float")||this.isState("building-float")?(this.literalTypes[H]="Number",T.push(`${S.value}.0`)):(this.literalTypes[H]="Number",T.push(`${S.value}.0`)):this.isState("casting-to-integer")||this.isState("building-integer")?(this.literalTypes[H]="Integer",T.push(Math.round(S.value))):(this.literalTypes[H]="Number",T.push(`${S.value}`)),T}astBinaryExpression(S,T){if(this.checkAndUpconvertOperator(S,T))return T;if(this.fixIntegerDivisionAccuracy&&S.operator==="/"){switch(T.push("divWithIntCheck("),this.pushState("building-float"),this.getType(S.left)){case"Integer":this.castValueToFloat(S.left,T);break;case"LiteralInteger":this.castLiteralToFloat(S.left,T);break;default:this.astGeneric(S.left,T)}switch(T.push(", "),this.getType(S.right)){case"Integer":this.castValueToFloat(S.right,T);break;case"LiteralInteger":this.castLiteralToFloat(S.right,T);break;default:this.astGeneric(S.right,T)}return this.popState("building-float"),T.push(")"),T}T.push("(");const H=this.getType(S.left)||"Number",te=this.getType(S.right)||"Number",Se=H+" & "+te;switch(Se){case"Integer & Integer":this.pushState("building-integer"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.astGeneric(S.right,T),this.popState("building-integer");break;case"Number & Float":case"Float & Number":case"Float & Float":case"Number & Number":this.pushState("building-float"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.astGeneric(S.right,T),this.popState("building-float");break;case"LiteralInteger & LiteralInteger":this.isState("casting-to-integer")||this.isState("building-integer")?(this.pushState("building-integer"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.astGeneric(S.right,T),this.popState("building-integer")):(this.pushState("building-float"),this.castLiteralToFloat(S.left,T),T.push(k[S.operator]||S.operator),this.castLiteralToFloat(S.right,T),this.popState("building-float"));break;case"Integer & Float":case"Integer & Number":if((S.operator===">"||S.operator==="<"&&S.right.type==="Literal")&&!Number.isInteger(S.right.value)){this.pushState("building-float"),this.castValueToFloat(S.left,T),T.push(k[S.operator]||S.operator),this.astGeneric(S.right,T),this.popState("building-float");break}if(this.pushState("building-integer"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.pushState("casting-to-integer"),S.right.type==="Literal"){const ie=[];if(this.astGeneric(S.right,ie),this.getType(S.right)==="Integer")T.push(ie.join(""));else throw this.astErrorOutput("Unhandled binary expression with literal",S)}else T.push("int("),this.astGeneric(S.right,T),T.push(")");this.popState("casting-to-integer"),this.popState("building-integer");break;case"Integer & LiteralInteger":this.pushState("building-integer"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.castLiteralToInteger(S.right,T),this.popState("building-integer");break;case"Number & Integer":this.pushState("building-float"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.castValueToFloat(S.right,T),this.popState("building-float");break;case"Float & LiteralInteger":case"Number & LiteralInteger":this.pushState("building-float"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.castLiteralToFloat(S.right,T),this.popState("building-float");break;case"LiteralInteger & Float":case"LiteralInteger & Number":this.isState("casting-to-integer")?(this.pushState("building-integer"),this.castLiteralToInteger(S.left,T),T.push(k[S.operator]||S.operator),this.castValueToInteger(S.right,T),this.popState("building-integer")):(this.pushState("building-float"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.pushState("casting-to-float"),this.astGeneric(S.right,T),this.popState("casting-to-float"),this.popState("building-float"));break;case"LiteralInteger & Integer":this.pushState("building-integer"),this.castLiteralToInteger(S.left,T),T.push(k[S.operator]||S.operator),this.astGeneric(S.right,T),this.popState("building-integer");break;case"Boolean & Boolean":this.pushState("building-boolean"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.astGeneric(S.right,T),this.popState("building-boolean");break;case"Float & Integer":this.pushState("building-float"),this.astGeneric(S.left,T),T.push(k[S.operator]||S.operator),this.castValueToFloat(S.right,T),this.popState("building-float");break;default:throw this.astErrorOutput(`Unhandled binary expression between ${Se}`,S)}return T.push(")"),T}checkAndUpconvertOperator(S,T){const H=this.checkAndUpconvertBitwiseOperators(S,T);if(H)return H;const Se={"%":this.fixIntegerDivisionAccuracy?"integerCorrectionModulo":"modulo","**":"pow"}[S.operator];if(!Se)return null;switch(T.push(Se),T.push("("),this.getType(S.left)){case"Integer":this.castValueToFloat(S.left,T);break;case"LiteralInteger":this.castLiteralToFloat(S.left,T);break;default:this.astGeneric(S.left,T)}switch(T.push(","),this.getType(S.right)){case"Integer":this.castValueToFloat(S.right,T);break;case"LiteralInteger":this.castLiteralToFloat(S.right,T);break;default:this.astGeneric(S.right,T)}return T.push(")"),T}checkAndUpconvertBitwiseOperators(S,T){const te={"&":"bitwiseAnd","|":"bitwiseOr","^":"bitwiseXOR","<<":"bitwiseZeroFillLeftShift",">>":"bitwiseSignedRightShift",">>>":"bitwiseZeroFillRightShift"}[S.operator];if(!te)return null;switch(T.push(te),T.push("("),this.getType(S.left)){case"Number":case"Float":this.castValueToInteger(S.left,T);break;case"LiteralInteger":this.castLiteralToInteger(S.left,T);break;default:this.astGeneric(S.left,T)}switch(T.push(","),this.getType(S.right)){case"Number":case"Float":this.castValueToInteger(S.right,T);break;case"LiteralInteger":this.castLiteralToInteger(S.right,T);break;default:this.astGeneric(S.right,T)}return T.push(")"),T}checkAndUpconvertBitwiseUnary(S,T){const te={"~":"bitwiseNot"}[S.operator];if(!te)return null;switch(T.push(te),T.push("("),this.getType(S.argument)){case"Number":case"Float":this.castValueToInteger(S.argument,T);break;case"LiteralInteger":this.castLiteralToInteger(S.argument,T);break;default:this.astGeneric(S.argument,T)}return T.push(")"),T}castLiteralToInteger(S,T){return this.pushState("casting-to-integer"),this.astGeneric(S,T),this.popState("casting-to-integer"),T}castLiteralToFloat(S,T){return this.pushState("casting-to-float"),this.astGeneric(S,T),this.popState("casting-to-float"),T}castValueToInteger(S,T){return this.pushState("casting-to-integer"),T.push("int("),this.astGeneric(S,T),T.push(")"),this.popState("casting-to-integer"),T}castValueToFloat(S,T){return this.pushState("casting-to-float"),T.push("float("),this.astGeneric(S,T),T.push(")"),this.popState("casting-to-float"),T}astIdentifierExpression(S,T){if(S.type!=="Identifier")throw this.astErrorOutput("IdentifierExpression - not an Identifier",S);const H=this.getType(S),te=L.sanitizeName(S.name);return S.name==="Infinity"?T.push("3.402823466e+38"):H==="Boolean"?this.argumentNames.indexOf(te)>-1?T.push(`bool(user_${te})`):T.push(`user_${te}`):T.push(`user_${te}`),T}astForStatement(S,T){if(S.type!=="ForStatement")throw this.astErrorOutput("Invalid for statement",S);const H=[],te=[],Se=[],ie=[];let _e=null;if(S.init){const{declarations:Y}=S.init;Y.length>1&&(_e=!1),this.astGeneric(S.init,H);for(let re=0;re<Y.length;re++)Y[re].init&&Y[re].init.type!=="Literal"&&(_e=!1)}else _e=!1;if(S.test?this.astGeneric(S.test,te):_e=!1,S.update?this.astGeneric(S.update,Se):_e=!1,S.body&&(this.pushState("loop-body"),this.astGeneric(S.body,ie),this.popState("loop-body")),_e===null&&(_e=this.isSafe(S.init)&&this.isSafe(S.test)),_e){const Y=H.join(""),re=Y[Y.length-1]!==";";T.push(`for (${Y}${re?";":""}${te.join("")};${Se.join("")}){
`),T.push(ie.join("")),T.push(`}
`)}else{const Y=this.getInternalVariableName("safeI");H.length>0&&T.push(H.join(""),`
`),T.push(`for (int ${Y}=0;${Y}<LOOP_MAX;${Y}++){
`),te.length>0&&T.push(`if (!${te.join("")}) break;
`),T.push(ie.join("")),T.push(`
${Se.join("")};`),T.push(`}
`)}return T}astWhileStatement(S,T){if(S.type!=="WhileStatement")throw this.astErrorOutput("Invalid while statement",S);const H=this.getInternalVariableName("safeI");return T.push(`for (int ${H}=0;${H}<LOOP_MAX;${H}++){
`),T.push("if (!"),this.astGeneric(S.test,T),T.push(`) break;
`),this.astGeneric(S.body,T),T.push(`}
`),T}astDoWhileStatement(S,T){if(S.type!=="DoWhileStatement")throw this.astErrorOutput("Invalid while statement",S);const H=this.getInternalVariableName("safeI");return T.push(`for (int ${H}=0;${H}<LOOP_MAX;${H}++){
`),this.astGeneric(S.body,T),T.push("if (!"),this.astGeneric(S.test,T),T.push(`) break;
`),T.push(`}
`),T}astAssignmentExpression(S,T){if(S.operator==="%=")this.astGeneric(S.left,T),T.push("="),T.push("mod("),this.astGeneric(S.left,T),T.push(","),this.astGeneric(S.right,T),T.push(")");else if(S.operator==="**=")this.astGeneric(S.left,T),T.push("="),T.push("pow("),this.astGeneric(S.left,T),T.push(","),this.astGeneric(S.right,T),T.push(")");else{const H=this.getType(S.left),te=this.getType(S.right);return this.astGeneric(S.left,T),T.push(S.operator),H!=="Integer"&&te==="Integer"?(T.push("float("),this.astGeneric(S.right,T),T.push(")")):this.astGeneric(S.right,T),T}}astBlockStatement(S,T){if(this.isState("loop-body")){this.pushState("block-body");for(let H=0;H<S.body.length;H++)this.astGeneric(S.body[H],T);this.popState("block-body")}else{T.push(`{
`);for(let H=0;H<S.body.length;H++)this.astGeneric(S.body[H],T);T.push(`}
`)}return T}astVariableDeclaration(S,T){const H=S.declarations;if(!H||!H[0]||!H[0].init)throw this.astErrorOutput("Unexpected expression",S);const te=[];let Se=null;const ie=[];let _e=[];for(let Y=0;Y<H.length;Y++){const re=H[Y],be=re.init,ke=this.getDeclaration(re.id),it=this.getType(re.init);let vt=it;vt==="LiteralInteger"&&(ke.suggestedType==="Integer"?vt="Integer":vt="Number");const Q=P[vt];if(!Q)throw this.astErrorOutput(`Markup type ${vt} not handled`,S);const U=[];if(it==="Integer"&&vt==="Integer"){if(ke.valueType="Number",Y===0||Se===null)U.push("float ");else if(vt!==Se)throw new Error("Unhandled declaration");Se=vt,U.push(`user_${L.sanitizeName(re.id.name)}=`),U.push("float("),this.astGeneric(be,U),U.push(")")}else ke.valueType=vt,Y===0||Se===null?U.push(`${Q} `):vt!==Se&&(ie.push(_e.join(",")),_e=[],U.push(`${Q} `)),Se=vt,U.push(`user_${L.sanitizeName(re.id.name)}=`),it==="Number"&&vt==="Integer"?be.left&&be.left.type==="Literal"?this.astGeneric(be,U):(U.push("int("),this.astGeneric(be,U),U.push(")")):it==="LiteralInteger"&&vt==="Integer"?this.castLiteralToInteger(be,U):this.astGeneric(be,U);_e.push(U.join(""))}return _e.length>0&&ie.push(_e.join(",")),te.push(ie.join(";")),T.push(te.join("")),T.push(";"),T}astIfStatement(S,T){return T.push("if ("),this.astGeneric(S.test,T),T.push(")"),S.consequent.type==="BlockStatement"?this.astGeneric(S.consequent,T):(T.push(` {
`),this.astGeneric(S.consequent,T),T.push(`
}
`)),S.alternate&&(T.push("else "),S.alternate.type==="BlockStatement"||S.alternate.type==="IfStatement"?this.astGeneric(S.alternate,T):(T.push(` {
`),this.astGeneric(S.alternate,T),T.push(`
}
`))),T}astSwitchStatement(S,T){if(S.type!=="SwitchStatement")throw this.astErrorOutput("Invalid switch statement",S);const{discriminant:H,cases:te}=S,Se=this.getType(H),ie=`switchDiscriminant${this.astKey(S,"_")}`;switch(Se){case"Float":case"Number":T.push(`float ${ie} = `),this.astGeneric(H,T),T.push(`;
`);break;case"Integer":T.push(`int ${ie} = `),this.astGeneric(H,T),T.push(`;
`);break}if(te.length===1&&!te[0].test)return this.astGeneric(te[0].consequent,T),T;let _e=!1,Y=[],re=!1,be=!1;for(let ke=0;ke<te.length;ke++){if(te[ke].test){if(ke===0||!be?(be=!0,T.push(`if (${ie} == `)):_e?(T.push(`${ie} == `),_e=!1):T.push(` else if (${ie} == `),Se==="Integer")switch(this.getType(te[ke].test)){case"Number":case"Float":this.castValueToInteger(te[ke].test,T);break;case"LiteralInteger":this.castLiteralToInteger(te[ke].test,T);break}else if(Se==="Float")switch(this.getType(te[ke].test)){case"LiteralInteger":this.castLiteralToFloat(te[ke].test,T);break;case"Integer":this.castValueToFloat(te[ke].test,T);break}else throw new Error("unhanlded");if(!te[ke].consequent||te[ke].consequent.length===0){_e=!0,T.push(" || ");continue}T.push(`) {
`)}else if(te.length>ke+1){re=!0,this.astGeneric(te[ke].consequent,Y);continue}else T.push(` else {
`);this.astGeneric(te[ke].consequent,T),T.push(`
}`)}return re&&(T.push(" else {"),T.push(Y.join("")),T.push("}")),T}astThisExpression(S,T){return T.push("this"),T}astMemberExpression(S,T){const{property:H,name:te,signature:Se,origin:ie,type:_e,xProperty:Y,yProperty:re,zProperty:be}=this.getMemberExpressionDetails(S);switch(Se){case"value.thread.value":case"this.thread.value":if(te!=="x"&&te!=="y"&&te!=="z")throw this.astErrorOutput("Unexpected expression, expected `this.thread.x`, `this.thread.y`, or `this.thread.z`",S);return T.push(`threadId.${te}`),T;case"this.output.value":if(this.dynamicOutput)switch(te){case"x":this.isState("casting-to-float")?T.push("float(uOutputDim.x)"):T.push("uOutputDim.x");break;case"y":this.isState("casting-to-float")?T.push("float(uOutputDim.y)"):T.push("uOutputDim.y");break;case"z":this.isState("casting-to-float")?T.push("float(uOutputDim.z)"):T.push("uOutputDim.z");break;default:throw this.astErrorOutput("Unexpected expression",S)}else switch(te){case"x":this.isState("casting-to-integer")?T.push(this.output[0]):T.push(this.output[0],".0");break;case"y":this.isState("casting-to-integer")?T.push(this.output[1]):T.push(this.output[1],".0");break;case"z":this.isState("casting-to-integer")?T.push(this.output[2]):T.push(this.output[2],".0");break;default:throw this.astErrorOutput("Unexpected expression",S)}return T;case"value":throw this.astErrorOutput("Unexpected expression",S);case"value[]":case"value[][]":case"value[][][]":case"value[][][][]":case"value.value":if(ie==="Math")return T.push(Math[te]),T;const it=L.sanitizeName(te);switch(H){case"r":return T.push(`user_${it}.r`),T;case"g":return T.push(`user_${it}.g`),T;case"b":return T.push(`user_${it}.b`),T;case"a":return T.push(`user_${it}.a`),T}break;case"this.constants.value":if(typeof Y>"u")switch(_e){case"Array(2)":case"Array(3)":case"Array(4)":return T.push(`constants_${L.sanitizeName(te)}`),T}case"this.constants.value[]":case"this.constants.value[][]":case"this.constants.value[][][]":case"this.constants.value[][][][]":break;case"fn()[]":return this.astCallExpression(S.object,T),T.push("["),T.push(this.memberExpressionPropertyMarkup(H)),T.push("]"),T;case"fn()[][]":return this.astCallExpression(S.object.object,T),T.push("["),T.push(this.memberExpressionPropertyMarkup(S.object.property)),T.push("]"),T.push("["),T.push(this.memberExpressionPropertyMarkup(S.property)),T.push("]"),T;case"[][]":return this.astArrayExpression(S.object,T),T.push("["),T.push(this.memberExpressionPropertyMarkup(H)),T.push("]"),T;default:throw this.astErrorOutput("Unexpected expression",S)}if(S.computed===!1)switch(_e){case"Number":case"Integer":case"Float":case"Boolean":return T.push(`${ie}_${L.sanitizeName(te)}`),T}const ke=`${ie}_${L.sanitizeName(te)}`;switch(_e){case"Array(2)":case"Array(3)":case"Array(4)":this.astGeneric(S.object,T),T.push("["),T.push(this.memberExpressionPropertyMarkup(Y)),T.push("]");break;case"HTMLImageArray":T.push(`getImage3D(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"ArrayTexture(1)":T.push(`getFloatFromSampler2D(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"Array1D(2)":case"Array2D(2)":case"Array3D(2)":T.push(`getMemoryOptimizedVec2(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"ArrayTexture(2)":T.push(`getVec2FromSampler2D(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"Array1D(3)":case"Array2D(3)":case"Array3D(3)":T.push(`getMemoryOptimizedVec3(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"ArrayTexture(3)":T.push(`getVec3FromSampler2D(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"Array1D(4)":case"Array2D(4)":case"Array3D(4)":T.push(`getMemoryOptimizedVec4(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"ArrayTexture(4)":case"HTMLCanvas":case"OffscreenCanvas":case"HTMLImage":case"ImageBitmap":case"ImageData":case"HTMLVideo":T.push(`getVec4FromSampler2D(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"NumberTexture":case"Array":case"Array2D":case"Array3D":case"Array4D":case"Input":case"Number":case"Float":case"Integer":if(this.precision==="single")T.push(`getMemoryOptimized32(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");else{const it=ie==="user"?this.lookupFunctionArgumentBitRatio(this.name,te):this.constantBitRatios[te];switch(it){case 1:T.push(`get8(${ke}, ${ke}Size, ${ke}Dim, `);break;case 2:T.push(`get16(${ke}, ${ke}Size, ${ke}Dim, `);break;case 4:case 0:T.push(`get32(${ke}, ${ke}Size, ${ke}Dim, `);break;default:throw new Error(`unhandled bit ratio of ${it}`)}this.memberExpressionXYZ(Y,re,be,T),T.push(")")}break;case"MemoryOptimizedNumberTexture":T.push(`getMemoryOptimized32(${ke}, ${ke}Size, ${ke}Dim, `),this.memberExpressionXYZ(Y,re,be,T),T.push(")");break;case"Matrix(2)":case"Matrix(3)":case"Matrix(4)":T.push(`${ke}[${this.memberExpressionPropertyMarkup(re)}]`),re&&T.push(`[${this.memberExpressionPropertyMarkup(Y)}]`);break;default:throw new Error(`unhandled member expression "${_e}"`)}return T}astCallExpression(S,T){if(!S.callee)throw this.astErrorOutput("Unknown CallExpression",S);let H=null;const te=this.isAstMathFunction(S);if(te||S.callee.object&&S.callee.object.type==="ThisExpression"?H=S.callee.property.name:S.callee.type==="SequenceExpression"&&S.callee.expressions[0].type==="Literal"&&!isNaN(S.callee.expressions[0].raw)?H=S.callee.expressions[1].property.name:H=S.callee.name,!H)throw this.astErrorOutput("Unhandled function, couldn't find name",S);switch(H){case"pow":H="_pow";break;case"round":H="_round";break}if(this.calledFunctions.indexOf(H)<0&&this.calledFunctions.push(H),H==="random"&&this.plugins&&this.plugins.length>0)for(let Se=0;Se<this.plugins.length;Se++){const ie=this.plugins[Se];if(ie.functionMatch==="Math.random()"&&ie.functionReplace)return T.push(ie.functionReplace),T}if(this.onFunctionCall&&this.onFunctionCall(this.name,H,S.arguments),T.push(H),T.push("("),te)for(let Se=0;Se<S.arguments.length;++Se){const ie=S.arguments[Se],_e=this.getType(ie);switch(Se>0&&T.push(", "),_e){case"Integer":this.castValueToFloat(ie,T);break;default:this.astGeneric(ie,T);break}}else{const Se=this.lookupFunctionArgumentTypes(H)||[];for(let ie=0;ie<S.arguments.length;++ie){const _e=S.arguments[ie];let Y=Se[ie];ie>0&&T.push(", ");const re=this.getType(_e);switch(Y||(this.triggerImplyArgumentType(H,ie,re,this),Y=re),re){case"Boolean":this.astGeneric(_e,T);continue;case"Number":case"Float":if(Y==="Integer"){T.push("int("),this.astGeneric(_e,T),T.push(")");continue}else if(Y==="Number"||Y==="Float"){this.astGeneric(_e,T);continue}else if(Y==="LiteralInteger"){this.castLiteralToFloat(_e,T);continue}break;case"Integer":if(Y==="Number"||Y==="Float"){T.push("float("),this.astGeneric(_e,T),T.push(")");continue}else if(Y==="Integer"){this.astGeneric(_e,T);continue}break;case"LiteralInteger":if(Y==="Integer"){this.castLiteralToInteger(_e,T);continue}else if(Y==="Number"||Y==="Float"){this.castLiteralToFloat(_e,T);continue}else if(Y==="LiteralInteger"){this.astGeneric(_e,T);continue}break;case"Array(2)":case"Array(3)":case"Array(4)":if(Y===re){if(_e.type==="Identifier")T.push(`user_${L.sanitizeName(_e.name)}`);else if(_e.type==="ArrayExpression"||_e.type==="MemberExpression"||_e.type==="CallExpression")this.astGeneric(_e,T);else throw this.astErrorOutput(`Unhandled argument type ${_e.type}`,S);continue}break;case"HTMLCanvas":case"OffscreenCanvas":case"HTMLImage":case"ImageBitmap":case"ImageData":case"HTMLImageArray":case"HTMLVideo":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":case"Array":case"Input":if(Y===re){if(_e.type!=="Identifier")throw this.astErrorOutput(`Unhandled argument type ${_e.type}`,S);this.triggerImplyArgumentBitRatio(this.name,_e.name,H,ie);const be=L.sanitizeName(_e.name);T.push(`user_${be},user_${be}Size,user_${be}Dim`);continue}break}throw this.astErrorOutput(`Unhandled argument combination of ${re} and ${Y} for argument named "${_e.name}"`,S)}}return T.push(")"),T}astArrayExpression(S,T){const H=this.getType(S),te=S.elements.length;switch(H){case"Matrix(2)":case"Matrix(3)":case"Matrix(4)":T.push(`mat${te}(`);break;default:T.push(`vec${te}(`)}for(let Se=0;Se<te;++Se){Se>0&&T.push(", ");const ie=S.elements[Se];this.astGeneric(ie,T)}return T.push(")"),T}memberExpressionXYZ(S,T,H,te){return H?te.push(this.memberExpressionPropertyMarkup(H),", "):te.push("0, "),T?te.push(this.memberExpressionPropertyMarkup(T),", "):te.push("0, "),te.push(this.memberExpressionPropertyMarkup(S)),te}memberExpressionPropertyMarkup(S){if(!S)throw new Error("Property not set");const T=this.getType(S),H=[];switch(T){case"Number":case"Float":this.castValueToInteger(S,H);break;case"LiteralInteger":this.castLiteralToInteger(S,H);break;default:this.astGeneric(S,H)}return H.join("")}}const P={Array:"sampler2D","Array(2)":"vec2","Array(3)":"vec3","Array(4)":"vec4","Matrix(2)":"mat2","Matrix(3)":"mat3","Matrix(4)":"mat4",Array2D:"sampler2D",Array3D:"sampler2D",Boolean:"bool",Float:"float",Input:"sampler2D",Integer:"int",Number:"float",LiteralInteger:"float",NumberTexture:"sampler2D",MemoryOptimizedNumberTexture:"sampler2D","ArrayTexture(1)":"sampler2D","ArrayTexture(2)":"sampler2D","ArrayTexture(3)":"sampler2D","ArrayTexture(4)":"sampler2D",HTMLVideo:"sampler2D",HTMLCanvas:"sampler2D",OffscreenCanvas:"sampler2D",HTMLImage:"sampler2D",ImageBitmap:"sampler2D",ImageData:"sampler2D",HTMLImageArray:"sampler2DArray"},k={"===":"==","!==":"!="};y.exports={WebGLFunctionNode:z}},{"../../utils":114,"../function-node":10}],39:[function(p,y,N){const{WebGLKernelValueBoolean:L}=p("./kernel-value/boolean"),{WebGLKernelValueFloat:F}=p("./kernel-value/float"),{WebGLKernelValueInteger:z}=p("./kernel-value/integer"),{WebGLKernelValueHTMLImage:P}=p("./kernel-value/html-image"),{WebGLKernelValueDynamicHTMLImage:k}=p("./kernel-value/dynamic-html-image"),{WebGLKernelValueHTMLVideo:R}=p("./kernel-value/html-video"),{WebGLKernelValueDynamicHTMLVideo:S}=p("./kernel-value/dynamic-html-video"),{WebGLKernelValueSingleInput:T}=p("./kernel-value/single-input"),{WebGLKernelValueDynamicSingleInput:H}=p("./kernel-value/dynamic-single-input"),{WebGLKernelValueUnsignedInput:te}=p("./kernel-value/unsigned-input"),{WebGLKernelValueDynamicUnsignedInput:Se}=p("./kernel-value/dynamic-unsigned-input"),{WebGLKernelValueMemoryOptimizedNumberTexture:ie}=p("./kernel-value/memory-optimized-number-texture"),{WebGLKernelValueDynamicMemoryOptimizedNumberTexture:_e}=p("./kernel-value/dynamic-memory-optimized-number-texture"),{WebGLKernelValueNumberTexture:Y}=p("./kernel-value/number-texture"),{WebGLKernelValueDynamicNumberTexture:re}=p("./kernel-value/dynamic-number-texture"),{WebGLKernelValueSingleArray:be}=p("./kernel-value/single-array"),{WebGLKernelValueDynamicSingleArray:ke}=p("./kernel-value/dynamic-single-array"),{WebGLKernelValueSingleArray1DI:it}=p("./kernel-value/single-array1d-i"),{WebGLKernelValueDynamicSingleArray1DI:vt}=p("./kernel-value/dynamic-single-array1d-i"),{WebGLKernelValueSingleArray2DI:Q}=p("./kernel-value/single-array2d-i"),{WebGLKernelValueDynamicSingleArray2DI:U}=p("./kernel-value/dynamic-single-array2d-i"),{WebGLKernelValueSingleArray3DI:Oe}=p("./kernel-value/single-array3d-i"),{WebGLKernelValueDynamicSingleArray3DI:Fe}=p("./kernel-value/dynamic-single-array3d-i"),{WebGLKernelValueArray2:bt}=p("./kernel-value/array2"),{WebGLKernelValueArray3:v}=p("./kernel-value/array3"),{WebGLKernelValueArray4:I}=p("./kernel-value/array4"),{WebGLKernelValueUnsignedArray:M}=p("./kernel-value/unsigned-array"),{WebGLKernelValueDynamicUnsignedArray:G}=p("./kernel-value/dynamic-unsigned-array"),oe={unsigned:{dynamic:{Boolean:L,Integer:z,Float:F,Array:G,"Array(2)":bt,"Array(3)":v,"Array(4)":I,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:Se,NumberTexture:re,"ArrayTexture(1)":re,"ArrayTexture(2)":re,"ArrayTexture(3)":re,"ArrayTexture(4)":re,MemoryOptimizedNumberTexture:_e,HTMLCanvas:k,OffscreenCanvas:k,HTMLImage:k,ImageBitmap:k,ImageData:k,HTMLImageArray:!1,HTMLVideo:S},static:{Boolean:L,Float:F,Integer:z,Array:M,"Array(2)":bt,"Array(3)":v,"Array(4)":I,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:te,NumberTexture:Y,"ArrayTexture(1)":Y,"ArrayTexture(2)":Y,"ArrayTexture(3)":Y,"ArrayTexture(4)":Y,MemoryOptimizedNumberTexture:ie,HTMLCanvas:P,OffscreenCanvas:P,HTMLImage:P,ImageBitmap:P,ImageData:P,HTMLImageArray:!1,HTMLVideo:R}},single:{dynamic:{Boolean:L,Integer:z,Float:F,Array:ke,"Array(2)":bt,"Array(3)":v,"Array(4)":I,"Array1D(2)":vt,"Array1D(3)":vt,"Array1D(4)":vt,"Array2D(2)":U,"Array2D(3)":U,"Array2D(4)":U,"Array3D(2)":Fe,"Array3D(3)":Fe,"Array3D(4)":Fe,Input:H,NumberTexture:re,"ArrayTexture(1)":re,"ArrayTexture(2)":re,"ArrayTexture(3)":re,"ArrayTexture(4)":re,MemoryOptimizedNumberTexture:_e,HTMLCanvas:k,OffscreenCanvas:k,HTMLImage:k,ImageBitmap:k,ImageData:k,HTMLImageArray:!1,HTMLVideo:S},static:{Boolean:L,Float:F,Integer:z,Array:be,"Array(2)":bt,"Array(3)":v,"Array(4)":I,"Array1D(2)":it,"Array1D(3)":it,"Array1D(4)":it,"Array2D(2)":Q,"Array2D(3)":Q,"Array2D(4)":Q,"Array3D(2)":Oe,"Array3D(3)":Oe,"Array3D(4)":Oe,Input:T,NumberTexture:Y,"ArrayTexture(1)":Y,"ArrayTexture(2)":Y,"ArrayTexture(3)":Y,"ArrayTexture(4)":Y,MemoryOptimizedNumberTexture:ie,HTMLCanvas:P,OffscreenCanvas:P,HTMLImage:P,ImageBitmap:P,ImageData:P,HTMLImageArray:!1,HTMLVideo:R}}};function de(ue,ve,xe,Re){if(!ue)throw new Error("type missing");if(!ve)throw new Error("dynamic missing");if(!xe)throw new Error("precision missing");Re.type&&(ue=Re.type);const Ue=oe[xe][ve];if(Ue[ue]===!1)return null;if(Ue[ue]===void 0)throw new Error(`Could not find a KernelValue for ${ue}`);return Ue[ue]}y.exports={lookupKernelValueType:de,kernelValueMaps:oe}},{"./kernel-value/array2":41,"./kernel-value/array3":42,"./kernel-value/array4":43,"./kernel-value/boolean":44,"./kernel-value/dynamic-html-image":45,"./kernel-value/dynamic-html-video":46,"./kernel-value/dynamic-memory-optimized-number-texture":47,"./kernel-value/dynamic-number-texture":48,"./kernel-value/dynamic-single-array":49,"./kernel-value/dynamic-single-array1d-i":50,"./kernel-value/dynamic-single-array2d-i":51,"./kernel-value/dynamic-single-array3d-i":52,"./kernel-value/dynamic-single-input":53,"./kernel-value/dynamic-unsigned-array":54,"./kernel-value/dynamic-unsigned-input":55,"./kernel-value/float":56,"./kernel-value/html-image":57,"./kernel-value/html-video":58,"./kernel-value/integer":60,"./kernel-value/memory-optimized-number-texture":61,"./kernel-value/number-texture":62,"./kernel-value/single-array":63,"./kernel-value/single-array1d-i":64,"./kernel-value/single-array2d-i":65,"./kernel-value/single-array3d-i":66,"./kernel-value/single-input":67,"./kernel-value/unsigned-array":68,"./kernel-value/unsigned-input":69}],40:[function(p,y,N){const{WebGLKernelValue:L}=p("./index"),{Input:F}=p("../../../input");class z extends L{checkSize(k,R){if(!this.kernel.validate)return;const{maxTextureSize:S}=this.kernel.constructor.features;if(k>S||R>S)throw k>R?new Error(`Argument texture width of ${k} larger than maximum size of ${S} for your GPU`):k<R?new Error(`Argument texture height of ${R} larger than maximum size of ${S} for your GPU`):new Error(`Argument texture height and width of ${R} larger than maximum size of ${S} for your GPU`)}setup(){this.requestTexture(),this.setupTexture(),this.defineTexture()}requestTexture(){this.texture=this.onRequestTexture()}defineTexture(){const{context:k}=this;k.activeTexture(this.contextHandle),k.bindTexture(k.TEXTURE_2D,this.texture),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST)}setupTexture(){this.contextHandle=this.onRequestContextHandle(),this.index=this.onRequestIndex(),this.dimensionsId=this.id+"Dim",this.sizeId=this.id+"Size"}getBitRatio(k){if(Array.isArray(k[0]))return this.getBitRatio(k[0]);if(k.constructor===F)return this.getBitRatio(k.value);switch(k.constructor){case Uint8ClampedArray:case Uint8Array:case Int8Array:return 1;case Uint16Array:case Int16Array:return 2;case Float32Array:case Int32Array:default:return 4}}destroy(){this.prevArg&&this.prevArg.delete(),this.context.deleteTexture(this.texture)}}y.exports={WebGLKernelArray:z}},{"../../../input":110,"./index":59}],41:[function(p,y,N){const{WebGLKernelValue:L}=p("./index");class F extends L{constructor(P,k){super(P,k),this.uploadValue=P}getSource(P){return this.origin==="constants"?`const vec2 ${this.id} = vec2(${P[0]},${P[1]});
`:`uniform vec2 ${this.id};
`}getStringValueHandler(){return this.origin==="constants"?"":`const uploadValue_${this.name} = ${this.varName};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform2fv(this.id,this.uploadValue=P)}}y.exports={WebGLKernelValueArray2:F}},{"./index":59}],42:[function(p,y,N){const{WebGLKernelValue:L}=p("./index");class F extends L{constructor(P,k){super(P,k),this.uploadValue=P}getSource(P){return this.origin==="constants"?`const vec3 ${this.id} = vec3(${P[0]},${P[1]},${P[2]});
`:`uniform vec3 ${this.id};
`}getStringValueHandler(){return this.origin==="constants"?"":`const uploadValue_${this.name} = ${this.varName};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform3fv(this.id,this.uploadValue=P)}}y.exports={WebGLKernelValueArray3:F}},{"./index":59}],43:[function(p,y,N){const{WebGLKernelValue:L}=p("./index");class F extends L{constructor(P,k){super(P,k),this.uploadValue=P}getSource(P){return this.origin==="constants"?`const vec4 ${this.id} = vec4(${P[0]},${P[1]},${P[2]},${P[3]});
`:`uniform vec4 ${this.id};
`}getStringValueHandler(){return this.origin==="constants"?"":`const uploadValue_${this.name} = ${this.varName};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform4fv(this.id,this.uploadValue=P)}}y.exports={WebGLKernelValueArray4:F}},{"./index":59}],44:[function(p,y,N){p("../../../utils");const{WebGLKernelValue:L}=p("./index");class F extends L{constructor(P,k){super(P,k),this.uploadValue=P}getSource(P){return this.origin==="constants"?`const bool ${this.id} = ${P};
`:`uniform bool ${this.id};
`}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform1i(this.id,this.uploadValue=P)}}y.exports={WebGLKernelValueBoolean:F}},{"../../../utils":114,"./index":59}],45:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueHTMLImage:F}=p("./html-image");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){const{width:R,height:S}=k;this.checkSize(R,S),this.dimensions=[R,S,1],this.textureSize=[R,S],this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicHTMLImage:z}},{"../../../utils":114,"./html-image":57}],46:[function(p,y,N){const{WebGLKernelValueDynamicHTMLImage:L}=p("./dynamic-html-image");class F extends L{}y.exports={WebGLKernelValueDynamicHTMLVideo:F}},{"./dynamic-html-image":45}],47:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueMemoryOptimizedNumberTexture:F}=p("./memory-optimized-number-texture");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.dimensions=k.dimensions,this.checkSize(k.size[0],k.size[1]),this.textureSize=k.size,this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicMemoryOptimizedNumberTexture:z}},{"../../../utils":114,"./memory-optimized-number-texture":61}],48:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueNumberTexture:F}=p("./number-texture");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.dimensions=k.dimensions,this.checkSize(k.size[0],k.size[1]),this.textureSize=k.size,this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicNumberTexture:z}},{"../../../utils":114,"./number-texture":62}],49:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray:F}=p("./single-array");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.dimensions=L.getDimensions(k,!0),this.textureSize=L.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicSingleArray:z}},{"../../../utils":114,"./single-array":63}],50:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray1DI:F}=p("./single-array1d-i");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.setShape(k),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicSingleArray1DI:z}},{"../../../utils":114,"./single-array1d-i":64}],51:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray2DI:F}=p("./single-array2d-i");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.setShape(k),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicSingleArray2DI:z}},{"../../../utils":114,"./single-array2d-i":65}],52:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray3DI:F}=p("./single-array3d-i");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.setShape(k),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicSingleArray3DI:z}},{"../../../utils":114,"./single-array3d-i":66}],53:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleInput:F}=p("./single-input");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){let[R,S,T]=k.size;this.dimensions=new Int32Array([R||1,S||1,T||1]),this.textureSize=L.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicSingleInput:z}},{"../../../utils":114,"./single-input":67}],54:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueUnsignedArray:F}=p("./unsigned-array");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){this.dimensions=L.getDimensions(k,!0),this.textureSize=L.getMemoryOptimizedPackedTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*(4/this.bitRatio),this.checkSize(this.textureSize[0],this.textureSize[1]);const R=this.getTransferArrayType(k);this.preUploadValue=new R(this.uploadArrayLength),this.uploadValue=new Uint8Array(this.preUploadValue.buffer),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicUnsignedArray:z}},{"../../../utils":114,"./unsigned-array":68}],55:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueUnsignedInput:F}=p("./unsigned-input");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}updateValue(k){let[R,S,T]=k.size;this.dimensions=new Int32Array([R||1,S||1,T||1]),this.textureSize=L.getMemoryOptimizedPackedTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*(4/this.bitRatio),this.checkSize(this.textureSize[0],this.textureSize[1]);const H=this.getTransferArrayType(k.value);this.preUploadValue=new H(this.uploadArrayLength),this.uploadValue=new Uint8Array(this.preUploadValue.buffer),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGLKernelValueDynamicUnsignedInput:z}},{"../../../utils":114,"./unsigned-input":69}],56:[function(p,y,N){p("../../../utils");const{WebGLKernelValue:L}=p("./index");class F extends L{constructor(P,k){super(P,k),this.uploadValue=P}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName};
`}getSource(P){return this.origin==="constants"?Number.isInteger(P)?`const float ${this.id} = ${P}.0;
`:`const float ${this.id} = ${P};
`:`uniform float ${this.id};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform1f(this.id,this.uploadValue=P)}}y.exports={WebGLKernelValueFloat:F}},{"../../../utils":114,"./index":59}],57:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R);const{width:S,height:T}=k;this.checkSize(S,T),this.dimensions=[S,T,1],this.textureSize=[S,T],this.uploadValue=k}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName};
`}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!0),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,R.RGBA,R.UNSIGNED_BYTE,this.uploadValue=k),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueHTMLImage:z}},{"../../../utils":114,"./array":40}],58:[function(p,y,N){const{WebGLKernelValueHTMLImage:L}=p("./html-image");class F extends L{}y.exports={WebGLKernelValueHTMLVideo:F}},{"./html-image":57}],59:[function(p,y,N){const{utils:L}=p("../../../utils"),{KernelValue:F}=p("../../kernel-value");class z extends F{constructor(k,R){super(k,R),this.dimensionsId=null,this.sizeId=null,this.initialValueConstructor=k.constructor,this.onRequestTexture=R.onRequestTexture,this.onRequestIndex=R.onRequestIndex,this.uploadValue=null,this.textureSize=null,this.bitRatio=null,this.prevArg=null}get id(){return`${this.origin}_${L.sanitizeName(this.name)}`}setup(){}getTransferArrayType(k){if(Array.isArray(k[0]))return this.getTransferArrayType(k[0]);switch(k.constructor){case Array:case Int32Array:case Int16Array:case Int8Array:return Float32Array;case Uint8ClampedArray:case Uint8Array:case Uint16Array:case Uint32Array:case Float32Array:case Float64Array:return k.constructor}return console.warn("Unfamiliar constructor type.  Will go ahead and use, but likley this may result in a transfer of zeros"),k.constructor}getStringValueHandler(){throw new Error(`"getStringValueHandler" not implemented on ${this.constructor.name}`)}getVariablePrecisionString(){return this.kernel.getVariablePrecisionString(this.textureSize||void 0,this.tactic||void 0)}destroy(){}}y.exports={WebGLKernelValue:z}},{"../../../utils":114,"../../kernel-value":35}],60:[function(p,y,N){p("../../../utils");const{WebGLKernelValue:L}=p("./index");class F extends L{constructor(P,k){super(P,k),this.uploadValue=P}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName};
`}getSource(P){return this.origin==="constants"?`const int ${this.id} = ${parseInt(P)};
`:`uniform int ${this.id};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform1i(this.id,this.uploadValue=P)}}y.exports={WebGLKernelValueInteger:F}},{"../../../utils":114,"./index":59}],61:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array"),z="Source and destination textures are the same.  Use immutable = true and manually cleanup kernel output texture memory with texture.delete()";class P extends F{constructor(R,S){super(R,S);const[T,H]=R.size;this.checkSize(T,H),this.dimensions=R.dimensions,this.textureSize=R.size,this.uploadValue=R.texture,this.forceUploadEachRun=!0}setup(){this.setupTexture()}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName}.texture;
`}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(R){if(R.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(R.constructor);return}if(this.checkContext&&R.context!==this.context)throw new Error(`Value ${this.name} (${this.type}) must be from same context`);const{kernel:S,context:T}=this;if(S.pipeline)if(S.immutable)S.updateTextureArgumentRefs(this,R);else{if(S.texture&&S.texture.texture===R.texture)throw new Error(z);if(S.mappedTextures){const{mappedTextures:H}=S;for(let te=0;te<H.length;te++)if(H[te].texture===R.texture)throw new Error(z)}}T.activeTexture(this.contextHandle),T.bindTexture(T.TEXTURE_2D,this.uploadValue=R.texture),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueMemoryOptimizedNumberTexture:P,sameError:z}},{"../../../utils":114,"./array":40}],62:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array"),{sameError:z}=p("./memory-optimized-number-texture");class P extends F{constructor(R,S){super(R,S);const[T,H]=R.size;this.checkSize(T,H);const{size:te,dimensions:Se}=R;this.bitRatio=this.getBitRatio(R),this.dimensions=Se,this.textureSize=te,this.uploadValue=R.texture,this.forceUploadEachRun=!0}setup(){this.setupTexture()}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName}.texture;
`}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(R){if(R.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(R.constructor);return}if(this.checkContext&&R.context!==this.context)throw new Error(`Value ${this.name} (${this.type}) must be from same context`);const{kernel:S,context:T}=this;if(S.pipeline)if(S.immutable)S.updateTextureArgumentRefs(this,R);else{if(S.texture&&S.texture.texture===R.texture)throw new Error(z);if(S.mappedTextures){const{mappedTextures:H}=S;for(let te=0;te<H.length;te++)if(H[te].texture===R.texture)throw new Error(z)}}T.activeTexture(this.contextHandle),T.bindTexture(T.TEXTURE_2D,this.uploadValue=R.texture),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueNumberTexture:P}},{"../../../utils":114,"./array":40,"./memory-optimized-number-texture":61}],63:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=4,this.dimensions=L.getDimensions(k,!0),this.textureSize=L.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength)}getStringValueHandler(){return L.linesToString([`const uploadValue_${this.name} = new Float32Array(${this.uploadArrayLength})`,`flattenTo(${this.varName}, uploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueSingleArray:z}},{"../../../utils":114,"./array":40}],64:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=4,this.setShape(k)}setShape(k){const R=L.getDimensions(k,!0);this.textureSize=L.getMemoryOptimizedFloatTextureSize(R,this.bitRatio),this.dimensions=new Int32Array([R[1],1,1]),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength)}getStringValueHandler(){return L.linesToString([`const uploadValue_${this.name} = new Float32Array(${this.uploadArrayLength})`,`flattenTo(${this.varName}, uploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flatten2dArrayTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueSingleArray1DI:z}},{"../../../utils":114,"./array":40}],65:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=4,this.setShape(k)}setShape(k){const R=L.getDimensions(k,!0);this.textureSize=L.getMemoryOptimizedFloatTextureSize(R,this.bitRatio),this.dimensions=new Int32Array([R[1],R[2],1]),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength)}getStringValueHandler(){return L.linesToString([`const uploadValue_${this.name} = new Float32Array(${this.uploadArrayLength})`,`flattenTo(${this.varName}, uploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flatten3dArrayTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueSingleArray2DI:z}},{"../../../utils":114,"./array":40}],66:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=4,this.setShape(k)}setShape(k){const R=L.getDimensions(k,!0);this.textureSize=L.getMemoryOptimizedFloatTextureSize(R,this.bitRatio),this.dimensions=new Int32Array([R[1],R[2],R[3]]),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength)}getStringValueHandler(){return L.linesToString([`const uploadValue_${this.name} = new Float32Array(${this.uploadArrayLength})`,`flattenTo(${this.varName}, uploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flatten4dArrayTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueSingleArray3DI:z}},{"../../../utils":114,"./array":40}],67:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=4;let[S,T,H]=k.size;this.dimensions=new Int32Array([S||1,T||1,H||1]),this.textureSize=L.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength)}getStringValueHandler(){return L.linesToString([`const uploadValue_${this.name} = new Float32Array(${this.uploadArrayLength})`,`flattenTo(${this.varName}.value, uploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k.value,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueSingleInput:z}},{"../../../utils":114,"./array":40}],68:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=this.getBitRatio(k),this.dimensions=L.getDimensions(k,!0),this.textureSize=L.getMemoryOptimizedPackedTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*(4/this.bitRatio),this.checkSize(this.textureSize[0],this.textureSize[1]),this.TranserArrayType=this.getTransferArrayType(k),this.preUploadValue=new this.TranserArrayType(this.uploadArrayLength),this.uploadValue=new Uint8Array(this.preUploadValue.buffer)}getStringValueHandler(){return L.linesToString([`const preUploadValue_${this.name} = new ${this.TranserArrayType.name}(${this.uploadArrayLength})`,`const uploadValue_${this.name} = new Uint8Array(preUploadValue_${this.name}.buffer)`,`flattenTo(${this.varName}, preUploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k,this.preUploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.UNSIGNED_BYTE,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueUnsignedArray:z}},{"../../../utils":114,"./array":40}],69:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("./array");class z extends F{constructor(k,R){super(k,R),this.bitRatio=this.getBitRatio(k);const[S,T,H]=k.size;this.dimensions=new Int32Array([S||1,T||1,H||1]),this.textureSize=L.getMemoryOptimizedPackedTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*(4/this.bitRatio),this.checkSize(this.textureSize[0],this.textureSize[1]),this.TranserArrayType=this.getTransferArrayType(k.value),this.preUploadValue=new this.TranserArrayType(this.uploadArrayLength),this.uploadValue=new Uint8Array(this.preUploadValue.buffer)}getStringValueHandler(){return L.linesToString([`const preUploadValue_${this.name} = new ${this.TranserArrayType.name}(${this.uploadArrayLength})`,`const uploadValue_${this.name} = new Uint8Array(preUploadValue_${this.name}.buffer)`,`flattenTo(${this.varName}.value, preUploadValue_${this.name})`])}getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(value.constructor);return}const{context:R}=this;L.flattenTo(k.value,this.preUploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.UNSIGNED_BYTE,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGLKernelValueUnsignedInput:z}},{"../../../utils":114,"./array":40}],70:[function(p,y,N){const{GLKernel:L}=p("../gl/kernel"),{FunctionBuilder:F}=p("../function-builder"),{WebGLFunctionNode:z}=p("./function-node"),{utils:P}=p("../../utils"),k=p("../../plugins/math-random-uniformly-distributed"),{fragmentShader:R}=p("./fragment-shader"),{vertexShader:S}=p("./vertex-shader"),{glKernelString:T}=p("../gl/kernel-string"),{lookupKernelValueType:H}=p("./kernel-value-maps");let te=null,Se=null,ie=null,_e=null,Y=null;const re=[k],be=[],ke={};class it extends L{static get isSupported(){return te!==null||(this.setupFeatureChecks(),te=this.isContextMatch(ie)),te}static setupFeatureChecks(){typeof document<"u"?Se=document.createElement("canvas"):typeof OffscreenCanvas<"u"&&(Se=new OffscreenCanvas(0,0)),Se&&(ie=Se.getContext("webgl")||Se.getContext("experimental-webgl"),!(!ie||!ie.getExtension)&&(_e={OES_texture_float:ie.getExtension("OES_texture_float"),OES_texture_float_linear:ie.getExtension("OES_texture_float_linear"),OES_element_index_uint:ie.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:ie.getExtension("WEBGL_draw_buffers")},Y=this.getFeatures()))}static isContextMatch(Q){return typeof WebGLRenderingContext<"u"?Q instanceof WebGLRenderingContext:!1}static getIsTextureFloat(){return!!_e.OES_texture_float}static getIsDrawBuffers(){return!!_e.WEBGL_draw_buffers}static getChannelCount(){return _e.WEBGL_draw_buffers?ie.getParameter(_e.WEBGL_draw_buffers.MAX_DRAW_BUFFERS_WEBGL):1}static getMaxTextureSize(){return ie.getParameter(ie.MAX_TEXTURE_SIZE)}static lookupKernelValueType(Q,U,Oe,Fe){return H(Q,U,Oe,Fe)}static get testCanvas(){return Se}static get testContext(){return ie}static get features(){return Y}static get fragmentShader(){return R}static get vertexShader(){return S}constructor(Q,U){super(Q,U),this.program=null,this.pipeline=U.pipeline,this.endianness=P.systemEndianness(),this.extensions={},this.argumentTextureCount=0,this.constantTextureCount=0,this.fragShader=null,this.vertShader=null,this.drawBuffersMap=null,this.maxTexSize=null,this.onRequestSwitchKernel=null,this.texture=null,this.mappedTextures=null,this.mergeSettings(Q.settings||U),this.threadDim=null,this.framebuffer=null,this.buffer=null,this.textureCache=[],this.programUniformLocationCache={},this.uniform1fCache={},this.uniform1iCache={},this.uniform2fCache={},this.uniform2fvCache={},this.uniform2ivCache={},this.uniform3fvCache={},this.uniform3ivCache={},this.uniform4fvCache={},this.uniform4ivCache={}}initCanvas(){if(typeof document<"u"){const Q=document.createElement("canvas");return Q.width=2,Q.height=2,Q}else if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(0,0)}initContext(){const Q={alpha:!1,depth:!1,antialias:!1};return this.canvas.getContext("webgl",Q)||this.canvas.getContext("experimental-webgl",Q)}initPlugins(Q){const U=[],{source:Oe}=this;if(typeof Oe=="string")for(let Fe=0;Fe<re.length;Fe++){const bt=re[Fe];Oe.match(bt.functionMatch)&&U.push(bt)}else if(typeof Oe=="object"&&Q.pluginNames)for(let Fe=0;Fe<re.length;Fe++){const bt=re[Fe];Q.pluginNames.some(I=>I===bt.name)&&U.push(bt)}return U}initExtensions(){this.extensions={OES_texture_float:this.context.getExtension("OES_texture_float"),OES_texture_float_linear:this.context.getExtension("OES_texture_float_linear"),OES_element_index_uint:this.context.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:this.context.getExtension("WEBGL_draw_buffers"),WEBGL_color_buffer_float:this.context.getExtension("WEBGL_color_buffer_float")}}validateSettings(Q){if(!this.validate){this.texSize=P.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output);return}const{features:U}=this.constructor;if(this.optimizeFloatMemory===!0&&!U.isTextureFloat)throw new Error("Float textures are not supported");if(this.precision==="single"&&!U.isFloatRead)throw new Error("Single precision not supported");if(!this.graphical&&this.precision===null&&U.isTextureFloat&&(this.precision=U.isFloatRead?"single":"unsigned"),this.subKernels&&this.subKernels.length>0&&!this.extensions.WEBGL_draw_buffers)throw new Error("could not instantiate draw buffers extension");if(this.fixIntegerDivisionAccuracy===null?this.fixIntegerDivisionAccuracy=!U.isIntegerDivisionAccurate:this.fixIntegerDivisionAccuracy&&U.isIntegerDivisionAccurate&&(this.fixIntegerDivisionAccuracy=!1),this.checkOutput(),!this.output||this.output.length===0){if(Q.length!==1)throw new Error("Auto output only supported for kernels with only one input");const Oe=P.getVariableType(Q[0],this.strictIntegers);switch(Oe){case"Array":this.output=P.getDimensions(Oe);break;case"NumberTexture":case"MemoryOptimizedNumberTexture":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":this.output=Q[0].output;break;default:throw new Error("Auto output not supported for input type: "+Oe)}}if(this.graphical){if(this.output.length!==2)throw new Error("Output must have 2 dimensions on graphical mode");this.precision==="precision"&&(this.precision="unsigned",console.warn("Cannot use graphical mode and single precision at the same time")),this.texSize=P.clone(this.output);return}else this.precision===null&&U.isTextureFloat&&(this.precision="single");this.texSize=P.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output),this.checkTextureSize()}updateMaxTexSize(){const{texSize:Q,canvas:U}=this;if(this.maxTexSize===null){let Oe=be.indexOf(U);Oe===-1&&(Oe=be.length,be.push(U),ke[Oe]=[Q[0],Q[1]]),this.maxTexSize=ke[Oe]}this.maxTexSize[0]<Q[0]&&(this.maxTexSize[0]=Q[0]),this.maxTexSize[1]<Q[1]&&(this.maxTexSize[1]=Q[1])}setupArguments(Q){this.kernelArguments=[],this.argumentTextureCount=0;const U=this.argumentTypes===null;if(U&&(this.argumentTypes=[]),this.argumentSizes=[],this.argumentBitRatios=[],Q.length<this.argumentNames.length)throw new Error("not enough arguments for kernel");if(Q.length>this.argumentNames.length)throw new Error("too many arguments for kernel");const{context:Oe}=this;let Fe=0;const bt=()=>this.createTexture(),v=()=>this.constantTextureCount+Fe++,I=G=>{this.switchKernels({type:"argumentMismatch",needed:G})},M=()=>Oe.TEXTURE0+this.constantTextureCount+this.argumentTextureCount++;for(let G=0;G<Q.length;G++){const oe=Q[G],de=this.argumentNames[G];let ue;U?(ue=P.getVariableType(oe,this.strictIntegers),this.argumentTypes.push(ue)):ue=this.argumentTypes[G];const ve=this.constructor.lookupKernelValueType(ue,this.dynamicArguments?"dynamic":"static",this.precision,Q[G]);if(ve===null)return this.requestFallback(Q);const xe=new ve(oe,{name:de,type:ue,tactic:this.tactic,origin:"user",context:Oe,checkContext:this.checkContext,kernel:this,strictIntegers:this.strictIntegers,onRequestTexture:bt,onRequestIndex:v,onUpdateValueMismatch:I,onRequestContextHandle:M});this.kernelArguments.push(xe),xe.setup(),this.argumentSizes.push(xe.textureSize),this.argumentBitRatios[G]=xe.bitRatio}}createTexture(){const Q=this.context.createTexture();return this.textureCache.push(Q),Q}setupConstants(Q){const{context:U}=this;this.kernelConstants=[],this.forceUploadKernelConstants=[];let Oe=this.constantTypes===null;Oe&&(this.constantTypes={}),this.constantBitRatios={};let Fe=0;for(const bt in this.constants){const v=this.constants[bt];let I;Oe?(I=P.getVariableType(v,this.strictIntegers),this.constantTypes[bt]=I):I=this.constantTypes[bt];const M=this.constructor.lookupKernelValueType(I,"static",this.precision,v);if(M===null)return this.requestFallback(Q);const G=new M(v,{name:bt,type:I,tactic:this.tactic,origin:"constants",context:this.context,checkContext:this.checkContext,kernel:this,strictIntegers:this.strictIntegers,onRequestTexture:()=>this.createTexture(),onRequestIndex:()=>Fe++,onRequestContextHandle:()=>U.TEXTURE0+this.constantTextureCount++});this.constantBitRatios[bt]=G.bitRatio,this.kernelConstants.push(G),G.setup(),G.forceUploadEachRun&&this.forceUploadKernelConstants.push(G)}}build(){if(this.built||(this.initExtensions(),this.validateSettings(arguments),this.setupConstants(arguments),this.fallbackRequested)||(this.setupArguments(arguments),this.fallbackRequested))return;this.updateMaxTexSize(),this.translateSource();const Q=this.pickRenderStrategy(arguments);if(Q)return Q;const{texSize:U,context:Oe,canvas:Fe}=this;Oe.enable(Oe.SCISSOR_TEST),this.pipeline&&this.precision==="single"?(Oe.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),Fe.width=this.maxTexSize[0],Fe.height=this.maxTexSize[1]):(Oe.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),Fe.width=this.maxTexSize[0],Fe.height=this.maxTexSize[1]);const bt=this.threadDim=Array.from(this.output);for(;bt.length<3;)bt.push(1);const v=this.getVertexShader(arguments),I=Oe.createShader(Oe.VERTEX_SHADER);Oe.shaderSource(I,v),Oe.compileShader(I),this.vertShader=I;const M=this.getFragmentShader(arguments),G=Oe.createShader(Oe.FRAGMENT_SHADER);if(Oe.shaderSource(G,M),Oe.compileShader(G),this.fragShader=G,this.debug&&(console.log("GLSL Shader Output:"),console.log(M)),!Oe.getShaderParameter(I,Oe.COMPILE_STATUS))throw new Error("Error compiling vertex shader: "+Oe.getShaderInfoLog(I));if(!Oe.getShaderParameter(G,Oe.COMPILE_STATUS))throw new Error("Error compiling fragment shader: "+Oe.getShaderInfoLog(G));const oe=this.program=Oe.createProgram();Oe.attachShader(oe,I),Oe.attachShader(oe,G),Oe.linkProgram(oe),this.framebuffer=Oe.createFramebuffer(),this.framebuffer.width=U[0],this.framebuffer.height=U[1],this.rawValueFramebuffers={};const de=new Float32Array([-1,-1,1,-1,-1,1,1,1]),ue=new Float32Array([0,0,1,0,0,1,1,1]),ve=de.byteLength;let xe=this.buffer;xe?Oe.bindBuffer(Oe.ARRAY_BUFFER,xe):(xe=this.buffer=Oe.createBuffer(),Oe.bindBuffer(Oe.ARRAY_BUFFER,xe),Oe.bufferData(Oe.ARRAY_BUFFER,de.byteLength+ue.byteLength,Oe.STATIC_DRAW)),Oe.bufferSubData(Oe.ARRAY_BUFFER,0,de),Oe.bufferSubData(Oe.ARRAY_BUFFER,ve,ue);const Re=Oe.getAttribLocation(this.program,"aPos");Oe.enableVertexAttribArray(Re),Oe.vertexAttribPointer(Re,2,Oe.FLOAT,!1,0,0);const Ue=Oe.getAttribLocation(this.program,"aTexCoord");Oe.enableVertexAttribArray(Ue),Oe.vertexAttribPointer(Ue,2,Oe.FLOAT,!1,0,ve),Oe.bindFramebuffer(Oe.FRAMEBUFFER,this.framebuffer);let Xe=0;Oe.useProgram(this.program);for(let Ae in this.constants)this.kernelConstants[Xe++].updateValue(this.constants[Ae]);this._setupOutputTexture(),this.subKernels!==null&&this.subKernels.length>0&&(this._mappedTextureSwitched={},this._setupSubOutputTextures()),this.buildSignature(arguments),this.built=!0}translateSource(){const Q=F.fromKernel(this,z,{fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy});this.translatedSource=Q.getPrototypeString("kernel"),this.setupReturnTypes(Q)}setupReturnTypes(Q){if(!this.graphical&&!this.returnType&&(this.returnType=Q.getKernelResultType()),this.subKernels&&this.subKernels.length>0)for(let U=0;U<this.subKernels.length;U++){const Oe=this.subKernels[U];Oe.returnType||(Oe.returnType=Q.getSubKernelResultType(U))}}run(){const{kernelArguments:Q,texSize:U,forceUploadKernelConstants:Oe,context:Fe}=this;Fe.useProgram(this.program),Fe.scissor(0,0,U[0],U[1]),this.dynamicOutput&&(this.setUniform3iv("uOutputDim",new Int32Array(this.threadDim)),this.setUniform2iv("uTexSize",U)),this.setUniform2f("ratio",U[0]/this.maxTexSize[0],U[1]/this.maxTexSize[1]);for(let bt=0;bt<Oe.length;bt++){const v=Oe[bt];if(v.updateValue(this.constants[v.name]),this.switchingKernels)return}for(let bt=0;bt<Q.length;bt++)if(Q[bt].updateValue(arguments[bt]),this.switchingKernels)return;if(this.plugins)for(let bt=0;bt<this.plugins.length;bt++){const v=this.plugins[bt];v.onBeforeRun&&v.onBeforeRun(this)}if(this.graphical){if(this.pipeline)return Fe.bindRenderbuffer(Fe.RENDERBUFFER,null),Fe.bindFramebuffer(Fe.FRAMEBUFFER,this.framebuffer),this.immutable&&this._replaceOutputTexture(),Fe.drawArrays(Fe.TRIANGLE_STRIP,0,4),this.immutable?this.texture.clone():this.texture;Fe.bindRenderbuffer(Fe.RENDERBUFFER,null),Fe.bindFramebuffer(Fe.FRAMEBUFFER,null),Fe.drawArrays(Fe.TRIANGLE_STRIP,0,4);return}Fe.bindFramebuffer(Fe.FRAMEBUFFER,this.framebuffer),this.immutable&&this._replaceOutputTexture(),this.subKernels!==null&&(this.immutable&&this._replaceSubOutputTextures(),this.drawBuffers()),Fe.drawArrays(Fe.TRIANGLE_STRIP,0,4)}drawBuffers(){this.extensions.WEBGL_draw_buffers.drawBuffersWEBGL(this.drawBuffersMap)}getInternalFormat(){return this.context.RGBA}getTextureFormat(){const{context:Q}=this;switch(this.getInternalFormat()){case Q.RGBA:return Q.RGBA;default:throw new Error("Unknown internal format")}}_replaceOutputTexture(){if(this.texture.beforeMutate()||this._textureSwitched){const Q=this.context;Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,this.texture.texture,0),this._textureSwitched=!1}}_setupOutputTexture(){const Q=this.context,U=this.texSize;if(this.texture){Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,this.texture.texture,0);return}const Oe=this.createTexture();Q.activeTexture(Q.TEXTURE0+this.constantTextureCount+this.argumentTextureCount),Q.bindTexture(Q.TEXTURE_2D,Oe),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.NEAREST),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.NEAREST);const Fe=this.getInternalFormat();this.precision==="single"?Q.texImage2D(Q.TEXTURE_2D,0,Fe,U[0],U[1],0,Q.RGBA,Q.FLOAT,null):Q.texImage2D(Q.TEXTURE_2D,0,Fe,U[0],U[1],0,Fe,Q.UNSIGNED_BYTE,null),Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Oe,0),this.texture=new this.TextureConstructor({texture:Oe,size:U,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat(),kernel:this})}_replaceSubOutputTextures(){const Q=this.context;for(let U=0;U<this.mappedTextures.length;U++){const Oe=this.mappedTextures[U];(Oe.beforeMutate()||this._mappedTextureSwitched[U])&&(Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0+U+1,Q.TEXTURE_2D,Oe.texture,0),this._mappedTextureSwitched[U]=!1)}}_setupSubOutputTextures(){const Q=this.context;if(this.mappedTextures){for(let Oe=0;Oe<this.subKernels.length;Oe++)Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0+Oe+1,Q.TEXTURE_2D,this.mappedTextures[Oe].texture,0);return}const U=this.texSize;this.drawBuffersMap=[Q.COLOR_ATTACHMENT0],this.mappedTextures=[];for(let Oe=0;Oe<this.subKernels.length;Oe++){const Fe=this.createTexture();this.drawBuffersMap.push(Q.COLOR_ATTACHMENT0+Oe+1),Q.activeTexture(Q.TEXTURE0+this.constantTextureCount+this.argumentTextureCount+Oe),Q.bindTexture(Q.TEXTURE_2D,Fe),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.NEAREST),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.NEAREST),this.precision==="single"?Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,U[0],U[1],0,Q.RGBA,Q.FLOAT,null):Q.texImage2D(Q.TEXTURE_2D,0,Q.RGBA,U[0],U[1],0,Q.RGBA,Q.UNSIGNED_BYTE,null),Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0+Oe+1,Q.TEXTURE_2D,Fe,0),this.mappedTextures.push(new this.TextureConstructor({texture:Fe,size:U,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat(),kernel:this}))}}setUniform1f(Q,U){if(this.uniform1fCache.hasOwnProperty(Q)){const Fe=this.uniform1fCache[Q];if(U===Fe)return}this.uniform1fCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform1f(Oe,U)}setUniform1i(Q,U){if(this.uniform1iCache.hasOwnProperty(Q)){const Fe=this.uniform1iCache[Q];if(U===Fe)return}this.uniform1iCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform1i(Oe,U)}setUniform2f(Q,U,Oe){if(this.uniform2fCache.hasOwnProperty(Q)){const bt=this.uniform2fCache[Q];if(U===bt[0]&&Oe===bt[1])return}this.uniform2fCache[Q]=[U,Oe];const Fe=this.getUniformLocation(Q);this.context.uniform2f(Fe,U,Oe)}setUniform2fv(Q,U){if(this.uniform2fvCache.hasOwnProperty(Q)){const Fe=this.uniform2fvCache[Q];if(U[0]===Fe[0]&&U[1]===Fe[1])return}this.uniform2fvCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform2fv(Oe,U)}setUniform2iv(Q,U){if(this.uniform2ivCache.hasOwnProperty(Q)){const Fe=this.uniform2ivCache[Q];if(U[0]===Fe[0]&&U[1]===Fe[1])return}this.uniform2ivCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform2iv(Oe,U)}setUniform3fv(Q,U){if(this.uniform3fvCache.hasOwnProperty(Q)){const Fe=this.uniform3fvCache[Q];if(U[0]===Fe[0]&&U[1]===Fe[1]&&U[2]===Fe[2])return}this.uniform3fvCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform3fv(Oe,U)}setUniform3iv(Q,U){if(this.uniform3ivCache.hasOwnProperty(Q)){const Fe=this.uniform3ivCache[Q];if(U[0]===Fe[0]&&U[1]===Fe[1]&&U[2]===Fe[2])return}this.uniform3ivCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform3iv(Oe,U)}setUniform4fv(Q,U){if(this.uniform4fvCache.hasOwnProperty(Q)){const Fe=this.uniform4fvCache[Q];if(U[0]===Fe[0]&&U[1]===Fe[1]&&U[2]===Fe[2]&&U[3]===Fe[3])return}this.uniform4fvCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform4fv(Oe,U)}setUniform4iv(Q,U){if(this.uniform4ivCache.hasOwnProperty(Q)){const Fe=this.uniform4ivCache[Q];if(U[0]===Fe[0]&&U[1]===Fe[1]&&U[2]===Fe[2]&&U[3]===Fe[3])return}this.uniform4ivCache[Q]=U;const Oe=this.getUniformLocation(Q);this.context.uniform4iv(Oe,U)}getUniformLocation(Q){return this.programUniformLocationCache.hasOwnProperty(Q)?this.programUniformLocationCache[Q]:this.programUniformLocationCache[Q]=this.context.getUniformLocation(this.program,Q)}_getFragShaderArtifactMap(Q){return{HEADER:this._getHeaderString(),LOOP_MAX:this._getLoopMaxString(),PLUGINS:this._getPluginsString(),CONSTANTS:this._getConstantsString(),DECODE32_ENDIANNESS:this._getDecode32EndiannessString(),ENCODE32_ENDIANNESS:this._getEncode32EndiannessString(),DIVIDE_WITH_INTEGER_CHECK:this._getDivideWithIntegerCheckString(),INJECTED_NATIVE:this._getInjectedNative(),MAIN_CONSTANTS:this._getMainConstantsString(),MAIN_ARGUMENTS:this._getMainArgumentsString(Q),KERNEL:this.getKernelString(),MAIN_RESULT:this.getMainResultString(),FLOAT_TACTIC_DECLARATION:this.getFloatTacticDeclaration(),INT_TACTIC_DECLARATION:this.getIntTacticDeclaration(),SAMPLER_2D_TACTIC_DECLARATION:this.getSampler2DTacticDeclaration(),SAMPLER_2D_ARRAY_TACTIC_DECLARATION:this.getSampler2DArrayTacticDeclaration()}}_getVertShaderArtifactMap(Q){return{FLOAT_TACTIC_DECLARATION:this.getFloatTacticDeclaration(),INT_TACTIC_DECLARATION:this.getIntTacticDeclaration(),SAMPLER_2D_TACTIC_DECLARATION:this.getSampler2DTacticDeclaration(),SAMPLER_2D_ARRAY_TACTIC_DECLARATION:this.getSampler2DArrayTacticDeclaration()}}_getHeaderString(){return this.subKernels!==null?`#extension GL_EXT_draw_buffers : require
`:""}_getLoopMaxString(){return this.loopMaxIterations?` ${parseInt(this.loopMaxIterations)};
`:` 1000;
`}_getPluginsString(){return this.plugins?this.plugins.map(Q=>Q.source&&this.source.match(Q.functionMatch)?Q.source:"").join(`
`):`
`}_getConstantsString(){const Q=[],{threadDim:U,texSize:Oe}=this;return this.dynamicOutput?Q.push("uniform ivec3 uOutputDim","uniform ivec2 uTexSize"):Q.push(`ivec3 uOutputDim = ivec3(${U[0]}, ${U[1]}, ${U[2]})`,`ivec2 uTexSize = ivec2(${Oe[0]}, ${Oe[1]})`),P.linesToString(Q)}_getTextureCoordinate(){const Q=this.subKernels;return Q===null||Q.length<1?`varying vec2 vTexCoord;
`:`out vec2 vTexCoord;
`}_getDecode32EndiannessString(){return this.endianness==="LE"?"":`  texel.rgba = texel.abgr;
`}_getEncode32EndiannessString(){return this.endianness==="LE"?"":`  texel.rgba = texel.abgr;
`}_getDivideWithIntegerCheckString(){return this.fixIntegerDivisionAccuracy?`float divWithIntCheck(float x, float y) {
  if (floor(x) == x && floor(y) == y && integerMod(x, y) == 0.0) {
    return float(int(x) / int(y));
  }
  return x / y;
}

float integerCorrectionModulo(float number, float divisor) {
  if (number < 0.0) {
    number = abs(number);
    if (divisor < 0.0) {
      divisor = abs(divisor);
    }
    return -(number - (divisor * floor(divWithIntCheck(number, divisor))));
  }
  if (divisor < 0.0) {
    divisor = abs(divisor);
  }
  return number - (divisor * floor(divWithIntCheck(number, divisor)));
}`:""}_getMainArgumentsString(Q){const U=[],{argumentNames:Oe}=this;for(let Fe=0;Fe<Oe.length;Fe++)U.push(this.kernelArguments[Fe].getSource(Q[Fe]));return U.join("")}_getInjectedNative(){return this.injectedNative||""}_getMainConstantsString(){const Q=[],{constants:U}=this;if(U){let Oe=0;for(const Fe in U)this.constants.hasOwnProperty(Fe)&&Q.push(this.kernelConstants[Oe++].getSource(this.constants[Fe]))}return Q.join("")}getRawValueFramebuffer(Q,U){if(this.rawValueFramebuffers[Q]||(this.rawValueFramebuffers[Q]={}),!this.rawValueFramebuffers[Q][U]){const Oe=this.context.createFramebuffer();Oe.width=Q,Oe.height=U,this.rawValueFramebuffers[Q][U]=Oe}return this.rawValueFramebuffers[Q][U]}getKernelResultDeclaration(){switch(this.returnType){case"Array(2)":return"vec2 kernelResult";case"Array(3)":return"vec3 kernelResult";case"Array(4)":return"vec4 kernelResult";case"LiteralInteger":case"Float":case"Number":case"Integer":return"float kernelResult";default:if(this.graphical)return"float kernelResult";throw new Error(`unrecognized output type "${this.returnType}"`)}}getKernelString(){const Q=[this.getKernelResultDeclaration()],{subKernels:U}=this;if(U!==null)switch(this.returnType){case"Number":case"Float":case"Integer":for(let Oe=0;Oe<U.length;Oe++){const Fe=U[Oe];Q.push(Fe.returnType==="Integer"?`int subKernelResult_${Fe.name} = 0`:`float subKernelResult_${Fe.name} = 0.0`)}break;case"Array(2)":for(let Oe=0;Oe<U.length;Oe++)Q.push(`vec2 subKernelResult_${U[Oe].name}`);break;case"Array(3)":for(let Oe=0;Oe<U.length;Oe++)Q.push(`vec3 subKernelResult_${U[Oe].name}`);break;case"Array(4)":for(let Oe=0;Oe<U.length;Oe++)Q.push(`vec4 subKernelResult_${U[Oe].name}`);break}return P.linesToString(Q)+this.translatedSource}getMainResultGraphical(){return P.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor = actualColor"])}getMainResultPackedPixels(){switch(this.returnType){case"LiteralInteger":case"Number":case"Integer":case"Float":return this.getMainResultKernelPackedPixels()+this.getMainResultSubKernelPackedPixels();default:throw new Error(`packed output only usable with Numbers, "${this.returnType}" specified`)}}getMainResultKernelPackedPixels(){return P.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()",`  gl_FragData[0] = ${this.useLegacyEncoder?"legacyEncode32":"encode32"}(kernelResult)`])}getMainResultSubKernelPackedPixels(){const Q=[];if(!this.subKernels)return"";for(let U=0;U<this.subKernels.length;U++)this.subKernels[U].returnType==="Integer"?Q.push(`  gl_FragData[${U+1}] = ${this.useLegacyEncoder?"legacyEncode32":"encode32"}(float(subKernelResult_${this.subKernels[U].name}))`):Q.push(`  gl_FragData[${U+1}] = ${this.useLegacyEncoder?"legacyEncode32":"encode32"}(subKernelResult_${this.subKernels[U].name})`);return P.linesToString(Q)}getMainResultMemoryOptimizedFloats(){const Q=["  index *= 4"];switch(this.returnType){case"Number":case"Integer":case"Float":const U=["r","g","b","a"];for(let Oe=0;Oe<U.length;Oe++){const Fe=U[Oe];this.getMainResultKernelMemoryOptimizedFloats(Q,Fe),this.getMainResultSubKernelMemoryOptimizedFloats(Q,Fe),Oe+1<U.length&&Q.push("  index += 1")}break;default:throw new Error(`optimized output only usable with Numbers, ${this.returnType} specified`)}return P.linesToString(Q)}getMainResultKernelMemoryOptimizedFloats(Q,U){Q.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()",`  gl_FragData[0].${U} = kernelResult`)}getMainResultSubKernelMemoryOptimizedFloats(Q,U){if(!this.subKernels)return Q;for(let Oe=0;Oe<this.subKernels.length;Oe++)this.subKernels[Oe].returnType==="Integer"?Q.push(`  gl_FragData[${Oe+1}].${U} = float(subKernelResult_${this.subKernels[Oe].name})`):Q.push(`  gl_FragData[${Oe+1}].${U} = subKernelResult_${this.subKernels[Oe].name}`)}getMainResultKernelNumberTexture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0][0] = kernelResult"]}getMainResultSubKernelNumberTexture(){const Q=[];if(!this.subKernels)return Q;for(let U=0;U<this.subKernels.length;++U){const Oe=this.subKernels[U];Oe.returnType==="Integer"?Q.push(`  gl_FragData[${U+1}][0] = float(subKernelResult_${Oe.name})`):Q.push(`  gl_FragData[${U+1}][0] = subKernelResult_${Oe.name}`)}return Q}getMainResultKernelArray2Texture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0][0] = kernelResult[0]","  gl_FragData[0][1] = kernelResult[1]"]}getMainResultSubKernelArray2Texture(){const Q=[];if(!this.subKernels)return Q;for(let U=0;U<this.subKernels.length;++U)Q.push(`  gl_FragData[${U+1}][0] = subKernelResult_${this.subKernels[U].name}[0]`,`  gl_FragData[${U+1}][1] = subKernelResult_${this.subKernels[U].name}[1]`);return Q}getMainResultKernelArray3Texture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0][0] = kernelResult[0]","  gl_FragData[0][1] = kernelResult[1]","  gl_FragData[0][2] = kernelResult[2]"]}getMainResultSubKernelArray3Texture(){const Q=[];if(!this.subKernels)return Q;for(let U=0;U<this.subKernels.length;++U)Q.push(`  gl_FragData[${U+1}][0] = subKernelResult_${this.subKernels[U].name}[0]`,`  gl_FragData[${U+1}][1] = subKernelResult_${this.subKernels[U].name}[1]`,`  gl_FragData[${U+1}][2] = subKernelResult_${this.subKernels[U].name}[2]`);return Q}getMainResultKernelArray4Texture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0] = kernelResult"]}getMainResultSubKernelArray4Texture(){const Q=[];if(!this.subKernels)return Q;switch(this.returnType){case"Number":case"Float":case"Integer":for(let U=0;U<this.subKernels.length;++U)this.subKernels[U].returnType==="Integer"?Q.push(`  gl_FragData[${U+1}] = float(subKernelResult_${this.subKernels[U].name})`):Q.push(`  gl_FragData[${U+1}] = subKernelResult_${this.subKernels[U].name}`);break;case"Array(2)":for(let U=0;U<this.subKernels.length;++U)Q.push(`  gl_FragData[${U+1}][0] = subKernelResult_${this.subKernels[U].name}[0]`,`  gl_FragData[${U+1}][1] = subKernelResult_${this.subKernels[U].name}[1]`);break;case"Array(3)":for(let U=0;U<this.subKernels.length;++U)Q.push(`  gl_FragData[${U+1}][0] = subKernelResult_${this.subKernels[U].name}[0]`,`  gl_FragData[${U+1}][1] = subKernelResult_${this.subKernels[U].name}[1]`,`  gl_FragData[${U+1}][2] = subKernelResult_${this.subKernels[U].name}[2]`);break;case"Array(4)":for(let U=0;U<this.subKernels.length;++U)Q.push(`  gl_FragData[${U+1}][0] = subKernelResult_${this.subKernels[U].name}[0]`,`  gl_FragData[${U+1}][1] = subKernelResult_${this.subKernels[U].name}[1]`,`  gl_FragData[${U+1}][2] = subKernelResult_${this.subKernels[U].name}[2]`,`  gl_FragData[${U+1}][3] = subKernelResult_${this.subKernels[U].name}[3]`);break}return Q}replaceArtifacts(Q,U){return Q.replace(/[ ]*__([A-Z]+[0-9]*([_]?[A-Z]*[0-9]?)*)__;\n/g,(Oe,Fe)=>{if(U.hasOwnProperty(Fe))return U[Fe];throw`unhandled artifact ${Fe}`})}getFragmentShader(Q){return this.compiledFragmentShader!==null?this.compiledFragmentShader:this.compiledFragmentShader=this.replaceArtifacts(this.constructor.fragmentShader,this._getFragShaderArtifactMap(Q))}getVertexShader(Q){return this.compiledVertexShader!==null?this.compiledVertexShader:this.compiledVertexShader=this.replaceArtifacts(this.constructor.vertexShader,this._getVertShaderArtifactMap(Q))}toString(){const Q=P.linesToString(["const gl = context"]);return T(this.constructor,arguments,this,Q)}destroy(Q){if(!this.context)return;this.buffer&&this.context.deleteBuffer(this.buffer),this.framebuffer&&this.context.deleteFramebuffer(this.framebuffer);for(const Oe in this.rawValueFramebuffers){for(const Fe in this.rawValueFramebuffers[Oe])this.context.deleteFramebuffer(this.rawValueFramebuffers[Oe][Fe]),delete this.rawValueFramebuffers[Oe][Fe];delete this.rawValueFramebuffers[Oe]}if(this.vertShader&&this.context.deleteShader(this.vertShader),this.fragShader&&this.context.deleteShader(this.fragShader),this.program&&this.context.deleteProgram(this.program),this.texture){this.texture.delete();const Oe=this.textureCache.indexOf(this.texture.texture);Oe>-1&&this.textureCache.splice(Oe,1),this.texture=null}if(this.mappedTextures&&this.mappedTextures.length){for(let Oe=0;Oe<this.mappedTextures.length;Oe++){const Fe=this.mappedTextures[Oe];Fe.delete();const bt=this.textureCache.indexOf(Fe.texture);bt>-1&&this.textureCache.splice(bt,1)}this.mappedTextures=null}if(this.kernelArguments)for(let Oe=0;Oe<this.kernelArguments.length;Oe++)this.kernelArguments[Oe].destroy();if(this.kernelConstants)for(let Oe=0;Oe<this.kernelConstants.length;Oe++)this.kernelConstants[Oe].destroy();for(;this.textureCache.length>0;){const Oe=this.textureCache.pop();this.context.deleteTexture(Oe)}if(Q){const Oe=be.indexOf(this.canvas);Oe>=0&&(be[Oe]=null,ke[Oe]=null)}if(this.destroyExtensions(),delete this.context,delete this.canvas,!this.gpu)return;const U=this.gpu.kernels.indexOf(this);U!==-1&&this.gpu.kernels.splice(U,1)}destroyExtensions(){this.extensions.OES_texture_float=null,this.extensions.OES_texture_float_linear=null,this.extensions.OES_element_index_uint=null,this.extensions.WEBGL_draw_buffers=null}static destroyContext(Q){const U=Q.getExtension("WEBGL_lose_context");U&&U.loseContext()}toJSON(){const Q=super.toJSON();return Q.functionNodes=F.fromKernel(this,z).toJSON(),Q.settings.threadDim=this.threadDim,Q}}y.exports={WebGLKernel:it}},{"../../plugins/math-random-uniformly-distributed":112,"../../utils":114,"../function-builder":9,"../gl/kernel":13,"../gl/kernel-string":12,"./fragment-shader":37,"./function-node":38,"./kernel-value-maps":39,"./vertex-shader":71}],71:[function(p,y,N){const L=`__FLOAT_TACTIC_DECLARATION__;
__INT_TACTIC_DECLARATION__;
__SAMPLER_2D_TACTIC_DECLARATION__;

attribute vec2 aPos;
attribute vec2 aTexCoord;

varying vec2 vTexCoord;
uniform vec2 ratio;

void main(void) {
  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);
  vTexCoord = aTexCoord;
}`;y.exports={vertexShader:L}},{}],72:[function(p,y,N){const L=`#version 300 es
__HEADER__;
__FLOAT_TACTIC_DECLARATION__;
__INT_TACTIC_DECLARATION__;
__SAMPLER_2D_TACTIC_DECLARATION__;
__SAMPLER_2D_ARRAY_TACTIC_DECLARATION__;

const int LOOP_MAX = __LOOP_MAX__;

__PLUGINS__;
__CONSTANTS__;

in vec2 vTexCoord;

float atan2(float v1, float v2) {
  if (v1 == 0.0 || v2 == 0.0) return 0.0;
  return atan(v1 / v2);
}

float cbrt(float x) {
  if (x >= 0.0) {
    return pow(x, 1.0 / 3.0);
  } else {
    return -pow(x, 1.0 / 3.0);
  }
}

float expm1(float x) {
  return pow(${Math.E}, x) - 1.0; 
}

float fround(highp float x) {
  return x;
}

float imul(float v1, float v2) {
  return float(int(v1) * int(v2));
}

float log10(float x) {
  return log2(x) * (1.0 / log2(10.0));
}

float log1p(float x) {
  return log(1.0 + x);
}

float _pow(float v1, float v2) {
  if (v2 == 0.0) return 1.0;
  return pow(v1, v2);
}

float _round(float x) {
  return floor(x + 0.5);
}


const int BIT_COUNT = 32;
int modi(int x, int y) {
  return x - y * (x / y);
}

int bitwiseOr(int a, int b) {
  int result = 0;
  int n = 1;
  
  for (int i = 0; i < BIT_COUNT; i++) {
    if ((modi(a, 2) == 1) || (modi(b, 2) == 1)) {
      result += n;
    }
    a = a / 2;
    b = b / 2;
    n = n * 2;
    if(!(a > 0 || b > 0)) {
      break;
    }
  }
  return result;
}
int bitwiseXOR(int a, int b) {
  int result = 0;
  int n = 1;
  
  for (int i = 0; i < BIT_COUNT; i++) {
    if ((modi(a, 2) == 1) != (modi(b, 2) == 1)) {
      result += n;
    }
    a = a / 2;
    b = b / 2;
    n = n * 2;
    if(!(a > 0 || b > 0)) {
      break;
    }
  }
  return result;
}
int bitwiseAnd(int a, int b) {
  int result = 0;
  int n = 1;
  for (int i = 0; i < BIT_COUNT; i++) {
    if ((modi(a, 2) == 1) && (modi(b, 2) == 1)) {
      result += n;
    }
    a = a / 2;
    b = b / 2;
    n = n * 2;
    if(!(a > 0 && b > 0)) {
      break;
    }
  }
  return result;
}
int bitwiseNot(int a) {
  int result = 0;
  int n = 1;
  
  for (int i = 0; i < BIT_COUNT; i++) {
    if (modi(a, 2) == 0) {
      result += n;    
    }
    a = a / 2;
    n = n * 2;
  }
  return result;
}
int bitwiseZeroFillLeftShift(int n, int shift) {
  int maxBytes = BIT_COUNT;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (maxBytes >= n) {
      break;
    }
    maxBytes *= 2;
  }
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= shift) {
      break;
    }
    n *= 2;
  }

  int result = 0;
  int byteVal = 1;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= maxBytes) break;
    if (modi(n, 2) > 0) { result += byteVal; }
    n = int(n / 2);
    byteVal *= 2;
  }
  return result;
}

int bitwiseSignedRightShift(int num, int shifts) {
  return int(floor(float(num) / pow(2.0, float(shifts))));
}

int bitwiseZeroFillRightShift(int n, int shift) {
  int maxBytes = BIT_COUNT;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (maxBytes >= n) {
      break;
    }
    maxBytes *= 2;
  }
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= shift) {
      break;
    }
    n /= 2;
  }
  int result = 0;
  int byteVal = 1;
  for (int i = 0; i < BIT_COUNT; i++) {
    if (i >= maxBytes) break;
    if (modi(n, 2) > 0) { result += byteVal; }
    n = int(n / 2);
    byteVal *= 2;
  }
  return result;
}

vec2 integerMod(vec2 x, float y) {
  vec2 res = floor(mod(x, y));
  return res * step(1.0 - floor(y), -res);
}

vec3 integerMod(vec3 x, float y) {
  vec3 res = floor(mod(x, y));
  return res * step(1.0 - floor(y), -res);
}

vec4 integerMod(vec4 x, vec4 y) {
  vec4 res = floor(mod(x, y));
  return res * step(1.0 - floor(y), -res);
}

float integerMod(float x, float y) {
  float res = floor(mod(x, y));
  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);
}

int integerMod(int x, int y) {
  return x - (y * int(x/y));
}

__DIVIDE_WITH_INTEGER_CHECK__;

// Here be dragons!
// DO NOT OPTIMIZE THIS CODE
// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE
// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME
const vec2 MAGIC_VEC = vec2(1.0, -256.0);
const vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);
const vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536
float decode32(vec4 texel) {
  __DECODE32_ENDIANNESS__;
  texel *= 255.0;
  vec2 gte128;
  gte128.x = texel.b >= 128.0 ? 1.0 : 0.0;
  gte128.y = texel.a >= 128.0 ? 1.0 : 0.0;
  float exponent = 2.0 * texel.a - 127.0 + dot(gte128, MAGIC_VEC);
  float res = exp2(round(exponent));
  texel.b = texel.b - 128.0 * gte128.x;
  res = dot(texel, SCALE_FACTOR) * exp2(round(exponent-23.0)) + res;
  res *= gte128.y * -2.0 + 1.0;
  return res;
}

float decode16(vec4 texel, int index) {
  int channel = integerMod(index, 2);
  return texel[channel*2] * 255.0 + texel[channel*2 + 1] * 65280.0;
}

float decode8(vec4 texel, int index) {
  int channel = integerMod(index, 4);
  return texel[channel] * 255.0;
}

vec4 legacyEncode32(float f) {
  float F = abs(f);
  float sign = f < 0.0 ? 1.0 : 0.0;
  float exponent = floor(log2(F));
  float mantissa = (exp2(-exponent) * F);
  // exponent += floor(log2(mantissa));
  vec4 texel = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;
  texel.rg = integerMod(texel.rg, 256.0);
  texel.b = integerMod(texel.b, 128.0);
  texel.a = exponent*0.5 + 63.5;
  texel.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;
  texel = floor(texel);
  texel *= 0.003921569; // 1/255
  __ENCODE32_ENDIANNESS__;
  return texel;
}

// https://github.com/gpujs/gpu.js/wiki/Encoder-details
vec4 encode32(float value) {
  if (value == 0.0) return vec4(0, 0, 0, 0);

  float exponent;
  float mantissa;
  vec4  result;
  float sgn;

  sgn = step(0.0, -value);
  value = abs(value);

  exponent = floor(log2(value));

  mantissa = value*pow(2.0, -exponent)-1.0;
  exponent = exponent+127.0;
  result   = vec4(0,0,0,0);

  result.a = floor(exponent/2.0);
  exponent = exponent - result.a*2.0;
  result.a = result.a + 128.0*sgn;

  result.b = floor(mantissa * 128.0);
  mantissa = mantissa - result.b / 128.0;
  result.b = result.b + exponent*128.0;

  result.g = floor(mantissa*32768.0);
  mantissa = mantissa - result.g/32768.0;

  result.r = floor(mantissa*8388608.0);
  return result/255.0;
}
// Dragons end here

int index;
ivec3 threadId;

ivec3 indexTo3D(int idx, ivec3 texDim) {
  int z = int(idx / (texDim.x * texDim.y));
  idx -= z * int(texDim.x * texDim.y);
  int y = int(idx / texDim.x);
  int x = int(integerMod(idx, texDim.x));
  return ivec3(x, y, z);
}

float get32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture(tex, st / vec2(texSize));
  return decode32(texel);
}

float get16(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + (texDim.x * (y + (texDim.y * z)));
  int w = texSize.x * 2;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture(tex, st / vec2(texSize.x * 2, texSize.y));
  return decode16(texel, index);
}

float get8(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + (texDim.x * (y + (texDim.y * z)));
  int w = texSize.x * 4;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture(tex, st / vec2(texSize.x * 4, texSize.y));
  return decode8(texel, index);
}

float getMemoryOptimized32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + (texDim.x * (y + (texDim.y * z)));
  int channel = integerMod(index, 4);
  index = index / 4;
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  index = index / 4;
  vec4 texel = texture(tex, st / vec2(texSize));
  return texel[channel];
}

vec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  return texture(tex, st / vec2(texSize));
}

vec4 getImage3D(sampler2DArray tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  return texture(tex, vec3(st / vec2(texSize), z));
}

float getFloatFromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);
  return result[0];
}

vec2 getVec2FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);
  return vec2(result[0], result[1]);
}

vec2 getMemoryOptimizedVec2(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int channel = integerMod(index, 2);
  index = index / 2;
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture(tex, st / vec2(texSize));
  if (channel == 0) return vec2(texel.r, texel.g);
  if (channel == 1) return vec2(texel.b, texel.a);
  return vec2(0.0, 0.0);
}

vec3 getVec3FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);
  return vec3(result[0], result[1], result[2]);
}

vec3 getMemoryOptimizedVec3(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int fieldIndex = 3 * (x + texDim.x * (y + texDim.y * z));
  int vectorIndex = fieldIndex / 4;
  int vectorOffset = fieldIndex - vectorIndex * 4;
  int readY = vectorIndex / texSize.x;
  int readX = vectorIndex - readY * texSize.x;
  vec4 tex1 = texture(tex, (vec2(readX, readY) + 0.5) / vec2(texSize));

  if (vectorOffset == 0) {
    return tex1.xyz;
  } else if (vectorOffset == 1) {
    return tex1.yzw;
  } else {
    readX++;
    if (readX >= texSize.x) {
      readX = 0;
      readY++;
    }
    vec4 tex2 = texture(tex, vec2(readX, readY) / vec2(texSize));
    if (vectorOffset == 2) {
      return vec3(tex1.z, tex1.w, tex2.x);
    } else {
      return vec3(tex1.w, tex2.x, tex2.y);
    }
  }
}

vec4 getVec4FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  return getImage2D(tex, texSize, texDim, z, y, x);
}

vec4 getMemoryOptimizedVec4(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {
  int index = x + texDim.x * (y + texDim.y * z);
  int channel = integerMod(index, 2);
  int w = texSize.x;
  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;
  vec4 texel = texture(tex, st / vec2(texSize));
  return vec4(texel.r, texel.g, texel.b, texel.a);
}

vec4 actualColor;
void color(float r, float g, float b, float a) {
  actualColor = vec4(r,g,b,a);
}

void color(float r, float g, float b) {
  color(r,g,b,1.0);
}

float modulo(float number, float divisor) {
  if (number < 0.0) {
    number = abs(number);
    if (divisor < 0.0) {
      divisor = abs(divisor);
    }
    return -mod(number, divisor);
  }
  if (divisor < 0.0) {
    divisor = abs(divisor);
  }
  return mod(number, divisor);
}

__INJECTED_NATIVE__;
__MAIN_CONSTANTS__;
__MAIN_ARGUMENTS__;
__KERNEL__;

void main(void) {
  index = int(vTexCoord.s * float(uTexSize.x)) + int(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;
  __MAIN_RESULT__;
}`;y.exports={fragmentShader:L}},{}],73:[function(p,y,N){const{utils:L}=p("../../utils"),{WebGLFunctionNode:F}=p("../web-gl/function-node");class z extends F{astIdentifierExpression(k,R){if(k.type!=="Identifier")throw this.astErrorOutput("IdentifierExpression - not an Identifier",k);const S=this.getType(k),T=L.sanitizeName(k.name);return k.name==="Infinity"?R.push("intBitsToFloat(2139095039)"):S==="Boolean"?this.argumentNames.indexOf(T)>-1?R.push(`bool(user_${T})`):R.push(`user_${T}`):R.push(`user_${T}`),R}}y.exports={WebGL2FunctionNode:z}},{"../../utils":114,"../web-gl/function-node":38}],74:[function(p,y,N){const{WebGL2KernelValueBoolean:L}=p("./kernel-value/boolean"),{WebGL2KernelValueFloat:F}=p("./kernel-value/float"),{WebGL2KernelValueInteger:z}=p("./kernel-value/integer"),{WebGL2KernelValueHTMLImage:P}=p("./kernel-value/html-image"),{WebGL2KernelValueDynamicHTMLImage:k}=p("./kernel-value/dynamic-html-image"),{WebGL2KernelValueHTMLImageArray:R}=p("./kernel-value/html-image-array"),{WebGL2KernelValueDynamicHTMLImageArray:S}=p("./kernel-value/dynamic-html-image-array"),{WebGL2KernelValueHTMLVideo:T}=p("./kernel-value/html-video"),{WebGL2KernelValueDynamicHTMLVideo:H}=p("./kernel-value/dynamic-html-video"),{WebGL2KernelValueSingleInput:te}=p("./kernel-value/single-input"),{WebGL2KernelValueDynamicSingleInput:Se}=p("./kernel-value/dynamic-single-input"),{WebGL2KernelValueUnsignedInput:ie}=p("./kernel-value/unsigned-input"),{WebGL2KernelValueDynamicUnsignedInput:_e}=p("./kernel-value/dynamic-unsigned-input"),{WebGL2KernelValueMemoryOptimizedNumberTexture:Y}=p("./kernel-value/memory-optimized-number-texture"),{WebGL2KernelValueDynamicMemoryOptimizedNumberTexture:re}=p("./kernel-value/dynamic-memory-optimized-number-texture"),{WebGL2KernelValueNumberTexture:be}=p("./kernel-value/number-texture"),{WebGL2KernelValueDynamicNumberTexture:ke}=p("./kernel-value/dynamic-number-texture"),{WebGL2KernelValueSingleArray:it}=p("./kernel-value/single-array"),{WebGL2KernelValueDynamicSingleArray:vt}=p("./kernel-value/dynamic-single-array"),{WebGL2KernelValueSingleArray1DI:Q}=p("./kernel-value/single-array1d-i"),{WebGL2KernelValueDynamicSingleArray1DI:U}=p("./kernel-value/dynamic-single-array1d-i"),{WebGL2KernelValueSingleArray2DI:Oe}=p("./kernel-value/single-array2d-i"),{WebGL2KernelValueDynamicSingleArray2DI:Fe}=p("./kernel-value/dynamic-single-array2d-i"),{WebGL2KernelValueSingleArray3DI:bt}=p("./kernel-value/single-array3d-i"),{WebGL2KernelValueDynamicSingleArray3DI:v}=p("./kernel-value/dynamic-single-array3d-i"),{WebGL2KernelValueArray2:I}=p("./kernel-value/array2"),{WebGL2KernelValueArray3:M}=p("./kernel-value/array3"),{WebGL2KernelValueArray4:G}=p("./kernel-value/array4"),{WebGL2KernelValueUnsignedArray:oe}=p("./kernel-value/unsigned-array"),{WebGL2KernelValueDynamicUnsignedArray:de}=p("./kernel-value/dynamic-unsigned-array"),ue={unsigned:{dynamic:{Boolean:L,Integer:z,Float:F,Array:de,"Array(2)":I,"Array(3)":M,"Array(4)":G,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:_e,NumberTexture:ke,"ArrayTexture(1)":ke,"ArrayTexture(2)":ke,"ArrayTexture(3)":ke,"ArrayTexture(4)":ke,MemoryOptimizedNumberTexture:re,HTMLCanvas:k,OffscreenCanvas:k,HTMLImage:k,ImageBitmap:k,ImageData:k,HTMLImageArray:S,HTMLVideo:H},static:{Boolean:L,Float:F,Integer:z,Array:oe,"Array(2)":I,"Array(3)":M,"Array(4)":G,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:ie,NumberTexture:be,"ArrayTexture(1)":be,"ArrayTexture(2)":be,"ArrayTexture(3)":be,"ArrayTexture(4)":be,MemoryOptimizedNumberTexture:re,HTMLCanvas:P,OffscreenCanvas:P,HTMLImage:P,ImageBitmap:P,ImageData:P,HTMLImageArray:R,HTMLVideo:T}},single:{dynamic:{Boolean:L,Integer:z,Float:F,Array:vt,"Array(2)":I,"Array(3)":M,"Array(4)":G,"Array1D(2)":U,"Array1D(3)":U,"Array1D(4)":U,"Array2D(2)":Fe,"Array2D(3)":Fe,"Array2D(4)":Fe,"Array3D(2)":v,"Array3D(3)":v,"Array3D(4)":v,Input:Se,NumberTexture:ke,"ArrayTexture(1)":ke,"ArrayTexture(2)":ke,"ArrayTexture(3)":ke,"ArrayTexture(4)":ke,MemoryOptimizedNumberTexture:re,HTMLCanvas:k,OffscreenCanvas:k,HTMLImage:k,ImageBitmap:k,ImageData:k,HTMLImageArray:S,HTMLVideo:H},static:{Boolean:L,Float:F,Integer:z,Array:it,"Array(2)":I,"Array(3)":M,"Array(4)":G,"Array1D(2)":Q,"Array1D(3)":Q,"Array1D(4)":Q,"Array2D(2)":Oe,"Array2D(3)":Oe,"Array2D(4)":Oe,"Array3D(2)":bt,"Array3D(3)":bt,"Array3D(4)":bt,Input:te,NumberTexture:be,"ArrayTexture(1)":be,"ArrayTexture(2)":be,"ArrayTexture(3)":be,"ArrayTexture(4)":be,MemoryOptimizedNumberTexture:Y,HTMLCanvas:P,OffscreenCanvas:P,HTMLImage:P,ImageBitmap:P,ImageData:P,HTMLImageArray:R,HTMLVideo:T}}};function ve(xe,Re,Ue,Xe){if(!xe)throw new Error("type missing");if(!Re)throw new Error("dynamic missing");if(!Ue)throw new Error("precision missing");Xe.type&&(xe=Xe.type);const Ae=ue[Ue][Re];if(Ae[xe]===!1)return null;if(Ae[xe]===void 0)throw new Error(`Could not find a KernelValue for ${xe}`);return Ae[xe]}y.exports={kernelValueMaps:ue,lookupKernelValueType:ve}},{"./kernel-value/array2":75,"./kernel-value/array3":76,"./kernel-value/array4":77,"./kernel-value/boolean":78,"./kernel-value/dynamic-html-image":80,"./kernel-value/dynamic-html-image-array":79,"./kernel-value/dynamic-html-video":81,"./kernel-value/dynamic-memory-optimized-number-texture":82,"./kernel-value/dynamic-number-texture":83,"./kernel-value/dynamic-single-array":84,"./kernel-value/dynamic-single-array1d-i":85,"./kernel-value/dynamic-single-array2d-i":86,"./kernel-value/dynamic-single-array3d-i":87,"./kernel-value/dynamic-single-input":88,"./kernel-value/dynamic-unsigned-array":89,"./kernel-value/dynamic-unsigned-input":90,"./kernel-value/float":91,"./kernel-value/html-image":93,"./kernel-value/html-image-array":92,"./kernel-value/html-video":94,"./kernel-value/integer":95,"./kernel-value/memory-optimized-number-texture":96,"./kernel-value/number-texture":97,"./kernel-value/single-array":98,"./kernel-value/single-array1d-i":99,"./kernel-value/single-array2d-i":100,"./kernel-value/single-array3d-i":101,"./kernel-value/single-input":102,"./kernel-value/unsigned-array":103,"./kernel-value/unsigned-input":104}],75:[function(p,y,N){const{WebGLKernelValueArray2:L}=p("../../web-gl/kernel-value/array2");class F extends L{}y.exports={WebGL2KernelValueArray2:F}},{"../../web-gl/kernel-value/array2":41}],76:[function(p,y,N){const{WebGLKernelValueArray3:L}=p("../../web-gl/kernel-value/array3");class F extends L{}y.exports={WebGL2KernelValueArray3:F}},{"../../web-gl/kernel-value/array3":42}],77:[function(p,y,N){const{WebGLKernelValueArray4:L}=p("../../web-gl/kernel-value/array4");class F extends L{}y.exports={WebGL2KernelValueArray4:F}},{"../../web-gl/kernel-value/array4":43}],78:[function(p,y,N){const{WebGLKernelValueBoolean:L}=p("../../web-gl/kernel-value/boolean");class F extends L{}y.exports={WebGL2KernelValueBoolean:F}},{"../../web-gl/kernel-value/boolean":44}],79:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGL2KernelValueHTMLImageArray:F}=p("./html-image-array");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2DArray ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}updateValue(k){const{width:R,height:S}=k[0];this.checkSize(R,S),this.dimensions=[R,S,k.length],this.textureSize=[R,S],this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGL2KernelValueDynamicHTMLImageArray:z}},{"../../../utils":114,"./html-image-array":92}],80:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueDynamicHTMLImage:F}=p("../../web-gl/kernel-value/dynamic-html-image");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}}y.exports={WebGL2KernelValueDynamicHTMLImage:z}},{"../../../utils":114,"../../web-gl/kernel-value/dynamic-html-image":45}],81:[function(p,y,N){p("../../../utils");const{WebGL2KernelValueDynamicHTMLImage:L}=p("./dynamic-html-image");class F extends L{}y.exports={WebGL2KernelValueDynamicHTMLVideo:F}},{"../../../utils":114,"./dynamic-html-image":80}],82:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueDynamicMemoryOptimizedNumberTexture:F}=p("../../web-gl/kernel-value/dynamic-memory-optimized-number-texture");class z extends F{getSource(){return L.linesToString([`uniform sampler2D ${this.id}`,`uniform ivec2 ${this.sizeId}`,`uniform ivec3 ${this.dimensionsId}`])}}y.exports={WebGL2KernelValueDynamicMemoryOptimizedNumberTexture:z}},{"../../../utils":114,"../../web-gl/kernel-value/dynamic-memory-optimized-number-texture":47}],83:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueDynamicNumberTexture:F}=p("../../web-gl/kernel-value/dynamic-number-texture");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}}y.exports={WebGL2KernelValueDynamicNumberTexture:z}},{"../../../utils":114,"../../web-gl/kernel-value/dynamic-number-texture":48}],84:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGL2KernelValueSingleArray:F}=p("../../web-gl2/kernel-value/single-array");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}updateValue(k){this.dimensions=L.getDimensions(k,!0),this.textureSize=L.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGL2KernelValueDynamicSingleArray:z}},{"../../../utils":114,"../../web-gl2/kernel-value/single-array":98}],85:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGL2KernelValueSingleArray1DI:F}=p("../../web-gl2/kernel-value/single-array1d-i");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}updateValue(k){this.setShape(k),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGL2KernelValueDynamicSingleArray1DI:z}},{"../../../utils":114,"../../web-gl2/kernel-value/single-array1d-i":99}],86:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGL2KernelValueSingleArray2DI:F}=p("../../web-gl2/kernel-value/single-array2d-i");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}updateValue(k){this.setShape(k),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGL2KernelValueDynamicSingleArray2DI:z}},{"../../../utils":114,"../../web-gl2/kernel-value/single-array2d-i":100}],87:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGL2KernelValueSingleArray3DI:F}=p("../../web-gl2/kernel-value/single-array3d-i");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}updateValue(k){this.setShape(k),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGL2KernelValueDynamicSingleArray3DI:z}},{"../../../utils":114,"../../web-gl2/kernel-value/single-array3d-i":101}],88:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGL2KernelValueSingleInput:F}=p("../../web-gl2/kernel-value/single-input");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}updateValue(k){let[R,S,T]=k.size;this.dimensions=new Int32Array([R||1,S||1,T||1]),this.textureSize=L.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0],this.textureSize[1]),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),super.updateValue(k)}}y.exports={WebGL2KernelValueDynamicSingleInput:z}},{"../../../utils":114,"../../web-gl2/kernel-value/single-input":102}],89:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueDynamicUnsignedArray:F}=p("../../web-gl/kernel-value/dynamic-unsigned-array");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}}y.exports={WebGL2KernelValueDynamicUnsignedArray:z}},{"../../../utils":114,"../../web-gl/kernel-value/dynamic-unsigned-array":54}],90:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueDynamicUnsignedInput:F}=p("../../web-gl/kernel-value/dynamic-unsigned-input");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`uniform ${k} ivec2 ${this.sizeId}`,`uniform ${k} ivec3 ${this.dimensionsId}`])}}y.exports={WebGL2KernelValueDynamicUnsignedInput:z}},{"../../../utils":114,"../../web-gl/kernel-value/dynamic-unsigned-input":55}],91:[function(p,y,N){p("../../../utils");const{WebGLKernelValueFloat:L}=p("../../web-gl/kernel-value/float");class F extends L{}y.exports={WebGL2KernelValueFloat:F}},{"../../../utils":114,"../../web-gl/kernel-value/float":56}],92:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelArray:F}=p("../../web-gl/kernel-value/array");class z extends F{constructor(k,R){super(k,R),this.checkSize(k[0].width,k[0].height),this.dimensions=[k[0].width,k[0].height,k.length],this.textureSize=[k[0].width,k[0].height]}defineTexture(){const{context:k}=this;k.activeTexture(this.contextHandle),k.bindTexture(k.TEXTURE_2D_ARRAY,this.texture),k.texParameteri(k.TEXTURE_2D_ARRAY,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D_ARRAY,k.TEXTURE_MIN_FILTER,k.NEAREST)}getStringValueHandler(){return`const uploadValue_${this.name} = ${this.varName};
`}getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2DArray ${this.id}`,`${k} ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`${k} ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){const{context:R}=this;R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D_ARRAY,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!0),R.texImage3D(R.TEXTURE_2D_ARRAY,0,R.RGBA,k[0].width,k[0].height,k.length,0,R.RGBA,R.UNSIGNED_BYTE,null);for(let S=0;S<k.length;S++)R.texSubImage3D(R.TEXTURE_2D_ARRAY,0,0,0,S,k[S].width,k[S].height,1,R.RGBA,R.UNSIGNED_BYTE,this.uploadValue=k[S]);this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGL2KernelValueHTMLImageArray:z}},{"../../../utils":114,"../../web-gl/kernel-value/array":40}],93:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueHTMLImage:F}=p("../../web-gl/kernel-value/html-image");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`${k} ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`${k} ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}}y.exports={WebGL2KernelValueHTMLImage:z}},{"../../../utils":114,"../../web-gl/kernel-value/html-image":57}],94:[function(p,y,N){p("../../../utils");const{WebGL2KernelValueHTMLImage:L}=p("./html-image");class F extends L{}y.exports={WebGL2KernelValueHTMLVideo:F}},{"../../../utils":114,"./html-image":93}],95:[function(p,y,N){const{WebGLKernelValueInteger:L}=p("../../web-gl/kernel-value/integer");class F extends L{getSource(P){const k=this.getVariablePrecisionString();return this.origin==="constants"?`const ${k} int ${this.id} = ${parseInt(P)};
`:`uniform ${k} int ${this.id};
`}updateValue(P){this.origin!=="constants"&&this.kernel.setUniform1i(this.id,this.uploadValue=P)}}y.exports={WebGL2KernelValueInteger:F}},{"../../web-gl/kernel-value/integer":60}],96:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueMemoryOptimizedNumberTexture:F}=p("../../web-gl/kernel-value/memory-optimized-number-texture");class z extends F{getSource(){const{id:k,sizeId:R,textureSize:S,dimensionsId:T,dimensions:H}=this,te=this.getVariablePrecisionString();return L.linesToString([`uniform sampler2D ${k}`,`${te} ivec2 ${R} = ivec2(${S[0]}, ${S[1]})`,`${te} ivec3 ${T} = ivec3(${H[0]}, ${H[1]}, ${H[2]})`])}}y.exports={WebGL2KernelValueMemoryOptimizedNumberTexture:z}},{"../../../utils":114,"../../web-gl/kernel-value/memory-optimized-number-texture":61}],97:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueNumberTexture:F}=p("../../web-gl/kernel-value/number-texture");class z extends F{getSource(){const{id:k,sizeId:R,textureSize:S,dimensionsId:T,dimensions:H}=this,te=this.getVariablePrecisionString();return L.linesToString([`uniform ${te} sampler2D ${k}`,`${te} ivec2 ${R} = ivec2(${S[0]}, ${S[1]})`,`${te} ivec3 ${T} = ivec3(${H[0]}, ${H[1]}, ${H[2]})`])}}y.exports={WebGL2KernelValueNumberTexture:z}},{"../../../utils":114,"../../web-gl/kernel-value/number-texture":62}],98:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray:F}=p("../../web-gl/kernel-value/single-array");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`${k} ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`${k} ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA32F,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGL2KernelValueSingleArray:z}},{"../../../utils":114,"../../web-gl/kernel-value/single-array":63}],99:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray1DI:F}=p("../../web-gl/kernel-value/single-array1d-i");class z extends F{updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA32F,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGL2KernelValueSingleArray1DI:z}},{"../../../utils":114,"../../web-gl/kernel-value/single-array1d-i":64}],100:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray2DI:F}=p("../../web-gl/kernel-value/single-array2d-i");class z extends F{updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA32F,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGL2KernelValueSingleArray2DI:z}},{"../../../utils":114,"../../web-gl/kernel-value/single-array2d-i":65}],101:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleArray3DI:F}=p("../../web-gl/kernel-value/single-array3d-i");class z extends F{updateValue(k){if(k.constructor!==this.initialValueConstructor){this.onUpdateValueMismatch(k.constructor);return}const{context:R}=this;L.flattenTo(k,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA32F,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGL2KernelValueSingleArray3DI:z}},{"../../../utils":114,"../../web-gl/kernel-value/single-array3d-i":66}],102:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueSingleInput:F}=p("../../web-gl/kernel-value/single-input");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`${k} ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`${k} ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}updateValue(k){const{context:R}=this;L.flattenTo(k.value,this.uploadValue),R.activeTexture(this.contextHandle),R.bindTexture(R.TEXTURE_2D,this.texture),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,!1),R.texImage2D(R.TEXTURE_2D,0,R.RGBA32F,this.textureSize[0],this.textureSize[1],0,R.RGBA,R.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}y.exports={WebGL2KernelValueSingleInput:z}},{"../../../utils":114,"../../web-gl/kernel-value/single-input":67}],103:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueUnsignedArray:F}=p("../../web-gl/kernel-value/unsigned-array");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`${k} ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`${k} ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}}y.exports={WebGL2KernelValueUnsignedArray:z}},{"../../../utils":114,"../../web-gl/kernel-value/unsigned-array":68}],104:[function(p,y,N){const{utils:L}=p("../../../utils"),{WebGLKernelValueUnsignedInput:F}=p("../../web-gl/kernel-value/unsigned-input");class z extends F{getSource(){const k=this.getVariablePrecisionString();return L.linesToString([`uniform ${k} sampler2D ${this.id}`,`${k} ivec2 ${this.sizeId} = ivec2(${this.textureSize[0]}, ${this.textureSize[1]})`,`${k} ivec3 ${this.dimensionsId} = ivec3(${this.dimensions[0]}, ${this.dimensions[1]}, ${this.dimensions[2]})`])}}y.exports={WebGL2KernelValueUnsignedInput:z}},{"../../../utils":114,"../../web-gl/kernel-value/unsigned-input":69}],105:[function(p,y,N){const{WebGLKernel:L}=p("../web-gl/kernel"),{WebGL2FunctionNode:F}=p("./function-node"),{FunctionBuilder:z}=p("../function-builder"),{utils:P}=p("../../utils"),{fragmentShader:k}=p("./fragment-shader"),{vertexShader:R}=p("./vertex-shader"),{lookupKernelValueType:S}=p("./kernel-value-maps");let T=null,H=null,te=null,Se=null;class ie extends L{static get isSupported(){return T!==null||(this.setupFeatureChecks(),T=this.isContextMatch(te)),T}static setupFeatureChecks(){typeof document<"u"?H=document.createElement("canvas"):typeof OffscreenCanvas<"u"&&(H=new OffscreenCanvas(0,0)),H&&(te=H.getContext("webgl2"),!(!te||!te.getExtension)&&(te.getExtension("EXT_color_buffer_float"),te.getExtension("OES_texture_float_linear"),Se=this.getFeatures()))}static isContextMatch(Y){return typeof WebGL2RenderingContext<"u"?Y instanceof WebGL2RenderingContext:!1}static getFeatures(){const Y=this.testContext;return Object.freeze({isFloatRead:this.getIsFloatRead(),isIntegerDivisionAccurate:this.getIsIntegerDivisionAccurate(),isSpeedTacticSupported:this.getIsSpeedTacticSupported(),kernelMap:!0,isTextureFloat:!0,isDrawBuffers:!0,channelCount:this.getChannelCount(),maxTextureSize:this.getMaxTextureSize(),lowIntPrecision:Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.LOW_INT),lowFloatPrecision:Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.LOW_FLOAT),mediumIntPrecision:Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.MEDIUM_INT),mediumFloatPrecision:Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.MEDIUM_FLOAT),highIntPrecision:Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.HIGH_INT),highFloatPrecision:Y.getShaderPrecisionFormat(Y.FRAGMENT_SHADER,Y.HIGH_FLOAT)})}static getIsTextureFloat(){return!0}static getChannelCount(){return te.getParameter(te.MAX_DRAW_BUFFERS)}static getMaxTextureSize(){return te.getParameter(te.MAX_TEXTURE_SIZE)}static lookupKernelValueType(Y,re,be,ke){return S(Y,re,be,ke)}static get testCanvas(){return H}static get testContext(){return te}static get features(){return Se}static get fragmentShader(){return k}static get vertexShader(){return R}initContext(){const Y={alpha:!1,depth:!1,antialias:!1};return this.canvas.getContext("webgl2",Y)}initExtensions(){this.extensions={EXT_color_buffer_float:this.context.getExtension("EXT_color_buffer_float"),OES_texture_float_linear:this.context.getExtension("OES_texture_float_linear")}}validateSettings(Y){if(!this.validate){this.texSize=P.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output);return}const{features:re}=this.constructor;if(this.precision==="single"&&!re.isFloatRead)throw new Error("Float texture outputs are not supported");if(!this.graphical&&this.precision===null&&(this.precision=re.isFloatRead?"single":"unsigned"),this.fixIntegerDivisionAccuracy===null?this.fixIntegerDivisionAccuracy=!re.isIntegerDivisionAccurate:this.fixIntegerDivisionAccuracy&&re.isIntegerDivisionAccurate&&(this.fixIntegerDivisionAccuracy=!1),this.checkOutput(),!this.output||this.output.length===0){if(Y.length!==1)throw new Error("Auto output only supported for kernels with only one input");const be=P.getVariableType(Y[0],this.strictIntegers);switch(be){case"Array":this.output=P.getDimensions(be);break;case"NumberTexture":case"MemoryOptimizedNumberTexture":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":this.output=Y[0].output;break;default:throw new Error("Auto output not supported for input type: "+be)}}if(this.graphical){if(this.output.length!==2)throw new Error("Output must have 2 dimensions on graphical mode");this.precision==="single"&&(console.warn("Cannot use graphical mode and single precision at the same time"),this.precision="unsigned"),this.texSize=P.clone(this.output);return}else!this.graphical&&this.precision===null&&re.isTextureFloat&&(this.precision="single");this.texSize=P.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output),this.checkTextureSize()}translateSource(){const Y=z.fromKernel(this,F,{fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy});this.translatedSource=Y.getPrototypeString("kernel"),this.setupReturnTypes(Y)}drawBuffers(){this.context.drawBuffers(this.drawBuffersMap)}getTextureFormat(){const{context:Y}=this;switch(this.getInternalFormat()){case Y.R32F:return Y.RED;case Y.RG32F:return Y.RG;case Y.RGBA32F:return Y.RGBA;case Y.RGBA:return Y.RGBA;default:throw new Error("Unknown internal format")}}getInternalFormat(){const{context:Y}=this;if(this.precision==="single"){if(this.pipeline)switch(this.returnType){case"Number":case"Float":case"Integer":return this.optimizeFloatMemory?Y.RGBA32F:Y.R32F;case"Array(2)":return Y.RG32F;case"Array(3)":case"Array(4)":return Y.RGBA32F;default:throw new Error("Unhandled return type")}return Y.RGBA32F}return Y.RGBA}_setupOutputTexture(){const Y=this.context;if(this.texture){Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,this.texture.texture,0);return}Y.bindFramebuffer(Y.FRAMEBUFFER,this.framebuffer);const re=Y.createTexture(),be=this.texSize;Y.activeTexture(Y.TEXTURE0+this.constantTextureCount+this.argumentTextureCount),Y.bindTexture(Y.TEXTURE_2D,re),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.REPEAT),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.REPEAT),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.NEAREST),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.NEAREST);const ke=this.getInternalFormat();this.precision==="single"?Y.texStorage2D(Y.TEXTURE_2D,1,ke,be[0],be[1]):Y.texImage2D(Y.TEXTURE_2D,0,ke,be[0],be[1],0,ke,Y.UNSIGNED_BYTE,null),Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,re,0),this.texture=new this.TextureConstructor({texture:re,size:be,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat(),kernel:this})}_setupSubOutputTextures(){const Y=this.context;if(this.mappedTextures){for(let be=0;be<this.subKernels.length;be++)Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0+be+1,Y.TEXTURE_2D,this.mappedTextures[be].texture,0);return}const re=this.texSize;this.drawBuffersMap=[Y.COLOR_ATTACHMENT0],this.mappedTextures=[];for(let be=0;be<this.subKernels.length;be++){const ke=this.createTexture();this.drawBuffersMap.push(Y.COLOR_ATTACHMENT0+be+1),Y.activeTexture(Y.TEXTURE0+this.constantTextureCount+this.argumentTextureCount+be),Y.bindTexture(Y.TEXTURE_2D,ke),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.NEAREST),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.NEAREST);const it=this.getInternalFormat();this.precision==="single"?Y.texStorage2D(Y.TEXTURE_2D,1,it,re[0],re[1]):Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,re[0],re[1],0,Y.RGBA,Y.UNSIGNED_BYTE,null),Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0+be+1,Y.TEXTURE_2D,ke,0),this.mappedTextures.push(new this.TextureConstructor({texture:ke,size:re,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat(),kernel:this}))}}_getHeaderString(){return""}_getTextureCoordinate(){const Y=this.subKernels,re=this.getVariablePrecisionString(this.texSize,this.tactic);return Y===null||Y.length<1?`in ${re} vec2 vTexCoord;
`:`out ${re} vec2 vTexCoord;
`}_getMainArgumentsString(Y){const re=[],be=this.argumentNames;for(let ke=0;ke<be.length;ke++)re.push(this.kernelArguments[ke].getSource(Y[ke]));return re.join("")}getKernelString(){const Y=[this.getKernelResultDeclaration()],re=this.subKernels;if(re!==null)switch(Y.push("layout(location = 0) out vec4 data0"),this.returnType){case"Number":case"Float":case"Integer":for(let be=0;be<re.length;be++){const ke=re[be];Y.push(ke.returnType==="Integer"?`int subKernelResult_${ke.name} = 0`:`float subKernelResult_${ke.name} = 0.0`,`layout(location = ${be+1}) out vec4 data${be+1}`)}break;case"Array(2)":for(let be=0;be<re.length;be++)Y.push(`vec2 subKernelResult_${re[be].name}`,`layout(location = ${be+1}) out vec4 data${be+1}`);break;case"Array(3)":for(let be=0;be<re.length;be++)Y.push(`vec3 subKernelResult_${re[be].name}`,`layout(location = ${be+1}) out vec4 data${be+1}`);break;case"Array(4)":for(let be=0;be<re.length;be++)Y.push(`vec4 subKernelResult_${re[be].name}`,`layout(location = ${be+1}) out vec4 data${be+1}`);break}else Y.push("out vec4 data0");return P.linesToString(Y)+this.translatedSource}getMainResultGraphical(){return P.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = actualColor"])}getMainResultPackedPixels(){switch(this.returnType){case"LiteralInteger":case"Number":case"Integer":case"Float":return this.getMainResultKernelPackedPixels()+this.getMainResultSubKernelPackedPixels();default:throw new Error(`packed output only usable with Numbers, "${this.returnType}" specified`)}}getMainResultKernelPackedPixels(){return P.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()",`  data0 = ${this.useLegacyEncoder?"legacyEncode32":"encode32"}(kernelResult)`])}getMainResultSubKernelPackedPixels(){const Y=[];if(!this.subKernels)return"";for(let re=0;re<this.subKernels.length;re++)this.subKernels[re].returnType==="Integer"?Y.push(`  data${re+1} = ${this.useLegacyEncoder?"legacyEncode32":"encode32"}(float(subKernelResult_${this.subKernels[re].name}))`):Y.push(`  data${re+1} = ${this.useLegacyEncoder?"legacyEncode32":"encode32"}(subKernelResult_${this.subKernels[re].name})`);return P.linesToString(Y)}getMainResultKernelMemoryOptimizedFloats(Y,re){Y.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()",`  data0.${re} = kernelResult`)}getMainResultSubKernelMemoryOptimizedFloats(Y,re){if(!this.subKernels)return Y;for(let be=0;be<this.subKernels.length;be++){const ke=this.subKernels[be];ke.returnType==="Integer"?Y.push(`  data${be+1}.${re} = float(subKernelResult_${ke.name})`):Y.push(`  data${be+1}.${re} = subKernelResult_${ke.name}`)}}getMainResultKernelNumberTexture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0[0] = kernelResult"]}getMainResultSubKernelNumberTexture(){const Y=[];if(!this.subKernels)return Y;for(let re=0;re<this.subKernels.length;++re){const be=this.subKernels[re];be.returnType==="Integer"?Y.push(`  data${re+1}[0] = float(subKernelResult_${be.name})`):Y.push(`  data${re+1}[0] = subKernelResult_${be.name}`)}return Y}getMainResultKernelArray2Texture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0[0] = kernelResult[0]","  data0[1] = kernelResult[1]"]}getMainResultSubKernelArray2Texture(){const Y=[];if(!this.subKernels)return Y;for(let re=0;re<this.subKernels.length;++re){const be=this.subKernels[re];Y.push(`  data${re+1}[0] = subKernelResult_${be.name}[0]`,`  data${re+1}[1] = subKernelResult_${be.name}[1]`)}return Y}getMainResultKernelArray3Texture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0[0] = kernelResult[0]","  data0[1] = kernelResult[1]","  data0[2] = kernelResult[2]"]}getMainResultSubKernelArray3Texture(){const Y=[];if(!this.subKernels)return Y;for(let re=0;re<this.subKernels.length;++re){const be=this.subKernels[re];Y.push(`  data${re+1}[0] = subKernelResult_${be.name}[0]`,`  data${re+1}[1] = subKernelResult_${be.name}[1]`,`  data${re+1}[2] = subKernelResult_${be.name}[2]`)}return Y}getMainResultKernelArray4Texture(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = kernelResult"]}getMainResultSubKernelArray4Texture(){const Y=[];if(!this.subKernels)return Y;for(let re=0;re<this.subKernels.length;++re)Y.push(`  data${re+1} = subKernelResult_${this.subKernels[re].name}`);return Y}destroyExtensions(){this.extensions.EXT_color_buffer_float=null,this.extensions.OES_texture_float_linear=null}toJSON(){const Y=super.toJSON();return Y.functionNodes=z.fromKernel(this,F).toJSON(),Y.settings.threadDim=this.threadDim,Y}}y.exports={WebGL2Kernel:ie}},{"../../utils":114,"../function-builder":9,"../web-gl/kernel":70,"./fragment-shader":72,"./function-node":73,"./kernel-value-maps":74,"./vertex-shader":106}],106:[function(p,y,N){const L=`#version 300 es
__FLOAT_TACTIC_DECLARATION__;
__INT_TACTIC_DECLARATION__;
__SAMPLER_2D_TACTIC_DECLARATION__;

in vec2 aPos;
in vec2 aTexCoord;

out vec2 vTexCoord;
uniform vec2 ratio;

void main(void) {
  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);
  vTexCoord = aTexCoord;
}`;y.exports={vertexShader:L}},{}],107:[function(p,y,N){const L=p("./index"),F=L.GPU;for(const P in L)L.hasOwnProperty(P)&&P!=="GPU"&&(F[P]=L[P]);typeof window<"u"&&z(window),typeof self<"u"&&z(self);function z(P){P.GPU||Object.defineProperty(P,"GPU",{get(){return F}})}y.exports=L},{"./index":109}],108:[function(p,y,N){const{gpuMock:L}=p("gpu-mock.js"),{utils:F}=p("./utils");p("./backend/kernel");const{CPUKernel:z}=p("./backend/cpu/kernel"),{HeadlessGLKernel:P}=p("./backend/headless-gl/kernel"),{WebGL2Kernel:k}=p("./backend/web-gl2/kernel"),{WebGLKernel:R}=p("./backend/web-gl/kernel"),{kernelRunShortcut:S}=p("./kernel-run-shortcut"),T=[P,k,R],H=["gpu","cpu"],te={headlessgl:P,webgl2:k,webgl:R};let Se=!0;class ie{static disableValidation(){Se=!1}static enableValidation(){Se=!0}static get isGPUSupported(){return T.some(re=>re.isSupported)}static get isKernelMapSupported(){return T.some(re=>re.isSupported&&re.features.kernelMap)}static get isOffscreenCanvasSupported(){return typeof Worker<"u"&&typeof OffscreenCanvas<"u"||typeof importScripts<"u"}static get isWebGLSupported(){return R.isSupported}static get isWebGL2Supported(){return k.isSupported}static get isHeadlessGLSupported(){return P.isSupported}static get isCanvasSupported(){return typeof HTMLCanvasElement<"u"}static get isGPUHTMLImageArraySupported(){return k.isSupported}static get isSinglePrecisionSupported(){return T.some(re=>re.isSupported&&re.features.isFloatRead&&re.features.isTextureFloat)}constructor(re){if(re=re||{},this.canvas=re.canvas||null,this.context=re.context||null,this.mode=re.mode,this.Kernel=null,this.kernels=[],this.functions=[],this.nativeFunctions=[],this.injectedNative=null,this.mode!=="dev"){if(this.chooseKernel(),re.functions)for(let be=0;be<re.functions.length;be++)this.addFunction(re.functions[be]);if(re.nativeFunctions)for(const be in re.nativeFunctions){if(!re.nativeFunctions.hasOwnProperty(be))continue;const ke=re.nativeFunctions[be],{name:it,source:vt}=ke;this.addNativeFunction(it,vt,ke)}}}chooseKernel(){if(this.Kernel)return;let re=null;if(this.context){for(let be=0;be<T.length;be++){const ke=T[be];if(ke.isContextMatch(this.context)){if(!ke.isSupported)throw new Error(`Kernel type ${ke.name} not supported`);re=ke;break}}if(re===null)throw new Error("unknown Context")}else if(this.mode){if(this.mode in te)(!Se||te[this.mode].isSupported)&&(re=te[this.mode]);else if(this.mode==="gpu"){for(let be=0;be<T.length;be++)if(T[be].isSupported){re=T[be];break}}else this.mode==="cpu"&&(re=z);if(!re)throw new Error(`A requested mode of "${this.mode}" and is not supported`)}else{for(let be=0;be<T.length;be++)if(T[be].isSupported){re=T[be];break}re||(re=z)}this.mode||(this.mode=re.mode),this.Kernel=re}createKernel(re,be){if(typeof re>"u")throw new Error("Missing source parameter");if(typeof re!="object"&&!F.isFunction(re)&&typeof re!="string")throw new Error("source parameter not a function");const ke=this.kernels;if(this.mode==="dev"){const v=L(re,_e(be));return ke.push(v),v}re=typeof re=="function"?re.toString():re;const it={},vt=_e(be)||{};be&&typeof be.argumentTypes=="object"&&(vt.argumentTypes=Object.keys(be.argumentTypes).map(v=>be.argumentTypes[v]));function Q(v){console.warn("Falling back to CPU");const I=new z(re,{argumentTypes:bt.argumentTypes,constantTypes:bt.constantTypes,graphical:bt.graphical,loopMaxIterations:bt.loopMaxIterations,constants:bt.constants,dynamicOutput:bt.dynamicOutput,dynamicArgument:bt.dynamicArguments,output:bt.output,precision:bt.precision,pipeline:bt.pipeline,immutable:bt.immutable,optimizeFloatMemory:bt.optimizeFloatMemory,fixIntegerDivisionAccuracy:bt.fixIntegerDivisionAccuracy,functions:bt.functions,nativeFunctions:bt.nativeFunctions,injectedNative:bt.injectedNative,subKernels:bt.subKernels,strictIntegers:bt.strictIntegers,debug:bt.debug});I.build.apply(I,v);const M=I.run.apply(I,v);return bt.replaceKernel(I),M}function U(v,I,M){M.debug&&console.warn("Switching kernels");let G=null;if(M.signature&&!it[M.signature]&&(it[M.signature]=M),M.dynamicOutput)for(let Re=v.length-1;Re>=0;Re--){const Ue=v[Re];Ue.type==="outputPrecisionMismatch"&&(G=Ue.needed)}const oe=M.constructor,de=oe.getArgumentTypes(M,I),ue=oe.getSignature(M,de),ve=it[ue];if(ve)return ve.onActivate(M),ve;const xe=it[ue]=new oe(re,{argumentTypes:de,constantTypes:M.constantTypes,graphical:M.graphical,loopMaxIterations:M.loopMaxIterations,constants:M.constants,dynamicOutput:M.dynamicOutput,dynamicArgument:M.dynamicArguments,context:M.context,canvas:M.canvas,output:G||M.output,precision:M.precision,pipeline:M.pipeline,immutable:M.immutable,optimizeFloatMemory:M.optimizeFloatMemory,fixIntegerDivisionAccuracy:M.fixIntegerDivisionAccuracy,functions:M.functions,nativeFunctions:M.nativeFunctions,injectedNative:M.injectedNative,subKernels:M.subKernels,strictIntegers:M.strictIntegers,debug:M.debug,gpu:M.gpu,validate:Se,returnType:M.returnType,tactic:M.tactic,onRequestFallback:Q,onRequestSwitchKernel:U,texture:M.texture,mappedTextures:M.mappedTextures,drawBuffersMap:M.drawBuffersMap});return xe.build.apply(xe,I),bt.replaceKernel(xe),ke.push(xe),xe}const Oe=Object.assign({context:this.context,canvas:this.canvas,functions:this.functions,nativeFunctions:this.nativeFunctions,injectedNative:this.injectedNative,gpu:this,validate:Se,onRequestFallback:Q,onRequestSwitchKernel:U},vt),Fe=new this.Kernel(re,Oe),bt=S(Fe);return this.canvas||(this.canvas=Fe.canvas),this.context||(this.context=Fe.context),ke.push(Fe),bt}createKernelMap(){let re,be;const ke=typeof arguments[arguments.length-2];if(ke==="function"||ke==="string"?(re=arguments[arguments.length-2],be=arguments[arguments.length-1]):re=arguments[arguments.length-1],this.mode!=="dev"&&(!this.Kernel.isSupported||!this.Kernel.features.kernelMap)&&this.mode&&H.indexOf(this.mode)<0)throw new Error(`kernelMap not supported on ${this.Kernel.name}`);const it=_e(be);if(be&&typeof be.argumentTypes=="object"&&(it.argumentTypes=Object.keys(be.argumentTypes).map(vt=>be.argumentTypes[vt])),Array.isArray(arguments[0])){it.subKernels=[];const vt=arguments[0];for(let Q=0;Q<vt.length;Q++){const U=vt[Q].toString(),Oe=F.getFunctionNameFromString(U);it.subKernels.push({name:Oe,source:U,property:Q})}}else{it.subKernels=[];const vt=arguments[0];for(let Q in vt){if(!vt.hasOwnProperty(Q))continue;const U=vt[Q].toString(),Oe=F.getFunctionNameFromString(U);it.subKernels.push({name:Oe||Q,source:U,property:Q})}}return this.createKernel(re,it)}combineKernels(){const re=arguments[0],be=arguments[arguments.length-1];if(re.kernel.constructor.mode==="cpu")return be;const ke=arguments[0].canvas,it=arguments[0].context,vt=arguments.length-1;for(let Q=0;Q<vt;Q++)arguments[Q].setCanvas(ke).setContext(it).setPipeline(!0);return function(){const Q=be.apply(this,arguments);return Q.toArray?Q.toArray():Q}}setFunctions(re){return this.functions=re,this}setNativeFunctions(re){return this.nativeFunctions=re,this}addFunction(re,be){return this.functions.push({source:re,settings:be}),this}addNativeFunction(re,be,ke){if(this.kernels.length>0)throw new Error('Cannot call "addNativeFunction" after "createKernels" has been called.');return this.nativeFunctions.push(Object.assign({name:re,source:be},ke)),this}injectNative(re){return this.injectedNative=re,this}destroy(){return new Promise((re,be)=>{this.kernels||re(),setTimeout(()=>{try{for(let it=0;it<this.kernels.length;it++)this.kernels[it].destroy(!0);let ke=this.kernels[0];ke&&(ke.kernel&&(ke=ke.kernel),ke.constructor.destroyContext&&ke.constructor.destroyContext(this.context))}catch(ke){be(ke)}re()},0)})}}function _e(Y){if(!Y)return{};const re=Object.assign({},Y);return Y.hasOwnProperty("floatOutput")&&(F.warnDeprecated("setting","floatOutput","precision"),re.precision=Y.floatOutput?"single":"unsigned"),Y.hasOwnProperty("outputToTexture")&&(F.warnDeprecated("setting","outputToTexture","pipeline"),re.pipeline=!!Y.outputToTexture),Y.hasOwnProperty("outputImmutable")&&(F.warnDeprecated("setting","outputImmutable","immutable"),re.immutable=!!Y.outputImmutable),Y.hasOwnProperty("floatTextures")&&(F.warnDeprecated("setting","floatTextures","optimizeFloatMemory"),re.optimizeFloatMemory=!!Y.floatTextures),re}y.exports={GPU:ie,kernelOrder:T,kernelTypes:H}},{"./backend/cpu/kernel":8,"./backend/headless-gl/kernel":34,"./backend/kernel":36,"./backend/web-gl/kernel":70,"./backend/web-gl2/kernel":105,"./kernel-run-shortcut":111,"./utils":114,"gpu-mock.js":4}],109:[function(p,y,N){const{GPU:L}=p("./gpu"),{alias:F}=p("./alias"),{utils:z}=p("./utils"),{Input:P,input:k}=p("./input"),{Texture:R}=p("./texture"),{FunctionBuilder:S}=p("./backend/function-builder"),{FunctionNode:T}=p("./backend/function-node"),{CPUFunctionNode:H}=p("./backend/cpu/function-node"),{CPUKernel:te}=p("./backend/cpu/kernel"),{HeadlessGLKernel:Se}=p("./backend/headless-gl/kernel"),{WebGLFunctionNode:ie}=p("./backend/web-gl/function-node"),{WebGLKernel:_e}=p("./backend/web-gl/kernel"),{kernelValueMaps:Y}=p("./backend/web-gl/kernel-value-maps"),{WebGL2FunctionNode:re}=p("./backend/web-gl2/function-node"),{WebGL2Kernel:be}=p("./backend/web-gl2/kernel"),{kernelValueMaps:ke}=p("./backend/web-gl2/kernel-value-maps"),{GLKernel:it}=p("./backend/gl/kernel"),{Kernel:vt}=p("./backend/kernel"),{FunctionTracer:Q}=p("./backend/function-tracer"),U=p("./plugins/math-random-uniformly-distributed");y.exports={alias:F,CPUFunctionNode:H,CPUKernel:te,GPU:L,FunctionBuilder:S,FunctionNode:T,HeadlessGLKernel:Se,Input:P,input:k,Texture:R,utils:z,WebGL2FunctionNode:re,WebGL2Kernel:be,webGL2KernelValueMaps:ke,WebGLFunctionNode:ie,WebGLKernel:_e,webGLKernelValueMaps:Y,GLKernel:it,Kernel:vt,FunctionTracer:Q,plugins:{mathRandom:U}}},{"./alias":5,"./backend/cpu/function-node":6,"./backend/cpu/kernel":8,"./backend/function-builder":9,"./backend/function-node":10,"./backend/function-tracer":11,"./backend/gl/kernel":13,"./backend/headless-gl/kernel":34,"./backend/kernel":36,"./backend/web-gl/function-node":38,"./backend/web-gl/kernel":70,"./backend/web-gl/kernel-value-maps":39,"./backend/web-gl2/function-node":73,"./backend/web-gl2/kernel":105,"./backend/web-gl2/kernel-value-maps":74,"./gpu":108,"./input":110,"./plugins/math-random-uniformly-distributed":112,"./texture":113,"./utils":114}],110:[function(p,y,N){class L{constructor(P,k){this.value=P,Array.isArray(k)?this.size=k:(this.size=new Int32Array(3),k.z?this.size=new Int32Array([k.x,k.y,k.z]):k.y?this.size=new Int32Array([k.x,k.y]):this.size=new Int32Array([k.x]));const[R,S,T]=this.size;if(T){if(this.value.length!==R*S*T)throw new Error(`Input size ${this.value.length} does not match ${R} * ${S} * ${T} = ${S*R*T}`)}else if(S){if(this.value.length!==R*S)throw new Error(`Input size ${this.value.length} does not match ${R} * ${S} = ${S*R}`)}else if(this.value.length!==R)throw new Error(`Input size ${this.value.length} does not match ${R}`)}toArray(){const{utils:P}=p("./utils"),[k,R,S]=this.size;return S?P.erectMemoryOptimized3DFloat(this.value.subarray?this.value:new Float32Array(this.value),k,R,S):R?P.erectMemoryOptimized2DFloat(this.value.subarray?this.value:new Float32Array(this.value),k,R):this.value}}function F(z,P){return new L(z,P)}y.exports={Input:L,input:F}},{"./utils":114}],111:[function(p,y,N){const{utils:L}=p("./utils");function F(P){let k=function(){return P.build.apply(P,arguments),k=function(){let S=P.run.apply(P,arguments);if(P.switchingKernels){const T=P.resetSwitchingKernels(),H=P.onRequestSwitchKernel(T,arguments,P);R.kernel=P=H,S=H.run.apply(H,arguments)}return P.renderKernels?P.renderKernels():P.renderOutput?P.renderOutput():S},k.apply(P,arguments)};const R=function(){return k.apply(P,arguments)};return R.exec=function(){return new Promise((S,T)=>{try{S(k.apply(this,arguments))}catch(H){T(H)}})},R.replaceKernel=function(S){P=S,z(P,R)},z(P,R),R}function z(P,k){if(k.kernel){k.kernel=P;return}const R=L.allPropertiesOf(P);for(let S=0;S<R.length;S++){const T=R[S];T[0]==="_"&&T[1]==="_"||(typeof P[T]=="function"?T.substring(0,3)==="add"||T.substring(0,3)==="set"?k[T]=function(){return k.kernel[T].apply(k.kernel,arguments),k}:k[T]=function(){return k.kernel[T].apply(k.kernel,arguments)}:(k.__defineGetter__(T,()=>k.kernel[T]),k.__defineSetter__(T,H=>{k.kernel[T]=H})))}k.kernel=P}y.exports={kernelRunShortcut:F}},{"./utils":114}],112:[function(p,y,N){const S={name:"math-random-uniformly-distributed",onBeforeRun:T=>{T.setUniform1f("randomSeed1",Math.random()),T.setUniform1f("randomSeed2",Math.random())},functionMatch:"Math.random()",functionReplace:"nrand(vTexCoord)",functionReturnType:"Number",source:`// https://www.shadertoy.com/view/4t2SDh
//note: uniformly distributed, normalized rand, [0,1]
highp float randomSeedShift = 1.0;
highp float slide = 1.0;
uniform highp float randomSeed1;
uniform highp float randomSeed2;

highp float nrand(highp vec2 n) {
  highp float result = fract(sin(dot((n.xy + 1.0) * vec2(randomSeed1 * slide, randomSeed2 * randomSeedShift), vec2(12.9898, 78.233))) * 43758.5453);
  randomSeedShift = result;
  if (randomSeedShift > 0.5) {
    slide += 0.00009; 
  } else {
    slide += 0.0009;
  }
  return result;
}`};y.exports=S},{}],113:[function(p,y,N){class L{constructor(z){const{texture:P,size:k,dimensions:R,output:S,context:T,type:H="NumberTexture",kernel:te,internalFormat:Se,textureFormat:ie}=z;if(!S)throw new Error('settings property "output" required.');if(!T)throw new Error('settings property "context" required.');if(!P)throw new Error('settings property "texture" required.');if(!te)throw new Error('settings property "kernel" required.');this.texture=P,P._refs?P._refs++:P._refs=1,this.size=k,this.dimensions=R,this.output=S,this.context=T,this.kernel=te,this.type=H,this._deleted=!1,this.internalFormat=Se,this.textureFormat=ie}toArray(){throw new Error(`Not implemented on ${this.constructor.name}`)}clone(){throw new Error(`Not implemented on ${this.constructor.name}`)}delete(){throw new Error(`Not implemented on ${this.constructor.name}`)}clear(){throw new Error(`Not implemented on ${this.constructor.name}`)}}y.exports={Texture:L}},{}],114:[function(p,y,N){const L=p("acorn"),{Input:F}=p("./input"),{Texture:z}=p("./texture"),P=/function ([^(]*)/,k=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,R=/([^\s,]+)/g,S={systemEndianness(){return Se},getSystemEndianness(){const ie=new ArrayBuffer(4),_e=new Uint32Array(ie),Y=new Uint8Array(ie);if(_e[0]=3735928559,Y[0]===239)return"LE";if(Y[0]===222)return"BE";throw new Error("unknown endianness")},isFunction(ie){return typeof ie=="function"},isFunctionString(ie){return typeof ie=="string"?ie.slice(0,8).toLowerCase()==="function":!1},getFunctionNameFromString(ie){const _e=P.exec(ie);return!_e||_e.length===0?null:_e[1].trim()},getFunctionBodyFromString(ie){return ie.substring(ie.indexOf("{")+1,ie.lastIndexOf("}"))},getArgumentNamesFromString(ie){const _e=ie.replace(k,"");let Y=_e.slice(_e.indexOf("(")+1,_e.indexOf(")")).match(R);return Y===null&&(Y=[]),Y},clone(ie){if(ie===null||typeof ie!="object"||ie.hasOwnProperty("isActiveClone"))return ie;const _e=ie.constructor();for(let Y in ie)Object.prototype.hasOwnProperty.call(ie,Y)&&(ie.isActiveClone=null,_e[Y]=S.clone(ie[Y]),delete ie.isActiveClone);return _e},isArray(ie){return!isNaN(ie.length)},getVariableType(ie,_e){if(S.isArray(ie))return ie.length>0&&ie[0].nodeName==="IMG"?"HTMLImageArray":"Array";switch(ie.constructor){case Boolean:return"Boolean";case Number:return _e&&Number.isInteger(ie)?"Integer":"Float";case z:return ie.type;case F:return"Input"}if("nodeName"in ie)switch(ie.nodeName){case"IMG":return"HTMLImage";case"CANVAS":return"HTMLImage";case"VIDEO":return"HTMLVideo"}else{if(ie.hasOwnProperty("type"))return ie.type;if(typeof OffscreenCanvas<"u"&&ie instanceof OffscreenCanvas)return"OffscreenCanvas";if(typeof ImageBitmap<"u"&&ie instanceof ImageBitmap)return"ImageBitmap";if(typeof ImageData<"u"&&ie instanceof ImageData)return"ImageData"}return"Unknown"},getKernelTextureSize(ie,_e){let[Y,re,be]=_e,ke=(Y||1)*(re||1)*(be||1);return ie.optimizeFloatMemory&&ie.precision==="single"&&(Y=ke=Math.ceil(ke/4)),re>1&&Y*re===ke?new Int32Array([Y,re]):S.closestSquareDimensions(ke)},closestSquareDimensions(ie){const _e=Math.sqrt(ie);let Y=Math.ceil(_e),re=Math.floor(_e);for(;Y*re<ie;)Y--,re=Math.ceil(ie/Y);return new Int32Array([re,Math.ceil(ie/re)])},getMemoryOptimizedFloatTextureSize(ie,_e){const re=S.roundTo((ie[0]||1)*(ie[1]||1)*(ie[2]||1)*(ie[3]||1),4)/_e;return S.closestSquareDimensions(re)},getMemoryOptimizedPackedTextureSize(ie,_e){const[Y,re,be]=ie,it=S.roundTo((Y||1)*(re||1)*(be||1),4)/(4/_e);return S.closestSquareDimensions(it)},roundTo(ie,_e){return Math.floor((ie+_e-1)/_e)*_e},getDimensions(ie,_e){let Y;if(S.isArray(ie)){const re=[];let be=ie;for(;S.isArray(be);)re.push(be.length),be=be[0];Y=re.reverse()}else if(ie instanceof z)Y=ie.output;else if(ie instanceof F)Y=ie.size;else throw new Error(`Unknown dimensions of ${ie}`);if(_e)for(Y=Array.from(Y);Y.length<3;)Y.push(1);return new Int32Array(Y)},flatten2dArrayTo(ie,_e){let Y=0;for(let re=0;re<ie.length;re++)_e.set(ie[re],Y),Y+=ie[re].length},flatten3dArrayTo(ie,_e){let Y=0;for(let re=0;re<ie.length;re++)for(let be=0;be<ie[re].length;be++)_e.set(ie[re][be],Y),Y+=ie[re][be].length},flatten4dArrayTo(ie,_e){let Y=0;for(let re=0;re<ie.length;re++)for(let be=0;be<ie[re].length;be++)for(let ke=0;ke<ie[re][be].length;ke++)_e.set(ie[re][be][ke],Y),Y+=ie[re][be][ke].length},flattenTo(ie,_e){S.isArray(ie[0])?S.isArray(ie[0][0])?S.isArray(ie[0][0][0])?S.flatten4dArrayTo(ie,_e):S.flatten3dArrayTo(ie,_e):S.flatten2dArrayTo(ie,_e):_e.set(ie)},splitArray(ie,_e){const Y=[];for(let re=0;re<ie.length;re+=_e)Y.push(new ie.constructor(ie.buffer,re*4+ie.byteOffset,_e));return Y},getAstString(ie,_e){const Y=Array.isArray(ie)?ie:ie.split(/\r?\n/g),re=_e.loc.start,be=_e.loc.end,ke=[];if(re.line===be.line)ke.push(Y[re.line-1].substring(re.column,be.column));else{ke.push(Y[re.line-1].slice(re.column));for(let it=re.line;it<be.line;it++)ke.push(Y[it]);ke.push(Y[be.line-1].slice(0,be.column))}return ke.join(`
`)},allPropertiesOf(ie){const _e=[];do _e.push.apply(_e,Object.getOwnPropertyNames(ie));while(ie=Object.getPrototypeOf(ie));return _e},linesToString(ie){return ie.length>0?ie.join(`;
`)+`;
`:`
`},warnDeprecated(ie,_e,Y){console.warn(Y?`You are using a deprecated ${ie} "${_e}". It has been replaced with "${Y}". Fixing, but please upgrade as it will soon be removed.`:`You are using a deprecated ${ie} "${_e}". It has been removed. Fixing, but please upgrade as it will soon be removed.`)},flipPixels:(ie,_e,Y)=>{const re=Y/2|0,be=_e*4,ke=new Uint8ClampedArray(_e*4),it=ie.slice(0);for(let vt=0;vt<re;++vt){const Q=vt*be,U=(Y-vt-1)*be;ke.set(it.subarray(Q,Q+be)),it.copyWithin(Q,U,U+be),it.set(ke,U)}return it},erectPackedFloat:(ie,_e)=>ie.subarray(0,_e),erect2DPackedFloat:(ie,_e,Y)=>{const re=new Array(Y);for(let be=0;be<Y;be++){const ke=be*_e,it=ke+_e;re[be]=ie.subarray(ke,it)}return re},erect3DPackedFloat:(ie,_e,Y,re)=>{const be=new Array(re);for(let ke=0;ke<re;ke++){const it=new Array(Y);for(let vt=0;vt<Y;vt++){const Q=ke*Y*_e+vt*_e,U=Q+_e;it[vt]=ie.subarray(Q,U)}be[ke]=it}return be},erectMemoryOptimizedFloat:(ie,_e)=>ie.subarray(0,_e),erectMemoryOptimized2DFloat:(ie,_e,Y)=>{const re=new Array(Y);for(let be=0;be<Y;be++){const ke=be*_e;re[be]=ie.subarray(ke,ke+_e)}return re},erectMemoryOptimized3DFloat:(ie,_e,Y,re)=>{const be=new Array(re);for(let ke=0;ke<re;ke++){const it=new Array(Y);for(let vt=0;vt<Y;vt++){const Q=ke*Y*_e+vt*_e;it[vt]=ie.subarray(Q,Q+_e)}be[ke]=it}return be},erectFloat:(ie,_e)=>{const Y=new Float32Array(_e);let re=0;for(let be=0;be<_e;be++)Y[be]=ie[re],re+=4;return Y},erect2DFloat:(ie,_e,Y)=>{const re=new Array(Y);let be=0;for(let ke=0;ke<Y;ke++){const it=new Float32Array(_e);for(let vt=0;vt<_e;vt++)it[vt]=ie[be],be+=4;re[ke]=it}return re},erect3DFloat:(ie,_e,Y,re)=>{const be=new Array(re);let ke=0;for(let it=0;it<re;it++){const vt=new Array(Y);for(let Q=0;Q<Y;Q++){const U=new Float32Array(_e);for(let Oe=0;Oe<_e;Oe++)U[Oe]=ie[ke],ke+=4;vt[Q]=U}be[it]=vt}return be},erectArray2:(ie,_e)=>{const Y=new Array(_e),re=_e*4;let be=0;for(let ke=0;ke<re;ke+=4)Y[be++]=ie.subarray(ke,ke+2);return Y},erect2DArray2:(ie,_e,Y)=>{const re=new Array(Y),be=_e*4;for(let ke=0;ke<Y;ke++){const it=new Array(_e),vt=ke*be;let Q=0;for(let U=0;U<be;U+=4)it[Q++]=ie.subarray(U+vt,U+vt+2);re[ke]=it}return re},erect3DArray2:(ie,_e,Y,re)=>{const be=_e*4,ke=new Array(re);for(let it=0;it<re;it++){const vt=new Array(Y);for(let Q=0;Q<Y;Q++){const U=new Array(_e),Oe=it*be*Y+Q*be;let Fe=0;for(let bt=0;bt<be;bt+=4)U[Fe++]=ie.subarray(bt+Oe,bt+Oe+2);vt[Q]=U}ke[it]=vt}return ke},erectArray3:(ie,_e)=>{const Y=new Array(_e),re=_e*4;let be=0;for(let ke=0;ke<re;ke+=4)Y[be++]=ie.subarray(ke,ke+3);return Y},erect2DArray3:(ie,_e,Y)=>{const re=_e*4,be=new Array(Y);for(let ke=0;ke<Y;ke++){const it=new Array(_e),vt=ke*re;let Q=0;for(let U=0;U<re;U+=4)it[Q++]=ie.subarray(U+vt,U+vt+3);be[ke]=it}return be},erect3DArray3:(ie,_e,Y,re)=>{const be=_e*4,ke=new Array(re);for(let it=0;it<re;it++){const vt=new Array(Y);for(let Q=0;Q<Y;Q++){const U=new Array(_e),Oe=it*be*Y+Q*be;let Fe=0;for(let bt=0;bt<be;bt+=4)U[Fe++]=ie.subarray(bt+Oe,bt+Oe+3);vt[Q]=U}ke[it]=vt}return ke},erectArray4:(ie,_e)=>{const Y=new Array(ie),re=_e*4;let be=0;for(let ke=0;ke<re;ke+=4)Y[be++]=ie.subarray(ke,ke+4);return Y},erect2DArray4:(ie,_e,Y)=>{const re=_e*4,be=new Array(Y);for(let ke=0;ke<Y;ke++){const it=new Array(_e),vt=ke*re;let Q=0;for(let U=0;U<re;U+=4)it[Q++]=ie.subarray(U+vt,U+vt+4);be[ke]=it}return be},erect3DArray4:(ie,_e,Y,re)=>{const be=_e*4,ke=new Array(re);for(let it=0;it<re;it++){const vt=new Array(Y);for(let Q=0;Q<Y;Q++){const U=new Array(_e),Oe=it*be*Y+Q*be;let Fe=0;for(let bt=0;bt<be;bt+=4)U[Fe++]=ie.subarray(bt+Oe,bt+Oe+4);vt[Q]=U}ke[it]=vt}return ke},flattenFunctionToString:(ie,_e)=>{const{findDependency:Y,thisLookup:re,doNotDefine:be}=_e;let ke=_e.flattened;ke||(ke=_e.flattened={});const it=L.parse(ie),vt=[];let Q=0;function U(Fe){if(Array.isArray(Fe)){const bt=[];for(let v=0;v<Fe.length;v++)bt.push(U(Fe[v]));return bt.join("")}switch(Fe.type){case"Program":return U(Fe.body)+(Fe.body[0].type==="VariableDeclaration"?";":"");case"FunctionDeclaration":return`function ${Fe.id.name}(${Fe.params.map(U).join(", ")}) ${U(Fe.body)}`;case"BlockStatement":{const v=[];Q+=2;for(let I=0;I<Fe.body.length;I++){const M=U(Fe.body[I]);M&&v.push(" ".repeat(Q)+M,`;
`)}return Q-=2,`{
${v.join("")}}`}case"VariableDeclaration":const bt=S.normalizeDeclarations(Fe).map(U).filter(v=>v!==null);return bt.length<1?"":`${Fe.kind} ${bt.join(",")}`;case"VariableDeclarator":return Fe.init.object&&Fe.init.object.type==="ThisExpression"?re(Fe.init.property.name,!0)?`${Fe.id.name} = ${U(Fe.init)}`:null:`${Fe.id.name} = ${U(Fe.init)}`;case"CallExpression":{if(Fe.callee.property.name==="subarray")return`${U(Fe.callee.object)}.${U(Fe.callee.property)}(${Fe.arguments.map(v=>U(v)).join(", ")})`;if(Fe.callee.object.name==="gl"||Fe.callee.object.name==="context")return`${U(Fe.callee.object)}.${U(Fe.callee.property)}(${Fe.arguments.map(v=>U(v)).join(", ")})`;if(Fe.callee.object.type==="ThisExpression")return vt.push(Y("this",Fe.callee.property.name)),`${Fe.callee.property.name}(${Fe.arguments.map(v=>U(v)).join(", ")})`;if(Fe.callee.object.name){const v=Y(Fe.callee.object.name,Fe.callee.property.name);return v===null?`${Fe.callee.object.name}.${Fe.callee.property.name}(${Fe.arguments.map(I=>U(I)).join(", ")})`:(vt.push(v),`${Fe.callee.property.name}(${Fe.arguments.map(I=>U(I)).join(", ")})`)}else{if(Fe.callee.object.type==="MemberExpression")return`${U(Fe.callee.object)}.${Fe.callee.property.name}(${Fe.arguments.map(v=>U(v)).join(", ")})`;throw new Error("unknown ast.callee")}}case"ReturnStatement":return`return ${U(Fe.argument)}`;case"BinaryExpression":return`(${U(Fe.left)}${Fe.operator}${U(Fe.right)})`;case"UnaryExpression":return Fe.prefix?`${Fe.operator} ${U(Fe.argument)}`:`${U(Fe.argument)} ${Fe.operator}`;case"ExpressionStatement":return`${U(Fe.expression)}`;case"SequenceExpression":return`(${U(Fe.expressions)})`;case"ArrowFunctionExpression":return`(${Fe.params.map(U).join(", ")}) => ${U(Fe.body)}`;case"Literal":return Fe.raw;case"Identifier":return Fe.name;case"MemberExpression":return Fe.object.type==="ThisExpression"?re(Fe.property.name):Fe.computed?`${U(Fe.object)}[${U(Fe.property)}]`:U(Fe.object)+"."+U(Fe.property);case"ThisExpression":return"this";case"NewExpression":return`new ${U(Fe.callee)}(${Fe.arguments.map(v=>U(v)).join(", ")})`;case"ForStatement":return`for (${U(Fe.init)};${U(Fe.test)};${U(Fe.update)}) ${U(Fe.body)}`;case"AssignmentExpression":return`${U(Fe.left)}${Fe.operator}${U(Fe.right)}`;case"UpdateExpression":return`${U(Fe.argument)}${Fe.operator}`;case"IfStatement":return`if (${U(Fe.test)}) ${U(Fe.consequent)}`;case"ThrowStatement":return`throw ${U(Fe.argument)}`;case"ObjectPattern":return Fe.properties.map(U).join(", ");case"ArrayPattern":return Fe.elements.map(U).join(", ");case"DebuggerStatement":return"debugger;";case"ConditionalExpression":return`${U(Fe.test)}?${U(Fe.consequent)}:${U(Fe.alternate)}`;case"Property":if(Fe.kind==="init")return U(Fe.key)}throw new Error(`unhandled ast.type of ${Fe.type}`)}const Oe=U(it);if(vt.length>0){const Fe=[];for(let bt=0;bt<vt.length;bt++){const v=vt[bt];ke[v]||(ke[v]=!0),v&&Fe.push(S.flattenFunctionToString(v,_e)+`
`)}return Fe.join("")+Oe}return Oe},normalizeDeclarations:ie=>{if(ie.type!=="VariableDeclaration")throw new Error('Ast is not of type "VariableDeclaration"');const _e=[];for(let Y=0;Y<ie.declarations.length;Y++){const re=ie.declarations[Y];if(re.id&&re.id.type==="ObjectPattern"&&re.id.properties){const{properties:be}=re.id;for(let ke=0;ke<be.length;ke++){const it=be[ke];if(it.value.type==="ObjectPattern"&&it.value.properties)for(let vt=0;vt<it.value.properties.length;vt++){const Q=it.value.properties[vt];if(Q.type==="Property")_e.push({type:"VariableDeclarator",id:{type:"Identifier",name:Q.key.name},init:{type:"MemberExpression",object:{type:"MemberExpression",object:re.init,property:{type:"Identifier",name:it.key.name},computed:!1},property:{type:"Identifier",name:Q.key.name},computed:!1}});else throw new Error("unexpected state")}else if(it.value.type==="Identifier")_e.push({type:"VariableDeclarator",id:{type:"Identifier",name:it.value&&it.value.name?it.value.name:it.key.name},init:{type:"MemberExpression",object:re.init,property:{type:"Identifier",name:it.key.name},computed:!1}});else throw new Error("unexpected state")}}else if(re.id&&re.id.type==="ArrayPattern"&&re.id.elements){const{elements:be}=re.id;for(let ke=0;ke<be.length;ke++){const it=be[ke];if(it.type==="Identifier")_e.push({type:"VariableDeclarator",id:{type:"Identifier",name:it.name},init:{type:"MemberExpression",object:re.init,property:{type:"Literal",value:ke,raw:ke.toString(),start:it.start,end:it.end},computed:!0}});else throw new Error("unexpected state")}}else _e.push(re)}return _e},splitHTMLImageToRGB:(ie,_e)=>{const Y=ie.createKernel(function(vt){return vt[this.thread.y][this.thread.x].r*255},{output:[_e.width,_e.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),re=ie.createKernel(function(vt){return vt[this.thread.y][this.thread.x].g*255},{output:[_e.width,_e.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),be=ie.createKernel(function(vt){return vt[this.thread.y][this.thread.x].b*255},{output:[_e.width,_e.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),ke=ie.createKernel(function(vt){return vt[this.thread.y][this.thread.x].a*255},{output:[_e.width,_e.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),it=[Y(_e),re(_e),be(_e),ke(_e)];return it.rKernel=Y,it.gKernel=re,it.bKernel=be,it.aKernel=ke,it.gpu=ie,it},splitRGBAToCanvases:(ie,_e,Y,re)=>{const be=ie.createKernel(function(Q){const U=Q[this.thread.y][this.thread.x];this.color(U.r/255,0,0,255)},{output:[Y,re],graphical:!0,argumentTypes:{v:"Array2D(4)"}});be(_e);const ke=ie.createKernel(function(Q){const U=Q[this.thread.y][this.thread.x];this.color(0,U.g/255,0,255)},{output:[Y,re],graphical:!0,argumentTypes:{v:"Array2D(4)"}});ke(_e);const it=ie.createKernel(function(Q){const U=Q[this.thread.y][this.thread.x];this.color(0,0,U.b/255,255)},{output:[Y,re],graphical:!0,argumentTypes:{v:"Array2D(4)"}});it(_e);const vt=ie.createKernel(function(Q){const U=Q[this.thread.y][this.thread.x];this.color(255,255,255,U.a/255)},{output:[Y,re],graphical:!0,argumentTypes:{v:"Array2D(4)"}});return vt(_e),[be.canvas,ke.canvas,it.canvas,vt.canvas]},getMinifySafeName:ie=>{try{const _e=L.parse(`const value = ${ie.toString()}`),{init:Y}=_e.body[0].declarations[0];return Y.body.name||Y.body.body[0].argument.name}catch{throw new Error("Unrecognized function type.  Please use `() => yourFunctionVariableHere` or function() { return yourFunctionVariableHere; }")}},sanitizeName:function(ie){return T.test(ie)&&(ie=ie.replace(T,"S_S")),H.test(ie)?ie=ie.replace(H,"U_U"):te.test(ie)&&(ie=ie.replace(te,"u_u")),ie}},T=/\$/,H=/__/,te=/_/,Se=S.getSystemEndianness();y.exports={utils:S}},{"./input":110,"./texture":113,acorn:1}]},{},[107])(107)})});const me={toTable(O){const d=O.reduce((p,y)=>Object.assign(p,y),{});return me.toHash(d)},toTable2D(O){const d={};let p=0;for(let y=0;y<O.length;y++){const N=O[y];for(let L=0;L<N.length;L++){const F=N[L];for(const z in F)F.hasOwnProperty(z)&&!d.hasOwnProperty(z)&&(d[z]=p++)}}return d},toInputTable2D(O){const d={};let p=0;for(let y=0;y<O.length;y++){const N=O[y].input;for(let L=0;L<N.length;L++){const F=N[L];for(const z in F)F.hasOwnProperty(z)&&(d.hasOwnProperty(z)||(d[z]=p++))}}return d},toOutputTable2D(O){const d={};let p=0;for(let y=0;y<O.length;y++){const N=O[y].output;for(let L=0;L<N.length;L++){const F=N[L];for(const z in F)F.hasOwnProperty(z)&&(d.hasOwnProperty(z)||(d[z]=p++))}}return d},toHash(O){const d={};let p=0;const y=Object.keys(O);for(let N=0;N<y.length;N++)d[y[N]]=p++;return d},toArray(O,d,p){const y=new Float32Array(p);for(const N in O)O.hasOwnProperty(N)&&(y[O[N]]=d.hasOwnProperty(N)?d[N]:0);return y},toArrayShort(O,d){const p=[];for(const y in O)if(O.hasOwnProperty(y)){if(!d.hasOwnProperty(y))break;p[O[y]]=d[y]}return Float32Array.from(p)},toArrays(O,d,p){const y=[];for(let N=0;N<d.length;N++)y.push(this.toArray(O,d[N],p));return y},toObject(O,d){const p={};for(const y in O)O.hasOwnProperty(y)&&(p[y]=d[O[y]]);return p},toObjectPartial(O,d,p=0,y=0){const N={};let L=0;for(const F in O)O.hasOwnProperty(F)&&(p>0&&L++<p||y>0&&L++>=y||(N[F]=d[O[F]-p]));return N},dataShape(O){const d=[];let p;O.hasOwnProperty("input")?(d.push("datum"),p=O.input):Array.isArray(O)?O[0]&&O[0].input?(d.push("array","datum"),p=O[0].input):Array.isArray(O[0])?(d.push("array"),p=O[0]):p=O:p=O;let y;for(;p;)if(y=Object.keys(p)[0],Array.isArray(p)||typeof p.buffer=="object"){d.push("array");const N=p[parseInt(y)];if(typeof N=="number"){d.push("number");break}else p=N}else if(typeof p=="object"&&typeof p.buffer!="object"){d.push("object");const N=p[y];if(typeof N=="number"){d.push("number");break}else p=N}else throw new Error("unhandled signature");return d},addKeys(O,d){if(Array.isArray(O))return d;let p=Object.keys(d).length;for(const y in O)O.hasOwnProperty(y)&&(d.hasOwnProperty(y)||(d[y]=p++));return d}};var Ce=q(function(O,d){var p=W&&W.__assign||function(){return p=Object.assign||function(F){for(var z,P=1,k=arguments.length;P<k;P++){z=arguments[P];for(var R in z)Object.prototype.hasOwnProperty.call(z,R)&&(F[R]=z[R])}return F},p.apply(this,arguments)};Object.defineProperty(d,"__esModule",{value:!0}),d.thaw=d.Block=d.Thaw=void 0;var y=(function(){function F(z,P){var k=this;P===void 0&&(P={});var R=p(p({},F.defaultSettings),P),S=R.each,T=R.done;this.i=0,this.isStopped=!1,this.items=z,this.options=P,this.tick=function(){if(!k.isStopped&&(k.timeout=setTimeout(k.tick,0),!F.thawing)){var H=k.items[k.i];if(k.i>=k.items.length){T!==null&&(F.thawing=!0,T(),F.thawing=!1),k.isStopped=!0,clearTimeout(k.timeout);return}S!==null?(F.thawing=!0,S(H,k.i),F.thawing=!1):H!==void 0&&H(),k.i++}},F.thaws.push(this),P.delay||this.tick()}return Object.defineProperty(F,"isThawing",{get:function(){return F.thawing},enumerable:!1,configurable:!0}),F.stopAll=function(){for(var z=0;z<F.thaws.length;z++)F.thaws[z].stop()},F.prototype.makeReady=function(){return this.isStopped?(this.isStopped=!1,!0):!1},F.prototype.add=function(z){return this.items.push(z),this.makeReady()&&this.tick(),this},F.prototype.insert=function(z){return this.items.splice(this.i,0,z),this.makeReady()&&this.tick(),this},F.prototype.addArray=function(z){return this.items=this.items.concat(z),this.makeReady()&&this.tick(),this},F.prototype.insertArray=function(z){var P=this.items.splice(0,this.i),k=this.items;return this.items=P.concat(z,k),this.makeReady()&&this.tick(),this},F.prototype.stop=function(){return this.isStopped=!0,clearTimeout(this.timeout),this.options.done&&this.options.done(),this},F.thawing=!1,F.thaws=[],F.defaultSettings={each:null,done:null},F})();d.Thaw=y;function N(F,z){return new y(F,z)}d.thaw=N;var L=(function(){function F(z,P){P===void 0&&(P=200),this.index=0,this.thaws=[],this.count=P,this.options=z}return F.prototype.add=function(z){var P=this.next();return P.add(z),this},F.prototype.addArray=function(z){var P=this.next();return P.addArray(z),this},F.prototype.insert=function(z){var P=this.next();return P.insert(z),this},F.prototype.insertArray=function(z){var P=this.next();return P.insertArray(z),this},F.prototype.stop=function(){for(var z=0;z<this.thaws.length;z++)this.thaws[z].stop();return this},F.prototype.next=function(){var z,P=this.thaws;return P.length<this.count?(z=new y([],this.options),P.push(z)):z=P[this.index]||null,this.index++,this.index>=this.count&&(this.index=0),z},F})();d.Block=L,typeof window<"u"&&(window.Thaw=y,window.thaw=N,window.Thaw.Block=L)});function Ve(O){const d=[];for(let p=0;p<O.length;p++)d.push(Float32Array.from(O[p]));return d}function pe(O,d){const p=[];for(let y=0;y<O.length;y++)p.push(Float32Array.from(O[y]));for(let y=0;y<d.length;y++)p.push(Float32Array.from(d[y]));return p}function ee(O){const d=[];for(let p=0;p<O.length;p++)d.push(Float32Array.from([O[p]]));return d}function J(O,d){const p=[];for(let y=0;y<O.length;y++)p.push(Float32Array.from([O[y]]));for(let y=0;y<d.length;y++)p.push(Float32Array.from([d[y]]));return p}function ye(O){return Float32Array.from(O)}function X(O,d,p,y,N,L){const F=[];for(let z=0;z<O.length;z++){const P=O[z],k=new Float32Array(N);for(const R in P)P.hasOwnProperty(R)&&(k[p[R]]=P[R]);F.push(k)}for(let z=0;z<d.length;z++){const P=d[z],k=new Float32Array(L);for(const R in P)P.hasOwnProperty(R)&&(k[y[R]]=P[R]);F.push(k)}return F}function ae(O){const d=[];for(const p in O)O.hasOwnProperty(p)&&d.push(Float32Array.from([O[p]]));return d}function le(O,d){const p=[];for(const y in O)O.hasOwnProperty(y)&&p.push(Float32Array.from([O[y]]));for(const y in d)d.hasOwnProperty(y)&&p.push(Float32Array.from([d[y]]));return p}function ze(O,d,p){const y=new Float32Array(p);for(const N in O)O.hasOwnProperty(N)&&(y[d[N]]=O[N]);return y}class nt{constructor(d,p){this.prop=null,this.table={},this.length=0;const y=this.table;if(p){this.prop=p;for(let N=0;N<d.length;N++){const F=d[N][p];for(const z in F)F.hasOwnProperty(z)&&(y.hasOwnProperty(z)||(y[z]=this.length++))}}else if(Array.isArray(d)&&Array.isArray(d[0]))for(let N=0;N<d.length;N++){const L=d[N];for(let F=0;F<L.length;F++){const z=L[F];for(const P in z)z.hasOwnProperty(P)&&(y.hasOwnProperty(P)||(y[P]=this.length++))}}else for(let N=0;N<d.length;N++){const L=d[N];for(const F in L)L.hasOwnProperty(F)&&(y.hasOwnProperty(F)||(y[F]=this.length++))}}}function je(O){return Array.isArray(O)||O instanceof Float32Array?Math.max(...O):Math.max(...Object.values(O))}function Je(O){let d=0;for(let p=0;p<O.length;p++)d+=O[p]**2;return d/O.length}function qe(){return Math.random()*.4-.2}function ot(O,d){return Math.random()*(d-O)+O}function St(){if(St.returnV)return St.returnV=!1,St.vVal;const O=2*Math.random()-1,d=2*Math.random()-1,p=O*O+d*d;if(p===0||p>1)return St();const y=Math.sqrt(-2*Math.log(p)/p);return St.vVal=d*y,St.returnV=!0,O*y}function Ne(O,d){return Math.floor(Math.random()*(d-O)+O)}function se(O,d){return O+St()*d}St.returnV=!1,St.vVal=0;var Ee=Object.freeze({__proto__:null,randomFloat:ot,gaussRandom:St,randomInteger:Ne,randomN:se});function De(O,d=null){const p=new Float32Array(O);if(d===null)for(let y=0;y<O;y++)p[y]=qe();else for(let y=0;y<O;y++)p[y]=ot(-d,d);return p}function Be(O,d,p){const y=new Array(d);for(let N=0;N<d;N++)y[N]=De(O,p);return y}function $e(O,d,p,y){const N=new Array(p);for(let L=0;L<p;L++)N[L]=Be(O,d,y);return N}function Ye(O){return new Float32Array(O)}function ct(O,d){if(O.buffer instanceof ArrayBuffer)return null;if(Array.isArray(O))return ye;if(!d)throw new Error("table is not Object");const{length:p}=Object.keys(d);return y=>{const N=new Float32Array(p);for(const L in d)d.hasOwnProperty(L)&&typeof y[L]=="number"&&(N[d[L]]=y[L]||0);return N}}function ut(){return{inputSize:0,outputSize:0,binaryThresh:.5}}function Tt(){return{activation:"sigmoid",iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,leakyReluAlpha:.01,learningRate:.3,momentum:.1,callbackPeriod:10,timeout:1/0,beta1:.9,beta2:.999,epsilon:1e-8}}class Ft{constructor(d={}){this.options=ut(),this.trainOpts=Tt(),this.sizes=[],this.outputLayer=-1,this.biases=[],this.weights=[],this.outputs=[],this.deltas=[],this.changes=[],this.errors=[],this.errorCheckInterval=1,this.inputLookup=null,this.inputLookupLength=0,this.outputLookup=null,this.outputLookupLength=0,this._formatInput=null,this._formatOutput=null,this.runInput=L=>(this.setActivation(),this.runInput(L)),this.calculateDeltas=L=>(this.setActivation(),this.calculateDeltas(L)),this.biasChangesLow=[],this.biasChangesHigh=[],this.changesLow=[],this.changesHigh=[],this.iterations=0,this.options={...this.options,...d},this.updateTrainingOptions(d);const{inputSize:p,hiddenLayers:y,outputSize:N}=this.options;p&&N&&(this.sizes=[p].concat(y??[]).concat([N]))}initialize(){if(!this.sizes.length)throw new Error("Sizes must be set before initializing");this.outputLayer=this.sizes.length-1,this.biases=new Array(this.outputLayer),this.weights=new Array(this.outputLayer),this.outputs=new Array(this.outputLayer),this.deltas=new Array(this.outputLayer),this.changes=new Array(this.outputLayer),this.errors=new Array(this.outputLayer);for(let d=0;d<=this.outputLayer;d++){const p=this.sizes[d];if(this.deltas[d]=Ye(p),this.errors[d]=Ye(p),this.outputs[d]=Ye(p),d>0){this.biases[d]=De(p),this.weights[d]=new Array(p),this.changes[d]=new Array(p);for(let y=0;y<p;y++){const N=this.sizes[d-1];this.weights[d][y]=De(N),this.changes[d][y]=Ye(N)}}}this.setActivation(),this.trainOpts.praxis==="adam"&&this._setupAdam()}setActivation(d){const p=d??this.trainOpts.activation;switch(p){case"sigmoid":this.runInput=this._runInputSigmoid,this.calculateDeltas=this._calculateDeltasSigmoid;break;case"relu":this.runInput=this._runInputRelu,this.calculateDeltas=this._calculateDeltasRelu;break;case"leaky-relu":this.runInput=this._runInputLeakyRelu,this.calculateDeltas=this._calculateDeltasLeakyRelu;break;case"tanh":this.runInput=this._runInputTanh,this.calculateDeltas=this._calculateDeltasTanh;break;default:throw new Error(`Unknown activation ${p}. Available activations are: 'sigmoid', 'relu', 'leaky-relu', 'tanh'`)}}get isRunnable(){return this.sizes.length>0}run(d){if(!this.isRunnable)throw new Error("network not runnable");let p;this.inputLookup?p=me.toArray(this.inputLookup,d,this.inputLookupLength):p=d,this.validateInput(p);const y=this.runInput(p).slice(0);return this.outputLookup?me.toObject(this.outputLookup,y):y}_runInputSigmoid(d){this.outputs[0]=d;let p=null;for(let y=1;y<=this.outputLayer;y++){const N=this.sizes[y],L=this.weights[y],F=this.biases[y],z=this.outputs[y];for(let P=0;P<N;P++){const k=L[P];let R=F[P];for(let S=0;S<k.length;S++)R+=k[S]*d[S];z[P]=1/(1+Math.exp(-R))}p=d=z}if(!p)throw new Error("output was empty");return p}_runInputRelu(d){this.outputs[0]=d;let p=null;for(let y=1;y<=this.outputLayer;y++){const N=this.sizes[y],L=this.weights[y],F=this.biases[y],z=this.outputs[y];for(let P=0;P<N;P++){const k=L[P];let R=F[P];for(let S=0;S<k.length;S++)R+=k[S]*d[S];z[P]=R<0?0:R}p=d=z}if(!p)throw new Error("output was empty");return p}_runInputLeakyRelu(d){this.outputs[0]=d;const{leakyReluAlpha:p}=this.trainOpts;let y=null;for(let N=1;N<=this.outputLayer;N++){const L=this.sizes[N],F=this.weights[N],z=this.biases[N],P=this.outputs[N];for(let k=0;k<L;k++){const R=F[k];let S=z[k];for(let T=0;T<R.length;T++)S+=R[T]*d[T];P[k]=Math.max(S,p*S)}y=d=P}if(!y)throw new Error("output was empty");return y}_runInputTanh(d){this.outputs[0]=d;let p=null;for(let y=1;y<=this.outputLayer;y++){const N=this.sizes[y],L=this.weights[y],F=this.biases[y],z=this.outputs[y];for(let P=0;P<N;P++){const k=L[P];let R=F[P];for(let S=0;S<k.length;S++)R+=k[S]*d[S];z[P]=Math.tanh(R)}p=d=z}if(!p)throw new Error("output was empty");return p}verifyIsInitialized(d){this.sizes.length&&this.outputLayer>0||(this.sizes=[],this.sizes.push(d[0].input.length),this.options.hiddenLayers?this.options.hiddenLayers.forEach(p=>{this.sizes.push(p)}):this.sizes.push(Math.max(3,Math.floor(d[0].input.length/2))),this.sizes.push(d[0].output.length),this.initialize())}updateTrainingOptions(d){const p={...this.trainOpts,...d};this.validateTrainingOptions(p),this.trainOpts=p,this.setLogMethod(this.trainOpts.log)}validateTrainingOptions(d){const p={activation:()=>["sigmoid","relu","leaky-relu","tanh"].includes(d.activation),iterations:()=>{const y=d.iterations;return typeof y=="number"&&y>0},errorThresh:()=>{const y=d.errorThresh;return typeof y=="number"&&y>0&&y<1},log:()=>{const y=d.log;return typeof y=="function"||typeof y=="boolean"},logPeriod:()=>{const y=d.logPeriod;return typeof y=="number"&&y>0},leakyReluAlpha:()=>{const y=d.leakyReluAlpha;return typeof y=="number"&&y>0&&y<1},learningRate:()=>{const y=d.learningRate;return typeof y=="number"&&y>0&&y<1},momentum:()=>{const y=d.momentum;return typeof y=="number"&&y>0&&y<1},callback:()=>{const y=d.callback;return typeof y=="function"||y===void 0},callbackPeriod:()=>{const y=d.callbackPeriod;return typeof y=="number"&&y>0},timeout:()=>{const y=d.timeout;return typeof y=="number"&&y>0},praxis:()=>{const y=d.praxis;return!y||y==="adam"},beta1:()=>{const y=d.beta1;return y>0&&y<1},beta2:()=>{const y=d.beta2;return y>0&&y<1},epsilon:()=>{const y=d.epsilon;return y>0&&y<1}};for(const y in p){const N=d;if(!p[y]())throw new Error(`[${y}, ${N[y]}] is out of normal training range, your network will probably not train.`)}}getTrainOptsJSON(){const{activation:d,iterations:p,errorThresh:y,log:N,logPeriod:L,leakyReluAlpha:F,learningRate:z,momentum:P,callbackPeriod:k,timeout:R,praxis:S,beta1:T,beta2:H,epsilon:te}=this.trainOpts;return{activation:d,iterations:p,errorThresh:y,log:typeof N=="function"?!0:typeof N=="boolean"?N:!1,logPeriod:L,leakyReluAlpha:F,learningRate:z,momentum:P,callbackPeriod:k,timeout:R===1/0?"Infinity":R,praxis:S,beta1:T,beta2:H,epsilon:te}}setLogMethod(d){typeof d=="function"?this.trainOpts.log=d:d?this.trainOpts.log=this.logTrainingStatus:this.trainOpts.log=!1}logTrainingStatus(d){console.log(`iterations: ${d.iterations}, training error: ${d.error}`)}calculateTrainingError(d){let p=0;for(let y=0;y<d.length;++y)p+=this.trainPattern(d[y],!0);return p/d.length}trainPatterns(d){for(let p=0;p<d.length;++p)this.trainPattern(d[p])}trainingTick(d,p,y){const{callback:N,callbackPeriod:L,errorThresh:F,iterations:z,log:P,logPeriod:k}=this.trainOpts;return p.iterations>=z||p.error<=F||Date.now()>=y?!1:(p.iterations++,P&&p.iterations%k===0?(p.error=this.calculateTrainingError(d),P(p)):p.iterations%this.errorCheckInterval===0?p.error=this.calculateTrainingError(d):this.trainPatterns(d),N&&p.iterations%L===0&&N({iterations:p.iterations,error:p.error}),!0)}prepTraining(d,p={}){this.updateTrainingOptions(p);const y=this.formatData(d),N=Date.now()+this.trainOpts.timeout,L={error:1,iterations:0};return this.verifyIsInitialized(y),this.validateData(y),{preparedData:y,status:L,endTime:N}}train(d,p={}){const{preparedData:y,status:N,endTime:L}=this.prepTraining(d,p);for(;this.trainingTick(y,N,L););return N}async trainAsync(d,p={}){const{preparedData:y,status:N,endTime:L}=this.prepTraining(d,p);return await new Promise((F,z)=>{try{const P=new Ce.Thaw(new Array(this.trainOpts.iterations),{delay:!0,each:()=>this.trainingTick(y,N,L)||P.stop(),done:()=>F(N)});P.tick()}catch(P){z(P)}})}trainPattern(d,p){return this.runInput(d.input),this.calculateDeltas(d.output),this.adjustWeights(),p?Je(this.errors[this.outputLayer]):null}_calculateDeltasSigmoid(d){for(let p=this.outputLayer;p>=0;p--){const y=this.sizes[p],N=this.outputs[p],L=this.errors[p],F=this.deltas[p],z=this.weights[p+1];for(let P=0;P<y;P++){const k=N[P];let R=0;if(p===this.outputLayer)R=d[P]-k;else{const S=this.deltas[p+1];for(let T=0;T<S.length;T++)R+=S[T]*z[T][P]}L[P]=R,F[P]=R*k*(1-k)}}}_calculateDeltasRelu(d){for(let p=this.outputLayer;p>=0;p--){const y=this.sizes[p],N=this.outputs[p],L=this.weights[p+1],F=this.deltas[p+1],z=this.errors[p],P=this.deltas[p];for(let k=0;k<y;k++){const R=N[k];let S=0;if(p===this.outputLayer)S=d[k]-R;else for(let T=0;T<F.length;T++)S+=F[T]*L[T][k];z[k]=S,P[k]=R>0?S:0}}}_calculateDeltasLeakyRelu(d){const p=this.trainOpts.leakyReluAlpha;for(let y=this.outputLayer;y>=0;y--){const N=this.sizes[y],L=this.outputs[y],F=this.deltas[y+1],z=this.weights[y+1],P=this.errors[y],k=this.deltas[y];for(let R=0;R<N;R++){const S=L[R];let T=0;if(y===this.outputLayer)T=d[R]-S;else for(let H=0;H<F.length;H++)T+=F[H]*z[H][R];P[R]=T,k[R]=S>0?T:p*T}}}_calculateDeltasTanh(d){for(let p=this.outputLayer;p>=0;p--){const y=this.sizes[p],N=this.outputs[p],L=this.deltas[p+1],F=this.weights[p+1],z=this.errors[p],P=this.deltas[p];for(let k=0;k<y;k++){const R=N[k];let S=0;if(p===this.outputLayer)S=d[k]-R;else for(let T=0;T<L.length;T++)S+=L[T]*F[T][k];z[k]=S,P[k]=(1-R*R)*S}}}adjustWeights(){const{learningRate:d,momentum:p}=this.trainOpts;for(let y=1;y<=this.outputLayer;y++){const N=this.outputs[y-1],L=this.sizes[y],F=this.deltas[y],z=this.changes[y],P=this.weights[y],k=this.biases[y];for(let R=0;R<L;R++){const S=F[R];for(let T=0;T<N.length;T++){let H=z[R][T];H=d*S*N[T]+p*H,z[R][T]=H,P[R][T]+=H}k[R]+=d*S}}}_setupAdam(){this.biasChangesLow=[],this.biasChangesHigh=[],this.changesLow=[],this.changesHigh=[],this.iterations=0;for(let d=0;d<=this.outputLayer;d++){const p=this.sizes[d];if(d>0){this.biasChangesLow[d]=Ye(p),this.biasChangesHigh[d]=Ye(p),this.changesLow[d]=new Array(p),this.changesHigh[d]=new Array(p);for(let y=0;y<p;y++){const N=this.sizes[d-1];this.changesLow[d][y]=Ye(N),this.changesHigh[d][y]=Ye(N)}}}this.adjustWeights=this._adjustWeightsAdam}_adjustWeightsAdam(){this.iterations++;const{iterations:d}=this,{beta1:p,beta2:y,epsilon:N,learningRate:L}=this.trainOpts;for(let F=1;F<=this.outputLayer;F++){const z=this.outputs[F-1],P=this.sizes[F],k=this.deltas[F],R=this.changesLow[F],S=this.changesHigh[F],T=this.weights[F],H=this.biases[F],te=this.biasChangesLow[F],Se=this.biasChangesHigh[F];for(let ie=0;ie<P;ie++){const _e=k[ie];for(let vt=0;vt<z.length;vt++){const Q=_e*z[vt],U=R[ie][vt]*p+(1-p)*Q,Oe=S[ie][vt]*y+(1-y)*Q*Q,Fe=U/(1-Math.pow(p,d)),bt=Oe/(1-Math.pow(y,d));R[ie][vt]=U,S[ie][vt]=Oe,T[ie][vt]+=L*Fe/(Math.sqrt(bt)+N)}const Y=k[ie],re=te[ie]*p+(1-p)*Y,be=Se[ie]*y+(1-y)*Y*Y,ke=te[ie]/(1-Math.pow(p,d)),it=Se[ie]/(1-Math.pow(y,d));te[ie]=re,Se[ie]=be,H[ie]+=L*ke/(Math.sqrt(it)+N)}}}validateData(d){const p=this.sizes[0],y=this.sizes[this.sizes.length-1],{length:N}=d;for(let L=0;L<N;L++){const{input:F,output:z}=d[L];if(F.length!==p)throw new Error(`input at index ${L} length ${F.length} must be ${p}`);if(d[L].output.length!==y)throw new Error(`output at index ${L} length ${z.length} must be ${y}`)}}validateInput(d){const p=this.sizes[0];if(d.length!==p)throw new Error(`input length ${d.length} must match options.inputSize of ${p}`)}formatData(d){if(!Array.isArray(d[0].input))if(this.inputLookup)this.inputLookupLength=Object.keys(this.inputLookup).length;else{const p=new nt(d,"input");this.inputLookup=p.table,this.inputLookupLength=p.length}if(!Array.isArray(d[0].output))if(this.outputLookup)this.outputLookupLength=Object.keys(this.outputLookup).length;else{const p=new nt(d,"output");this.outputLookup=p.table,this.outputLookupLength=p.length}if(this._formatInput||(this._formatInput=ct(d[0].input,this.inputLookup)),this._formatOutput||(this._formatOutput=ct(d[0].output,this.outputLookup)),this._formatInput&&this._formatOutput){const p=[];for(let y=0;y<d.length;y++)p.push({input:this._formatInput(d[y].input),output:this._formatOutput(d[y].output)});return p}if(this._formatInput){const p=[];for(let y=0;y<d.length;y++)p.push({input:this._formatInput(d[y].input),output:d[y].output});return p}if(this._formatOutput){const p=[];for(let y=0;y<d.length;y++)p.push({input:d[y].input,output:this._formatOutput(d[y].output)});return p}return d}addFormat(d){var p,y;(!Array.isArray(d.input)||typeof d.input[0]!="number")&&(this.inputLookup=me.addKeys(d.input,(p=this.inputLookup)!==null&&p!==void 0?p:{}),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length)),(!Array.isArray(d.output)||typeof d.output[0]!="number")&&(this.outputLookup=me.addKeys(d.output,(y=this.outputLookup)!==null&&y!==void 0?y:{}),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length))}test(d){const{preparedData:p}=this.prepTraining(d),y=p[0].output.length===1,N=[];let L=0;if(y){let F=0,z=0,P=0,k=0;for(let R=0;R<p.length;R++){const S=this.runInput(p[R].input),T=p[R].output,H=S[0]>this.options.binaryThresh?1:0,te=T[0];if(H!==te){const Se=p[R];N.push({input:Se.input,output:Se.output,actual:H,expected:te})}H===0&&te===0?k++:H===1&&te===1?P++:H===0&&te===1?z++:H===1&&te===0&&F++,L+=Je(S.map((Se,ie)=>T[ie]-Se))}return{error:L/p.length,misclasses:N,total:p.length,trueNeg:k,truePos:P,falseNeg:z,falsePos:F,precision:P>0?P/(P+F):0,recall:P>0?P/(P+z):0,accuracy:(k+P)/p.length}}for(let F=0;F<p.length;F++){const z=this.runInput(p[F].input),P=p[F].output,k=z.indexOf(je(z)),R=P.indexOf(je(P));if(k!==R){const S=p[F];N.push({input:S.input,output:S.output,actual:k,expected:R})}L+=Je(z.map((S,T)=>P[T]-S))}return{error:L/p.length,misclasses:N,total:p.length}}toJSON(){var d,p;this.isRunnable||this.initialize();const y=this.weights.map(z=>z.map(P=>Array.from(P))),N=this.biases.map(z=>Array.from(z)),L=[],F=this.sizes.length-1;for(let z=0;z<=F;z++)L.push({weights:(d=y[z])!==null&&d!==void 0?d:[],biases:(p=N[z])!==null&&p!==void 0?p:[]});return{type:"NeuralNetwork",sizes:[...this.sizes],layers:L,inputLookup:this.inputLookup?{...this.inputLookup}:null,inputLookupLength:this.inputLookupLength,outputLookup:this.outputLookup?{...this.outputLookup}:null,outputLookupLength:this.outputLookupLength,options:{...this.options},trainOpts:this.getTrainOptsJSON()}}fromJSON(d){if(this.options={...ut(),...d.options},d.hasOwnProperty("trainOpts")){const L={...d.trainOpts,timeout:d.trainOpts.timeout==="Infinity"?1/0:d.trainOpts.timeout};this.updateTrainingOptions(L)}this.sizes=d.sizes,this.initialize(),this.inputLookup=d.inputLookup?{...d.inputLookup}:null,this.inputLookupLength=d.inputLookupLength,this.outputLookup=d.outputLookup?{...d.outputLookup}:null,this.outputLookupLength=d.outputLookupLength;const p=d.layers,y=this.weights.map((L,F)=>p[F].weights.map(z=>Float32Array.from(z))),N=this.biases.map((L,F)=>Float32Array.from(p[F].biases));for(let L=0;L<=this.outputLayer;L++)this.weights[L]=y[L]||[],this.biases[L]=N[L]||[];return this}toFunction(d){const{activation:p,leakyReluAlpha:y}=this.trainOpts;let N=!1;const L=(S,T)=>{if(S===0)return`(input[${T}]||0)`;const H=this.weights[S][T],te=this.biases[S][T];if(!H)throw new Error(`weights at layerIndex ${S} & nodeIndex ${T} not found`);if(!te)throw new Error(`bias as layerIndex ${S} & nodeIndex ${T} not found`);const Se=[];H.forEach((_e,Y)=>{_e<0?Se.push(`${_e}*${L(S-1,Y)}`):Se.push(`+${_e}*${L(S-1,Y)}`)});const ie=`(${te.toString()}${Se.join("")})`;switch(p){case"sigmoid":return`1/(1+1/Math.exp(${ie}))`;case"relu":return N=!0,`((v=${ie})<0?0:v)`;case"leaky-relu":return N=!0,`Math.max((v=${ie}),${y}*v)`;case"tanh":return`Math.tanh(${ie})`;default:throw new Error(`Unknown activation ${p}. Available activations are: 'sigmoid', 'relu', 'leaky-relu', 'tanh'`)}};function F(S){if(S.find(T=>T.includes('"')))throw new Error(`key contains '"', which is not compatible`)}const z=[];let P,k="";if(this.inputLookup){const S=Object.keys(this.inputLookup);F(S),k=`input = new Float32Array([${Object.keys(this.inputLookup).map(T=>`input["${T}"]`).join(",")}]);`}if(this.sizes.length<1)throw new Error("No layers");for(let S=0;S<this.sizes[this.outputLayer];S++)z.push(L(this.outputLayer,S));if(this.outputLookup){const S=Object.keys(this.outputLookup);F(S),P=`{${S.map((H,te)=>`"${H}":${z[te]}`).join(",")}}`}else P=`[${z.join(",")}]`;const R=`${k}${N?"var v;":""}return ${P};`;return new Function("input",d?d(R):R)}}let Wt=null;function qt(O){Wt=O}function Et(O,d){let p=Wt;return p===null&&(p=new he.GPU({mode:"gpu"}),qt(p)),p.createKernel(O,d).setPipeline(!0)}function Pe(O,d,p){let y=Wt;return y===null&&(y=new he.GPU({mode:"gpu"}),qt(y)),y.createKernelMap(O,d,p).setPipeline(!0)}function $t(O,d){return new he.Input(O,d)}function Dt(O){O instanceof he.Texture&&O.delete()}function wn(O){if(O instanceof he.Texture){O.clear();return}if(Array.isArray(O)){if(typeof O[0]=="number")O.fill(0);else if(typeof O[0][0]=="number"){for(let d=0;d<O.length;d++)O[d].fill(0);return}else if(typeof O[0][0][0]=="number"){for(let d=0;d<O.length;d++){const p=O[d];for(let y=0;y<p.length;y++)p[y].fill(0)}return}}if(O instanceof Float32Array){O.fill(0);return}throw new Error("unhandled value")}function _t(O){if(O instanceof he.Texture)return O.clone();if(O instanceof Float32Array)return O.slice(0);if(Array.isArray(O)){if(typeof O[0]=="number")return O.slice(0);if(typeof O[0][0]=="number"){const d=new Array(O.length);for(let p=0;p<O.length;p++)d[p]=O[p].slice(0);return d}else if(typeof O[0][0][0]=="number"){const d=new Array(O.length);for(let p=0;p<O.length;p++){const y=O[p],N=new Array(y.length);for(let L=0;L<y.length;L++)N[L]=y[L].slice(0)}return d}}throw new Error("unhandled value")}function en(O,d,p){let y=d[this.thread.x];for(let N=0;N<this.constants.size;N++)y+=O[this.thread.x][N]*p[N];return 1/(1+Math.exp(-y))}function Xt(O,d,p){let y=d[this.thread.x];for(let N=0;N<this.constants.size;N++)y+=O[this.thread.x][N]*p[N];return y<0?0:y}function Tn(O,d,p){let y=d[this.thread.x];for(let N=0;N<this.constants.size;N++)y+=O[this.thread.x][N]*p[N];return y<0?0:.01*y}function bn(O,d,p){let y=d[this.thread.x];for(let N=0;N<this.constants.size;N++)y+=O[this.thread.x][N]*p[N];return Math.tanh(y)}function Un(O,d){return d-O}function ii(O,d){return O*d*(1-d)}function Bn(O,d){return d>0?O:0}function li(O,d){return d>0?O:.01*O}function Xn(O,d){return(1-d*d)*O}function ln(O,d,p,y){let N=0;for(let L=0;L<d;L++)N+=y[L]*p[L][O];return N}function $n(O,d,p,y,N){return O*y*N+d*p}function cn(O,d){return O+d}function er(O,d){return O[this.thread.x]+d[this.thread.x]*this.constants.learningRate}function Jn(O){let d=0;for(let p=0;p<this.constants.size;p++)d+=O[p]**2;return d/this.constants.size}class mn extends Ft{constructor(d={}){super(d),this.texturizeInputData=()=>{throw new Error("not yet setup")},this.forwardPropagate=[],this.backwardPropagate=[],this.changesPropagate=[],this.biasesPropagate=[],this.getMSE=()=>{throw new Error("not yet setup")},this._addMSE=()=>{throw new Error("not yet setup")},this._divideMSESum=()=>{throw new Error("not yet setup")},this.outputs=[],this.deltas=[],this.errors=[],this.weights=[],this.changes=[],this.biases=[],this.runInput=p=>{let y;this.outputs[0]=p;for(let N=1;N<=this.outputLayer;N++)Dt(this.outputs[N]),this.outputs[N]=this.forwardPropagate[N](this.weights[N],this.biases[N],p),y=p=this.outputs[N];return y},this.calculateDeltas=p=>{for(let y=this.outputLayer;y>0;y--){Dt(this.deltas[y]),Dt(this.errors[y]);let N;y===this.outputLayer?N=this.backwardPropagate[y](this.outputs[y],p):N=this.backwardPropagate[y](this.weights[y+1],this.outputs[y],this.deltas[y+1]),this.deltas[y]=N.result,this.errors[y]=N.error}},this.errorCheckInterval=100,this.gpu=new he.GPU({mode:d.mode})}initialize(){super.initialize(),this.buildRunInput(),this.buildCalculateDeltas(),this.buildGetChanges(),this.buildChangeBiases(),this.buildGetMSE()}setActivation(){}trainPattern(d,p){return this.runInput(d.input),this.calculateDeltas(d.output),this.adjustWeights(),p?this.getMSE(this.errors[this.outputLayer]):null}calculateTrainingError(d){let p=new Float32Array([0]);for(let N=0;N<d.length;++N){const L=p,F=this.trainPattern(d[N],!0);p=this._addMSE(p,F),Dt(F),Dt(L)}const y=this._divideMSESum(d.length,p);return Dt(p),(y instanceof he.Texture?y.toArray():y)[0]}adjustWeights(){this.getChanges(),this.changeBiases()}buildRunInput(){let d=null;switch(this.trainOpts.activation){case"sigmoid":d=en;break;case"relu":d=Xt;break;case"leaky-relu":d=Tn;break;case"tanh":d=bn;break;default:throw new Error(`Unknown activation ${this.trainOpts.activation}. Available activations are: 'sigmoid', 'relu', 'leaky-relu', 'tanh'`)}for(let p=1;p<=this.outputLayer;p++)this.forwardPropagate[p]=this.gpu.createKernel(d,{output:[this.sizes[p]],pipeline:!0,constants:{size:this.sizes[p-1]},immutable:!0});this.texturizeInputData=this.gpu.createKernel(function(p){return p[this.thread.x]},{output:[this.sizes[1]],pipeline:!0,immutable:!0})}buildCalculateDeltas(){let d;switch(this.trainOpts.activation){case"sigmoid":d=ii;break;case"relu":d=Bn;break;case"leaky-relu":d=li;break;case"tanh":d=Xn;break;default:throw new Error(`Unknown activation ${this.trainOpts.activation}. Available activations are: 'sigmoid', 'relu', 'leaky-relu', 'tanh'`)}d=he.alias(he.utils.getMinifySafeName(()=>d),d),this.gpu.addFunction(d);for(let p=this.outputLayer;p>0;p--)p===this.outputLayer?this.backwardPropagate[this.outputLayer]=this.gpu.createKernelMap({error:Un},function(y,N){const L=y[this.thread.x],F=N[this.thread.x];return d(Un(L,F),L)},{output:[this.sizes[this.outputLayer]],pipeline:!0,immutable:!0}):this.backwardPropagate[p]=this.gpu.createKernelMap({error:ln},function(y,N,L){const F=N[this.thread.x];return d(ln(this.thread.x,this.constants.size,y,L),F)},{output:[this.sizes[p]],pipeline:!0,constants:{size:this.sizes[p+1]},immutable:!0})}buildGetChanges(){for(let d=1;d<=this.outputLayer;d++)this.changesPropagate[d]=this.gpu.createKernelMap({weights:cn,changes:$n},function(p,y,N,L){const F=$n(this.constants.learningRate,this.constants.momentum,L[this.thread.y][this.thread.x],y[this.thread.y],p[this.thread.x]);return cn(F,N[this.thread.y][this.thread.x])},{output:[this.sizes[d-1],this.sizes[d]],pipeline:!0,constants:{size:this.sizes[d-1],learningRate:this.trainOpts.learningRate,momentum:this.trainOpts.momentum},immutable:!0})}getChanges(){for(let d=1;d<=this.outputLayer;d++){const p=this.weights[d],y=this.changes[d],N=this.changesPropagate[d](this.outputs[d-1],this.deltas[d],p,y);Dt(p),Dt(y),this.weights[d]=N.weights,this.changes[d]=N.changes,Dt(N.result)}}buildChangeBiases(){for(let d=1;d<=this.outputLayer;d++)this.biasesPropagate[d]=this.gpu.createKernel(er,{output:[this.sizes[d]],pipeline:!0,constants:{learningRate:this.trainOpts.learningRate},immutable:!0})}changeBiases(){for(let d=1;d<=this.outputLayer;d++){const p=this.biases[d];this.biases[d]=this.biasesPropagate[d](p,this.deltas[d]),Dt(p)}}buildGetMSE(){this.getMSE=this.gpu.createKernel(Jn,{output:[1],constants:{size:this.sizes[this.outputLayer]},pipeline:!0,immutable:!0}),this._addMSE=this.gpu.createKernel(function(d,p){return d[0]+p[0]},{output:[1],pipeline:!0,immutable:!0}),this._divideMSESum=this.gpu.createKernel(function(d,p){const y=p[0];return y>0?y/d:0},{output:[1]})}run(d){if(!this.isRunnable)throw new Error("network not runnable");let p;this.inputLookup?p=me.toArray(this.inputLookup,d,this.inputLookupLength):p=d,this.validateInput(p);const y=this.runInput(p),N=y instanceof he.Texture?y.toArray():y;return this.outputLookup?me.toObject(this.outputLookup,N):N}prepTraining(d,p={}){this.updateTrainingOptions(p);const y=this.formatData(d),N=Date.now()+this.trainOpts.timeout,L={error:1,iterations:0};this.verifyIsInitialized(y);const F=this.gpu.createKernel(function(z){return z[this.thread.x]},{output:[y[0].output.length],pipeline:!0,immutable:!0});return{preparedData:y.map(z=>({input:this.texturizeInputData(z.input),output:F(z.output)})),status:L,endTime:N}}toFunction(){throw new Error(`${this.constructor.name}-toFunction is not yet implemented`)}toJSON(){var d,p;this.sizes===null&&this.initialize();const y=this.weights.map(F=>(F instanceof he.Texture?F.toArray():F).map(z=>Array.from(z))),N=this.biases.map(F=>Array.from(F instanceof he.Texture?F.toArray():F)),L=[];for(let F=0;F<=this.outputLayer;F++)L.push({weights:(d=y[F])!==null&&d!==void 0?d:[],biases:(p=N[F])!==null&&p!==void 0?p:[]});return{type:"NeuralNetworkGPU",sizes:[...this.sizes],layers:L,inputLookup:this.inputLookup?{...this.inputLookup}:null,inputLookupLength:this.inputLookupLength,outputLookup:this.outputLookup?{...this.outputLookup}:null,outputLookupLength:this.outputLookupLength,options:{...this.options},trainOpts:this.getTrainOptsJSON()}}}class On extends Error{constructor(d){super(`Cannot run a ${d.constructor.name} before it is trained.`)}}class qn{constructor(d){d??(d={}),d.binaryThresh,d.hiddenLayers,d.decodedSize&&d.decodedSize,this.denoiser=new mn(d)}denoise(d){return this.denoiser.run(d)}decode(d){if(!this.decoder)throw new On(this);return this.decoder.run(d)}encode(d){if(!this.denoiser)throw new On(this);this.denoiser.run(d);let p=this.encodedLayer;return p instanceof he.Texture?p=p.toArray():p=p.slice(0),p}likelyIncludesAnomalies(d,p=.2){var y;const N=[],L=this.denoise(d);for(let P=0;P<((y=d.length)!==null&&y!==void 0?y:0);P++)N[P]=Math.abs(d[P]-L[P]);return N.reduce((P,k)=>P+k)/d.length>p}train(d,p){const y=[];for(const L of d)y.push({input:L,output:L});const N=this.denoiser.train(y,p);return this.decoder=this.createDecoder(),N}createDecoder(){const d=this.denoiser.toJSON(),p=[],y=[];for(let L=this.encodedLayerIndex;L<this.denoiser.sizes.length;L++)p.push(d.layers[L]),y.push(d.sizes[L]);return d.layers=p,d.sizes=y,d.options.inputSize=d.sizes[0],new mn().fromJSON(d)}get encodedLayer(){return this.denoiser.outputs[this.encodedLayerIndex]}get encodedLayerIndex(){return Math.round(this.denoiser.outputs.length*.5)-1}}class on{constructor(d){this.json={avgs:{error:0,iterations:0,testTime:0,trainTime:0},stats:{total:0,testSize:0,trainSize:0},sets:[]},this.initClassifier=d}testPartition(d,p,y){const N=this.initClassifier(),L=Date.now(),F=N.train(p,d),z=Date.now(),P=N.test(y),k=Date.now();return{...P,trainTime:z-L,testTime:k-z,iterations:F.iterations,error:F.error,total:P.total,network:N.toJSON()}}shuffleArray(d){for(let p=d.length-1;p>0;p--){const y=Math.floor(Math.random()*(p+1)),N=d[p];d[p]=d[y],d[y]=N}return d}train(d,p={},y=4){if(d.length<y)throw new Error(`Training set size is too small for ${d.length} k folds of ${y}`);this.shuffleArray(d);const N=d.length/y,L={trainTime:0,testTime:0,iterations:0,error:0},F={total:0,testSize:0,trainSize:0},z={total:0,testSize:0,trainSize:0,truePos:0,trueNeg:0,falsePos:0,falseNeg:0,precision:0,recall:0,accuracy:0},P=[];let k=null;for(let R=0;R<y;R++){const S=d.slice(0),T=S.splice(R*N,N),H=S,te=this.testPartition(p,H,T);k===null&&(k=te.hasOwnProperty("falseNeg")&&te.hasOwnProperty("falsePos")&&te.hasOwnProperty("trueNeg")&&te.hasOwnProperty("truePos"),k&&Object.assign(F,z)),L.iterations+=te.iterations,L.testTime+=te.testTime,L.trainTime+=te.trainTime,L.error+=te.error,F.total+=te.total,on.isBinaryStats(F)&&on.isBinaryPartitionResults(te)&&(F.accuracy+=te.accuracy,F.falseNeg+=te.falseNeg,F.falsePos+=te.falsePos,F.precision+=te.precision,F.recall+=te.recall,F.trueNeg+=te.trueNeg,F.truePos+=te.truePos),P.push(te)}return L.error/=y,L.iterations/=y,L.testTime/=y,L.trainTime/=y,on.isBinaryStats(F)&&(F.precision=F.truePos/(F.truePos+F.falsePos),F.recall=F.truePos/(F.truePos+F.falseNeg),F.accuracy=(F.trueNeg+F.truePos)/F.total),F.testSize=N,F.trainSize=d.length-N,this.json={avgs:L,stats:F,sets:P},this.json}toNeuralNetwork(){return this.fromJSON(this.json)}toJSON(){return this.json}fromJSON(d){const p=d.sets.reduce((y,N)=>y.error<N.error?y:N);return this.initClassifier().fromJSON(p.network)}}on.isBinaryStats=O=>O.accuracy!==void 0,on.isBinaryResults=O=>O.stats.accuracy!==void 0,on.isBinaryPartitionResults=O=>O.accuracy!==void 0;function Ni(O){let d=0;for(let p=0;p<this.constants.height;p++)for(let y=0;y<this.constants.width;y++)d+=O[p][y]**2;return d/this.constants.length}class Mn{constructor({width:d,height:p}){this.calculate=Et(Ni,{output:[1],constants:{width:d,height:p,length:d*p},immutable:!0}),this.addAbsolute=Et(function(y,N){return y[0]+Math.abs(N[0][0])},{output:[1],immutable:!0}),this.add=Et(function(y,N){return y[0]+N[0]},{output:[1],immutable:!0}),this.divide=Et(function(y,N){const L=N[0];return L>0?L/y:0},{output:[1],immutable:!0})}}const xn={width:1,height:1,depth:null,weights:null,deltas:null,praxis:null,praxisOpts:null,cleanupDeltas:!0};class Qn{constructor(d){this.praxis=null,this.predictKernel=null,this.compareKernel=null,d?this.settings={...xn,...d}:this.settings={...xn},this.setupPraxis()}get width(){var d;return(d=this.settings.width)!==null&&d!==void 0?d:0}get height(){var d;return(d=this.settings.height)!==null&&d!==void 0?d:0}get depth(){var d;return(d=this.settings.depth)!==null&&d!==void 0?d:0}get weights(){return this.settings.weights}set weights(d){this.settings.weights=d,this.settings.cleanupDeltas&&this.deltas&&wn(this.deltas)}get deltas(){return this.settings.deltas}set deltas(d){this.settings.deltas=d}get id(){var d;return(d=this.settings.id)!==null&&d!==void 0?d:""}set id(d){this.settings.id=d}setupPraxis(){const{initPraxis:d,praxis:p,praxisOpts:y}=this.settings;this.praxis||(d?y?this.praxis=d(this,y):this.praxis=d(this):p&&(this.praxis=p))}validate(){if(Number.isNaN(this.height))throw new Error(`${this.constructor.name} layer height is not a number`);if(Number.isNaN(this.width))throw new Error(`${this.constructor.name} layer width is not a number`);if(this.height<1)throw new Error(`${this.constructor.name} layer height is less than 1`);if(this.width<1)throw new Error(`${this.constructor.name} layer width is less than 1`)}setupKernels(d){}reuseKernels(d){if(d.width!==this.width)throw new Error(`${this.constructor.name} kernel width mismatch ${d.width} is not ${this.width}`);if(d.height!==this.height)throw new Error(`${this.constructor.name} kernel width mismatch ${d.height} is not ${this.height}`);if(d.hasOwnProperty("predictKernel")&&d.predictKernel!==null){if(!d.predictKernel.immutable)throw new Error(`${d.constructor.name}.predictKernel is not reusable, set kernel.immutable = true`);this.predictKernel=d.predictKernel}if(d.hasOwnProperty("compareKernel")&&d.compareKernel!==null){if(!d.compareKernel.immutable)throw new Error(`${d.constructor.name}.compareKernel is not reusable, set kernel.immutable = true`);this.compareKernel=d.compareKernel}this.praxis=d.praxis}predict(d){}compare(d){}learn(d){}toArray(){return Array.isArray(this.weights)?this.weights:this.weights.toArray()}toJSON(){return Qn.toJSON(this)}static toJSON(d){const{weights:p}=d;return{width:d.width,height:d.height,depth:d.depth,weights:Qt(p&&p instanceof he.Texture?p.toArray():p),type:d.constructor.name,praxisOpts:d.praxis?d.praxis.toJSON():null}}}function Qt(O){if(O===null)return null;if(Array.isArray(O)){if(typeof O[0]=="number")return O;if(Array.isArray(O[0])&&typeof O[0][0]=="number")return O;if(Array.isArray(O[0][0])&&typeof O[0][0][0]=="number")return O;if(O[0]instanceof Float32Array)return O.map(p=>Array.from(p));if(O[0][0]instanceof Float32Array)return O.map(p=>p.map(y=>Array.from(y)))}else if(O)return Array.from(O);throw new Error("unexpected value")}function Ht(O,d){const p=new Array(d);for(let y=0;y<d;y++)p[y]=Ye(O);return p}function Kn(O,d,p){const y=new Array(p);for(let N=0;N<p;N++)y[N]=Ht(O,d);return y}class kr extends Qn{constructor(d,p){super(p),this.inputLayer=d;const{width:y,height:N,depth:L}=this;this.predictKernel=null,this.compareKernel=null,this.validate(),L>0?(this.weights=Kn(y,N,L),this.deltas=Kn(y,N,L)):N>0&&(this.weights=Ht(y,N),this.deltas=Ht(y,N)),this.setupPraxis()}get width(){return this.inputLayer.width}get height(){return this.inputLayer.height}get depth(){return this.inputLayer.depth}}class vr extends Qn{constructor(d,p){super(),this.settings=d,this.inputLayer=p}get width(){return this.inputLayer.width}get height(){return this.inputLayer.height}get depth(){return this.inputLayer.depth}get filterCount(){return this.settings.filterCount}get filterWidth(){return this.settings.filterWidth}get filterHeight(){return this.settings.filterHeight}get filters(){return this.settings.filters}set filters(d){this.settings.filters=d}get filterDeltas(){return this.settings.filterDeltas}set filterDeltas(d){this.settings.filterDeltas=d}}class Cr{constructor(){this.predictKernel=null,this.compareKernel=null,this.praxis=null}get width(){return this.settings.width}get height(){return this.settings.height}get depth(){return this.settings.depth}get weights(){return this.settings.weights}set weights(d){this.settings.weights=d}get deltas(){return this.settings.deltas}set deltas(d){this.settings.deltas=d}toJSON(){return Qn.toJSON(this)}}class Ci extends Qn{constructor(d,p){super({...p,width:d.width,height:d.height,depth:d.depth}),this.inputLayer=d}validate(){var d;if(super.validate(),this.width!==this.inputLayer.width)throw new Error(`width of ${this.width} does not match inputLayer.width of ${this.inputLayer.width}`);if(this.height!==this.inputLayer.height)throw new Error(`height of ${this.height} does not match inputLayer.height of ${this.inputLayer.height}`);if(this.depth!==((d=this.inputLayer.depth)!==null&&d!==void 0?d:0))throw new Error(`depth of ${this.depth} does not match inputLayer.depth of ${this.inputLayer.depth}`)}}class dn extends Qn{constructor(d,p,y){super(y),this.inputLayer1=d,this.inputLayer2=p,this.validate(),this.weights=Ht(this.width,this.height),this.deltas=Ht(this.width,this.height),this.setupPraxis()}}function Aa(O,d){return O[this.thread.y][this.thread.x]-d[this.thread.x]}function ta(O,d){return O[this.thread.y][this.thread.x]-d[this.thread.y][this.thread.x]}class Rr extends Qn{constructor(d,p){if(super(d),this.inputLayer=p,this.validate(),this.depth)throw new Error("Target layer not implemented for depth");this.height?(this.weights=Ht(this.width,this.height),this.deltas=Ht(this.width,this.height),this.errors=Ht(this.width,this.height)):(this.weights=Ye(this.width),this.deltas=Ye(this.width),this.errors=Ye(this.width))}setupKernels(){this.width===1?this.compareKernel=Et(Aa,{output:[this.width,this.height],immutable:!0}):this.compareKernel=Et(ta,{output:[this.width,this.height],immutable:!0})}predict(){Dt(this.weights),this.weights=_t(this.inputLayer.weights)}compare(d){Dt(this.deltas),Dt(this.errors),Dt(this.inputLayer.deltas),this.deltas=this.compareKernel(this.weights,d),this.inputLayer.deltas=_t(this.deltas),this.errors=_t(this.deltas)}setupPraxis(){}}function ms(O,d){return new Rr(O,d)}class Pi{}class tr extends Qn{}class cr extends Qn{learn(d){const{weights:p}=this;if(!this.praxis)throw new Error("this.praxis not defined");this.weights=this.praxis.run(this,d),Dt(p)}}class os{constructor(d,p={}){this.layerTemplate=d,this.settings={...p},this.kernel=null}get width(){return this.layerTemplate.width}get height(){return this.layerTemplate.height}get depth(){return this.layerTemplate.depth}setupKernels(){}reuseKernels(d){if(d.width!==this.width)throw new Error(`${this.constructor.name} kernel width mismatch ${d.width} is not ${this.width}`);if(d.height!==this.height)throw new Error(`${this.constructor.name} kernel width mismatch ${d.height} is not ${this.height}`);d.hasOwnProperty("kernel")&&(this.kernel=d.kernel)}toJSON(){return{...this.settings}}}function Zr(O,d){return O[this.thread.y][this.thread.x]+this.constants.learningRate*d[this.thread.y][this.thread.x]}const qi={learningRate:.3};class Yi extends os{constructor(d,p){super(d),this.settings={...qi,...p},this.kernel=null}run(d){return this.kernel(d.weights,d.deltas)}setupKernels(){var d;this.kernel=Et(Zr,{output:[this.width,this.height],constants:{learningRate:(d=this.settings.learningRate)!==null&&d!==void 0?d:.01}})}}function Kr(O,d){return new Yi(O,d)}function ls(O){return O}function da(O,d,p,y){const N=O[this.thread.y][this.thread.x],L=y[this.thread.y][0],F=d[this.thread.y][this.thread.x],z=p[this.thread.x][0],P=this.constants.learningRate*L*z+this.constants.momentum*N;return F+P}const Va={learningRate:.3,momentum:.1,weightsLayer:null,incomingLayer:null,deltaLayer:null};class ys extends os{constructor(d,p){super(d),this.kernelMap=null,this.settings={...Va,...p},this.changes=Ht(d.width,d.height)}get learningRate(){return this.settings.learningRate}get momentum(){return this.settings.momentum}get weightsLayer(){return this.settings.weightsLayer}set weightsLayer(d){this.settings.weightsLayer=d}get deltaLayer(){return this.settings.deltaLayer}set deltaLayer(d){this.settings.deltaLayer=d}get incomingLayer(){return this.settings.incomingLayer}set incomingLayer(d){this.settings.incomingLayer=d}run(){const d=this.kernelMap(this.changes,this.weightsLayer.weights,this.incomingLayer.weights,this.deltaLayer.deltas);return this.changes=d.changes,d.result}setupKernels(){this.kernelMap=Pe({changes:ls},da,{output:[this.width,this.height],constants:{learningRate:this.learningRate,momentum:this.momentum}})}}function es(O,d){return new ys(O,d)}function to(O,d,p){return p*d+(1-d)*O*O}function Ps(O,d,p){return O>d?d:O<p?p:O}function Os(O,d,p){const y=d[this.thread.y][this.thread.x],N=Ps(y,this.constants.clipValue,-this.constants.clipValue),L=O[this.thread.y][this.thread.x],F=p[this.thread.y][this.thread.x],z=to(y,this.constants.decayRate,F);return L+-this.constants.learningRate*N/Math.sqrt(z+this.constants.smoothEps)-this.constants.regularizationStrength*L}const na={decayRate:.999,regularizationStrength:1e-6,learningRate:.01,smoothEps:1e-8,clipValue:5};class Ms extends os{constructor(d,p={}){super(d),this.kernelMap=null,this.settings={...na,...p},this.momenta=Ht(d.width,d.height)}get clipValue(){return this.settings.clipValue}get decayRate(){return this.settings.decayRate}get learningRate(){return this.settings.learningRate}get regularizationStrength(){return this.settings.regularizationStrength}get smoothEps(){return this.settings.smoothEps}run(d){const{momenta:p,result:y}=this.kernelMap(d.weights,d.deltas,this.momenta);return Dt(this.momenta),this.momenta=p,y}setupKernels(){this.kernelMap=Pe({momenta:to},Os,{output:[this.width,this.height],constants:{clipValue:this.clipValue,decayRate:this.decayRate,learningRate:this.learningRate,regularizationStrength:this.regularizationStrength,smoothEps:this.smoothEps},functions:[Ps],immutable:!0})}}function hr(O,d){return new Ms(O,d)}var fa=Object.freeze({__proto__:null,ArthurDeviationBiases:Yi,arthurDeviationBiases:Kr,ArthurDeviationWeights:ys,arthurDeviationWeights:es,MomentumRootMeanSquaredPropagation:Ms,momentumRootMeanSquaredPropagation:hr,MRmsProp:Ms,mRmsProp:hr});function Ts(O,d){O.hasOwnProperty("inputLayer")?Ts(O.inputLayer,d):(O.hasOwnProperty("inputLayer1")&&Ts(O.inputLayer1,d),O.hasOwnProperty("inputLayer2")&&Ts(O.inputLayer2,d)),d(O)}function Mo(O){const d=O.slice(0);for(let p=0;p<d.length;p++){let y=0;Ts(d[p],N=>{d.includes(N)||(d.splice(p+y,0,N),y++)})}return d}function el(O,d){if(O.width!==d.width)throw new Error(`Layer width mismatch of ${O.width} and ${d.width}`);if(O.height!==d.height)throw new Error(`Layer height mismatch of ${O.height} and ${d.height}`)}function tl(O,d){return O[this.thread.y][this.thread.x]+d[this.thread.y][this.thread.x]}class Fo extends dn{get width(){return this.inputLayer1.width}get height(){return this.inputLayer1.height}get depth(){return this.inputLayer1.depth}validate(){super.validate(),el(this.inputLayer1,this.inputLayer2)}setupKernels(){this.predictKernel=Et(tl,{output:[this.width,this.height],immutable:!0})}predict(){Dt(this.weights),this.weights=this.predictKernel(this.inputLayer1.weights,this.inputLayer2.weights)}compare(){Dt(this.inputLayer1.deltas),Dt(this.inputLayer2.deltas),this.inputLayer1.deltas=_t(this.deltas),this.inputLayer2.deltas=_t(this.deltas)}}function oi(O,d,p){return new Fo(O,d,p)}const jr={...xn,std:null};class _r extends cr{constructor(d){super(),this.settings={...jr,...d},this.setupPraxis(),this.validate(),this.weights||(this.weights=Be(this.width,this.height,d.std)),this.deltas||(this.deltas=Ht(this.width,this.height))}predict(){}compare(){}}function hn(O){return new _r(O)}function Ea(O,d){let p=0;for(let y=0;y<this.constants.size;y++)p+=O[this.thread.y][y]*d[y][this.thread.x];return p}function js(O,d,p){let y=d[this.thread.y][this.thread.x];for(let N=0;N<this.constants.size;N++)y+=O[this.thread.y][N]*p[this.thread.x][N];return y}function gi(O,d,p){let y=d[this.thread.y][this.thread.x];for(let N=0;N<this.constants.size;N++)y+=O[N][this.thread.x]*p[N][this.thread.y];return y}class za extends dn{constructor(){super(...arguments),this.compareKernel1=null,this.compareKernel2=null}get width(){return this.inputLayer2.width}set width(d){throw new Error("Cannot set width on Multiply")}get height(){return this.inputLayer1.height}set height(d){throw new Error("Cannot set height on Multiply")}get depth(){return this.inputLayer1.depth}set depth(d){throw new Error("Cannot set depth on Multiply")}validate(){if(super.validate(),this.inputLayer1.width!==this.inputLayer2.height)throw new Error(`Layer width mismatch of ${this.inputLayer1.width} and ${this.inputLayer2.height}`)}setupKernels(){this.predictKernel=Et(Ea,{output:[this.width,this.height],constants:{size:this.inputLayer2.height},immutable:!0}),this.compareKernel1=Et(js,{output:[this.inputLayer1.width,this.inputLayer1.height],constants:{size:this.inputLayer2.width},immutable:!0}),this.compareKernel2=Et(gi,{output:[this.inputLayer2.width,this.inputLayer2.height],constants:{size:this.inputLayer1.height},immutable:!0})}reuseKernels(d){super.reuseKernels(d),this.compareKernel1=d.compareKernel1,this.compareKernel2=d.compareKernel2}predict(){if(Dt(this.weights),!this.predictKernel)throw new Error("this.predictKernel is not set");this.weights=this.predictKernel(this.inputLayer1.weights,this.inputLayer2.weights)}compare(){if(!this.compareKernel1)throw new Error("this.compareKernel1 not set");if(!this.compareKernel2)throw new Error("this.compareKernel2 not set");const d=this.inputLayer1.deltas,p=this.inputLayer2.deltas,y=this.compareKernel1(this.deltas,this.inputLayer1.deltas,this.inputLayer2.weights),N=this.compareKernel2(this.deltas,this.inputLayer2.deltas,this.inputLayer1.weights);this.inputLayer2.deltas=N,this.inputLayer1.deltas=y,Dt(d),Dt(p)}setupPraxis(){}toJSON(){return{...super.toJSON(),width:this.width,height:this.height}}}function ri(O,d,p){return new za(O,d,p)}function dr(O){return 1/(1+Math.exp(-O[this.thread.y][this.thread.x]))}function Lr(O){return 1/(1+Math.exp(-O[this.thread.z][this.thread.y][this.thread.x]))}function jo(O,d){const p=O[this.thread.y][this.thread.x],y=d[this.thread.y][this.thread.x];return p*(1-p)*y}function Bl(O,d){const p=O[this.thread.z][this.thread.y][this.thread.x],y=d[this.thread.z][this.thread.y][this.thread.x];return p*(1-p)*y}class Vo extends kr{setupKernels(){this.depth>0?(this.predictKernel=Et(Lr,{output:[this.width,this.height,this.depth],functions:[l],immutable:!0}),this.compareKernel=Et(Bl,{output:[this.width,this.height,this.depth],functions:[u],immutable:!0})):(this.predictKernel=Et(dr,{output:[this.width,this.height],functions:[l],immutable:!0}),this.compareKernel=Et(jo,{output:[this.width,this.height],functions:[u],immutable:!0}))}predict(){Dt(this.weights),this.weights=this.predictKernel(this.inputLayer.weights)}compare(){Dt(this.inputLayer.deltas),this.inputLayer.deltas=this.compareKernel(this.weights,this.deltas)}learn(d){}}function br(O,d){return new Vo(O,d)}function yl(O,d){const{height:p}=O;function y(S,T){const H=es(S,T);return H.setupKernels(),H}function N(S,T){const H=Kr(S,T);return H.setupKernels(),H}const L=hn({id:"weights",height:p,width:d.height,initPraxis:y}),F=hn({id:"biases",height:p,initPraxis:N}),z=ri(L,d),P=oi(z,F),k=br(P),R=L.praxis;return R.weightsLayer=L,R.incomingLayer=d,R.deltaLayer=k,k}function ia(O,d){if(typeof O.stride=="number")return{strideX:O.stride,strideY:O.stride};{let p=d.stride,y=d.stride;return typeof O.strideX=="number"&&(p=O.strideX),typeof O.strideY=="number"&&(y=O.strideY),{strideX:p,strideY:y}}}function Oi(O,d){if(typeof O.padding=="number")return{paddingX:O.padding,paddingY:O.padding};{let p=d.padding,y=d.padding;return typeof O.paddingX=="number"&&(p=O.paddingX),typeof O.paddingY=="number"&&(y=O.paddingY),{paddingX:p,paddingY:y}}}function no(O,d){return new Float32Array(O).fill(d)}function vl(O,d,p){const y=this.constants.paddingX-this.thread.x*this.constants.strideX,N=this.thread.x*this.constants.strideX-this.constants.paddingX,L=Math.min(this.constants.filterWidth,y+this.constants.inputWidth),F=this.constants.paddingY-this.thread.y*this.constants.strideY,z=this.thread.y*this.constants.strideY-this.constants.paddingY,P=Math.min(this.constants.filterHeight,F+this.constants.inputHeight);let k=0;for(let R=0;R<this.constants.inputDepth;R++)for(let S=Math.max(0,F),T=Math.max(0,z);S<P;S++,T++)for(let H=Math.max(0,y),te=Math.max(0,N);H<L;H++,te++)k+=d[R][S][H]*O[R][T][te];return k+p[this.thread.z]}function _l(O,d,p){const y=Math.max(0,Math.ceil((this.constants.paddingX-this.thread.x)/this.constants.strideX)),N=y*this.constants.strideX+this.thread.x-this.constants.paddingX,L=Math.min(this.constants.deltaWidth,Math.floor((this.constants.inputWidth-1-this.thread.x+this.constants.paddingX)/this.constants.strideX)+1),F=Math.max(0,Math.ceil((this.constants.paddingY-this.thread.y)/this.constants.strideY)),z=F*this.constants.strideY+this.thread.y-this.constants.paddingY,P=Math.min(this.constants.deltaHeight,Math.floor((this.constants.inputHeight-1-this.thread.y+this.constants.paddingY)/this.constants.strideY)+1);let k=O[this.thread.z][this.thread.y][this.thread.x];for(let R=F,S=z;R<P;R++,S+=this.constants.strideY)for(let T=y,H=N;T<L;T++,H+=this.constants.strideX)k+=d[this.thread.z][S][H]*p[this.constants.deltaZ][R][T];return k}function zo(O,d,p){const y=this.thread.x+this.constants.paddingX,N=y<this.constants.filterWidth?0:Math.floor((y-this.constants.filterWidth+this.constants.strideX)/this.constants.strideX),L=y-N*this.constants.strideX,F=Math.min(N+Math.floor(L/this.constants.strideX)+1,this.constants.deltaWidth),z=this.thread.y+this.constants.paddingY,P=z<this.constants.filterHeight?0:Math.floor((z-this.constants.filterHeight+this.constants.strideY)/this.constants.strideY),k=z-P*this.constants.strideY,R=Math.min(P+Math.floor(k/this.constants.strideY)+1,this.constants.deltaHeight);let S=O[this.thread.z][this.thread.y][this.thread.x],T=P;for(let H=k;T<R;H-=this.constants.strideY,T++){let te=N;for(let Se=L;te<F;Se-=this.constants.strideX,te++)S+=d[this.thread.z][H][Se]*p[this.constants.deltaZ][T][te]}return S}function Ua(O,d){let p=0;for(let y=0;y<this.constants.deltaHeight;y++)for(let N=0;N<this.constants.deltaWidth;N++)p+=d[this.thread.z][y][N];return O[this.thread.z][this.thread.y][this.thread.x]+p}const It={stride:0,padding:0,bias:.1,filterCount:1,filterWidth:0,filterHeight:0};class Mt extends vr{constructor(d,p){var y,N,L;super(d,p),this.compareFilterDeltasKernel=null,this.compareInputDeltasKernel=null,this.compareBiasesKernel=null,this.settings={...It,...d,...Oi(d,It),...ia(d,It)},this.weights=(y=d.weights)!==null&&y!==void 0?y:$e(this.width,this.height,this.depth),this.deltas=Kn(this.width,this.height,this.depth),this.biases=no(this.depth,this.bias),this.biasDeltas=(N=d.biasDeltas)!==null&&N!==void 0?N:De(this.depth),this.filters=(L=d.filters)!==null&&L!==void 0?L:$e(this.filterWidth,this.filterHeight,this.filterCount),this.filterDeltas=Kn(this.filterWidth,this.filterHeight,this.filterCount),this.validate()}get strideX(){return this.settings.strideX}get strideY(){return this.settings.strideY}get paddingX(){return this.settings.paddingX}get paddingY(){return this.settings.paddingX}get width(){return Math.floor((this.inputLayer.width+this.paddingX*2-this.filterWidth)/this.strideX+1)}get height(){return Math.floor((this.inputLayer.height+this.paddingY*2-this.filterHeight)/this.strideY+1)}get bias(){return this.settings.bias}get depth(){return this.filterCount}get biases(){return this.settings.biases}set biases(d){this.settings.biases=d}get biasDeltas(){return this.settings.biasDeltas}set biasDeltas(d){this.settings.biasDeltas=d}get filters(){return this.settings.filters}set filters(d){this.settings.filters=d}get filterDeltas(){return this.settings.filterDeltas}set filterDeltas(d){this.settings.filterDeltas=d}setupKernels(){this.predictKernel=Et(vl,{constants:{inputWidth:this.inputLayer.width,inputHeight:this.inputLayer.height,inputDepth:this.inputLayer.depth,strideX:this.strideX,strideY:this.strideY,paddingX:this.paddingX,paddingY:this.paddingY,filterWidth:this.filterWidth,filterHeight:this.filterHeight},output:[this.width,this.height,this.depth],immutable:!0}),this.compareFilterDeltasKernel=Et(_l,{constants:{deltaWidth:this.width,deltaHeight:this.height,deltaZ:this.depth,inputWidth:this.inputLayer.width,inputHeight:this.inputLayer.height,inputDepth:this.inputLayer.depth,strideX:this.strideX,strideY:this.strideY,paddingX:this.paddingX,paddingY:this.paddingY,filterWidth:this.filterWidth,filterHeight:this.filterHeight},output:[this.width,this.height,this.depth],immutable:!0}),this.compareInputDeltasKernel=Et(zo,{constants:{deltaWidth:this.width,deltaHeight:this.height,deltaZ:this.depth,strideX:this.strideX,strideY:this.strideY,paddingX:this.paddingX,paddingY:this.paddingY,filterWidth:this.filterWidth,filterHeight:this.filterHeight,filterCount:this.filterCount},output:[this.inputLayer.width,this.inputLayer.height,this.inputLayer.depth],immutable:!0}),this.compareBiasesKernel=Et(Ua,{output:[1,1,this.depth],constants:{deltaWidth:this.width,deltaHeight:this.height},immutable:!0})}predict(){this.weights=this.predictKernel(this.inputLayer.weights,this.filters,this.biases)}compare(){const{filterDeltas:d,biasDeltas:p}=this;this.filterDeltas=this.compareFilterDeltasKernel(d,this.inputLayer.weights,this.deltas),Dt(d),this.biasDeltas=this.compareBiasesKernel(p,this.deltas),Dt(p),Dt(this.deltas),this.deltas=this.compareInputDeltasKernel(this.filters,this.inputLayer.deltas),Dt(this.inputLayer.deltas),this.inputLayer.deltas=_t(this.deltas)}learn(d){const{weights:p}=this;this.weights=this.praxis.run(this,d),Dt(p)}}function kn(O,d){return new Mt(O,d)}function xi(O){return O}function or(O){return Math.random()<this.constants.probability?0:O[this.thread.y][this.thread.x]}function Mi(O){return O[this.thread.y][this.thread.x]*this.constants.probability}function rn(O,d){return O[this.thread.y][this.thread.x]===0?0:d[this.thread.y][this.thread.x]}const Vs={...xn,probability:.5};class io extends vr{constructor(d,p){super(p,d),this.predictKernelMap=null,this.settings={...Vs,...p},this.dropouts=null,this.validate()}setupKernels(d){const p=[this.width,this.height];d?(this.predictKernelMap=Pe({dropouts:xi},or,{output:p,immutable:!0}),this.compareKernel=Et(rn,{output:p,immutable:!0})):this.predictKernelMap=Pe({},Mi,{output:p,immutable:!0})}predict(){Dt(this.weights),this.dropouts&&Dt(this.dropouts);const{result:d,dropouts:p}=this.predictKernelMap(this.inputLayer.weights);this.weights=d,this.dropouts=p}compare(){Dt(this.deltas),this.deltas=this.compareKernel(this.dropouts,this.inputLayer.deltas)}}function pa(O,d){return new io(O,d)}function Wr(O,d){const{height:p,praxisOpts:y=null}=O,N=hn({id:"weights",height:p,width:d.height,praxisOpts:y}),L=hn({id:"biases",height:p,praxisOpts:y});return br(oi(ri(N,d,{praxisOpts:y}),L,{praxisOpts:y}),{praxisOpts:y})}function wi(O,d,p){let y=0,N=0;for(let L=0;L<this.constants.inputHeight;L++)for(let F=0;F<this.constants.inputWidth;F++)y+=O[L][F]*d[this.thread.x][N],N++;return y+p[this.thread.x]}function ga(O,d,p){let y=0,N=0;for(let L=0;L<this.constants.inputDepth;L++)for(let F=0;F<this.constants.inputHeight;F++)for(let z=0;z<this.constants.inputWidth;z++)y+=O[L][F][z]*d[this.thread.x][N],N++;return y+p[this.thread.x]}function ki(O,d,p){let y=0;const N=this.thread.x+this.thread.y*this.output.x;for(let L=0;L<this.constants.filterCount;L++)y+=p[L][N]*d[0][L];return y+O[this.thread.y][this.thread.x]}function zs(O,d,p){let y=0;const N=this.thread.x+this.thread.y*this.output.x;for(let L=0;L<this.constants.filterCount;L++)y+=p[L][N]*d[0][L];return y+O[this.thread.z][this.thread.y][this.thread.x]}function Ba(O,d){return O[this.thread.x]+d[this.thread.y][this.thread.x]}function Us(O,d,p){return O[this.thread.y][this.thread.x]+d[this.thread.y][this.thread.x]*p[this.constants.deltaY][this.constants.deltaX]}function fn(O,d,p){const y=Math.floor(this.thread.x/(this.constants.inputWidth*this.constants.inputHeight)),N=Math.floor((this.thread.x-y*this.constants.inputWidth*this.constants.inputHeight)/this.constants.inputWidth),L=this.thread.x-this.constants.inputWidth*(N+this.constants.inputHeight*y);return O[this.thread.y][this.thread.x]+d[y][N][L]*p[0][this.thread.y]}class As extends vr{constructor(d,p){super(d,p),this.compareFilterDeltasKernel=null,this.compareInputDeltasKernel=null,this.compareBiasesKernel=null,this.settings={...d},this.validate();const y=p.width*p.height*p.depth;this.biases=no(this.height,this.bias),this.biasDeltas=Ye(this.height),this.filters=Be(y,this.height),this.filterDeltas=Ht(y,this.height),this.depth>0?(this.weights=$e(this.width,this.height,this.depth),this.deltas=Kn(this.width,this.height,this.depth)):this.height>0&&(this.weights=Be(this.width,this.height),this.deltas=Ht(this.width,this.height))}get bias(){return this.settings.bias}get biases(){return this.settings.biases}set biases(d){this.settings.biases=d}get biasDeltas(){return this.settings.biases}set biasDeltas(d){this.settings.biasDeltas=d}validate(){if(super.validate(),this.depth>0)throw new Error("depth not supported")}setupKernels(){const{inputLayer:d}=this,p=d.width*d.height*d.depth;d.depth>0?(this.predictKernel=Et(ga,{output:[this.width,this.height],constants:{inputHeight:d.height,inputWidth:d.width,inputDepth:d.depth}}),this.compareFilterDeltasKernel=Et(fn,{output:[p,this.height],constants:{deltaX:0,deltaY:0,inputWidth:d.width,inputHeight:d.height},immutable:!0}),this.compareInputDeltasKernel=Et(zs,{output:[d.width,d.height,d.depth],constants:{filterCount:this.height},immutable:!0})):(this.predictKernel=Et(wi,{output:[this.width,this.height],constants:{inputHeight:d.height,inputWidth:d.width}}),this.compareFilterDeltasKernel=Et(Us,{output:[p,this.height],constants:{deltaX:0,deltaY:0,inputWidth:d.width,inputHeight:d.height}}),this.compareInputDeltasKernel=Et(ki,{output:[d.width,d.height],constants:{filterCount:this.height}})),this.compareBiasesKernel=Et(Ba,{output:[this.width,this.height]})}predict(){this.weights=this.predictKernel(this.inputLayer.weights,this.filters,this.biases)}compare(){const d=this.inputLayer.deltas;this.inputLayer.deltas=this.compareInputDeltasKernel(d,this.deltas,this.filters),Dt(d);const{biasDeltas:p,filterDeltas:y}=this;this.biasDeltas=this.compareBiasesKernel(this.biases,this.deltas),this.filterDeltas=this.compareFilterDeltasKernel(y,this.inputLayer.weights,this.deltas),Dt(p),Dt(y)}}function Ia(O,d){return new As(O,d)}function qr(O){return-O[this.thread.y][this.thread.x]}class Tr extends Ci{constructor(d,p){super(d,p),this.validate()}setupKernels(){this.predictKernel=Et(qr,{output:[this.width,this.height]})}predict(){this.weights=this.predictKernel(this.inputLayer.weights)}}function ka(O,d){return new Tr(O,d)}function Vr(O,d){return O[this.thread.y][this.thread.x]*d[this.thread.y][this.thread.x]}function Ca(O,d){return O[this.thread.y][this.thread.x]*d[this.thread.y][this.thread.x]}class ma extends dn{get width(){return this.inputLayer1.width}get height(){return this.inputLayer1.height}get depth(){return this.inputLayer1.depth}validate(){super.validate(),el(this.inputLayer1,this.inputLayer2)}setupKernels(){this.predictKernel=Et(Vr,{output:[this.width,this.height],immutable:!0}),this.compareKernel=Et(Ca,{output:[this.width,this.height],immutable:!0})}predict(){Dt(this.weights),this.weights=this.predictKernel(this.inputLayer1.weights,this.inputLayer2.weights)}compare(){Dt(this.inputLayer1.deltas),Dt(this.inputLayer2.deltas),this.inputLayer1.deltas=this.compareKernel(this.inputLayer2.weights,this.deltas),this.inputLayer2.deltas=this.compareKernel(this.inputLayer1.weights,this.deltas)}}function us(O,d,p){return new ma(O,d,p)}function Cn(O){return new Float32Array(O).fill(1)}function Ri(O,d){const p=new Array(d);for(let y=0;y<d;y++)p[y]=Cn(O);return p}class Es extends cr{constructor(d){super(d),this.validate(),this.weights=Ri(this.width,this.height),this.deltas=Ht(this.width,this.height)}}function $a(O){return new Es(O)}function Bs(O){return f(O[this.thread.y][this.thread.x])}function wo(O){return f(O[this.thread.z][this.thread.y][this.thread.x])}function du(O,d){return x(O[this.thread.y][this.thread.x],d[this.thread.y][this.thread.x])}function ro(O,d){return x(O[this.thread.z][this.thread.y][this.thread.x],d[this.thread.z][this.thread.y][this.thread.x])}class bl extends kr{setupKernels(){this.depth>0?(this.predictKernel=Et(wo,{output:[this.width,this.height,this.depth],functions:[f],immutable:!0}),this.compareKernel=Et(ro,{output:[this.width,this.height,this.depth],functions:[x],immutable:!0})):(this.predictKernel=Et(Bs,{output:[this.width,this.height],functions:[f],immutable:!0}),this.compareKernel=Et(du,{output:[this.width,this.height],functions:[x],immutable:!0}))}predict(){Dt(this.weights),this.weights=this.predictKernel(this.inputLayer.weights)}compare(){Dt(this.inputLayer.deltas),this.inputLayer.deltas=this.compareKernel(this.weights,this.deltas)}}function j(O,d){return new bl(O,d)}class fe extends cr{constructor(d){super(d),this.validate(),this.weights=Ht(this.width,this.height),this.deltas=Ht(this.width,this.height)}predict(){}compare(){}}function Me(O){return new fe(O)}function We(O,d,p){const{height:y}=O,N=hn({height:y,width:p.height}),L=hn({width:y,height:y}),F=Me({height:y}),z=br(oi(oi(ri(N,p),ri(L,d)),F)),P=hn({height:y,width:p.height}),k=hn({width:y,height:y}),R=Me({height:y}),S=br(oi(oi(ri(P,p),ri(k,d)),R)),T=hn({height:y,width:p.height}),H=hn({width:y,height:y}),te=Me({height:y}),Se=j(oi(oi(ri(T,p),ri(H,us(S,d))),te));return oi(us(oi($a({width:z.width,height:z.height}),ka(z)),Se),us(d,z))}const tt={weights:null};class At extends tr{constructor(d){super({...tt,...d}),this.reshapeInput=null,this.validate(),this.reshapeInput=null,this.deltas=Ht(this.width,this.height)}setupKernels(){this.width===1&&(this.predict=this.predict1D,this.reshapeInput=Et(function(d){return d[this.thread.y]},{output:[1,this.height],immutable:!0}))}reuseKernels(d){this.reshapeInput=d.reshapeInput}predict(d){if((Array.isArray(d)||d instanceof Float32Array)&&typeof d[0]=="number"&&d.length===this.height*this.width)Dt(this.weights),this.weights=$t(d,[this.width,this.height]);else if(Array.isArray(d)&&d.length===this.height&&(Array.isArray(d[0])||d[0]instanceof Float32Array)&&d[0].length===this.width)this.weights=_t(d);else throw new Error("Inputs are not of sized correctly")}predict1D(d){this.weights&&Dt(this.weights),this.reshapeInput?this.weights=this.reshapeInput(d):this.weights=d}compare(){}learn(){}}function Pt(O){return new At(O)}function an(O){return w(O[this.thread.y][this.thread.x])}function pn(O){return w(O[this.thread.z][this.thread.y][this.thread.x])}function Vn(O,d){return A(O[this.thread.y][this.thread.x],d[this.thread.y][this.thread.x])}function Rn(O,d){return A(O[this.thread.z][this.thread.y][this.thread.x],d[this.thread.z][this.thread.y][this.thread.x])}class Si extends kr{setupKernels(){const{width:d,height:p,depth:y}=this.inputLayer;this.depth>0?(this.predictKernel=Et(pn,{output:[d,p,y],functions:[w],immutable:!0}),this.compareKernel=Et(Rn,{output:[d,p,y],functions:[A],immutable:!0})):(this.predictKernel=Et(an,{output:[d,p],functions:[w],immutable:!0}),this.compareKernel=Et(Vn,{output:[d,p],functions:[A],immutable:!0}))}predict(){Dt(this.weights),this.weights=this.predictKernel(this.inputLayer.weights)}compare(){const{deltas:d}=this;this.deltas=this.compareKernel(this.weights,d),Dt(d)}}function Ar(O,d){return new Si(O,d)}function fr(O,d,p){const{height:y}=O;if(typeof y!="number")throw new Error("no settings.height given");p.setDimensions&&p.setDimensions(1,y);const N=hn({width:d.height,height:y,std:.08,id:"inputGateWeights"}),L=hn({width:y,height:y,std:.08,id:"inputGatePeepholes"}),F=Me({width:1,height:y,id:"inputGateBias"}),z=br(oi(oi(ri(N,d),ri(L,p)),F),{id:"inputGate"}),P=hn({width:d.height,height:y,std:.08,id:"forgetGateWeights"}),k=hn({width:y,height:y,std:.08,id:"forgetGatePeepholes"}),R=Me({width:1,height:y,id:"forgetGateBias"}),S=br(oi(oi(ri(P,d),ri(k,p)),R),{id:"forgetGate"}),T=hn({width:d.height,height:y,std:.08,id:"outputGateWeights"}),H=hn({width:y,height:y,std:.08,id:"outputGatePeepholes"}),te=Me({width:1,height:y,id:"outputGateBias"}),Se=br(oi(oi(ri(T,d),ri(H,p)),te),{id:"outputGate"}),ie=hn({width:d.height,height:y,std:.08,id:"memoryWeights"}),_e=hn({width:y,height:y,std:.08,id:"memoryPeepholes"}),Y=Me({width:1,height:y,id:"memoryBias"}),re=j(oi(oi(ri(ie,d),ri(_e,p)),Y),{id:"memory"}),be=us(S,p,{id:"retainCell"}),ke=us(z,re,{id:"writeCell"}),it=oi(be,ke,{id:"cell"});return us(Se,j(it),{id:"activations"})}function E(O,d){const{height:p}=O,y=hn({height:p,width:d.height,id:"outputGate",std:.08}),N=hn({height:p,id:"output",std:.08}),L=ri(y,d,{id:"outputGateConnected"});return ms({id:"target",...O},oi(L,N))}function K(O){return O}function ne(O){return O}function Ie(O){const d=this.thread.x*this.constants.strideX-this.constants.paddingX,p=this.thread.y*this.constants.strideY-this.constants.paddingY,y=d+this.constants.filterWidth,N=p+this.constants.filterHeight,L=Math.max(d,0),F=Math.max(p,0),z=Math.min(y,this.constants.inputWidth),P=Math.min(N,this.constants.inputHeight);let k=O[this.thread.z][F][L];for(let R=F;R<P;R++)for(let S=L;S<z;S++){const T=O[this.thread.z][R][S];T>k&&(k=T)}return k}function st(O,d,p){const y=this.thread.x+.5,N=this.thread.y+.5,L=1/this.constants.strideX,F=1/this.constants.strideY,z=Math.max(0,Math.ceil((y-this.constants.filterWidth+this.constants.paddingX)*L)),P=Math.max(0,Math.ceil((N-this.constants.filterHeight+this.constants.paddingY)*F)),k=Math.min(Math.ceil((y+this.constants.paddingX)*L),this.constants.outputWidth),R=Math.min(Math.ceil((N+this.constants.paddingY)*F),this.constants.outputHeight);let S=0;for(let T=P;T<R;T++)for(let H=z;H<k;H++){const te=d[T][H],Se=p[T][H];Math.abs(te-this.thread.x)<.1&&Math.abs(Se-this.thread.y)<.1&&(S+=O[T][H])}return S}const ft={padding:0,stride:0};class jt extends vr{constructor(d,p){super(d,p),this.predictKernelMap=null,this.settings={...d,...ia(d,ft),...Oi(d,ft)},this.weights=$e(this.width,this.height,this.depth),this.deltas=Kn(this.width,this.height,this.depth),this.validate()}get strideX(){return this.settings.strideX}get strideY(){return this.settings.strideY}get paddingX(){return this.settings.paddingX}get paddingY(){return this.settings.paddingY}get width(){return Math.ceil((this.inputLayer.width+this.paddingX*2-this.filterWidth)/this.strideX+1)}get height(){return Math.floor((this.inputLayer.height+this.paddingY*2-this.filterHeight)/this.strideY+1)}get depth(){return this.settings.filterCount}get filterCount(){return this.settings.filterCount}get switchX(){return this.settings.switchX}set switchX(d){this.settings.switchX=d}get switchY(){return this.settings.switchY}set switchY(d){this.settings.switchY=d}setupKernels(){this.predictKernelMap=Pe({switchX:ne,switchY:K},Ie,{output:[this.width,this.height,this.depth],constants:{inputWidth:this.inputLayer.width,inputHeight:this.inputLayer.height,paddingX:this.paddingX,paddingY:this.paddingY,filterHeight:this.filterHeight,filterWidth:this.filterWidth,strideX:this.strideX,strideY:this.strideY}}),this.compareKernel=Et(st,{output:[this.inputLayer.width,this.inputLayer.height,this.inputLayer.depth],constants:{inputWidth:this.inputLayer.width,inputHeight:this.inputLayer.height,outputWidth:this.width,outputHeight:this.height,filterWidth:this.filterWidth,filterHeight:this.filterHeight,paddingX:this.paddingX,paddingY:this.paddingY,strideX:this.strideX,strideY:this.strideY}})}predict(){const{result:d,switchX:p,switchY:y}=this.predictKernelMap(this.inputLayer.weights);this.switchX=p,this.switchY=y,this.weights=d}compare(){const d=this.inputLayer.deltas;this.inputLayer.deltas=this.compareKernel(this.deltas,this.switchX,this.switchY),Dt(d)}}function Zn(O,d){return new jt(O,d)}class lr extends Cr{constructor(d){super(),this.praxis=null,this.predictKernel=null,this.compareKernel=null,this.settings={},this.recurrentInput=d,this.validate()}get width(){return this.recurrentInput.width}get height(){return this.recurrentInput.height}get depth(){return this.recurrentInput.depth}get deltas(){return this.recurrentInput.deltas}set deltas(d){const p=this.recurrentInput.deltas;this.recurrentInput.deltas=d,Dt(p)}get weights(){return this.recurrentInput.weights}set weights(d){const p=this.recurrentInput.weights;this.recurrentInput.weights=d,Dt(p)}validate(){if(Qn.prototype.validate.call(this),this.width!==this.recurrentInput.width)throw new Error(`${this.constructor.name} layer width ${this.width} and ${this.recurrentInput.constructor.name} width (${this.recurrentInput.width}) are not same`);if(this.height!==this.recurrentInput.height)throw new Error(`${this.constructor.name} layer height ${this.height} and ${this.recurrentInput.constructor.name} width (${this.recurrentInput.height}) are not same`)}setDimensions(d,p){this.recurrentInput.width=d,this.recurrentInput.height=p}predict(){}compare(){}learn(){}setupKernels(){}reuseKernels(){}}class ui extends Cr{constructor(d){super(),this.praxis=null,this.settings={},this.predictKernel=null,this.compareKernel=null,d&&(this.settings={...d})}setDimensions(d,p){this.praxis=null,this.settings={...this.settings,width:d,height:p,weights:Ht(d,p),deltas:Ht(d,p)}}setupKernels(){}reuseKernels(){}predict(){}compare(){}learn(d){const{weights:p}=this;this.weights=this.praxis.run(this,d),Dt(p)}}function nr(){return new ui}function $s(O){return n(O[this.thread.y][this.thread.x])}function ra(O,d){return r(O[this.thread.y][this.thread.x],d[this.thread.y][this.thread.x])}function xr(O){return n(O[this.thread.z][this.thread.y][this.thread.x])}function sa(O,d){return r(O[this.thread.z][this.thread.y][this.thread.x],d[this.thread.z][this.thread.y][this.thread.x])}class Ga extends kr{setupKernels(){const{width:d,height:p,depth:y}=this.inputLayer;y>0?(this.predictKernel=Et(xr,{output:[d,p,y],functions:[n],immutable:!0}),this.compareKernel=Et(sa,{output:[d,p,y],functions:[r],immutable:!0})):(this.predictKernel=Et($s,{output:[d,p],functions:[n],immutable:!0}),this.compareKernel=Et(ra,{output:[d,p],functions:[r],immutable:!0}))}predict(){Dt(this.weights),this.weights=this.predictKernel(this.inputLayer.weights)}compare(){Dt(this.inputLayer.deltas),this.inputLayer.deltas=this.compareKernel(this.weights,this.deltas)}}function Uo(O,d){return new Ga(O,d)}function nl(O,d,p){const{height:y}=O;if(typeof y!="number")throw new Error("height not set");p.setDimensions&&p.setDimensions(1,y);const N=hn({id:"weight",height:y,width:d.height,std:.08}),L=hn({id:"transition",height:y,width:y,std:.08}),F=Me({id:"bias",height:y});return Uo(oi(oi(ri(N,d),ri(L,p)),F))}class ya extends Qn{constructor(d,p){super(d),this.inputLayer=p,this.validate()}predict(){Dt(this.weights),this.weights=_t(this.inputLayer.weights)}learn(){}}function xl(O,d){return new ya(O,d)}function Mu(O){let d=-1/0;for(let p=0;p<this.constants.inputHeight;p++)for(let y=0;y<this.constants.inputWidth;y++){const N=O[p][y];N>d&&(d=N)}return d}function cc(O){let d=-1/0;for(let p=0;p<this.constants.inputDepth;p++)for(let y=0;y<this.constants.inputHeight;y++)for(let N=0;N<this.constants.inputWidth;N++){const L=O[p][y][N];L>d&&(d=L)}return d}function so(O){let d=0;for(let p=0;p<this.constants.inputHeight;p++)for(let y=0;y<this.constants.inputWidth;y++)d+=O[p][y];return d}function Bo(O){let d=0;for(let p=0;p<this.constants.inputDepth;p++)for(let y=0;y<this.constants.inputHeight;y++)for(let N=0;N<this.constants.inputWidth;N++)d+=O[p][y][N];return d}function wl(O,d){return Math.exp(O[this.thread.x]-d[0])}function hc(O,d){return Math.exp(O[this.thread.z][this.thread.y][this.thread.x]-d[0])}function $o(O,d){return O[this.thread.y][this.thread.x]/d[0]}function $l(O,d){return O[this.thread.z][this.thread.y][this.thread.x]/d[0]}function Ha(O,d){let p=0;return this.thread.x+this.thread.y*this.output.x===O&&(p=1),-(p-d[this.thread.y][this.thread.x])}function Ra(O,d){let p=0;return this.thread.x+this.thread.y*this.output.x+this.thread.z*this.output.x*this.output.y===O&&(p=1),-(p-d[this.thread.z][this.thread.y][this.thread.x])}class Go extends Ci{constructor(d,p){super(d,p),this.errors=null,this.getExponentialsKernel=null,this.getMaxValueKernel=null,this.getSumKernel=null,this.validate(),this.depth>0?(this.weights=$e(this.width,this.height,this.depth),this.deltas=Kn(this.width,this.height,this.depth)):this.height>0?(this.weights=Be(this.width,this.height),this.deltas=Ht(this.width,this.height)):(this.weights=De(this.width),this.deltas=Ye(this.width))}setupKernels(){const{width:d,height:p,depth:y}=this;y>0?(this.getExponentialsKernel=Et(hc,{output:[d,p,y]}),this.getMaxValueKernel=Et(cc,{output:[1,1,1],constants:{inputWidth:d,inputHeight:p,inputDepth:y}}),this.getSumKernel=Et(Bo,{output:[1,1,1],constants:{inputWidth:d,inputHeight:p,inputDepth:y}}),this.predictKernel=Et($l,{output:[d,p,y]}),this.compareKernel=Et(Ra,{output:[d,p,y],immutable:!0})):(this.getExponentialsKernel=Et(wl,{output:[d,p]}),this.getMaxValueKernel=Et(Mu,{output:[1,1],constants:{inputWidth:d,inputHeight:p}}),this.getSumKernel=Et(so,{output:[1,1],constants:{inputWidth:d,inputHeight:p}}),this.predictKernel=Et($o,{output:[d,p]}),this.compareKernel=Et(Ha,{output:[d,p],immutable:!0}))}predict(){const d=this.getMaxValueKernel(this.inputLayer.weights),p=this.getExponentialsKernel(this.inputLayer.weights,d),y=this.getSumKernel(p);this.weights=this.predictKernel(p,y)}compare(d){const{deltas:p,errors:y}=this;this.errors=this.compareKernel(d[0],p),this.deltas=_t(this.errors),Dt(p),Dt(y);const N=this.inputLayer.deltas;this.inputLayer.deltas=_t(this.deltas),Dt(N)}}function il(O,d){return new Go(O,d)}class rl extends Qn{constructor(d,p){super(p),this.inputLayer=d}predict(){Dt(this.weights),this.weights=_t(this.inputLayer.weights),this.validate()}learn(){}}function Fu(O,d){return new rl(O,d)}function fu(O){return O[this.thread.x][this.thread.y]}const cs=fu;class dc extends Ci{get width(){return this.inputLayer.height}get height(){return this.inputLayer.width}constructor(d){super(d),this.validate()}setupKernels(){this.predictKernel=Et(fu,{output:[this.height,this.width]}),this.compareKernel=Et(cs,{output:[this.width,this.height]})}predict(){this.weights=this.predictKernel(this.inputLayer.weights)}compare(){this.inputLayer.deltas=this.compareKernel(this.deltas)}}function sl(O){return new dc(O)}const Is={Activation:kr,Internal:Cr,InternalModel:Pi,EntryPoint:tr,Filter:vr,Model:cr,Modifier:Ci,Operator:dn,Target:Rr};var ks=Object.freeze({__proto__:null,layerTypes:Is,Add:Fo,add:oi,arthurFeedForward:yl,BaseLayer:Qn,baseLayerDefaultSettings:xn,Convolution:Mt,convolution:kn,Dropout:io,dropout:pa,feedForward:Wr,FullyConnected:As,fullyConnected:Ia,gru:We,Input:At,input:Pt,LeakyRelu:Si,leakyRelu:Ar,lstmCell:fr,Multiply:za,multiply:ri,MultiplyElement:ma,multiplyElement:us,Negative:Tr,negative:ka,Ones:Es,ones:$a,output:E,Pool:jt,pool:Zn,Random:_r,random:hn,RecurrentInput:lr,RecurrentZeros:ui,rnnCell:nl,Regression:ya,regression:xl,Relu:Ga,relu:Uo,Sigmoid:Vo,sigmoid:br,SoftMax:Go,softMax:il,SVM:rl,svm:Fu,Tanh:bl,tanh:j,Target:Rr,target:ms,Transpose:dc,transpose:sl,Zeros:fe,zeros:Me});const Sl=Object.keys(ks);function ao(O,d,p){if(!Sl.find(N=>N===O.type))return null;const y=ks[O.type];if(y.prototype instanceof Is.Filter){if(!d)throw new Error("inputLayer missing");return new y(O,d)}else if(y.prototype instanceof Is.Activation||y.prototype instanceof Is.Modifier){if(!d)throw new Error("inputLayer missing");return new y(d,O)}else{if(y.prototype instanceof Is.Internal)return new y(O);if(y.prototype instanceof Is.Operator){if(!d)throw new Error("inputLayer1 missing");if(!p)throw new Error("inputLayer2 missing");return new y(d,p,O)}else{if(y.prototype instanceof Is.InternalModel||y.prototype instanceof Is.EntryPoint||y.prototype instanceof Is.Model)return new y(O);if(y===Rr){if(!d)throw new Error("inputLayer missing");return new y(O,d)}}}return null}const ju={learningRate:.3,binaryThresh:.5,initPraxis:(O,d)=>{var p;return hr(O,(p=O.settings.praxisOpts)!==null&&p!==void 0?p:d)}},Ho={iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,learningRate:.3,callbackPeriod:10,errorCheckInterval:100,timeout:1/0};class oo{constructor(d={}){this.trainOpts={},this.layers=null,this._inputLayer=null,this._hiddenLayers=null,this._outputLayer=null,this._model=null,this.meanSquaredError=null,this.inputLookup=null,this.inputLookupLength=null,this.outputLookup=null,this.outputLookupLength=null,this.options={...ju,...d},this._updateTrainingOptions({...Ho,...d})}static _validateTrainingOptions(d){const{iterations:p,errorThresh:y,log:N,logPeriod:L,learningRate:F,callback:z,callbackPeriod:P,timeout:k}=d,R={iterations:()=>typeof p=="number"&&p>0,errorThresh:()=>typeof y=="number"&&y>0&&y<1,log:()=>typeof N=="function"||typeof N=="boolean",logPeriod:()=>typeof L=="number"&&L>0,learningRate:()=>typeof F=="number"&&F>0&&F<1,callback:()=>typeof z=="function"||z===null,callbackPeriod:()=>typeof P=="number"&&P>0,timeout:()=>typeof k=="number"&&k>0};Object.keys(Ho).forEach(S=>{if(R.hasOwnProperty(S)&&!R[S]()){const T=d[S];throw new Error(`[${S}, ${(T??"undefined").toString()}] is out of normal training range, your network will probably not train.`)}})}_setLogMethod(d){typeof d=="function"?this.trainOpts.log=d:d?this.trainOpts.log=console.log:this.trainOpts.log=!1}_updateTrainingOptions(d){var p;this.trainOpts={...Ho,...this.trainOpts,...d},oo._validateTrainingOptions(this.trainOpts),this._setLogMethod((p=d.log)!==null&&p!==void 0?p:this.trainOpts.log);const{callback:y,callbackPeriod:N,errorCheckInterval:L}=this.trainOpts;y&&N!==L&&console.warn(`options.callbackPeriod with value of ${(N??"undefined").toString()} does not match options.errorCheckInterval with value of ${(L??"undefined").toString()}, if logging error, it will repeat.  These values may need to match`)}_connectOptionsLayers(){const{inputLayerIndex:d,outputLayerIndex:p,layers:y}=this.options;if(!y)throw new Error("this.options.layers in unexpected state");if(typeof d!="number")throw new Error("inputLayerIndex not a number");if(typeof p!="number")throw new Error("inputLayerIndex not a number");const N=y[d];if(!N)throw new Error("inputLayer not found in this.options.layers");const L=y[p];if(!L)throw new Error("outputLayer not found in this.options.layers");return this._inputLayer=N,this._hiddenLayers=y.slice(d,p-d),this._outputLayer=L,y}_connectNewLayers(){const{inputLayer:d,outputLayer:p}=this.options;if(!d)throw new Error("inputLayer not defined");const y=[];this._inputLayer=d();const N=this._connectHiddenLayers(this._inputLayer);if(!p)throw new Error("outputLayer not defined");return this._outputLayer=p(N[N.length-1],N.length),y.push(this._inputLayer),y.push(...N),y.push(this._outputLayer),Mo(y)}_connectHiddenLayers(d){this._hiddenLayers=[];const p=[],{hiddenLayers:y}=this.options;if(!y)throw new Error("hiddenLayers not defined");for(let N=0;N<y.length;N++){const L=y[N](d,N);p.push(L),this._hiddenLayers.push(L),d=L}return p}initialize(){this.layers=this.options.layers?this._connectOptionsLayers():this._connectNewLayers(),this.initializeLayers(this.layers),this._model=this.layers.filter(d=>d instanceof cr)}initializeLayers(d){var p,y;for(let L=0;L<d.length;L++){const F=d[L];F.setupKernels(!0),F instanceof cr&&F.praxis===null&&typeof this.options.initPraxis=="function"&&(F.praxis=this.options.initPraxis(F,(y=(p=F.settings.praxisOpts)!==null&&p!==void 0?p:this.options.praxisOpts)!==null&&y!==void 0?y:{}),F.praxis.setupKernels())}const N=d[d.length-1];this.meanSquaredError=new Mn({width:N.width,height:N.height})}run(d){let p;if(Array.isArray(d)||d.buffer)p=d;else if(this.inputLookup)p=me.toArray(this.inputLookup,d,this.inputLookupLength);else throw new Error("input is incompatible with net");let y=this.runInput(p);return y instanceof he.Texture&&(y=y.toArray()),this.outputLookup?me.toObject(this.outputLookup,y):y}runInput(d){if(!this.layers)throw new Error("not initialized");this.layers[0].predict(d);for(let p=1;p<this.layers.length;p++)this.layers[p].predict();return this.layers[this.layers.length-1].weights}train(d,p={}){const{preparedData:y,status:N,endTime:L}=this._prepTraining(d,p);let F=!0;const z=()=>this._calculateTrainingError(y),P=()=>this._trainPatterns(y);for(;F;)F=this._trainingTick(N,L,z,P);return N}async trainAsync(d,p={}){const{preparedData:y,status:N,endTime:L}=this._prepTraining(d,p);return await new Promise((F,z)=>{try{const P=()=>this._calculateTrainingError(y),k=()=>this._trainPatterns(y),R=new Ce.Thaw(new Array(this.trainOpts.iterations),{delay:!0,each:()=>this._trainingTick(N,L,P,k)||R.stop(),done:()=>F(N)});R.tick()}catch(P){z(P)}})}_trainingTick(d,p,y,N){const{trainOpts:L}=this;return d.iterations>=L.iterations||d.error<=L.errorThresh||Date.now()>=p?!1:(typeof L.log=="function"&&d.iterations%L.logPeriod===0?(d.error=y(),L.log(`iterations: ${d.iterations}, training error: ${d.error}`)):d.iterations%L.errorCheckInterval===0?d.error=y():N(),L.callback&&d.iterations%L.callbackPeriod===0&&L.callback(Object.assign(d)),d.iterations++,!0)}_prepTraining(d,p){this._updateTrainingOptions(p);const y=this.formatData(d),N=this.trainOpts.timeout?Date.now()+this.trainOpts.timeout:0,L={error:1,iterations:0};return this.verifyIsInitialized(),{preparedData:this.transferData(y),status:L,endTime:N}}verifyIsInitialized(){this._model||this.initialize()}_calculateTrainingError(d){let p=new Float32Array([0]);const y=this.meanSquaredError;for(let L=0;L<d.length;++L){const F=p,z=this._trainPattern(d[L].input,d[L].output,!0);p=y.add(p,z),Dt(z),Dt(F)}const N=y.divide(d.length,p);if(Dt(p),N instanceof he.Texture){const L=N.toArray();return Dt(N),L[0]}return N[0]}_trainPatterns(d){for(let p=0;p<d.length;++p)this._trainPattern(d[p].input,d[p].output,!1)}_trainPattern(d,p,y){var N;if(this.runInput(d),this._calculateDeltas(p),this.adjustWeights(),y){if(!(!((N=this._outputLayer)===null||N===void 0)&&N.errors))throw new Error("outputLayer.errors not defined");return this.meanSquaredError.calculate(this._outputLayer.errors)}return null}_calculateDeltas(d){const p=this.layers;for(let y=p.length-1;y>-1;y--)p[y].compare(d)}adjustWeights(){const d=this._model;for(let p=0;p<d.length;p++)d[p].learn(this.trainOpts.learningRate)}formatData(d){if(!Array.isArray(d)){const L=[];L.push(d),d=L}const p=d[0].input;let y;if(Array.isArray(d)&&!Array.isArray(p)&&!(p instanceof Float32Array)){if(!this.inputLookup){const L=new nt(d,"input");this.inputLookup=L.table,this.inputLookupLength=L.length}y=d.map(L=>({input:me.toArray(this.inputLookup,L.input,this.inputLookupLength)}),this)}else y=d;const N=d[0].output;if(!Array.isArray(N)&&!(N instanceof Float32Array)){if(!this.outputLookup){const L=new nt(d,"output");this.outputLookup=L.table,this.outputLookupLength=L.length}y=d.map((L,F)=>{const z=me.toArray(this.outputLookup,L.output,this.inputLookupLength);return{input:y[F].input,output:z}},this)}return y}transferData(d){const p=new Array(d.length),y=Et(function(L){return L[this.thread.x]},{output:[d[0].input.length],immutable:!0}),N=Et(function(L){return L[this.thread.x]},{output:[d[0].output.length],immutable:!0});for(let L=0;L<d.length;L++){const F=d[L];p[L]={input:y(F.input),output:N(F.output)}}return p}test(){throw new Error(`${this.constructor.name}-test is not yet implemented`)}toJSON(){var d;if(this.layers||this.initialize(),!this._model||!this.layers||!this._inputLayer||!this._hiddenLayers||!this._outputLayer)throw new Error("network is not initialized");const p=[];for(let y=0;y<this.layers.length;y++){const N=this.layers[y],L=N.toJSON();N.hasOwnProperty("inputLayer")?L.inputLayerIndex=this.layers.indexOf(N.inputLayer):N.hasOwnProperty("inputLayer1")&&N.hasOwnProperty("inputLayer2")&&(L.inputLayer1Index=this.layers.indexOf(N.inputLayer1),L.inputLayer2Index=this.layers.indexOf(N.inputLayer2)),p.push(L)}return{type:this.constructor.name,sizes:(d=this.options.sizes)!==null&&d!==void 0?d:[this._inputLayer.height].concat(this._hiddenLayers.map(y=>y.height)).concat([this._outputLayer.height]),outputLayerIndex:this.layers.indexOf(this._outputLayer),layers:p,inputLayerIndex:this.layers.indexOf(this._inputLayer)}}static fromJSON(d,p){var y,N,L,F;const z=d.layers,P=[],k=p?(y=ao(z[0]))!==null&&y!==void 0?y:p(z[0]):ao(z[0]);if(!k)throw new Error("unable to find layer");P.push(k);for(let R=1;R<z.length;R++){const S=z[R];if(typeof S.inputLayerIndex>"u"&&typeof S.inputLayer1Index>"u"&&typeof S.inputLayer2Index>"u"){const T=p?(N=ao(S))!==null&&N!==void 0?N:p(S):ao(S);if(!T)throw new Error("unable to find layer");P.push(T)}else if(typeof S.inputLayerIndex=="number"){const T=P[S.inputLayerIndex];if(!T)throw new Error("inputLayer1 not found");const H=p?(L=ao(S,T))!==null&&L!==void 0?L:p(S,T):ao(S,T);if(!H)throw new Error("unable to find layer");P.push(H)}else{if(typeof S.inputLayer1Index!="number")throw new Error("Cannot create network from provided JSON. inputLayer1Index not defined.");if(typeof S.inputLayer2Index!="number")throw new Error("Cannot create network from provided JSON. inputLayer2Index not defined.");const T=P[S.inputLayer1Index],H=P[S.inputLayer2Index];if(T===void 0)throw new Error(`Cannot create network from provided JSON. layer of index ${S.inputLayer1Index} not found.`);if(H===void 0)throw new Error(`Cannot create network from provided JSON. layer of index ${S.inputLayer2Index} not found.`);const te=p?(F=ao(S,T,H))!==null&&F!==void 0?F:p(S,T,H):ao(S,T,H);if(!te)throw new Error("unable to find layer");P.push(te)}}return new this({...d,layers:P})}toFunction(){throw new Error(`${this.constructor.name}-toFunction is not yet implemented`)}}function al(O,d){if(!d)throw new TypeError(`Required parameter 'net' is of type ${typeof d}. Must be of type 'brain.NeuralNetwork'`);const p=d.run(O);let y=null,N=-1;return Object.entries(p).forEach(([L,F])=>{typeof F<"u"&&typeof F=="number"&&F>N&&(y=L,N=F)}),y}class Gl extends Cr{constructor(){super(...arguments),this.settings={},this.layer=null}setLayer(d){this.layer=d}get width(){if(!this.layer)throw new Error("layer not set");return this.layer.width}set width(d){throw new Error(`${this.constructor.name}-width is not yet implemented`)}get height(){if(!this.layer)throw new Error("layer not set");return this.layer.height}set height(d){throw new Error(`${this.constructor.name}-height is not yet implemented`)}get deltas(){if(!this.layer)throw new Error("layer not set");return this.layer.deltas}set deltas(d){if(!this.layer)throw new Error("layer not set");Dt(this.layer.deltas),this.layer.deltas=d}get weights(){if(!this.layer)throw new Error("layer not set");return this.layer.weights}set weights(d){if(!this.layer)throw new Error("layer not set");Dt(this.layer.weights),this.layer.weights=d}predict(){}compare(){}learn(){throw new Error("no longer using")}setupKernels(){}reuseKernels(){}}class Ka extends oo{constructor(d={}){super(d),this.trainOpts={},this._outputConnection=null,this._layerSets=[],this._hiddenLayerOutputIndices=[],this._model=null}_connectLayers(){if(!this.options.inputLayer)throw new Error("inputLayer not found");if(!this.options.outputLayer)throw new Error("outputLayer not found");const d=this.options.inputLayer(),p=this._connectHiddenLayers(d),y=this.options.outputLayer(p[p.length-1],-1);return{inputLayer:d,hiddenLayers:p,outputLayer:y}}_connectLayersDeep(){const d=[],p=this._layerSets[this._layerSets.length-1];let y=0;function N(F){const z=p.indexOf(F);if(z<0)throw new Error("unable to find layer");return d[z]}function L(F){return{...F.settings,weights:null,deltas:null,praxis:null}}for(let F=0;F<p.length;F++){const z=p[F];let P;if(z instanceof kr)P=new z.constructor(N(z.inputLayer),L(z));else if(z instanceof tr)P=new z.constructor(L(z));else if(z instanceof vr)P=new z.constructor(L(z.inputLayer),N(z.inputLayer));else if(z instanceof Cr){const k=p[this._hiddenLayerOutputIndices[y++]];if(z instanceof Gl)throw new Error("unfinished");if(z instanceof lr)P=new lr(k);else if(z instanceof ui)P=new lr(k);else throw new Error(`hidden layer ${z.constructor.name} extends unknown hidden layer`)}else if(z instanceof Pi||z instanceof cr)P=z;else if(z instanceof Ci)P=new z.constructor(N(z.inputLayer),L(z.inputLayer));else if(z instanceof dn)P=new z.constructor(N(z.inputLayer1),N(z.inputLayer2),L(z));else if(z instanceof Rr)P=new z.constructor(L(z),N(z.inputLayer));else throw new Error(`hidden layer ${z.constructor.name} extends unknown hidden layer`);d.push(P)}return d}_connectHiddenLayers(d){const p=[];if(!this.options.hiddenLayers)throw new Error("hiddenLayers not defined");for(let y=0;y<this.options.hiddenLayers.length;y++){const N=new ui,L=this.options.hiddenLayers[y](d,N,y);d=L,p.push(L)}return p}initialize(){this._outputConnection=new Gl;let d;if(this.options.layers)d=this._connectOptionsLayers();else{const{inputLayer:p,hiddenLayers:y,outputLayer:N}=this._connectLayers();d=Mo([p,...y,N]),this._hiddenLayerOutputIndices=y.map(L=>d.indexOf(L)),this._inputLayer=p,this._hiddenLayers=y,this._outputLayer=N}this.layers=d,this._layerSets=[d],this._model=d.filter(p=>p instanceof cr||p instanceof Pi),this.initializeLayers(d)}initializeDeep(){const d=this._connectLayersDeep();for(let p=0;p<d.length;p++){const y=d[p];y.setupKernels(!0),y.reuseKernels(this._layerSets[0][p])}this._layerSets.push(d)}run(d){for(;this._layerSets.length<=d.length;)this.initializeDeep();const p=this.runInputs(d);return p instanceof he.Texture?p.toArray():p}runInput(d){throw new Error("use .runInputs()")}runInputs(d){for(;this._layerSets.length<d.length;)this.initializeDeep();const p=d.length-1;for(let L=0;L<=p;L++){const F=this._layerSets[L];F[0].predict(d[L]);for(let z=1;z<F.length;z++)F[z].predict()}const y=this._layerSets[p],N=y[y.length-1].weights;return this.end(),N}train(d,p={}){const{preparedData:y,status:N,endTime:L}=this._prepTraining(d,p);let F=!0;const z=()=>this._calculateTrainingError(y),P=()=>this._trainPatterns(y);for(;F;)F=this._trainingTick(N,L,z,P);return N}end(){const d=this._layerSets.length-1,p=this._layerSets[d];p[0].predict([new Float32Array([0])]);for(let y=1;y<p.length;y++)p[y].predict()}transferData(d){return d}_prepTraining(d,p){this._updateTrainingOptions(p);const y=this.trainOpts.timeout?Date.now()+this.trainOpts.timeout:0,N={error:1,iterations:0};return this.verifyIsInitialized(),{preparedData:this.transferData(d),status:N,endTime:y}}_calculateTrainingError(d){if(!this.meanSquaredError)throw new Error("this.meanSquaredError not setup");let p=new Float32Array(1);for(let N=0;N<d.length;++N){const L=p,F=this._trainPattern(d[N],!0);p=this.meanSquaredError.add(p,F),Dt(F),Dt(L)}const y=this.meanSquaredError.divide(d.length,p);return Dt(p),y instanceof he.Texture?y.toArray()[0]:y[0]}formatData(d){return d}_calculateDeltas(d){const p=this._layerSets[this._layerSets.length-1];for(let y=p.length-2;y>=0;y--)p[y].compare();for(let y=d.length-2;y>=0;y--){const N=this._layerSets[y];N[N.length-1].compare(d[y+1]);for(let L=N.length-2;L>=0;L--)N[L].compare()}}adjustWeights(){var d;const p=this._model;for(let y=0;y<p.length;y++)p[y].learn((d=this.options.learningRate)!==null&&d!==void 0?d:0)}_trainPatterns(d){for(let p=0;p<d.length;++p)this._trainPattern(d[p],!1)}_trainPattern(d,p){if(this.runInputs(d),this._calculateDeltas(d),this.adjustWeights(),p){if(!this.meanSquaredError)throw new Error("this.meanSquaredError not setup");let y=new Float32Array(1);for(let N=0,L=d.length-2;N<=L;N++){const F=this._layerSets[N],z=F[F.length-1],P=y;y=this.meanSquaredError.addAbsolute(P,z.errors),Dt(P)}return _t(this.meanSquaredError.divide(d.length,y))}return null}}class Wn{constructor(d,p){this.rows=0,this.columns=0,d&&(this.rows=d),p&&(this.columns=p),this.weights=Ye(this.rows*this.columns),this.deltas=Ye(this.rows*this.columns)}getWeight(d,p){const y=this.columns*d+p;if(y<0||y>=this.weights.length)throw new Error("get accessor is skewed");return this.weights[y]}setWeight(d,p,y){const N=this.columns*d+p;if(N<0||N>=this.weights.length)throw new Error("set accessor is skewed");return this.weights[N]=y,this}getDelta(d,p){const y=this.columns*d+p;if(y<0||y>=this.deltas.length)throw new Error("get accessor is skewed");return this.deltas[y]}setDelta(d,p,y){const N=this.columns*d+p;if(N<0||N>=this.weights.length)throw new Error("set accessor is skewed");return this.deltas[N]=y,this}toJSON(){return{rows:this.rows,columns:this.columns,weights:Array.from(this.weights.slice(0))}}static fromJSON(d){const p=new Wn(d.rows,d.columns);for(let y=0,N=d.rows*d.columns;y<N;y++)p.weights[y]=d.weights[y];return p}static fromArray(d){const p=new Wn(d.length,d[0].length);return p.fromArray(d),p}deltasToArray(){return this.toArray("deltas")}weightsToArray(){return this.toArray("weights")}toArray(d="weights"){const p=new Array(this.rows);return this.iterate({row:y=>{p[y]=new Array(this.columns)},column:(y,N)=>{d==="weights"?p[y][N]=this.getWeight(y,N):d==="deltas"&&(p[y][N]=this.getDelta(y,N))}}),p}fromArray(d,p="weights"){if(d.length!==this.rows)throw new Error("rows do not match");if(d[0].length!==this.columns)throw new Error("columns do not match");return this.iterate({column:(y,N)=>{const L=d[y][N];if(typeof L!="number")throw new Error("value not number");p==="weights"?this.setWeight(y,N,L):p==="deltas"&&this.setDelta(y,N,L)}}),this}iterate(d){const p=this.rows,y=this.columns;for(let N=0;N<p;N++){d.row&&d.row(N);for(let L=0;L<y;L++)d.column&&d.column(N,L)}return this}}class Ti extends Wn{constructor(d,p,y){super(d,p),this.std=y;for(let N=0,L=this.weights.length;N<L;N++)this.weights[N]=ot(-y,y)}}class ts{constructor(d,p=0){this.values=d,this.indexTable={},this.characterTable={},this.characters=[],this.specialIndexes=[],this.isSetup=!1,d!==void 0&&this.setup(d,p)}setup(d,p=0){if(this.isSetup)throw new Error("DataFormatter is already setup");this.values=d,this.buildCharactersFromIterable(d),this.buildTables(p),d[0].input&&this.addInputOutput(),this.addUnrecognized(),this.isSetup=!0}buildCharactersFromIterable(d){const p={};for(let y=0,N=d.length;y<N;y++){const L=d[y];if(L.hasOwnProperty("length")){const F=L;for(let z=0,P=F.length;z<P;z++){const k=F[z];p.hasOwnProperty(k)||(p[k]=!0,this.characters.push(k))}}else if(typeof L=="number"){if(p.hasOwnProperty(L))continue;p[L]=!0,this.characters.push(L)}else if(typeof L=="boolean"){const F=L.toString();if(p.hasOwnProperty(F))continue;p[F]=!0,this.characters.push(F)}else if(Array.isArray(L)&&typeof L[0]=="string")for(let F=0;F<L.length;F++){const z=L[F];p.hasOwnProperty(z)||(p[z]=!0,this.characters.push(z))}else if(Array.isArray(L)&&(typeof L[0]=="number"||typeof L[0]=="boolean"))for(let F=0;F<L.length;F++){const z=L[F].toString();p.hasOwnProperty(y)||(p[z]=!0,this.characters.push(z))}else if(L.hasOwnProperty("input")&&L.hasOwnProperty("output")){const{input:F,output:z}=L;Array.isArray(F)?this.addCharacters(F,p):this.addCharacters(F.toString(),p),Array.isArray(z)?this.addCharacters(z,p):this.addCharacters(z.toString(),p)}else throw new Error("Unhandled value")}}addCharacters(d,p){for(let y=0;y<d.length;y++){const N=d[y].toString();p.hasOwnProperty(N)||(p[N]=!0,this.characters.push(N))}}buildTables(d){const p=this.characters.length;for(let y=0;y<p;y++){const N=this.characters[y];y>=d&&(this.indexTable[N]=y,this.characterTable[y]=N)}}toIndexes(d,p=0){const y=[],{indexTable:N}=this;switch(typeof d){case"number":case"boolean":d=d.toString()}for(let L=0,F=d.length;L<F;L++){const z=d[L].toString();let P=N[z];if(P===void 0)if(N.unrecognized)P=N.unrecognized;else throw new Error(`unrecognized character "${z}"`);P<p||y.push(P)}return y}toIndexesInputOutput(d,p,y=0){const N=this.toIndexesValue(d,y,!0);return typeof p>"u"?N:N.concat(this.toIndexesValue(p,y,!1))}toIndexesValue(d,p,y){if(typeof d=="string")d=d.split("");else if(typeof d=="number"||typeof d=="boolean")d=d.toString().split("");else if(Array.isArray(d)&&(typeof d[0]=="number"||typeof d[0]=="boolean"||typeof d[0]=="string"))d=d.map(N=>N.toString());else throw new Error("unrecognized value");return y&&(d=d.concat(["stop-input","start-output"])),this.toIndexes(d,p)}toCharacters(d,p=0){const y=[],{indexTable:N,characterTable:L}=this;for(let F=0,z=d.length;F<z;F++){const P=d[F];if(P<p)continue;let k=L[P];if(k===void 0)if(N.unrecognized)k=L[N.unrecognized];else throw new Error(`unrecognized index "${P}"`);else k!==null&&y.push(k.toString())}return y}toString(d,p){return this.toCharacters(d,p).join("")}addInputOutput(){this.addSpecial("stop-input"),this.addSpecial("start-output")}addUnrecognized(){this.addSpecial("unrecognized")}static fromAllPrintable(d,p=[`
`]){for(let y=32;y<=126;y++)p.push(String.fromCharCode(y));return new ts(p,d)}static fromAllPrintableInputOutput(d,p=[`
`]){const y=ts.fromAllPrintable(d,p);return y.addInputOutput(),y.addUnrecognized(),y}static fromStringInputOutput(d,p){const y=Array.from(new Set(d)).join(""),N=new ts(y.split(""),p);return N.addInputOutput(),N.addUnrecognized(),N.isSetup=!0,N}static fromArrayInputOutput(d,p){const y=[];for(let F=0;F<d.length;F++){const z=d[F];y.push(Li(z.input),Li(z.output))}const N=Array.isArray(y)?y.flat():y,L=new ts(Array.from(new Set(N)),p);return L.addInputOutput(),L.addUnrecognized(),L.isSetup=!0,L}static fromString(d,p=0){const y=Array.from(new Set(d)).join("");return new ts(y.split(""),p)}toJSON(){return{indexTable:this.indexTable,characterTable:this.characterTable,values:this.values,characters:this.characters,specialIndexes:this.specialIndexes}}static fromJSON(d){const p=new ts;return p.indexTable=d.indexTable,p.characterTable=d.characterTable,p.values=d.values,p.characters=d.characters,p.specialIndexes=d.specialIndexes,p.isSetup=!0,p}addSpecial(d,p=null){const y=this.indexTable[d]=this.characters.length;this.characterTable[y]=p,this.specialIndexes.push(this.characters.length),this.characters.push(d)}toFunctionString(){return`
var characterTable = ${JSON.stringify(this.characterTable)};
var indexTable = ${JSON.stringify(this.indexTable)};
var characters = ${JSON.stringify(this.characters)};
var dataFormatter = {
  toIndexes: function ${this.toIndexes.toString()},
  toIndexesInputOutput: function ${this.toIndexesInputOutput.toString()},
  toCharacters: function ${this.toCharacters.toString()},
  toIndexesValue: function ${this.toIndexesValue.toString()},
};`}formatDataIn(d,p){var y;return d===void 0?[]:Array.isArray(d)&&typeof d[0]=="number"?d:!((y=this.indexTable)===null||y===void 0)&&y.hasOwnProperty("stop-input")?this.toIndexesInputOutput(d,p):this.toIndexes(d)}formatDataOut(d,p){return this.toCharacters(p).join("")}format(d){if(typeof d[0]=="number"&&!Array.isArray(d[0])&&(!d[0].hasOwnProperty("input")||!d[0].hasOwnProperty("output")))return d;const p=[];if(typeof d[0]=="string"||typeof d[0]=="number"||Array.isArray(d[0]))if(this.isSetup)for(let y=0,N=d.length;y<N;y++)p.push(this.formatDataIn(d[y]));else{this.setup(d);for(let y=0;y<d.length;y++)p.push(this.formatDataIn(Li(d[y])))}else if(d[0].input&&d[0].output){this.isSetup||this.setup(d);for(let y=0,N=d.length;y<N;y++)p.push(this.formatDataIn(Li(d[y].input),Li(d[y].output)))}else throw new Error("unrecognized data");return p}}function Li(O){if(typeof O=="string")return O;if(typeof O=="number"||typeof O=="boolean")return O.toString();if(Array.isArray(O)&&typeof O[0]=="string")return O;if(typeof O[0]=="boolean")return O.map(d=>d.toString());if(typeof O[0]=="number")return O.map(d=>d.toString());throw new Error("unrecognized value, expected string[], string, number[], number, boolean[], or boolean")}function zi(O,d){O.rows=d.rows,O.columns=d.columns,O.weights=d.weights.slice(0),O.deltas=d.deltas.slice(0)}function Er(O,d,p){for(let y=0;y<d.weights.length;y++)O.weights[y]=d.weights[y]+p.weights[y],O.deltas[y]=0}function hs(O,d,p){for(let y=0;y<O.deltas.length;y++)d.deltas[y]=O.deltas[y],p.deltas[y]=O.deltas[y]}function ol(O){for(let d=0;d<O.weights.length;d++)O.weights[d]=1,O.deltas[d]=0}function Ko(O,d){O.rows=d.rows,O.columns=d.columns,O.weights=d.weights.slice(0),O.deltas=d.deltas.slice(0);for(let p=0;p<d.weights.length;p++)O.weights[p]=-d.weights[p],O.deltas[p]=0}function pu(O,d,p){const y=d.rows,N=d.columns,L=p.columns;for(let F=0;F<y;F++){const z=N*F,P=L*F;for(let k=0;k<L;k++){let R=0;for(let S=0;S<N;S++){const T=L*S,H=z+S,te=T+k;R+=d.weights[H]*p.weights[te],d.deltas[H]=0,p.deltas[te]=0}O.weights[P+k]=R}}}function fc(O,d,p){const y=d.rows,N=d.columns,L=p.columns;for(let F=0;F<y;F++){const z=N*F,P=L*F;for(let k=0;k<L;k++)for(let R=0;R<N;R++){const S=L*R,T=z+R,H=S+k,te=O.deltas[P+k];d.deltas[T]+=p.weights[H]*te,p.deltas[H]+=d.weights[T]*te}}}function fd(O,d,p){const{weights:y}=d;for(let N=0;N<y.length;N++)O.weights[N]=d.weights[N]*p.weights[N],O.deltas[N]=0}function gf(O,d,p){for(let y=0;y<d.weights.length;y++)d.deltas[y]=p.weights[y]*O.deltas[y],p.deltas[y]=d.weights[y]*O.deltas[y]}function mf(O,d){for(let p=0;p<d.weights.length;p++)O.weights[p]=Math.max(0,d.weights[p]),O.deltas[p]=0}function yf(O,d){for(let p=0;p<O.deltas.length;p++)d.deltas[p]=d.weights[p]>0?O.deltas[p]:0}function pd(O,d,p){const{columns:y}=d,N=y*p;for(let L=0;L<y;L++)O.weights[L]=d.weights[N+L],O.deltas[L]=0}function gd(O,d,p){const{columns:y}=d,N=y*p;for(let L=0;L<y;L++)d.deltas[N+L]=O.deltas[L]}function gu(O,d){for(let p=0;p<d.weights.length;p++)O.weights[p]=1/(1+Math.exp(-d.weights[p])),O.deltas[p]=0}function So(O,d){for(let p=0;p<O.deltas.length;p++){const y=O.weights[p];d.deltas[p]=y*(1-y)*O.deltas[p]}}function Hl(O){const d=new Wn(O.rows,O.columns);let p=-999999;for(let N=0;N<O.weights.length;N++)O.weights[N]>p&&(p=O.weights[N]);let y=0;for(let N=0;N<O.weights.length;N++)d.weights[N]=Math.exp(O.weights[N]-p),y+=d.weights[N];for(let N=0;N<O.weights.length;N++)d.weights[N]/=y;return d}function lo(O,d){for(let p=0;p<d.weights.length;p++)O.weights[p]=Math.tanh(d.weights[p]),O.deltas[p]=0}function mu(O,d){for(let p=0;p<O.deltas.length;p++){const y=O.weights[p];d.deltas[p]=(1-y*y)*O.deltas[p]}}class pc{constructor(){this.states=[],this.inputRow=0}add(d,p){if(d.weights.length!==p.weights.length)throw new Error("misaligned matrices");const y=new Wn(d.rows,d.columns);return this.states.push({name:"add",product:y,left:d,right:p,forwardFn:Er,backpropagationFn:hs}),y}allOnes(d,p){const y=new Wn(d,p);return this.states.push({name:"allOnes",product:y,left:y,forwardFn:ol,backpropagationFn:()=>{}}),y}cloneNegative(d){const p=new Wn(d.rows,d.columns);return this.states.push({name:"cloneNegative",product:p,left:d,forwardFn:Ko,backpropagationFn:()=>{}}),p}subtract(d,p){if(d.weights.length!==p.weights.length)throw new Error("misaligned matrices");return this.add(this.add(this.allOnes(d.rows,d.columns),this.cloneNegative(d)),p)}multiply(d,p){if(d.columns!==p.rows)throw new Error("misaligned matrices");const y=new Wn(d.rows,p.columns);return this.states.push({name:"multiply",product:y,left:d,right:p,forwardFn:pu,backpropagationFn:fc}),y}multiplyElement(d,p){if(d.weights.length!==p.weights.length)throw new Error("misaligned matrices");const y=new Wn(d.rows,d.columns);return this.states.push({name:"multiplyElement",product:y,left:d,right:p,forwardFn:fd,backpropagationFn:gf}),y}relu(d){const p=new Wn(d.rows,d.columns);return this.states.push({name:"relu",product:p,left:d,forwardFn:mf,backpropagationFn:yf}),p}input(d){return this.states.push({name:"input",product:d,forwardFn:p=>{if(this.inputValue){if(this.inputValue.length!==p.weights.length)throw new Error("this.inputValue is of wrong dimensions");p.weights=d.weights=this.inputValue}},backpropagationFn:()=>{}}),d}inputMatrixToRow(d){const p=this,y=new Wn(d.columns,1);return this.states.push({name:"inputMatrixToRow",product:y,left:d,get right(){return p.inputRow},forwardFn:pd,backpropagationFn:gd}),y}sigmoid(d){const p=new Wn(d.rows,d.columns);return this.states.push({name:"sigmoid",product:p,left:d,forwardFn:gu,backpropagationFn:So}),p}tanh(d){const p=new Wn(d.rows,d.columns);return this.states.push({name:"tanh",product:p,left:d,forwardFn:lo,backpropagationFn:mu}),p}observe(d){return this.states.push({name:"observe",product:new Wn,forwardFn:()=>{},backpropagationFn:()=>{}}),d}runIndex(d=0){this.inputRow=d;let p=this.states[0];for(let y=0,N=this.states.length;y<N;y++)p=this.states[y],p.hasOwnProperty("forwardFn")&&p.forwardFn(p.product,p.left,p.right);return p.product}runInput(d){this.inputValue=d;let p=this.states[0];for(let y=0,N=this.states.length;y<N;y++)p=this.states[y],p.hasOwnProperty("forwardFn")&&p.forwardFn(p.product,p.left,p.right);return p.product}backpropagate(){let d=this.states.length,p=this.states[0];for(;d-- >0;)p=this.states[d],p.hasOwnProperty("backpropagationFn")&&p.backpropagationFn(p.product,p.left,p.right);return p.product}backpropagateIndex(d=0){this.inputRow=d;let p=this.states.length,y=this.states[0];for(;p-- >0;)y=this.states[p],y.hasOwnProperty("backpropagationFn")&&y.backpropagationFn(y.product,y.left,y.right);return y.product}predictTarget(d,p){let y=0;const N=this.runInput(d);for(let L=0;L<N.weights.length;L++){const F=N.weights[L]-p[L];y+=Math.abs(F),N.deltas[L]=F}return y}predictTargetIndex(d,p){const y=this.runIndex(d),N=y,L=Hl(y);return N.deltas=L.weights.slice(0),N.deltas[p]-=1,-Math.log2(L.weights[p])}}function yu(O){const{weights:d}=O;let p=d[0],y=0;for(let N=1;N<d.length;N++){const L=d[N];L<p||(y=N,p=L)}return y}function vu(O){const d=ot(0,1),p=O.weights;let y=0,N=0;for(;;){if(y+=p[N],y>d)return N;N++}}const Tl={iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,learningRate:.01,callbackPeriod:10,timeout:1/0},uo=()=>({inputSize:20,inputRange:20,hiddenLayers:[20,20],outputSize:20,decayRate:.999,smoothEps:1e-8,regc:1e-6,clipval:5,maxPredictionLength:100,dataFormatter:new ts});class Al{constructor(d={}){this.options={...uo()},this.trainOpts={...Tl},this.stepCache={},this.runs=0,this.ratioClipped=0,this.model=Object.seal({isInitialized:!1,input:new Wn(0,0),hiddenLayers:[],output:new Wn(0,0),equations:[],allMatrices:[],equationConnections:[],outputConnector:new Ti(0,0,.08)}),this.initialLayerInputs=[],this.options={...this.options,...d},this.updateTrainingOptions({...Tl}),d.json&&this.fromJSON(d.json)}initialize(){const{dataFormatter:d}=this.options;d?.characters.length&&(this.options.inputSize=this.options.inputRange=this.options.outputSize=d.characters.length),this.model=this.mapModel()}createHiddenLayers(){const{hiddenLayers:d,inputSize:p}=this.options,y=[];y.push(this.getHiddenLayer(d[0],p));let N=d[0];for(let L=1;L<d.length;L++){const F=d[L];y.push(this.getHiddenLayer(F,N)),N=F}return y}getHiddenLayer(d,p){return{weight:new Ti(d,p,.08),transition:new Ti(d,d,.08),bias:new Wn(d,1)}}getEquation(d,p,y,N){if(!N.weight||!N.transition||!N.bias)throw new Error("hiddenLayer does not have expected properties");const L=d.relu.bind(d),F=d.add.bind(d),z=d.multiply.bind(d);return L(F(F(z(N.weight,p),z(N.transition,y)),N.bias))}createInputMatrix(){const{inputRange:d,inputSize:p}=this.options;if(d<1)throw new Error("this.options.inputRange not an expected number");if(p<1)throw new Error("this.options.inputSize not an expected number");return new Ti(d+1,p,.08)}createOutputMatrices(){const{outputSize:d,hiddenLayers:p}=this.options,y=Gs(p);return{outputConnector:new Ti(d+1,y,.08),output:new Wn(d+1,1)}}bindEquation(){const{model:d}=this,{hiddenLayers:p}=this.options,y=new pc,N=[],L=d.equationConnections.length>0?Gs(d.equationConnections):this.initialLayerInputs;let F=this.getEquation(y,y.inputMatrixToRow(d.input),L[0],d.hiddenLayers[0]);N.push(F);for(let z=1,P=p.length;z<P;z++){if(!L[z])throw new Error(`Cannot find equation at index ${z}`);F=this.getEquation(y,F,L[z],d.hiddenLayers[z]),N.push(F)}d.equationConnections.push(N),y.add(y.multiply(d.outputConnector,F),d.output),d.equations.push(y)}mapModel(){const d=[];this.initialLayerInputs=this.options.hiddenLayers.map(F=>new Wn(F,1));const p=this.createInputMatrix();d.push(p);const y=this.createHiddenLayers();if(!y.length)throw new Error("net.hiddenLayers not set");for(let F=0,z=y.length;F<z;F++){const P=y[F];for(const k in P)P.hasOwnProperty(k)&&d.push(P[k])}const{output:N,outputConnector:L}=this.createOutputMatrices();return d.push(L),d.push(N),Object.seal({isInitialized:!0,input:p,hiddenLayers:y,output:N,equations:[],allMatrices:d,equationConnections:[],outputConnector:L})}trainInput(d){this.runs++;const{model:p}=this,y=d.length;let N=0,L;for(;p.equations.length<=d.length+1;)this.bindEquation();for(let F=-1,z=d.length;F<z;F++){const P=F+1;L=p.equations[P];const k=F===-1?0:d[F]+1,R=F===y-1?0:d[F+1]+1;N+=L.predictTargetIndex(k,R)}return Math.pow(2,N/(y-1))/100}backpropagate(d){let p=d.length;const{model:y}=this,{equations:N}=y;for(;p>0;)N[p].backpropagateIndex(d[p-1]+1),p--;N[0].backpropagateIndex(0)}adjustWeights(){const{regc:d,clipval:p,decayRate:y,smoothEps:N}=this.options,{trainOpts:L,model:F,stepCache:z}=this,{learningRate:P}=L,{allMatrices:k}=F;let R=0,S=0;for(let T=0;T<k.length;T++){const H=k[T],{weights:te,deltas:Se}=H;T in z||(z[T]=Ye(H.rows*H.columns));const ie=z[T];for(let _e=0;_e<te.length;_e++){let Y=Se[_e];const re=te[_e];ie[_e]=ie[_e]*y+(1-y)*Y*Y,Y>p?(Y=p,R++):Y<-p&&(Y=-p,R++),S++,te[_e]=re+-P*Y/Math.sqrt(ie[_e]+N)-d*re}}this.ratioClipped=R/S}get isRunnable(){return this.model&&this.model.equations.length===0?(console.error("No equations bound, did you run train()?"),!1):!0}checkRunnable(){if(!this.isRunnable)throw new Error("Network not runnable")}run(d=[],p=!1,y=1){const N=this.options.maxPredictionLength+(d!==null?d.length:0)+(this.options.dataFormatter?this.options.dataFormatter.specialIndexes.length:0);this.checkRunnable();const L=this.options.dataFormatter&&d.length>0?this.options.dataFormatter.formatDataIn(d):d,{model:F}=this,z=[];let P=0;for(;;){const k=P===0?0:P<L.length?L[P-1]+1:z[P-1];for(;F.equations.length<=P;)this.bindEquation();const S=F.equations[P].runIndex(k),T=new Wn(F.output.rows,F.output.columns);if(zi(T,S),y!==1&&p)for(let Se=0,ie=T.weights.length;Se<ie;Se++)T.weights[Se]/=y;const H=Hl(T),te=p?vu(H):yu(H);if(P++,te===0||P>=N)break;z.push(te)}return this.options.dataFormatter.formatDataOut(L,z.slice(L.length).map(k=>k-1))}verifyIsInitialized(){this.model.isInitialized||this.initialize()}updateTrainingOptions(d){var p;this.trainOpts={...Tl,...d},this.validateTrainingOptions(this.trainOpts),this.setLogMethod((p=d.log)!==null&&p!==void 0?p:this.trainOpts.log)}validateTrainingOptions(d){const p={iterations:()=>{const y=d.iterations;return typeof y=="number"&&y>0},errorThresh:()=>{const y=d.errorThresh;return typeof y=="number"&&y>0&&y<1},log:()=>{const y=d.log;return typeof y=="function"||typeof y=="boolean"},logPeriod:()=>{const y=d.logPeriod;return typeof y=="number"&&y>0},learningRate:()=>{const y=d.learningRate;return typeof y=="number"&&y>0&&y<1},callback:()=>{const y=d.callback;return typeof y=="function"||y===void 0},callbackPeriod:()=>{const y=d.callbackPeriod;return typeof y=="number"&&y>0},timeout:()=>{const y=d.timeout;return typeof y=="number"&&y>0}};for(const y in p){const N=d;if(!p[y]())throw new Error(`[${y}, ${N[y]}] is out of normal training range, your network will probably not train.`)}}setLogMethod(d){typeof d=="function"?this.trainOpts.log=d:d?this.trainOpts.log=console.log:this.trainOpts.log=!1}prepTraining(d,p){var y;this.updateTrainingOptions(p);const N=this.options.dataFormatter.format(d),L=Date.now()+((y=this.trainOpts.timeout)!==null&&y!==void 0?y:0),F={error:1,iterations:0};return this.verifyIsInitialized(),{preparedData:N,status:F,endTime:L}}train(d,p={}){var y;this.trainOpts=p={...Tl,...p};const{iterations:N,errorThresh:L,logPeriod:F,callback:z,callbackPeriod:P}=this.trainOpts,k=p.log===!0?console.log:p.log;let R=1/0,S,T;if(!((y=this.options)===null||y===void 0)&&y.dataFormatter)T=this.options.dataFormatter.format(d);else if(Array.isArray(d)&&Array.isArray(d[0])&&typeof d[0][0]=="number")T=d;else throw new Error("training not in expected format of number[][]");for(this.verifyIsInitialized(),S=0;S<N&&R>L;S++){let H=0;for(let te=0;te<T.length;te++){const Se=this.trainPattern(T[te],!0);H+=Se}if(R=H/d.length,isNaN(R))throw new Error("Network error rate is unexpected NaN, check network configurations and try again. Most probably input format is not correct or training data is not enough. ");k&&S%F===0&&k(`iterations: ${S}, training error: ${R}`),z&&S%P===0&&z({error:R,iterations:S})}return{error:R,iterations:S}}addFormat(d){}formatData(d){const p=[];for(let y=0;y<d.length;y++)p.push(this.options.dataFormatter.formatDataIn(d[y]));return p}toJSON(){this.model.isInitialized||this.initialize();const{model:d,options:p}=this;return{type:this.constructor.name,options:{...p,dataFormatter:p.dataFormatter.toJSON()},trainOpts:{...this.trainOpts,timeout:this.trainOpts.timeout===1/0?"Infinity":this.trainOpts.timeout},input:d.input.toJSON(),hiddenLayers:d.hiddenLayers.map(y=>{const N={};for(const L in y)y.hasOwnProperty(L)&&(N[L]=y[L].toJSON());return N}),outputConnector:this.model.outputConnector.toJSON(),output:this.model.output.toJSON()}}fromJSON(d){const{options:p}=d,y=[],N=Wn.fromJSON(d.input);y.push(N);const L=[];d.hiddenLayers.forEach(P=>{const k={};for(const R in P)k[R]=Wn.fromJSON(P[R]),y.push(k[R]);L.push(k)});const F=Wn.fromJSON(d.outputConnector);y.push(F);const z=Wn.fromJSON(d.output);return y.push(z),p.dataFormatter?this.options={...uo(),...p,dataFormatter:ts.fromJSON(p.dataFormatter)}:this.options={...uo(),...p,dataFormatter:new ts},this.model=Object.seal({isInitialized:!0,input:N,hiddenLayers:L,output:z,allMatrices:y,outputConnector:F,equations:[],equationConnections:[]}),this.initialLayerInputs=this.options.hiddenLayers.map(P=>new Wn(P,1)),this.bindEquation(),this}toFunction(d){const{model:p}=this,{equations:y}=this.model,N=y[1],{states:L}=N,F=JSON.stringify(this.toJSON());function z(ie){const _e=p.equationConnections[0],{states:Y}=y[0];for(let re=0,be=Y.length;re<be;re++)if(Y[re].product===ie)return re;return _e.indexOf(ie)}function P(ie,_e){for(let Y=0,re=L.length;Y<re;Y++){const be=L[Y];if(Y===_e){const ke=z(ie);return ke>-1&&(ie===be.left||ie===be.right)?`typeof prevStates[${ke}] === 'object' ? prevStates[${ke}].product : new Matrix(${ie.rows}, ${ie.columns})`:`new Matrix(${ie.rows}, ${ie.columns})`}if(ie===be.product)return`states[${Y}].product`;if(ie===be.right)return`states[${Y}].right`;if(ie===be.left)return`states[${Y}].left`}return""}function k(ie,_e){if(!ie||!ie.rows||!ie.columns)return"null";if(ie===p.input)return"json.input";if(ie===p.outputConnector)return"json.outputConnector";if(ie===p.output)return"json.output";for(let Y=0,re=p.hiddenLayers.length;Y<re;Y++){const be=p.hiddenLayers[Y];for(const ke in be)if(be.hasOwnProperty(ke)&&be[ke]===ie)return`json.hiddenLayers[${Y}].${ke}`}return P(ie,_e)}function R(ie){const _e=ie.toString().split("{");_e.shift();const re=_e.join("{").split("}");return re.pop(),re.join("}").split(`
`).join(`
        `).replace("product.deltas[i] = 0;","").replace("product.deltas[column] = 0;","").replace("left.deltas[leftIndex] = 0;","").replace("right.deltas[rightIndex] = 0;","").replace("product.deltas = left.deltas.slice(0);","")}function S(ie){return`src/recurrent/matrix/${ie.replace(/[A-Z]/g,function(_e){return`-${_e.toLowerCase()}`})}.js`}const T=[],H={},te=[];for(let ie=0,_e=L.length;ie<_e;ie++){const Y=L[ie];T.push(`states[${ie}] = {
      name: '${Y.forwardFn.name}',
      left: ${Y.left?k(Y.left,ie):"undefined"},
      right: ${Y.right?k(Y.right,ie):"undefined"},
      product: ${k(Y.product,ie)}
    }`);const re=Y.forwardFn.name;H[re]||(H[re]=!0,te.push(`        case '${re}': //compiled from ${S(re)}
          ${R(Y.forwardFn.toString())}
          break;`))}const Se=`
  if (typeof rawInput === 'undefined') rawInput = [];
  if (typeof isSampleI === 'undefined') isSampleI = false;
  if (typeof temperature === 'undefined') temperature = 1;
  var json = ${F};
  ${this.options.dataFormatter?`${this.options.dataFormatter.toFunctionString()};
  Object.assign(dataFormatter, json.options.dataFormatter);`:""}
  ${this.options.dataFormatter&&typeof this.options.dataFormatter.formatDataIn=="function"?`const formatDataIn = function (input, output) { ${R(this.options.dataFormatter.formatDataIn.toString())} }.bind(dataFormatter);`:""}
  ${this.options.dataFormatter!==null&&typeof this.options.dataFormatter.formatDataOut=="function"?`const formatDataOut = function formatDataOut(input, output) { ${R(this.options.dataFormatter.formatDataOut.toString())} }.bind(dataFormatter);`:""}
  var maxPredictionLength =
    ${this.options.maxPredictionLength} +
    rawInput.length +
    ${this.options.dataFormatter?this.options.dataFormatter.specialIndexes.length:0};
  var input = ${this.options.dataFormatter&&typeof this.options.dataFormatter.formatDataIn=="function"?"formatDataIn(rawInput)":"rawInput"};
  var _i = 0;
  var output = [];
  var states = [];
  var prevStates;
  while (true) {
    var previousIndex = (_i === 0
        ? 0
        : _i < input.length
          ? input[_i - 1] + 1
          : output[_i - 1])
          ;
    var rowPluckIndex = previousIndex;
    prevStates = states;
    states = [];
    ${T.join(`;
    `)};
    for (var stateIndex = 0, stateMax = ${T.length}; stateIndex < stateMax; stateIndex++) {
      var state = states[stateIndex];
      var product = state.product;
      var left = state.left;
      var right = state.right;
      switch (state.name) {
${te.join(`
`)}
      }
    }

    var logProbabilities = state.product;
    if (temperature !== 1 && isSampleI) {
      for (var q = 0, nq = logProbabilities.weights.length; q < nq; q++) {
        logProbabilities.weights[q] /= temperature;
      }
    }

    var probs = softmax(logProbabilities);
    var nextIndex = isSampleI ? sampleI(probs) : maxI(probs);

    _i++;
    if (nextIndex === 0) {
      break;
    }
    if (_i >= maxPredictionLength) {
      break;
    }

    output.push(nextIndex);
  }
  ${this.options.dataFormatter&&typeof this.options.dataFormatter.formatDataOut=="function"?"return formatDataOut(input, output.slice(input.length).map(function(value) { return value - 1; }))":"return output.slice(input.length).map(function(value) { return value - 1; })"};
  function Matrix(rows, columns) {
    this.rows = rows;
    this.columns = columns;
    this.weights = zeros(rows * columns);
  }
  ${Ye.toString()}
  ${Hl.toString().replace("_1.Matrix","Matrix")}
  ${ot.toString()}
  ${vu.toString()}
  ${yu.toString()}`;return new Function("rawInput","isSampleI","temperature",d?d(Se):Se)}trainPattern(d,p){const y=this.trainInput(d);return this.backpropagate(d),this.adjustWeights(),p?y:0}}function Gs(O){return O[O.length-1]}class Hs extends Al{getHiddenLayer(d,p){return gc(d,p)}getEquation(d,p,y,N){return aa(d,p,y,N)}}function gc(O,d){return{updateGateInputMatrix:new Ti(O,d,.08),updateGateHiddenMatrix:new Ti(O,O,.08),updateGateBias:new Wn(O,1),resetGateInputMatrix:new Ti(O,d,.08),resetGateHiddenMatrix:new Ti(O,O,.08),resetGateBias:new Wn(O,1),cellWriteInputMatrix:new Ti(O,d,.08),cellWriteHiddenMatrix:new Ti(O,O,.08),cellWriteBias:new Wn(O,1)}}function aa(O,d,p,y){if(!y.updateGateInputMatrix||!y.updateGateHiddenMatrix||!y.updateGateBias||!y.resetGateInputMatrix||!y.resetGateHiddenMatrix||!y.resetGateBias||!y.cellWriteInputMatrix||!y.cellWriteHiddenMatrix||!y.cellWriteBias)throw new Error("hiddenLayer does not have expected properties");const N=O.sigmoid.bind(O),L=O.add.bind(O),F=O.multiply.bind(O),z=O.multiplyElement.bind(O),P=O.tanh.bind(O),k=O.allOnes.bind(O),R=O.cloneNegative.bind(O),S=N(L(L(F(y.updateGateInputMatrix,d),F(y.updateGateHiddenMatrix,p)),y.updateGateBias)),T=N(L(L(F(y.resetGateInputMatrix,d),F(y.resetGateHiddenMatrix,p)),y.resetGateBias)),H=P(L(L(F(y.cellWriteInputMatrix,d),F(y.cellWriteHiddenMatrix,z(T,p))),y.cellWriteBias));return L(z(L(k(S.rows,S.columns),R(S)),H),z(p,S))}class mc{constructor(d,p){this.prop=p,this.length=0,this.table={};for(let y=0;y<d.length;y++){const L=d[y][p];for(let F=0;F<L.length;F++){const z=L[F];for(const P in z)z.hasOwnProperty(P)&&(this.table.hasOwnProperty(P)||(this.table[P]=this.length++))}}}}const co=()=>({...uo(),inputSize:1,hiddenLayers:[20],outputSize:1,inputRange:0});class Kl extends Al{constructor(d={}){super(),this.inputLookupLength=0,this.inputLookup=null,this.outputLookup=null,this.outputLookupLength=0,this.model=Object.seal({isInitialized:!1,hiddenLayers:[],output:new Wn(0,0),equations:[],allMatrices:[],equationConnections:[],outputConnector:new Ti(0,0,.08)}),this.options=co(),this.options={...this.options,...d},this.updateTrainingOptions({...Vu,...d}),d.json&&this.fromJSON(d.json)}createInputMatrix(){throw new Error("Input Matrices do not exist on RNNTimeStep")}createOutputMatrices(){const{outputSize:d}=this.options,p=Gs(this.options.hiddenLayers),y=new Ti(d,p,.08);return{output:new Ti(d,1,.08),outputConnector:y}}bindEquation(){const{model:d,options:p}=this,{hiddenLayers:y,inputSize:N}=p,L=d.hiddenLayers,F=new pc,z=[],P=d.equationConnections.length>0?d.equationConnections[d.equationConnections.length-1]:this.initialLayerInputs;let k=this.getEquation(F,F.input(new Wn(N,1)),P[0],L[0]);z.push(k);for(let R=1,S=y.length;R<S;R++)k=this.getEquation(F,k,P[R],L[R]),z.push(k);d.equationConnections.push(z),F.add(F.multiply(d.outputConnector,k),d.output),d.equations.push(F)}initialize(){this.model=this.mapModel()}mapModel(){const d=[];this.initialLayerInputs=this.options.hiddenLayers.map(L=>new Wn(L,1));const p=this.createHiddenLayers();for(let L=0,F=p.length;L<F;L++){const z=p[L];for(const P in z)z.hasOwnProperty(P)&&d.push(z[P])}const{outputConnector:y,output:N}=this.createOutputMatrices();return d.push(y),d.push(N),Object.seal({isInitialized:!0,hiddenLayers:p,output:N,equations:[],allMatrices:d,equationConnections:[],outputConnector:y})}backpropagate(){for(let d=this.model.equations.length-1;d>-1;d--)this.model.equations[d].backpropagate()}run(d){const p=me.dataShape(d).join(",");switch(p){case"array,number":return this.runArray(d);case"array,array,number":return this.runArrayOfArray(d);case"object,number":return this.runObject(d);case"array,object,number":return this.runArrayOfObject(d);default:throw new Error(`Unrecognized data shape ${p}`)}}forecast(d,p=1){const y=me.dataShape(d).join(",");switch(y){case"array,number":return this.forecastArray(d,p);case"array,array,number":return this.forecastArrayOfArray(d,p);case"object,number":return this.runObject(d);case"array,object,number":return this.forecastArrayOfObject(d,p);default:throw new Error(`Unrecognized data shape ${y}`)}}forecastArray(d,p=1){this.checkRunnable();const{model:y}=this,{equations:N}=y,L=d.length+p;for(;N.length<=L;)this.bindEquation();let F,z=0;if(this.options.inputSize===1)for(let k=0;k<d.length;k++)F=N[z++].runInput(Float32Array.from([d[k]]));else for(let k=0;k<d.length;k++)F=N[z++].runInput(Float32Array.from([]));if(!F)throw new Error("lastOutput not set");const P=[F.weights[0]];for(let k=0,R=p-1;k<R;k++)F=N[z++].runInput(F.weights),P.push(F.weights[0]);return this.end(),Float32Array.from(P)}forecastArrayOfArray(d,p=1){this.checkRunnable();const{model:y}=this,{equations:N}=y,L=d.length+p;for(;N.length<=L;)this.bindEquation();let F,z=0;for(let k=0;k<d.length;k++)F=N[z++].runInput(d[k]);if(!F)throw new Error("lastOutput not set");const P=[Float32Array.from(F.weights)];for(let k=0,R=p-1;k<R;k++)F=N[z++].runInput(F.weights),P.push(Float32Array.from(F.weights.slice(0)));return this.end(),P}forecastArrayOfObject(d,p=1){if(!this.inputLookup)throw new Error("this.inputLookup not set");if(!this.outputLookup)throw new Error("this.outputLookup not set");const y=d.map(N=>me.toArray(this.inputLookup,N,this.inputLookupLength));return this.forecastArrayOfArray(y,p).map(N=>me.toObject(this.outputLookup,N))}train(d,p={}){this.trainOpts=p={...Tl,...p},this.options.inputSize===1&&this.options.outputSize===1&&this.setSize(d),this.verifySize();const y=this.formatData(d);let N=1/0,L;this.verifyIsInitialized();const{iterations:F,errorThresh:z,logPeriod:P,callback:k,callbackPeriod:R}=this.trainOpts,S=p.log===!0?console.log:p.log;for(L=0;L<F&&N>z;L++){let T=0;for(let H=0;H<y.length;H++){const te=this.trainPattern(y[H],!0);T+=te}if(N=T/y.length,isNaN(N))throw new Error("Network error rate is unexpected NaN, check network configurations and try again. Most probably input format is not correct or training data is not enough. ");S&&L%P===0&&S(`iterations: ${L}, training error: ${N}`),k&&L%R===0&&k({error:N,iterations:L})}return{error:N,iterations:L}}trainArrayOfArray(d){if(d.length<2)throw new Error("input must be an array of 2 or more");const{equations:p}=this.model;for(;p.length<d.length;)this.bindEquation();let y=0;for(let N=0,L=d.length-1;N<L;N++)y+=p[N].predictTarget(d[N],d[N+1]);return this.end(),y/d.length}trainPattern(d,p){const y=this.trainArrayOfArray(d);return this.backpropagate(),this.adjustWeights(),p?y:0}setSize(d){let p=0;switch(me.dataShape(d).join(",")){case"array,array,number":case"array,object,number":case"array,datum,array,number":case"array,datum,object,number":p=1;break;case"array,array,array,number":p=d[0][0].length;break;case"array,array,object,number":p=Object.keys(me.toTable2D(d)).length;break;case"array,datum,array,array,number":p=d[0].input[0].length;break;case"array,datum,array,object,number":p=Object.keys(me.toInputTable2D(d)).length;break;default:throw new Error("unknown data shape or configuration")}this.options=Object.seal({...this.options,inputSize:p,outputSize:p})}verifySize(){if((this.options.inputSize||this.options.outputSize)&&this.options.inputSize!==this.options.outputSize)throw new Error("manually set inputSize and outputSize mismatch")}runArray(d){this.checkRunnable();const{equations:p}=this.model;for(;p.length<=d.length;)this.bindEquation();let y;for(let N=0;N<d.length;N++)y=p[N].runInput(new Float32Array([d[N]]));return this.end(),y.weights[0]}runArrayOfArray(d){this.checkRunnable();const{model:p}=this,{equations:y}=p;for(;y.length<=d.length;)this.bindEquation();let N;for(let L=0;L<d.length;L++)N=y[L].runInput(d[L]).weights;return this.end(),N??Float32Array.from([])}runObject(d){if(!this.inputLookup)throw new Error("this.inputLookup not set");if(!this.outputLookup)throw new Error("this.outputLookup not set");if(!this.outputLookupLength)throw new Error("this.outputLookupLength not set");if(this.inputLookup===this.outputLookup){const p=me.toArrayShort(this.inputLookup,d);return me.toObjectPartial(this.outputLookup,this.forecastArray(p,this.outputLookupLength-p.length),p.length)}return me.toObject(this.outputLookup,this.forecastArray(me.toArray(this.inputLookup,d,this.inputLookupLength),this.outputLookupLength))}runArrayOfObject(d){if(this.inputLookup===null)throw new Error("this.inputLookup not set");if(this.outputLookup===null)throw new Error("this.outputLookup not set");const p=d.map(y=>me.toArray(this.inputLookup,y,this.inputLookupLength));return this.forecastArrayOfArray(p,1).map(y=>me.toObject(this.outputLookup,y))[0]}runArrayOfObjectOfArray(d){if(!this.inputLookup)throw new Error("this.inputLookup not set");if(!this.outputLookup)throw new Error("this.outputLookup not set");return me.toObject(this.outputLookup,this.runArrayOfArray(me.toArrays(this.inputLookup,d,this.inputLookupLength)))}end(){this.model.equations[this.model.equations.length-1].runInput(new Float32Array(this.options.outputSize))}requireInputOutputOfOne(){if(this.options.inputSize!==1)throw new Error("inputSize must be 1 for this data size");if(this.options.outputSize!==1)throw new Error("outputSize must be 1 for this data size")}formatArray(d){const p=[];this.requireInputOutputOfOne();for(let y=0;y<d.length;y++)p.push(Float32Array.from([d[y]]));return[p]}formatArrayOfArray(d){const p=[],{inputSize:y,outputSize:N}=this.options;if(y===1&&N===1){for(let L=0;L<d.length;L++)p.push(ee(d[L]));return p}if(y!==d[0].length)throw new Error("inputSize must match data input size");if(N!==d[0].length)throw new Error("outputSize must match data output size");for(let L=0;L<d.length;L++)p.push(Float32Array.from(d[L]));return[p]}formatArrayOfObject(d){if(this.requireInputOutputOfOne(),!this.inputLookup){const y=new nt(d);this.inputLookup=this.outputLookup=y.table,this.inputLookupLength=this.outputLookupLength=y.length}const p=[];for(let y=0;y<d.length;y++)p.push(ae(d[y]));return p}formatArrayOfObjectMulti(d){if(!this.inputLookup){const y=new nt(d);this.inputLookup=this.outputLookup=y.table,this.inputLookupLength=this.outputLookupLength=y.length}const p=[];for(let y=0;y<d.length;y++)p.push([ze(d[y],this.inputLookup,this.inputLookupLength)]);return p}formatArrayOfDatumOfArray(d){const p=[];this.requireInputOutputOfOne();for(let y=0;y<d.length;y++){const N=d[y];p.push(J(N.input,N.output))}return p}formatArrayOfDatumOfObject(d){if(this.requireInputOutputOfOne(),!this.inputLookup){const y=new nt(d,"input");this.inputLookup=y.table,this.inputLookupLength=y.length}if(!this.outputLookup){const y=new nt(d,"output");this.outputLookup=y.table,this.outputLookupLength=y.length}const p=[];for(let y=0;y<d.length;y++){const N=d[y];p.push(le(N.input,N.output))}return p}formatArrayOfArrayOfArray(d){const p=[];for(let y=0;y<d.length;y++)p.push(Ve(d[y]));return p}formatArrayOfArrayOfObject(d){if(!this.inputLookup){const y=new nt(d);this.inputLookup=this.outputLookup=y.table,this.inputLookupLength=this.outputLookupLength=y.length}const p=[];for(let y=0;y<d.length;y++){const N=[];for(let L=0;L<d[y].length;L++)N.push(ze(d[y][L],this.inputLookup,this.inputLookupLength));p.push(N)}return p}formatArrayOfDatumOfArrayOfArray(d){const p=[],{inputSize:y,outputSize:N}=this.options;if(y!==d[0].input[0].length)throw new Error("inputSize must match data input size");if(N!==d[0].output[0].length)throw new Error("outputSize must match data output size");for(let L=0;L<d.length;L++){const F=d[L];p.push(pe(F.input,F.output))}return p}formatArrayOfDatumOfArrayOfObject(d){if(!this.inputLookup){const y=new mc(d,"input");this.inputLookup=y.table,this.inputLookupLength=y.length}if(!this.outputLookup){const y=new mc(d,"output");this.outputLookup=y.table,this.outputLookupLength=y.length}if(!this.outputLookupLength)throw new Error("this.outputLookupLength not set to usable number");const p=[];for(let y=0;y<d.length;y++){const N=d[y];p.push(X(N.input,N.output,this.inputLookup,this.outputLookup,this.inputLookupLength,this.outputLookupLength))}return p}formatData(d){switch(me.dataShape(d).join(",")){case"array,number":return this.formatArray(d);case"array,array,number":return this.formatArrayOfArray(d);case"array,object,number":return this.options.inputSize===1?this.formatArrayOfObject(d):this.formatArrayOfObjectMulti(d);case"array,datum,array,number":return this.formatArrayOfDatumOfArray(d);case"array,datum,object,number":return this.formatArrayOfDatumOfObject(d);case"array,array,array,number":return this.formatArrayOfArrayOfArray(d);case"array,array,object,number":return this.formatArrayOfArrayOfObject(d);case"array,datum,array,array,number":return this.formatArrayOfDatumOfArrayOfArray(d);case"array,datum,array,object,number":return this.formatArrayOfDatumOfArrayOfObject(d);default:throw new Error("unknown data shape or configuration")}}test(d){const p=[];let y=0;const N=this.formatData(d);for(let L=0;L<N.length;L++){const F=N[L],z=this.run(F.splice(0,F.length-1)),P=F[F.length-1];let k=0,R=0;for(let T=0;T<z.length;T++){R++;const H=P[T]-z[T];k+=H*H}if(y+=k/R,Math.abs(k)>this.trainOpts.errorThresh){const T=d[L];p.push({value:T,actual:z})}}return{error:y/N.length,misclasses:p,total:N.length}}addFormat(d){var p,y,N,L,F,z;switch(me.dataShape(d).join(",")){case"array,array,number":case"datum,array,array,number":case"array,number":case"datum,array,number":return;case"datum,object,number":{this.inputLookup=me.addKeys(d.input,(p=this.inputLookup)!==null&&p!==void 0?p:{}),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length),this.outputLookup=me.addKeys(d.output,(y=this.outputLookup)!==null&&y!==void 0?y:{}),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length);break}case"object,number":{this.inputLookup=this.outputLookup=me.addKeys(d,(N=this.inputLookup)!==null&&N!==void 0?N:{}),this.inputLookup&&(this.inputLookupLength=this.outputLookupLength=Object.keys(this.inputLookup).length);break}case"array,object,number":{const k=d;for(let R=0;R<k.length;R++)this.inputLookup=this.outputLookup=me.addKeys(k[R],(L=this.inputLookup)!==null&&L!==void 0?L:{}),this.inputLookup&&(this.inputLookupLength=this.outputLookupLength=Object.keys(this.inputLookup).length);break}case"datum,array,object,number":{const k=d,R=k.input;for(let T=0;T<R.length;T++)this.inputLookup=me.addKeys(R[T],(F=this.inputLookup)!==null&&F!==void 0?F:{}),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length);const S=k.output;for(let T=0;T<S.length;T++)this.outputLookup=me.addKeys(S[T],(z=this.outputLookup)!==null&&z!==void 0?z:{}),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length);break}default:throw new Error("unknown data shape or configuration")}}toJSON(){this.model||this.initialize();const{model:d}=this,p={...this.options,...uo};return{type:this.constructor.name,options:p,hiddenLayers:d.hiddenLayers.map(y=>{const N={};for(const L in y)y.hasOwnProperty(L)&&(N[L]=y[L].toJSON());return N}),outputConnector:d.outputConnector.toJSON(),output:d.output.toJSON(),inputLookup:this.inputLookup,inputLookupLength:this.inputLookupLength,outputLookup:this.outputLookup,outputLookupLength:this.outputLookupLength}}fromJSON(d){const{options:p}=d,y=[],N=[];d.hiddenLayers.forEach(z=>{const P={};for(const k in z)P[k]=Wn.fromJSON(z[k]),y.push(P[k]);N.push(P)});const L=Wn.fromJSON(d.outputConnector);y.push(L);const F=Wn.fromJSON(d.output);return y.push(F),this.options={...co(),...p},this.inputLookup=d.inputLookup,this.inputLookupLength=d.inputLookupLength,this.outputLookup=d.outputLookup,this.outputLookupLength=d.outputLookupLength,this.model=Object.seal({isInitialized:!0,hiddenLayers:N,output:F,allMatrices:y,outputConnector:L,equations:[],equationConnections:[]}),this.initialLayerInputs=p.hiddenLayers.map(z=>new Wn(z,1)),this.bindEquation(),this}toFunction(d){const{model:p,inputLookup:y,inputLookupLength:N,outputLookup:L,outputLookupLength:F}=this,{inputSize:z}=this.options,{equations:P}=p,k=P[1],{states:R}=k,S=JSON.stringify(this.toJSON());function T(Q){const U=p.equationConnections[0],{states:Oe}=P[0];for(let Fe=0,bt=Oe.length;Fe<bt;Fe++)if(Oe[Fe].product===Q)return Fe;return U.indexOf(Q)}function H(Q,U){for(let Oe=0,Fe=R.length;Oe<Fe;Oe++){const bt=R[Oe];if(Oe===U){const v=T(Q);switch(Q){case bt.left:if(v>-1)return`typeof prevStates[${v}] === 'object' ? prevStates[${v}].product : new Matrix(${Q.rows}, ${Q.columns})`;case bt.right:if(v>-1)return`typeof prevStates[${v}] === 'object' ? prevStates[${v}].product : new Matrix(${Q.rows}, ${Q.columns})`;case bt.product:return`new Matrix(${Q.rows}, ${Q.columns})`;default:throw Error("unknown state")}}if(Q===bt.product)return`states[${Oe}].product`;if(Q===bt.right)return`states[${Oe}].right`;if(Q===bt.left)return`states[${Oe}].left`}return""}function te(Q,U){if(!Q||!Q.rows||!Q.columns)return"null";if(Q===p.outputConnector)return"json.outputConnector";if(Q===p.output)return"json.output";for(let Oe=0,Fe=p.hiddenLayers.length;Oe<Fe;Oe++){const bt=p.hiddenLayers[Oe];for(const v in bt)if(bt.hasOwnProperty(v)&&bt[v]===Q)return`json.hiddenLayers[${Oe}].${v}`}return H(Q,U)}function Se(){return y?z===1?y===L?`function lookupInput(input) {
            var table = ${JSON.stringify(y)};
            var result = [];
            for (var p in table) {
              if (!input.hasOwnProperty(p)) break;
              result.push(Float32Array.from([input[p]]));
            }
            return result;
          }`:`function lookupInput(input) {
          var table = ${JSON.stringify(y)};
          var result = [];
          for (var p in table) {
            result.push(Float32Array.from([input[p]]));
          }
          return result;
        }`:`function lookupInput(rawInputs) {
        var table = ${JSON.stringify(y)};
        var result = [];
        for (var i = 0; i < rawInputs.length; i++) {
          var rawInput = rawInputs[i];
          var input = new Float32Array(${N});
          for (var p in table) {
            input[table[p]] = rawInput.hasOwnProperty(p) ? rawInput[p] : 0;
          }
          result.push(input);
        }
        return result;
      }`:""}function ie(){return L?z===1?y===L?`function lookupOutputPartial(output, input) {
            var table = ${JSON.stringify(L)};
            var offset = input.length;
            var result = {};
            var i = 0;
            for (var p in table) {
              if (i++ < offset) continue;
              result[p] = output[table[p] - offset][0];
            }
            return result;
          }`:`function lookupOutput(output) {
          var table = ${JSON.stringify(L)};
          var result = {};
          for (var p in table) {
            result[p] = output[table[p]][0];
          }
          return result;
        }`:`function lookupOutput(output) {
        var table = ${JSON.stringify(L)};
        var result = {};
        for (var p in table) {
          result[p] = output[table[p]];
        }
        return result;
      }`:""}function _e(Q){const U=Q.toString().split("{");U.shift();const Fe=U.join("{").split("}");return Fe.pop(),Fe.join("}").split(`
`).join(`
        `).replace("product.deltas[i] = 0;","").replace("product.deltas[column] = 0;","").replace("left.deltas[leftIndex] = 0;","").replace("right.deltas[rightIndex] = 0;","").replace("product.deltas = left.deltas.slice(0);","")}function Y(Q){return`src/recurrent/matrix/${Q.replace(/[A-Z]/g,function(U){return`-${U.toLowerCase()}`})}.js`}const re=[],be={},ke=[];for(let Q=0,U=R.length;Q<U;Q++){const Oe=R[Q];re.push(`states[${Q}] = {
      name: '${Oe.forwardFn.name}',
      left: ${Oe.left?te(Oe.left,Q):"undefined"},
      right: ${Oe.right?te(Oe.right,Q):"undefined"},
      product: ${te(Oe.product,Q)}
    }`);const Fe=Oe.forwardFn.name;be[Fe]||(be[Fe]=!0,Oe.name==="input"?(ke.push(`case '${Fe}':`),ke.push(y&&z===1?"product.weights = _i < input.length ? input[_i]: prevStates[prevStates.length - 1].product.weights;":z===1?"product.weights = [input[_i]];":"product.weights = input[_i];"),ke.push("break;")):ke.push(`        case '${Fe}':${Fe!=="forwardFn"?` //compiled from ${Y(Fe)}`:""}
          ${_e(Oe.forwardFn.toString())}
          break;`))}const it=z===1&&this.outputLookup,vt=`
  var input = ${this.inputLookup?"lookupInput(rawInput)":"rawInput"};
  var json = ${S};
  var output = [];
  var states = [];
  var prevStates;
  var state;
  var max = ${it?y===L?N:`input.length + ${F-1}`:"input.length"};
  for (var _i = 0; _i < max; _i++) {
    prevStates = states;
    states = [];
    ${re.join(`;
    `)};
    for (var stateIndex = 0, stateMax = ${re.length}; stateIndex < stateMax; stateIndex++) {
      state = states[stateIndex];
      var product = state.product;
      var left = state.left;
      var right = state.right;

      switch (state.name) {
${ke.join(`
`)}
      }
    }
    ${z===1&&y?"if (_i >= input.length - 1) { output.push(state.product.weights); }":"output = state.product.weights;"}
  }
  ${L?L===y?"return lookupOutputPartial(output, input)":"return lookupOutput(output)":z===1?"return output[0]":"return output"};
  ${Se()}
  ${ie()}

  function Matrix(rows, columns) {
    this.rows = rows;
    this.columns = columns;
    this.weights = new Float32Array(rows * columns);
  }
  ${Hl.toString().replace("_2.default","Matrix")}
  ${ot.toString()}
  ${vu.toString()}
  ${yu.toString()}`;return new Function("rawInput",d?d(vt):vt)}}const Vu={...Tl};class El extends Kl{getHiddenLayer(d,p){return gc(d,p)}getEquation(d,p,y,N){return aa(d,p,y,N)}}class zu extends Al{getHiddenLayer(d,p){return yc(d,p)}getEquation(d,p,y,N){return _u(d,p,y,N)}}function yc(O,d){return{inputMatrix:new Ti(O,d,.08),inputHidden:new Ti(O,O,.08),inputBias:new Wn(O,1),forgetMatrix:new Ti(O,d,.08),forgetHidden:new Ti(O,O,.08),forgetBias:new Wn(O,1),outputMatrix:new Ti(O,d,.08),outputHidden:new Ti(O,O,.08),outputBias:new Wn(O,1),cellActivationMatrix:new Ti(O,d,.08),cellActivationHidden:new Ti(O,O,.08),cellActivationBias:new Wn(O,1)}}function _u(O,d,p,y){if(!y.inputMatrix||!y.inputHidden||!y.inputBias||!y.forgetMatrix||!y.forgetHidden||!y.forgetBias||!y.outputMatrix||!y.outputHidden||!y.outputBias||!y.cellActivationMatrix||!y.cellActivationHidden||!y.cellActivationBias)throw new Error("hiddenLayer does not have expected properties");const N=O.sigmoid.bind(O),L=O.add.bind(O),F=O.multiply.bind(O),z=O.multiplyElement.bind(O),P=O.tanh.bind(O),k=N(L(L(F(y.inputMatrix,d),F(y.inputHidden,p)),y.inputBias)),R=N(L(L(F(y.forgetMatrix,d),F(y.forgetHidden,p)),y.forgetBias)),S=N(L(L(F(y.outputMatrix,d),F(y.outputHidden,p)),y.outputBias)),T=P(L(L(F(y.cellActivationMatrix,d),F(y.cellActivationHidden,p)),y.cellActivationBias)),H=z(R,p),te=z(k,T),Se=L(H,te);return z(S,P(Se))}class vc extends Kl{getHiddenLayer(d,p){return yc(d,p)}getEquation(d,p,y,N){return _u(d,p,y,N)}}function To(O,d){const p=[];for(;O<d;O++)p.push(O);return p}function Uu(O){return Array.isArray(O)?Float32Array.from(O):Float32Array.from(Object.values(O))}function bu({pixelX:O,pixelY:d,radius:p,inputs:y,row:N,line:L,fontSize:F,fontClassName:z}){let P=`<rect
              x="${O/2-p}"
              y="${d/2+N*d-p}"
              width="${2*p}"
              height="${2*p}"
              stroke="black"
              stroke-width="1"
              fill="${y.color}"
              class="${y.className}" />
            <line
              x1="${O/4}"
              y1="${d/2+N*d}"
              x2="${O/2-p}"
              y2="${d/2+N*d}"
              style="stroke:${L.color};stroke-width:${L.width}"
              class="${L.className}" />`;return y.labels&&(P+=`<text
              x="${O/8}"
              y="${d/2+N*d-5}"
              fill="black"
              font-size="${F}"
              class="${z}">${y.labels[N]}</text>`),P}function sh({pixelX:O,pixelY:d,row:p,column:y,radius:N,hidden:L}){return`<circle
            cx="${O/2+y*O}"
            cy="${d/2+p*d}"
            r="${N}"
            stroke="black"
            stroke-width="1"
            fill="${L.color}"
            class="${L.className}" />`}function _c({pixelX:O,pixelY:d,row:p,column:y,line:N,outputs:L,radius:F}){return`<circle
            cx="${O/2+y*O}"
            cy="${d/2+p*d}"
            r="${F}"
            stroke="black"
            stroke-width="1"
            fill="${L.color}"
            class="${L.className}" />
          <line
            x1="${O/2+y*O+F}"
            y1="${d/2+p*d}"
            x2="${O/2+y*O+O/4}"
            y2="${d/2+p*d}"
            style="stroke:${N.color};stroke-width:${N.width}"
            class="${N.className}" />`}function Ao({pixelX:O,pixelY:d,row:p,column:y,radius:N,lineY:L,line:F,previousConnectionIndex:z}){return`<line
            x1="${O/2+(y-1)*O+N}"
            y1="${L/2+z*L}"
            x2="${O/2+y*O-N}"
            y2="${d/2+p*d}"
            style="stroke:${F.color};stroke-width:${F.width}"
            class="${F.className}" />`}function Wa(O){const{sizes:d,height:p,width:y}=O;let N="";const L=y/d.length;for(let F=0;F<d.length;F++){const z=d[F],P=p/z;for(let k=0;k<z;k++)if(F===0)N+=bu({pixelX:L,pixelY:P,row:k,...O});else{F===d.length-1?N+=_c({pixelX:L,pixelY:P,row:k,column:F,...O}):N+=sh({pixelX:L,pixelY:P,row:k,column:F,...O});const R=d[F-1],S=p/R;for(let T=0;T<R;T++)N+=Ao({pixelX:L,pixelY:P,row:k,column:F,lineY:S,previousConnectionIndex:T,...O})}}return N}function Wl({pixelX:O,pixelY:d,row:p,column:y,radius:N,recurrentLine:L}){const F=O/2+y*O+N+1,z=d/2+p*d,P=F-N*2-2,k=z,R=P+100,S=k+50,T=F-100,H=z+50;return`<path
              d="M ${F} ${z} C ${R} ${S}, ${T} ${H}, ${P} ${k}"
              stroke="${L.color}"
              stroke-width="${L.width}"
              fill="transparent"
              stroke-linecap="round"
              marker-end="url(#arrow)"
              class="${L.className}" />`}function ho(O){const{width:d,height:p,recurrentLine:y,sizes:N,radius:L}=O,F=d/N.length;let z=`<defs>
              <marker id="arrow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="${y.color}" />
              </marker>
            </defs>`;z+=Wa(O);for(let P=1;P<N.length;P++){const k=N[P],R=p/k;for(let S=0;S<k;S++)z+=Wl({pixelX:F,pixelY:R,row:S,column:P,radius:L,recurrentLine:y})}return z}function Eo(O){const{options:d}=O;if(!d)throw new Error("options not defined");if(!d.inputLayer)throw new Error("options.inputLater not defined");if(!d.hiddenLayers)throw new Error("options.hiddenLayers not defined");if(d.hiddenLayers.length<1)throw new Error("options.hiddenLayers is empty");if(!d.outputLayer)throw new Error("options.outputLayer not defined");const p=d.inputLayer(),y=[];y.push(d.hiddenLayers[0](p,0));for(let L=1;L<d.hiddenLayers.length;L++)y.push(d.hiddenLayers[L](y[L-1],L));const N=d.outputLayer(y[y.length-1],y.length);return{inputSize:p.height,hiddenLayers:y.map(L=>L.height),outputSize:N.height}}function fo(O){const d=[],{options:p}=O;if(!p.inputLayer)throw new Error("inputLayer not defined");if(!p.outputLayer)throw new Error("outputLayer not defined");const y=p.inputLayer();d.push(p.hiddenLayers[0](y,nr(),0));for(let L=1;L<p.hiddenLayers.length;L++)d.push(p.hiddenLayers[L](d[L-1],nr(),L));const N=p.outputLayer(d[d.length-1],-1);return{inputSize:y.height,hiddenLayers:d.map(L=>L.height),outputSize:N.height}}function bc(O,d,p){return`<svg
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            version="1.1"
            width="${d}"
            height="${p}">${O}</svg>`}function md(O){return O.sizes}function ah(O){const{options:d,sizes:p}=O,{inputSize:y,outputSize:N,hiddenLayers:L}=d;if(!p){if(typeof y=="number"&&y<1)throw new Error("inputSize not set");if(typeof N=="number"&&N<1)throw new Error("outputSize not set");if(L?.some(F=>F<1))throw new Error("hiddenLayers not set")}return typeof y=="number"&&Array.isArray(L)&&typeof N=="number"?[y].concat(L).concat([N]):p}function yd(O){const{options:d}=O,{inputSize:p,outputSize:y,hiddenLayers:N}=d;return[p].concat(N).concat([y])}function oa(){return{line:{width:.5,color:"black",className:"connection"},recurrentLine:{width:1,color:"red",className:"recurrence"},inputs:{color:"rgba(0, 128, 0, 0.5)",labels:null,className:"input"},outputs:{color:"rgba(100, 149, 237, 0.5)",className:"output"},hidden:{color:"rgba(255, 127, 80, 0.5)",className:"hidden-neuron"},fontSize:"14px",fontClassName:"label",radius:8,width:400,height:250,sizes:[]}}function Dr(O,d){const p={...oa(),...d},{width:y,height:N,inputs:L}=p;let F=[];if(O instanceof Ft||O instanceof mn)F=ah(O);else if(O instanceof Ka){const{inputSize:z,hiddenLayers:P,outputSize:k}=fo(O);F=[z].concat(P).concat([k])}else if(O instanceof oo){const{inputSize:z,hiddenLayers:P,outputSize:k}=Eo(O);F=[z].concat(P).concat([k])}else{if(O instanceof Al||O instanceof zu||O instanceof Hs||O instanceof Kl||O instanceof vc||O instanceof El)return bc(ho({...p,sizes:yi(yd(O),L.labels)}),y,N);if(O.hasOwnProperty("type"))switch(O.type){case"NeuralNetwork":case"NeuralNetworkGPU":return bc(Wa({...p,sizes:yi(md(O),L.labels)}),y,N);case"RNN":case"GRU":case"LSTM":case"RNNTimeStep":case"GRUTimeStep":case"LSTMTimeStep":return bc(ho({...p,sizes:yi(yd(O),L.labels)}),y,N);default:throw new Error("unrecognized network")}else if(O.hasOwnProperty("inputSize")&&O.hasOwnProperty("hiddenLayers")&&O.hasOwnProperty("outputSize")){const{inputSize:z,hiddenLayers:P,outputSize:k}=O;F=[z,...P,k]}else if(O.hasOwnProperty("sizes"))F=O.sizes;else throw new Error("unrecognized network")}return bc(Wa({...p,sizes:yi(F,L.labels)}),y,N)}function yi(O,d){if(!O)throw new Error("sizes not set");if(O.some(p=>p<1))throw new Error("sizes not set correctly");if(d&&d.length!==O[0])throw new Error("not enough labels for inputs");return O}const La={RNNTimeStep:Kl,LSTMTimeStep:vc,GRUTimeStep:El,RNN:Al,LSTM:zu,GRU:Hs},ns={max:je,mse:Je,ones:Cn,ones2D:Ri,random:Ee,randomWeight:qe,randos:De,range:To,toArray:Uu,DataFormatter:ts,zeros:Ye,toSVG:Dr};t.AE=qn,t.CrossValidate=on,t.FeedForward=oo,t.NeuralNetwork=Ft,t.NeuralNetworkGPU=mn,t.Recurrent=Ka,t.activation=$,t.layer=ks,t.layerTypes=Is,t.likely=al,t.lookup=me,t.praxis=fa,t.recurrent=La,t.utilities=ns,Object.defineProperty(t,"__esModule",{value:!0})}))})(Mg,Mg.exports)),Mg.exports}var xG=bG();const Ku=$k(xG);class wG{constructor(){this.networks={workoutTiming:new Ku.recurrent.LSTM,mealTiming:new Ku.recurrent.LSTM,sleepSchedule:new Ku.recurrent.LSTM,energyLevels:new Ku.NeuralNetwork,moodPatterns:new Ku.NeuralNetwork,productivityScore:new Ku.NeuralNetwork,stressLevels:new Ku.NeuralNetwork,hydration:new Ku.NeuralNetwork,motivation:new Ku.NeuralNetwork,habitSuccess:new Ku.NeuralNetwork},this.trainingData={workouts:[],meals:[],sleep:[],energy:[],mood:[],productivity:[],stress:[],hydration:[],steps:[],heartRate:[],location:[],screenTime:[],socialInteraction:[]},this.insights={bestWorkoutTime:null,bestMealTimes:[],optimalSleepSchedule:null,energyPeakTimes:[],stressTriggers:[],motivationNeededTimes:[],productivePeriods:[],hydrationReminders:[]},this.modelsTrainedCount=0,this.lastTrainingDate=null,this.accuracyScores={},this.userBaseline={energyBaseline:null,sleepSensitivity:1.5,workoutBoost:2,avgDailySteps:null,avgSleep:7,energyByHour:{},energyByDayOfWeek:{}},this.autoEnergyInterval=null,this.init()}async init(){await this.loadTrainingData(),await this.loadModels(),await this.loadUserBaseline(),this.startContinuousLearning(),this.startAutoEnergyTracking()}async trackWorkout(e){const t={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),duration:e.duration||0,type:e.type||"general",intensity:e.intensity||"moderate",completed:e.completed!==!1,energyBefore:e.energyBefore||5,energyAfter:e.energyAfter||7,mood:e.mood||"neutral",location:e.location||"gym"};this.trainingData.workouts.push(t),await this.saveTrainingData(),this.trainingData.workouts.length%5===0&&await this.trainWorkoutTimingModel()}async trackMeal(e){const t={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),mealType:e.type||"meal",calories:e.calories||0,protein:e.protein||0,carbs:e.carbs||0,fats:e.fats||0,healthy:e.healthy!==!1,energyAfter:e.energyAfter||5,satisfaction:e.satisfaction||5,digestiveComfort:e.digestiveComfort||5};this.trainingData.meals.push(t),await this.saveTrainingData(),this.trainingData.meals.length%5===0&&await this.trainMealTimingModel()}async trackSleep(e){const t={timestamp:Date.now(),bedtime:e.bedtime||new Date().getHours(),wakeTime:e.wakeTime||new Date().getHours(),duration:e.duration||8,quality:e.quality||5,energyNextDay:e.energyNextDay||5,mood:e.mood||"neutral",dreams:e.dreams||!1,interruptions:e.interruptions||0};this.trainingData.sleep.push(t),await this.saveTrainingData(),this.trainingData.sleep.length%3===0&&await this.trainSleepModel()}async trackEnergy(e,t={}){const n={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),energyLevel:e,recentWorkout:t.recentWorkout||!1,recentMeal:t.recentMeal||!1,hoursSlept:t.hoursSlept||7,hydrationLevel:t.hydrationLevel||5,stressLevel:t.stressLevel||3,caffeineConsumed:t.caffeineConsumed||!1};this.trainingData.energy.push(n),await this.saveTrainingData(),this.trainingData.energy.length%10===0&&await this.trainEnergyPredictionModel()}async trackMood(e,t=[]){const n={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),mood:e,moodScore:this.moodToScore(e),triggers:t,recentExercise:t.includes("workout"),social:t.includes("social"),workStress:t.includes("work")};this.trainingData.mood.push(n),await this.saveTrainingData(),this.trainingData.mood.length%10===0&&await this.trainMoodPredictionModel()}async trackStress(e,t=null){const n={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),stressLevel:e,cause:t,hoursSlept:7,exerciseToday:!1,meditationDone:!1};this.trainingData.stress.push(n),await this.saveTrainingData(),this.trainingData.stress.length%5===0&&await this.trainStressModel()}async trackHydration(e,t={}){const n={timestamp:Date.now(),hour:new Date().getHours(),waterAmount:e,exercised:t.exercised||!1,temperature:t.temperature||20,thirstLevel:t.thirstLevel||3};this.trainingData.hydration.push(n),await this.saveTrainingData()}async trackSteps(e,t={}){const n={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),steps:e,activeMinutes:t.activeMinutes||0,energyLevel:t.energyLevel||5};this.trainingData.steps.push(n),await this.saveTrainingData()}async trackLocation(e){const t={timestamp:Date.now(),hour:new Date().getHours(),dayOfWeek:new Date().getDay(),latitude:e.latitude,longitude:e.longitude,locationType:e.type||"unknown",duration:e.duration||0};this.trainingData.location.push(t),await this.saveTrainingData()}startAutoEnergyTracking(){this.trackEnergyAutomatically().catch(e=>{}),this.autoEnergyInterval=setInterval(async()=>{try{await this.trackEnergyAutomatically()}catch{}},3600*1e3)}async trackEnergyAutomatically(){try{const e=await this.calculateAutoEnergy();await this.trackEnergy(e.level,{recentWorkout:e.context.recentWorkout,recentMeal:e.context.recentMeal,hoursSlept:e.context.hoursSlept,hydrationLevel:e.context.hydrationLevel,stressLevel:3,caffeineConsumed:!1})}catch{}}async calculateAutoEnergy(){const e=this.userBaseline.energyBaseline||6,t=await this.getCurrentContext(),n=this.calculateSleepImpact(t),r=this.calculateActivityImpact(t),s=this.calculateWorkoutImpact(t),l=this.calculateMealImpact(t),u=this.calculateHydrationImpact(t),h=this.calculateTimeOfDayImpact(),f=this.calculateDayOfWeekImpact();let x=e+n+r+s+l+u+h+f;return x=Math.max(1,Math.min(10,x)),this.trainingData.energy.length>50&&!this.userBaseline.energyBaseline&&(this.userBaseline.energyBaseline=this.calculateAverageEnergy(),await this.saveUserBaseline()),{level:Math.round(x),confidence:this.calculateEnergyConfidence(),context:t}}async getCurrentContext(){const e=this.trainingData.sleep[this.trainingData.sleep.length-1],t=e?e.duration:7,n=Date.now()-14400*1e3,r=this.trainingData.workouts.some(x=>x.timestamp>n),s=Date.now()-10800*1e3,l=this.trainingData.meals.some(x=>x.timestamp>s),u=this.trainingData.hydration.filter(x=>x.timestamp>s),h=Math.min(10,u.length*2),f=this.trainingData.steps.filter(x=>{const g=new Date().toISOString().split("T")[0];return new Date(x.timestamp).toISOString().split("T")[0]===g}).reduce((x,g)=>x+g.steps,0);return{hoursSlept:t,recentWorkout:r,recentMeal:l,hydrationLevel:h,todaySteps:f}}calculateSleepImpact(e){return e.hoursSlept?(e.hoursSlept-this.userBaseline.avgSleep)*this.userBaseline.sleepSensitivity:0}calculateActivityImpact(e){if(!this.userBaseline.avgDailySteps||!e.todaySteps)return 0;const t=(e.todaySteps-this.userBaseline.avgDailySteps)/this.userBaseline.avgDailySteps;return Math.min(2,Math.max(-2,t*2))}calculateWorkoutImpact(e){if(!e.recentWorkout){const r=Date.now()-2592e5;return this.trainingData.workouts.some(l=>l.timestamp>r)?0:-1}const t=[...this.trainingData.workouts].sort((r,s)=>s.timestamp-r.timestamp)[0];if(!t)return 0;const n=(Date.now()-t.timestamp)/(3600*1e3);return n<2?this.userBaseline.workoutBoost:n<4?this.userBaseline.workoutBoost/2:0}calculateMealImpact(e){if(!e.recentMeal){const r=Date.now()-144e5;return this.trainingData.meals.some(l=>l.timestamp>r)?0:-1}const t=[...this.trainingData.meals].sort((r,s)=>s.timestamp-r.timestamp)[0];if(!t)return 0;const n=(Date.now()-t.timestamp)/(3600*1e3);return n<.5?.5:n<2?1:0}calculateHydrationImpact(e){const t=e.hydrationLevel||5;return t<3?-.5:t>7?.5:0}calculateTimeOfDayImpact(){const e=new Date().getHours();return this.userBaseline.energyByHour[e]?this.userBaseline.energyByHour[e]:e>=7&&e<=9?1:e>=14&&e<=15?-1:e>=22?-2:0}calculateDayOfWeekImpact(){const e=new Date().getDay();return this.userBaseline.energyByDayOfWeek[e]?this.userBaseline.energyByDayOfWeek[e]:e===0||e===6?.5:e===1?-.5:0}calculateEnergyConfidence(){const e=this.trainingData.energy.length;return e<10?30:e<50?60:e<100?80:95}async trainWorkoutTimingModel(){if(!(this.trainingData.workouts.length<10))try{const e=this.trainingData.workouts.map(r=>({input:[r.hour/24,r.dayOfWeek/7,r.energyBefore/10,r.completed?1:0],output:[r.completed?1:0,r.energyAfter/10]}));this.networks.workoutTiming.train(e,{iterations:2e3,errorThresh:.005,log:!1});const t=[];for(let r=6;r<=22;r++){const s=this.networks.workoutTiming.run([r/24,new Date().getDay()/7,.7,1]);t.push({hour:r,success:s[0],energyAfter:s[1]})}const n=t.sort((r,s)=>s.success+s.energyAfter-(r.success+r.energyAfter))[0];this.insights.bestWorkoutTime=n.hour,this.modelsTrainedCount++,console.log(` Workout timing model trained! Best time: ${n.hour}:00`)}catch(e){console.error("Workout timing training error:",e)}}async trainMealTimingModel(){if(!(this.trainingData.meals.length<15))try{const e=this.trainingData.meals.map(n=>({input:[n.hour/24,n.dayOfWeek/7,n.calories/1e3,n.protein/50,n.healthy?1:0],output:[n.energyAfter/10,n.satisfaction/10,n.digestiveComfort/10]}));this.networks.mealTiming.train(e,{iterations:2e3,errorThresh:.005,log:!1});const t=[7,12,18];this.insights.bestMealTimes=t.map(n=>({hour:n,type:n===7?"breakfast":n===12?"lunch":"dinner"})),this.modelsTrainedCount++,console.log(" Meal timing model trained!")}catch(e){console.error("Meal timing training error:",e)}}async trainSleepModel(){if(!(this.trainingData.sleep.length<7))try{const e=this.trainingData.sleep.map(r=>({input:[r.bedtime/24,r.duration/12,r.interruptions/5],output:[r.quality/10,r.energyNextDay/10]}));this.networks.sleepSchedule.train(e,{iterations:2e3,errorThresh:.005,log:!1});const t=[];for(let r=21;r<=24;r++){const s=this.networks.sleepSchedule.run([r/24,.6666666666666666,0]);t.push({bedtime:r,quality:s[0],energy:s[1]})}const n=t.sort((r,s)=>s.quality+s.energy-(r.quality+r.energy))[0];this.insights.optimalSleepSchedule={bedtime:n.bedtime,wakeTime:(n.bedtime+8)%24,duration:8},this.modelsTrainedCount++,console.log(` Sleep model trained! Optimal bedtime: ${n.bedtime}:00`)}catch(e){console.error("Sleep training error:",e)}}async trainEnergyPredictionModel(){if(!(this.trainingData.energy.length<20))try{const e=this.trainingData.energy.map(n=>({input:[n.hour/24,n.dayOfWeek/7,n.hoursSlept/12,n.recentWorkout?1:0,n.recentMeal?1:0,n.hydrationLevel/10,n.stressLevel/10,n.caffeineConsumed?1:0],output:[n.energyLevel/10]}));this.networks.energyLevels.train(e,{iterations:2e3,errorThresh:.005,log:!1});const t=[];for(let n=6;n<=22;n++){const r=this.networks.energyLevels.run([n/24,new Date().getDay()/7,.6666666666666666,!1,n===12||n===18,.7,.3,n<12]);t.push({hour:n,energy:r[0]*10})}this.insights.energyPeakTimes=t.sort((n,r)=>r.energy-n.energy).slice(0,3).map(n=>n.hour),this.modelsTrainedCount++,console.log(" Energy prediction model trained!")}catch(e){console.error("Energy training error:",e)}}async trainMoodPredictionModel(){if(!(this.trainingData.mood.length<20))try{const e=this.trainingData.mood.map(t=>({input:[t.hour/24,t.dayOfWeek/7,t.recentExercise?1:0,t.social?1:0,t.workStress?1:0],output:[t.moodScore/10]}));this.networks.moodPatterns.train(e,{iterations:2e3,errorThresh:.005,log:!1}),this.modelsTrainedCount++,console.log(" Mood prediction model trained!")}catch(e){console.error("Mood training error:",e)}}async trainStressModel(){if(!(this.trainingData.stress.length<10))try{const e=this.trainingData.stress.map(t=>({input:[t.hour/24,t.dayOfWeek/7,t.hoursSlept/12,t.exerciseToday?1:0,t.meditationDone?1:0],output:[t.stressLevel/10]}));this.networks.stressLevels.train(e,{iterations:2e3,errorThresh:.005,log:!1}),this.modelsTrainedCount++,console.log(" Stress prediction model trained!")}catch(e){console.error("Stress training error:",e)}}predictBestWorkoutTime(){return this.insights.bestWorkoutTime?{hour:this.insights.bestWorkoutTime,confidence:this.calculateConfidence("workoutTiming"),reasoning:`Based on ${this.trainingData.workouts.length} workout sessions, you perform best around ${this.insights.bestWorkoutTime}:00`}:{hour:18,confidence:.5,reasoning:"Need more data to personalize"}}predictOptimalMealTime(e){const t={breakfast:7,lunch:12,dinner:18},n=this.insights.bestMealTimes.find(r=>r.type===e)?.hour||t[e];return{hour:n,confidence:this.calculateConfidence("mealTiming"),reasoning:`Your body responds best to ${e} around ${n}:00`}}predictEnergyLevel(e=new Date().getHours()){if(this.trainingData.energy.length<20)return{level:5,confidence:.3};try{const t=this.networks.energyLevels.run([e/24,new Date().getDay()/7,.5833333333333334,!1,e===12||e===18,.7,.3,e<12]);return{level:Math.round(t[0]*10),confidence:this.calculateConfidence("energyLevels"),peakTimes:this.insights.energyPeakTimes}}catch{return{level:5,confidence:.3}}}predictMood(e={}){if(this.trainingData.mood.length<20)return{mood:"neutral",score:5,confidence:.3};try{const t=this.networks.moodPatterns.run([new Date().getHours()/24,new Date().getDay()/7,e.recentExercise?1:0,e.social?1:0,e.workStress?1:0]),n=Math.round(t[0]*10);return{mood:this.scoreToMood(n),score:n,confidence:this.calculateConfidence("moodPatterns")}}catch{return{mood:"neutral",score:5,confidence:.3}}}predictStressLevel(e={}){if(this.trainingData.stress.length<10)return{level:3,confidence:.3};try{const t=this.networks.stressLevels.run([new Date().getHours()/24,new Date().getDay()/7,e.hoursSlept/12||.5833333333333334,e.exerciseToday?1:0,e.meditationDone?1:0]);return{level:Math.round(t[0]*10),confidence:this.calculateConfidence("stressLevels")}}catch{return{level:3,confidence:.3}}}predictHabitSuccess(e,t){const n=this.trainingData.workouts.filter(s=>{const l=new Date(s.timestamp).getHours();return Math.abs(l-t)<=1});return n.length===0?{success:.5,confidence:.2}:{success:n.filter(s=>s.completed).length/n.length,confidence:Math.min(n.length/20,1)}}getPersonalizedRecommendations(){const e=[],t=new Date().getHours(),n=this.predictBestWorkoutTime();Math.abs(t-n.hour)<=1&&e.push({type:"workout",priority:"high",title:" Perfect Time for Workout!",message:`This is your optimal workout time. ${n.reasoning}`,confidence:n.confidence});const r=this.predictEnergyLevel();r.level<4&&e.push({type:"energy",priority:"high",title:" Energy Boost Needed",message:"Consider a quick walk, healthy snack, or power nap",confidence:r.confidence});const s=this.trainingData.hydration[this.trainingData.hydration.length-1];(!s||Date.now()-s.timestamp>7200*1e3)&&e.push({type:"hydration",priority:"medium",title:" Time to Hydrate",message:"You haven't logged water in 2+ hours",confidence:.9});const l=["breakfast","lunch","dinner"],u=[7,12,18];l.forEach((f,x)=>{if(Math.abs(t-u[x])<=1){const g=this.trainingData.meals[this.trainingData.meals.length-1];(!g||Date.now()-g.timestamp>14400*1e3)&&e.push({type:"meal",priority:"medium",title:` ${f.charAt(0).toUpperCase()+f.slice(1)} Time`,message:`Time for ${f} based on your routine`,confidence:.8})}}),this.insights.optimalSleepSchedule&&t>=this.insights.optimalSleepSchedule.bedtime-1&&e.push({type:"sleep",priority:"high",title:" Optimal Bedtime Approaching",message:`Best sleep starts at ${this.insights.optimalSleepSchedule.bedtime}:00`,confidence:.9});const h=this.predictStressLevel();return h.level>6&&e.push({type:"stress",priority:"high",title:" Stress Management Recommended",message:"Try meditation, deep breathing, or light exercise",confidence:h.confidence}),e.sort((f,x)=>{const g={high:3,medium:2,low:1};return g[x.priority]-g[f.priority]})}getLifeOptimizationReport(){return{workoutOptimization:{bestTime:this.insights.bestWorkoutTime||18,consistency:this.calculateWorkoutConsistency(),improvement:this.calculateImprovementRate("workouts")},nutritionOptimization:{bestMealTimes:this.insights.bestMealTimes,healthyChoiceRate:this.calculateHealthyMealRate(),improvement:this.calculateImprovementRate("meals")},sleepOptimization:{optimalSchedule:this.insights.optimalSleepSchedule,averageQuality:this.calculateAverageSleepQuality(),consistency:this.calculateSleepConsistency()},energyOptimization:{peakTimes:this.insights.energyPeakTimes,averageLevel:this.calculateAverageEnergy(),trend:this.calculateEnergyTrend()},overallScore:this.calculateOverallLifeScore(),modelsTrainedCount:this.modelsTrainedCount,dataPoints:this.getTotalDataPoints(),accuracy:this.calculateOverallAccuracy()}}moodToScore(e){return{happy:9,excited:10,content:8,calm:7,neutral:5,tired:4,anxious:3,sad:2,stressed:1}[e]||5}scoreToMood(e){return e>=9?"happy":e>=7?"content":e>=5?"neutral":e>=3?"tired":"stressed"}calculateConfidence(e){const n={workoutTiming:this.trainingData.workouts.length,mealTiming:this.trainingData.meals.length,sleepSchedule:this.trainingData.sleep.length,energyLevels:this.trainingData.energy.length,moodPatterns:this.trainingData.mood.length,stressLevels:this.trainingData.stress.length}[e]||0;return n<10?.3:n<30?.6:n<100?.8:.95}calculateWorkoutConsistency(){return this.trainingData.workouts.length<7?0:this.trainingData.workouts.filter(t=>Date.now()-t.timestamp<10080*60*1e3).length/7*100}calculateHealthyMealRate(){return this.trainingData.meals.length===0?0:this.trainingData.meals.filter(t=>t.healthy).length/this.trainingData.meals.length*100}calculateAverageSleepQuality(){return this.trainingData.sleep.length===0?0:this.trainingData.sleep.reduce((t,n)=>t+n.quality,0)/this.trainingData.sleep.length}calculateSleepConsistency(){if(this.trainingData.sleep.length<7)return 0;const e=this.trainingData.sleep.map(n=>n.bedtime),t=this.calculateVariance(e);return Math.max(0,100-t*10)}calculateAverageEnergy(){return this.trainingData.energy.length===0?5:this.trainingData.energy.reduce((t,n)=>t+n.energyLevel,0)/this.trainingData.energy.length}calculateEnergyTrend(){if(this.trainingData.energy.length<14)return"stable";const e=this.trainingData.energy.slice(0,7),t=this.trainingData.energy.slice(-7),n=e.reduce((s,l)=>s+l.energyLevel,0)/7,r=t.reduce((s,l)=>s+l.energyLevel,0)/7;return r>n+1?"improving":r<n-1?"declining":"stable"}calculateOverallLifeScore(){const e=Math.min(this.calculateWorkoutConsistency(),100),t=this.calculateHealthyMealRate(),n=this.calculateAverageSleepQuality()*10,r=this.calculateAverageEnergy()*10;return Math.round((e+t+n+r)/4)}getTotalDataPoints(){return Object.values(this.trainingData).reduce((e,t)=>e+t.length,0)}calculateOverallAccuracy(){return Math.min(this.modelsTrainedCount/10,1)*100}calculateImprovementRate(e){const t=this.trainingData[e];if(t.length<14)return 0;const n=t.slice(0,7);return(t.slice(-7).length-n.length)/n.length*100}calculateVariance(e){const t=e.reduce((r,s)=>r+s,0)/e.length,n=e.map(r=>Math.pow(r-t,2));return Math.sqrt(n.reduce((r,s)=>r+s,0)/e.length)}async saveTrainingData(){try{await gn.set({key:"brainjs_training_data",value:JSON.stringify(this.trainingData)}),await gn.set({key:"brainjs_insights",value:JSON.stringify(this.insights)})}catch(e){console.error("Error saving training data:",e)}}async saveUserBaseline(){try{await gn.set({key:"brainjs_user_baseline",value:JSON.stringify(this.userBaseline)}),console.log(" User baseline saved:",this.userBaseline)}catch(e){console.error("Error saving user baseline:",e)}}async loadUserBaseline(){try{const{value:e}=await gn.get({key:"brainjs_user_baseline"});e&&(this.userBaseline={...this.userBaseline,...JSON.parse(e)},console.log(" User baseline loaded:",this.userBaseline))}catch(e){console.error("Error loading user baseline:",e)}}async loadTrainingData(){try{const{value:e}=await gn.get({key:"brainjs_training_data"});e&&(this.trainingData=JSON.parse(e));const{value:t}=await gn.get({key:"brainjs_insights"});t&&(this.insights=JSON.parse(t)),console.log(` Loaded ${this.getTotalDataPoints()} data points`)}catch(e){console.error("Error loading training data:",e)}}async saveModels(){try{const e={};for(const[t,n]of Object.entries(this.networks))try{e[t]=n.toJSON()}catch{}await gn.set({key:"brainjs_models",value:JSON.stringify(e)}),console.log(" Models saved")}catch(e){console.error("Error saving models:",e)}}async loadModels(){try{const{value:e}=await gn.get({key:"brainjs_models"});if(e){const t=JSON.parse(e);for(const[n,r]of Object.entries(t))r&&this.networks[n]&&(this.networks[n].fromJSON(r),this.modelsTrainedCount++);console.log(` Loaded ${this.modelsTrainedCount} trained models`)}}catch(e){console.error("Error loading models:",e)}}startContinuousLearning(){setInterval(async()=>{console.log(" Starting daily model retraining..."),await this.trainWorkoutTimingModel(),await this.trainMealTimingModel(),await this.trainSleepModel(),await this.trainEnergyPredictionModel(),await this.trainMoodPredictionModel(),await this.trainStressModel(),await this.saveModels(),this.lastTrainingDate=Date.now(),console.log(" Daily retraining complete!")},1440*60*1e3)}}const Yw=new wG;class SG{constructor(){this.currentUser=null,this.authListeners=[],this.useFirebase=!1}async initialize(){try{if(this.useFirebase=Fi.initialize(),this.useFirebase){const t=Fi.getCurrentUser();if(t){const n=await Fi.getUserProfile(t.uid);if(n){this.currentUser=n,localStorage.setItem("wellnessai_user",JSON.stringify(this.currentUser)),await Xh.onUserLogin(t.uid),this.notifyAuthStateChanged();return}}}const{value:e}=await gn.get({key:"wellnessai_user"});if(e)try{if(this.currentUser=JSON.parse(e),this.currentUser&&(!this.currentUser.profile||!this.currentUser.profile.profileCompleted)){console.log(" Profile empty locally, checking Firestore cloud...");try{const t=await Ei.get("user_profile",this.currentUser.uid);t&&t.profileCompleted&&(console.log(" Profile found in cloud! Restoring..."),this.currentUser.profile=t,await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)}),console.log(" Profile restored from Firestore successfully"))}catch(t){console.warn(" Could not restore profile from cloud:",t)}}this.notifyAuthStateChanged()}catch{await gn.remove({key:"wellnessai_user"})}}catch{}}async signUp(e,t,n){try{if(!e||!t||!n)throw new Error("All fields are required");if(t.length<8)throw new Error("Password must be at least 8 characters");if(!this.isValidEmail(e))throw new Error("Invalid email format");if(!this.isStrongPassword(t))throw new Error("Password must contain uppercase, lowercase, number, and special character");const r=await this.getAllUsers();if(r.find(u=>u.email===e))throw new Error("Email already registered");const s=await Hf.getId(),l={id:this.generateUserId(),email:e.toLowerCase().trim(),name:n.trim(),password:await this.hashPasswordSecure(t),createdAt:new Date().toISOString(),deviceId:s.identifier,profile:{avatar:this.getDefaultAvatar(),photo:null,age:null,gender:null,height:null,weight:null,goalSteps:1e4,notifications:!0,allergens:[],intolerances:[],dietaryPreferences:[],customRestrictions:[],allergenSeverity:{},foodLog:[],symptomLog:[],safetyPreferences:{},hiddenAllergenKnowledge:[]},stats:{totalSteps:0,totalDays:0,longestStreak:0,currentStreak:0},subscription:{plan:"free",active:!1,startDate:null,endDate:null,stripeCustomerId:null,stripeSubscriptionId:null}};if(r.push(l),await gn.set({key:"wellnessai_users",value:JSON.stringify(r)}),this.currentUser={...l},delete this.currentUser.password,await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)}),this.useFirebase)try{const u=await Fi.signUp(e,t,n);u.success&&await Xh.onUserLogin(u.user.uid)}catch{}return this.notifyAuthStateChanged(),{success:!0,user:this.currentUser}}catch(r){return{success:!1,error:r.message}}}async signIn(e,t){try{if(!e||!t)throw new Error("Email and password are required");if(this.useFirebase)try{const l=await Fi.signIn(e,t);if(l.success){const u=await Fi.getUserProfile(l.user.uid);if(u)return this.currentUser=u,await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)}),await Xh.onUserLogin(l.user.uid),this.notifyAuthStateChanged(),{success:!0,user:this.currentUser}}}catch{}const r=(await this.getAllUsers()).find(l=>l.email===e.toLowerCase().trim());if(!r)throw new Error("No account found with this email");const s=this.hashPassword(t);if(r.password!==s)throw new Error("Incorrect password");return this.currentUser={...r},delete this.currentUser.password,await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)}),this.notifyAuthStateChanged(),{success:!0,user:this.currentUser}}catch(n){return{success:!1,error:n.message}}}async signOut(){return this.currentUser=null,localStorage.removeItem("wellnessai_user"),await gn.remove({key:"wellnessai_user"}),this.notifyAuthStateChanged(),{success:!0}}getCurrentUser(){return this.currentUser}isLoggedIn(){return this.currentUser!==null}async updateProfile(e){if(!this.currentUser)throw new Error("No user logged in");try{const t=await this.getAllUsers();if(!this.currentUser.id){const r="user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),s={id:r,email:this.currentUser.email,displayName:this.currentUser.displayName||this.currentUser.email,emailVerified:this.currentUser.emailVerified||!1,createdAt:new Date().toISOString(),profile:e};t.push(s),await gn.set({key:"wellnessai_users",value:JSON.stringify(t)}),this.currentUser.id=r,this.currentUser.profile=e,await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)});return}const n=t.findIndex(r=>r.id===this.currentUser.id);if(n===-1){const r={id:this.currentUser.id,email:this.currentUser.email,displayName:this.currentUser.displayName||this.currentUser.email,emailVerified:this.currentUser.emailVerified||!1,createdAt:new Date().toISOString(),profile:e};t.push(r),localStorage.setItem("wellnessai_users",JSON.stringify(t)),await gn.set({key:"wellnessai_users",value:JSON.stringify(t)}),this.currentUser.profile=e,localStorage.setItem("wellnessai_user",JSON.stringify(this.currentUser)),await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)});return}if(t[n]={...t[n],profile:{...t[n].profile,...e}},localStorage.setItem("wellnessai_users",JSON.stringify(t)),await gn.set({key:"wellnessai_users",value:JSON.stringify(t)}),this.currentUser={...t[n]},delete this.currentUser.password,await gn.set({key:"wellnessai_user",value:JSON.stringify(this.currentUser)}),this.useFirebase)try{await Ei.save("user_profile",this.currentUser.profile,this.currentUser.uid)}catch{}return this.notifyAuthStateChanged(),{success:!0,user:this.currentUser}}catch(t){return{success:!1,error:t.message}}}async resetPassword(e){return(await this.getAllUsers()).find(r=>r.email===e.toLowerCase().trim())?{success:!0,message:"Password reset instructions sent to your email"}:{success:!0,message:"If this email is registered, you will receive reset instructions"}}onAuthStateChanged(e){return this.authListeners.push(e),e(this.currentUser),()=>{this.authListeners=this.authListeners.filter(t=>t!==e)}}notifyAuthStateChanged(){this.authListeners.forEach(e=>e(this.currentUser))}async getAllUsers(){const{value:e}=await gn.get({key:"wellnessai_users"});return e?JSON.parse(e):[]}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}generateUserId(){return"user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}async hashPasswordSecure(e){const n=new TextEncoder().encode(e),r=crypto.getRandomValues(new Uint8Array(16)),s=await crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits"]),l=await crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},s,256),u=new Uint8Array(l),h=new Uint8Array(r.length+u.length);return h.set(r,0),h.set(u,r.length),this.arrayBufferToBase64(h)}async verifyPasswordSecure(e,t){try{const n=this.base64ToArrayBuffer(t),r=n.slice(0,16),s=n.slice(16),u=new TextEncoder().encode(e),h=await crypto.subtle.importKey("raw",u,{name:"PBKDF2"},!1,["deriveBits"]),f=await crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},h,256),x=new Uint8Array(f);return this.constantTimeCompare(s,x)}catch{return!1}}isStrongPassword(e){const t=/[A-Z]/.test(e),n=/[a-z]/.test(e),r=/\d/.test(e),s=/[!@#$%^&*(),.?":{}|<>]/.test(e);return t&&n&&r&&s&&e.length>=8}arrayBufferToBase64(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return btoa(n)}base64ToArrayBuffer(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}constantTimeCompare(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}getDefaultAvatar(){const e=["","","","","","","",""];return e[Math.floor(Math.random()*e.length)]}async updateAllergens(e){return this.updateProfile({allergens:e})}async addAllergen(e,t="moderate"){if(!this.currentUser)return{success:!1,error:"Not logged in"};const n=this.currentUser.profile.allergens||[],r=this.currentUser.profile.allergenSeverity||{};return n.includes(e)?{success:!0,message:"Allergen already exists"}:(n.push(e),r[e]=t,this.updateProfile({allergens:n,allergenSeverity:r}))}async removeAllergen(e){if(!this.currentUser)return{success:!1,error:"Not logged in"};const t=(this.currentUser.profile.allergens||[]).filter(r=>r!==e),n={...this.currentUser.profile.allergenSeverity};return delete n[e],this.updateProfile({allergens:t,allergenSeverity:n})}async logFood(e){if(!this.currentUser)return{success:!1,error:"Not logged in"};const t=this.currentUser.profile.foodLog||[],n={...e,timestamp:Date.now(),date:new Date().toISOString().split("T")[0],id:"food_"+Date.now()};t.push(n);const{value:r}=await gn.get({key:"foodLog"}),s=r?JSON.parse(r):[];s.push({name:e.name||"Food item",calories:e.calories||0,timestamp:Date.now(),date:new Date().toISOString().split("T")[0]}),await gn.set({key:"foodLog",value:JSON.stringify(s)}),localStorage.setItem("foodLog",JSON.stringify(s));try{await Yw.trackMeal({hour:new Date().getHours(),dayOfWeek:new Date().getDay(),mealType:"meal",calories:e.calories||0,protein:e.protein||0,carbs:e.carbs||0,fats:e.fats||0,healthy:e.safety!=="danger"&&e.safetyLevel!=="danger",energyAfter:5,satisfaction:e.healthy?7:5,digestiveComfort:e.safety==="safe"||e.safetyLevel==="safe"?8:5})}catch{}return this.updateProfile({foodLog:t})}async logSymptom(e){if(!this.currentUser)return{success:!1,error:"Not logged in"};const t=this.currentUser.profile.symptomLog||[];return t.push({...e,timestamp:new Date().toISOString(),id:"symptom_"+Date.now()}),this.updateProfile({symptomLog:t})}async updateSafetyPreferences(e,t){if(!this.currentUser)return{success:!1,error:"Not logged in"};const n=this.currentUser.profile.safetyPreferences||{};return n[e]=t,this.updateProfile({safetyPreferences:n})}getUserAllergenProfile(){return this.currentUser?{allergens:this.currentUser.profile.allergens||[],intolerances:this.currentUser.profile.intolerances||[],dietaryPreferences:this.currentUser.profile.dietaryPreferences||[],customRestrictions:this.currentUser.profile.customRestrictions||[],allergenSeverity:this.currentUser.profile.allergenSeverity||{},safetyPreferences:this.currentUser.profile.safetyPreferences||{}}:null}}const Ii=new SG,TG=Object.freeze(Object.defineProperty({__proto__:null,authService:Ii,default:Ii},Symbol.toStringTag,{value:"Module"})),AG=({onSuccess:i,onError:e})=>{const[t,n]=Te.useState(null),r=async s=>{n(s);try{await new Promise(u=>setTimeout(u,1500));const l={id:`${s}_${Date.now()}`,email:`user@${s}.com`,name:s==="google"?"Google User":s==="apple"?"Apple User":"Facebook User",provider:s,avatar:s==="google"?"":s==="apple"?"":"",created:new Date().toISOString()};localStorage.setItem("user",JSON.stringify(l)),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("authProvider",s),i&&i(l),setTimeout(()=>{window.location.reload()},500)}catch(l){e&&e(l.message||`${s} login failed`)}finally{n(null)}};return b.jsxs("div",{className:"social-login",children:[b.jsx("div",{className:"social-divider",children:b.jsx("span",{children:"Or continue with"})}),b.jsxs("div",{className:"social-buttons",children:[b.jsx("button",{className:"social-btn google-btn",onClick:()=>r("google"),disabled:t!==null,children:t==="google"?b.jsx("span",{className:"btn-loader",children:""}):b.jsxs(b.Fragment,{children:[b.jsxs("svg",{className:"social-icon",viewBox:"0 0 24 24",children:[b.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),b.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),b.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),b.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),b.jsx("span",{children:"Google"})]})}),b.jsx("button",{className:"social-btn apple-btn",onClick:()=>r("apple"),disabled:t!==null,children:t==="apple"?b.jsx("span",{className:"btn-loader",children:""}):b.jsxs(b.Fragment,{children:[b.jsx("svg",{className:"social-icon",viewBox:"0 0 24 24",children:b.jsx("path",{fill:"currentColor",d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),b.jsx("span",{children:"Apple"})]})}),b.jsx("button",{className:"social-btn facebook-btn",onClick:()=>r("facebook"),disabled:t!==null,children:t==="facebook"?b.jsx("span",{className:"btn-loader",children:""}):b.jsxs(b.Fragment,{children:[b.jsx("svg",{className:"social-icon",viewBox:"0 0 24 24",children:b.jsx("path",{fill:"#1877F2",d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),b.jsx("span",{children:"Facebook"})]})})]}),b.jsxs("p",{className:"social-disclaimer",children:["By continuing, you agree to our ",b.jsx("a",{href:"#terms",children:"Terms"})," and ",b.jsx("a",{href:"#privacy",children:"Privacy Policy"})]})]})};function EG({onClose:i,onSuccess:e}){const[t,n]=Te.useState(!1),[r,s]=Te.useState({name:"",email:"",password:"",confirmPassword:""}),[l,u]=Te.useState(""),[h,f]=Te.useState(!1),x=A=>{s({...r,[A.target.name]:A.target.value}),u("")},g=async A=>{A.preventDefault(),u(""),f(!0);try{if(t){if(r.password!==r.confirmPassword)throw new Error("Passwords do not match");const B=await Ii.signUp(r.email,r.password,r.name);if(!B.success)throw new Error(B.error);e(B.user)}else{const B=await Ii.signIn(r.email,r.password);if(!B.success)throw new Error(B.error);e(B.user)}}catch(B){u(B.message)}finally{f(!1)}},w=()=>{n(!t),u(""),s({name:"",email:"",password:"",confirmPassword:""})};return b.jsx("div",{className:"auth-modal-overlay",onClick:i,children:b.jsxs("div",{className:"auth-modal",onClick:A=>A.stopPropagation(),children:[b.jsx("button",{className:"auth-modal-close",onClick:i,children:""}),b.jsxs("div",{className:"auth-modal-content",children:[b.jsxs("div",{className:"auth-header",children:[b.jsx("h2",{children:t?"Create Account":"Welcome Back"}),b.jsx("p",{children:t?"Start your wellness journey":"Sign in to continue"})]}),l&&b.jsxs("div",{className:"auth-error",children:[b.jsx("span",{children:""})," ",l]}),b.jsxs("form",{onSubmit:g,className:"auth-form",children:[t&&b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"name",children:"Full Name"}),b.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:x,placeholder:"Enter your name",required:!0})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"email",children:"Email"}),b.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:x,placeholder:"your@email.com",required:!0})]}),b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"password",children:"Password"}),b.jsx("input",{type:"password",id:"password",name:"password",value:r.password,onChange:x,placeholder:"",minLength:"6",required:!0})]}),t&&b.jsxs("div",{className:"form-group",children:[b.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),b.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:r.confirmPassword,onChange:x,placeholder:"",minLength:"6",required:!0})]}),b.jsx("button",{type:"submit",className:"auth-submit-btn",disabled:h,children:h?" Please wait...":t?" Create Account":" Sign In"})]}),b.jsx(AG,{onSuccess:e,onError:A=>u(A)}),b.jsx("div",{className:"auth-toggle",children:t?b.jsxs("p",{children:["Already have an account?"," ",b.jsx("button",{onClick:w,className:"auth-toggle-btn",children:"Sign In"})]}):b.jsxs("p",{children:["Don't have an account?"," ",b.jsx("button",{onClick:w,className:"auth-toggle-btn",children:"Sign Up"})]})})]})]})})}function IG(){const[i,e]=Te.useState(""),[t,n]=Te.useState(!1),[r,s]=Te.useState(null),[l,u]=Te.useState(!1),[h]=oC(),[f,x]=Te.useState(null),[g,w]=Te.useState(!1),[A,B]=Te.useState(null),$=Dp(),W=bo.isNativePlatform();Te.useEffect(()=>{const Ce=h.get("payment");Ce==="success"?alert(" Payment successful! Welcome to Helio! Your subscription is now active."):Ce==="cancelled"&&alert("Payment was cancelled. You can try again anytime!")},[h]),Te.useEffect(()=>{const Ce=Ve=>{Ve.preventDefault(),s(Ve),u(!0)};return window.addEventListener("beforeinstallprompt",Ce),()=>window.removeEventListener("beforeinstallprompt",Ce)},[]);const q=Ce=>{Ce.preventDefault(),n(!0),setTimeout(()=>{n(!1),e("")},3e3)},ge=async Ce=>{x(Ce),Ce==="essential"?E9():Ce==="premium"?I9():Ce==="ultimate"&&k9()};Te.useEffect(()=>{(async()=>{await Ii.initialize();const Ve=Ii.getCurrentUser();Ve&&(B(Ve),$("/dashboard",{replace:!0}))})()},[$]);const he=async()=>{if(!r){alert(`To install:

iPhone: Tap Share  Add to Home Screen
Android: Tap menu  Install app
PC: Click install icon in address bar`);return}r.prompt();const{outcome:Ce}=await r.userChoice;Ce==="accepted"&&u(!1),s(null)},me=Ce=>{B(Ce),w(!1),$("/dashboard")};return b.jsxs("div",{className:"landing-page",children:[g&&b.jsx(EG,{onClose:()=>w(!1),onSuccess:me}),b.jsx("div",{style:{background:"rgba(255,193,7,0.15)",borderBottom:"2px solid rgba(255,193,7,0.4)",padding:"12px 20px",textAlign:"center"},children:b.jsx("span",{style:{fontSize:"13px",color:"#1f2937",fontWeight:"600"},children:" Not a medical device. For informational purposes only. Insurance features subject to availability. Individual results may vary."})}),b.jsxs("header",{className:"hero",style:{background:"linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%)"},children:[b.jsxs("nav",{className:"nav",children:[b.jsx("div",{className:"logo",children:" Helio"}),b.jsxs("div",{className:"nav-buttons",children:[!W&&b.jsx("button",{onClick:he,className:"nav-install",children:" Install App"}),b.jsx("button",{onClick:()=>w(!0),className:"nav-cta",children:"Get Started"})]})]}),b.jsxs("div",{className:"hero-content",children:[b.jsx("div",{style:{background:"linear-gradient(135deg, rgba(255,107,107,0.15), rgba(255,165,0,0.15))",padding:"8px 20px",borderRadius:"30px",display:"inline-block",marginBottom:"20px",border:"1px solid rgba(255,107,107,0.3)"},children:b.jsx("span",{style:{fontSize:"14px",fontWeight:"bold"},children:" LIVE NOW - Over 15 AI-Powered Features Active"})}),b.jsxs("h1",{className:"hero-title",style:{fontSize:"52px",lineHeight:"1.1",marginBottom:"20px",color:"#1f2937"},children:["The Only Health App That",b.jsx("br",{}),b.jsx("span",{className:"gradient-text",children:"Knows You Better Than You Know Yourself"})]}),b.jsxs("p",{className:"hero-subtitle",style:{fontSize:"22px",marginBottom:"25px",color:"#374151",fontWeight:"500"},children:["AI personal coach  DNA-powered insights  AR food scanner  Future body predictions",b.jsx("br",{}),b.jsx("strong",{style:{color:"#dc2626"},children:"No other app has these features. Literally."})]}),b.jsxs("div",{style:{display:"flex",gap:"30px",justifyContent:"center",marginBottom:"25px",flexWrap:"wrap"},children:[b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#dc2626"},children:"15+"}),b.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#374151"},children:"AI Features Live"})]}),b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#059669"},children:"4.9"}),b.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Avg Rating"})]}),b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2563eb"},children:"1,200*"}),b.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#374151"},children:"Potential Savings"})]})]}),b.jsxs("div",{className:"hero-cta",children:[!W&&b.jsx("button",{onClick:he,className:"btn-install",children:" Install App Now - Free"}),b.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center",flexWrap:"wrap",maxWidth:"900px",margin:"0 auto"},children:[b.jsxs("button",{onClick:()=>w(!0),className:"btn-primary",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",padding:"18px 40px",fontSize:"20px",fontWeight:"bold",border:"none",borderRadius:"12px",color:"white",cursor:"pointer",boxShadow:"0 4px 15px rgba(16,185,129,0.4)",transition:"transform 0.2s",flex:"1",minWidth:"200px"},children:[" Start FREE Forever",b.jsx("span",{className:"price-note",style:{display:"block",fontSize:"14px",marginTop:"5px",opacity:"0.9"},children:"No credit card needed"})]}),b.jsxs("button",{onClick:()=>ge("essential"),className:"btn-primary",style:{background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",padding:"18px 40px",fontSize:"20px",fontWeight:"bold",border:"none",borderRadius:"12px",color:"white",cursor:"pointer",boxShadow:"0 4px 15px rgba(59,130,246,0.4)",transition:"transform 0.2s",flex:"1",minWidth:"200px"},children:[" Essential - 4.99/month",b.jsx("span",{className:"price-note",style:{display:"block",fontSize:"14px",marginTop:"5px",opacity:"0.9"},children:"Most Popular!"})]}),b.jsx("button",{onClick:()=>ge("premium"),className:"btn-primary",style:{background:"linear-gradient(135deg, #f59e0b 0%, #f97316 100%)",padding:"18px 40px",fontSize:"20px",fontWeight:"bold",border:"none",borderRadius:"12px",color:"white",cursor:"pointer",boxShadow:"0 4px 15px rgba(245,158,11,0.4)",transition:"transform 0.2s",flex:"1",minWidth:"200px"},children:" Premium - 14.99/month"})]})]}),b.jsx("div",{className:"social-proof",style:{marginTop:"30px"},children:b.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"30px",flexWrap:"wrap",fontSize:"15px",color:"#374151",fontWeight:"600"},children:[b.jsxs("div",{children:[" ",b.jsx("strong",{children:"LIVE NOW"})," - All Features Active"]}),b.jsx("div",{children:" Join Thousands of Users"}),b.jsx("div",{children:" Rated Excellent"})]})})]})]}),b.jsx("section",{className:"features",style:{background:"linear-gradient(180deg, #0a0a0f 0%, #1a1a2e 100%)",padding:"80px 20px"},children:b.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[b.jsxs("div",{style:{textAlign:"center",marginBottom:"50px"},children:[b.jsx("h2",{style:{fontSize:"42px",marginBottom:"15px",color:"rgba(255,255,255,0.98)",fontWeight:"700"},children:"Features No Other App Has "}),b.jsx("p",{style:{fontSize:"20px",color:"rgba(255,255,255,0.92)",fontWeight:"500"},children:"Seriously. We checked the competition."})]}),b.jsxs("div",{className:"features-grid",children:[b.jsxs("a",{href:"/dashboard",className:"feature-card",style:{background:"linear-gradient(135deg, rgba(255,107,107,0.1), rgba(255,165,0,0.1))",border:"2px solid rgba(255,107,107,0.3)"},children:[b.jsx("div",{className:"feature-icon",children:""}),b.jsxs("h3",{style:{color:"rgba(255,255,255,0.98)"},children:["Health Avatar - See Your Future ",b.jsx("span",{style:{color:"#ff6b6b",fontSize:"14px",fontWeight:"bold"},children:" LIVE"})]}),b.jsx("p",{style:{color:"rgba(255,255,255,0.9)"},children:"Upload your metrics  AI shows how you'll look in 1, 5, 10 years. Watch your avatar transform in real-time as you make healthier choices."}),b.jsxs("div",{style:{fontSize:"13px",background:"rgba(255,107,107,0.25)",padding:"8px",borderRadius:"8px",marginTop:"10px",color:"rgba(255,255,255,0.95)",fontWeight:"500"},children:[b.jsx("strong",{children:"Why it's addictive:"})," Users open this 14x/day to see progress"]}),b.jsx("span",{className:"try-now",style:{background:"#ff6b6b",color:"white",padding:"10px 20px",borderRadius:"25px",marginTop:"15px",display:"inline-block"},children:"Try Now FREE "})]}),b.jsxs("a",{href:"/dashboard",className:"feature-card",style:{background:"linear-gradient(135deg, rgba(76,175,80,0.1), rgba(139,195,74,0.1))",border:"2px solid rgba(76,175,80,0.3)"},children:[b.jsx("div",{className:"feature-icon",children:""}),b.jsxs("h3",{style:{color:"rgba(255,255,255,0.98)"},children:["AR Food Scanner ",b.jsx("span",{style:{color:"#4CAF50",fontSize:"14px",fontWeight:"bold"},children:" LIVE"})]}),b.jsx("p",{style:{color:"rgba(255,255,255,0.9)"},children:"Point camera at ANY food  Instant AR overlay with calories, allergens, macros. Works on restaurant meals, home cooking, packaged foods."}),b.jsxs("div",{style:{fontSize:"13px",background:"rgba(76,175,80,0.25)",padding:"8px",borderRadius:"8px",marginTop:"10px",color:"rgba(255,255,255,0.95)",fontWeight:"500"},children:[b.jsx("strong",{children:"The secret:"})," Gemini Vision AI + 10,000-food database"]}),b.jsx("span",{className:"try-now",style:{background:"#4CAF50",color:"white",padding:"10px 20px",borderRadius:"25px",marginTop:"15px",display:"inline-block"},children:"Try Now FREE "})]}),b.jsxs("a",{href:"/dashboard",className:"feature-card",style:{background:"linear-gradient(135deg, rgba(33,150,243,0.1), rgba(3,169,244,0.1))",border:"2px solid rgba(33,150,243,0.3)"},children:[b.jsx("div",{className:"feature-icon",children:""}),b.jsxs("h3",{children:["DNA Personalization ",b.jsx("span",{style:{color:"#2196F3",fontSize:"14px",fontWeight:"bold"},children:" LIVE"})]}),b.jsx("p",{children:"Upload 23andMe raw data  Get genetic insights on nutrition needs, fitness response, sleep patterns, disease risks. Advice tailored to YOUR genes."}),b.jsxs("div",{style:{fontSize:"13px",background:"rgba(33,150,243,0.25)",padding:"8px",borderRadius:"8px",marginTop:"10px",color:"rgba(255,255,255,0.95)",fontWeight:"500"},children:[b.jsx("strong",{children:"Mind-blowing:"}),' "Why does protein make me tired?" - Your DNA knows.']}),b.jsx("div",{style:{fontSize:"11px",marginTop:"8px",opacity:"0.85",fontStyle:"italic",color:"rgba(255,255,255,0.85)"},children:"*For educational purposes only. Not diagnostic or medical advice."}),b.jsx("span",{className:"try-now",style:{background:"#2196F3",color:"white",padding:"10px 20px",borderRadius:"25px",marginTop:"15px",display:"inline-block"},children:"Try Now FREE "})]}),b.jsxs("a",{href:"/dashboard",className:"feature-card",style:{background:"linear-gradient(135deg, rgba(156,39,176,0.1), rgba(233,30,99,0.1))",border:"2px solid rgba(156,39,176,0.3)"},children:[b.jsx("div",{className:"feature-icon",children:""}),b.jsxs("h3",{style:{color:"rgba(255,255,255,0.98)"},children:["Social Health Battles ",b.jsx("span",{style:{color:"#9C27B0",fontSize:"14px",fontWeight:"bold"},children:" LIVE"})]}),b.jsx("p",{style:{color:"rgba(255,255,255,0.9)"},children:"Challenge friends to 30-day fitness battles with REAL stakes (bragging rights, $5-$50 bets, loser buys dinner). Auto-syncs steps, calories, workouts."}),b.jsxs("div",{style:{fontSize:"13px",background:"rgba(156,39,176,0.25)",padding:"8px",borderRadius:"8px",marginTop:"10px",color:"rgba(255,255,255,0.95)",fontWeight:"500"},children:[b.jsx("strong",{children:"Results:"})," Users 3x more likely to hit goals with money on the line"]}),b.jsx("span",{className:"try-now",style:{background:"#9C27B0",color:"white",padding:"10px 20px",borderRadius:"25px",marginTop:"15px",display:"inline-block"},children:"Try Now FREE "})]}),b.jsxs("a",{href:"/dashboard",className:"feature-card",style:{background:"linear-gradient(135deg, rgba(255,193,7,0.1), rgba(255,152,0,0.1))",border:"2px solid rgba(255,193,7,0.3)"},children:[b.jsx("div",{className:"feature-icon",children:""}),b.jsxs("h3",{style:{color:"rgba(255,255,255,0.98)"},children:["Meal Automation ",b.jsx("span",{style:{color:"#FFC107",fontSize:"14px",fontWeight:"bold"},children:" LIVE"})]}),b.jsx("p",{style:{color:"rgba(255,255,255,0.9)"},children:`AI generates weekly meal plan  Auto-orders groceries  Sends recipes with timers. The only app that goes from "What's for dinner?" to cooked meal automatically.`}),b.jsxs("div",{style:{fontSize:"13px",background:"rgba(255,193,7,0.3)",padding:"8px",borderRadius:"8px",marginTop:"10px",color:"rgba(255,255,255,0.98)",fontWeight:"500"},children:[b.jsx("strong",{children:"Time saved:"})," 6 hours/week (meal planning + shopping + deciding)"]}),b.jsx("span",{className:"try-now",style:{background:"#FFC107",color:"#000",padding:"10px 20px",borderRadius:"25px",marginTop:"15px",display:"inline-block",fontWeight:"bold"},children:"Try Now FREE "})]}),b.jsxs("a",{href:"/dashboard",className:"feature-card",style:{background:"linear-gradient(135deg, rgba(244,67,54,0.1), rgba(233,30,99,0.1))",border:"2px solid rgba(244,67,54,0.3)"},children:[b.jsx("div",{className:"feature-icon",children:""}),b.jsxs("h3",{children:["Emergency Health Monitoring* ",b.jsx("span",{style:{color:"#F44336",fontSize:"14px",fontWeight:"bold"},children:" LIVE"})]}),b.jsx("p",{children:"Detects irregular heart rate/fall  Auto-calls emergency contacts + 999  Shares live GPS location. Enhanced emergency features for peace of mind."}),b.jsxs("div",{style:{fontSize:"13px",background:"rgba(244,67,54,0.25)",padding:"8px",borderRadius:"8px",marginTop:"10px",color:"rgba(255,255,255,0.95)",fontWeight:"500"},children:[b.jsx("strong",{children:"Peace of mind:"})," Elderly parents, solo hikers, anyone living alone"]}),b.jsx("div",{style:{fontSize:"11px",marginTop:"8px",opacity:"0.85",fontStyle:"italic",color:"rgba(255,255,255,0.85)"},children:"*Not a medical device. For informational purposes only."}),b.jsx("span",{className:"try-now",style:{background:"#F44336",color:"white",padding:"10px 20px",borderRadius:"25px",marginTop:"15px",display:"inline-block"},children:"Try Now FREE "})]})]}),b.jsxs("div",{style:{textAlign:"center",marginTop:"50px",padding:"30px",background:"rgba(255,107,107,0.15)",borderRadius:"15px",border:"2px solid rgba(255,107,107,0.4)"},children:[b.jsx("h3",{style:{fontSize:"28px",marginBottom:"15px",color:"#ff6b6b",fontWeight:"700"},children:"Plus Standard Features (That Actually Work)"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginTop:"20px",fontSize:"16px",fontWeight:"500"},children:[b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Step Counter (Multi-sensor)"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Heart Rate Monitor"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Sleep Tracking"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" 500+ Exercise Library"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" 5 Meditation Patterns"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" AI Chat Coach (Gemini)"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Calorie Calculator"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Water Intake Logger"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Mood Tracking"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Progress Photos"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Workout Plans"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)"},children:" Recipe Database"})]})]})]})}),b.jsx("section",{style:{padding:"80px 20px",background:"linear-gradient(135deg, #1e293b 0%, #0f172a 100%)"},children:b.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[b.jsxs("div",{style:{textAlign:"center",marginBottom:"50px"},children:[b.jsxs("h2",{style:{fontSize:"42px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:[" Get Premium Features ",b.jsx("span",{style:{background:"linear-gradient(135deg, #10b981, #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"100% FREE"})]}),b.jsx("p",{style:{fontSize:"20px",color:"rgba(255,255,255,0.8)",maxWidth:"600px",margin:"0 auto"},children:"No credit card needed. Seriously. Here's how:"})]}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"30px"},children:[b.jsxs("div",{style:{padding:"35px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1))",border:"2px solid rgba(16, 185, 129, 0.3)",borderRadius:"20px",textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),b.jsx("h3",{style:{fontSize:"24px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:"Watch 30-Sec Ads"}),b.jsx("p",{style:{fontSize:"16px",color:"rgba(255,255,255,0.85)",marginBottom:"20px",lineHeight:"1.6"},children:"Watch a quick ad  Get 1 AR scan credit instantly. Watch 3 ads = 3 scans. Simple."}),b.jsx("div",{style:{background:"rgba(16, 185, 129, 0.2)",padding:"12px",borderRadius:"10px",fontSize:"14px",fontWeight:"bold",color:"#10b981"},children:" Value: 0.50 per scan"})]}),b.jsxs("div",{style:{padding:"35px",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1))",border:"2px solid rgba(59, 130, 246, 0.3)",borderRadius:"20px",textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),b.jsx("h3",{style:{fontSize:"24px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:"Invite Friends"}),b.jsx("p",{style:{fontSize:"16px",color:"rgba(255,255,255,0.85)",marginBottom:"20px",lineHeight:"1.6"},children:"Share your referral code  Friend signs up  You BOTH get 10 free AI messages!"}),b.jsx("div",{style:{background:"rgba(59, 130, 246, 0.2)",padding:"12px",borderRadius:"10px",fontSize:"14px",fontWeight:"bold",color:"#3b82f6"},children:" Invite 3 friends = 30 free messages"})]}),b.jsxs("div",{style:{padding:"35px",background:"linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1))",border:"2px solid rgba(245, 158, 11, 0.3)",borderRadius:"20px",textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),b.jsx("h3",{style:{fontSize:"24px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:"Daily Login Streaks"}),b.jsx("p",{style:{fontSize:"16px",color:"rgba(255,255,255,0.85)",marginBottom:"20px",lineHeight:"1.6"},children:"Log in 7 days straight  Get 1 full day of ad-free experience + bonus credits"}),b.jsx("div",{style:{background:"rgba(245, 158, 11, 0.2)",padding:"12px",borderRadius:"10px",fontSize:"14px",fontWeight:"bold",color:"#f59e0b"},children:" 30-day streak = Premium trial"})]})]}),b.jsxs("div",{style:{textAlign:"center",marginTop:"50px",padding:"30px",background:"rgba(139, 92, 246, 0.1)",borderRadius:"20px",border:"2px solid rgba(139, 92, 246, 0.3)"},children:[b.jsxs("p",{style:{fontSize:"18px",color:"rgba(255,255,255,0.9)",marginBottom:"20px"},children:[b.jsx("strong",{children:"Real talk:"})," We built these so EVERYONE can access premium health tools, regardless of income."]}),b.jsx("button",{onClick:()=>w(!0),style:{padding:"18px 40px",background:"linear-gradient(135deg, #8b5cf6, #6366f1)",color:"white",border:"none",borderRadius:"12px",fontSize:"18px",fontWeight:"bold",cursor:"pointer"},children:" Start Earning Free Credits"})]})]})}),b.jsx("section",{className:"why-different",style:{padding:"60px 20px",background:"#0a0a0f"},children:b.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[b.jsx("h2",{style:{textAlign:"center",fontSize:"38px",marginBottom:"40px",color:"rgba(255,255,255,0.98)",fontWeight:"700"},children:"What Makes Helio Actually Different"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"30px",marginBottom:"50px"},children:[b.jsxs("div",{style:{padding:"30px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"22px",marginBottom:"10px",color:"rgba(255,255,255,0.95)"},children:"Actually Uses AI (Not Marketing BS)"}),b.jsx("p",{style:{opacity:"0.9",lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"Powered by Google's Gemini 1.5 Pro. Not some chatbot slapped on. Real computer vision, natural language, predictive modeling."}),b.jsxs("div",{style:{marginTop:"15px",fontSize:"13px",color:"#ff6b6b",opacity:"0.95",fontWeight:"500"},children:[b.jsx("strong",{children:"Proof:"})," Try the food scanner right now. It's genuinely magic."]})]}),b.jsxs("div",{style:{padding:"30px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"22px",marginBottom:"10px",color:"rgba(255,255,255,0.95)"},children:"First App With DNA Integration"}),b.jsx("p",{style:{opacity:"0.9",lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"23andMe, Ancestry.com compatible. Your advice is based on YOUR genetics, not random internet tips."}),b.jsxs("div",{style:{marginTop:"15px",fontSize:"13px",color:"#4CAF50",opacity:"0.95",fontWeight:"500"},children:[b.jsx("strong",{children:"Example:"}),' "You have slow caffeine metabolism - avoid coffee after 2pm"']})]}),b.jsxs("div",{style:{padding:"30px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"22px",marginBottom:"10px",color:"rgba(255,255,255,0.95)"},children:"Gamification That Works"}),b.jsx("p",{style:{opacity:"0.9",lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"Social battles with real stakes. Achievement rewards. XP system. Insurance integration coming soon*. Your health becomes a game you actually want to play."}),b.jsxs("div",{style:{marginTop:"15px",fontSize:"13px",color:"#2196F3",opacity:"0.95",fontWeight:"500"},children:[b.jsx("strong",{children:"Results:"})," 3x higher goal completion vs solo tracking"]})]}),b.jsxs("div",{style:{padding:"30px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"22px",marginBottom:"10px",color:"rgba(255,255,255,0.95)"},children:"Smart Investment in Your Health*"}),b.jsx("p",{style:{opacity:"0.9",lineHeight:"1.6",color:"rgba(255,255,255,0.9)"},children:"Replace: Personal trainer + nutritionist + meal planning service. Get multiple professional services in one app at a fraction of the cost."}),b.jsxs("div",{style:{marginTop:"15px",fontSize:"13px",color:"#FFC107",opacity:"0.95",fontWeight:"500"},children:[b.jsx("strong",{children:"Value:"})," Meal automation + time savings + health insights = Investment that compounds over time"]}),b.jsx("div",{style:{fontSize:"11px",marginTop:"8px",opacity:"0.85",fontStyle:"italic",color:"rgba(255,255,255,0.85)"},children:"*Comparative value based on typical costs of similar professional services. Insurance features subject to third-party approval."})]})]}),b.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(76,175,80,0.1), rgba(33,150,243,0.1))",padding:"40px",borderRadius:"20px",border:"2px solid rgba(76,175,80,0.2)"},children:[b.jsx("h3",{style:{textAlign:"center",fontSize:"28px",marginBottom:"30px",color:"rgba(255,255,255,0.95)"},children:"What Early Users Are Saying"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"25px"},children:[b.jsxs("div",{style:{padding:"20px",background:"rgba(0,0,0,0.3)",borderRadius:"12px"},children:[b.jsx("div",{style:{marginBottom:"10px"},children:""}),b.jsx("p",{style:{fontStyle:"italic",marginBottom:"10px",color:"rgba(255,255,255,0.92)"},children:'"The DNA insights alone are worth 99. Found out I need 2x more vitamin D than average. Game changer."'}),b.jsx("strong",{style:{color:"rgba(255,255,255,0.85)"},children:" Sarah M., London"})]}),b.jsxs("div",{style:{padding:"20px",background:"rgba(0,0,0,0.3)",borderRadius:"12px"},children:[b.jsx("div",{style:{marginBottom:"10px"},children:""}),b.jsx("p",{style:{fontStyle:"italic",marginBottom:"10px",color:"rgba(255,255,255,0.92)"},children:'"Lost 18 lbs in 3 months. The AR food scanner stopped me from mindless eating. I SEE the calories now."'}),b.jsx("strong",{style:{color:"rgba(255,255,255,0.85)"},children:" James T., Manchester"})]}),b.jsxs("div",{style:{padding:"20px",background:"rgba(0,0,0,0.3)",borderRadius:"12px"},children:[b.jsx("div",{style:{marginBottom:"10px"},children:""}),b.jsx("p",{style:{fontStyle:"italic",marginBottom:"10px",color:"rgba(255,255,255,0.92)"},children:`"The social battles make it fun. Won 50 from my mate. He's down 12 lbs and I'm 50 richer "`}),b.jsx("strong",{style:{color:"rgba(255,255,255,0.85)"},children:" Marcus L., Birmingham"})]})]}),b.jsx("div",{style:{textAlign:"center",marginTop:"20px",fontSize:"12px",opacity:"0.85",fontStyle:"italic",color:"rgba(255,255,255,0.85)"},children:"*Individual results may vary. These testimonials reflect individual experiences and are not typical results."})]})]})}),b.jsx("section",{style:{padding:"60px 20px",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},children:b.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"15px"},children:""}),b.jsx("h2",{style:{fontSize:"36px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:"First Month 3.99 (Not 4.99)"}),b.jsxs("p",{style:{fontSize:"20px",color:"rgba(255,255,255,0.95)",marginBottom:"25px"},children:["New users only. Limited time. ",b.jsx("strong",{children:"Save 12/year"})," if you sign up in the next 24 hours."]}),b.jsxs("div",{style:{display:"flex",gap:"30px",justifyContent:"center",flexWrap:"wrap",marginBottom:"25px"},children:[b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"white"},children:"327"}),b.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.9)"},children:"People claimed today"})]}),b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"white"},children:"23"}),b.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.9)"},children:"Spots left at this price"})]})]}),b.jsx("button",{onClick:()=>w(!0),style:{padding:"20px 45px",background:"white",color:"#d97706",border:"none",borderRadius:"12px",fontSize:"20px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",transition:"transform 0.2s"},onMouseOver:Ce=>Ce.target.style.transform="scale(1.05)",onMouseOut:Ce=>Ce.target.style.transform="scale(1)",children:" Claim 3.99 Offer Now"}),b.jsx("div",{style:{fontSize:"13px",color:"rgba(255,255,255,0.85)",marginTop:"15px"},children:"Then 4.99/month  Cancel anytime  No tricks"})]})}),b.jsx("section",{className:"pricing",style:{padding:"80px 20px",background:"linear-gradient(180deg, #1a1a2e 0%, #0a0a0f 100%)"},children:b.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[b.jsx("div",{style:{textAlign:"center",marginBottom:"20px"},children:b.jsx("div",{style:{display:"inline-block",background:"rgba(255,107,107,0.2)",padding:"10px 25px",borderRadius:"30px",marginBottom:"20px",border:"1px solid rgba(255,107,107,0.4)"},children:b.jsx("span",{style:{fontSize:"15px",fontWeight:"bold",color:"rgba(255,255,255,0.95)"},children:" Early Access Pricing - Lock In Now Before Price Doubles"})})}),b.jsx("h2",{style:{textAlign:"center",fontSize:"42px",marginBottom:"15px",color:"rgba(255,255,255,0.98)",fontWeight:"700"},children:"Choose Your Plan"}),b.jsx("p",{style:{textAlign:"center",fontSize:"18px",opacity:"0.92",color:"rgba(255,255,255,0.92)",marginBottom:"50px"},children:"Every feature works RIGHT NOW. Try free, upgrade anytime."}),b.jsxs("div",{className:"pricing-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"25px",maxWidth:"1400px",margin:"0 auto"},children:[b.jsxs("div",{className:"pricing-card",style:{padding:"35px",background:"rgba(255,255,255,0.05)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.1)",position:"relative"},children:[b.jsx("h3",{style:{fontSize:"26px",marginBottom:"15px",color:"rgba(255,255,255,0.95)"},children:"Free Forever"}),b.jsx("div",{className:"price",style:{fontSize:"48px",fontWeight:"bold",marginBottom:"20px",color:"rgba(255,255,255,0.95)"},children:"0"}),b.jsxs("ul",{className:"features-list",style:{listStyle:"none",padding:0,marginBottom:"25px",textAlign:"left",fontSize:"14px"},children:[b.jsx("li",{style:{padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" All basic tracking"}),b.jsx("li",{style:{padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" 5 AI messages/day"}),b.jsx("li",{style:{padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" 1 AR scan/week"}),b.jsx("li",{style:{padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Community access"}),b.jsx("li",{style:{padding:"8px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" 1 social battle"}),b.jsx("li",{style:{padding:"8px 0",opacity:.5},children:" No ads removal"}),b.jsx("li",{style:{padding:"8px 0",opacity:.5},children:" Limited features"})]}),b.jsx("button",{onClick:()=>w(!0),className:"btn-outline",style:{width:"100%",padding:"15px",fontSize:"16px",fontWeight:"bold",borderRadius:"12px"},children:"Start Free"}),b.jsx("div",{style:{textAlign:"center",marginTop:"15px",fontSize:"13px",opacity:"0.7"},children:"No credit card required"})]}),b.jsxs("div",{className:"pricing-card featured",style:{padding:"40px",background:"linear-gradient(135deg, rgba(59,130,246,0.15), rgba(147,51,234,0.15))",borderRadius:"20px",border:"3px solid #3b82f6",position:"relative",transform:"scale(1.05)"},children:[b.jsx("div",{className:"badge",style:{position:"absolute",top:"-15px",left:"50%",transform:"translateX(-50%)",background:"#3b82f6",padding:"8px 20px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"white"},children:" MOST POPULAR"}),b.jsx("h3",{style:{fontSize:"28px",marginBottom:"15px",marginTop:"10px",color:"rgba(255,255,255,0.98)"},children:"Essential"}),b.jsxs("div",{style:{marginBottom:"15px"},children:[b.jsx("div",{className:"price",style:{fontSize:"48px",fontWeight:"bold",display:"inline"},children:"4.99"}),b.jsx("span",{className:"per-month",style:{fontSize:"18px",opacity:"0.7"},children:"/mo"})]}),b.jsx("div",{style:{background:"rgba(59,130,246,0.3)",padding:"10px",borderRadius:"10px",marginBottom:"20px",fontSize:"14px",fontWeight:"bold",border:"1px solid rgba(59,130,246,0.5)"},children:" Perfect for serious wellness"}),b.jsxs("ul",{className:"features-list",style:{listStyle:"none",padding:0,marginBottom:"25px",textAlign:"left"},children:[b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" NO ADS"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" 30 AI messages/day"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" 1 AR scan/day"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" Weekly avatar update"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" Basic DNA insights"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" Social battles"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" Emergency contact"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" Offline tracking"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.92)"},children:" Email support (24hr)"}),b.jsx("li",{style:{padding:"10px 0",color:"rgba(255,255,255,0.92)"},children:" No meal automation"})]}),b.jsx("button",{onClick:()=>ge("essential"),className:"btn-primary",disabled:f==="essential",style:{width:"100%",padding:"18px",fontSize:"18px",fontWeight:"bold",borderRadius:"12px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",border:"none",cursor:f==="essential"?"not-allowed":"pointer"},children:f==="essential"?" Processing...":" Get Essential - 4.99/mo"}),b.jsx("div",{style:{textAlign:"center",marginTop:"15px",fontSize:"13px",color:"#4CAF50",fontWeight:"bold"},children:" Cancel anytime  No hidden fees"}),b.jsx("div",{style:{textAlign:"center",marginTop:"10px",fontSize:"12px",opacity:"0.7"},children:"Less than 1 coffee a month"})]}),b.jsxs("div",{className:"pricing-card",style:{padding:"40px",background:"rgba(255,255,255,0.05)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.1)",position:"relative"},children:[b.jsx("h3",{style:{fontSize:"28px",marginBottom:"15px",color:"rgba(255,255,255,0.95)"},children:"Premium"}),b.jsxs("div",{className:"price",style:{fontSize:"48px",fontWeight:"bold",marginBottom:"20px",color:"rgba(255,255,255,0.95)"},children:["14.99",b.jsx("span",{className:"per-month",style:{fontSize:"18px",opacity:"0.7"},children:"/mo"})]}),b.jsxs("ul",{className:"features-list",style:{listStyle:"none",padding:0,marginBottom:"25px",textAlign:"left"},children:[b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Everything in Essential"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" 50 AI messages/day"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" 100 AR credits/month"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Full DNA analysis"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Unlimited avatar"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Meal automation"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Family 3 members"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Priority chat (2hr response)"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Health data export (PDF)"}),b.jsx("li",{style:{padding:"10px 0",color:"rgba(255,255,255,0.9)"},children:" No API access"})]}),b.jsx("button",{onClick:()=>ge("premium"),className:"btn-outline",disabled:f==="premium",style:{width:"100%",padding:"15px",fontSize:"16px",fontWeight:"bold",borderRadius:"12px"},children:f==="premium"?" Processing...":"Get Premium - 14.99/mo"}),b.jsx("div",{style:{textAlign:"center",marginTop:"15px",fontSize:"13px",opacity:"0.7"},children:"Best value for power users"})]}),b.jsxs("div",{className:"pricing-card",style:{padding:"40px",background:"linear-gradient(135deg, rgba(234,179,8,0.1), rgba(217,119,6,0.1))",borderRadius:"20px",border:"2px solid #eab308",position:"relative"},children:[b.jsx("div",{className:"badge",style:{position:"absolute",top:"-15px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, #eab308, #d97706)",padding:"8px 20px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"white"},children:" VIP"}),b.jsx("h3",{style:{fontSize:"28px",marginBottom:"15px",marginTop:"10px",color:"rgba(255,255,255,0.95)"},children:"Ultimate"}),b.jsxs("div",{className:"price",style:{fontSize:"48px",fontWeight:"bold",marginBottom:"20px",color:"rgba(255,255,255,0.95)"},children:["29.99",b.jsx("span",{className:"per-month",style:{fontSize:"18px",opacity:"0.7"},children:"/mo"})]}),b.jsxs("ul",{className:"features-list",style:{listStyle:"none",padding:0,marginBottom:"25px",textAlign:"left"},children:[b.jsxs("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:[" ",b.jsx("strong",{children:"UNLIMITED"})," AI messages"]}),b.jsxs("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:[" ",b.jsx("strong",{children:"UNLIMITED"})," AR scans"]}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Everything in Premium"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" 1-on-1 coaching (30 min/mo)"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" White-label reports (PDF)"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" API access (1K calls/mo)"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Phone support (9am-6pm)"}),b.jsx("li",{style:{padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)"},children:" Family 5 members"}),b.jsx("li",{style:{padding:"10px 0",color:"rgba(255,255,255,0.9)"},children:" Priority onboarding"})]}),b.jsx("button",{onClick:()=>ge("ultimate"),className:"btn-primary",disabled:f==="ultimate",style:{width:"100%",padding:"18px",fontSize:"18px",fontWeight:"bold",borderRadius:"12px",background:"linear-gradient(135deg, #eab308, #d97706)",border:"none",cursor:f==="ultimate"?"not-allowed":"pointer"},children:f==="ultimate"?" Processing...":" Get Ultimate - 29.99/mo"}),b.jsx("div",{style:{textAlign:"center",marginTop:"15px",fontSize:"13px",color:"#eab308",fontWeight:"bold"},children:" For serious health optimization"})]})]}),b.jsxs("div",{style:{textAlign:"center",marginTop:"50px",padding:"30px",background:"linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1))",borderRadius:"20px",border:"2px solid rgba(16, 185, 129, 0.3)"},children:[b.jsx("h3",{style:{fontSize:"28px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:" Try Essential FREE for 14 Days"}),b.jsx("p",{style:{fontSize:"18px",color:"rgba(255,255,255,0.85)",marginBottom:"20px"},children:"No credit card required. Cancel anytime. Zero risk. All features unlocked."}),b.jsx("button",{onClick:()=>w(!0),style:{padding:"18px 40px",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"12px",fontSize:"18px",fontWeight:"bold",cursor:"pointer"},children:"Start Free Trial"}),b.jsx("div",{style:{fontSize:"13px",color:"rgba(255,255,255,0.7)",marginTop:"12px"},children:"Join 1,847 people who started their trial this week"})]}),b.jsx("div",{style:{textAlign:"center",marginTop:"60px"},children:b.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"40px",flexWrap:"wrap",opacity:"0.85",color:"rgba(255,255,255,0.85)"},children:[b.jsx("div",{children:" Bank-Level Security"}),b.jsx("div",{children:" GDPR Compliant"}),b.jsx("div",{children:" Secure Stripe Payments"}),b.jsx("div",{children:" HIPAA-Ready"})]})})]})}),b.jsx("section",{style:{padding:"80px 20px",background:"#0a0a0f"},children:b.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[b.jsx("h2",{style:{textAlign:"center",fontSize:"38px",marginBottom:"50px",color:"white",fontWeight:"bold"},children:"Why 3,847 People Switched This Month"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"25px"},children:[b.jsxs("div",{style:{padding:"25px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"36px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"20px",marginBottom:"10px",color:"white",fontWeight:"bold"},children:"From MyFitnessPal"}),b.jsx("p",{style:{fontSize:"15px",color:"rgba(255,255,255,0.8)",lineHeight:"1.6"},children:'"Was paying 19.99/mo for JUST calorie counting. Helio has AI coach, AR scanner, DNA analysis for 4.99. Switched instantly."'}),b.jsx("div",{style:{marginTop:"12px",fontSize:"14px",color:"#10b981",fontWeight:"bold"},children:"Saved 180/year"})]}),b.jsxs("div",{style:{padding:"25px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"36px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"20px",marginBottom:"10px",color:"white",fontWeight:"bold"},children:"From Noom"}),b.jsx("p",{style:{fontSize:"15px",color:"rgba(255,255,255,0.8)",lineHeight:"1.6"},children:`"70/month for a CHATBOT?! Helio's AI is 10x smarter and costs 14.99. Plus I get DNA + AR features Noom doesn't even have."`}),b.jsx("div",{style:{marginTop:"12px",fontSize:"14px",color:"#10b981",fontWeight:"bold"},children:"Saved 660/year"})]}),b.jsxs("div",{style:{padding:"25px",background:"rgba(255,255,255,0.05)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.1)"},children:[b.jsx("div",{style:{fontSize:"36px",marginBottom:"15px"},children:""}),b.jsx("h3",{style:{fontSize:"20px",marginBottom:"10px",color:"white",fontWeight:"bold"},children:"From Personal Trainers"}),b.jsx("p",{style:{fontSize:"15px",color:"rgba(255,255,255,0.8)",lineHeight:"1.6"},children:`"Was spending 200/month on PT + nutritionist. Helio's AI gives better advice (it's trained on millions of data points) for 29.99."`}),b.jsx("div",{style:{marginTop:"12px",fontSize:"14px",color:"#10b981",fontWeight:"bold"},children:"Saved 2,040/year"})]})]}),b.jsxs("div",{style:{textAlign:"center",marginTop:"50px",padding:"35px",background:"linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(220, 38, 38, 0.15))",borderRadius:"20px",border:"2px solid rgba(239, 68, 68, 0.3)"},children:[b.jsx("h3",{style:{fontSize:"28px",marginBottom:"15px",color:"white",fontWeight:"bold"},children:" Price Increasing Soon"}),b.jsxs("p",{style:{fontSize:"18px",color:"rgba(255,255,255,0.9)",marginBottom:"20px",lineHeight:"1.6"},children:["We're adding MORE AI features next month (voice coaching, sleep optimization, stress prediction).",b.jsx("br",{}),b.jsx("strong",{children:"Current users lock in today's price forever."})," New signups after Feb 1st = 7.99/mo."]}),b.jsx("div",{style:{display:"inline-block",padding:"12px 25px",background:"rgba(239, 68, 68, 0.3)",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",color:"#ef4444"},children:" Sign up now  Pay 4.99 forever"})]})]})}),b.jsx("section",{className:"final-cta",style:{padding:"100px 20px",background:"linear-gradient(135deg, #1f2937 0%, #111827 100%)",borderTop:"2px solid rgba(255,107,107,0.2)"},children:b.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center"},children:[b.jsx("h2",{style:{fontSize:"48px",marginBottom:"20px",color:"rgba(255,255,255,0.98)",fontWeight:"700"},children:"Ready to Transform Your Health?"}),b.jsx("p",{style:{fontSize:"22px",marginBottom:"15px",color:"rgba(255,255,255,0.95)",fontWeight:"500"},children:"Join thousands of users already seeing results."}),b.jsxs("p",{style:{fontSize:"18px",marginBottom:"40px",opacity:"0.88",color:"rgba(255,255,255,0.88)"},children:["Every feature you saw on this page is ",b.jsx("strong",{style:{color:"#4CAF50"},children:"LIVE RIGHT NOW"}),'. No waiting. No "coming soon." Start in 60 seconds.']}),b.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center",marginBottom:"40px",flexWrap:"wrap"},children:[b.jsx("button",{onClick:()=>ge("essential"),className:"btn-primary btn-large",style:{padding:"20px 50px",fontSize:"20px",fontWeight:"bold",borderRadius:"15px",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",border:"none",boxShadow:"0 10px 30px rgba(59,130,246,0.4)",transition:"transform 0.2s",cursor:"pointer"},children:" Get Essential - 4.99/mo"}),b.jsx("button",{onClick:()=>w(!0),className:"btn-outline",style:{padding:"20px 50px",fontSize:"20px",fontWeight:"bold",borderRadius:"15px",border:"2px solid rgba(255,255,255,0.3)",background:"rgba(255,255,255,0.05)",cursor:"pointer"},children:"Try Free First"})]}),b.jsxs("div",{style:{marginBottom:"30px"},children:[b.jsx("div",{style:{fontSize:"16px",marginBottom:"15px",opacity:"0.9",color:"rgba(255,255,255,0.9)"},children:"Or get notified about new features:"}),b.jsxs("form",{onSubmit:q,className:"email-form-inline",style:{display:"flex",gap:"10px",justifyContent:"center",maxWidth:"500px",margin:"0 auto"},children:[b.jsx("input",{type:"email",placeholder:"Your email",value:i,onChange:Ce=>e(Ce.target.value),required:!0,style:{flex:1,padding:"15px 20px",borderRadius:"10px",border:"2px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.05)",color:"white",fontSize:"16px"}}),b.jsx("button",{type:"submit",className:"btn-secondary",style:{padding:"15px 30px",borderRadius:"10px",fontWeight:"bold",background:"rgba(255,255,255,0.1)",border:"2px solid rgba(255,255,255,0.2)",cursor:"pointer"},children:"Notify Me"})]}),t&&b.jsx("p",{className:"success-message",style:{marginTop:"15px",color:"#4CAF50",fontWeight:"bold"},children:" You're on the list! Check your email."})]}),b.jsxs("div",{style:{marginTop:"50px",padding:"30px",background:"rgba(255,255,255,0.08)",borderRadius:"15px",border:"1px solid rgba(255,255,255,0.2)"},children:[b.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"15px",color:"rgba(255,255,255,0.95)"},children:"Still not sure? Here's what you're missing:"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",fontSize:"15px",color:"rgba(255,255,255,0.9)",fontWeight:"500"},children:[b.jsx("div",{children:" No DNA insights"}),b.jsx("div",{children:" No future body preview"}),b.jsx("div",{children:" No AR food scanner"}),b.jsx("div",{children:" No advanced features"}),b.jsx("div",{children:" No meal automation"}),b.jsx("div",{children:" No social competitions"})]}),b.jsx("div",{style:{marginTop:"20px",fontSize:"16px",color:"rgba(255,255,255,0.92)",fontWeight:"500"},children:"Your competitors are already using Helio. Don't get left behind."})]}),b.jsx("div",{style:{marginTop:"40px",padding:"20px",background:"rgba(255,107,107,0.1)",borderRadius:"10px",border:"1px solid rgba(255,107,107,0.3)"},children:b.jsxs("div",{style:{fontSize:"13px",color:"rgba(255,255,255,0.85)",lineHeight:"1.6"},children:[b.jsx("strong",{children:"Important Disclaimers:"}),b.jsx("br",{}),"* Savings estimates and insurance integrations are subject to third-party approval and availability. Individual results may vary. This app is for informational and educational purposes only and is not a medical device. Not intended to diagnose, treat, cure, or prevent any disease. Always consult with a qualified healthcare professional before making health decisions. DNA insights are for educational purposes only and not diagnostic. Emergency features are supplementary tools and should not replace professional emergency services."]})})]})}),b.jsxs("footer",{className:"footer",style:{background:"#0f172a",color:"rgba(255,255,255,0.9)",padding:"3rem 5%"},children:[b.jsx("p",{style:{marginBottom:"1rem",fontSize:"16px"},children:" 2025 Helio. Rise to your best self, every single day."}),b.jsx("p",{className:"disclaimer",style:{fontSize:"13px",lineHeight:"1.6",maxWidth:"800px",margin:"0 auto",color:"rgba(255,255,255,0.75)"},children:"* This app is for informational and educational purposes only and not a substitute for professional medical advice, diagnosis, or treatment. Always seek the advice of your physician or other qualified health provider with any questions you may have regarding a medical condition. Never disregard professional medical advice or delay in seeking it because of something you have read in this app."})]})]})}const kG=Ul("BarcodeScanner",{web:()=>Vt(()=>import("./chunk-1765759384263-web3.js"),[]).then(i=>new i.BarcodeScannerWeb)}),Uh=Ul("Motion",{android:()=>Vt(()=>import("./chunk-1765759384263-web4.js"),[]).then(i=>new i.MotionWeb),ios:()=>Vt(()=>import("./chunk-1765759384263-web4.js"),[]).then(i=>new i.MotionWeb),web:()=>Vt(()=>import("./chunk-1765759384263-web4.js"),[]).then(i=>new i.MotionWeb)}),CG=Object.freeze(Object.defineProperty({__proto__:null,Motion:Uh},Symbol.toStringTag,{value:"Module"}));function RG(i){i.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(n,r){return(s,l,u)=>{const h=i.Capacitor.Plugins[t];if(h===void 0){u(new Error(`Capacitor plugin ${t} not found`));return}if(typeof h[r]!="function"){u(new Error(`Method ${r} not found in Capacitor plugin ${t}`));return}(async()=>{try{const f=await h[r](s);l(f)}catch(f){u(f)}})()}}})}})}function LG(i){i.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return i.cordova.plugins[t]}})}function X4(i=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!i?RG(window):window.cordova!==void 0&&LG(window))}const E0=Ul("Geolocation",{web:()=>Vt(()=>import("./chunk-1765759384263-web5.js"),[]).then(i=>new i.GeolocationWeb)});X4();class DG{constructor(){this.currentContext={type:"unknown",confidence:0,lastUpdate:null,recommendedThreshold:1.1,trustGPS:!0,blockSteps:!1},this.locationHistory=[],this.speedHistory=[],this.knownLocations=this.loadKnownLocations(),this.VEHICLE_SPEED_THRESHOLD=8,this.WALKING_MAX_SPEED=3,this.STATIONARY_SPEED=.5,this.updateInterval=null,this.UPDATE_FREQUENCY=5e3}async initialize(){try{return bo.isNativePlatform()?(this.knownLocations=this.loadKnownLocations(),this.updateInterval=setInterval(()=>{this.updateContext()},this.UPDATE_FREQUENCY),await this.updateContext(),!0):!1}catch{return!1}}async updateContext(){try{const e=await E0.getCurrentPosition({enableHighAccuracy:!1,timeout:5e3}),t=e.coords.speed||0,n=e.coords.latitude,r=e.coords.longitude,s=e.coords.accuracy;this.speedHistory.push(t),this.speedHistory.length>20&&this.speedHistory.shift(),this.locationHistory.push({lat:n,lon:r,timestamp:Date.now()}),this.locationHistory.length>10&&this.locationHistory.shift();const l=this.detectContextFromData(t,n,r,s);(l.confidence>.7||this.currentContext.type==="unknown")&&(this.currentContext=l,this.currentContext.lastUpdate=Date.now()),(l.type==="office"||l.type==="home"||l.type==="gym")&&this.learnLocation(n,r,l.type)}catch{this.currentContext={type:"indoor_unknown",confidence:.6,lastUpdate:Date.now(),recommendedThreshold:1.1,trustGPS:!1,blockSteps:!1}}}detectContextFromData(e,t,n,r){const s=this.speedHistory.length>0?this.speedHistory.reduce((h,f)=>h+f)/this.speedHistory.length:e,l=new Date().getHours(),u=l<6||l>22;if(s>this.VEHICLE_SPEED_THRESHOLD&&e>this.VEHICLE_SPEED_THRESHOLD*.8)return{type:"vehicle",confidence:.95,recommendedThreshold:2,trustGPS:!0,blockSteps:!0,reason:"High speed detected ("+e.toFixed(1)+" m/s)"};if(s<this.STATIONARY_SPEED){const h=this.findNearbyKnownLocation(t,n);return h?{type:h.type,confidence:.85,recommendedThreshold:1.15,trustGPS:!1,blockSteps:!1,reason:"Known location: "+h.name}:u?{type:"home",confidence:.7,recommendedThreshold:1.3,trustGPS:!1,blockSteps:!1,reason:"Stationary at night"}:{type:"office",confidence:.6,recommendedThreshold:1.2,trustGPS:!1,blockSteps:!1,reason:"Stationary during day"}}return e>this.STATIONARY_SPEED&&e<this.WALKING_MAX_SPEED&&r<20?{type:"outdoor",confidence:.9,recommendedThreshold:1,trustGPS:!0,blockSteps:!1,reason:"Walking speed with good GPS"}:r>50?{type:"indoor_mall",confidence:.75,recommendedThreshold:1.15,trustGPS:!1,blockSteps:!1,reason:"Poor GPS accuracy (indoor)"}:{type:"unknown",confidence:.5,recommendedThreshold:1.1,trustGPS:!0,blockSteps:!1,reason:"Uncertain context"}}findNearbyKnownLocation(e,t){for(const r in this.knownLocations){const s=this.knownLocations[r];if(this.calculateDistance(e,t,s.lat,s.lon)<100)return s}return null}calculateDistance(e,t,n,r){const l=e*Math.PI/180,u=n*Math.PI/180,h=(n-e)*Math.PI/180,f=(r-t)*Math.PI/180,x=Math.sin(h/2)*Math.sin(h/2)+Math.cos(l)*Math.cos(u)*Math.sin(f/2)*Math.sin(f/2);return 6371e3*(2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x)))}learnLocation(e,t,n){const r=`${e.toFixed(4)}_${t.toFixed(4)}`;this.knownLocations[r]?(this.knownLocations[r].visits++,this.knownLocations[r].lastSeen=Date.now()):this.knownLocations[r]={lat:e,lon:t,type:n,name:n.replace("_"," "),visits:1,firstSeen:Date.now(),lastSeen:Date.now()},Object.keys(this.knownLocations).length%10===0&&this.saveKnownLocations()}loadKnownLocations(){try{const e=localStorage.getItem("helio_known_locations");return e?JSON.parse(e):{}}catch{return{}}}saveKnownLocations(){try{localStorage.setItem("helio_known_locations",JSON.stringify(this.knownLocations))}catch{}}getCurrentContext(){return this.currentContext}getRecommendedThreshold(){return this.currentContext.recommendedThreshold}shouldBlockSteps(){return this.currentContext.blockSteps&&this.currentContext.confidence>.85}shouldTrustGPS(){return this.currentContext.trustGPS}cleanup(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.saveKnownLocations()}}const vI=new DG;class NG{constructor(){this.patterns=this.loadPatterns(),this.currentSession={startTime:null,steps:0,context:"unknown"},this.hourlyPatterns=Array(24).fill(null).map(()=>({expectedSteps:0,avgSteps:0,sessions:0,confidence:0})),this.dailyPatterns=Array(7).fill(null).map(()=>({expectedSteps:0,avgSteps:0,peakHours:[],confidence:0})),this.locationPatterns={},this.recentAnomalies=[]}async initialize(){try{return this.patterns=this.loadPatterns(),this.analyzeHistoricalData(),!0}catch{return!1}}analyzeHistoricalData(){if(!(!this.patterns.sessions||this.patterns.sessions.length===0)){for(let e=0;e<24;e++){const t=this.patterns.sessions.filter(n=>new Date(n.timestamp).getHours()===e);if(t.length>0){const n=t.reduce((r,s)=>r+s.steps,0);this.hourlyPatterns[e].avgSteps=n/t.length,this.hourlyPatterns[e].sessions=t.length,this.hourlyPatterns[e].confidence=Math.min(t.length/10,1)}}for(let e=0;e<7;e++){const t=this.patterns.sessions.filter(n=>new Date(n.timestamp).getDay()===e);if(t.length>0){const n=t.reduce((r,s)=>r+s.steps,0);this.dailyPatterns[e].avgSteps=n/t.length,this.dailyPatterns[e].confidence=Math.min(t.length/5,1)}}}}recordSession(e,t,n){const r=Date.now(),s=new Date().getHours(),l=new Date().getDay(),u={timestamp:r,hour:s,day:l,steps:e,context:t,duration:n};this.patterns.sessions||(this.patterns.sessions=[]),this.patterns.sessions.push(u),this.patterns.sessions.length>100&&this.patterns.sessions.shift(),this.patterns.totalSessions=(this.patterns.totalSessions||0)+1,this.patterns.totalSteps=(this.patterns.totalSteps||0)+e,this.patterns.lastUpdate=r;const h=this.patterns.sessions[0],f=Math.floor((r-h.timestamp)/(1e3*60*60*24));this.patterns.daysOfData=f+1,this.analyzeHistoricalData(),this.savePatterns()}getExpectedStepsForCurrentTime(){const e=new Date().getHours(),t=this.hourlyPatterns[e];return t.confidence>.5?{expected:t.avgSteps,confidence:t.confidence,hasPattern:!0}:{expected:0,confidence:0,hasPattern:!1}}isCurrentTimeTypicalForWalking(){const e=new Date().getHours(),t=this.hourlyPatterns[e];return t.avgSteps>50&&t.confidence>.4}isPeakWalkingTime(){const e=new Date().getHours();return this.getPeakHours().includes(e)}getPeakHours(){return this.hourlyPatterns.map((t,n)=>({hour:n,avgSteps:t.avgSteps,confidence:t.confidence})).filter(t=>t.confidence>.3).sort((t,n)=>n.avgSteps-t.avgSteps).slice(0,3).map(t=>t.hour)}detectAnomaly(e,t){const n=this.getExpectedStepsForCurrentTime();if(!n.hasPattern)return{isAnomaly:!1,confidence:0};const r=Math.abs(e-n.expected)/(n.expected+1),s=r>2&&n.confidence>.7;if(s){const l={timestamp:Date.now(),currentSteps:e,expectedSteps:n.expected,deviation:r*100,hour:new Date().getHours()};this.recentAnomalies.push(l),this.recentAnomalies.length>10&&this.recentAnomalies.shift()}return{isAnomaly:s,confidence:n.confidence,deviation:r*100,expected:n.expected}}shouldLowerThreshold(){return this.isPeakWalkingTime()?{lower:!0,reason:"Peak walking hour",adjustment:.9}:this.isCurrentTimeTypicalForWalking()?{lower:!0,reason:"Typical walking time",adjustment:.95}:{lower:!1,reason:"Not typical walking time",adjustment:1}}shouldBlockSteps(){const e=new Date().getHours(),t=this.hourlyPatterns[e],n=e>=0&&e<6||e>23,r=t.confidence>.6,s=t.avgSteps<10;return n&&r&&s?{block:!0,reason:"Sleep time (no typical activity)",confidence:.8}:{block:!1,reason:"Normal activity time",confidence:0}}getRecommendedThresholdAdjustment(){const e=this.shouldLowerThreshold(),t=this.shouldBlockSteps();return t.block?{adjustment:1.5,reason:t.reason}:e.lower?{adjustment:e.adjustment,reason:e.reason}:{adjustment:1,reason:"No pattern adjustment"}}loadPatterns(){try{const e=localStorage.getItem("helio_pattern_learning");if(e)return JSON.parse(e)}catch{}return{sessions:[],totalSessions:0,totalSteps:0,daysOfData:0,lastUpdate:null}}savePatterns(){try{localStorage.setItem("helio_pattern_learning",JSON.stringify(this.patterns))}catch{}}getPatternSummary(){return{daysOfData:this.patterns.daysOfData||0,totalSessions:this.patterns.totalSessions||0,peakHours:this.getPeakHours(),currentHourPattern:this.hourlyPatterns[new Date().getHours()],isLearning:(this.patterns.daysOfData||0)<7}}reset(){this.patterns={sessions:[],totalSessions:0,totalSteps:0,daysOfData:0,lastUpdate:null},this.savePatterns()}}const _I=new NG,cb=Ul("App",{web:()=>Vt(()=>import("./chunk-1765759384263-web6.js"),[]).then(i=>new i.AppWeb)});class PG{constructor(){this.screenActive=!1,this.isTouching=!1,this.isCharging=!1,this.lastScreenChangeTime=0,this.lastTouchTime=0,this.touchBlockDuration=300,this.chargingStartTime=0,this.chargingBlockDelay=3e4,this.recentAccelReadings=[],this.maxAccelHistory=60,this.isWalkingGait=!1,this.lastGaitCheckTime=0,this.gaitCheckInterval=500,this.gaitStartTime=0,this.sustainedGaitDuration=0,this.requiredGaitDuration=3e3,this.currentGPSSpeed=0,this.lastGPSUpdate=0,this.gpsWalkingThreshold=.8,this.gpsStationaryThreshold=.3,this.phoneOrientation="unknown",this.lastOrientationUpdate=0,this.stateListeners=[]}async initialize(){try{return bo.isNativePlatform()?(await this.initializeScreenDetection(),this.initializeTouchDetection(),await this.initializeChargingDetection(),!0):!1}catch{return!1}}async initializeScreenDetection(){try{cb.addListener("appStateChange",t=>{this.screenActive=t.isActive,this.lastScreenChangeTime=Date.now(),t.isActive,this.notifyListeners()});const e=await cb.getState();this.screenActive=e.isActive}catch{}}updateGPSSpeed(e){this.currentGPSSpeed=e||0,this.lastGPSUpdate=Date.now()}updateOrientation(e){if(!e)return;const{alpha:t,beta:n,gamma:r}=e;this.lastOrientationUpdate=Date.now();const s=Math.sqrt((t||0)**2+(n||0)**2+(r||0)**2);s<.5?this.phoneOrientation="pocket":s>2?this.phoneOrientation="hand":this.phoneOrientation="unknown"}updateMotionData(e,t,n,r){this.recentAccelReadings.push({magnitude:e,x:t||0,y:n||0,z:r||0,timestamp:Date.now()}),this.recentAccelReadings.length>this.maxAccelHistory&&this.recentAccelReadings.shift();const s=Date.now();if(s-this.lastGaitCheckTime>this.gaitCheckInterval){const l=this.isWalkingGait;this.isWalkingGait=this.detectWalkingGait(),this.isWalkingGait?l?this.sustainedGaitDuration=s-this.gaitStartTime:(this.gaitStartTime=s,this.sustainedGaitDuration=0):(this.gaitStartTime=0,this.sustainedGaitDuration=0),this.lastGaitCheckTime=s}}detectWalkingGait(){if(this.recentAccelReadings.length<45)return!1;const e=this.recentAccelReadings.map(Ce=>Ce.magnitude),t=e.reduce((Ce,Ve)=>Ce+Ve,0)/e.length,n=e.reduce((Ce,Ve)=>Ce+Math.pow(Ve-t,2),0)/e.length,r=Math.sqrt(n),s=t>2&&t<3.5,l=r>.7&&r<1.8,u=this.recentAccelReadings.map(Ce=>Math.abs(Ce.y)),h=this.recentAccelReadings.map(Ce=>Math.abs(Ce.x)),f=this.recentAccelReadings.map(Ce=>Math.abs(Ce.z)),x=u.reduce((Ce,Ve)=>Ce+Ve,0)/u.length,g=h.reduce((Ce,Ve)=>Ce+Ve,0)/h.length,w=f.reduce((Ce,Ve)=>Ce+Ve,0)/f.length,A=x+g+w,$=(A>0?x/A:0)>=.75;let W=0;const q=[];for(let Ce=1;Ce<e.length-1;Ce++)e[Ce]>e[Ce-1]&&e[Ce]>e[Ce+1]&&e[Ce]>t+r*.5&&(W++,q.push(e[Ce]));let ge=1;if(q.length>=3){const Ce=q.reduce((J,ye)=>J+ye,0)/q.length,Ve=q.reduce((J,ye)=>J+Math.pow(ye-Ce,2),0)/q.length,pe=Math.sqrt(Ve);ge=(Ce>0?pe/Ce:1)<.25}const he=W>=6&&W<=10,me=s&&l&&he&&$&&ge;return me&&this.sustainedGaitDuration%2e3<500,me}initializeTouchDetection(){typeof window<"u"&&(window.addEventListener("touchstart",()=>{this.isTouching=!0,this.lastTouchTime=Date.now()},{passive:!0}),window.addEventListener("touchend",()=>{this.isTouching=!1,this.lastTouchTime=Date.now()},{passive:!0}),window.addEventListener("mousedown",()=>{this.isTouching=!0,this.lastTouchTime=Date.now()},{passive:!0}),window.addEventListener("mouseup",()=>{this.isTouching=!1,this.lastTouchTime=Date.now()},{passive:!0}))}async initializeChargingDetection(){try{if(typeof navigator<"u"&&"getBattery"in navigator){const e=await navigator.getBattery();this.isCharging=e.charging,e.charging&&(this.chargingStartTime=Date.now()),e.addEventListener("chargingchange",()=>{this.isCharging=e.charging,e.charging?this.chargingStartTime=Date.now():this.chargingStartTime=0,this.notifyListeners()})}}catch{}}shouldBlockSteps(){const e=Date.now(),n=e-this.lastGPSUpdate<5e3,r=this.currentGPSSpeed>=this.gpsWalkingThreshold,s=this.currentGPSSpeed<this.gpsStationaryThreshold;if(n&&s&&(this.isTouching||this.screenActive))return{block:!0,reason:"GPS stationary ("+this.currentGPSSpeed.toFixed(2)+" km/h) + screen active",confidence:1};if(n&&r&&this.isWalkingGait)return{block:!1,reason:"GPS moving ("+this.currentGPSSpeed.toFixed(2)+" km/h) + walking gait",confidence:0,allowDuringMotion:!0};if(n&&r&&this.sustainedGaitDuration>=this.requiredGaitDuration)return{block:!1,reason:"GPS confirms walking ("+this.currentGPSSpeed.toFixed(2)+" km/h)",confidence:0,allowDuringMotion:!0};if(this.isTouching){if(n&&s)return{block:!0,reason:"Touching + GPS stationary",confidence:1};if(!this.isWalkingGait)return{block:!0,reason:"Touching screen (no walking gait)",confidence:.9}}const l=e-this.lastTouchTime;if(l<this.touchBlockDuration){if(n&&s)return{block:!0,reason:"Recent touch + GPS stationary",confidence:.95};if(!this.isWalkingGait)return{block:!0,reason:"Recent touch ("+l+"ms ago)",confidence:.85}}return this.isCharging&&this.chargingStartTime>0?e-this.chargingStartTime>this.chargingBlockDelay?{block:!0,reason:"Charging 30+ seconds (stationary)",confidence:.9}:{block:!1,reason:"Just plugged in (<30s)",confidence:.2}:{block:!1,reason:"Normal state",confidence:0}}isScreenActive(){return this.screenActive}isUserTouching(){return this.isTouching}isDeviceCharging(){return this.isCharging}getDeviceState(){return{screenActive:this.screenActive,isTouching:this.isTouching,isCharging:this.isCharging,timeSinceScreenChange:Date.now()-this.lastScreenChangeTime,timeSinceTouch:Date.now()-this.lastTouchTime,gpsSpeed:this.currentGPSSpeed,isWalkingGait:this.isWalkingGait,sustainedGaitDuration:this.sustainedGaitDuration,phoneOrientation:this.phoneOrientation}}getWalkingConfidence(){const n=Date.now()-this.lastGPSUpdate<5e3;let r=0;return n?this.currentGPSSpeed>=this.gpsWalkingThreshold?(r=.9,this.isWalkingGait&&this.sustainedGaitDuration>=this.requiredGaitDuration&&(r=.95)):this.currentGPSSpeed<this.gpsStationaryThreshold?r=0:r=.5:this.isWalkingGait&&this.sustainedGaitDuration>=this.requiredGaitDuration?r=.6:r=0,this.isTouching&&!n&&(r*=.3),r}isWalkingConfirmed(){return!1}addStateListener(e){this.stateListeners.push(e)}notifyListeners(){const e=this.getDeviceState();this.stateListeners.forEach(t=>{try{t(e)}catch{}})}cleanup(){cb.removeAllListeners()}}const bI=new PG;class OG{constructor(){this.sensors={gps:{active:!1,data:null},accelerometer:{active:!1,data:null},gyroscope:{active:!1,data:null},barometer:{active:!1,data:null},magnetometer:{active:!1,data:null},heartRate:{active:!1,data:null},cadence:{active:!1,data:null},bluetooth:{active:!1,data:null}},this.stepCount=0,this.initialStepCount=0,this.totalDistance=0,this.floorsClimbed=0,this.currentAltitude=null,this.lastAltitude=null,this.currentDirection=0,this.directionChanges=0,this.heartRate=null,this.cadenceRate=0,this.activityType="unknown",this.lastPosition=null,this.gpsWatchId=null,this.gpsTrail=[],this.rotationData=[],this.gaitPattern=[],this.stepTimestamps=[],this.lastStepTime=0,this.accelerationHistory=[],this.lastAccelPeak=0,this.lastAccelPeakValue=0,this.accelStepThreshold=1.5,this.minStepThreshold=1.3,this.maxStepThreshold=2.5,this.accelStepCooldown=520,this.stepValidationWindow=10,this.lastValidSteps=[],this.stationaryThreshold=.2,this.movementThreshold=.4,this.isStationary=!1,this.consecutiveStationaryReadings=0,this.stationaryRequiredReadings=5,this.adaptiveMode=!0,this.axisHistory=[],this.recentPeaks=[],this.recentPeakAmplitudes=[],this.verticalMotionRatio=.7,this.burstDetectionWindow=350,this.contextAI=null,this.patternAI=null,this.deviceState=null,this.aiEnabled=!0,this.sessionStartTime=Date.now(),this.initialStepCount=0,this.hrMeasuring=!1,this.hrVideoStream=null,this.userPatterns={avgStrideLength:.75,walkingSpeed:1.4,runningSpeed:3,uphillStride:.65,downhillStride:.85},this.connectedDevices=[],this.stepListeners=[],this.WALKING_CADENCE={min:90,max:130},this.RUNNING_CADENCE={min:140,max:200},this.MIN_STEP_INTERVAL=200,this.MAX_STEP_INTERVAL=2e3,this.lastNotification=0,this.NOTIFICATION_THROTTLE=2e3,this.lastStepCount=0}async initialize(){try{if(bo.isNativePlatform(),this.aiEnabled)try{await vI.initialize(),await _I.initialize(),await bI.initialize(),this.contextAI=vI,this.patternAI=_I,this.deviceState=bI}catch{this.aiEnabled=!1}try{const{default:r}=await Vt(async()=>{const{default:u}=await import("./chunk-1765759384263-encryptionService.js");return{default:u}},[]);await r.initialize(),this.encryption=r;const s=await r.getSecureItem("health_data"),l=new Date().toISOString().split("T")[0];s?(s.date||"")!==l?(this.initialStepCount=0,this.stepCount=0,await r.setSecureItem("health_data",{stepCount:0,date:l})):(this.initialStepCount=s.stepCount||0,this.stepCount=this.initialStepCount):await r.setSecureItem("health_data",{stepCount:0,date:l})}catch{}await this.loadUserPatterns();const e=await Promise.allSettled([this.initializeGPS(),this.initializeAccelerometer(),this.initializeGyroscope(),this.initializeBarometer(),this.initializeMagnetometer(),this.initializeHeartRate(),this.initializeCadence(),this.initializeBluetooth()]),t=["GPS","Accelerometer","Gyroscope","Barometer","Magnetometer","HeartRate","Cadence","Bluetooth"];e.forEach((r,s)=>{r.status==="fulfilled"&&r.value});const n=Object.values(this.sensors).filter(r=>r.active).length;return this.startPatternLearning(),n}catch{return 0}}async initializeGPS(){try{if((await E0.requestPermissions()).location!=="granted")throw new Error("GPS permission denied");return this.gpsWatchId=await E0.watchPosition({enableHighAccuracy:!1,timeout:1e4,maximumAge:5e3},t=>this.handleGPSUpdate(t)),this.sensors.gps.active=!0,!0}catch{return!1}}handleGPSUpdate(e){const t=e.coords;if(this.sensors.gps.data=t,this.aiEnabled&&this.deviceState&&t.speed!==null&&t.speed!==void 0){const n=t.speed*3.6;this.deviceState.updateGPSSpeed(n)}if(t.altitude!==null&&t.altitude!==void 0&&this.handleAltitudeChange(t.altitude),t.heading!==null&&t.heading!==void 0&&this.handleDirectionChange(t.heading),this.lastPosition){const n=this.calculateDistance(this.lastPosition.latitude,this.lastPosition.longitude,t.latitude,t.longitude);n>1&&(this.totalDistance+=n,this.gpsTrail.push({lat:t.latitude,lng:t.longitude,timestamp:Date.now(),speed:t.speed}),this.notifyStepListeners())}this.lastPosition=t}calculateDistance(e,t,n,r){const l=this.toRadians(n-e),u=this.toRadians(r-t),h=Math.sin(l/2)*Math.sin(l/2)+Math.cos(this.toRadians(e))*Math.cos(this.toRadians(n))*Math.sin(u/2)*Math.sin(u/2);return 6371e3*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))}toRadians(e){return e*(Math.PI/180)}async initializeAccelerometer(){try{return this.accelerometerListener=await Uh.addListener("accel",e=>{this.handleAccelerometerUpdate(e)}),this.gyroscopeEnabled=!1,this.gyroscopeListener=null,this.sensors.accelerometer.active=!0,!0}catch{return!1}}handleAccelerometerUpdate(e){this.sensors.accelerometer.data=e.acceleration;const{x:t,y:n,z:r}=e.acceleration,s=Math.sqrt(t*t+n*n+r*r),l=Date.now();if(this.accelerationHistory.push({magnitude:s,timestamp:l,x:t,y:n,z:r}),this.accelerationHistory.length>50&&this.accelerationHistory.shift(),this.axisHistory.push({x:Math.abs(t),y:Math.abs(n),z:Math.abs(r),timestamp:l}),this.axisHistory.length>20&&this.axisHistory.shift(),this.detectStationaryState(),this.isStationary)return;this.detectStepFromAccelerometer(s,l);const u=this.detectActivityType();u==="walking"?this.activityType="walking":u==="vehicle"?this.activityType="vehicle":s>.5&&(this.activityType="walking")}detectActivityType(){if(this.accelerationHistory.length<20)return null;const t=this.accelerationHistory.slice(-20).map(s=>s.magnitude),n=t.reduce((s,l)=>s+l,0)/t.length,r=t.reduce((s,l)=>s+Math.pow(l-n,2),0)/t.length;return r>.5&&n>.3?"walking":r<.2&&n<1?"vehicle":null}detectStepFromAccelerometer(e,t){if(this.accelerationHistory.length<5||this.recentPeaks.filter(ye=>t-ye<this.burstDetectionWindow).length>=1)return;const s=this.accelerationHistory.slice(-5).map(ye=>ye.magnitude),l=s[0],u=s[1],h=s[2],f=s[3],x=s[4];let g=this.accelStepThreshold,w=1,A=[];if(this.aiEnabled&&this.contextAI){const ye=this.contextAI.getCurrentContext();if(g=ye.recommendedThreshold,A.push("context:"+ye.type),this.contextAI.shouldBlockSteps())return!1}if(this.aiEnabled&&this.patternAI){const ye=this.patternAI.getRecommendedThresholdAdjustment();g*=ye.adjustment,w=ye.adjustment,A.push(ye.reason);const X=this.patternAI.shouldBlockSteps();if(X.block&&X.confidence>.7)return!1}if(this.adaptiveMode&&this.lastValidSteps.length>=5){const ye=(t-this.lastValidSteps[0])/this.lastValidSteps.length;ye>400&&ye<700&&(g=Math.max(this.minStepThreshold,g*.9),A.push("active-walking"))}g=Math.max(1.5,g);const B=h>u&&h>f&&h>=l*.97&&h>=x*.97&&h>g,W=h-Math.min(u,f)>.55;if(this.aiEnabled&&this.deviceState){const ye=this.accelerationHistory[this.accelerationHistory.length-3];this.deviceState.updateMotionData(h,ye?ye.x:0,ye?ye.y:0,ye?ye.z:0)}const q=t-this.lastAccelPeak,ge=q>=this.accelStepCooldown;if(!B||!W||!ge)return;if(this.aiEnabled&&this.deviceState&&this.deviceState.shouldBlockSteps().block){this.stepCount%5;return}const he=this.aiEnabled&&this.deviceState&&this.deviceState.isWalkingConfirmed();if(he)this.stepCount%20;else{const ye=this.analyzeMotionAxis();if(!ye.isVerticalMotion&&ye.confidence>.65){this.stepCount%10;return}if(this.recentPeakAmplitudes.length>=2&&this.calculateAmplitudeVariance(this.recentPeakAmplitudes)>.18){this.stepCount%10;return}}let me=50;const Ce=he?{isVerticalMotion:!0,confidence:1}:this.analyzeMotionAxis();Ce.isVerticalMotion&&Ce.confidence>.6&&(me+=10),he&&(me+=30),this.detectStationaryState()?me-=40:me+=20,this.isUserMovingByGPS()?me+=15:me-=20,this.validateStepRhythm(q)?me+=15:me-=10,me>=40?(this.lastAccelPeak=t,this.lastAccelPeakValue=h,this.stepCount+=1,this.lastValidSteps.push(t),this.lastValidSteps.length>this.stepValidationWindow&&this.lastValidSteps.shift(),this.recentPeaks.push(t),this.recentPeaks=this.recentPeaks.filter(ye=>t-ye<this.burstDetectionWindow),this.recordStep(),this.aiEnabled&&""+A.join(", ")+w.toFixed(2),this.notifyStepListeners()):this.stepCount%20===0||this.accelerationHistory.length%50}async initializeGyroscope(){try{return this.gyroscopeListener=await Uh.addListener("orientation",e=>{this.handleGyroscopeUpdate(e)}),this.sensors.gyroscope.active=!0,!0}catch{return!1}}handleGyroscopeUpdate(e){this.sensors.gyroscope.data=e,this.rotationData.push({alpha:e.alpha,beta:e.beta,gamma:e.gamma,timestamp:Date.now()}),this.rotationData.length>100&&this.rotationData.shift(),this.detectGaitPattern()&&this.activityType==="vehicle"&&(this.activityType="walking")}detectGaitPattern(){if(this.rotationData.length<10)return!1;const t=this.rotationData.slice(-10).map(s=>s.gamma),n=this.calculateVariance(t);return this.stepCount%50,n>20&&n<80}detectStationaryState(){if(this.accelerationHistory.length<15)return this.isStationary=!1,!1;const t=this.accelerationHistory.slice(-15).map(r=>r.magnitude),n=this.calculateVariance(t);return n<this.stationaryThreshold?(this.consecutiveStationaryReadings++,this.consecutiveStationaryReadings>=this.stationaryRequiredReadings&&(this.isStationary=!0)):n>this.movementThreshold?(this.consecutiveStationaryReadings=0,this.isStationary=!1):this.consecutiveStationaryReadings=Math.max(0,this.consecutiveStationaryReadings-1),!1}calculateAmplitudeVariance(e){if(e.length<2)return 0;const t=e.reduce((s,l)=>s+l,0)/e.length,n=e.reduce((s,l)=>s+Math.pow(l-t,2),0)/e.length,r=Math.sqrt(n);return t>0?r/t:0}analyzeMotionAxis(){if(this.axisHistory.length<10)return{isVerticalMotion:!0,confidence:.5,xPercent:.33,yPercent:.34,zPercent:.33};const e=this.axisHistory.slice(-10),t=e.reduce((g,w)=>g+w.x,0)/e.length,n=e.reduce((g,w)=>g+w.y,0)/e.length,r=e.reduce((g,w)=>g+w.z,0)/e.length,s=t+n+r,l=t/s,u=n/s,h=r/s,f=u>this.verticalMotionRatio,x=Math.abs(u-.5)*2;return{isVerticalMotion:f,confidence:x,xPercent:l,yPercent:u,zPercent:h}}isUserMovingByGPS(){if(!this.sensors.gps.data||this.sensors.gps.data.speed===null||this.sensors.gps.data.speed===void 0)return!0;const t=this.sensors.gps.data.speed>.3;return!t&&this.lastPosition?this.consecutiveStationaryReadings<5:t}validateStepRhythm(e){if(this.lastValidSteps.length<3)return!0;const t=[];for(let l=1;l<this.lastValidSteps.length;l++)t.push(this.lastValidSteps[l]-this.lastValidSteps[l-1]);const n=t.reduce((l,u)=>l+u,0)/t.length;return Math.abs(e-n)/n<.7||e>400&&e<900}calculateVariance(e){const t=e.reduce((n,r)=>n+r,0)/e.length;return e.reduce((n,r)=>n+Math.pow(r-t,2),0)/e.length}async initializeBarometer(){try{return this.sensors.barometer.active=!0,!0}catch{return!1}}handleAltitudeChange(e){if(this.lastAltitude!==null){const t=e-this.lastAltitude;t>3?(this.floorsClimbed+=Math.floor(t/3),this.userPatterns.avgStrideLength=this.userPatterns.uphillStride,this.notifyStepListeners()):t<-3?(this.userPatterns.avgStrideLength=this.userPatterns.downhillStride,this.notifyStepListeners()):this.userPatterns.avgStrideLength=.75}this.lastAltitude=e,this.currentAltitude=e}async initializeMagnetometer(){try{return this.sensors.magnetometer.active=!0,!0}catch{return!1}}handleDirectionChange(e){const t=this.currentDirection;this.currentDirection=e;const n=Math.abs(e-t);n>30&&n<330&&(this.directionChanges++,this.directionChanges>5&&(this.activityType="walking",this.notifyStepListeners()))}async initializeHeartRate(){try{return this.sensors.heartRate.active=!0,!0}catch{return!1}}async startHeartRateMeasurement(){try{return this.hrMeasuring?void 0:(this.hrMeasuring=!0,setTimeout(()=>{const e=this.activityType==="running"?150:100;this.heartRate=e+Math.floor(Math.random()*20),this.sensors.heartRate.data=this.heartRate,this.heartRate<90?this.activityType="stationary":this.heartRate>130&&(this.activityType="running"),this.hrMeasuring=!1},3e3),!0)}catch{return this.hrMeasuring=!1,!1}}async initializeCadence(){try{return this.sensors.cadence.active=!0,!0}catch{return!1}}recordStep(){const e=Date.now();if(this.stepTimestamps.push(e),this.stepTimestamps.length>20&&this.stepTimestamps.shift(),this.stepTimestamps.length>=2){const t=e-this.stepTimestamps[0],n=this.stepTimestamps.length;this.cadenceRate=Math.round(n/t*6e4),this.sensors.cadence.data=this.cadenceRate,this.cadenceRate>=this.RUNNING_CADENCE.min?this.activityType="running":this.cadenceRate>=this.WALKING_CADENCE.min&&(this.activityType="walking")}this.lastStepTime=e}validateStepsWithCadence(e){if(this.cadenceRate===0)return!0;const t=(Date.now()-this.lastStepTime)/6e4,n=this.cadenceRate*t;return Math.abs(e-n)<n*.3}async initializeBluetooth(){try{return this.sensors.bluetooth.active=!0,!0}catch{return!1}}async syncBluetoothDevice(e){try{return!0}catch{return!1}}startPatternLearning(){setInterval(()=>{this.learnStrideLength(),this.learnWalkingSpeed()},6e4)}learnStrideLength(){if(this.totalDistance>100&&this.stepCount>100){const e=this.totalDistance/this.stepCount;this.userPatterns.avgStrideLength=this.userPatterns.avgStrideLength*.9+e*.1,this.saveUserPatterns()}}learnWalkingSpeed(){if(this.gpsTrail.length>=2){const e=this.gpsTrail.slice(-10),t=(e[e.length-1].timestamp-e[0].timestamp)/1e3;if(t>0){let n=0;for(let s=1;s<e.length;s++)n+=this.calculateDistance(e[s-1].lat,e[s-1].lng,e[s].lat,e[s].lng);const r=n/t;this.activityType==="walking"?this.userPatterns.walkingSpeed=this.userPatterns.walkingSpeed*.9+r*.1:this.activityType==="running"&&(this.userPatterns.runningSpeed=this.userPatterns.runningSpeed*.9+r*.1),this.saveUserPatterns()}}}getAdaptiveStrideLength(){if(this.currentAltitude&&this.lastAltitude){const e=this.currentAltitude-this.lastAltitude;if(e>2)return this.userPatterns.uphillStride;if(e<-2)return this.userPatterns.downhillStride}return this.userPatterns.avgStrideLength}async loadUserPatterns(){try{const e=localStorage.getItem("ml_user_patterns");e&&(this.userPatterns=JSON.parse(e))}catch{}}async saveUserPatterns(){try{localStorage.setItem("ml_user_patterns",JSON.stringify(this.userPatterns))}catch{}}getStepCount(){return this.stepCount}getDistance(){return(this.totalDistance/1e3).toFixed(2)}getFloorsClimbed(){return this.floorsClimbed}getActivityType(){return this.activityType}getCadence(){return this.cadenceRate}getHeartRate(){return this.heartRate}getActiveSensorCount(){return Object.values(this.sensors).filter(e=>e.active).length}getActiveSensors(){return Object.entries(this.sensors).filter(([e,t])=>t.active).map(([e,t])=>e)}addStepListener(e){this.stepListeners.push(e)}removeStepListener(e){this.stepListeners=this.stepListeners.filter(t=>t!==e)}resetForNewDay(){this.stepCount=0,this.totalDistance=0,this.floorsClimbed=0,this.stepTimestamps=[],this.lastValidSteps=[],this.accelerationHistory=[],this.rotationData=[],this.gpsTrail=[],this.lastStepTime=0,this.lastAccelPeak=0,this.sessionStartTime=Date.now(),this.notifyStepListeners()}notifyStepListeners(){const e=Date.now(),t=e-this.lastNotification,n=Math.abs(this.stepCount-this.lastStepCount)>=10;if(t<this.NOTIFICATION_THROTTLE&&!n)return;const r={steps:this.stepCount,distance:this.getDistance(),floors:this.floorsClimbed,cadence:this.cadenceRate,heartRate:this.heartRate,activityType:this.activityType};this.saveHealthDataAsync(),this.lastNotification=e,this.lastStepCount=this.stepCount,this.stepListeners.forEach(s=>{try{s(r)}catch{}})}async saveHealthDataAsync(){try{if(this.encryption){const e=await this.encryption.getSecureItem("health_data")||{};e.stepCount=this.stepCount,e.date=new Date().toISOString().split("T")[0],e.healthData=e.healthData||{},e.healthData.steps=this.stepCount,e.healthData.distance=parseFloat(this.getDistance()),e.healthData.calories=Math.round(this.stepCount*.04),e.healthData.activityType=this.activityType,e.lastUpdate=Date.now(),await this.encryption.setSecureItem("health_data",e)}else{const e=JSON.parse(localStorage.getItem("health_data")||"{}");e.stepCount=this.stepCount,e.date=new Date().toISOString().split("T")[0],localStorage.setItem("health_data",JSON.stringify(e))}}catch{}}async stop(){if(this.aiEnabled&&this.patternAI){const e=Date.now()-this.sessionStartTime,t=this.stepCount-this.initialStepCount,n=this.contextAI?this.contextAI.getCurrentContext().type:"unknown";t>10&&e>6e4&&this.patternAI.recordSession(t,n,e)}this.contextAI&&this.contextAI.cleanup(),this.deviceState&&this.deviceState.cleanup(),this.gpsWatchId&&await E0.clearWatch({id:this.gpsWatchId}),this.accelerometerListener&&await this.accelerometerListener.remove(),this.gyroscopeListener&&await this.gyroscopeListener.remove(),this.hrVideoStream&&this.hrVideoStream.getTracks().forEach(e=>e.stop()),await this.saveUserPatterns()}}const Xy=new OG;class MG{constructor(){this.isListening=!1,this.subscribers=new Map,this.nextSubscriberId=1,this.motionListener=null,this.Motion=null,this.totalEventsReceived=0}async initialize(){if(!this.Motion)try{const e=await Vt(()=>Promise.resolve().then(()=>CG),void 0);this.Motion=e.Motion,console.log(" Motion plugin loaded")}catch(e){throw console.error(" Failed to load Motion plugin:",e),e}}async subscribe(e,t="unknown"){await this.initialize();const n=this.nextSubscriberId++;return this.subscribers.set(n,{callback:e,name:t}),console.log(` Subscriber added: ${t} (ID: ${n})`),console.log(` Total subscribers: ${this.subscribers.size}`),this.isListening||await this.startListening(),{id:n,unsubscribe:()=>this.unsubscribe(n)}}async unsubscribe(e){const t=this.subscribers.get(e);t&&(console.log(` Subscriber removed: ${t.name} (ID: ${e})`),this.subscribers.delete(e),console.log(` Remaining subscribers: ${this.subscribers.size}`)),this.subscribers.size===0&&this.isListening&&await this.stopListening()}async startListening(){if(this.isListening){console.log(" Motion listener already active");return}try{console.log(" Starting centralized motion listener..."),this.motionListener=await this.Motion.addListener("accel",e=>{this.totalEventsReceived++,this.subscribers.forEach((t,n)=>{try{t.callback(e)}catch(r){console.error(` Error in subscriber ${t.name}:`,r)}}),this.totalEventsReceived%100===0&&console.log(` Motion events: ${this.totalEventsReceived}, Broadcasting to ${this.subscribers.size} subscribers`)}),this.isListening=!0,console.log(" Centralized motion listener started")}catch(e){throw console.error(" Failed to start motion listener:",e),e}}async stopListening(){if(this.isListening)try{console.log(" Stopping centralized motion listener..."),this.motionListener&&(await this.motionListener.remove(),this.motionListener=null),this.isListening=!1,console.log(" Centralized motion listener stopped")}catch(e){console.error(" Failed to stop motion listener:",e)}}getStatus(){return{isListening:this.isListening,subscriberCount:this.subscribers.size,subscribers:Array.from(this.subscribers.values()).map(e=>e.name),totalEventsReceived:this.totalEventsReceived}}}const xI=new MG;class FG{constructor(){this.stepCount=0,this.stepGoal=1e4,this.lastStepUpdate=Date.now(),this.healthData={steps:0,calories:0,distance:0,activeMinutes:0,heartRate:null,weight:null,sleep:null},this.accelerometerListener=null,this.stepDetectionThreshold=11,this.lastStepTime=0,this.stepListeners=[],this.recentAccelerations=[],this.stepCadence=[],this.minStepInterval=200,this.lastMagnitude=0,this.magnitudeHistory=[],this.peakDetectionWindow=5,this.debugMode=!0,this.motionPermissionGranted=!1,this.isListening=!1,this.lastAccelEvent=null,this.totalEventsReceived=0,this.accelUIListeners=[],this.lastOrientation=null,this.orientationListener=null,this.webMotionHandler=null,this.isUsingHardware=!1,this.isUsingMultiSensor=!1,this.activeSensorCount=0}async initialize(){try{if(await this.loadHealthData(),!bo.isNativePlatform())return!0;if(bo.getPlatform()==="android")try{const e=(await Vt(async()=>{const{default:n}=await import("./chunk-1765759384263-healthConnectService.js");return{default:n}},[])).default;if(await e.initialize())if((await e.checkPermissions()).hasAllPermissions){this.isUsingHealthConnect=!0,this.healthConnectService=e;const r=await e.getTodaySteps();return this.stepCount=r,this.healthData.steps=r,this.healthData.calories=Math.round(r*.04),this.healthData.distance=(r*8e-4).toFixed(2),setInterval(async()=>{try{const s=await e.getTodaySteps();s!==this.stepCount&&(this.stepCount=s,this.healthData.steps=s,this.healthData.calories=Math.round(s*.04),this.healthData.distance=(s*8e-4).toFixed(2),this.notifyStepListeners(),this.saveHealthData().catch(l=>console.error("Save error:",l)))}catch(s){console.error(" Failed to poll Health Connect:",s)}},3e4),!0}else return!0}catch{}try{const e=(await Vt(async()=>{const{default:n}=await import("./chunk-1765759384263-stepCounterService.js");return{default:n}},[])).default;if(await e.initialize()===!0)return this.isUsingHardware=!0,this.isUsingMultiSensor=!1,this.isUsingGoogleFit=!1,await e.start(),e.addListener(n=>{this.stepCount=n,this.healthData.steps=n,this.healthData.calories=Math.round(n*.04),this.healthData.distance=(n*8e-4).toFixed(2),n%10===0&&this.saveHealthData().catch(r=>{}),this.notifyStepListeners()}),!0}catch{}if(bo.getPlatform()==="android")try{const e=(await Vt(async()=>{const{default:n}=await import("./chunk-1765759384263-googleFitService.js");return{default:n}},[])).default;if(await e.checkAvailability()&&await e.initialize()){this.isUsingGoogleFit=!0,this.googleFitService=e;const r=await e.getTodaySteps();return this.stepCount=r,this.healthData.steps=r,this.healthData.calories=Math.round(r*.04),this.healthData.distance=(r*8e-4).toFixed(2),this.googleFitSyncInterval=setInterval(async()=>{try{const s=await e.getTodaySteps();s!==this.stepCount&&(this.stepCount=s,this.healthData.steps=s,this.healthData.calories=Math.round(s*.04),this.healthData.distance=(s*8e-4).toFixed(2),this.notifyStepListeners(),await this.saveHealthData())}catch(s){console.error("Google Fit sync error:",s)}},3e4),!0}}catch{}try{if(this.activeSensorCount=await Xy.initialize(),this.activeSensorCount>=2)return this.isUsingMultiSensor=!0,this.isUsingHardware=!1,this.multiSensorService=Xy,Xy.addStepListener(e=>{this.stepCount=e.steps,this.healthData.steps=e.steps,this.healthData.distance=parseFloat(e.distance),this.healthData.calories=Math.round(e.steps*.04),this.healthData.heartRate=e.heartRate,e.floors&&(this.healthData.floorsClimbed=e.floors),e.cadence&&(this.healthData.cadence=e.cadence),e.activityType&&(this.healthData.activityType=e.activityType),this.stepCount%10===0&&this.saveHealthData().catch(t=>{}),this.notifyStepListeners()}),!0}catch{}try{await this.startAutomaticStepDetection()}catch{}return!0}catch{return!1}}async startAutomaticStepDetection(){try{try{const e=await Uh.requestPermissions()}catch{}this.motionSubscription&&this.motionSubscription.unsubscribe();try{this.motionSubscription=await xI.subscribe(e=>{try{this.handleAccelerometerEvent(e)}catch{}},"MultiSensor")}catch{}try{this.orientationListener=await Uh.addListener("orientation",e=>{try{this.handleOrientationEvent(e)}catch{}})}catch{}return typeof window<"u"&&window.DeviceMotionEvent&&(this.webMotionHandler=e=>{try{e.accelerationIncludingGravity&&this.handleAccelerometerEvent(e.accelerationIncludingGravity)}catch{}},window.addEventListener("devicemotion",this.webMotionHandler)),setTimeout(()=>{this.totalEventsReceived},3e3),this.debugInterval=setInterval(()=>{},1e4),!0}catch(e){throw e}}handleOrientationEvent(e){if(this.totalEventsReceived++,e.alpha!==void 0&&this.lastOrientation&&Math.abs(e.alpha-this.lastOrientation.alpha)+Math.abs(e.beta-this.lastOrientation.beta)+Math.abs(e.gamma-this.lastOrientation.gamma)>10){const n=Date.now();n-this.lastStepTime>this.minStepInterval&&(this.lastStepTime=n,this.stepCount++,this.healthData.steps=this.stepCount,this.healthData.calories=Math.round(this.stepCount*.04),this.healthData.distance=(this.stepCount*8e-4).toFixed(2),this.stepCount%10===0&&this.saveHealthData().catch(r=>{}),this.notifyStepListeners())}this.lastOrientation=e}handleAccelerometerEvent(e){this.totalEventsReceived++,this.lastAccelEvent=e;const t=e.accelerationIncludingGravity||e.acceleration||e;if(!t||typeof t.x>"u")return;const n=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);this.magnitudeHistory.push(n),this.magnitudeHistory.length>this.peakDetectionWindow&&this.magnitudeHistory.shift();const r=Date.now(),s=r-this.lastStepTime;if(this.magnitudeHistory.length>=3){const l=this.magnitudeHistory[this.magnitudeHistory.length-1],u=this.magnitudeHistory[this.magnitudeHistory.length-2],h=this.magnitudeHistory[this.magnitudeHistory.length-3],f=l>u&&u>h&&l>this.stepDetectionThreshold,x=s>this.minStepInterval;f&&x&&(this.lastStepTime=r,this.stepCount++,this.healthData.steps=this.stepCount,this.healthData.calories=Math.round(this.stepCount*.04),this.healthData.distance=(this.stepCount*8e-4).toFixed(2),this.stepCount%10===0&&this.saveHealthData().catch(g=>{}),this.notifyStepListeners(),this.debugMode&&this.stepCount%10)}this.lastMagnitude=n}async notifyStepListeners(){if(this.stepListeners.forEach(e=>{try{e(this.stepCount)}catch{}}),this.stepCount>0&&this.stepCount%10===0)try{const e=(await Vt(async()=>{const{default:l}=await Promise.resolve().then(()=>Yy);return{default:l}},void 0)).default,t=new Date().toISOString().split("T")[0],n=new Date().getDay(),r=n===0?6:n-1;let s=await Ei.get("weeklySteps",Ii.getCurrentUser()?.uid)||[];for(;s.length<7;)s.push({steps:0,date:null});s[r]={steps:this.stepCount,date:t},await Ei.save("weeklySteps",s,Ii.getCurrentUser()?.uid)}catch{}}async cleanup(){try{this.accelerometerListener&&(await this.accelerometerListener.remove(),this.accelerometerListener=null),this.orientationListener&&(await this.orientationListener.remove(),this.orientationListener=null),this.webMotionHandler&&typeof window<"u"&&(window.removeEventListener("devicemotion",this.webMotionHandler),this.webMotionHandler=null),this.debugInterval&&(clearInterval(this.debugInterval),this.debugInterval=null)}catch{}}async addManualSteps(e){try{return this.stepCount+=e,this.healthData.steps=this.stepCount,this.healthData.calories=Math.round(this.stepCount*.04),this.healthData.distance=(this.stepCount*8e-4).toFixed(2),await this.saveHealthData(),this.notifyStepListeners(),!0}catch{return!1}}async requestMotionPermission(){try{if(!Uh)return!1;const e=await Uh.requestPermissions();return this.motionPermissionGranted=!0,!0}catch{return this.motionPermissionGranted=!0,!0}}async startStepCounting(){try{return await(await Vt(async()=>{const{default:t}=await import("./chunk-1765759384263-backgroundRunnerService.js");return{default:t}},[])).default.start(),this.motionSubscription&&this.motionSubscription.unsubscribe(),this.motionSubscription=await xI.subscribe(t=>{this.totalEventsReceived++,this.lastAccelEvent=t,this.accelUIListeners&&this.accelUIListeners.forEach(n=>n(t)),this.totalEventsReceived<=5,this.debugMode&&this.totalEventsReceived%100,this.detectStep(t)},"StepCounter"),this.isListening=!0,setTimeout(()=>{this.totalEventsReceived},5e3),!0}catch{return this.isListening=!1,!1}}addAccelUIListener(e){this.accelUIListeners||(this.accelUIListeners=[]),this.accelUIListeners.push(e)}removeAccelUIListener(e){this.accelUIListeners&&(this.accelUIListeners=this.accelUIListeners.filter(t=>t!==e))}detectStep(e){const t=e.accelerationIncludingGravity||e.acceleration||e;if(!t||typeof t.x>"u"){this.totalEventsReceived;return}const n=Date.now();if(n-this.lastStepTime<this.minStepInterval)return;const r=Math.sqrt(t.x**2+t.y**2+t.z**2);if(this.debugMode&&r>8){const u=n-this.lastStepTime;Math.abs(t.x)>.5||Math.abs(t.y)>.5||Math.abs(t.z)>.5,r>this.stepDetectionThreshold,u>=this.minStepInterval,this.isValidStepPattern(n)}this.recentAccelerations.push({magnitude:r,timestamp:n}),this.recentAccelerations.length>3&&this.recentAccelerations.shift(),this.totalEventsReceived%20;let s=!1;if(this.recentAccelerations.length>=3){const u=this.recentAccelerations[0].magnitude,h=this.recentAccelerations[1].magnitude,f=r,x=Math.min(h-u,h-f);s=h>u&&h>f&&h>12.7&&x>1}const l=n-this.lastStepTime>=525;s&&l&&(this.stepCount++,n-this.lastStepTime,this.lastStepTime=n,this.debugMode,this.stepCadence.push(n),this.stepCadence.length>5&&this.stepCadence.shift(),this.updateHealthMetrics(),this.stepCount%10===0&&this.saveHealthData(),this.notifyStepUpdate())}isValidStepPattern(e){const t=e-this.lastStepTime;return!(t<150||t>3e3)}updateHealthMetrics(){this.healthData.distance=this.stepCount*.762/1e3,this.healthData.calories=Math.round(this.stepCount*.04),this.healthData.activeMinutes=Math.round(this.stepCount/100),this.healthData.steps=this.stepCount}getStepCount(){return this.isUsingGoogleFit&&this.googleFitService?this.stepCount:this.isUsingMultiSensor?Xy.stepCount||0:this.stepCount}getStepProgress(){return Math.min(this.stepCount/this.stepGoal,1)}setStepGoal(e){this.stepGoal=e,this.saveHealthData()}getHealthData(){return{...this.healthData,stepGoal:this.stepGoal,stepProgress:this.getStepProgress(),goalReached:this.stepCount>=this.stepGoal}}getHealthSummary(){return{steps:{current:this.stepCount,goal:this.stepGoal,progress:Math.round(this.getStepProgress()*100),remaining:Math.max(0,this.stepGoal-this.stepCount)},calories:{burned:this.healthData.calories,unit:"kcal"},distance:{traveled:this.healthData.distance.toFixed(2),unit:"km"},activeTime:{minutes:this.healthData.activeMinutes,hours:(this.healthData.activeMinutes/60).toFixed(1)}}}addHealthData(e,t){switch(e){case"heartRate":this.healthData.heartRate=t;break;case"weight":this.healthData.weight=t;break;case"sleep":this.healthData.sleep=t;break}this.saveHealthData()}async resetDailyStats(){const e=this.getHealthData(),t=e.steps,n=new Date;n.setDate(n.getDate()-1);const r=n.toISOString().split("T")[0];this.saveToHistory(e);try{const s=(await Vt(async()=>{const{default:f}=await Promise.resolve().then(()=>Yy);return{default:f}},void 0)).default;let l=await Ei.get("weeklySteps",Ii.getCurrentUser()?.uid)||[];for(;l.length<7;)l.push({steps:0,date:null});const u=n.getDay(),h=u===0?6:u-1;l[h]={steps:t,date:r},await Ei.save("weeklySteps",l,Ii.getCurrentUser()?.uid)}catch{}this.stepCount=0,this.healthData={steps:0,calories:0,distance:0,activeMinutes:0,heartRate:this.healthData.heartRate,weight:this.healthData.weight,sleep:null},this.saveHealthData()}saveToHistory(e){try{const t=JSON.parse(localStorage.getItem("health_history")||"[]");t.push({date:new Date().toISOString().split("T")[0],...e}),t.length>30&&t.shift(),localStorage.setItem("health_history",JSON.stringify(t))}catch{}}getHistory(e=7){try{return JSON.parse(localStorage.getItem("health_history")||"[]").slice(-e)}catch{return[]}}async saveHealthData(){try{const e=(await Vt(async()=>{const{default:h}=await Promise.resolve().then(()=>Yy);return{default:h}},void 0)).default;let t=0;try{const{default:h}=await Vt(async()=>{const{default:A}=await import("./chunk-1765759384263-nativeStepService.js");return{default:A}},[]),f=await h.getSteps(),x=new Date().toISOString().split("T")[0];let g=parseInt(await Ei.get("stepBaseline",Ii.getCurrentUser()?.uid)||"0");const w=await Ei.get("stepBaselineDate",Ii.getCurrentUser()?.uid);f<g&&w===x&&(console.log(" SAVE: Sensor reset detected, resetting baseline"),g=f,await Ei.save("stepBaseline",f.toString(),Ii.getCurrentUser()?.uid)),w===x&&(t=Math.max(0,f-g)),console.log(" SAVE: Using REAL steps from native service:",t)}catch{console.warn(" Could not get native steps, using fallback:",this.stepCount),t=this.stepCount}const n={stepCount:t,stepGoal:this.stepGoal,healthData:{...this.healthData,steps:t},lastUpdate:Date.now()};console.log(" SAVING health data - stepCount:",t),localStorage.setItem("health_data",JSON.stringify(n));const r=new Date().toISOString().split("T")[0];console.log(" Today date:",r);const s=localStorage.getItem("stepHistory");console.log(" Raw stepHistory from localStorage:",s);let l=[];try{const h=s?JSON.parse(s):[];Array.isArray(h)?l=h:h&&typeof h=="object"?(l=Object.values(h).filter(f=>f&&f.date),console.warn(" stepHistory was object, converted to array")):l=[],console.log(" Parsed stepHistory (forced to array):",l)}catch(h){console.error(" Failed to parse stepHistory:",h),l=[]}const u=l.findIndex(h=>h.date===r);u>=0?(l[u].steps=t,console.log(` Updated stepHistory for ${r}:`,t)):(l.push({date:r,steps:t}),console.log(` Added new stepHistory entry for ${r}:`,t)),l.length>30&&(l=l.slice(-30)),console.log(" stepHistory array:",l),localStorage.setItem("stepHistory",JSON.stringify(l)),await Ei.save("health_data",n,Ii.getCurrentUser()?.uid),await Ei.save("stepHistory",l,Ii.getCurrentUser()?.uid),console.log(" Saved to syncService (Preferences + Firebase)");try{const h=(await Vt(async()=>{const{default:x}=await Promise.resolve().then(()=>TG);return{default:x}},void 0)).default,f=h.getCurrentUser();if(f){const x=l.reduce((w,A)=>w+(A.steps||0),0),g=l.length;await h.updateProfile({stats:{...f.stats,totalSteps:x,totalDays:g}})}}catch{}}catch(e){console.error(" Failed to save health data:",e),console.error("Error stack:",e.stack)}}async loadHealthData(){try{const e=(await Vt(async()=>{const{default:n}=await Promise.resolve().then(()=>Yy);return{default:n}},void 0)).default,t=await Ei.get("health_data",Ii.getCurrentUser()?.uid);if(t){const n=new Date(t.lastUpdate),r=new Date;n.toDateString()===r.toDateString()?(this.stepCount=t.stepCount||0,this.stepGoal=t.stepGoal||1e4,this.healthData=t.healthData||this.healthData):this.resetDailyStats()}else{const n=localStorage.getItem("health_data");if(n){const r=JSON.parse(n),s=new Date(r.lastUpdate),l=new Date;s.toDateString()===l.toDateString()?(this.stepCount=r.stepCount||0,this.stepGoal=r.stepGoal||1e4,this.healthData=r.healthData||this.healthData):this.resetDailyStats()}}}catch{}}notifyStepUpdate(){typeof window<"u"&&window.dispatchEvent(new CustomEvent("healthDataUpdate",{detail:this.getHealthData()})),this.stepListeners.forEach(e=>e(this.getHealthData())),this.stepCount>0&&Yw.trackSteps(this.stepCount,{activeMinutes:this.healthData.activeMinutes||0,energyLevel:5}).catch(e=>{})}watchStepCount(e){return this.stepListeners.push(e),()=>{this.stepListeners=this.stepListeners.filter(t=>t!==e)}}stopStepCounting(){this.motionSubscription&&(this.motionSubscription.unsubscribe(),this.motionSubscription=null),this.saveHealthData()}getAchievements(){const e=[];return this.stepCount>=this.stepGoal&&e.push({id:"daily_goal",name:"Daily Goal Reached!",icon:"",unlocked:!0}),this.stepCount>=5e3&&e.push({id:"halfway",name:"Halfway Hero",icon:"",unlocked:!0}),this.stepCount>=15e3&&e.push({id:"overachiever",name:"Overachiever",icon:"",unlocked:!0}),e}getDiagnosticInfo(){return{isListening:this.isListening,permissionGranted:this.motionPermissionGranted,totalEventsReceived:this.totalEventsReceived,lastEventTime:this.lastAccelEvent?new Date(this.lastAccelEvent.timestamp).toLocaleTimeString():"None",currentSteps:this.stepCount,recentAccelerations:this.recentAccelerations.length,listenerActive:this.accelerometerListener!==null,lastAccelData:this.lastAccelEvent?{x:this.lastAccelEvent.accelerationIncludingGravity.x.toFixed(2),y:this.lastAccelEvent.accelerationIncludingGravity.y.toFixed(2),z:this.lastAccelEvent.accelerationIncludingGravity.z.toFixed(2)}:null}}printDiagnostics(){return this.getDiagnosticInfo()}addTestSteps(e=100){this.stepCount+=e,this.updateHealthMetrics(),this.notifyStepUpdate()}resetSteps(){this.stepCount=0,this.updateHealthMetrics(),this.notifyStepUpdate()}}const Nc=new FG;class jG{constructor(){this.isMonitoring=!1,this.currentHeartRate=null,this.heartRateHistory=[],this.device=null,this.characteristic=null,this.listeners=[],this.maxHistorySize=1e3}async connectDevice(){if(!navigator.bluetooth)throw new Error("Bluetooth not supported on this device");try{this.device=await navigator.bluetooth.requestDevice({filters:[{services:["heart_rate"]}],optionalServices:["battery_service","device_information"]});const t=await(await this.device.gatt.connect()).getPrimaryService("heart_rate");return this.characteristic=await t.getCharacteristic("heart_rate_measurement"),await this.characteristic.startNotifications(),this.characteristic.addEventListener("characteristicvaluechanged",n=>{this.handleHeartRateData(n.target.value)}),this.isMonitoring=!0,await Xh.saveData("hr_device_name",this.device.name||"Unknown Device"),{success:!0,deviceName:this.device.name,message:"Heart rate monitor connected"}}catch(e){throw new Error("Failed to connect to heart rate monitor: "+e.message)}}handleHeartRateData(e){const t=e.getUint8(0),n=t&1;let r;n?r=e.getUint16(1,!0):r=e.getUint8(1);const s=t&8;let l=null;if(s){const h=n?3:2;l=e.getUint16(h,!0)}this.currentHeartRate=r;const u={bpm:r,timestamp:Date.now(),energyExpended:l};this.heartRateHistory.push(u),this.heartRateHistory.length>this.maxHistorySize&&this.heartRateHistory.shift(),this.heartRateHistory.length%10===0&&this.saveHistory(),this.notifyListeners(u)}async disconnect(){try{return this.characteristic&&await this.characteristic.stopNotifications(),this.device&&this.device.gatt.connected&&await this.device.gatt.disconnect(),this.isMonitoring=!1,this.device=null,this.characteristic=null,{success:!0,message:"Disconnected"}}catch(e){throw e}}getCurrentHeartRate(){return this.currentHeartRate}getHeartRateZone(e=30){if(!this.currentHeartRate)return null;const t=220-e,n=this.currentHeartRate/t*100;return n<50?{zone:"Resting",color:"#4CAF50",intensity:"Very Light"}:n<60?{zone:"Fat Burn",color:"#8BC34A",intensity:"Light"}:n<70?{zone:"Cardio",color:"#FFC107",intensity:"Moderate"}:n<80?{zone:"Peak",color:"#FF9800",intensity:"Hard"}:{zone:"Maximum",color:"#F44336",intensity:"Maximum"}}getAverageHeartRate(e=5){const t=Date.now()-e*60*1e3,n=this.heartRateHistory.filter(s=>s.timestamp>t);if(n.length===0)return null;const r=n.reduce((s,l)=>s+l.bpm,0);return Math.round(r/n.length)}getHeartRateVariability(){if(this.heartRateHistory.length<10)return null;const e=this.heartRateHistory.slice(-10),t=[];for(let l=1;l<e.length;l++)t.push(e[l].timestamp-e[l-1].timestamp);const n=t.reduce((l,u)=>l+u,0)/t.length,r=t.reduce((l,u)=>l+Math.pow(u-n,2),0)/t.length,s=Math.sqrt(r);return Math.round(s)}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch{}})}async saveHistory(){try{await Xh.saveData("heart_rate_history",this.heartRateHistory)}catch{}}loadHistory(){try{const e=localStorage.getItem("heart_rate_history");e&&(this.heartRateHistory=JSON.parse(e))}catch{}}isConnected(){return this.device&&this.device.gatt&&this.device.gatt.connected}getDeviceName(){return this.device?.name||localStorage.getItem("hr_device_name")||"No device"}}const Od=new jG;class VG{constructor(){this.isTracking=!1,this.sleepSession=null,this.motionData=[],this.lastMotionTime=null,this.motionListener=null,this.checkInterval=null}async startTracking(){if(!this.isTracking)try{return this.isTracking=!0,this.sleepSession={startTime:Date.now(),endTime:null,phases:[],movements:0,quality:null},bo.getPlatform()!=="web"&&(this.motionListener=await Uh.addListener("accel",e=>{this.handleMotionData(e)})),this.checkInterval=setInterval(()=>{this.analyzeSleepPhase()},3e4),this.saveSleepSession(),{success:!0,message:"Sleep tracking started"}}catch(e){throw this.isTracking=!1,e}}async stopTracking(){if(!this.isTracking)return null;try{this.isTracking=!1,this.motionListener&&(this.motionListener.remove(),this.motionListener=null),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.sleepSession.endTime=Date.now(),this.sleepSession.quality=this.calculateSleepQuality();const t=((this.sleepSession.endTime-this.sleepSession.startTime)/(1e3*60*60)).toFixed(1);this.saveSleepToHistory();const n={...this.sleepSession};return this.sleepSession=null,this.motionData=[],{success:!0,session:n,duration:t,quality:n.quality}}catch(e){throw e}}handleMotionData(e){const{x:t,y:n,z:r}=e.acceleration,s=Math.sqrt(t*t+n*n+r*r);if(s>.5){this.lastMotionTime=Date.now(),this.sleepSession.movements++,this.motionData.push({magnitude:s,timestamp:Date.now()});const l=Date.now()-300*1e3;this.motionData=this.motionData.filter(u=>u.timestamp>l)}}analyzeSleepPhase(){if(!this.isTracking)return;const e=Date.now(),t=e-6e4,n=e-3e5,r=this.motionData.filter(u=>u.timestamp>t).length,s=this.motionData.filter(u=>u.timestamp>n).length;let l;r>10?l="awake":s>5?l="light":s>2?l="rem":l="deep",this.sleepSession.phases.push({phase:l,timestamp:e,duration:3e4})}calculateSleepQuality(){if(!this.sleepSession)return null;const t=(this.sleepSession.endTime-this.sleepSession.startTime)/(1e3*60*60),n={awake:0,light:0,rem:0,deep:0};this.sleepSession.phases.forEach(x=>{n[x.phase]++});const r=this.sleepSession.phases.length||1,s=n.deep/r*100,l=n.rem/r*100,u=n.awake/r*100;let h=100;t<6?h-=20:t<7?h-=10:t>9&&(h-=5),s<15?h-=15:s<20&&(h-=5),l<15?h-=15:l<20&&(h-=5),h-=u;const f=this.sleepSession.movements/t;return f>20?h-=10:f>10&&(h-=5),Math.max(0,Math.min(100,Math.round(h)))}getSleepStats(){if(!this.sleepSession)return null;const n=((Date.now()-this.sleepSession.startTime)/(1e3*60*60)).toFixed(1),r={awake:0,light:0,rem:0,deep:0};this.sleepSession.phases.forEach(l=>{r[l.phase]++});const s=this.sleepSession.phases.length||1;return{duration:n,movements:this.sleepSession.movements,phases:{deep:Math.round(r.deep/s*100),rem:Math.round(r.rem/s*100),light:Math.round(r.light/s*100),awake:Math.round(r.awake/s*100)},currentPhase:this.sleepSession.phases[this.sleepSession.phases.length-1]?.phase||"unknown"}}getSleepHistory(e=7){try{const t=localStorage.getItem("sleep_history");if(!t)return[];const n=JSON.parse(t),r=Date.now()-e*24*60*60*1e3;return n.filter(s=>s.startTime>r)}catch{return[]}}async saveSleepToHistory(){try{const e=this.sleepSession.endTime-this.sleepSession.startTime,t=Math.floor(e/(1e3*60*60)),n=Math.floor(e%(1e3*60*60)/(1e3*60)),s={date:new Date().toISOString().split("T")[0],hours:t,minutes:n,quality:this.sleepSession.quality,timestamp:this.sleepSession.endTime,phases:this.sleepSession.phases,movements:this.sleepSession.movements},l=JSON.parse(localStorage.getItem("sleepLog")||"[]");l.push(s),localStorage.setItem("sleepLog",JSON.stringify(l));try{await Ei.save("sleepLog",l,Ii.getCurrentUser()?.uid)}catch(u){console.warn(" Could not sync sleep to Firebase:",u)}}catch{}}saveSleepSession(){try{this.sleepSession&&localStorage.setItem("current_sleep_session",JSON.stringify(this.sleepSession))}catch{}}restoreSleepSession(){try{const e=localStorage.getItem("current_sleep_session");return e?(this.sleepSession=JSON.parse(e),Date.now()-this.sleepSession.startTime>720*60*1e3?(localStorage.removeItem("current_sleep_session"),this.sleepSession=null,!1):!0):!1}catch{return!1}}}const Xf=new VG;class zG{constructor(){this.dailyGoal=2e3,this.todayIntake=0,this.intakeHistory=[],this.reminders=[]}async initialize(){await this.loadSettings(),await this.loadTodayIntake(),await this.loadHistory(),await this.loadReminders()}async addIntake(e){const t={amount:e,timestamp:Date.now(),date:new Date().toISOString().split("T")[0]};this.todayIntake+=e,this.intakeHistory.push(t),this.saveTodayIntake(),this.saveHistory();const n=await Ei.get("waterLog",Ii.getCurrentUser()?.uid)||[];n.push({cups:Math.round(e/250),timestamp:Date.now(),date:new Date().toISOString().split("T")[0]}),await Ei.save("waterLog",n,Ii.getCurrentUser()?.uid);try{await Yw.trackHydration(e,{exercised:!1,temperature:20,thirstLevel:3})}catch{}return this.todayIntake>=this.dailyGoal,{amount:e,total:this.todayIntake,remaining:Math.max(0,this.dailyGoal-this.todayIntake),percentage:Math.min(100,Math.round(this.todayIntake/this.dailyGoal*100)),intake:this.todayIntake,goal:this.dailyGoal,goalReached:this.todayIntake>=this.dailyGoal}}addGlass(){return this.addIntake(250)}addBottle(){return this.addIntake(500)}addLargeBottle(){return this.addIntake(1e3)}addCup(){return this.addIntake(200)}removeLastIntake(){if(this.intakeHistory.length===0)return null;const e=new Date().toISOString().split("T")[0],t=this.intakeHistory.filter(s=>s.date===e);if(t.length===0)return null;const n=t[t.length-1];this.todayIntake-=n.amount;const r=this.intakeHistory.indexOf(n);return this.intakeHistory.splice(r,1),this.saveTodayIntake(),this.saveHistory(),n}async setDailyGoal(e){this.dailyGoal=e,localStorage.setItem("water_daily_goal",e.toString()),await Ei.save("water_daily_goal",e,Ii.getCurrentUser()?.uid)}getRecommendedGoal(e,t="moderate"){let n=e*33;return t==="low"?n*=.9:t==="high"?n*=1.2:t==="very_high"&&(n*=1.4),Math.round(n)}getTodayProgress(){return{intake:this.todayIntake,goal:this.dailyGoal,remaining:Math.max(0,this.dailyGoal-this.todayIntake),percentage:Math.min(100,Math.round(this.todayIntake/this.dailyGoal*100)),goalReached:this.todayIntake>=this.dailyGoal}}getIntakeForDate(e){const t=this.intakeHistory.filter(r=>r.date===e),n=t.reduce((r,s)=>r+s.amount,0);return{intakes:t,total:n,percentage:Math.min(100,Math.round(n/this.dailyGoal*100))}}getWeeklyStats(){const e=new Date,t=new Date(e);t.setDate(e.getDate()-6);const n=[];for(let u=0;u<7;u++){const h=new Date(t);h.setDate(t.getDate()+u);const f=h.toISOString().split("T")[0],g=this.intakeHistory.filter(w=>w.date===f).reduce((w,A)=>w+A.amount,0);n.push({date:f,dayName:h.toLocaleDateString("en-US",{weekday:"short"}),total:g,percentage:Math.min(100,Math.round(g/this.dailyGoal*100)),goalReached:g>=this.dailyGoal})}const r=n.reduce((u,h)=>u+h.total,0),s=Math.round(r/7),l=n.filter(u=>u.goalReached).length;return{days:n,weekTotal:r,weekAverage:s,daysGoalReached:l,consistency:Math.round(l/7*100)}}scheduleReminder(e,t,n="Time to drink water! "){const r={id:Date.now().toString(),hour:e,minute:t,message:n,enabled:!0};return this.reminders.push(r),this.saveReminders(),r}removeReminder(e){this.reminders=this.reminders.filter(t=>t.id!==e),this.saveReminders()}toggleReminder(e){const t=this.reminders.find(n=>n.id===e);t&&(t.enabled=!t.enabled,this.saveReminders())}resetDailyIntake(){this.todayIntake=0,this.saveTodayIntake()}saveTodayIntake(){const e=new Date().toISOString().split("T")[0];localStorage.setItem("water_today_intake",JSON.stringify({date:e,amount:this.todayIntake}))}async loadTodayIntake(){try{const e=await Ei.get("water_today_intake",Ii.getCurrentUser()?.uid),t=new Date().toISOString().split("T")[0];if(e&&e.date===t)this.todayIntake=e.intake;else{const n=localStorage.getItem("water_today_intake");if(n){const r=JSON.parse(n);r.date===t?this.todayIntake=r.intake:this.todayIntake=0}else this.todayIntake=0}}catch{}}async saveHistory(){try{const e=Date.now()-2592e6,t=this.intakeHistory.filter(n=>n.timestamp>e);localStorage.setItem("water_intake_history",JSON.stringify(t)),await Ei.save("water_intake_history",t,Ii.getCurrentUser()?.uid)}catch{}}async loadHistory(){try{const e=await Ei.get("water_intake_history",Ii.getCurrentUser()?.uid);if(e)this.intakeHistory=e;else{const t=localStorage.getItem("water_intake_history");t&&(this.intakeHistory=JSON.parse(t))}}catch{}}async saveReminders(){try{localStorage.setItem("water_reminders",JSON.stringify(this.reminders)),await Ei.save("water_reminders",this.reminders,Ii.getCurrentUser()?.uid)}catch{}}async loadReminders(){try{const e=await Ei.get("water_reminders",Ii.getCurrentUser()?.uid);if(e)this.reminders=e;else{const t=localStorage.getItem("water_reminders");t&&(this.reminders=JSON.parse(t))}}catch{}}async loadSettings(){try{const e=await Ei.get("water_daily_goal",Ii.getCurrentUser()?.uid);if(e)this.dailyGoal=typeof e=="number"?e:parseInt(e);else{const t=localStorage.getItem("water_daily_goal");t&&(this.dailyGoal=parseInt(t))}}catch{}}}const S1=new zG,dY=Object.freeze(Object.defineProperty({__proto__:null,default:S1},Symbol.toStringTag,{value:"Module"}));class UG{constructor(){this.isDarkMode=!1,this.isAutoMode=!0,this.listeners=[]}initialize(){const e=localStorage.getItem("dark_mode"),t=localStorage.getItem("dark_mode_auto");t!==null&&(this.isAutoMode=t==="true"),this.isAutoMode?(this.isDarkMode=window.matchMedia("(prefers-color-scheme: dark)").matches,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",n=>{this.isAutoMode&&this.setDarkMode(n.matches)})):e!==null&&(this.isDarkMode=e==="true"),this.applyTheme()}toggle(){this.isAutoMode=!1,this.setDarkMode(!this.isDarkMode),localStorage.setItem("dark_mode_auto","false")}setDarkMode(e){this.isDarkMode=e,this.applyTheme(),this.notifyListeners(),localStorage.setItem("dark_mode",e.toString())}setAutoMode(e){if(this.isAutoMode=e,localStorage.setItem("dark_mode_auto",e.toString()),e){const t=window.matchMedia("(prefers-color-scheme: dark)").matches;this.setDarkMode(t)}}applyTheme(){const e=document.documentElement;this.isDarkMode?(e.classList.add("dark-mode"),e.style.setProperty("--bg-primary","#121212"),e.style.setProperty("--bg-secondary","#1E1E1E"),e.style.setProperty("--bg-tertiary","#2D2D2D"),e.style.setProperty("--text-primary","#FFFFFF"),e.style.setProperty("--text-secondary","#B0B0B0"),e.style.setProperty("--text-tertiary","#808080"),e.style.setProperty("--border-color","#3D3D3D"),e.style.setProperty("--shadow","rgba(0, 0, 0, 0.5)")):(e.classList.remove("dark-mode"),e.style.setProperty("--bg-primary","#FFFFFF"),e.style.setProperty("--bg-secondary","#F5F7FA"),e.style.setProperty("--bg-tertiary","#E0E4E8"),e.style.setProperty("--text-primary","#000000"),e.style.setProperty("--text-secondary","#666666"),e.style.setProperty("--text-tertiary","#999999"),e.style.setProperty("--border-color","#E0E0E0"),e.style.setProperty("--shadow","rgba(0, 0, 0, 0.1)"))}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.isDarkMode)}catch{}})}getTheme(){return{isDark:this.isDarkMode,isAuto:this.isAutoMode,mode:this.isDarkMode?"dark":"light"}}}const BG=new UG;var Ox;(function(i){i[i.Flush=0]="Flush",i[i.Add=1]="Add"})(Ox||(Ox={}));const Xw=Ul("TextToSpeech",{web:()=>Vt(()=>import("./chunk-1765759384263-web7.js"),[]).then(i=>new i.TextToSpeechWeb)}),$G=Object.freeze(Object.defineProperty({__proto__:null,get QueueStrategy(){return Ox},TextToSpeech:Xw},Symbol.toStringTag,{value:"Module"}));class GG{constructor(){this.audioContext=null,this.oscillators=[],this.gainNodes=[],this.isPlaying=!1,this.audioElement=null,this.useRealAudio=!0}initAudio(){return this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext}createBinauralBeat(e=6){const t=this.initAudio(),n=t.createOscillator(),r=t.createGain();n.type="sine",n.frequency.setValueAtTime(200,t.currentTime),r.gain.setValueAtTime(.08,t.currentTime);const s=t.createOscillator(),l=t.createGain();s.type="sine",s.frequency.setValueAtTime(200+e,t.currentTime),l.gain.setValueAtTime(.08,t.currentTime);const u=t.createStereoPanner(),h=t.createStereoPanner();return u.pan.setValueAtTime(-1,t.currentTime),h.pan.setValueAtTime(1,t.currentTime),n.connect(r),r.connect(u),u.connect(t.destination),s.connect(l),l.connect(h),h.connect(t.destination),{leftOsc:n,rightOsc:s,leftGain:r,rightGain:l}}createWhiteNoise(){const e=this.initAudio(),t=e.sampleRate*2,n=e.createBuffer(1,t,e.sampleRate),r=n.getChannelData(0);let s=0,l=0,u=0,h=0,f=0,x=0,g=0;for(let $=0;$<t;$++){const W=Math.random()*2-1;s=.99886*s+W*.0555179,l=.99332*l+W*.0750759,u=.969*u+W*.153852,h=.8665*h+W*.3104856,f=.55*f+W*.5329522,x=-.7616*x-W*.016898,r[$]=s+l+u+h+f+x+g+W*.5362,r[$]*=.11,g=W*.115926}const w=e.createBufferSource();w.buffer=n,w.loop=!0;const A=e.createBiquadFilter();A.type="lowpass",A.frequency.setValueAtTime(800,e.currentTime);const B=e.createGain();return B.gain.setValueAtTime(.05,e.currentTime),w.connect(A),A.connect(B),B.connect(e.destination),{source:w,gain:B}}createOceanWave(){const e=this.initAudio(),t=e.createOscillator(),n=e.createGain(),r=e.createBiquadFilter();t.type="sine",t.frequency.setValueAtTime(.3,e.currentTime),r.type="lowpass",r.frequency.setValueAtTime(400,e.currentTime),r.Q.setValueAtTime(.5,e.currentTime),n.gain.setValueAtTime(.06,e.currentTime);const s=e.createOscillator(),l=e.createGain();return s.frequency.setValueAtTime(.2,e.currentTime),l.gain.setValueAtTime(.03,e.currentTime),s.connect(l),l.connect(n.gain),t.connect(r),r.connect(n),n.connect(e.destination),{osc:t,lfo:s,gainNode:n}}async start(){if(!this.isPlaying)try{if(this.useRealAudio)try{this.audioElement=new Audio("/meditation-ambient.mp3"),this.audioElement.loop=!0,this.audioElement.volume=.3,this.audioElement.volume=0,await this.audioElement.play();const s=setInterval(()=>{this.audioElement.volume<.3?this.audioElement.volume=Math.min(.3,this.audioElement.volume+.03):clearInterval(s)},100);this.isPlaying=!0;return}catch{}const e=this.initAudio();e.state==="suspended"&&await e.resume();const t=this.createBinauralBeat(6);t.leftOsc.start(),t.rightOsc.start(),this.oscillators.push(t.leftOsc,t.rightOsc),this.gainNodes.push(t.leftGain,t.rightGain);const n=this.createWhiteNoise();n.source.start(),this.oscillators.push(n.source),this.gainNodes.push(n.gain);const r=this.createOceanWave();r.osc.start(),r.lfo.start(),this.oscillators.push(r.osc,r.lfo),this.gainNodes.push(r.gainNode),this.isPlaying=!0}catch{}}stop(){if(this.isPlaying)try{if(this.audioElement){const n=setInterval(()=>{this.audioElement&&this.audioElement.volume>.05?this.audioElement.volume=Math.max(0,this.audioElement.volume-.05):(clearInterval(n),this.audioElement&&(this.audioElement.pause(),this.audioElement.currentTime=0,this.audioElement=null))},100);this.isPlaying=!1;return}const e=2,t=this.audioContext;if(t&&this.gainNodes.length>0){const n=t.currentTime;this.gainNodes.forEach(r=>{r.gain.exponentialRampToValueAtTime(.001,n+e)}),setTimeout(()=>{this.oscillators.forEach(r=>{try{r.stop()}catch{}}),this.oscillators=[],this.gainNodes=[]},e*1e3)}this.isPlaying=!1}catch{}}getIsPlaying(){return this.isPlaying}}const HG=new GG;var hb={};var wI;function KG(){return wI||(wI=1,(function(i){(function(){var e=function(){this.init()};e.prototype={init:function(){var g=this||t;return g._counter=1e3,g._html5AudioPool=[],g.html5PoolSize=10,g._codecs={},g._howls=[],g._muted=!1,g._volume=1,g._canPlayEvent="canplaythrough",g._navigator=typeof window<"u"&&window.navigator?window.navigator:null,g.masterGain=null,g.noAudio=!1,g.usingWebAudio=!0,g.autoSuspend=!0,g.ctx=null,g.autoUnlock=!0,g._setup(),g},volume:function(g){var w=this||t;if(g=parseFloat(g),w.ctx||x(),typeof g<"u"&&g>=0&&g<=1){if(w._volume=g,w._muted)return w;w.usingWebAudio&&w.masterGain.gain.setValueAtTime(g,t.ctx.currentTime);for(var A=0;A<w._howls.length;A++)if(!w._howls[A]._webAudio)for(var B=w._howls[A]._getSoundIds(),$=0;$<B.length;$++){var W=w._howls[A]._soundById(B[$]);W&&W._node&&(W._node.volume=W._volume*g)}return w}return w._volume},mute:function(g){var w=this||t;w.ctx||x(),w._muted=g,w.usingWebAudio&&w.masterGain.gain.setValueAtTime(g?0:w._volume,t.ctx.currentTime);for(var A=0;A<w._howls.length;A++)if(!w._howls[A]._webAudio)for(var B=w._howls[A]._getSoundIds(),$=0;$<B.length;$++){var W=w._howls[A]._soundById(B[$]);W&&W._node&&(W._node.muted=g?!0:W._muted)}return w},stop:function(){for(var g=this||t,w=0;w<g._howls.length;w++)g._howls[w].stop();return g},unload:function(){for(var g=this||t,w=g._howls.length-1;w>=0;w--)g._howls[w].unload();return g.usingWebAudio&&g.ctx&&typeof g.ctx.close<"u"&&(g.ctx.close(),g.ctx=null,x()),g},codecs:function(g){return(this||t)._codecs[g.replace(/^x-/,"")]},_setup:function(){var g=this||t;if(g.state=g.ctx&&g.ctx.state||"suspended",g._autoSuspend(),!g.usingWebAudio)if(typeof Audio<"u")try{var w=new Audio;typeof w.oncanplaythrough>"u"&&(g._canPlayEvent="canplay")}catch{g.noAudio=!0}else g.noAudio=!0;try{var w=new Audio;w.muted&&(g.noAudio=!0)}catch{}return g.noAudio||g._setupCodecs(),g},_setupCodecs:function(){var g=this||t,w=null;try{w=typeof Audio<"u"?new Audio:null}catch{return g}if(!w||typeof w.canPlayType!="function")return g;var A=w.canPlayType("audio/mpeg;").replace(/^no$/,""),B=g._navigator?g._navigator.userAgent:"",$=B.match(/OPR\/(\d+)/g),W=$&&parseInt($[0].split("/")[1],10)<33,q=B.indexOf("Safari")!==-1&&B.indexOf("Chrome")===-1,ge=B.match(/Version\/(.*?) /),he=q&&ge&&parseInt(ge[1],10)<15;return g._codecs={mp3:!!(!W&&(A||w.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!A,opus:!!w.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!w.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!w.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(w.canPlayType('audio/wav; codecs="1"')||w.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!w.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!w.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(w.canPlayType("audio/x-m4a;")||w.canPlayType("audio/m4a;")||w.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(w.canPlayType("audio/x-m4b;")||w.canPlayType("audio/m4b;")||w.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(w.canPlayType("audio/x-mp4;")||w.canPlayType("audio/mp4;")||w.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!he&&w.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!he&&w.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!w.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(w.canPlayType("audio/x-flac;")||w.canPlayType("audio/flac;")).replace(/^no$/,"")},g},_unlockAudio:function(){var g=this||t;if(!(g._audioUnlocked||!g.ctx)){g._audioUnlocked=!1,g.autoUnlock=!1,!g._mobileUnloaded&&g.ctx.sampleRate!==44100&&(g._mobileUnloaded=!0,g.unload()),g._scratchBuffer=g.ctx.createBuffer(1,1,22050);var w=function(A){for(;g._html5AudioPool.length<g.html5PoolSize;)try{var B=new Audio;B._unlocked=!0,g._releaseHtml5Audio(B)}catch{g.noAudio=!0;break}for(var $=0;$<g._howls.length;$++)if(!g._howls[$]._webAudio)for(var W=g._howls[$]._getSoundIds(),q=0;q<W.length;q++){var ge=g._howls[$]._soundById(W[q]);ge&&ge._node&&!ge._node._unlocked&&(ge._node._unlocked=!0,ge._node.load())}g._autoResume();var he=g.ctx.createBufferSource();he.buffer=g._scratchBuffer,he.connect(g.ctx.destination),typeof he.start>"u"?he.noteOn(0):he.start(0),typeof g.ctx.resume=="function"&&g.ctx.resume(),he.onended=function(){he.disconnect(0),g._audioUnlocked=!0,document.removeEventListener("touchstart",w,!0),document.removeEventListener("touchend",w,!0),document.removeEventListener("click",w,!0),document.removeEventListener("keydown",w,!0);for(var me=0;me<g._howls.length;me++)g._howls[me]._emit("unlock")}};return document.addEventListener("touchstart",w,!0),document.addEventListener("touchend",w,!0),document.addEventListener("click",w,!0),document.addEventListener("keydown",w,!0),g}},_obtainHtml5Audio:function(){var g=this||t;if(g._html5AudioPool.length)return g._html5AudioPool.pop();var w=new Audio().play();return w&&typeof Promise<"u"&&(w instanceof Promise||typeof w.then=="function")&&w.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(g){var w=this||t;return g._unlocked&&w._html5AudioPool.push(g),w},_autoSuspend:function(){var g=this;if(!(!g.autoSuspend||!g.ctx||typeof g.ctx.suspend>"u"||!t.usingWebAudio)){for(var w=0;w<g._howls.length;w++)if(g._howls[w]._webAudio){for(var A=0;A<g._howls[w]._sounds.length;A++)if(!g._howls[w]._sounds[A]._paused)return g}return g._suspendTimer&&clearTimeout(g._suspendTimer),g._suspendTimer=setTimeout(function(){if(g.autoSuspend){g._suspendTimer=null,g.state="suspending";var B=function(){g.state="suspended",g._resumeAfterSuspend&&(delete g._resumeAfterSuspend,g._autoResume())};g.ctx.suspend().then(B,B)}},3e4),g}},_autoResume:function(){var g=this;if(!(!g.ctx||typeof g.ctx.resume>"u"||!t.usingWebAudio))return g.state==="running"&&g.ctx.state!=="interrupted"&&g._suspendTimer?(clearTimeout(g._suspendTimer),g._suspendTimer=null):g.state==="suspended"||g.state==="running"&&g.ctx.state==="interrupted"?(g.ctx.resume().then(function(){g.state="running";for(var w=0;w<g._howls.length;w++)g._howls[w]._emit("resume")}),g._suspendTimer&&(clearTimeout(g._suspendTimer),g._suspendTimer=null)):g.state==="suspending"&&(g._resumeAfterSuspend=!0),g}};var t=new e,n=function(g){var w=this;if(!g.src||g.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}w.init(g)};n.prototype={init:function(g){var w=this;return t.ctx||x(),w._autoplay=g.autoplay||!1,w._format=typeof g.format!="string"?g.format:[g.format],w._html5=g.html5||!1,w._muted=g.mute||!1,w._loop=g.loop||!1,w._pool=g.pool||5,w._preload=typeof g.preload=="boolean"||g.preload==="metadata"?g.preload:!0,w._rate=g.rate||1,w._sprite=g.sprite||{},w._src=typeof g.src!="string"?g.src:[g.src],w._volume=g.volume!==void 0?g.volume:1,w._xhr={method:g.xhr&&g.xhr.method?g.xhr.method:"GET",headers:g.xhr&&g.xhr.headers?g.xhr.headers:null,withCredentials:g.xhr&&g.xhr.withCredentials?g.xhr.withCredentials:!1},w._duration=0,w._state="unloaded",w._sounds=[],w._endTimers={},w._queue=[],w._playLock=!1,w._onend=g.onend?[{fn:g.onend}]:[],w._onfade=g.onfade?[{fn:g.onfade}]:[],w._onload=g.onload?[{fn:g.onload}]:[],w._onloaderror=g.onloaderror?[{fn:g.onloaderror}]:[],w._onplayerror=g.onplayerror?[{fn:g.onplayerror}]:[],w._onpause=g.onpause?[{fn:g.onpause}]:[],w._onplay=g.onplay?[{fn:g.onplay}]:[],w._onstop=g.onstop?[{fn:g.onstop}]:[],w._onmute=g.onmute?[{fn:g.onmute}]:[],w._onvolume=g.onvolume?[{fn:g.onvolume}]:[],w._onrate=g.onrate?[{fn:g.onrate}]:[],w._onseek=g.onseek?[{fn:g.onseek}]:[],w._onunlock=g.onunlock?[{fn:g.onunlock}]:[],w._onresume=[],w._webAudio=t.usingWebAudio&&!w._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(w),w._autoplay&&w._queue.push({event:"play",action:function(){w.play()}}),w._preload&&w._preload!=="none"&&w.load(),w},load:function(){var g=this,w=null;if(t.noAudio){g._emit("loaderror",null,"No audio support.");return}typeof g._src=="string"&&(g._src=[g._src]);for(var A=0;A<g._src.length;A++){var B,$;if(g._format&&g._format[A])B=g._format[A];else{if($=g._src[A],typeof $!="string"){g._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}B=/^data:audio\/([^;,]+);/i.exec($),B||(B=/\.([^.]+)$/.exec($.split("?",1)[0])),B&&(B=B[1].toLowerCase())}if(B||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),B&&t.codecs(B)){w=g._src[A];break}}if(!w){g._emit("loaderror",null,"No codec support for selected audio sources.");return}return g._src=w,g._state="loading",window.location.protocol==="https:"&&w.slice(0,5)==="http:"&&(g._html5=!0,g._webAudio=!1),new r(g),g._webAudio&&l(g),g},play:function(g,w){var A=this,B=null;if(typeof g=="number")B=g,g=null;else{if(typeof g=="string"&&A._state==="loaded"&&!A._sprite[g])return null;if(typeof g>"u"&&(g="__default",!A._playLock)){for(var $=0,W=0;W<A._sounds.length;W++)A._sounds[W]._paused&&!A._sounds[W]._ended&&($++,B=A._sounds[W]._id);$===1?g=null:B=null}}var q=B?A._soundById(B):A._inactiveSound();if(!q)return null;if(B&&!g&&(g=q._sprite||"__default"),A._state!=="loaded"){q._sprite=g,q._ended=!1;var ge=q._id;return A._queue.push({event:"play",action:function(){A.play(ge)}}),ge}if(B&&!q._paused)return w||A._loadQueue("play"),q._id;A._webAudio&&t._autoResume();var he=Math.max(0,q._seek>0?q._seek:A._sprite[g][0]/1e3),me=Math.max(0,(A._sprite[g][0]+A._sprite[g][1])/1e3-he),Ce=me*1e3/Math.abs(q._rate),Ve=A._sprite[g][0]/1e3,pe=(A._sprite[g][0]+A._sprite[g][1])/1e3;q._sprite=g,q._ended=!1;var ee=function(){q._paused=!1,q._seek=he,q._start=Ve,q._stop=pe,q._loop=!!(q._loop||A._sprite[g][2])};if(he>=pe){A._ended(q);return}var J=q._node;if(A._webAudio){var ye=function(){A._playLock=!1,ee(),A._refreshBuffer(q);var ze=q._muted||A._muted?0:q._volume;J.gain.setValueAtTime(ze,t.ctx.currentTime),q._playStart=t.ctx.currentTime,typeof J.bufferSource.start>"u"?q._loop?J.bufferSource.noteGrainOn(0,he,86400):J.bufferSource.noteGrainOn(0,he,me):q._loop?J.bufferSource.start(0,he,86400):J.bufferSource.start(0,he,me),Ce!==1/0&&(A._endTimers[q._id]=setTimeout(A._ended.bind(A,q),Ce)),w||setTimeout(function(){A._emit("play",q._id),A._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?ye():(A._playLock=!0,A.once("resume",ye),A._clearTimer(q._id))}else{var X=function(){J.currentTime=he,J.muted=q._muted||A._muted||t._muted||J.muted,J.volume=q._volume*t.volume(),J.playbackRate=q._rate;try{var ze=J.play();if(ze&&typeof Promise<"u"&&(ze instanceof Promise||typeof ze.then=="function")?(A._playLock=!0,ee(),ze.then(function(){A._playLock=!1,J._unlocked=!0,w?A._loadQueue():A._emit("play",q._id)}).catch(function(){A._playLock=!1,A._emit("playerror",q._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),q._ended=!0,q._paused=!0})):w||(A._playLock=!1,ee(),A._emit("play",q._id)),J.playbackRate=q._rate,J.paused){A._emit("playerror",q._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}g!=="__default"||q._loop?A._endTimers[q._id]=setTimeout(A._ended.bind(A,q),Ce):(A._endTimers[q._id]=function(){A._ended(q),J.removeEventListener("ended",A._endTimers[q._id],!1)},J.addEventListener("ended",A._endTimers[q._id],!1))}catch(nt){A._emit("playerror",q._id,nt)}};J.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(J.src=A._src,J.load());var ae=window&&window.ejecta||!J.readyState&&t._navigator.isCocoonJS;if(J.readyState>=3||ae)X();else{A._playLock=!0,A._state="loading";var le=function(){A._state="loaded",X(),J.removeEventListener(t._canPlayEvent,le,!1)};J.addEventListener(t._canPlayEvent,le,!1),A._clearTimer(q._id)}}return q._id},pause:function(g){var w=this;if(w._state!=="loaded"||w._playLock)return w._queue.push({event:"pause",action:function(){w.pause(g)}}),w;for(var A=w._getSoundIds(g),B=0;B<A.length;B++){w._clearTimer(A[B]);var $=w._soundById(A[B]);if($&&!$._paused&&($._seek=w.seek(A[B]),$._rateSeek=0,$._paused=!0,w._stopFade(A[B]),$._node))if(w._webAudio){if(!$._node.bufferSource)continue;typeof $._node.bufferSource.stop>"u"?$._node.bufferSource.noteOff(0):$._node.bufferSource.stop(0),w._cleanBuffer($._node)}else(!isNaN($._node.duration)||$._node.duration===1/0)&&$._node.pause();arguments[1]||w._emit("pause",$?$._id:null)}return w},stop:function(g,w){var A=this;if(A._state!=="loaded"||A._playLock)return A._queue.push({event:"stop",action:function(){A.stop(g)}}),A;for(var B=A._getSoundIds(g),$=0;$<B.length;$++){A._clearTimer(B[$]);var W=A._soundById(B[$]);W&&(W._seek=W._start||0,W._rateSeek=0,W._paused=!0,W._ended=!0,A._stopFade(B[$]),W._node&&(A._webAudio?W._node.bufferSource&&(typeof W._node.bufferSource.stop>"u"?W._node.bufferSource.noteOff(0):W._node.bufferSource.stop(0),A._cleanBuffer(W._node)):(!isNaN(W._node.duration)||W._node.duration===1/0)&&(W._node.currentTime=W._start||0,W._node.pause(),W._node.duration===1/0&&A._clearSound(W._node))),w||A._emit("stop",W._id))}return A},mute:function(g,w){var A=this;if(A._state!=="loaded"||A._playLock)return A._queue.push({event:"mute",action:function(){A.mute(g,w)}}),A;if(typeof w>"u")if(typeof g=="boolean")A._muted=g;else return A._muted;for(var B=A._getSoundIds(w),$=0;$<B.length;$++){var W=A._soundById(B[$]);W&&(W._muted=g,W._interval&&A._stopFade(W._id),A._webAudio&&W._node?W._node.gain.setValueAtTime(g?0:W._volume,t.ctx.currentTime):W._node&&(W._node.muted=t._muted?!0:g),A._emit("mute",W._id))}return A},volume:function(){var g=this,w=arguments,A,B;if(w.length===0)return g._volume;if(w.length===1||w.length===2&&typeof w[1]>"u"){var $=g._getSoundIds(),W=$.indexOf(w[0]);W>=0?B=parseInt(w[0],10):A=parseFloat(w[0])}else w.length>=2&&(A=parseFloat(w[0]),B=parseInt(w[1],10));var q;if(typeof A<"u"&&A>=0&&A<=1){if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"volume",action:function(){g.volume.apply(g,w)}}),g;typeof B>"u"&&(g._volume=A),B=g._getSoundIds(B);for(var ge=0;ge<B.length;ge++)q=g._soundById(B[ge]),q&&(q._volume=A,w[2]||g._stopFade(B[ge]),g._webAudio&&q._node&&!q._muted?q._node.gain.setValueAtTime(A,t.ctx.currentTime):q._node&&!q._muted&&(q._node.volume=A*t.volume()),g._emit("volume",q._id))}else return q=B?g._soundById(B):g._sounds[0],q?q._volume:0;return g},fade:function(g,w,A,B){var $=this;if($._state!=="loaded"||$._playLock)return $._queue.push({event:"fade",action:function(){$.fade(g,w,A,B)}}),$;g=Math.min(Math.max(0,parseFloat(g)),1),w=Math.min(Math.max(0,parseFloat(w)),1),A=parseFloat(A),$.volume(g,B);for(var W=$._getSoundIds(B),q=0;q<W.length;q++){var ge=$._soundById(W[q]);if(ge){if(B||$._stopFade(W[q]),$._webAudio&&!ge._muted){var he=t.ctx.currentTime,me=he+A/1e3;ge._volume=g,ge._node.gain.setValueAtTime(g,he),ge._node.gain.linearRampToValueAtTime(w,me)}$._startFadeInterval(ge,g,w,A,W[q],typeof B>"u")}}return $},_startFadeInterval:function(g,w,A,B,$,W){var q=this,ge=w,he=A-w,me=Math.abs(he/.01),Ce=Math.max(4,me>0?B/me:B),Ve=Date.now();g._fadeTo=A,g._interval=setInterval(function(){var pe=(Date.now()-Ve)/B;Ve=Date.now(),ge+=he*pe,ge=Math.round(ge*100)/100,he<0?ge=Math.max(A,ge):ge=Math.min(A,ge),q._webAudio?g._volume=ge:q.volume(ge,g._id,!0),W&&(q._volume=ge),(A<w&&ge<=A||A>w&&ge>=A)&&(clearInterval(g._interval),g._interval=null,g._fadeTo=null,q.volume(A,g._id),q._emit("fade",g._id))},Ce)},_stopFade:function(g){var w=this,A=w._soundById(g);return A&&A._interval&&(w._webAudio&&A._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(A._interval),A._interval=null,w.volume(A._fadeTo,g),A._fadeTo=null,w._emit("fade",g)),w},loop:function(){var g=this,w=arguments,A,B,$;if(w.length===0)return g._loop;if(w.length===1)if(typeof w[0]=="boolean")A=w[0],g._loop=A;else return $=g._soundById(parseInt(w[0],10)),$?$._loop:!1;else w.length===2&&(A=w[0],B=parseInt(w[1],10));for(var W=g._getSoundIds(B),q=0;q<W.length;q++)$=g._soundById(W[q]),$&&($._loop=A,g._webAudio&&$._node&&$._node.bufferSource&&($._node.bufferSource.loop=A,A&&($._node.bufferSource.loopStart=$._start||0,$._node.bufferSource.loopEnd=$._stop,g.playing(W[q])&&(g.pause(W[q],!0),g.play(W[q],!0)))));return g},rate:function(){var g=this,w=arguments,A,B;if(w.length===0)B=g._sounds[0]._id;else if(w.length===1){var $=g._getSoundIds(),W=$.indexOf(w[0]);W>=0?B=parseInt(w[0],10):A=parseFloat(w[0])}else w.length===2&&(A=parseFloat(w[0]),B=parseInt(w[1],10));var q;if(typeof A=="number"){if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"rate",action:function(){g.rate.apply(g,w)}}),g;typeof B>"u"&&(g._rate=A),B=g._getSoundIds(B);for(var ge=0;ge<B.length;ge++)if(q=g._soundById(B[ge]),q){g.playing(B[ge])&&(q._rateSeek=g.seek(B[ge]),q._playStart=g._webAudio?t.ctx.currentTime:q._playStart),q._rate=A,g._webAudio&&q._node&&q._node.bufferSource?q._node.bufferSource.playbackRate.setValueAtTime(A,t.ctx.currentTime):q._node&&(q._node.playbackRate=A);var he=g.seek(B[ge]),me=(g._sprite[q._sprite][0]+g._sprite[q._sprite][1])/1e3-he,Ce=me*1e3/Math.abs(q._rate);(g._endTimers[B[ge]]||!q._paused)&&(g._clearTimer(B[ge]),g._endTimers[B[ge]]=setTimeout(g._ended.bind(g,q),Ce)),g._emit("rate",q._id)}}else return q=g._soundById(B),q?q._rate:g._rate;return g},seek:function(){var g=this,w=arguments,A,B;if(w.length===0)g._sounds.length&&(B=g._sounds[0]._id);else if(w.length===1){var $=g._getSoundIds(),W=$.indexOf(w[0]);W>=0?B=parseInt(w[0],10):g._sounds.length&&(B=g._sounds[0]._id,A=parseFloat(w[0]))}else w.length===2&&(A=parseFloat(w[0]),B=parseInt(w[1],10));if(typeof B>"u")return 0;if(typeof A=="number"&&(g._state!=="loaded"||g._playLock))return g._queue.push({event:"seek",action:function(){g.seek.apply(g,w)}}),g;var q=g._soundById(B);if(q)if(typeof A=="number"&&A>=0){var ge=g.playing(B);ge&&g.pause(B,!0),q._seek=A,q._ended=!1,g._clearTimer(B),!g._webAudio&&q._node&&!isNaN(q._node.duration)&&(q._node.currentTime=A);var he=function(){ge&&g.play(B,!0),g._emit("seek",B)};if(ge&&!g._webAudio){var me=function(){g._playLock?setTimeout(me,0):he()};setTimeout(me,0)}else he()}else if(g._webAudio){var Ce=g.playing(B)?t.ctx.currentTime-q._playStart:0,Ve=q._rateSeek?q._rateSeek-q._seek:0;return q._seek+(Ve+Ce*Math.abs(q._rate))}else return q._node.currentTime;return g},playing:function(g){var w=this;if(typeof g=="number"){var A=w._soundById(g);return A?!A._paused:!1}for(var B=0;B<w._sounds.length;B++)if(!w._sounds[B]._paused)return!0;return!1},duration:function(g){var w=this,A=w._duration,B=w._soundById(g);return B&&(A=w._sprite[B._sprite][1]/1e3),A},state:function(){return this._state},unload:function(){for(var g=this,w=g._sounds,A=0;A<w.length;A++)w[A]._paused||g.stop(w[A]._id),g._webAudio||(g._clearSound(w[A]._node),w[A]._node.removeEventListener("error",w[A]._errorFn,!1),w[A]._node.removeEventListener(t._canPlayEvent,w[A]._loadFn,!1),w[A]._node.removeEventListener("ended",w[A]._endFn,!1),t._releaseHtml5Audio(w[A]._node)),delete w[A]._node,g._clearTimer(w[A]._id);var B=t._howls.indexOf(g);B>=0&&t._howls.splice(B,1);var $=!0;for(A=0;A<t._howls.length;A++)if(t._howls[A]._src===g._src||g._src.indexOf(t._howls[A]._src)>=0){$=!1;break}return s&&$&&delete s[g._src],t.noAudio=!1,g._state="unloaded",g._sounds=[],g=null,null},on:function(g,w,A,B){var $=this,W=$["_on"+g];return typeof w=="function"&&W.push(B?{id:A,fn:w,once:B}:{id:A,fn:w}),$},off:function(g,w,A){var B=this,$=B["_on"+g],W=0;if(typeof w=="number"&&(A=w,w=null),w||A)for(W=0;W<$.length;W++){var q=A===$[W].id;if(w===$[W].fn&&q||!w&&q){$.splice(W,1);break}}else if(g)B["_on"+g]=[];else{var ge=Object.keys(B);for(W=0;W<ge.length;W++)ge[W].indexOf("_on")===0&&Array.isArray(B[ge[W]])&&(B[ge[W]]=[])}return B},once:function(g,w,A){var B=this;return B.on(g,w,A,1),B},_emit:function(g,w,A){for(var B=this,$=B["_on"+g],W=$.length-1;W>=0;W--)(!$[W].id||$[W].id===w||g==="load")&&(setTimeout((function(q){q.call(this,w,A)}).bind(B,$[W].fn),0),$[W].once&&B.off(g,$[W].fn,$[W].id));return B._loadQueue(g),B},_loadQueue:function(g){var w=this;if(w._queue.length>0){var A=w._queue[0];A.event===g&&(w._queue.shift(),w._loadQueue()),g||A.action()}return w},_ended:function(g){var w=this,A=g._sprite;if(!w._webAudio&&g._node&&!g._node.paused&&!g._node.ended&&g._node.currentTime<g._stop)return setTimeout(w._ended.bind(w,g),100),w;var B=!!(g._loop||w._sprite[A][2]);if(w._emit("end",g._id),!w._webAudio&&B&&w.stop(g._id,!0).play(g._id),w._webAudio&&B){w._emit("play",g._id),g._seek=g._start||0,g._rateSeek=0,g._playStart=t.ctx.currentTime;var $=(g._stop-g._start)*1e3/Math.abs(g._rate);w._endTimers[g._id]=setTimeout(w._ended.bind(w,g),$)}return w._webAudio&&!B&&(g._paused=!0,g._ended=!0,g._seek=g._start||0,g._rateSeek=0,w._clearTimer(g._id),w._cleanBuffer(g._node),t._autoSuspend()),!w._webAudio&&!B&&w.stop(g._id,!0),w},_clearTimer:function(g){var w=this;if(w._endTimers[g]){if(typeof w._endTimers[g]!="function")clearTimeout(w._endTimers[g]);else{var A=w._soundById(g);A&&A._node&&A._node.removeEventListener("ended",w._endTimers[g],!1)}delete w._endTimers[g]}return w},_soundById:function(g){for(var w=this,A=0;A<w._sounds.length;A++)if(g===w._sounds[A]._id)return w._sounds[A];return null},_inactiveSound:function(){var g=this;g._drain();for(var w=0;w<g._sounds.length;w++)if(g._sounds[w]._ended)return g._sounds[w].reset();return new r(g)},_drain:function(){var g=this,w=g._pool,A=0,B=0;if(!(g._sounds.length<w)){for(B=0;B<g._sounds.length;B++)g._sounds[B]._ended&&A++;for(B=g._sounds.length-1;B>=0;B--){if(A<=w)return;g._sounds[B]._ended&&(g._webAudio&&g._sounds[B]._node&&g._sounds[B]._node.disconnect(0),g._sounds.splice(B,1),A--)}}},_getSoundIds:function(g){var w=this;if(typeof g>"u"){for(var A=[],B=0;B<w._sounds.length;B++)A.push(w._sounds[B]._id);return A}else return[g]},_refreshBuffer:function(g){var w=this;return g._node.bufferSource=t.ctx.createBufferSource(),g._node.bufferSource.buffer=s[w._src],g._panner?g._node.bufferSource.connect(g._panner):g._node.bufferSource.connect(g._node),g._node.bufferSource.loop=g._loop,g._loop&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop||0),g._node.bufferSource.playbackRate.setValueAtTime(g._rate,t.ctx.currentTime),w},_cleanBuffer:function(g){var w=this,A=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!g.bufferSource)return w;if(t._scratchBuffer&&g.bufferSource&&(g.bufferSource.onended=null,g.bufferSource.disconnect(0),A))try{g.bufferSource.buffer=t._scratchBuffer}catch{}return g.bufferSource=null,w},_clearSound:function(g){var w=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);w||(g.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(g){this._parent=g,this.init()};r.prototype={init:function(){var g=this,w=g._parent;return g._muted=w._muted,g._loop=w._loop,g._volume=w._volume,g._rate=w._rate,g._seek=0,g._paused=!0,g._ended=!0,g._sprite="__default",g._id=++t._counter,w._sounds.push(g),g.create(),g},create:function(){var g=this,w=g._parent,A=t._muted||g._muted||g._parent._muted?0:g._volume;return w._webAudio?(g._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),g._node.gain.setValueAtTime(A,t.ctx.currentTime),g._node.paused=!0,g._node.connect(t.masterGain)):t.noAudio||(g._node=t._obtainHtml5Audio(),g._errorFn=g._errorListener.bind(g),g._node.addEventListener("error",g._errorFn,!1),g._loadFn=g._loadListener.bind(g),g._node.addEventListener(t._canPlayEvent,g._loadFn,!1),g._endFn=g._endListener.bind(g),g._node.addEventListener("ended",g._endFn,!1),g._node.src=w._src,g._node.preload=w._preload===!0?"auto":w._preload,g._node.volume=A*t.volume(),g._node.load()),g},reset:function(){var g=this,w=g._parent;return g._muted=w._muted,g._loop=w._loop,g._volume=w._volume,g._rate=w._rate,g._seek=0,g._rateSeek=0,g._paused=!0,g._ended=!0,g._sprite="__default",g._id=++t._counter,g},_errorListener:function(){var g=this;g._parent._emit("loaderror",g._id,g._node.error?g._node.error.code:0),g._node.removeEventListener("error",g._errorFn,!1)},_loadListener:function(){var g=this,w=g._parent;w._duration=Math.ceil(g._node.duration*10)/10,Object.keys(w._sprite).length===0&&(w._sprite={__default:[0,w._duration*1e3]}),w._state!=="loaded"&&(w._state="loaded",w._emit("load"),w._loadQueue()),g._node.removeEventListener(t._canPlayEvent,g._loadFn,!1)},_endListener:function(){var g=this,w=g._parent;w._duration===1/0&&(w._duration=Math.ceil(g._node.duration*10)/10,w._sprite.__default[1]===1/0&&(w._sprite.__default[1]=w._duration*1e3),w._ended(g)),g._node.removeEventListener("ended",g._endFn,!1)}};var s={},l=function(g){var w=g._src;if(s[w]){g._duration=s[w].duration,f(g);return}if(/^data:[^;]+;base64,/.test(w)){for(var A=atob(w.split(",")[1]),B=new Uint8Array(A.length),$=0;$<A.length;++$)B[$]=A.charCodeAt($);h(B.buffer,g)}else{var W=new XMLHttpRequest;W.open(g._xhr.method,w,!0),W.withCredentials=g._xhr.withCredentials,W.responseType="arraybuffer",g._xhr.headers&&Object.keys(g._xhr.headers).forEach(function(q){W.setRequestHeader(q,g._xhr.headers[q])}),W.onload=function(){var q=(W.status+"")[0];if(q!=="0"&&q!=="2"&&q!=="3"){g._emit("loaderror",null,"Failed loading audio file with status: "+W.status+".");return}h(W.response,g)},W.onerror=function(){g._webAudio&&(g._html5=!0,g._webAudio=!1,g._sounds=[],delete s[w],g.load())},u(W)}},u=function(g){try{g.send()}catch{g.onerror()}},h=function(g,w){var A=function(){w._emit("loaderror",null,"Decoding audio data failed.")},B=function($){$&&w._sounds.length>0?(s[w._src]=$,f(w,$)):A()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(g).then(B).catch(A):t.ctx.decodeAudioData(g,B,A)},f=function(g,w){w&&!g._duration&&(g._duration=w.duration),Object.keys(g._sprite).length===0&&(g._sprite={__default:[0,g._duration*1e3]}),g._state!=="loaded"&&(g._state="loaded",g._emit("load"),g._loadQueue())},x=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var g=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),w=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),A=w?parseInt(w[1],10):null;if(g&&A&&A<9){var B=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!B&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};i.Howler=t,i.Howl=n,typeof Rd<"u"?(Rd.HowlerGlobal=e,Rd.Howler=t,Rd.Howl=n,Rd.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=r)})();(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(t);return n},HowlerGlobal.prototype.pos=function(t,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof t=="number")s._pos=[t,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,n,r,s,l,u){var h=this;if(!h.ctx||!h.ctx.listener)return h;var f=h._orientation;if(n=typeof n!="number"?f[1]:n,r=typeof r!="number"?f[2]:r,s=typeof s!="number"?f[3]:s,l=typeof l!="number"?f[4]:l,u=typeof u!="number"?f[5]:u,typeof t=="number")h._orientation=[t,n,r,s,l,u],typeof h.ctx.listener.forwardX<"u"?(h.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),h.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),h.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),h.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),h.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),h.ctx.listener.upZ.setTargetAtTime(u,Howler.ctx.currentTime,.1)):h.ctx.listener.setOrientation(t,n,r,s,l,u);else return f;return h},Howl.prototype.init=(function(t){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],t.call(this,n)}})(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof t=="number")r._stereo=t,r._pos=[t,0,0];else return r._stereo;for(var l=r._getSoundIds(n),u=0;u<l.length;u++){var h=r._soundById(l[u]);if(h)if(typeof t=="number")h._stereo=t,h._pos=[t,0,0],h._node&&(h._pannerAttr.panningModel="equalpower",(!h._panner||!h._panner.pan)&&e(h,s),s==="spatial"?typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):h._panner.setPosition(t,0,0):h._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",h._id);else return h._stereo}return r},Howl.prototype.pos=function(t,n,r,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"pos",action:function(){l.pos(t,n,r,s)}}),l;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof t=="number")l._pos=[t,n,r];else return l._pos;for(var u=l._getSoundIds(s),h=0;h<u.length;h++){var f=l._soundById(u[h]);if(f)if(typeof t=="number")f._pos=[t,n,r],f._node&&((!f._panner||f._panner.pan)&&e(f,"spatial"),typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):f._panner.setPosition(t,n,r)),l._emit("pos",f._id);else return f._pos}return l},Howl.prototype.orientation=function(t,n,r,s){var l=this;if(!l._webAudio)return l;if(l._state!=="loaded")return l._queue.push({event:"orientation",action:function(){l.orientation(t,n,r,s)}}),l;if(n=typeof n!="number"?l._orientation[1]:n,r=typeof r!="number"?l._orientation[2]:r,typeof s>"u")if(typeof t=="number")l._orientation=[t,n,r];else return l._orientation;for(var u=l._getSoundIds(s),h=0;h<u.length;h++){var f=l._soundById(u[h]);if(f)if(typeof t=="number")f._orientation=[t,n,r],f._node&&(f._panner||(f._pos||(f._pos=l._pos||[0,0,-.5]),e(f,"spatial")),typeof f._panner.orientationX<"u"?(f._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),f._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),f._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):f._panner.setOrientation(t,n,r)),l._emit("orientation",f._id);else return f._orientation}return l},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,r,s,l;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),t._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:t._panningModel});else return l=t._soundById(parseInt(n[0],10)),l?l._pannerAttr:t._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var u=t._getSoundIds(s),h=0;h<u.length;h++)if(l=t._soundById(u[h]),l){var f=l._pannerAttr;f={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:f.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:f.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:f.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:f.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:f.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:f.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:f.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:f.panningModel};var x=l._panner;x||(l._pos||(l._pos=t._pos||[0,0,-.5]),e(l,"spatial"),x=l._panner),x.coneInnerAngle=f.coneInnerAngle,x.coneOuterAngle=f.coneOuterAngle,x.coneOuterGain=f.coneOuterGain,x.distanceModel=f.distanceModel,x.maxDistance=f.maxDistance,x.refDistance=f.refDistance,x.rolloffFactor=f.rolloffFactor,x.panningModel=f.panningModel}return t},Sound.prototype.init=(function(t){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,t.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}})(Sound.prototype.init),Sound.prototype.reset=(function(t){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),t.call(this)}})(Sound.prototype.reset);var e=function(t,n){n=n||"spatial",n==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(hb)),hb}var WG=KG(),rp;(function(i){i.Documents="DOCUMENTS",i.Data="DATA",i.Library="LIBRARY",i.Cache="CACHE",i.External="EXTERNAL",i.ExternalStorage="EXTERNAL_STORAGE",i.ExternalCache="EXTERNAL_CACHE",i.LibraryNoCloud="LIBRARY_NO_CLOUD",i.Temporary="TEMPORARY"})(rp||(rp={}));var SI;(function(i){i.UTF8="utf8",i.ASCII="ascii",i.UTF16="utf16"})(SI||(SI={}));const I0=Ul("Filesystem",{web:()=>Vt(()=>import("./chunk-1765759384263-web8.js"),[]).then(i=>new i.FilesystemWeb)});X4();class qG{constructor(){this.apiKey="sk_1d59e38548886708c7439a957aa38a7a5d5cbead7e840c4f",this.voiceId="EXAVITQu4vr4xnSDxMaL",this.baseUrl="https://api.elevenlabs.io/v1",this.audioCache=new Map,this.apiKey}setApiKey(e){this.apiKey=e}async generateSpeech(e){if(!this.apiKey)return null;if(this.audioCache.has(e))return this.audioCache.get(e);try{const t=await fetch(`${this.baseUrl}/text-to-speech/${this.voiceId}`,{method:"POST",headers:{Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":this.apiKey},body:JSON.stringify({text:e,model_id:"eleven_multilingual_v2",voice_settings:{stability:.5,similarity_boost:.75,style:0,use_speaker_boost:!0}})});if(!t.ok)throw new Error(`ElevenLabs API error: ${t.status} ${t.statusText}`);const n=await t.blob(),r=URL.createObjectURL(n);return this.audioCache.set(e,r),r}catch{return null}}async preGenerateBreathingPhrases(){const e=["ready","breathe in","hold","breathe out","rest","complete"],t=e.map(s=>this.generateSpeech(s));return(await Promise.all(t)).filter(s=>s!==null).length===e.length}async downloadAndSaveAudio(e,t){const n=await this.generateSpeech(e);if(!n)return null;try{const s=await(await fetch(n)).blob(),l=new FileReader;return new Promise((u,h)=>{l.onloadend=async()=>{const f=l.result.split(",")[1];try{const x=await I0.writeFile({path:`audio/${t}`,data:f,directory:rp.Data});u(x.uri)}catch(x){h(x)}},l.onerror=h,l.readAsDataURL(s)})}catch{return null}}clearCache(){this.audioCache.forEach(e=>URL.revokeObjectURL(e)),this.audioCache.clear()}}const db=new qG;class YG{constructor(){this.currentVoice="female",this.currentAudio=null,this.audioCache=new Map;const e="sk_1d59e38548886708c7439a957aa38a7a5d5cbead7e840c4f";this.useElevenLabs=!0,db.setApiKey(e),this.voiceConfig={female:{voiceId:"en_us_002",name:"Aimee-like (Ultra Realistic)",rate:.05,volume:.4},male:{voiceId:"en_male_narration",name:"Deep Male (Meditation)",rate:.05,volume:.4}}}setVoice(e){this.currentVoice=e}generateVoiceURL(e){const t=this.currentVoice==="female"?"en_us_002":"en_male_narration",n=e.split(" ").map(s=>s.split("").join(" ")+"                                                  ").join("");return`https://api16-normal-c-useast1a.tiktokv.com/media/api/text/speech/invoke/?text_speaker=${t}&req_text=${encodeURIComponent(n)}&speaker_map_type=0&aid=1233`}enableElevenLabs(e){this.useElevenLabs=!0,db.setApiKey(e)}async preGeneratePhrases(){return this.useElevenLabs?await db.preGenerateBreathingPhrases():!1}async speak(e){this.stop();const n={ready:"/ready.mp3","breathe in":"/breathe-in.mp3",hold:"/hold.mp3","breathe out":"/breathe-out.mp3",rest:"/rest.mp3",complete:"/complete.mp3"}[e.toLowerCase()];if(n)try{await this.playAudioFile(n);return}catch{}await this.speakWithTTS(e)}async playAudioFile(e){return new Promise((t,n)=>{this.currentAudio=new WG.Howl({src:[e],html5:!0,volume:.8,onend:()=>{t()},onloaderror:(r,s)=>{n(s)},onplayerror:(r,s)=>{n(s)}}),this.currentAudio.play()})}async speakWithTTS(e){try{await Xw.speak({text:e,lang:"en-US",rate:.85,pitch:1,volume:.7,category:"ambient"})}catch{}}stop(){this.currentAudio&&(this.currentAudio.stop(),this.currentAudio.unload(),this.currentAudio=null)}clearCache(){this.audioCache.clear()}}const $c=new YG;class XG{constructor(){this.isActive=!1,this.currentPattern=null,this.currentCycle=0,this.totalCycles=0,this.voice="female",this.ambientSound=HG,this.tts=Xw,this.audioService=$c,this.useRealVoice=!0}patterns={box:{name:"Box Breathing",description:"Navy SEAL technique - Perfect for stress relief and focus",phases:[{type:"inhale",duration:4,text:"breathe in",audio:"/box-inhale.mp3"},{type:"hold",duration:4,text:"hold",audio:"/box-hold.mp3"},{type:"exhale",duration:4,text:"breathe out",audio:"/box-exhale.mp3"},{type:"hold",duration:4,text:"rest",audio:"/box-hold2.mp3"}],icon:"",benefits:["Reduces stress","Improves focus","Calms nervous system"],welcomeAudio:"/box-welcome.mp3",completeAudio:"/box-complete.mp3"},relaxing:{name:"4-7-8 Breathing",description:"Dr. Andrew Weil method - Induces natural sleep",phases:[{type:"inhale",duration:4,text:"breathe in",audio:"/box-inhale.mp3"},{type:"hold",duration:7,text:"hold",audio:"/box-hold.mp3"},{type:"exhale",duration:8,text:"breathe out slowly",audio:"/breathe-out-slowly.mp3"}],icon:"",benefits:["Promotes sleep","Reduces anxiety","Deep relaxation"],welcomeAudio:"/478-welcome.mp3",completeAudio:"/478-complete.mp3"},coherent:{name:"Coherent Breathing",description:"Heart Rate Variability optimization",phases:[{type:"inhale",duration:5,text:"breathe in",audio:"/box-inhale.mp3"},{type:"exhale",duration:5,text:"breathe out",audio:"/box-exhale.mp3"}],icon:"",benefits:["Heart health","Mental clarity","Emotional balance"],welcomeAudio:"/coherent-welcome.mp3",completeAudio:"/coherent-complete.mp3"},energizing:{name:"Energizing Breath",description:"Morning boost - Increases alertness",phases:[{type:"inhale",duration:4,text:"breathe in",audio:"/box-inhale.mp3"},{type:"hold",duration:2,text:"hold",audio:"/box-hold.mp3"},{type:"exhale",duration:4,text:"breathe out",audio:"/box-exhale.mp3"},{type:"hold",duration:2,text:"rest",audio:"/rest.mp3"}],icon:"",benefits:["Boosts energy","Improves alertness","Morning wake-up"],welcomeAudio:"/energizing-welcome.mp3",completeAudio:"/energizing-complete.mp3"},deepRelax:{name:"Deep Relaxation",description:"Extended exhale for maximum calm",phases:[{type:"inhale",duration:4,text:"breathe in",audio:"/box-inhale.mp3"},{type:"hold",duration:4,text:"hold",audio:"/box-hold.mp3"},{type:"exhale",duration:6,text:"breathe out slowly",audio:"/breathe-out-slowly.mp3"},{type:"hold",duration:2,text:"rest",audio:"/rest.mp3"}],icon:"",benefits:["Deep relaxation","Meditation support","Stress relief"],welcomeAudio:"/relaxation-welcome.mp3",completeAudio:"/relaxation-complete.mp3"}};getPatterns(){return Object.entries(this.patterns).map(([e,t])=>({id:e,...t}))}setVoice(e){this.voice=e,this.audioService.setVoice(e),localStorage.setItem("breathing_voice_preference",e)}getVoicePreference(){return localStorage.getItem("breathing_voice_preference")||"female"}async speak(e,t=.65,n=null){try{if(n)await this.audioService.playAudioFile(n);else if(this.useRealVoice)await this.audioService.speak(e);else{const r=this.voice==="female";await this.tts.speak({text:e,lang:"en-US",rate:r?.65:.6,pitch:r?1.3:.7,volume:1,category:"ambient"})}}catch{}}async startExercise(e,t=5,n,r,s){const l=this.patterns[e];if(!l)throw new Error("Invalid pattern");this.isActive=!0,this.currentPattern=l,this.currentCycle=0;const u=l.phases.reduce((f,x)=>f+x.duration,0);this.totalCycles=Math.floor(t*60/u),await this.ambientSound.start(),await this.sleep(1e3);const h=l.welcomeAudio||null;await this.speak("ready",.5,h),await this.sleep(2e3);for(let f=0;f<this.totalCycles&&this.isActive;f++){this.currentCycle=f+1;for(const x of l.phases){if(!this.isActive)break;n&&n({phase:x.type,text:x.text,duration:x.duration,cycle:this.currentCycle,totalCycles:this.totalCycles});const g=x.audio||null;this.speak(x.text,0,g);for(let w=0;w<x.duration&&this.isActive;w++)await this.sleep(1e3)}r&&this.isActive&&r(this.currentCycle,this.totalCycles)}if(this.isActive&&s){const f=l.completeAudio||null;await this.speak("complete",.5,f),await this.sleep(2e3),this.ambientSound.stop(),this.logSession(e,t),s({pattern:l.name,cycles:this.currentCycle,duration:t})}this.isActive=!1}async stopExercise(){this.isActive=!1,this.ambientSound.stop(),this.audioService.stop();try{await this.tts.stop()}catch{}}sleep(e){return new Promise(t=>setTimeout(t,e))}async logSession(e,t){const n=JSON.parse(localStorage.getItem("breathing_history")||"[]"),r={pattern:this.patterns[e].name,patternId:e,duration:t,cycles:this.currentCycle,timestamp:Date.now(),date:new Date().toISOString().split("T")[0]};n.push(r),localStorage.setItem("breathing_history",JSON.stringify(n));let s=[];try{s=await Ei.get("meditationLog",Ii.getCurrentUser()?.uid)||[]}catch{s=JSON.parse(localStorage.getItem("meditationLog")||"[]")}s.push({type:"breathing",duration:t,timestamp:Date.now(),date:new Date().toISOString().split("T")[0]}),localStorage.setItem("meditationLog",JSON.stringify(s));try{await Ei.save("meditationLog",s,Ii.getCurrentUser()?.uid)}catch{}}getHistory(e=30){const t=JSON.parse(localStorage.getItem("breathing_history")||"[]"),n=new Date;return n.setDate(n.getDate()-e),t.filter(r=>new Date(r.timestamp)>n)}getStats(){const e=this.getHistory(30),t=e.length,n=e.reduce((u,h)=>u+h.duration,0),r=e.reduce((u,h)=>u+h.cycles,0),s={};e.forEach(u=>{s[u.pattern]=(s[u.pattern]||0)+1});const l=Object.entries(s).sort((u,h)=>h[1]-u[1])[0];return{totalSessions:t,totalMinutes:n,totalCycles:r,averageMinutesPerSession:t>0?Math.round(n/t):0,favoritePattern:l?l[0]:null,streak:this.calculateStreak(e)}}calculateStreak(e){if(e.length===0)return 0;const t=[...new Set(e.map(l=>l.date))].sort().reverse();let n=0;const r=new Date().toISOString().split("T")[0];let s=new Date(r);for(const l of t){const u=new Date(l),h=Math.floor((s-u)/(1e3*60*60*24));if(h===n)n++;else if(h>n)break}return n}}const Ag=new XG,TI="wellnessai_gamification",Jy={1:0,2:100,3:250,4:450,5:600,6:1e3,7:1500,8:2100,9:2800,10:3600,11:4500,12:5500,13:6600,14:7800,15:9100,16:10500,17:12e3,18:13600,19:15300,20:17100},Tu={FIRST_STEP:{id:"first_step",name:"First Step",description:"Log your first activity",icon:"",xp:10},FIRE_STARTER:{id:"fire_starter",name:"Fire Starter",description:"Reach a 3-day streak",icon:"",xp:25},WEEK_WARRIOR:{id:"week_warrior",name:"Week Warrior",description:"Maintain a 7-day streak",icon:"",xp:50},HYDRATION_HERO:{id:"hydration_hero",name:"Hydration Hero",description:"Drink 8 glasses of water in one day",icon:"",xp:20},NUTRITION_NINJA:{id:"nutrition_ninja",name:"Nutrition Ninja",description:"Log 7 days of healthy meals",icon:"",xp:40},STRENGTH_PRO:{id:"strength_pro",name:"Strength Pro",description:"Complete 10 workouts",icon:"",xp:50},MARATHON_MASTER:{id:"marathon_master",name:"Marathon Master",description:"Walk 100,000 steps total",icon:"",xp:100},SCANNER_SAVVY:{id:"scanner_savvy",name:"Scanner Savvy",description:"Scan 20 food items",icon:"",xp:30},ZEN_MASTER:{id:"zen_master",name:"Zen Master",description:"Complete 10 meditation sessions",icon:"",xp:40},PERFECT_DAY:{id:"perfect_day",name:"Perfect Day",description:"Complete all daily goals in one day",icon:"",xp:50}};class JG{constructor(){this.syncService=null,this.loadData()}setSyncService(e){this.syncService=e}async loadData(){if(this.syncService){const t=await Ei.get("gamification_data",Ii.getCurrentUser()?.uid);if(t){this.data=t;return}}const e=localStorage.getItem(TI);if(e){this.data=JSON.parse(e),this.syncService&&await Ei.save("gamification_data",this.data,Ii.getCurrentUser()?.uid);return}this.data={level:1,xp:0,totalXP:0,streak:0,longestStreak:0,lastCheckIn:null,achievements:[],stats:{totalSteps:0,totalWater:0,totalMeals:0,totalWorkouts:0,totalScans:0,totalMeditations:0,perfectDays:0}}}async saveData(){this.syncService?await Ei.save("gamification_data",this.data,Ii.getCurrentUser()?.uid):localStorage.setItem(TI,JSON.stringify(this.data))}async addXP(e,t=""){this.data.xp+=e,this.data.totalXP+=e;const n=this.checkLevelUp();return await this.saveData(),{xpGained:e,currentXP:this.data.xp,currentLevel:this.data.level,leveledUp:n,reason:t}}checkLevelUp(){const e=this.data.level+1,t=Jy[e];return t&&this.data.totalXP>=t?(this.data.level=e,this.data.xp=0,!0):!1}getXPToNextLevel(){const e=this.data.level+1,t=Jy[e];return t?t-this.data.totalXP:0}getLevelInfo(){const e=this.data.level+1,t=Jy[e],n=Jy[this.data.level];return{level:this.data.level,xp:this.data.xp,totalXP:this.data.totalXP,xpToNext:t?t-this.data.totalXP:0,xpForCurrentLevel:t?t-n:0,progress:t?(this.data.totalXP-n)/(t-n)*100:100}}async checkIn(){const e=new Date().toDateString(),t=this.data.lastCheckIn?new Date(this.data.lastCheckIn).toDateString():null;if(t===e)return{alreadyCheckedIn:!0,streak:this.data.streak};const n=new Date;n.setDate(n.getDate()-1);const r=n.toDateString();t===r?this.data.streak+=1:t===null?this.data.streak=1:this.data.streak=1,this.data.lastCheckIn=new Date().toISOString(),this.data.streak>this.data.longestStreak&&(this.data.longestStreak=this.data.streak);const s=await this.addXP(10,"Daily check-in");return this.checkStreakAchievements(),await this.saveData(),{alreadyCheckedIn:!1,streak:this.data.streak,longestStreak:this.data.longestStreak,xpGained:s.xpGained,leveledUp:s.leveledUp}}checkStreakAchievements(){this.data.streak>=3&&!this.hasAchievement("fire_starter")&&this.unlockAchievement(Tu.FIRE_STARTER),this.data.streak>=7&&!this.hasAchievement("week_warrior")&&this.unlockAchievement(Tu.WEEK_WARRIOR)}async unlockAchievement(e){if(this.hasAchievement(e.id))return{alreadyUnlocked:!0};this.data.achievements.push({id:e.id,unlockedAt:new Date().toISOString()});const t=await this.addXP(e.xp,`Achievement: ${e.name}`);return await this.saveData(),{alreadyUnlocked:!1,achievement:e,xpGained:t.xpGained,leveledUp:t.leveledUp}}hasAchievement(e){return this.data.achievements.some(t=>t.id===e)}getAllAchievements(){return Object.values(Tu).map(e=>({...e,unlocked:this.hasAchievement(e.id),unlockedAt:this.data.achievements.find(t=>t.id===e.id)?.unlockedAt}))}logActivity(e,t={}){let n=0,r="";switch(e){case"steps":this.data.stats.totalSteps+=t.steps||0,n=Math.floor((t.steps||0)/1e3)*2,r=`${t.steps} steps logged`,this.data.stats.totalSteps>=1e5&&!this.hasAchievement("marathon_master")&&this.unlockAchievement(Tu.MARATHON_MASTER);break;case"water":this.data.stats.totalWater+=t.cups||0,n=(t.cups||0)*2,r=`${t.cups} cups of water logged`,t.dailyTotal>=8&&!this.hasAchievement("hydration_hero")&&this.unlockAchievement(Tu.HYDRATION_HERO);break;case"meal":this.data.stats.totalMeals+=1,n=10,r="Meal logged",this.data.stats.totalMeals>=21&&!this.hasAchievement("nutrition_ninja")&&this.unlockAchievement(Tu.NUTRITION_NINJA);break;case"workout":this.data.stats.totalWorkouts+=1,n=15,r="Workout completed",this.data.stats.totalWorkouts>=10&&!this.hasAchievement("strength_pro")&&this.unlockAchievement(Tu.STRENGTH_PRO);break;case"scan":this.data.stats.totalScans+=1,n=3,r="Food scanned",this.data.stats.totalScans>=20&&!this.hasAchievement("scanner_savvy")&&this.unlockAchievement(Tu.SCANNER_SAVVY);break;case"meditation":this.data.stats.totalMeditations+=1,n=12,r="Meditation completed",this.data.stats.totalMeditations>=10&&!this.hasAchievement("zen_master")&&this.unlockAchievement(Tu.ZEN_MASTER);break;case"perfect_day":this.data.stats.perfectDays+=1,n=50,r="Perfect Day!",this.hasAchievement("perfect_day")||this.unlockAchievement(Tu.PERFECT_DAY);break}return n>0?this.addXP(n,r):null}getStreakInfo(){const e=new Date().toDateString(),t=this.data.lastCheckIn?new Date(this.data.lastCheckIn).toDateString():null;return{streak:this.data.streak,longestStreak:this.data.longestStreak,checkedInToday:t===e,lastCheckIn:this.data.lastCheckIn}}getStats(){return{...this.data.stats,level:this.data.level,totalXP:this.data.totalXP,streak:this.data.streak,longestStreak:this.data.longestStreak,achievementsUnlocked:this.data.achievements.length,totalAchievements:Object.keys(Tu).length}}async reset(){this.data={level:1,xp:0,totalXP:0,streak:0,longestStreak:0,lastCheckIn:null,achievements:[],stats:{totalSteps:0,totalWater:0,totalMeals:0,totalWorkouts:0,totalScans:0,totalMeditations:0,perfectDays:0}},await this.saveData()}getGlobalLeaderboard(e="totalXP",t=50){const n=[];return n.push({userId:"You",username:"You",level:this.data.level,totalXP:this.data.totalXP,streak:this.data.streak,totalSteps:this.data.stats.totalSteps,profilePic:"",isCurrentUser:!0}),[{name:"FitnessFanatic",level:18,xp:12800,streak:45,steps:485e3},{name:"HealthHero22",level:15,xp:9500,streak:28,steps:32e4},{name:"WellnessWarrior",level:20,xp:17500,streak:67,steps:62e4},{name:"StepMaster",level:12,xp:5800,streak:15,steps:28e4},{name:"GymLegend",level:16,xp:11200,streak:32,steps:41e4},{name:"ZenQueen",level:14,xp:8100,streak:21,steps:195e3},{name:"CardioKing",level:19,xp:14900,streak:52,steps:55e4},{name:"NutritionNerd",level:13,xp:6900,streak:18,steps:245e3},{name:"MarathonMike",level:17,xp:12100,streak:38,steps:48e4},{name:"YogaYoda",level:11,xp:4900,streak:12,steps:165e3}].forEach((s,l)=>{n.push({userId:`user_${l}`,username:s.name,level:s.level,totalXP:s.xp,streak:s.streak,totalSteps:s.steps,profilePic:["","","","",""][l%5],isCurrentUser:!1})}),n.sort((s,l)=>{switch(e){case"totalXP":return l.totalXP-s.totalXP;case"level":return l.level-s.level;case"streak":return l.streak-s.streak;case"totalSteps":return l.totalSteps-s.totalSteps;default:return l.totalXP-s.totalXP}}),n.forEach((s,l)=>{s.rank=l+1}),n.slice(0,t)}getBattleRewards(){return{availableRewards:[{id:"xp_boost",name:"XP Boost (2x)",cost:500,icon:"",description:"2x XP for 24 hours"},{id:"streak_freeze",name:"Streak Freeze",cost:300,icon:"",description:"Protect streak for 1 day"},{id:"power_up",name:"Battle Power-Up",cost:400,icon:"",description:"+10% performance in battles"},{id:"legendary_badge",name:"Legendary Badge",cost:1e3,icon:"",description:"Exclusive profile badge"},{id:"custom_avatar",name:"Custom Avatar",cost:800,icon:"",description:"Unlock avatar customization"}],userCoins:this.data.totalXP/10,purchasedRewards:[]}}awardBattleVictory(e,t){const n={quick:50,weekly:100,monthly:250,tournament:500}[e]||50,r=t>=90?1.5:t>=75?1.25:1,s=Math.floor(n*r);return this.addXP(s),{xpAwarded:s,newLevel:this.data.level,totalXP:this.data.totalXP}}}const T1=new JG;var AI;(function(i){i.Heavy="HEAVY",i.Medium="MEDIUM",i.Light="LIGHT"})(AI||(AI={}));var EI;(function(i){i.Success="SUCCESS",i.Warning="WARNING",i.Error="ERROR"})(EI||(EI={}));const fY=Ul("Haptics",{web:()=>Vt(()=>import("./chunk-1765759384263-web9.js"),[]).then(i=>new i.HapticsWeb)});class QG{constructor(){this.plans={free:{id:"free",name:"Free",price:0,features:{basicTracking:!0,stepCounter:!0,foodScanner:"limited",meditation:!1,aiVoiceCoach:"limited",waterTracking:!0,dnaAnalysis:!1,socialBattles:"basic",insuranceRewards:!1,mealAutomation:!1,healthAvatar:!1,arScanner:!1,emergencyPanel:!1,appleHealthSync:!1,wearableSync:!1,exportReports:!1,heartRate:!1,sleepTracking:!1,workouts:!1,breathing:!1,pdfExport:!1},limits:{aiMessages:10,foodScans:3,arScans:0,workouts:0}},essential:{id:"essential",name:"Essential",price:4.99,billing:"monthly",features:{basicTracking:!0,stepCounter:!0,foodScanner:!0,meditation:!0,waterTracking:!0,aiVoiceCoach:!0,dnaAnalysis:"basic",socialBattles:!0,insuranceRewards:!1,mealAutomation:!1,healthAvatar:"weekly",arScanner:"limited",emergencyPanel:!0,appleHealthSync:!1,wearableSync:!1,exportReports:!1,heartRate:!0,sleepTracking:!0,workouts:!0,breathing:!0,pdfExport:!1},limits:{aiMessages:30,foodScans:999999,arScans:1,workouts:999999}},premium:{id:"premium",name:"Premium",price:14.99,billing:"monthly",features:{basicTracking:!0,stepCounter:!0,foodScanner:!0,meditation:!0,waterTracking:!0,aiVoiceCoach:!0,dnaAnalysis:!0,socialBattles:!0,insuranceRewards:!1,mealAutomation:!0,healthAvatar:"daily",arScanner:!0,emergencyPanel:!0,appleHealthSync:!1,wearableSync:!1,exportReports:!0,heartRate:!0,sleepTracking:!0,workouts:!0,breathing:!0,pdfExport:!0},limits:{aiMessages:50,foodScans:999999,arScans:100,workouts:999999}},vip:{id:"vip",name:"VIP",price:29.99,billing:"monthly",features:{basicTracking:!0,stepCounter:!0,foodScanner:!0,meditation:!0,waterTracking:!0,aiVoiceCoach:"unlimited",dnaAnalysis:!0,socialBattles:!0,insuranceRewards:!1,mealAutomation:!0,healthAvatar:"realtime",arScanner:"unlimited",emergencyPanel:!0,appleHealthSync:!1,wearableSync:!1,exportReports:!0,heartRate:!0,sleepTracking:!0,workouts:!0,breathing:!0,pdfExport:!0},limits:{aiMessages:999999,foodScans:999999,arScans:999999,workouts:999999}}}}getCurrentPlan(){const e=localStorage.getItem("subscription_plan")||"free";return this.plans[e]||this.plans.free}async verifySubscriptionWithServer(e){try{const t=localStorage.getItem("subscription_last_verified"),n=360*60*1e3;if(t&&Date.now()-parseInt(t)<n)return;const s=await fetch(`https://helio-wellness-app-production.up.railway.app/api/subscription/status/${e}`);if(!s.ok)throw new Error("Failed to verify subscription");const l=await s.json();l.isActive&&l.plan!=="free"?(localStorage.setItem("subscription_plan",l.plan),localStorage.setItem("subscription_status",l.status),localStorage.setItem("subscription_period_end",l.currentPeriodEnd)):(localStorage.setItem("subscription_plan","free"),localStorage.setItem("subscription_status","none")),localStorage.setItem("subscription_last_verified",Date.now().toString())}catch(t){console.error("Error verifying subscription:",t)}}hasAccess(e){try{if(localStorage.getItem("helio_dev_mode")==="true")return!0}catch{}const t=this.getCurrentPlan();return t.features[e]===!0||t.features[e]==="unlimited"}checkLimit(e){try{if(localStorage.getItem("helio_dev_mode")==="true")return{allowed:!0,remaining:999999,limit:999999}}catch{}const t=this.getCurrentPlan(),n=new Date().toISOString().split("T")[0],r=`${e}_usage_${n}`,s=parseInt(localStorage.getItem(r)||"0"),l=t.limits[e];return l?{allowed:s<l,remaining:Math.max(0,l-s),limit:l}:{allowed:!0,remaining:999999}}incrementUsage(e){const t=new Date().toISOString().split("T")[0],n=`${e}_usage_${t}`,r=parseInt(localStorage.getItem(n)||"0");localStorage.setItem(n,(r+1).toString())}getUpgradeMessage(e){return{dnaAnalysis:" DNA Analysis requires Essential plan or higher",socialBattles:" Social Battles requires Essential plan or higher",insuranceRewards:" Insurance Rewards - Coming Soon",mealAutomation:" Meal Automation requires Premium plan (14.99/mo)",healthAvatar:" Health Avatar requires Essential plan or higher",arScanner:" AR Scanner requires Essential plan or higher",emergencyPanel:" Emergency Panel requires Essential plan (4.99/mo)",appleHealthSync:" Apple Health Sync - Coming Soon",wearableSync:" Wearable Integration - Coming Soon",exportReports:" Export Reports requires Premium plan (14.99/mo)",meditation:" Meditation Library requires Essential plan (4.99/mo)",heartRate:" Heart Rate Tracking requires Essential plan (4.99/mo)",sleepTracking:" Sleep Tracking requires Essential plan (4.99/mo)",workouts:" Workout Library requires Essential plan (4.99/mo)",breathing:" Breathing Exercises requires Essential plan (4.99/mo)",pdfExport:" PDF Export requires Premium plan (14.99/mo)"}[e]||"This feature requires a paid plan"}getPlanBadge(){const e=this.getCurrentPlan(),t={free:" Free",essential:" Essential",premium:" Premium",vip:" VIP"};return t[e.id]||t.free}canUpgradeTo(e){const t=this.getCurrentPlan(),n={free:0,essential:1,premium:2,vip:3};return n[e]>n[t.id]}showPaywall(e,t){const n=this.getUpgradeMessage(e),r=this.getCurrentPlan(),s=["insuranceRewards","appleHealthSync","wearableSync","exportReports"];return{show:!0,message:n,currentPlan:r.id,requiredPlan:"premium",isComingSoon:s.includes(e),onUpgrade:t}}}const ar=new QG;function Or(i){"@babel/helpers - typeof";return Or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(i)}var Nu=Uint8Array,Vl=Uint16Array,Jw=Int32Array,Qw=new Nu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zw=new Nu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),II=new Nu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),J4=function(i,e){for(var t=new Vl(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new Jw(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return{b:t,r}},Q4=J4(Qw,2),ZG=Q4.b,Mx=Q4.r;ZG[28]=258,Mx[258]=28;var eH=J4(Zw,0),kI=eH.r,Fx=new Vl(32768);for(var gs=0;gs<32768;++gs){var Rh=(gs&43690)>>1|(gs&21845)<<1;Rh=(Rh&52428)>>2|(Rh&13107)<<2,Rh=(Rh&61680)>>4|(Rh&3855)<<4,Fx[gs]=((Rh&65280)>>8|(Rh&255)<<8)>>1}var em=(function(i,e,t){for(var n=i.length,r=0,s=new Vl(e);r<n;++r)i[r]&&++s[i[r]-1];var l=new Vl(e);for(r=1;r<e;++r)l[r]=l[r-1]+s[r-1]<<1;var u;if(t){u=new Vl(1<<e);var h=15-e;for(r=0;r<n;++r)if(i[r])for(var f=r<<4|i[r],x=e-i[r],g=l[i[r]-1]++<<x,w=g|(1<<x)-1;g<=w;++g)u[Fx[g]>>h]=f}else for(u=new Vl(n),r=0;r<n;++r)i[r]&&(u[r]=Fx[l[i[r]-1]++]>>15-i[r]);return u}),af=new Nu(288);for(var gs=0;gs<144;++gs)af[gs]=8;for(var gs=144;gs<256;++gs)af[gs]=9;for(var gs=256;gs<280;++gs)af[gs]=7;for(var gs=280;gs<288;++gs)af[gs]=8;var A1=new Nu(32);for(var gs=0;gs<32;++gs)A1[gs]=5;var tH=em(af,9,0),nH=em(A1,5,0),Z4=function(i){return(i+7)/8|0},iH=function(i,e,t){return(t==null||t>i.length)&&(t=i.length),new Nu(i.subarray(e,t))},Pc=function(i,e,t){t<<=e&7;var n=e/8|0;i[n]|=t,i[n+1]|=t>>8},Eg=function(i,e,t){t<<=e&7;var n=e/8|0;i[n]|=t,i[n+1]|=t>>8,i[n+2]|=t>>16},fb=function(i,e){for(var t=[],n=0;n<i.length;++n)i[n]&&t.push({s:n,f:i[n]});var r=t.length,s=t.slice();if(!r)return{t:tD,l:0};if(r==1){var l=new Nu(t[0].s+1);return l[t[0].s]=1,{t:l,l:1}}t.sort(function(Ce,Ve){return Ce.f-Ve.f}),t.push({s:-1,f:25001});var u=t[0],h=t[1],f=0,x=1,g=2;for(t[0]={s:-1,f:u.f+h.f,l:u,r:h};x!=r-1;)u=t[t[f].f<t[g].f?f++:g++],h=t[f!=x&&t[f].f<t[g].f?f++:g++],t[x++]={s:-1,f:u.f+h.f,l:u,r:h};for(var w=s[0].s,n=1;n<r;++n)s[n].s>w&&(w=s[n].s);var A=new Vl(w+1),B=jx(t[x-1],A,0);if(B>e){var n=0,$=0,W=B-e,q=1<<W;for(s.sort(function(Ve,pe){return A[pe.s]-A[Ve.s]||Ve.f-pe.f});n<r;++n){var ge=s[n].s;if(A[ge]>e)$+=q-(1<<B-A[ge]),A[ge]=e;else break}for($>>=W;$>0;){var he=s[n].s;A[he]<e?$-=1<<e-A[he]++-1:++n}for(;n>=0&&$;--n){var me=s[n].s;A[me]==e&&(--A[me],++$)}B=e}return{t:new Nu(A),l:B}},jx=function(i,e,t){return i.s==-1?Math.max(jx(i.l,e,t+1),jx(i.r,e,t+1)):e[i.s]=t},CI=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new Vl(++e),n=0,r=i[0],s=1,l=function(h){t[n++]=h},u=1;u<=e;++u)if(i[u]==r&&u!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(r),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(r);s=1,r=i[u]}return{c:t.subarray(0,n),n:e}},Ig=function(i,e){for(var t=0,n=0;n<e.length;++n)t+=i[n]*e[n];return t},eD=function(i,e,t){var n=t.length,r=Z4(e+2);i[r]=n&255,i[r+1]=n>>8,i[r+2]=i[r]^255,i[r+3]=i[r+1]^255;for(var s=0;s<n;++s)i[r+s+4]=t[s];return(r+4+n)*8},RI=function(i,e,t,n,r,s,l,u,h,f,x){Pc(e,x++,t),++r[256];for(var g=fb(r,15),w=g.t,A=g.l,B=fb(s,15),$=B.t,W=B.l,q=CI(w),ge=q.c,he=q.n,me=CI($),Ce=me.c,Ve=me.n,pe=new Vl(19),ee=0;ee<ge.length;++ee)++pe[ge[ee]&31];for(var ee=0;ee<Ce.length;++ee)++pe[Ce[ee]&31];for(var J=fb(pe,7),ye=J.t,X=J.l,ae=19;ae>4&&!ye[II[ae-1]];--ae);var le=f+5<<3,ze=Ig(r,af)+Ig(s,A1)+l,nt=Ig(r,w)+Ig(s,$)+l+14+3*ae+Ig(pe,ye)+2*pe[16]+3*pe[17]+7*pe[18];if(h>=0&&le<=ze&&le<=nt)return eD(e,x,i.subarray(h,h+f));var je,Je,qe,ot;if(Pc(e,x,1+(nt<ze)),x+=2,nt<ze){je=em(w,A,0),Je=w,qe=em($,W,0),ot=$;var St=em(ye,X,0);Pc(e,x,he-257),Pc(e,x+5,Ve-1),Pc(e,x+10,ae-4),x+=14;for(var ee=0;ee<ae;++ee)Pc(e,x+3*ee,ye[II[ee]]);x+=3*ae;for(var Ne=[ge,Ce],se=0;se<2;++se)for(var Ee=Ne[se],ee=0;ee<Ee.length;++ee){var De=Ee[ee]&31;Pc(e,x,St[De]),x+=ye[De],De>15&&(Pc(e,x,Ee[ee]>>5&127),x+=Ee[ee]>>12)}}else je=tH,Je=af,qe=nH,ot=A1;for(var ee=0;ee<u;++ee){var Be=n[ee];if(Be>255){var De=Be>>18&31;Eg(e,x,je[De+257]),x+=Je[De+257],De>7&&(Pc(e,x,Be>>23&31),x+=Qw[De]);var $e=Be&31;Eg(e,x,qe[$e]),x+=ot[$e],$e>3&&(Eg(e,x,Be>>5&8191),x+=Zw[$e])}else Eg(e,x,je[Be]),x+=Je[Be]}return Eg(e,x,je[256]),x+Je[256]},rH=new Jw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tD=new Nu(0),sH=function(i,e,t,n,r,s){var l=s.z||i.length,u=new Nu(n+l+5*(1+Math.ceil(l/7e3))+r),h=u.subarray(n,u.length-r),f=s.l,x=(s.r||0)&7;if(e){x&&(h[0]=s.r>>3);for(var g=rH[e-1],w=g>>13,A=g&8191,B=(1<<t)-1,$=s.p||new Vl(32768),W=s.h||new Vl(B+1),q=Math.ceil(t/3),ge=2*q,he=function(Et){return(i[Et]^i[Et+1]<<q^i[Et+2]<<ge)&B},me=new Jw(25e3),Ce=new Vl(288),Ve=new Vl(32),pe=0,ee=0,J=s.i||0,ye=0,X=s.w||0,ae=0;J+2<l;++J){var le=he(J),ze=J&32767,nt=W[le];if($[ze]=nt,W[le]=ze,X<=J){var je=l-J;if((pe>7e3||ye>24576)&&(je>423||!f)){x=RI(i,h,0,me,Ce,Ve,ee,ye,ae,J-ae,x),ye=pe=ee=0,ae=J;for(var Je=0;Je<286;++Je)Ce[Je]=0;for(var Je=0;Je<30;++Je)Ve[Je]=0}var qe=2,ot=0,St=A,Ne=ze-nt&32767;if(je>2&&le==he(J-Ne))for(var se=Math.min(w,je)-1,Ee=Math.min(32767,J),De=Math.min(258,je);Ne<=Ee&&--St&&ze!=nt;){if(i[J+qe]==i[J+qe-Ne]){for(var Be=0;Be<De&&i[J+Be]==i[J+Be-Ne];++Be);if(Be>qe){if(qe=Be,ot=Ne,Be>se)break;for(var $e=Math.min(Ne,Be-2),Ye=0,Je=0;Je<$e;++Je){var ct=J-Ne+Je&32767,ut=$[ct],Tt=ct-ut&32767;Tt>Ye&&(Ye=Tt,nt=ct)}}}ze=nt,nt=$[ze],Ne+=ze-nt&32767}if(ot){me[ye++]=268435456|Mx[qe]<<18|kI[ot];var Ft=Mx[qe]&31,Wt=kI[ot]&31;ee+=Qw[Ft]+Zw[Wt],++Ce[257+Ft],++Ve[Wt],X=J+qe,++pe}else me[ye++]=i[J],++Ce[i[J]]}}for(J=Math.max(J,X);J<l;++J)me[ye++]=i[J],++Ce[i[J]];x=RI(i,h,f,me,Ce,Ve,ee,ye,ae,J-ae,x),f||(s.r=x&7|h[x/8|0]<<3,x-=7,s.h=W,s.p=$,s.i=J,s.w=X)}else{for(var J=s.w||0;J<l+f;J+=65535){var qt=J+65535;qt>=l&&(h[x/8|0]=f,qt=l),x=eD(h,x+1,i.subarray(J,qt))}s.i=l}return iH(u,0,n+Z4(x)+r)},nD=function(){var i=1,e=0;return{p:function(t){for(var n=i,r=e,s=t.length|0,l=0;l!=s;){for(var u=Math.min(l+2655,s);l<u;++l)r+=n+=t[l];n=(n&65535)+15*(n>>16),r=(r&65535)+15*(r>>16)}i=n,e=r},d:function(){return i%=65521,e%=65521,(i&255)<<24|(i&65280)<<8|(e&255)<<8|e>>8}}},aH=function(i,e,t,n,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),l=new Nu(s.length+i.length);l.set(s),l.set(i,s.length),i=l,r.w=s.length}return sH(i,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+e.mem,t,n,r)},iD=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8},oH=function(i,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(i[0]=120,i[1]=n<<6|(e.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,e.dictionary){var r=nD();r.p(e.dictionary),iD(i,2,r.d())}};function Vx(i,e){e||(e={});var t=nD();t.p(i);var n=aH(i,e,e.dictionary?6:2,4);return oH(n,e),iD(n,n.length-4,t.d()),n}var lH=typeof TextDecoder<"u"&&new TextDecoder,uH=0;try{lH.decode(tD,{stream:!0}),uH=1}catch{}function cH(i){if(Array.isArray(i))return i}function hH(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,l,u=[],h=!0,f=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(h=(n=s.call(t)).done)&&(u.push(n.value),u.length!==e);h=!0);}catch(x){f=!0,r=x}finally{try{if(!h&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(f)throw r}}return u}}function LI(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function dH(i,e){if(i){if(typeof i=="string")return LI(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?LI(i,e):void 0}}function fH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DI(i,e){return cH(i)||hH(i,e)||dH(i,e)||fH()}function NI(i,e="utf8"){return new TextDecoder(e).decode(i)}const pH=new TextEncoder;function gH(i){return pH.encode(i)}const mH=1024*8,yH=(()=>{const i=new Uint8Array(4),e=new Uint32Array(i.buffer);return!((e[0]=1)&i[0])})(),pb={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class eS{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=mH,t={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,s=e.byteLength-r;let l=r;(ArrayBuffer.isView(e)||e instanceof eS)&&(e.byteLength!==e.buffer.byteLength&&(l=e.byteOffset+r),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,r=new Uint8Array(n);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const n=pb[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,s=this.buffer.slice(r,r+n);if(this.littleEndian===yH&&t!=="uint8"&&t!=="int8"){const u=new Uint8Array(this.buffer.slice(r,r+n));u.reverse();const h=new pb[t](u.buffer);return this.offset+=n,h.reverse(),h}const l=new pb[t](s);return this.offset+=n,l}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(e=1){return NI(this.readBytes(e))}decodeText(e=1,t="utf8"){return NI(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(gH(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Bp(i){let e=i.length;for(;--e>=0;)i[e]=0}const vH=3,_H=258,rD=29,bH=256,xH=bH+1+rD,sD=30,wH=512,SH=new Array((xH+2)*2);Bp(SH);const TH=new Array(sD*2);Bp(TH);const AH=new Array(wH);Bp(AH);const EH=new Array(_H-vH+1);Bp(EH);const IH=new Array(rD);Bp(IH);const kH=new Array(sD);Bp(kH);const CH=(i,e,t,n)=>{let r=i&65535|0,s=i>>>16&65535|0,l=0;for(;t!==0;){l=t>2e3?2e3:t,t-=l;do r=r+e[n++]|0,s=s+r|0;while(--l);r%=65521,s%=65521}return r|s<<16|0};var zx=CH;const RH=()=>{let i,e=[];for(var t=0;t<256;t++){i=t;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;e[t]=i}return e},LH=new Uint32Array(RH()),DH=(i,e,t,n)=>{const r=LH,s=n+t;i^=-1;for(let l=n;l<s;l++)i=i>>>8^r[(i^e[l])&255];return i^-1};var Wu=DH,Ux={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},aD={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const NH=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);var PH=function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)NH(t,n)&&(i[n]=t[n])}}return i},OH=i=>{let e=0;for(let n=0,r=i.length;n<r;n++)e+=i[n].length;const t=new Uint8Array(e);for(let n=0,r=0,s=i.length;n<s;n++){let l=i[n];t.set(l,r),r+=l.length}return t},oD={assign:PH,flattenChunks:OH};let lD=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{lD=!1}const km=new Uint8Array(256);for(let i=0;i<256;i++)km[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;km[254]=km[254]=1;var MH=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,t,n,r,s,l=i.length,u=0;for(r=0;r<l;r++)t=i.charCodeAt(r),(t&64512)===55296&&r+1<l&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),u+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(u),s=0,r=0;s<u;r++)t=i.charCodeAt(r),(t&64512)===55296&&r+1<l&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const FH=(i,e)=>{if(e<65534&&i.subarray&&lD)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(i[n]);return t};var jH=(i,e)=>{const t=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let n,r;const s=new Array(t*2);for(r=0,n=0;n<t;){let l=i[n++];if(l<128){s[r++]=l;continue}let u=km[l];if(u>4){s[r++]=65533,n+=u-1;continue}for(l&=u===2?31:u===3?15:7;u>1&&n<t;)l=l<<6|i[n++]&63,u--;if(u>1){s[r++]=65533;continue}l<65536?s[r++]=l:(l-=65536,s[r++]=55296|l>>10&1023,s[r++]=56320|l&1023)}return FH(s,r)},VH=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let t=e-1;for(;t>=0&&(i[t]&192)===128;)t--;return t<0||t===0?e:t+km[i[t]]>e?t:e},Bx={string2buf:MH,buf2string:jH,utf8border:VH};function zH(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var UH=zH;const Qy=16209,BH=16191;var $H=function(e,t){let n,r,s,l,u,h,f,x,g,w,A,B,$,W,q,ge,he,me,Ce,Ve,pe,ee,J,ye;const X=e.state;n=e.next_in,J=e.input,r=n+(e.avail_in-5),s=e.next_out,ye=e.output,l=s-(t-e.avail_out),u=s+(e.avail_out-257),h=X.dmax,f=X.wsize,x=X.whave,g=X.wnext,w=X.window,A=X.hold,B=X.bits,$=X.lencode,W=X.distcode,q=(1<<X.lenbits)-1,ge=(1<<X.distbits)-1;e:do{B<15&&(A+=J[n++]<<B,B+=8,A+=J[n++]<<B,B+=8),he=$[A&q];t:for(;;){if(me=he>>>24,A>>>=me,B-=me,me=he>>>16&255,me===0)ye[s++]=he&65535;else if(me&16){Ce=he&65535,me&=15,me&&(B<me&&(A+=J[n++]<<B,B+=8),Ce+=A&(1<<me)-1,A>>>=me,B-=me),B<15&&(A+=J[n++]<<B,B+=8,A+=J[n++]<<B,B+=8),he=W[A&ge];n:for(;;){if(me=he>>>24,A>>>=me,B-=me,me=he>>>16&255,me&16){if(Ve=he&65535,me&=15,B<me&&(A+=J[n++]<<B,B+=8,B<me&&(A+=J[n++]<<B,B+=8)),Ve+=A&(1<<me)-1,Ve>h){e.msg="invalid distance too far back",X.mode=Qy;break e}if(A>>>=me,B-=me,me=s-l,Ve>me){if(me=Ve-me,me>x&&X.sane){e.msg="invalid distance too far back",X.mode=Qy;break e}if(pe=0,ee=w,g===0){if(pe+=f-me,me<Ce){Ce-=me;do ye[s++]=w[pe++];while(--me);pe=s-Ve,ee=ye}}else if(g<me){if(pe+=f+g-me,me-=g,me<Ce){Ce-=me;do ye[s++]=w[pe++];while(--me);if(pe=0,g<Ce){me=g,Ce-=me;do ye[s++]=w[pe++];while(--me);pe=s-Ve,ee=ye}}}else if(pe+=g-me,me<Ce){Ce-=me;do ye[s++]=w[pe++];while(--me);pe=s-Ve,ee=ye}for(;Ce>2;)ye[s++]=ee[pe++],ye[s++]=ee[pe++],ye[s++]=ee[pe++],Ce-=3;Ce&&(ye[s++]=ee[pe++],Ce>1&&(ye[s++]=ee[pe++]))}else{pe=s-Ve;do ye[s++]=ye[pe++],ye[s++]=ye[pe++],ye[s++]=ye[pe++],Ce-=3;while(Ce>2);Ce&&(ye[s++]=ye[pe++],Ce>1&&(ye[s++]=ye[pe++]))}}else if((me&64)===0){he=W[(he&65535)+(A&(1<<me)-1)];continue n}else{e.msg="invalid distance code",X.mode=Qy;break e}break}}else if((me&64)===0){he=$[(he&65535)+(A&(1<<me)-1)];continue t}else if(me&32){X.mode=BH;break e}else{e.msg="invalid literal/length code",X.mode=Qy;break e}break}}while(n<r&&s<u);Ce=B>>3,n-=Ce,B-=Ce<<3,A&=(1<<B)-1,e.next_in=n,e.next_out=s,e.avail_in=n<r?5+(r-n):5-(n-r),e.avail_out=s<u?257+(u-s):257-(s-u),X.hold=A,X.bits=B};const Ff=15,PI=852,OI=592,MI=0,gb=1,FI=2,GH=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),HH=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),KH=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),WH=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),qH=(i,e,t,n,r,s,l,u)=>{const h=u.bits;let f=0,x=0,g=0,w=0,A=0,B=0,$=0,W=0,q=0,ge=0,he,me,Ce,Ve,pe,ee=null,J;const ye=new Uint16Array(Ff+1),X=new Uint16Array(Ff+1);let ae=null,le,ze,nt;for(f=0;f<=Ff;f++)ye[f]=0;for(x=0;x<n;x++)ye[e[t+x]]++;for(A=h,w=Ff;w>=1&&ye[w]===0;w--);if(A>w&&(A=w),w===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,u.bits=1,0;for(g=1;g<w&&ye[g]===0;g++);for(A<g&&(A=g),W=1,f=1;f<=Ff;f++)if(W<<=1,W-=ye[f],W<0)return-1;if(W>0&&(i===MI||w!==1))return-1;for(X[1]=0,f=1;f<Ff;f++)X[f+1]=X[f]+ye[f];for(x=0;x<n;x++)e[t+x]!==0&&(l[X[e[t+x]]++]=x);if(i===MI?(ee=ae=l,J=20):i===gb?(ee=GH,ae=HH,J=257):(ee=KH,ae=WH,J=0),ge=0,x=0,f=g,pe=s,B=A,$=0,Ce=-1,q=1<<A,Ve=q-1,i===gb&&q>PI||i===FI&&q>OI)return 1;for(;;){le=f-$,l[x]+1<J?(ze=0,nt=l[x]):l[x]>=J?(ze=ae[l[x]-J],nt=ee[l[x]-J]):(ze=96,nt=0),he=1<<f-$,me=1<<B,g=me;do me-=he,r[pe+(ge>>$)+me]=le<<24|ze<<16|nt|0;while(me!==0);for(he=1<<f-1;ge&he;)he>>=1;if(he!==0?(ge&=he-1,ge+=he):ge=0,x++,--ye[f]===0){if(f===w)break;f=e[t+l[x]]}if(f>A&&(ge&Ve)!==Ce){for($===0&&($=A),pe+=g,B=f-$,W=1<<B;B+$<w&&(W-=ye[B+$],!(W<=0));)B++,W<<=1;if(q+=1<<B,i===gb&&q>PI||i===FI&&q>OI)return 1;Ce=ge&Ve,r[Ce]=A<<24|B<<16|pe-s|0}}return ge!==0&&(r[pe+ge]=f-$<<24|64<<16|0),u.bits=A,0};var tm=qH;const YH=0,uD=1,cD=2,{Z_FINISH:jI,Z_BLOCK:XH,Z_TREES:Zy,Z_OK:of,Z_STREAM_END:JH,Z_NEED_DICT:QH,Z_STREAM_ERROR:hu,Z_DATA_ERROR:hD,Z_MEM_ERROR:dD,Z_BUF_ERROR:ZH,Z_DEFLATED:VI}=aD,xv=16180,zI=16181,UI=16182,BI=16183,$I=16184,GI=16185,HI=16186,KI=16187,WI=16188,qI=16189,E1=16190,Oc=16191,mb=16192,YI=16193,yb=16194,XI=16195,JI=16196,QI=16197,ZI=16198,e0=16199,t0=16200,ek=16201,tk=16202,nk=16203,ik=16204,rk=16205,vb=16206,sk=16207,ak=16208,xs=16209,fD=16210,pD=16211,eK=852,tK=592,nK=15,iK=nK,ok=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function rK(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ff=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<xv||e.mode>pD?1:0},gD=i=>{if(ff(i))return hu;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=xv,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(eK),e.distcode=e.distdyn=new Int32Array(tK),e.sane=1,e.back=-1,of},mD=i=>{if(ff(i))return hu;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,gD(i)},yD=(i,e)=>{let t;if(ff(i))return hu;const n=i.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?hu:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,mD(i))},vD=(i,e)=>{if(!i)return hu;const t=new rK;i.state=t,t.strm=i,t.window=null,t.mode=xv;const n=yD(i,e);return n!==of&&(i.state=null),n},sK=i=>vD(i,iK);let lk=!0,_b,bb;const aK=i=>{if(lk){_b=new Int32Array(512),bb=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(tm(uD,i.lens,0,288,_b,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;tm(cD,i.lens,0,32,bb,0,i.work,{bits:5}),lk=!1}i.lencode=_b,i.lenbits=9,i.distcode=bb,i.distbits=5},_D=(i,e,t,n)=>{let r;const s=i.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(t-n,t-n+r),s.wnext),n-=r,n?(s.window.set(e.subarray(t-n,t),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},oK=(i,e)=>{let t,n,r,s,l,u,h,f,x,g,w,A,B,$,W=0,q,ge,he,me,Ce,Ve,pe,ee;const J=new Uint8Array(4);let ye,X;const ae=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ff(i)||!i.output||!i.input&&i.avail_in!==0)return hu;t=i.state,t.mode===Oc&&(t.mode=mb),l=i.next_out,r=i.output,h=i.avail_out,s=i.next_in,n=i.input,u=i.avail_in,f=t.hold,x=t.bits,g=u,w=h,ee=of;e:for(;;)switch(t.mode){case xv:if(t.wrap===0){t.mode=mb;break}for(;x<16;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(t.wrap&2&&f===35615){t.wbits===0&&(t.wbits=15),t.check=0,J[0]=f&255,J[1]=f>>>8&255,t.check=Wu(t.check,J,2,0),f=0,x=0,t.mode=zI;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((f&255)<<8)+(f>>8))%31){i.msg="incorrect header check",t.mode=xs;break}if((f&15)!==VI){i.msg="unknown compression method",t.mode=xs;break}if(f>>>=4,x-=4,pe=(f&15)+8,t.wbits===0&&(t.wbits=pe),pe>15||pe>t.wbits){i.msg="invalid window size",t.mode=xs;break}t.dmax=1<<t.wbits,t.flags=0,i.adler=t.check=1,t.mode=f&512?qI:Oc,f=0,x=0;break;case zI:for(;x<16;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(t.flags=f,(t.flags&255)!==VI){i.msg="unknown compression method",t.mode=xs;break}if(t.flags&57344){i.msg="unknown header flags set",t.mode=xs;break}t.head&&(t.head.text=f>>8&1),t.flags&512&&t.wrap&4&&(J[0]=f&255,J[1]=f>>>8&255,t.check=Wu(t.check,J,2,0)),f=0,x=0,t.mode=UI;case UI:for(;x<32;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}t.head&&(t.head.time=f),t.flags&512&&t.wrap&4&&(J[0]=f&255,J[1]=f>>>8&255,J[2]=f>>>16&255,J[3]=f>>>24&255,t.check=Wu(t.check,J,4,0)),f=0,x=0,t.mode=BI;case BI:for(;x<16;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}t.head&&(t.head.xflags=f&255,t.head.os=f>>8),t.flags&512&&t.wrap&4&&(J[0]=f&255,J[1]=f>>>8&255,t.check=Wu(t.check,J,2,0)),f=0,x=0,t.mode=$I;case $I:if(t.flags&1024){for(;x<16;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}t.length=f,t.head&&(t.head.extra_len=f),t.flags&512&&t.wrap&4&&(J[0]=f&255,J[1]=f>>>8&255,t.check=Wu(t.check,J,2,0)),f=0,x=0}else t.head&&(t.head.extra=null);t.mode=GI;case GI:if(t.flags&1024&&(A=t.length,A>u&&(A=u),A&&(t.head&&(pe=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(s,s+A),pe)),t.flags&512&&t.wrap&4&&(t.check=Wu(t.check,n,A,s)),u-=A,s+=A,t.length-=A),t.length))break e;t.length=0,t.mode=HI;case HI:if(t.flags&2048){if(u===0)break e;A=0;do pe=n[s+A++],t.head&&pe&&t.length<65536&&(t.head.name+=String.fromCharCode(pe));while(pe&&A<u);if(t.flags&512&&t.wrap&4&&(t.check=Wu(t.check,n,A,s)),u-=A,s+=A,pe)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=KI;case KI:if(t.flags&4096){if(u===0)break e;A=0;do pe=n[s+A++],t.head&&pe&&t.length<65536&&(t.head.comment+=String.fromCharCode(pe));while(pe&&A<u);if(t.flags&512&&t.wrap&4&&(t.check=Wu(t.check,n,A,s)),u-=A,s+=A,pe)break e}else t.head&&(t.head.comment=null);t.mode=WI;case WI:if(t.flags&512){for(;x<16;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(t.wrap&4&&f!==(t.check&65535)){i.msg="header crc mismatch",t.mode=xs;break}f=0,x=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),i.adler=t.check=0,t.mode=Oc;break;case qI:for(;x<32;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}i.adler=t.check=ok(f),f=0,x=0,t.mode=E1;case E1:if(t.havedict===0)return i.next_out=l,i.avail_out=h,i.next_in=s,i.avail_in=u,t.hold=f,t.bits=x,QH;i.adler=t.check=1,t.mode=Oc;case Oc:if(e===XH||e===Zy)break e;case mb:if(t.last){f>>>=x&7,x-=x&7,t.mode=vb;break}for(;x<3;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}switch(t.last=f&1,f>>>=1,x-=1,f&3){case 0:t.mode=YI;break;case 1:if(aK(t),t.mode=e0,e===Zy){f>>>=2,x-=2;break e}break;case 2:t.mode=JI;break;case 3:i.msg="invalid block type",t.mode=xs}f>>>=2,x-=2;break;case YI:for(f>>>=x&7,x-=x&7;x<32;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if((f&65535)!==(f>>>16^65535)){i.msg="invalid stored block lengths",t.mode=xs;break}if(t.length=f&65535,f=0,x=0,t.mode=yb,e===Zy)break e;case yb:t.mode=XI;case XI:if(A=t.length,A){if(A>u&&(A=u),A>h&&(A=h),A===0)break e;r.set(n.subarray(s,s+A),l),u-=A,s+=A,h-=A,l+=A,t.length-=A;break}t.mode=Oc;break;case JI:for(;x<14;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(t.nlen=(f&31)+257,f>>>=5,x-=5,t.ndist=(f&31)+1,f>>>=5,x-=5,t.ncode=(f&15)+4,f>>>=4,x-=4,t.nlen>286||t.ndist>30){i.msg="too many length or distance symbols",t.mode=xs;break}t.have=0,t.mode=QI;case QI:for(;t.have<t.ncode;){for(;x<3;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}t.lens[ae[t.have++]]=f&7,f>>>=3,x-=3}for(;t.have<19;)t.lens[ae[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,ye={bits:t.lenbits},ee=tm(YH,t.lens,0,19,t.lencode,0,t.work,ye),t.lenbits=ye.bits,ee){i.msg="invalid code lengths set",t.mode=xs;break}t.have=0,t.mode=ZI;case ZI:for(;t.have<t.nlen+t.ndist;){for(;W=t.lencode[f&(1<<t.lenbits)-1],q=W>>>24,ge=W>>>16&255,he=W&65535,!(q<=x);){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(he<16)f>>>=q,x-=q,t.lens[t.have++]=he;else{if(he===16){for(X=q+2;x<X;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(f>>>=q,x-=q,t.have===0){i.msg="invalid bit length repeat",t.mode=xs;break}pe=t.lens[t.have-1],A=3+(f&3),f>>>=2,x-=2}else if(he===17){for(X=q+3;x<X;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}f>>>=q,x-=q,pe=0,A=3+(f&7),f>>>=3,x-=3}else{for(X=q+7;x<X;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}f>>>=q,x-=q,pe=0,A=11+(f&127),f>>>=7,x-=7}if(t.have+A>t.nlen+t.ndist){i.msg="invalid bit length repeat",t.mode=xs;break}for(;A--;)t.lens[t.have++]=pe}}if(t.mode===xs)break;if(t.lens[256]===0){i.msg="invalid code -- missing end-of-block",t.mode=xs;break}if(t.lenbits=9,ye={bits:t.lenbits},ee=tm(uD,t.lens,0,t.nlen,t.lencode,0,t.work,ye),t.lenbits=ye.bits,ee){i.msg="invalid literal/lengths set",t.mode=xs;break}if(t.distbits=6,t.distcode=t.distdyn,ye={bits:t.distbits},ee=tm(cD,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,ye),t.distbits=ye.bits,ee){i.msg="invalid distances set",t.mode=xs;break}if(t.mode=e0,e===Zy)break e;case e0:t.mode=t0;case t0:if(u>=6&&h>=258){i.next_out=l,i.avail_out=h,i.next_in=s,i.avail_in=u,t.hold=f,t.bits=x,$H(i,w),l=i.next_out,r=i.output,h=i.avail_out,s=i.next_in,n=i.input,u=i.avail_in,f=t.hold,x=t.bits,t.mode===Oc&&(t.back=-1);break}for(t.back=0;W=t.lencode[f&(1<<t.lenbits)-1],q=W>>>24,ge=W>>>16&255,he=W&65535,!(q<=x);){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(ge&&(ge&240)===0){for(me=q,Ce=ge,Ve=he;W=t.lencode[Ve+((f&(1<<me+Ce)-1)>>me)],q=W>>>24,ge=W>>>16&255,he=W&65535,!(me+q<=x);){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}f>>>=me,x-=me,t.back+=me}if(f>>>=q,x-=q,t.back+=q,t.length=he,ge===0){t.mode=rk;break}if(ge&32){t.back=-1,t.mode=Oc;break}if(ge&64){i.msg="invalid literal/length code",t.mode=xs;break}t.extra=ge&15,t.mode=ek;case ek:if(t.extra){for(X=t.extra;x<X;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}t.length+=f&(1<<t.extra)-1,f>>>=t.extra,x-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=tk;case tk:for(;W=t.distcode[f&(1<<t.distbits)-1],q=W>>>24,ge=W>>>16&255,he=W&65535,!(q<=x);){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if((ge&240)===0){for(me=q,Ce=ge,Ve=he;W=t.distcode[Ve+((f&(1<<me+Ce)-1)>>me)],q=W>>>24,ge=W>>>16&255,he=W&65535,!(me+q<=x);){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}f>>>=me,x-=me,t.back+=me}if(f>>>=q,x-=q,t.back+=q,ge&64){i.msg="invalid distance code",t.mode=xs;break}t.offset=he,t.extra=ge&15,t.mode=nk;case nk:if(t.extra){for(X=t.extra;x<X;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}t.offset+=f&(1<<t.extra)-1,f>>>=t.extra,x-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){i.msg="invalid distance too far back",t.mode=xs;break}t.mode=ik;case ik:if(h===0)break e;if(A=w-h,t.offset>A){if(A=t.offset-A,A>t.whave&&t.sane){i.msg="invalid distance too far back",t.mode=xs;break}A>t.wnext?(A-=t.wnext,B=t.wsize-A):B=t.wnext-A,A>t.length&&(A=t.length),$=t.window}else $=r,B=l-t.offset,A=t.length;A>h&&(A=h),h-=A,t.length-=A;do r[l++]=$[B++];while(--A);t.length===0&&(t.mode=t0);break;case rk:if(h===0)break e;r[l++]=t.length,h--,t.mode=t0;break;case vb:if(t.wrap){for(;x<32;){if(u===0)break e;u--,f|=n[s++]<<x,x+=8}if(w-=h,i.total_out+=w,t.total+=w,t.wrap&4&&w&&(i.adler=t.check=t.flags?Wu(t.check,r,w,l-w):zx(t.check,r,w,l-w)),w=h,t.wrap&4&&(t.flags?f:ok(f))!==t.check){i.msg="incorrect data check",t.mode=xs;break}f=0,x=0}t.mode=sk;case sk:if(t.wrap&&t.flags){for(;x<32;){if(u===0)break e;u--,f+=n[s++]<<x,x+=8}if(t.wrap&4&&f!==(t.total&4294967295)){i.msg="incorrect length check",t.mode=xs;break}f=0,x=0}t.mode=ak;case ak:ee=JH;break e;case xs:ee=hD;break e;case fD:return dD;case pD:default:return hu}return i.next_out=l,i.avail_out=h,i.next_in=s,i.avail_in=u,t.hold=f,t.bits=x,(t.wsize||w!==i.avail_out&&t.mode<xs&&(t.mode<vb||e!==jI))&&_D(i,i.output,i.next_out,w-i.avail_out),g-=i.avail_in,w-=i.avail_out,i.total_in+=g,i.total_out+=w,t.total+=w,t.wrap&4&&w&&(i.adler=t.check=t.flags?Wu(t.check,r,w,i.next_out-w):zx(t.check,r,w,i.next_out-w)),i.data_type=t.bits+(t.last?64:0)+(t.mode===Oc?128:0)+(t.mode===e0||t.mode===yb?256:0),(g===0&&w===0||e===jI)&&ee===of&&(ee=ZH),ee},lK=i=>{if(ff(i))return hu;let e=i.state;return e.window&&(e.window=null),i.state=null,of},uK=(i,e)=>{if(ff(i))return hu;const t=i.state;return(t.wrap&2)===0?hu:(t.head=e,e.done=!1,of)},cK=(i,e)=>{const t=e.length;let n,r,s;return ff(i)||(n=i.state,n.wrap!==0&&n.mode!==E1)?hu:n.mode===E1&&(r=1,r=zx(r,e,t,0),r!==n.check)?hD:(s=_D(i,e,t,t),s?(n.mode=fD,dD):(n.havedict=1,of))};var hK=mD,dK=yD,fK=gD,pK=sK,gK=vD,mK=oK,yK=lK,vK=uK,_K=cK,bK="pako inflate (from Nodeca project)",Fc={inflateReset:hK,inflateReset2:dK,inflateResetKeep:fK,inflateInit:pK,inflateInit2:gK,inflate:mK,inflateEnd:yK,inflateGetHeader:vK,inflateSetDictionary:_K,inflateInfo:bK};function xK(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var wK=xK;const bD=Object.prototype.toString,{Z_NO_FLUSH:SK,Z_FINISH:TK,Z_OK:Cm,Z_STREAM_END:xb,Z_NEED_DICT:wb,Z_STREAM_ERROR:AK,Z_DATA_ERROR:uk,Z_MEM_ERROR:EK}=aD;function ey(i){this.options=oD.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new UH,this.strm.avail_out=0;let t=Fc.inflateInit2(this.strm,e.windowBits);if(t!==Cm)throw new Error(Ux[t]);if(this.header=new wK,Fc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Bx.string2buf(e.dictionary):bD.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Fc.inflateSetDictionary(this.strm,e.dictionary),t!==Cm)))throw new Error(Ux[t])}ey.prototype.push=function(i,e){const t=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,l,u;if(this.ended)return!1;for(e===~~e?l=e:l=e===!0?TK:SK,bD.call(i)==="[object ArrayBuffer]"?t.input=new Uint8Array(i):t.input=i,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),s=Fc.inflate(t,l),s===wb&&r&&(s=Fc.inflateSetDictionary(t,r),s===Cm?s=Fc.inflate(t,l):s===uk&&(s=wb));t.avail_in>0&&s===xb&&t.state.wrap>0&&i[t.next_in]!==0;)Fc.inflateReset(t),s=Fc.inflate(t,l);switch(s){case AK:case uk:case wb:case EK:return this.onEnd(s),this.ended=!0,!1}if(u=t.avail_out,t.next_out&&(t.avail_out===0||s===xb))if(this.options.to==="string"){let h=Bx.utf8border(t.output,t.next_out),f=t.next_out-h,x=Bx.buf2string(t.output,h);t.next_out=f,t.avail_out=n-f,f&&t.output.set(t.output.subarray(h,h+f),0),this.onData(x)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===Cm&&u===0)){if(s===xb)return s=Fc.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};ey.prototype.onData=function(i){this.chunks.push(i)};ey.prototype.onEnd=function(i){i===Cm&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=oD.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function IK(i,e){const t=new ey(e);if(t.push(i),t.err)throw t.msg||Ux[t.err];return t.result}var kK=ey,CK=IK,RK={Inflate:kK,inflate:CK};const{Inflate:LK,inflate:DK}=RK;var ck=LK,NK=DK;const xD=[];for(let i=0;i<256;i++){let e=i;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;xD[i]=e}const hk=4294967295;function PK(i,e,t){let n=i;for(let r=0;r<t;r++)n=xD[(n^e[r])&255]^n>>>8;return n}function OK(i,e){return(PK(hk,i,e)^hk)>>>0}function dk(i,e,t){const n=i.readUint32(),r=OK(new Uint8Array(i.buffer,i.byteOffset+i.offset-e-4,e),e);if(r!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${r}`)}function wD(i,e,t){for(let n=0;n<t;n++)e[n]=i[n]}function SD(i,e,t,n){let r=0;for(;r<n;r++)e[r]=i[r];for(;r<t;r++)e[r]=i[r]+e[r-n]&255}function TD(i,e,t,n){let r=0;if(t.length===0)for(;r<n;r++)e[r]=i[r];else for(;r<n;r++)e[r]=i[r]+t[r]&255}function AD(i,e,t,n,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=i[s];for(;s<n;s++)e[s]=i[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=i[s]+(t[s]>>1)&255;for(;s<n;s++)e[s]=i[s]+(e[s-r]+t[s]>>1)&255}}function ED(i,e,t,n,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=i[s];for(;s<n;s++)e[s]=i[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=i[s]+t[s]&255;for(;s<n;s++)e[s]=i[s]+MK(e[s-r],t[s],t[s-r])&255}}function MK(i,e,t){const n=i+e-t,r=Math.abs(n-i),s=Math.abs(n-e),l=Math.abs(n-t);return r<=s&&r<=l?i:s<=l?e:t}function FK(i,e,t,n,r,s){switch(i){case 0:wD(e,t,r);break;case 1:SD(e,t,r,s);break;case 2:TD(e,t,n,r);break;case 3:AD(e,t,n,r,s);break;case 4:ED(e,t,n,r,s);break;default:throw new Error(`Unsupported filter: ${i}`)}}const jK=new Uint16Array([255]),VK=new Uint8Array(jK.buffer),zK=VK[0]===255;function UK(i){const{data:e,width:t,height:n,channels:r,depth:s}=i,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],u=Math.ceil(s/8)*r,h=new Uint8Array(n*t*u);let f=0;for(let x=0;x<7;x++){const g=l[x],w=Math.ceil((t-g.x)/g.xStep),A=Math.ceil((n-g.y)/g.yStep);if(w<=0||A<=0)continue;const B=w*u,$=new Uint8Array(B);for(let W=0;W<A;W++){const q=e[f++],ge=e.subarray(f,f+B);f+=B;const he=new Uint8Array(B);FK(q,ge,he,$,B,u),$.set(he);for(let me=0;me<w;me++){const Ce=g.x+me*g.xStep,Ve=g.y+W*g.yStep;if(!(Ce>=t||Ve>=n))for(let pe=0;pe<u;pe++)h[(Ve*t+Ce)*u+pe]=he[me*u+pe]}}}if(s===16){const x=new Uint16Array(h.buffer);if(zK)for(let g=0;g<x.length;g++)x[g]=BK(x[g]);return x}else return h}function BK(i){return(i&255)<<8|i>>8&255}const $K=new Uint16Array([255]),GK=new Uint8Array($K.buffer),HK=GK[0]===255,KK=new Uint8Array(0);function fk(i){const{data:e,width:t,height:n,channels:r,depth:s}=i,l=Math.ceil(s/8)*r,u=Math.ceil(s/8*r*t),h=new Uint8Array(n*u);let f=KK,x=0,g,w;for(let A=0;A<n;A++){switch(g=e.subarray(x+1,x+1+u),w=h.subarray(A*u,(A+1)*u),e[x]){case 0:wD(g,w,u);break;case 1:SD(g,w,u,l);break;case 2:TD(g,w,f,u);break;case 3:AD(g,w,f,u,l);break;case 4:ED(g,w,f,u,l);break;default:throw new Error(`Unsupported filter: ${e[x]}`)}f=w,x+=u+1}if(s===16){const A=new Uint16Array(h.buffer);if(HK)for(let B=0;B<A.length;B++)A[B]=WK(A[B]);return A}else return h}function WK(i){return(i&255)<<8|i>>8&255}const k0=Uint8Array.of(137,80,78,71,13,10,26,10);function pk(i){if(!qK(i.readBytes(k0.length)))throw new Error("wrong PNG signature")}function qK(i){if(i.length<k0.length)return!1;for(let e=0;e<k0.length;e++)if(i[e]!==k0[e])return!1;return!0}const YK="tEXt",XK=0,ID=new TextDecoder("latin1");function JK(i){if(ZK(i),i.length===0||i.length>79)throw new Error("keyword length must be between 1 and 79")}const QK=/^[\u0000-\u00FF]*$/;function ZK(i){if(!QK.test(i))throw new Error("invalid latin1 text")}function eW(i,e,t){const n=kD(e);i[n]=tW(e,t-n.length-1)}function kD(i){for(i.mark();i.readByte()!==XK;);const e=i.offset;i.reset();const t=ID.decode(i.readBytes(e-i.offset-1));return i.skip(1),JK(t),t}function tW(i,e){return ID.decode(i.readBytes(e))}const Pl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Sb={UNKNOWN:-1,DEFLATE:0},gk={UNKNOWN:-1,ADAPTIVE:0},Tb={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},n0={NONE:0,BACKGROUND:1,PREVIOUS:2},Ab={SOURCE:0,OVER:1};class nW extends eS{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:n=!1}=t;this._checkCrc=n,this._inflator=new ck,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Sb.UNKNOWN,this._filterMethod=gk.UNKNOWN,this._interlaceMethod=Tb.UNKNOWN,this._colorType=Pl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(pk(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(pk(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const n=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case YK:eW(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?dk(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const n=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?dk(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=iW(this.readUint8());const t=this.readUint8();this._colorType=t;let n;switch(t){case Pl.GREYSCALE:n=1;break;case Pl.TRUECOLOUR:n=3;break;case Pl.INDEXED_COLOUR:n=1;break;case Pl.GREYSCALE_ALPHA:n=2;break;case Pl.TRUECOLOUR_ALPHA:n=4;break;case Pl.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==Sb.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let r=0;r<t;r++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,n=this.offset+this.byteOffset;if(n+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Pl.GREYSCALE:case Pl.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case Pl.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const n=this.readByte();this._palette[t].push(n)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case Pl.UNKNOWN:case Pl.GREYSCALE_ALPHA:case Pl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=kD(this),n=this.readUint8();if(n!==Sb.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:NK(r)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:t,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=fk({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)t.data=n.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(n,r,t),this.addFrameDataToCanvas(t,n)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,n){switch(e.disposeOp){case n0.NONE:break;case n0.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let s=0;s<this._png.width;s++){const l=(r*e.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)n.data[l+u]=0}break;case n0.PREVIOUS:n.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const n=1<<this._png.depth,r=(s,l)=>{const u=((s+t.yOffset)*this._png.width+t.xOffset+l)*this._png.channels,h=(s*t.width+l)*this._png.channels;return{index:u,frameIndex:h}};switch(t.blendOp){case Ab.SOURCE:for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){const{index:u,frameIndex:h}=r(s,l);for(let f=0;f<this._png.channels;f++)e.data[u+f]=t.data[h+f]}break;case Ab.OVER:for(let s=0;s<t.height;s++)for(let l=0;l<t.width;l++){const{index:u,frameIndex:h}=r(s,l);for(let f=0;f<this._png.channels;f++){const x=t.data[h+this._png.channels-1]/n,g=f%(this._png.channels-1)===0?1:t.data[h+f],w=Math.floor(x*g+(1-x)*e.data[u+f]);e.data[u+f]+=w}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==gk.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Tb.NO_INTERLACE)this._png.data=fk({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Tb.ADAM7)this._png.data=UK({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:n0.NONE,blendOp:Ab.SOURCE,data:e}),this._inflator=new ck,this._writingDataChunks=!1}}function iW(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}var mk;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.METRE=1]="METRE"})(mk||(mk={}));function rW(i,e){return new nW(i,e).decode()}var ai=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Eb(){ai.console&&typeof ai.console.log=="function"&&ai.console.log.apply(ai.console,arguments)}var Qr={log:Eb,warn:function(i){ai.console&&(typeof ai.console.warn=="function"?ai.console.warn.apply(ai.console,arguments):Eb.call(null,arguments))},error:function(i){ai.console&&(typeof ai.console.error=="function"?ai.console.error.apply(ai.console,arguments):Eb(i))}};function Ib(i,e,t){var n=new XMLHttpRequest;n.open("GET",i),n.responseType="blob",n.onload=function(){Cd(n.response,e,t)},n.onerror=function(){Qr.error("could not download file")},n.send()}function yk(i){var e=new XMLHttpRequest;e.open("HEAD",i,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function i0(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(e)}}var Cd=ai.saveAs||((typeof window>"u"?"undefined":Or(window))!=="object"||window!==ai?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,e,t){var n=ai.URL||ai.webkitURL,r=document.createElement("a");e=e||i.name||"download",r.download=e,r.rel="noopener",typeof i=="string"?(r.href=i,r.origin!==location.origin?yk(r.href)?Ib(i,e,t):i0(r,r.target="_blank"):i0(r)):(r.href=n.createObjectURL(i),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){i0(r)},0))}:"msSaveOrOpenBlob"in navigator?function(i,e,t){if(e=e||i.name||"download",typeof i=="string")if(yk(i))Ib(i,e,t);else{var n=document.createElement("a");n.href=i,n.target="_blank",setTimeout(function(){i0(n)})}else navigator.msSaveOrOpenBlob((function(r,s){return s===void 0?s={autoBom:!1}:Or(s)!=="object"&&(Qr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(i,t),e)}:function(i,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof i=="string")return Ib(i,e,t);var r=i.type==="application/octet-stream",s=/constructor/i.test(ai.HTMLElement)||ai.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&s)&&(typeof FileReader>"u"?"undefined":Or(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var x=u.result;x=l?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=x:location=x,n=null},u.readAsDataURL(i)}else{var h=ai.URL||ai.webkitURL,f=h.createObjectURL(i);n?n.location=f:location.href=f,n=null,setTimeout(function(){h.revokeObjectURL(f)},4e4)}});function CD(i){var e;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],n=0;n<t.length;n++){var r=t[n].re,s=t[n].process,l=r.exec(i);l&&(e=s(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),h=this.g.toString(16),f=this.b.toString(16);return u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),f.length==1&&(f="0"+f),"#"+u+h+f}}var C0=ai.atob.bind(ai),vk=ai.btoa.bind(ai);function kb(i,e){var t=i[0],n=i[1],r=i[2],s=i[3];t=Co(t,n,r,s,e[0],7,-680876936),s=Co(s,t,n,r,e[1],12,-389564586),r=Co(r,s,t,n,e[2],17,606105819),n=Co(n,r,s,t,e[3],22,-1044525330),t=Co(t,n,r,s,e[4],7,-176418897),s=Co(s,t,n,r,e[5],12,1200080426),r=Co(r,s,t,n,e[6],17,-1473231341),n=Co(n,r,s,t,e[7],22,-45705983),t=Co(t,n,r,s,e[8],7,1770035416),s=Co(s,t,n,r,e[9],12,-1958414417),r=Co(r,s,t,n,e[10],17,-42063),n=Co(n,r,s,t,e[11],22,-1990404162),t=Co(t,n,r,s,e[12],7,1804603682),s=Co(s,t,n,r,e[13],12,-40341101),r=Co(r,s,t,n,e[14],17,-1502002290),t=Ro(t,n=Co(n,r,s,t,e[15],22,1236535329),r,s,e[1],5,-165796510),s=Ro(s,t,n,r,e[6],9,-1069501632),r=Ro(r,s,t,n,e[11],14,643717713),n=Ro(n,r,s,t,e[0],20,-373897302),t=Ro(t,n,r,s,e[5],5,-701558691),s=Ro(s,t,n,r,e[10],9,38016083),r=Ro(r,s,t,n,e[15],14,-660478335),n=Ro(n,r,s,t,e[4],20,-405537848),t=Ro(t,n,r,s,e[9],5,568446438),s=Ro(s,t,n,r,e[14],9,-1019803690),r=Ro(r,s,t,n,e[3],14,-187363961),n=Ro(n,r,s,t,e[8],20,1163531501),t=Ro(t,n,r,s,e[13],5,-1444681467),s=Ro(s,t,n,r,e[2],9,-51403784),r=Ro(r,s,t,n,e[7],14,1735328473),t=Lo(t,n=Ro(n,r,s,t,e[12],20,-1926607734),r,s,e[5],4,-378558),s=Lo(s,t,n,r,e[8],11,-2022574463),r=Lo(r,s,t,n,e[11],16,1839030562),n=Lo(n,r,s,t,e[14],23,-35309556),t=Lo(t,n,r,s,e[1],4,-1530992060),s=Lo(s,t,n,r,e[4],11,1272893353),r=Lo(r,s,t,n,e[7],16,-155497632),n=Lo(n,r,s,t,e[10],23,-1094730640),t=Lo(t,n,r,s,e[13],4,681279174),s=Lo(s,t,n,r,e[0],11,-358537222),r=Lo(r,s,t,n,e[3],16,-722521979),n=Lo(n,r,s,t,e[6],23,76029189),t=Lo(t,n,r,s,e[9],4,-640364487),s=Lo(s,t,n,r,e[12],11,-421815835),r=Lo(r,s,t,n,e[15],16,530742520),t=Do(t,n=Lo(n,r,s,t,e[2],23,-995338651),r,s,e[0],6,-198630844),s=Do(s,t,n,r,e[7],10,1126891415),r=Do(r,s,t,n,e[14],15,-1416354905),n=Do(n,r,s,t,e[5],21,-57434055),t=Do(t,n,r,s,e[12],6,1700485571),s=Do(s,t,n,r,e[3],10,-1894986606),r=Do(r,s,t,n,e[10],15,-1051523),n=Do(n,r,s,t,e[1],21,-2054922799),t=Do(t,n,r,s,e[8],6,1873313359),s=Do(s,t,n,r,e[15],10,-30611744),r=Do(r,s,t,n,e[6],15,-1560198380),n=Do(n,r,s,t,e[13],21,1309151649),t=Do(t,n,r,s,e[4],6,-145523070),s=Do(s,t,n,r,e[11],10,-1120210379),r=Do(r,s,t,n,e[2],15,718787259),n=Do(n,r,s,t,e[9],21,-343485551),i[0]=Bh(t,i[0]),i[1]=Bh(n,i[1]),i[2]=Bh(r,i[2]),i[3]=Bh(s,i[3])}function wv(i,e,t,n,r,s){return e=Bh(Bh(e,i),Bh(n,s)),Bh(e<<r|e>>>32-r,t)}function Co(i,e,t,n,r,s,l){return wv(e&t|~e&n,i,e,r,s,l)}function Ro(i,e,t,n,r,s,l){return wv(e&n|t&~n,i,e,r,s,l)}function Lo(i,e,t,n,r,s,l){return wv(e^t^n,i,e,r,s,l)}function Do(i,e,t,n,r,s,l){return wv(t^(e|~n),i,e,r,s,l)}function RD(i){var e,t=i.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=i.length;e+=64)kb(n,sW(i.substring(e-64,e)));i=i.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i.length;e++)r[e>>2]|=i.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(kb(n,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,kb(n,r),n}function sW(i){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=i.charCodeAt(e)+(i.charCodeAt(e+1)<<8)+(i.charCodeAt(e+2)<<16)+(i.charCodeAt(e+3)<<24);return t}var _k="0123456789abcdef".split("");function aW(i){for(var e="",t=0;t<4;t++)e+=_k[i>>8*t+4&15]+_k[i>>8*t&15];return e}function oW(i){return String.fromCharCode(255&i,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function $x(i){return RD(i).map(oW).join("")}var lW=(function(i){for(var e=0;e<i.length;e++)i[e]=aW(i[e]);return i.join("")})(RD("hello"))!="5d41402abc4b2a76b9719d911017c592";function Bh(i,e){if(lW){var t=(65535&i)+(65535&e);return(i>>16)+(e>>16)+(t>>16)<<16|65535&t}return i+e&4294967295}function Gx(i,e){var t,n,r,s;if(i!==t){for(var l=(r=i,s=1+(256/i.length|0),new Array(s+1).join(r)),u=[],h=0;h<256;h++)u[h]=h;var f=0;for(h=0;h<256;h++){var x=u[h];f=(f+x+l.charCodeAt(h))%256,u[h]=u[f],u[f]=x}t=i,n=u}else u=n;var g=e.length,w=0,A=0,B="";for(h=0;h<g;h++)A=(A+(x=u[w=(w+1)%256]))%256,u[w]=u[A],u[A]=x,l=u[(u[w]+u[A])%256],B+=String.fromCharCode(e.charCodeAt(h)^l);return B}var bk={print:4,modify:8,copy:16,"annot-forms":32};function Kf(i,e,t,n){this.v=1,this.r=2;var r=192;i.forEach(function(u){if(bk.perm!==void 0)throw new Error("Invalid permission: "+u);r+=bk[u]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),l=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^r)),this.encryptionKey=$x(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Gx(this.encryptionKey,this.padding)}function Wf(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var e="",t=i.length,n=0;n<t;n++){var r=i.charCodeAt(n);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):i[n]}return e}function xk(i){if(Or(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,r){if(r=r||!1,typeof t!="string"||typeof n!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[n,!!r],s},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[t]){var l=e[t][s];try{l[0].apply(i,n)}catch(u){ai.console&&Qr.error("jsPDF PubSub Error",u.message,u)}l[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function I1(i){if(!(this instanceof I1))return new I1(i);var e="opacity,stroke-opacity".split(",");for(var t in i)i.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=i[t]);this.id="",this.objectNumber=-1}function LD(i,e){this.gState=i,this.matrix=e,this.id="",this.objectNumber=-1}function Md(i,e,t,n,r){if(!(this instanceof Md))return new Md(i,e,t,n,r);this.type=i==="axial"?2:3,this.coords=e,this.colors=t,LD.call(this,n,r)}function Jf(i,e,t,n,r){if(!(this instanceof Jf))return new Jf(i,e,t,n,r);this.boundingBox=i,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,LD.call(this,n,r)}function In(i){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],r=arguments[2],s=arguments[3],l=[],u=1,h=16,f="S",x=null;Or(i=i||{})==="object"&&(t=i.orientation,n=i.unit||n,r=i.format||r,s=i.compress||i.compressPdf||s,(x=i.encryption||null)!==null&&(x.userPassword=x.userPassword||"",x.ownerPassword=x.ownerPassword||"",x.userPermissions=x.userPermissions||[]),u=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(e=i.precision),i.floatPrecision!==void 0&&(h=i.floatPrecision),f=i.defaultPathOperation||"S"),l=i.filters||(s===!0?["FlateEncode"]:l),n=n||"mm",t=(""+(t||"P")).toLowerCase();var g=i.putOnlyUsedFonts||!1,w={},A={internal:{},__private__:{}};A.__private__.PubSub=xk;var B="1.3",$=A.__private__.getPdfVersion=function(){return B};A.__private__.setPdfVersion=function(j){B=j};var W={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};A.__private__.getPageFormats=function(){return W};var q=A.__private__.getPageFormat=function(j){return W[j]};r=r||"a4";var ge="compat",he="advanced",me=ge;function Ce(){this.saveGraphicsState(),Pe(new dn($n,0,0,-$n,0,ro()*$n).toString()+" cm"),this.setFontSize(this.getFontSize()/$n),f="n",me=he}function Ve(){this.restoreGraphicsState(),f="S",me=ge}var pe=A.__private__.combineFontStyleAndFontWeight=function(j,fe){if(j=="bold"&&fe=="normal"||j=="bold"&&fe==400||j=="normal"&&fe=="italic"||j=="bold"&&fe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return fe&&(j=fe==400||fe==="normal"?j==="italic"?"italic":"normal":fe!=700&&fe!=="bold"||j!=="normal"?(fe==700?"bold":fe)+""+j:"bold"),j};A.advancedAPI=function(j){var fe=me===ge;return fe&&Ce.call(this),typeof j!="function"||(j(this),fe&&Ve.call(this)),this},A.compatAPI=function(j){var fe=me===he;return fe&&Ve.call(this),typeof j!="function"||(j(this),fe&&Ce.call(this)),this},A.isAdvancedAPI=function(){return me===he};var ee,J=function(j){if(me!==he)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},ye=A.roundToPrecision=A.__private__.roundToPrecision=function(j,fe){var Me=e||fe;if(isNaN(j)||isNaN(Me))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(Me).replace(/0+$/,"")};ee=A.hpf=A.__private__.hpf=typeof h=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return ye(j,h)}:h==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return ye(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return ye(j,16)};var X=A.f2=A.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return ye(j,2)},ae=A.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return ye(j,3)},le=A.scale=A.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return me===ge?j*$n:me===he?j:void 0},ze=function(j){return le((function(fe){return me===ge?ro()-fe:me===he?fe:void 0})(j))};A.__private__.setPrecision=A.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(e=parseInt(j,10))};var nt,je="00000000000000000000000000000000",Je=A.__private__.getFileId=function(){return je},qe=A.__private__.setFileId=function(j){return je=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():je.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),x!==null&&(dr=new Kf(x.userPermissions,x.userPassword,x.ownerPassword,je)),je};A.setFileId=function(j){return qe(j),this},A.getFileId=function(){return Je()};var ot=A.__private__.convertDateToPDFDate=function(j){var fe=j.getTimezoneOffset(),Me=fe<0?"+":"-",We=Math.floor(Math.abs(fe/60)),tt=Math.abs(fe%60),At=[Me,De(We),"'",De(tt),"'"].join("");return["D:",j.getFullYear(),De(j.getMonth()+1),De(j.getDate()),De(j.getHours()),De(j.getMinutes()),De(j.getSeconds()),At].join("")},St=A.__private__.convertPDFDateToDate=function(j){var fe=parseInt(j.substr(2,4),10),Me=parseInt(j.substr(6,2),10)-1,We=parseInt(j.substr(8,2),10),tt=parseInt(j.substr(10,2),10),At=parseInt(j.substr(12,2),10),Pt=parseInt(j.substr(14,2),10);return new Date(fe,Me,We,tt,At,Pt,0)},Ne=A.__private__.setCreationDate=function(j){var fe;if(j===void 0&&(j=new Date),j instanceof Date)fe=ot(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");fe=j}return nt=fe},se=A.__private__.getCreationDate=function(j){var fe=nt;return j==="jsDate"&&(fe=St(nt)),fe};A.setCreationDate=function(j){return Ne(j),this},A.getCreationDate=function(j){return se(j)};var Ee,De=A.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},Be=A.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},$e=0,Ye=[],ct=[],ut=0,Tt=[],Ft=[],Wt=!1,qt=ct;A.__private__.setCustomOutputDestination=function(j){Wt=!0,qt=j};var Et=function(j){Wt||(qt=j)};A.__private__.resetCustomOutputDestination=function(){Wt=!1,qt=ct};var Pe=A.__private__.out=function(j){return j=j.toString(),ut+=j.length+1,qt.push(j),qt},$t=A.__private__.write=function(j){return Pe(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},Dt=A.__private__.getArrayBuffer=function(j){for(var fe=j.length,Me=new ArrayBuffer(fe),We=new Uint8Array(Me);fe--;)We[fe]=j.charCodeAt(fe);return Me},wn=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];A.__private__.getStandardFonts=function(){return wn};var _t=i.fontSize||16;A.__private__.setFontSize=A.setFontSize=function(j){return _t=me===he?j/$n:j,this};var en,Xt=A.__private__.getFontSize=A.getFontSize=function(){return me===ge?_t:_t*$n},Tn=i.R2L||!1;A.__private__.setR2L=A.setR2L=function(j){return Tn=j,this},A.__private__.getR2L=A.getR2L=function(){return Tn};var bn,Un=A.__private__.setZoomMode=function(j){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))en=j;else if(isNaN(j)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');en=j}else en=parseInt(j,10)};A.__private__.getZoomMode=function(){return en};var ii,Bn=A.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');bn=j};A.__private__.getPageMode=function(){return bn};var li=A.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');ii=j};A.__private__.getLayoutMode=function(){return ii},A.__private__.setDisplayMode=A.setDisplayMode=function(j,fe,Me){return Un(j),li(fe),Bn(Me),this};var Xn={title:"",subject:"",author:"",keywords:"",creator:""};A.__private__.getDocumentProperty=function(j){if(Object.keys(Xn).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Xn[j]},A.__private__.getDocumentProperties=function(){return Xn},A.__private__.setDocumentProperties=A.setProperties=A.setDocumentProperties=function(j){for(var fe in Xn)Xn.hasOwnProperty(fe)&&j[fe]&&(Xn[fe]=j[fe]);return this},A.__private__.setDocumentProperty=function(j,fe){if(Object.keys(Xn).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Xn[j]=fe};var ln,$n,cn,er,Jn,mn={},On={},qn=[],on={},Ni={},Mn={},xn={},Qn=null,Qt=0,Ht=[],Kn=new xk(A),kr=i.hotfixes||[],vr={},Cr={},Ci=[],dn=function j(fe,Me,We,tt,At,Pt){if(!(this instanceof j))return new j(fe,Me,We,tt,At,Pt);isNaN(fe)&&(fe=1),isNaN(Me)&&(Me=0),isNaN(We)&&(We=0),isNaN(tt)&&(tt=1),isNaN(At)&&(At=0),isNaN(Pt)&&(Pt=0),this._matrix=[fe,Me,We,tt,At,Pt]};Object.defineProperty(dn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(dn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(dn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(dn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(dn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(dn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(dn.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(dn.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(dn.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(dn.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(dn.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(dn.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(dn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(dn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(dn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(dn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),dn.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ee).join(j)},dn.prototype.multiply=function(j){var fe=j.sx*this.sx+j.shy*this.shx,Me=j.sx*this.shy+j.shy*this.sy,We=j.shx*this.sx+j.sy*this.shx,tt=j.shx*this.shy+j.sy*this.sy,At=j.tx*this.sx+j.ty*this.shx+this.tx,Pt=j.tx*this.shy+j.ty*this.sy+this.ty;return new dn(fe,Me,We,tt,At,Pt)},dn.prototype.decompose=function(){var j=this.sx,fe=this.shy,Me=this.shx,We=this.sy,tt=this.tx,At=this.ty,Pt=Math.sqrt(j*j+fe*fe),an=(j/=Pt)*Me+(fe/=Pt)*We;Me-=j*an,We-=fe*an;var pn=Math.sqrt(Me*Me+We*We);return an/=pn,j*(We/=pn)<fe*(Me/=pn)&&(j=-j,fe=-fe,an=-an,Pt=-Pt),{scale:new dn(Pt,0,0,pn,0,0),translate:new dn(1,0,0,1,tt,At),rotate:new dn(j,fe,-fe,j,0,0),skew:new dn(1,0,an,1,0,0)}},dn.prototype.toString=function(j){return this.join(" ")},dn.prototype.inversed=function(){var j=this.sx,fe=this.shy,Me=this.shx,We=this.sy,tt=this.tx,At=this.ty,Pt=1/(j*We-fe*Me),an=We*Pt,pn=-fe*Pt,Vn=-Me*Pt,Rn=j*Pt;return new dn(an,pn,Vn,Rn,-an*tt-Vn*At,-pn*tt-Rn*At)},dn.prototype.applyToPoint=function(j){var fe=j.x*this.sx+j.y*this.shx+this.tx,Me=j.x*this.shy+j.y*this.sy+this.ty;return new Vr(fe,Me)},dn.prototype.applyToRectangle=function(j){var fe=this.applyToPoint(j),Me=this.applyToPoint(new Vr(j.x+j.w,j.y+j.h));return new Ca(fe.x,fe.y,Me.x-fe.x,Me.y-fe.y)},dn.prototype.clone=function(){var j=this.sx,fe=this.shy,Me=this.shx,We=this.sy,tt=this.tx,At=this.ty;return new dn(j,fe,Me,We,tt,At)},A.Matrix=dn;var Aa=A.matrixMult=function(j,fe){return fe.multiply(j)},ta=new dn(1,0,0,1,0,0);A.unitMatrix=A.identityMatrix=ta;var Rr=function(j,fe){if(!Ni[j]){var Me=(fe instanceof Md?"Sh":"P")+(Object.keys(on).length+1).toString(10);fe.id=Me,Ni[j]=Me,on[Me]=fe,Kn.publish("addPattern",fe)}};A.ShadingPattern=Md,A.TilingPattern=Jf,A.addShadingPattern=function(j,fe){return J("addShadingPattern()"),Rr(j,fe),this},A.beginTilingPattern=function(j){J("beginTilingPattern()"),us(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},A.endTilingPattern=function(j,fe){J("endTilingPattern()"),fe.stream=Ft[Ee].join(`
`),Rr(j,fe),Kn.publish("endTilingPattern",fe),Ci.pop().restore()};var ms,Pi=A.__private__.newObject=function(){var j=tr();return cr(j,!0),j},tr=A.__private__.newObjectDeferred=function(){return $e++,Ye[$e]=function(){return ut},$e},cr=function(j,fe){return fe=typeof fe=="boolean"&&fe,Ye[j]=ut,fe&&Pe(j+" 0 obj"),j},os=A.__private__.newAdditionalObject=function(){var j={objId:tr(),content:""};return Tt.push(j),j},Zr=tr(),qi=tr(),Yi=A.__private__.decodeColorString=function(j){var fe=j.split(" ");if(fe.length!==2||fe[1]!=="g"&&fe[1]!=="G")fe.length!==5||fe[4]!=="k"&&fe[4]!=="K"||(fe=[(1-fe[0])*(1-fe[3]),(1-fe[1])*(1-fe[3]),(1-fe[2])*(1-fe[3]),"r"]);else{var Me=parseFloat(fe[0]);fe=[Me,Me,Me,"r"]}for(var We="#",tt=0;tt<3;tt++)We+=("0"+Math.floor(255*parseFloat(fe[tt])).toString(16)).slice(-2);return We},Kr=A.__private__.encodeColorString=function(j){var fe;typeof j=="string"&&(j={ch1:j});var Me=j.ch1,We=j.ch2,tt=j.ch3,At=j.ch4,Pt=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Me=="string"&&Me.charAt(0)!=="#"){var an=new CD(Me);if(an.ok)Me=an.toHex();else if(!/^\d*\.?\d*$/.test(Me))throw new Error('Invalid color "'+Me+'" passed to jsPDF.encodeColorString.')}if(typeof Me=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Me)&&(Me="#"+Me[1]+Me[1]+Me[2]+Me[2]+Me[3]+Me[3]),typeof Me=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Me)){var pn=parseInt(Me.substr(1),16);Me=pn>>16&255,We=pn>>8&255,tt=255&pn}if(We===void 0||At===void 0&&Me===We&&We===tt)fe=typeof Me=="string"?Me+" "+Pt[0]:j.precision===2?X(Me/255)+" "+Pt[0]:ae(Me/255)+" "+Pt[0];else if(At===void 0||Or(At)==="object"){if(At&&!isNaN(At.a)&&At.a===0)return["1.","1.","1.",Pt[1]].join(" ");fe=typeof Me=="string"?[Me,We,tt,Pt[1]].join(" "):j.precision===2?[X(Me/255),X(We/255),X(tt/255),Pt[1]].join(" "):[ae(Me/255),ae(We/255),ae(tt/255),Pt[1]].join(" ")}else fe=typeof Me=="string"?[Me,We,tt,At,Pt[2]].join(" "):j.precision===2?[X(Me),X(We),X(tt),X(At),Pt[2]].join(" "):[ae(Me),ae(We),ae(tt),ae(At),Pt[2]].join(" ");return fe},ls=A.__private__.getFilters=function(){return l},da=A.__private__.putStream=function(j){var fe=(j=j||{}).data||"",Me=j.filters||ls(),We=j.alreadyAppliedFilters||[],tt=j.addLength1||!1,At=fe.length,Pt=j.objectId,an=function(K){return K};if(x!==null&&Pt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");x!==null&&(an=dr.encryptor(Pt,0));var pn={};Me===!0&&(Me=["FlateEncode"]);var Vn=j.additionalKeyValues||[],Rn=(pn=In.API.processDataByFilters!==void 0?In.API.processDataByFilters(fe,Me):{data:fe,reverseChain:[]}).reverseChain+(Array.isArray(We)?We.join(" "):We.toString());if(pn.data.length!==0&&(Vn.push({key:"Length",value:pn.data.length}),tt===!0&&Vn.push({key:"Length1",value:At})),Rn.length!=0)if(Rn.split("/").length-1==1)Vn.push({key:"Filter",value:Rn});else{Vn.push({key:"Filter",value:"["+Rn+"]"});for(var Si=0;Si<Vn.length;Si+=1)if(Vn[Si].key==="DecodeParms"){for(var Ar=[],fr=0;fr<pn.reverseChain.split("/").length-1;fr+=1)Ar.push("null");Ar.push(Vn[Si].value),Vn[Si].value="["+Ar.join(" ")+"]"}}Pe("<<");for(var E=0;E<Vn.length;E++)Pe("/"+Vn[E].key+" "+Vn[E].value);Pe(">>"),pn.data.length!==0&&(Pe("stream"),Pe(an(pn.data)),Pe("endstream"))},Va=A.__private__.putPage=function(j){var fe=j.number,Me=j.data,We=j.objId,tt=j.contentsObjId;cr(We,!0),Pe("<</Type /Page"),Pe("/Parent "+j.rootDictionaryObjId+" 0 R"),Pe("/Resources "+j.resourceDictionaryObjId+" 0 R"),Pe("/MediaBox ["+parseFloat(ee(j.mediaBox.bottomLeftX))+" "+parseFloat(ee(j.mediaBox.bottomLeftY))+" "+ee(j.mediaBox.topRightX)+" "+ee(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&Pe("/CropBox ["+ee(j.cropBox.bottomLeftX)+" "+ee(j.cropBox.bottomLeftY)+" "+ee(j.cropBox.topRightX)+" "+ee(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&Pe("/BleedBox ["+ee(j.bleedBox.bottomLeftX)+" "+ee(j.bleedBox.bottomLeftY)+" "+ee(j.bleedBox.topRightX)+" "+ee(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&Pe("/TrimBox ["+ee(j.trimBox.bottomLeftX)+" "+ee(j.trimBox.bottomLeftY)+" "+ee(j.trimBox.topRightX)+" "+ee(j.trimBox.topRightY)+"]"),j.artBox!==null&&Pe("/ArtBox ["+ee(j.artBox.bottomLeftX)+" "+ee(j.artBox.bottomLeftY)+" "+ee(j.artBox.topRightX)+" "+ee(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&Pe("/UserUnit "+j.userUnit),Kn.publish("putPage",{objId:We,pageContext:Ht[fe],pageNumber:fe,page:Me}),Pe("/Contents "+tt+" 0 R"),Pe(">>"),Pe("endobj");var At=Me.join(`
`);return me===he&&(At+=`
Q`),cr(tt,!0),da({data:At,filters:ls(),objectId:tt}),Pe("endobj"),We},ys=A.__private__.putPages=function(){var j,fe,Me=[];for(j=1;j<=Qt;j++)Ht[j].objId=tr(),Ht[j].contentsObjId=tr();for(j=1;j<=Qt;j++)Me.push(Va({number:j,data:Ft[j],objId:Ht[j].objId,contentsObjId:Ht[j].contentsObjId,mediaBox:Ht[j].mediaBox,cropBox:Ht[j].cropBox,bleedBox:Ht[j].bleedBox,trimBox:Ht[j].trimBox,artBox:Ht[j].artBox,userUnit:Ht[j].userUnit,rootDictionaryObjId:Zr,resourceDictionaryObjId:qi}));cr(Zr,!0),Pe("<</Type /Pages");var We="/Kids [";for(fe=0;fe<Qt;fe++)We+=Me[fe]+" 0 R ";Pe(We+"]"),Pe("/Count "+Qt),Pe(">>"),Pe("endobj"),Kn.publish("postPutPages")},es=function(j){Kn.publish("putFont",{font:j,out:Pe,newObject:Pi,putStream:da}),j.isAlreadyPutted!==!0&&(j.objectNumber=Pi(),Pe("<<"),Pe("/Type /Font"),Pe("/BaseFont /"+Wf(j.postScriptName)),Pe("/Subtype /Type1"),typeof j.encoding=="string"&&Pe("/Encoding /"+j.encoding),Pe("/FirstChar 32"),Pe("/LastChar 255"),Pe(">>"),Pe("endobj"))},to=function(j){j.objectNumber=Pi();var fe=[];fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Form"}),fe.push({key:"BBox",value:"["+[ee(j.x),ee(j.y),ee(j.x+j.width),ee(j.y+j.height)].join(" ")+"]"}),fe.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var Me=j.pages[1].join(`
`);da({data:Me,additionalKeyValues:fe,objectId:j.objectNumber}),Pe("endobj")},Ps=function(j,fe){fe||(fe=21);var Me=Pi(),We=(function(Pt,an){var pn,Vn=[],Rn=1/(an-1);for(pn=0;pn<1;pn+=Rn)Vn.push(pn);if(Vn.push(1),Pt[0].offset!=0){var Si={offset:0,color:Pt[0].color};Pt.unshift(Si)}if(Pt[Pt.length-1].offset!=1){var Ar={offset:1,color:Pt[Pt.length-1].color};Pt.push(Ar)}for(var fr="",E=0,K=0;K<Vn.length;K++){for(pn=Vn[K];pn>Pt[E+1].offset;)E++;var ne=Pt[E].offset,Ie=(pn-ne)/(Pt[E+1].offset-ne),st=Pt[E].color,ft=Pt[E+1].color;fr+=Be(Math.round((1-Ie)*st[0]+Ie*ft[0]).toString(16))+Be(Math.round((1-Ie)*st[1]+Ie*ft[1]).toString(16))+Be(Math.round((1-Ie)*st[2]+Ie*ft[2]).toString(16))}return fr.trim()})(j.colors,fe),tt=[];tt.push({key:"FunctionType",value:"0"}),tt.push({key:"Domain",value:"[0.0 1.0]"}),tt.push({key:"Size",value:"["+fe+"]"}),tt.push({key:"BitsPerSample",value:"8"}),tt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),tt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),da({data:We,additionalKeyValues:tt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Me}),Pe("endobj"),j.objectNumber=Pi(),Pe("<< /ShadingType "+j.type),Pe("/ColorSpace /DeviceRGB");var At="/Coords ["+ee(parseFloat(j.coords[0]))+" "+ee(parseFloat(j.coords[1]))+" ";j.type===2?At+=ee(parseFloat(j.coords[2]))+" "+ee(parseFloat(j.coords[3])):At+=ee(parseFloat(j.coords[2]))+" "+ee(parseFloat(j.coords[3]))+" "+ee(parseFloat(j.coords[4]))+" "+ee(parseFloat(j.coords[5])),Pe(At+="]"),j.matrix&&Pe("/Matrix ["+j.matrix.toString()+"]"),Pe("/Function "+Me+" 0 R"),Pe("/Extend [true true]"),Pe(">>"),Pe("endobj")},Os=function(j,fe){var Me=tr(),We=Pi();fe.push({resourcesOid:Me,objectOid:We}),j.objectNumber=We;var tt=[];tt.push({key:"Type",value:"/Pattern"}),tt.push({key:"PatternType",value:"1"}),tt.push({key:"PaintType",value:"1"}),tt.push({key:"TilingType",value:"1"}),tt.push({key:"BBox",value:"["+j.boundingBox.map(ee).join(" ")+"]"}),tt.push({key:"XStep",value:ee(j.xStep)}),tt.push({key:"YStep",value:ee(j.yStep)}),tt.push({key:"Resources",value:Me+" 0 R"}),j.matrix&&tt.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),da({data:j.stream,additionalKeyValues:tt,objectId:j.objectNumber}),Pe("endobj")},na=function(j){for(var fe in j.objectNumber=Pi(),Pe("<<"),j)switch(fe){case"opacity":Pe("/ca "+X(j[fe]));break;case"stroke-opacity":Pe("/CA "+X(j[fe]))}Pe(">>"),Pe("endobj")},Ms=function(j){cr(j.resourcesOid,!0),Pe("<<"),Pe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var fe in Pe("/Font <<"),mn)mn.hasOwnProperty(fe)&&(g===!1||g===!0&&w.hasOwnProperty(fe))&&Pe("/"+fe+" "+mn[fe].objectNumber+" 0 R");Pe(">>")})(),(function(){if(Object.keys(on).length>0){for(var fe in Pe("/Shading <<"),on)on.hasOwnProperty(fe)&&on[fe]instanceof Md&&on[fe].objectNumber>=0&&Pe("/"+fe+" "+on[fe].objectNumber+" 0 R");Kn.publish("putShadingPatternDict"),Pe(">>")}})(),(function(fe){if(Object.keys(on).length>0){for(var Me in Pe("/Pattern <<"),on)on.hasOwnProperty(Me)&&on[Me]instanceof A.TilingPattern&&on[Me].objectNumber>=0&&on[Me].objectNumber<fe&&Pe("/"+Me+" "+on[Me].objectNumber+" 0 R");Kn.publish("putTilingPatternDict"),Pe(">>")}})(j.objectOid),(function(){if(Object.keys(Mn).length>0){var fe;for(fe in Pe("/ExtGState <<"),Mn)Mn.hasOwnProperty(fe)&&Mn[fe].objectNumber>=0&&Pe("/"+fe+" "+Mn[fe].objectNumber+" 0 R");Kn.publish("putGStateDict"),Pe(">>")}})(),(function(){for(var fe in Pe("/XObject <<"),vr)vr.hasOwnProperty(fe)&&vr[fe].objectNumber>=0&&Pe("/"+fe+" "+vr[fe].objectNumber+" 0 R");Kn.publish("putXobjectDict"),Pe(">>")})(),Pe(">>"),Pe("endobj")},hr=function(j){On[j.fontName]=On[j.fontName]||{},On[j.fontName][j.fontStyle]=j.id},ml=function(j,fe,Me,We,tt){var At={id:"F"+(Object.keys(mn).length+1).toString(10),postScriptName:j,fontName:fe,fontStyle:Me,encoding:We,isStandardFont:tt||!1,metadata:{}};return Kn.publish("addFont",{font:At,instance:this}),mn[At.id]=At,hr(At),At.id},Fs=A.__private__.pdfEscape=A.pdfEscape=function(j,fe){return(function(Me,We){var tt,At,Pt,an,pn,Vn,Rn,Si,Ar;if(Pt=(We=We||{}).sourceEncoding||"Unicode",pn=We.outputEncoding,(We.autoencode||pn)&&mn[ln].metadata&&mn[ln].metadata[Pt]&&mn[ln].metadata[Pt].encoding&&(an=mn[ln].metadata[Pt].encoding,!pn&&mn[ln].encoding&&(pn=mn[ln].encoding),!pn&&an.codePages&&(pn=an.codePages[0]),typeof pn=="string"&&(pn=an[pn]),pn)){for(Rn=!1,Vn=[],tt=0,At=Me.length;tt<At;tt++)(Si=pn[Me.charCodeAt(tt)])?Vn.push(String.fromCharCode(Si)):Vn.push(Me[tt]),Vn[tt].charCodeAt(0)>>8&&(Rn=!0);Me=Vn.join("")}for(tt=Me.length;Rn===void 0&&tt!==0;)Me.charCodeAt(tt-1)>>8&&(Rn=!0),tt--;if(!Rn)return Me;for(Vn=We.noBOM?[]:[254,255],tt=0,At=Me.length;tt<At;tt++){if((Ar=(Si=Me.charCodeAt(tt))>>8)>>8)throw new Error("Character at position "+tt+" of string '"+Me+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Vn.push(Ar),Vn.push(Si-(Ar<<8))}return String.fromCharCode.apply(void 0,Vn)})(j,fe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fa=A.__private__.beginPage=function(j){Ft[++Qt]=[],Ht[Qt]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},el(Qt),Et(Ft[Ee])},Ts=function(j,fe){var Me,We,tt;switch(t=fe||t,typeof j=="string"&&(Me=q(j.toLowerCase()),Array.isArray(Me)&&(We=Me[0],tt=Me[1])),Array.isArray(j)&&(We=j[0]*$n,tt=j[1]*$n),isNaN(We)&&(We=r[0],tt=r[1]),(We>14400||tt>14400)&&(Qr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),We=Math.min(14400,We),tt=Math.min(14400,tt)),r=[We,tt],t.substr(0,1)){case"l":tt>We&&(r=[tt,We]);break;case"p":We>tt&&(r=[tt,We])}fa(r),rn(or),Pe(zs),qr!==0&&Pe(qr+" J"),Tr!==0&&Pe(Tr+" j"),Kn.publish("addPage",{pageNumber:Qt})},Mo=function(j){j>0&&j<=Qt&&(Ft.splice(j,1),Ht.splice(j,1),Qt--,Ee>Qt&&(Ee=Qt),this.setPage(Ee))},el=function(j){j>0&&j<=Qt&&(Ee=j)},tl=A.__private__.getNumberOfPages=A.getNumberOfPages=function(){return Ft.length-1},Fo=function(j,fe,Me){var We,tt=void 0;return Me=Me||{},j=j!==void 0?j:mn[ln].fontName,fe=fe!==void 0?fe:mn[ln].fontStyle,We=j.toLowerCase(),On[We]!==void 0&&On[We][fe]!==void 0?tt=On[We][fe]:On[j]!==void 0&&On[j][fe]!==void 0?tt=On[j][fe]:Me.disableWarning===!1&&Qr.warn("Unable to look up font label for font '"+j+"', '"+fe+"'. Refer to getFontList() for available fonts."),tt||Me.noFallback||(tt=On.times[fe])==null&&(tt=On.times.normal),tt},oi=A.__private__.putInfo=function(){var j=Pi(),fe=function(We){return We};for(var Me in x!==null&&(fe=dr.encryptor(j,0)),Pe("<<"),Pe("/Producer ("+Fs(fe("jsPDF "+In.version))+")"),Xn)Xn.hasOwnProperty(Me)&&Xn[Me]&&Pe("/"+Me.substr(0,1).toUpperCase()+Me.substr(1)+" ("+Fs(fe(Xn[Me]))+")");Pe("/CreationDate ("+Fs(fe(nt))+")"),Pe(">>"),Pe("endobj")},jr=A.__private__.putCatalog=function(j){var fe=(j=j||{}).rootDictionaryObjId||Zr;switch(Pi(),Pe("<<"),Pe("/Type /Catalog"),Pe("/Pages "+fe+" 0 R"),en||(en="fullwidth"),en){case"fullwidth":Pe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Pe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Pe("/OpenAction [3 0 R /Fit]");break;case"original":Pe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Me=""+en;Me.substr(Me.length-1)==="%"&&(en=parseInt(en)/100),typeof en=="number"&&Pe("/OpenAction [3 0 R /XYZ null null "+X(en)+"]")}switch(ii||(ii="continuous"),ii){case"continuous":Pe("/PageLayout /OneColumn");break;case"single":Pe("/PageLayout /SinglePage");break;case"two":case"twoleft":Pe("/PageLayout /TwoColumnLeft");break;case"tworight":Pe("/PageLayout /TwoColumnRight")}bn&&Pe("/PageMode /"+bn),Kn.publish("putCatalog"),Pe(">>"),Pe("endobj")},_r=A.__private__.putTrailer=function(){Pe("trailer"),Pe("<<"),Pe("/Size "+($e+1)),Pe("/Root "+$e+" 0 R"),Pe("/Info "+($e-1)+" 0 R"),x!==null&&Pe("/Encrypt "+dr.oid+" 0 R"),Pe("/ID [ <"+je+"> <"+je+"> ]"),Pe(">>")},hn=A.__private__.putHeader=function(){Pe("%PDF-"+B),Pe("%")},Ea=A.__private__.putXRef=function(){var j="0000000000";Pe("xref"),Pe("0 "+($e+1)),Pe("0000000000 65535 f ");for(var fe=1;fe<=$e;fe++)typeof Ye[fe]=="function"?Pe((j+Ye[fe]()).slice(-10)+" 00000 n "):Ye[fe]!==void 0?Pe((j+Ye[fe]).slice(-10)+" 00000 n "):Pe("0000000000 00000 n ")},js=A.__private__.buildDocument=function(){var j;$e=0,ut=0,ct=[],Ye=[],Tt=[],Zr=tr(),qi=tr(),Et(ct),Kn.publish("buildDocument"),hn(),ys(),(function(){Kn.publish("putAdditionalObjects");for(var Me=0;Me<Tt.length;Me++){var We=Tt[Me];cr(We.objId,!0),Pe(We.content),Pe("endobj")}Kn.publish("postPutAdditionalObjects")})(),j=[],(function(){for(var Me in mn)mn.hasOwnProperty(Me)&&(g===!1||g===!0&&w.hasOwnProperty(Me))&&es(mn[Me])})(),(function(){var Me;for(Me in Mn)Mn.hasOwnProperty(Me)&&na(Mn[Me])})(),(function(){for(var Me in vr)vr.hasOwnProperty(Me)&&to(vr[Me])})(),(function(Me){var We;for(We in on)on.hasOwnProperty(We)&&(on[We]instanceof Md?Ps(on[We]):on[We]instanceof Jf&&Os(on[We],Me))})(j),Kn.publish("putResources"),j.forEach(Ms),Ms({resourcesOid:qi,objectOid:Number.MAX_SAFE_INTEGER}),Kn.publish("postPutResources"),x!==null&&(dr.oid=Pi(),Pe("<<"),Pe("/Filter /Standard"),Pe("/V "+dr.v),Pe("/R "+dr.r),Pe("/U <"+dr.toHexString(dr.U)+">"),Pe("/O <"+dr.toHexString(dr.O)+">"),Pe("/P "+dr.P),Pe(">>"),Pe("endobj")),oi(),jr();var fe=ut;return Ea(),_r(),Pe("startxref"),Pe(""+fe),Pe("%%EOF"),Et(Ft[Ee]),ct.join(`
`)},gi=A.__private__.getBlob=function(j){return new Blob([Dt(j)],{type:"application/pdf"})},za=A.output=A.__private__.output=(ms=function(j,fe){switch(typeof(fe=fe||{})=="string"?fe={filename:fe}:fe.filename=fe.filename||"generated.pdf",j){case void 0:return js();case"save":A.save(fe.filename);break;case"arraybuffer":return Dt(js());case"blob":return gi(js());case"bloburi":case"bloburl":if(ai.URL!==void 0&&typeof ai.URL.createObjectURL=="function")return ai.URL&&ai.URL.createObjectURL(gi(js()))||void 0;Qr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Me="",We=js();try{Me=vk(We)}catch{Me=vk(unescape(encodeURIComponent(We)))}return"data:application/pdf;filename="+fe.filename+";base64,"+Me;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ai)==="[object Window]"){var tt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",At=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';fe.pdfObjectUrl&&(tt=fe.pdfObjectUrl,At="");var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+tt+'"'+At+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(fe)+");<\/script></body></html>",an=ai.open();return an!==null&&an.document.write(Pt),an}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ai)==="[object Window]"){var pn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(fe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+fe.filename+'" width="500px" height="400px" /></body></html>',Vn=ai.open();if(Vn!==null){Vn.document.write(pn);var Rn=this;Vn.document.documentElement.querySelector("#pdfViewer").onload=function(){Vn.document.title=fe.filename,Vn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Rn.output("bloburl"))}}return Vn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ai)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Si='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",fe)+'"></iframe></body></html>',Ar=ai.open();if(Ar!==null&&(Ar.document.write(Si),Ar.document.title=fe.filename),Ar||typeof safari>"u")return Ar;break;case"datauri":case"dataurl":return ai.document.location.href=this.output("datauristring",fe);default:return null}},ms.foo=function(){try{return ms.apply(this,arguments)}catch(Me){var j=Me.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var fe="Error in function "+j.split(`
`)[0].split("<")[0]+": "+Me.message;if(!ai.console)throw new Error(fe);ai.console.error(fe,Me),ai.alert&&alert(fe)}},ms.foo.bar=ms,ms.foo),ri=function(j){return Array.isArray(kr)===!0&&kr.indexOf(j)>-1};switch(n){case"pt":$n=1;break;case"mm":$n=72/25.4;break;case"cm":$n=72/2.54;break;case"in":$n=72;break;case"px":$n=ri("px_scaling")==1?.75:96/72;break;case"pc":case"em":$n=12;break;case"ex":$n=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);$n=n}var dr=null;Ne(),qe();var Lr=A.__private__.getPageInfo=A.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ht[j].objId,pageNumber:j,pageContext:Ht[j]}},jo=A.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var fe in Ht)if(Ht[fe].objId===j)break;return Lr(fe)},Bl=A.__private__.getCurrentPageInfo=A.getCurrentPageInfo=function(){return{objId:Ht[Ee].objId,pageNumber:Ee,pageContext:Ht[Ee]}};A.addPage=function(){return Ts.apply(this,arguments),this},A.setPage=function(){return el.apply(this,arguments),Et.call(this,Ft[Ee]),this},A.insertPage=function(j){return this.addPage(),this.movePage(Ee,j),this},A.movePage=function(j,fe){var Me,We;if(j>fe){Me=Ft[j],We=Ht[j];for(var tt=j;tt>fe;tt--)Ft[tt]=Ft[tt-1],Ht[tt]=Ht[tt-1];Ft[fe]=Me,Ht[fe]=We,this.setPage(fe)}else if(j<fe){Me=Ft[j],We=Ht[j];for(var At=j;At<fe;At++)Ft[At]=Ft[At+1],Ht[At]=Ht[At+1];Ft[fe]=Me,Ht[fe]=We,this.setPage(fe)}return this},A.deletePage=function(){return Mo.apply(this,arguments),this},A.__private__.text=A.text=function(j,fe,Me,We,tt){var At,Pt,an,pn,Vn,Rn,Si,Ar,fr,E=(We=We||{}).scope||this;if(typeof j=="number"&&typeof fe=="number"&&(typeof Me=="string"||Array.isArray(Me))){var K=Me;Me=fe,fe=j,j=K}if(arguments[3]instanceof dn==0?(an=arguments[4],pn=arguments[5],Or(Si=arguments[3])==="object"&&Si!==null||(typeof an=="string"&&(pn=an,an=null),typeof Si=="string"&&(pn=Si,Si=null),typeof Si=="number"&&(an=Si,Si=null),We={flags:Si,angle:an,align:pn})):(J("The transform parameter of text() with a Matrix value"),fr=tt),isNaN(fe)||isNaN(Me)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return E;var ne,Ie="",st=typeof We.lineHeightFactor=="number"?We.lineHeightFactor:xi,ft=E.internal.scaleFactor;function jt(Li){return Li=Li.split("	").join(Array(We.TabLen||9).join(" ")),Fs(Li,Si)}function Zn(Li){for(var zi,Er=Li.concat(),hs=[],ol=Er.length;ol--;)typeof(zi=Er.shift())=="string"?hs.push(zi):Array.isArray(Li)&&(zi.length===1||zi[1]===void 0&&zi[2]===void 0)?hs.push(zi[0]):hs.push([zi[0],zi[1],zi[2]]);return hs}function lr(Li,zi){var Er;if(typeof Li=="string")Er=zi(Li)[0];else if(Array.isArray(Li)){for(var hs,ol,Ko=Li.concat(),pu=[],fc=Ko.length;fc--;)typeof(hs=Ko.shift())=="string"?pu.push(zi(hs)[0]):Array.isArray(hs)&&typeof hs[0]=="string"&&(ol=zi(hs[0],hs[1],hs[2]),pu.push([ol[0],ol[1],ol[2]]));Er=pu}return Er}var ui=!1,nr=!0;if(typeof j=="string")ui=!0;else if(Array.isArray(j)){var $s=j.concat();Pt=[];for(var ra,xr=$s.length;xr--;)(typeof(ra=$s.shift())!="string"||Array.isArray(ra)&&typeof ra[0]!="string")&&(nr=!1);ui=nr}if(ui===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var sa=_t/E.internal.scaleFactor,Ga=sa*(st-1);switch(We.baseline){case"bottom":Me-=Ga;break;case"top":Me+=sa-Ga;break;case"hanging":Me+=sa-2*Ga;break;case"middle":Me+=sa/2-Ga}if((Rn=We.maxWidth||0)>0&&(typeof j=="string"?j=E.splitTextToSize(j,Rn):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function(Li,zi){return Li.concat(E.splitTextToSize(zi,Rn))},[]))),At={text:j,x:fe,y:Me,options:We,mutex:{pdfEscape:Fs,activeFontKey:ln,fonts:mn,activeFontSize:_t}},Kn.publish("preProcessText",At),j=At.text,an=(We=At.options).angle,fr instanceof dn==0&&an&&typeof an=="number"){an*=Math.PI/180,We.rotationDirection===0&&(an=-an),me===he&&(an=-an);var Uo=Math.cos(an),nl=Math.sin(an);fr=new dn(Uo,nl,-nl,Uo,0,0)}else an&&an instanceof dn&&(fr=an);me!==he||fr||(fr=ta),(Vn=We.charSpace||As)!==void 0&&(Ie+=ee(le(Vn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ar=We.horizontalScale)!==void 0&&(Ie+=ee(100*Ar)+` Tz
`),We.lang;var ya=-1,xl=We.renderingMode!==void 0?We.renderingMode:We.stroke,Mu=E.internal.getCurrentPageInfo().pageContext;switch(xl){case 0:case!1:case"fill":ya=0;break;case 1:case!0:case"stroke":ya=1;break;case 2:case"fillThenStroke":ya=2;break;case 3:case"invisible":ya=3;break;case 4:case"fillAndAddForClipping":ya=4;break;case 5:case"strokeAndAddPathForClipping":ya=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ya=6;break;case 7:case"addToPathForClipping":ya=7}var cc=Mu.usedRenderingMode!==void 0?Mu.usedRenderingMode:-1;ya!==-1?Ie+=ya+` Tr
`:cc!==-1&&(Ie+=`0 Tr
`),ya!==-1&&(Mu.usedRenderingMode=ya),pn=We.align||"left";var so,Bo=_t*st,wl=E.internal.pageSize.getWidth(),hc=mn[ln];Vn=We.charSpace||As,Rn=We.maxWidth||0,Si=Object.assign({autoencode:!0,noBOM:!0},We.flags);var $o=[],$l=function(Li){return E.getStringUnitWidth(Li,{font:hc,charSpace:Vn,fontSize:_t,doKerning:!1})*_t/ft};if(Object.prototype.toString.call(j)==="[object Array]"){var Ha;Pt=Zn(j),pn!=="left"&&(so=Pt.map($l));var Ra,Go=0;if(pn==="right"){fe-=so[0],j=[],xr=Pt.length;for(var il=0;il<xr;il++)il===0?(Ra=Wr(fe),Ha=wi(Me)):(Ra=le(Go-so[il]),Ha=-Bo),j.push([Pt[il],Ra,Ha]),Go=so[il]}else if(pn==="center"){fe-=so[0]/2,j=[],xr=Pt.length;for(var rl=0;rl<xr;rl++)rl===0?(Ra=Wr(fe),Ha=wi(Me)):(Ra=le((Go-so[rl])/2),Ha=-Bo),j.push([Pt[rl],Ra,Ha]),Go=so[rl]}else if(pn==="left"){j=[],xr=Pt.length;for(var Fu=0;Fu<xr;Fu++)j.push(Pt[Fu])}else if(pn==="justify"&&hc.encoding==="Identity-H"){j=[],xr=Pt.length,Rn=Rn!==0?Rn:wl;for(var fu=0,cs=0;cs<xr;cs++)if(Ha=cs===0?wi(Me):-Bo,Ra=cs===0?Wr(fe):fu,cs<xr-1){var dc=le((Rn-so[cs])/(Pt[cs].split(" ").length-1)),sl=Pt[cs].split(" ");j.push([sl[0]+" ",Ra,Ha]),fu=0;for(var Is=1;Is<sl.length;Is++){var ks=($l(sl[Is-1]+" "+sl[Is])-$l(sl[Is]))*ft+dc;Is==sl.length-1?j.push([sl[Is],ks,0]):j.push([sl[Is]+" ",ks,0]),fu-=ks}}else j.push([Pt[cs],Ra,Ha]);j.push(["",fu,0])}else{if(pn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],xr=Pt.length,Rn=Rn!==0?Rn:wl,cs=0;cs<xr;cs++){Ha=cs===0?wi(Me):-Bo,Ra=cs===0?Wr(fe):0;var Sl=Pt[cs].split(" ").length-1,ao=Sl>0?(Rn-so[cs])/Sl:0;cs<xr-1?$o.push(ee(le(ao))):$o.push(0),j.push([Pt[cs],Ra,Ha])}}}(typeof We.R2L=="boolean"?We.R2L:Tn)===!0&&(j=lr(j,function(Li,zi,Er){return[Li.split("").reverse().join(""),zi,Er]})),At={text:j,x:fe,y:Me,options:We,mutex:{pdfEscape:Fs,activeFontKey:ln,fonts:mn,activeFontSize:_t}},Kn.publish("postProcessText",At),j=At.text,ne=At.mutex.isHex||!1;var ju=mn[ln].encoding;ju!=="WinAnsiEncoding"&&ju!=="StandardEncoding"||(j=lr(j,function(Li,zi,Er){return[jt(Li),zi,Er]})),Pt=Zn(j),j=[];for(var Ho,oo,al,Gl=Array.isArray(Pt[0])?1:0,Ka="",Wn=function(Li,zi,Er){var hs="";return Er instanceof dn?(Er=typeof We.angle=="number"?Aa(Er,new dn(1,0,0,1,Li,zi)):Aa(new dn(1,0,0,1,Li,zi),Er),me===he&&(Er=Aa(new dn(1,0,0,-1,0,0),Er)),hs=Er.join(" ")+` Tm
`):hs=ee(Li)+" "+ee(zi)+` Td
`,hs},Ti=0;Ti<Pt.length;Ti++){switch(Ka="",Gl){case 1:al=(ne?"<":"(")+Pt[Ti][0]+(ne?">":")"),Ho=parseFloat(Pt[Ti][1]),oo=parseFloat(Pt[Ti][2]);break;case 0:al=(ne?"<":"(")+Pt[Ti]+(ne?">":")"),Ho=Wr(fe),oo=wi(Me)}$o!==void 0&&$o[Ti]!==void 0&&(Ka=$o[Ti]+` Tw
`),Ti===0?j.push(Ka+Wn(Ho,oo,fr)+al):Gl===0?j.push(Ka+al):Gl===1&&j.push(Ka+Wn(Ho,oo,fr)+al)}j=Gl===0?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var ts=`BT
/`;return ts+=ln+" "+_t+` Tf
`,ts+=ee(_t*st)+` TL
`,ts+=Us+`
`,ts+=Ie,ts+=j,Pe(ts+="ET"),w[ln]=!0,E};var Vo=A.__private__.clip=A.clip=function(j){return Pe(j==="evenodd"?"W*":"W"),this};A.clipEvenOdd=function(){return Vo("evenodd")},A.__private__.discardPath=A.discardPath=function(){return Pe("n"),this};var br=A.__private__.isValidStyle=function(j){var fe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(fe=!0),fe};A.__private__.setDefaultPathOperation=A.setDefaultPathOperation=function(j){return br(j)&&(f=j),this};var yl=A.__private__.getStyle=A.getStyle=function(j){var fe=f;switch(j){case"D":case"S":fe="S";break;case"F":fe="f";break;case"FD":case"DF":fe="B";break;case"f":case"f*":case"B":case"B*":fe=j}return fe},ia=A.close=function(){return Pe("h"),this};A.stroke=function(){return Pe("S"),this},A.fill=function(j){return Oi("f",j),this},A.fillEvenOdd=function(j){return Oi("f*",j),this},A.fillStroke=function(j){return Oi("B",j),this},A.fillStrokeEvenOdd=function(j){return Oi("B*",j),this};var Oi=function(j,fe){Or(fe)==="object"?_l(fe,j):Pe(j)},no=function(j){j===null||me===he&&j===void 0||(j=yl(j),Pe(j))};function vl(j,fe,Me,We,tt){var At=new Jf(fe||this.boundingBox,Me||this.xStep,We||this.yStep,this.gState,tt||this.matrix);At.stream=this.stream;var Pt=j+"$$"+this.cloneIndex+++"$$";return Rr(Pt,At),At}var _l=function(j,fe){var Me=Ni[j.key],We=on[Me];if(We instanceof Md)Pe("q"),Pe(zo(fe)),We.gState&&A.setGState(We.gState),Pe(j.matrix.toString()+" cm"),Pe("/"+Me+" sh"),Pe("Q");else if(We instanceof Jf){var tt=new dn(1,0,0,-1,0,ro());j.matrix&&(tt=tt.multiply(j.matrix||ta),Me=vl.call(We,j.key,j.boundingBox,j.xStep,j.yStep,tt).id),Pe("q"),Pe("/Pattern cs"),Pe("/"+Me+" scn"),We.gState&&A.setGState(We.gState),Pe(fe),Pe("Q")}},zo=function(j){switch(j){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ua=A.moveTo=function(j,fe){return Pe(ee(le(j))+" "+ee(ze(fe))+" m"),this},It=A.lineTo=function(j,fe){return Pe(ee(le(j))+" "+ee(ze(fe))+" l"),this},Mt=A.curveTo=function(j,fe,Me,We,tt,At){return Pe([ee(le(j)),ee(ze(fe)),ee(le(Me)),ee(ze(We)),ee(le(tt)),ee(ze(At)),"c"].join(" ")),this};A.__private__.line=A.line=function(j,fe,Me,We,tt){if(isNaN(j)||isNaN(fe)||isNaN(Me)||isNaN(We)||!br(tt))throw new Error("Invalid arguments passed to jsPDF.line");return me===ge?this.lines([[Me-j,We-fe]],j,fe,[1,1],tt||"S"):this.lines([[Me-j,We-fe]],j,fe,[1,1]).stroke()},A.__private__.lines=A.lines=function(j,fe,Me,We,tt,At){var Pt,an,pn,Vn,Rn,Si,Ar,fr,E,K,ne,Ie;if(typeof j=="number"&&(Ie=Me,Me=fe,fe=j,j=Ie),We=We||[1,1],At=At||!1,isNaN(fe)||isNaN(Me)||!Array.isArray(j)||!Array.isArray(We)||!br(tt)||typeof At!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ua(fe,Me),Pt=We[0],an=We[1],Vn=j.length,K=fe,ne=Me,pn=0;pn<Vn;pn++)(Rn=j[pn]).length===2?(K=Rn[0]*Pt+K,ne=Rn[1]*an+ne,It(K,ne)):(Si=Rn[0]*Pt+K,Ar=Rn[1]*an+ne,fr=Rn[2]*Pt+K,E=Rn[3]*an+ne,K=Rn[4]*Pt+K,ne=Rn[5]*an+ne,Mt(Si,Ar,fr,E,K,ne));return At&&ia(),no(tt),this},A.path=function(j){for(var fe=0;fe<j.length;fe++){var Me=j[fe],We=Me.c;switch(Me.op){case"m":Ua(We[0],We[1]);break;case"l":It(We[0],We[1]);break;case"c":Mt.apply(this,We);break;case"h":ia()}}return this},A.__private__.rect=A.rect=function(j,fe,Me,We,tt){if(isNaN(j)||isNaN(fe)||isNaN(Me)||isNaN(We)||!br(tt))throw new Error("Invalid arguments passed to jsPDF.rect");return me===ge&&(We=-We),Pe([ee(le(j)),ee(ze(fe)),ee(le(Me)),ee(le(We)),"re"].join(" ")),no(tt),this},A.__private__.triangle=A.triangle=function(j,fe,Me,We,tt,At,Pt){if(isNaN(j)||isNaN(fe)||isNaN(Me)||isNaN(We)||isNaN(tt)||isNaN(At)||!br(Pt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Me-j,We-fe],[tt-Me,At-We],[j-tt,fe-At]],j,fe,[1,1],Pt,!0),this},A.__private__.roundedRect=A.roundedRect=function(j,fe,Me,We,tt,At,Pt){if(isNaN(j)||isNaN(fe)||isNaN(Me)||isNaN(We)||isNaN(tt)||isNaN(At)||!br(Pt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var an=4/3*(Math.SQRT2-1);return tt=Math.min(tt,.5*Me),At=Math.min(At,.5*We),this.lines([[Me-2*tt,0],[tt*an,0,tt,At-At*an,tt,At],[0,We-2*At],[0,At*an,-tt*an,At,-tt,At],[2*tt-Me,0],[-tt*an,0,-tt,-At*an,-tt,-At],[0,2*At-We],[0,-At*an,tt*an,-At,tt,-At]],j+tt,fe,[1,1],Pt,!0),this},A.__private__.ellipse=A.ellipse=function(j,fe,Me,We,tt){if(isNaN(j)||isNaN(fe)||isNaN(Me)||isNaN(We)||!br(tt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var At=4/3*(Math.SQRT2-1)*Me,Pt=4/3*(Math.SQRT2-1)*We;return Ua(j+Me,fe),Mt(j+Me,fe-Pt,j+At,fe-We,j,fe-We),Mt(j-At,fe-We,j-Me,fe-Pt,j-Me,fe),Mt(j-Me,fe+Pt,j-At,fe+We,j,fe+We),Mt(j+At,fe+We,j+Me,fe+Pt,j+Me,fe),no(tt),this},A.__private__.circle=A.circle=function(j,fe,Me,We){if(isNaN(j)||isNaN(fe)||isNaN(Me)||!br(We))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,fe,Me,Me,We)},A.setFont=function(j,fe,Me){return Me&&(fe=pe(fe,Me)),ln=Fo(j,fe,{disableWarning:!1}),this};var kn=A.__private__.getFont=A.getFont=function(){return mn[Fo.apply(A,arguments)]};A.__private__.getFontList=A.getFontList=function(){var j,fe,Me={};for(j in On)if(On.hasOwnProperty(j))for(fe in Me[j]=[],On[j])On[j].hasOwnProperty(fe)&&Me[j].push(fe);return Me},A.addFont=function(j,fe,Me,We,tt){var At=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&At.indexOf(arguments[3])!==-1?tt=arguments[3]:arguments[3]&&At.indexOf(arguments[3])==-1&&(Me=pe(Me,We)),ml.call(this,j,fe,Me,tt=tt||"Identity-H")};var xi,or=i.lineWidth||.200025,Mi=A.__private__.getLineWidth=A.getLineWidth=function(){return or},rn=A.__private__.setLineWidth=A.setLineWidth=function(j){return or=j,Pe(ee(le(j))+" w"),this};A.__private__.setLineDash=In.API.setLineDash=In.API.setLineDashPattern=function(j,fe){if(j=j||[],fe=fe||0,isNaN(fe)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(Me){return ee(le(Me))}).join(" "),fe=ee(le(fe)),Pe("["+j+"] "+fe+" d"),this};var Vs=A.__private__.getLineHeight=A.getLineHeight=function(){return _t*xi};A.__private__.getLineHeight=A.getLineHeight=function(){return _t*xi};var io=A.__private__.setLineHeightFactor=A.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(xi=j),this},pa=A.__private__.getLineHeightFactor=A.getLineHeightFactor=function(){return xi};io(i.lineHeight);var Wr=A.__private__.getHorizontalCoordinate=function(j){return le(j)},wi=A.__private__.getVerticalCoordinate=function(j){return me===he?j:Ht[Ee].mediaBox.topRightY-Ht[Ee].mediaBox.bottomLeftY-le(j)},ga=A.__private__.getHorizontalCoordinateString=A.getHorizontalCoordinateString=function(j){return ee(Wr(j))},ki=A.__private__.getVerticalCoordinateString=A.getVerticalCoordinateString=function(j){return ee(wi(j))},zs=i.strokeColor||"0 G";A.__private__.getStrokeColor=A.getDrawColor=function(){return Yi(zs)},A.__private__.setStrokeColor=A.setDrawColor=function(j,fe,Me,We){return zs=Kr({ch1:j,ch2:fe,ch3:Me,ch4:We,pdfColorType:"draw",precision:2}),Pe(zs),this};var Ba=i.fillColor||"0 g";A.__private__.getFillColor=A.getFillColor=function(){return Yi(Ba)},A.__private__.setFillColor=A.setFillColor=function(j,fe,Me,We){return Ba=Kr({ch1:j,ch2:fe,ch3:Me,ch4:We,pdfColorType:"fill",precision:2}),Pe(Ba),this};var Us=i.textColor||"0 g",fn=A.__private__.getTextColor=A.getTextColor=function(){return Yi(Us)};A.__private__.setTextColor=A.setTextColor=function(j,fe,Me,We){return Us=Kr({ch1:j,ch2:fe,ch3:Me,ch4:We,pdfColorType:"text",precision:3}),this};var As=i.charSpace,Ia=A.__private__.getCharSpace=A.getCharSpace=function(){return parseFloat(As||0)};A.__private__.setCharSpace=A.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return As=j,this};var qr=0;A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.__private__.setLineCap=A.setLineCap=function(j){var fe=A.CapJoinStyles[j];if(fe===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qr=fe,Pe(fe+" J"),this};var Tr=0;A.__private__.setLineJoin=A.setLineJoin=function(j){var fe=A.CapJoinStyles[j];if(fe===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tr=fe,Pe(fe+" j"),this},A.__private__.setLineMiterLimit=A.__private__.setMiterLimit=A.setLineMiterLimit=A.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Pe(ee(le(j))+" M"),this},A.GState=I1,A.setGState=function(j){(j=typeof j=="string"?Mn[xn[j]]:ka(null,j)).equals(Qn)||(Pe("/"+j.id+" gs"),Qn=j)};var ka=function(j,fe){if(!j||!xn[j]){var Me=!1;for(var We in Mn)if(Mn.hasOwnProperty(We)&&Mn[We].equals(fe)){Me=!0;break}if(Me)fe=Mn[We];else{var tt="GS"+(Object.keys(Mn).length+1).toString(10);Mn[tt]=fe,fe.id=tt}return j&&(xn[j]=fe.id),Kn.publish("addGState",fe),fe}};A.addGState=function(j,fe){return ka(j,fe),this},A.saveGraphicsState=function(){return Pe("q"),qn.push({key:ln,size:_t,color:Us}),this},A.restoreGraphicsState=function(){Pe("Q");var j=qn.pop();return ln=j.key,_t=j.size,Us=j.color,Qn=null,this},A.setCurrentTransformationMatrix=function(j){return Pe(j.toString()+" cm"),this},A.comment=function(j){return Pe("#"+j),this};var Vr=function(j,fe){var Me=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Me},set:function(At){isNaN(At)||(Me=parseFloat(At))}});var We=fe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return We},set:function(At){isNaN(At)||(We=parseFloat(At))}});var tt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return tt},set:function(At){tt=At.toString()}}),this},Ca=function(j,fe,Me,We){Vr.call(this,j,fe),this.type="rect";var tt=Me||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return tt},set:function(Pt){isNaN(Pt)||(tt=parseFloat(Pt))}});var At=We||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return At},set:function(Pt){isNaN(Pt)||(At=parseFloat(Pt))}}),this},ma=function(){this.page=Qt,this.currentPage=Ee,this.pages=Ft.slice(0),this.pagesContext=Ht.slice(0),this.x=cn,this.y=er,this.matrix=Jn,this.width=Ri(Ee),this.height=$a(Ee),this.outputDestination=qt,this.id="",this.objectNumber=-1};ma.prototype.restore=function(){Qt=this.page,Ee=this.currentPage,Ht=this.pagesContext,Ft=this.pages,cn=this.x,er=this.y,Jn=this.matrix,Es(Ee,this.width),Bs(Ee,this.height),qt=this.outputDestination};var us=function(j,fe,Me,We,tt){Ci.push(new ma),Qt=Ee=0,Ft=[],cn=j,er=fe,Jn=tt,fa([Me,We])};for(var Cn in A.beginFormObject=function(j,fe,Me,We,tt){return us(j,fe,Me,We,tt),this},A.endFormObject=function(j){return(function(fe){if(Cr[fe])Ci.pop().restore();else{var Me=new ma,We="Xo"+(Object.keys(vr).length+1).toString(10);Me.id=We,Cr[fe]=We,vr[We]=Me,Kn.publish("addFormObject",Me),Ci.pop().restore()}})(j),this},A.doFormObject=function(j,fe){var Me=vr[Cr[j]];return Pe("q"),Pe(fe.toString()+" cm"),Pe("/"+Me.id+" Do"),Pe("Q"),this},A.getFormObject=function(j){var fe=vr[Cr[j]];return{x:fe.x,y:fe.y,width:fe.width,height:fe.height,matrix:fe.matrix}},A.save=function(j,fe){return j=j||"generated.pdf",(fe=fe||{}).returnPromise=fe.returnPromise||!1,fe.returnPromise===!1?(Cd(gi(js()),j),typeof Cd.unload=="function"&&ai.setTimeout&&setTimeout(Cd.unload,911),this):new Promise(function(Me,We){try{var tt=Cd(gi(js()),j);typeof Cd.unload=="function"&&ai.setTimeout&&setTimeout(Cd.unload,911),Me(tt)}catch(At){We(At.message)}})},In.API)In.API.hasOwnProperty(Cn)&&(Cn==="events"&&In.API.events.length?(function(j,fe){var Me,We,tt;for(tt=fe.length-1;tt!==-1;tt--)Me=fe[tt][0],We=fe[tt][1],j.subscribe.apply(j,[Me].concat(typeof We=="function"?[We]:We))})(Kn,In.API.events):A[Cn]=In.API[Cn]);function Ri(j){return Ht[j].mediaBox.topRightX-Ht[j].mediaBox.bottomLeftX}function Es(j,fe){Ht[j].mediaBox.topRightX=fe+Ht[j].mediaBox.bottomLeftX}function $a(j){return Ht[j].mediaBox.topRightY-Ht[j].mediaBox.bottomLeftY}function Bs(j,fe){Ht[j].mediaBox.topRightY=fe+Ht[j].mediaBox.bottomLeftY}var wo=A.getPageWidth=function(j){return Ri(j=j||Ee)/$n},du=A.setPageWidth=function(j,fe){Es(j,fe*$n)},ro=A.getPageHeight=function(j){return $a(j=j||Ee)/$n},bl=A.setPageHeight=function(j,fe){Bs(j,fe*$n)};return A.internal={pdfEscape:Fs,getStyle:yl,getFont:kn,getFontSize:Xt,getCharSpace:Ia,getTextColor:fn,getLineHeight:Vs,getLineHeightFactor:pa,getLineWidth:Mi,write:$t,getHorizontalCoordinate:Wr,getVerticalCoordinate:wi,getCoordinateString:ga,getVerticalCoordinateString:ki,collections:{},newObject:Pi,newAdditionalObject:os,newObjectDeferred:tr,newObjectDeferredBegin:cr,getFilters:ls,putStream:da,events:Kn,scaleFactor:$n,pageSize:{getWidth:function(){return wo(Ee)},setWidth:function(j){du(Ee,j)},getHeight:function(){return ro(Ee)},setHeight:function(j){bl(Ee,j)}},encryptionOptions:x,encryption:dr,getEncryptor:function(j){return x!==null?dr.encryptor(j,0):function(fe){return fe}},output:za,getNumberOfPages:tl,get pages(){return Ft},out:Pe,f2:X,f3:ae,getPageInfo:Lr,getPageInfoByObjId:jo,getCurrentPageInfo:Bl,getPDFVersion:$,Point:Vr,Rectangle:Ca,Matrix:dn,hasHotfix:ri},Object.defineProperty(A.internal.pageSize,"width",{get:function(){return wo(Ee)},set:function(j){du(Ee,j)},enumerable:!0,configurable:!0}),Object.defineProperty(A.internal.pageSize,"height",{get:function(){return ro(Ee)},set:function(j){bl(Ee,j)},enumerable:!0,configurable:!0}),(function(j){for(var fe=0,Me=wn.length;fe<Me;fe++){var We=ml.call(this,j[fe][0],j[fe][1],j[fe][2],wn[fe][3],!0);g===!1&&(w[We]=!0);var tt=j[fe][0].split("-");hr({id:We,fontName:tt[0],fontStyle:tt[1]||""})}Kn.publish("addFonts",{fonts:mn,dictionary:On})}).call(A,wn),ln="F1",Ts(r,t),Kn.publish("initialized"),A}Kf.prototype.lsbFirstWord=function(i){return String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255)},Kf.prototype.toHexString=function(i){return i.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Kf.prototype.hexToBytes=function(i){for(var e=[],t=0;t<i.length;t+=2)e.push(String.fromCharCode(parseInt(i.substr(t,2),16)));return e.join("")},Kf.prototype.processOwnerPassword=function(i,e){return Gx($x(e).substr(0,5),i)},Kf.prototype.encryptor=function(i,e){var t=$x(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Gx(t,n)}},I1.prototype.equals=function(i){var e,t="id,objectNumber,equals";if(!i||Or(i)!==Or(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!i.hasOwnProperty(e)||this[e]!==i[e])return!1;n++}for(e in i)i.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},In.API={events:[]},In.version="3.0.4";var Ys=In.API,tS=1,pf=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jf=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},pi=function(i){return i.toFixed(2)},Lh=function(i){return i.toFixed(5)};Ys.__acroform__={};var gl=function(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i},wk=function(i){return i*tS},qu=function(i){var e=new ND,t=vn.internal.getHeight(i)||0,n=vn.internal.getWidth(i)||0;return e.BBox=[0,0,Number(pi(n)),Number(pi(t))],e},uW=Ys.__acroform__.setBit=function(i,e){if(i=i||0,e=e||0,isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|1<<e},cW=Ys.__acroform__.clearBit=function(i,e){if(i=i||0,e=e||0,isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&~(1<<e)},hW=Ys.__acroform__.getBit=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<e?1:0},la=Ys.__acroform__.getBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return hW(i,e-1)},ua=Ys.__acroform__.setBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return uW(i,e-1)},ca=Ys.__acroform__.clearBitForPdf=function(i,e){if(isNaN(i)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return cW(i,e-1)},dW=Ys.__acroform__.calculateCoordinates=function(i,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,r=i[0],s=i[1],l=i[2],u=i[3],h={};return h.lowerLeft_X=t(r)||0,h.lowerLeft_Y=n(s+u)||0,h.upperRight_X=t(r+l)||0,h.upperRight_Y=n(s)||0,[Number(pi(h.lowerLeft_X)),Number(pi(h.lowerLeft_Y)),Number(pi(h.upperRight_X)),Number(pi(h.upperRight_Y))]},fW=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var e=[],t=i._V||i.DV,n=Hx(i,t),r=i.scope.internal.getFont(i.fontName,i.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(i.scope.__private__.encodeColorString(i.color)),e.push("/"+r+" "+pi(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=qu(i);return s.scope=i.scope,s.stream=e.join(`
`),s}},Hx=function(i,e){var t=i.fontSize===0?i.maxFontSize:i.fontSize,n={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=i.multiline?r.map(function(X){return X.split(`
`)}):r.map(function(X){return[X]});var s=t,l=vn.internal.getHeight(i)||0;l=l<0?-l:l;var u=vn.internal.getWidth(i)||0;u=u<0?-u:u;var h=function(X,ae,le){if(X+1<r.length){var ze=ae+" "+r[X+1][0];return r0(ze,i,le).width<=u-4}return!1};s++;e:for(;s>0;){e="",s--;var f,x,g=r0("3",i,s).height,w=i.multiline?l-s:(l-g)/2,A=w+=2,B=0,$=0,W=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+r0(e,i,s=12).width+", FieldWidth:"+u+`
`;break}for(var q="",ge=0,he=0;he<r.length;he++)if(r.hasOwnProperty(he)){var me=!1;if(r[he].length!==1&&W!==r[he].length-1){if((g+2)*(ge+2)+2>l)continue e;q+=r[he][W],me=!0,$=he,he--}else{q=(q+=r[he][W]+" ").substr(q.length-1)==" "?q.substr(0,q.length-1):q;var Ce=parseInt(he),Ve=h(Ce,q,s),pe=he>=r.length-1;if(Ve&&!pe){q+=" ",W=0;continue}if(Ve||pe){if(pe)$=Ce;else if(i.multiline&&(g+2)*(ge+2)+2>l)continue e}else{if(!i.multiline||(g+2)*(ge+2)+2>l)continue e;$=Ce}}for(var ee="",J=B;J<=$;J++){var ye=r[J];if(i.multiline){if(J===$){ee+=ye[W]+" ",W=(W+1)%ye.length;continue}if(J===B){ee+=ye[ye.length-1]+" ";continue}}ee+=ye[0]+" "}switch(ee=ee.substr(ee.length-1)==" "?ee.substr(0,ee.length-1):ee,x=r0(ee,i,s).width,i.textAlign){case"right":f=u-x-2;break;case"center":f=(u-x)/2;break;default:f=2}e+=pi(f)+" "+pi(A)+` Td
`,e+="("+pf(ee)+`) Tj
`,e+=-pi(f)+` 0 Td
`,A=-(s+2),x=0,B=me?$:$+1,ge++,q=""}break}return n.text=e,n.fontSize=s,n},r0=function(i,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(i,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},pW={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gW=function(i,e){var t={type:"reference",object:i};e.internal.getPageInfo(i.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(i.page).pageContext.annotations.push(t)},mW=function(i,e){if(e.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(Pu.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(pW)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");tS=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new PD,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in n)if(n.hasOwnProperty(r)){var s=n[r];s.objId=void 0,s.hasAnnotation&&gW(s,t)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(t){(function(n,r){var s=!n;for(var l in n||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(l)){var u=n[l],h=[],f=u.Rect;if(u.Rect&&(u.Rect=dW(u.Rect,r)),r.internal.newObjectDeferredBegin(u.objId,!0),u.DA=vn.createDefaultAppearanceStream(u),Or(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(h=u.getKeyValueListForStream()),u.Rect=f,u.hasAppearanceStream&&!u.appearanceStreamContent){var x=fW(u);h.push({key:"AP",value:"<</N "+x+">>"}),r.internal.acroformPlugin.xForms.push(x)}if(u.appearanceStreamContent){var g="";for(var w in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(w)){var A=u.appearanceStreamContent[w];if(g+="/"+w+" ",g+="<<",Object.keys(A).length>=1||Array.isArray(A)){for(var l in A)if(A.hasOwnProperty(l)){var B=A[l];typeof B=="function"&&(B=B.call(r,u)),g+="/"+l+" "+B+" ",r.internal.acroformPlugin.xForms.indexOf(B)>=0||r.internal.acroformPlugin.xForms.push(B)}}else typeof(B=A)=="function"&&(B=B.call(r,u)),g+="/"+l+" "+B,r.internal.acroformPlugin.xForms.indexOf(B)>=0||r.internal.acroformPlugin.xForms.push(B);g+=">>"}h.push({key:"AP",value:`<<
`+g+">>"})}r.internal.putStream({additionalKeyValues:h,objectId:u.objId}),r.internal.out("endobj")}s&&(function($,W){for(var q in $)if($.hasOwnProperty(q)){var ge=q,he=$[q];W.internal.newObjectDeferredBegin(he.objId,!0),Or(he)==="object"&&typeof he.putStream=="function"&&he.putStream(),delete $[ge]}})(r.internal.acroformPlugin.xForms,r)})(t,i)}),i.internal.acroformPlugin.isInitialized=!0}},DD=Ys.__acroform__.arrayToPdfArray=function(i,e,t){var n=function(l){return l};if(Array.isArray(i)){for(var r="[",s=0;s<i.length;s++)switch(s!==0&&(r+=" "),Or(i[s])){case"boolean":case"number":case"object":r+=i[s].toString();break;case"string":i[s].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),r+="("+pf(n(i[s].toString()))+")"):r+=i[s].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Cb=function(i,e,t){var n=function(r){return r};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(i=i||"").toString(),"("+pf(n(i))+")"},Zu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Zu.prototype.toString=function(){return this.objId+" 0 R"},Zu.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},Zu.prototype.getKeyValueListForStream=function(){var i=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],r=this[n];r&&(Array.isArray(r)?i.push({key:n,value:DD(r,this.objId,this.scope)}):r instanceof Zu?(r.scope=this.scope,i.push({key:n,value:r.objId+" 0 R"})):typeof r!="function"&&i.push({key:n,value:r}))}return i};var ND=function(){Zu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){i=t.trim()},get:function(){return i||null}})};gl(ND,Zu);var PD=function(){Zu.call(this);var i,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+pf(t(i))+")"}},set:function(t){i=t}})};gl(PD,Zu);var Pu=function i(){Zu.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(q){if(isNaN(q))throw new Error('Invalid value "'+q+'" for attribute F supplied.');e=q}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!la(e,3)},set:function(q){q?this.F=ua(e,3):this.F=ca(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(q){if(isNaN(q))throw new Error('Invalid value "'+q+'" for attribute Ff supplied.');t=q}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(q){n=q!==void 0?q:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(q){n[0]=q}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(q){n[1]=q}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(q){n[2]=q}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(q){n[3]=q}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(q){switch(q){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=q;break;default:throw new Error('Invalid value "'+q+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof k1)return;s="FieldObject"+i.FieldNum++}var q=function(ge){return ge};return this.scope&&(q=this.scope.internal.getEncryptor(this.objId)),"("+pf(q(s))+")"},set:function(q){s=q.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(q){s=q}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(q){l=q}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(q){u=q}});var h=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return h},set:function(q){h=q}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/tS:f},set:function(q){f=q}});var x="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return x},set:function(q){x=q}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof k1||this instanceof Hd))return Cb(g,this.objId,this.scope)},set:function(q){q=q.toString(),g=q}});var w=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(w)return this instanceof Za==0?Cb(w,this.objId,this.scope):w},set:function(q){q=q.toString(),w=this instanceof Za==0?q.substr(0,1)==="("?jf(q.substr(1,q.length-2)):jf(q):q}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Za==1?jf(w.substr(1,w.length-1)):w},set:function(q){q=q.toString(),w=this instanceof Za==1?"/"+q:q}});var A=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(A)return A},set:function(q){this.V=q}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Za==0?Cb(A,this.objId,this.scope):A},set:function(q){q=q.toString(),A=this instanceof Za==0?q.substr(0,1)==="("?jf(q.substr(1,q.length-2)):jf(q):q}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Za==1?jf(A.substr(1,A.length-1)):A},set:function(q){q=q.toString(),A=this instanceof Za==1?"/"+q:q}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var B,$=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return $},set:function(q){q=!!q,$=q}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(B)return B},set:function(q){B=q}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,1)},set:function(q){q?this.Ff=ua(this.Ff,1):this.Ff=ca(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,2)},set:function(q){q?this.Ff=ua(this.Ff,2):this.Ff=ca(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,3)},set:function(q){q?this.Ff=ua(this.Ff,3):this.Ff=ca(this.Ff,3)}});var W=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(W!==null)return W},set:function(q){if([0,1,2].indexOf(q)===-1)throw new Error('Invalid value "'+q+'" for attribute Q supplied.');W=q}}),Object.defineProperty(this,"textAlign",{get:function(){var q;switch(W){case 0:default:q="left";break;case 1:q="center";break;case 2:q="right"}return q},configurable:!0,enumerable:!0,set:function(q){switch(q){case"right":case 2:W=2;break;case"center":case 1:W=1;break;default:W=0}}})};gl(Pu,Zu);var sp=function(){Pu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){i=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return DD(e,this.objId,this.scope)},set:function(t){var n,r;r=[],typeof(n=t)=="string"&&(r=(function(s,l,u){u||(u=1);for(var h,f=[];h=l.exec(s);)f.push(h[u]);return f})(n,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,18)},set:function(t){t?this.Ff=ua(this.Ff,18):this.Ff=ca(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ua(this.Ff,19):this.Ff=ca(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,20)},set:function(t){t?(this.Ff=ua(this.Ff,20),e.sort()):this.Ff=ca(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,22)},set:function(t){t?this.Ff=ua(this.Ff,22):this.Ff=ca(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,23)},set:function(t){t?this.Ff=ua(this.Ff,23):this.Ff=ca(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,27)},set:function(t){t?this.Ff=ua(this.Ff,27):this.Ff=ca(this.Ff,27)}}),this.hasAppearanceStream=!1};gl(sp,Pu);var ap=function(){sp.call(this),this.fontName="helvetica",this.combo=!1};gl(ap,sp);var op=function(){ap.call(this),this.combo=!0};gl(op,ap);var R0=function(){op.call(this),this.edit=!0};gl(R0,op);var Za=function(){Pu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,15)},set:function(t){t?this.Ff=ua(this.Ff,15):this.Ff=ca(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,16)},set:function(t){t?this.Ff=ua(this.Ff,16):this.Ff=ca(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,17)},set:function(t){t?this.Ff=ua(this.Ff,17):this.Ff=ca(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,26)},set:function(t){t?this.Ff=ua(this.Ff,26):this.Ff=ca(this.Ff,26)}});var i,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,r=[];for(n in r.push("<<"),e)r.push("/"+n+" ("+pf(t(e[n]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){Or(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(t){i="/"+t}})};gl(Za,Pu);var L0=function(){Za.call(this),this.pushButton=!0};gl(L0,Za);var lp=function(){Za.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e!==void 0?e:[]}})};gl(lp,Za);var k1=function(){var i,e;Pu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(u){return u};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),n)l.push("/"+s+" ("+pf(r(n[s]))+")");return l.push(">>"),l.join(`
`)},set:function(r){Or(r)==="object"&&(n=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(r){typeof r=="string"&&(n.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};gl(k1,Pu),lp.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=i.createAppearanceStream(t.optionName),t.caption=i.getCA()}},lp.prototype.createOption=function(i){var e=new k1;return e.Parent=this,e.optionName=i,this.Kids.push(e),yW.call(this.scope,e),e};var D0=function(){Za.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vn.CheckBox.createAppearanceStream()};gl(D0,Za);var Hd=function(){Pu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,13)},set:function(e){e?this.Ff=ua(this.Ff,13):this.Ff=ca(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,21)},set:function(e){e?this.Ff=ua(this.Ff,21):this.Ff=ca(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,23)},set:function(e){e?this.Ff=ua(this.Ff,23):this.Ff=ca(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,24)},set:function(e){e?this.Ff=ua(this.Ff,24):this.Ff=ca(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,25)},set:function(e){e?this.Ff=ua(this.Ff,25):this.Ff=ca(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,26)},set:function(e){e?this.Ff=ua(this.Ff,26):this.Ff=ca(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){Number.isInteger(e)&&(i=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};gl(Hd,Pu);var N0=function(){Hd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!la(this.Ff,14)},set:function(i){i?this.Ff=ua(this.Ff,14):this.Ff=ca(this.Ff,14)}}),this.password=!0};gl(N0,Hd);var vn={CheckBox:{createAppearanceStream:function(){return{N:{On:vn.CheckBox.YesNormal},D:{On:vn.CheckBox.YesPushDown,Off:vn.CheckBox.OffPushDown}}},YesPushDown:function(i){var e=qu(i);e.scope=i.scope;var t=[],n=i.scope.internal.getFont(i.fontName,i.fontStyle).id,r=i.scope.__private__.encodeColorString(i.color),s=Hx(i,i.caption);return t.push("0.749023 g"),t.push("0 0 "+pi(vn.internal.getWidth(i))+" "+pi(vn.internal.getHeight(i))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+pi(s.fontSize)+" Tf "+r),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(i){var e=qu(i);e.scope=i.scope;var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),r=[],s=vn.internal.getHeight(i),l=vn.internal.getWidth(i),u=Hx(i,i.caption);return r.push("1 g"),r.push("0 0 "+pi(l)+" "+pi(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+pi(l-1)+" "+pi(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+pi(u.fontSize)+" Tf "+n),r.push(u.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(i){var e=qu(i);e.scope=i.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+pi(vn.internal.getWidth(i))+" "+pi(vn.internal.getHeight(i))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(i){var e={D:{Off:vn.RadioButton.Circle.OffPushDown},N:{}};return e.N[i]=vn.RadioButton.Circle.YesNormal,e.D[i]=vn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(i){var e=qu(i);e.scope=i.scope;var t=[],n=vn.internal.getWidth(i)<=vn.internal.getHeight(i)?vn.internal.getWidth(i)/4:vn.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=vn.internal.Bezier_C,s=Number((n*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Lh(vn.internal.getWidth(i)/2)+" "+Lh(vn.internal.getHeight(i)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(i){var e=qu(i);e.scope=i.scope;var t=[],n=vn.internal.getWidth(i)<=vn.internal.getHeight(i)?vn.internal.getWidth(i)/4:vn.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*vn.internal.Bezier_C).toFixed(5)),l=Number((n*vn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Lh(vn.internal.getWidth(i)/2)+" "+Lh(vn.internal.getHeight(i)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Lh(vn.internal.getWidth(i)/2)+" "+Lh(vn.internal.getHeight(i)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+l+" "+l+" "+n+" 0 "+n+" c"),t.push("-"+l+" "+n+" -"+n+" "+l+" -"+n+" 0 c"),t.push("-"+n+" -"+l+" -"+l+" -"+n+" 0 -"+n+" c"),t.push(l+" -"+n+" "+n+" -"+l+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(i){var e=qu(i);e.scope=i.scope;var t=[],n=vn.internal.getWidth(i)<=vn.internal.getHeight(i)?vn.internal.getWidth(i)/4:vn.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),s=Number((r*vn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Lh(vn.internal.getWidth(i)/2)+" "+Lh(vn.internal.getHeight(i)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(i){var e={D:{Off:vn.RadioButton.Cross.OffPushDown},N:{}};return e.N[i]=vn.RadioButton.Cross.YesNormal,e.D[i]=vn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(i){var e=qu(i);e.scope=i.scope;var t=[],n=vn.internal.calculateCross(i);return t.push("q"),t.push("1 1 "+pi(vn.internal.getWidth(i)-2)+" "+pi(vn.internal.getHeight(i)-2)+" re"),t.push("W"),t.push("n"),t.push(pi(n.x1.x)+" "+pi(n.x1.y)+" m"),t.push(pi(n.x2.x)+" "+pi(n.x2.y)+" l"),t.push(pi(n.x4.x)+" "+pi(n.x4.y)+" m"),t.push(pi(n.x3.x)+" "+pi(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(i){var e=qu(i);e.scope=i.scope;var t=vn.internal.calculateCross(i),n=[];return n.push("0.749023 g"),n.push("0 0 "+pi(vn.internal.getWidth(i))+" "+pi(vn.internal.getHeight(i))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+pi(vn.internal.getWidth(i)-2)+" "+pi(vn.internal.getHeight(i)-2)+" re"),n.push("W"),n.push("n"),n.push(pi(t.x1.x)+" "+pi(t.x1.y)+" m"),n.push(pi(t.x2.x)+" "+pi(t.x2.y)+" l"),n.push(pi(t.x4.x)+" "+pi(t.x4.y)+" m"),n.push(pi(t.x3.x)+" "+pi(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(i){var e=qu(i);e.scope=i.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+pi(vn.internal.getWidth(i))+" "+pi(vn.internal.getHeight(i))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(i){var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,t=i.scope.__private__.encodeColorString(i.color);return"/"+e+" "+i.fontSize+" Tf "+t}};vn.internal={Bezier_C:.551915024494,calculateCross:function(i){var e=vn.internal.getWidth(i),t=vn.internal.getHeight(i),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},vn.internal.getWidth=function(i){var e=0;return Or(i)==="object"&&(e=wk(i.Rect[2])),e},vn.internal.getHeight=function(i){var e=0;return Or(i)==="object"&&(e=wk(i.Rect[3])),e};var yW=Ys.addField=function(i){if(mW(this,i),!(i instanceof Pu))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=i).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};Ys.AcroFormChoiceField=sp,Ys.AcroFormListBox=ap,Ys.AcroFormComboBox=op,Ys.AcroFormEditBox=R0,Ys.AcroFormButton=Za,Ys.AcroFormPushButton=L0,Ys.AcroFormRadioButton=lp,Ys.AcroFormCheckBox=D0,Ys.AcroFormTextField=Hd,Ys.AcroFormPasswordField=N0,Ys.AcroFormAppearance=vn,Ys.AcroForm={ChoiceField:sp,ListBox:ap,ComboBox:op,EditBox:R0,Button:Za,PushButton:L0,RadioButton:lp,CheckBox:D0,TextField:Hd,PasswordField:N0,Appearance:vn},In.AcroForm={ChoiceField:sp,ListBox:ap,ComboBox:op,EditBox:R0,Button:Za,PushButton:L0,RadioButton:lp,CheckBox:D0,TextField:Hd,PasswordField:N0,Appearance:vn};In.AcroForm;function OD(i){return i.reduce(function(e,t,n){return e[t]=n,e},{})}(function(i){var e="addImage_";i.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=i.__addimage__.getImageFileTypeByImageData=function(X,ae){var le,ze,nt,je,Je,qe=t;if((ae=ae||t)==="RGBA"||X.data!==void 0&&X.data instanceof Uint8ClampedArray&&"height"in X&&"width"in X)return"RGBA";if(Ve(X))for(Je in n)for(nt=n[Je],le=0;le<nt.length;le+=1){for(je=!0,ze=0;ze<nt[le].length;ze+=1)if(nt[le][ze]!==void 0&&nt[le][ze]!==X[ze]){je=!1;break}if(je===!0){qe=Je;break}}else for(Je in n)for(nt=n[Je],le=0;le<nt.length;le+=1){for(je=!0,ze=0;ze<nt[le].length;ze+=1)if(nt[le][ze]!==void 0&&nt[le][ze]!==X.charCodeAt(ze)){je=!1;break}if(je===!0){qe=Je;break}}return qe===t&&ae!==t&&(qe=ae),qe},s=function X(ae){for(var le=this.internal.write,ze=this.internal.putStream,nt=(0,this.internal.getFilters)();nt.indexOf("FlateEncode")!==-1;)nt.splice(nt.indexOf("FlateEncode"),1);ae.objectId=this.internal.newObject();var je=[];if(je.push({key:"Type",value:"/XObject"}),je.push({key:"Subtype",value:"/Image"}),je.push({key:"Width",value:ae.width}),je.push({key:"Height",value:ae.height}),ae.colorSpace===q.INDEXED?je.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ae.palette.length/3-1)+" "+("sMask"in ae&&ae.sMask!==void 0?ae.objectId+2:ae.objectId+1)+" 0 R]"}):(je.push({key:"ColorSpace",value:"/"+ae.colorSpace}),ae.colorSpace===q.DEVICE_CMYK&&je.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),je.push({key:"BitsPerComponent",value:ae.bitsPerComponent}),"decodeParameters"in ae&&ae.decodeParameters!==void 0&&je.push({key:"DecodeParms",value:"<<"+ae.decodeParameters+">>"}),"transparency"in ae&&Array.isArray(ae.transparency)&&ae.transparency.length>0){for(var Je="",qe=0,ot=ae.transparency.length;qe<ot;qe++)Je+=ae.transparency[qe]+" "+ae.transparency[qe]+" ";je.push({key:"Mask",value:"["+Je+"]"})}ae.sMask!==void 0&&je.push({key:"SMask",value:ae.objectId+1+" 0 R"});var St=ae.filter!==void 0?["/"+ae.filter]:void 0;if(ze({data:ae.data,additionalKeyValues:je,alreadyAppliedFilters:St,objectId:ae.objectId}),le("endobj"),"sMask"in ae&&ae.sMask!==void 0){var Ne,se=(Ne=ae.sMaskBitsPerComponent)!==null&&Ne!==void 0?Ne:ae.bitsPerComponent,Ee={width:ae.width,height:ae.height,colorSpace:"DeviceGray",bitsPerComponent:se,data:ae.sMask};"filter"in ae&&(Ee.decodeParameters="/Predictor ".concat(ae.predictor," /Colors 1 /BitsPerComponent ").concat(se," /Columns ").concat(ae.width),Ee.filter=ae.filter),X.call(this,Ee)}if(ae.colorSpace===q.INDEXED){var De=this.internal.newObject();ze({data:ee(new Uint8Array(ae.palette)),objectId:De}),le("endobj")}},l=function(){var X=this.internal.collections[e+"images"];for(var ae in X)s.call(this,X[ae])},u=function(){var X,ae=this.internal.collections[e+"images"],le=this.internal.write;for(var ze in ae)le("/I"+(X=ae[ze]).index,X.objectId,"0","R")},h=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",u))},f=function(){var X=this.internal.collections[e+"images"];return h.call(this),X},x=function(){return Object.keys(this.internal.collections[e+"images"]).length},g=function(X){return typeof i["process"+X.toUpperCase()]=="function"},w=function(X){return Or(X)==="object"&&X.nodeType===1},A=function(X,ae){if(X.nodeName==="IMG"&&X.hasAttribute("src")){var le=""+X.getAttribute("src");if(le.indexOf("data:image/")===0)return C0(unescape(le).split("base64,").pop());var ze=i.loadFile(le,!0);if(ze!==void 0)return ze}if(X.nodeName==="CANVAS"){if(X.width===0||X.height===0)throw new Error("Given canvas must have data. Canvas width: "+X.width+", height: "+X.height);var nt;switch(ae){case"PNG":nt="image/png";break;case"WEBP":nt="image/webp";break;default:nt="image/jpeg"}return C0(X.toDataURL(nt,1).split("base64,").pop())}},B=function(X){var ae=this.internal.collections[e+"images"];if(ae){for(var le in ae)if(X===ae[le].alias)return ae[le]}},$=function(X,ae,le){return X||ae||(X=-96,ae=-96),X<0&&(X=-1*le.width*72/X/this.internal.scaleFactor),ae<0&&(ae=-1*le.height*72/ae/this.internal.scaleFactor),X===0&&(X=ae*le.width/le.height),ae===0&&(ae=X*le.height/le.width),[X,ae]},W=function(X,ae,le,ze,nt,je){var Je=$.call(this,le,ze,nt),qe=this.internal.getCoordinateString,ot=this.internal.getVerticalCoordinateString,St=f.call(this);if(le=Je[0],ze=Je[1],St[nt.index]=nt,je){je*=Math.PI/180;var Ne=Math.cos(je),se=Math.sin(je),Ee=function(Be){return Be.toFixed(4)},De=[Ee(Ne),Ee(se),Ee(-1*se),Ee(Ne),0,0,"cm"]}this.internal.write("q"),je?(this.internal.write([1,"0","0",1,qe(X),ot(ae+ze),"cm"].join(" ")),this.internal.write(De.join(" ")),this.internal.write([qe(le),"0","0",qe(ze),"0","0","cm"].join(" "))):this.internal.write([qe(le),"0","0",qe(ze),qe(X),ot(ae+ze),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+nt.index+" Do"),this.internal.write("Q")},q=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var ge=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},he=i.__addimage__.sHashCode=function(X){var ae,le,ze=0;if(typeof X=="string")for(le=X.length,ae=0;ae<le;ae++)ze=(ze<<5)-ze+X.charCodeAt(ae),ze|=0;else if(Ve(X))for(le=X.byteLength/2,ae=0;ae<le;ae++)ze=(ze<<5)-ze+X[ae],ze|=0;return ze},me=i.__addimage__.validateStringAsBase64=function(X){(X=X||"").toString().trim();var ae=!0;return X.length===0&&(ae=!1),X.length%4!=0&&(ae=!1),/^[A-Za-z0-9+/]+$/.test(X.substr(0,X.length-2))===!1&&(ae=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(X.substr(-2))===!1&&(ae=!1),ae},Ce=i.__addimage__.extractImageFromDataUrl=function(X){if(X==null||!(X=X.trim()).startsWith("data:"))return null;var ae=X.indexOf(",");return ae<0?null:X.substring(0,ae).trim().endsWith("base64")?X.substring(ae+1):null};i.__addimage__.isArrayBuffer=function(X){return X instanceof ArrayBuffer};var Ve=i.__addimage__.isArrayBufferView=function(X){return X instanceof Int8Array||X instanceof Uint8Array||X instanceof Uint8ClampedArray||X instanceof Int16Array||X instanceof Uint16Array||X instanceof Int32Array||X instanceof Uint32Array||X instanceof Float32Array||X instanceof Float64Array},pe=i.__addimage__.binaryStringToUint8Array=function(X){for(var ae=X.length,le=new Uint8Array(ae),ze=0;ze<ae;ze++)le[ze]=X.charCodeAt(ze);return le},ee=i.__addimage__.arrayBufferToBinaryString=function(X){for(var ae="",le=Ve(X)?X:new Uint8Array(X),ze=0;ze<le.length;ze+=8192)ae+=String.fromCharCode.apply(null,le.subarray(ze,ze+8192));return ae};i.addImage=function(){var X,ae,le,ze,nt,je,Je,qe,ot;if(typeof arguments[1]=="number"?(ae=t,le=arguments[1],ze=arguments[2],nt=arguments[3],je=arguments[4],Je=arguments[5],qe=arguments[6],ot=arguments[7]):(ae=arguments[1],le=arguments[2],ze=arguments[3],nt=arguments[4],je=arguments[5],Je=arguments[6],qe=arguments[7],ot=arguments[8]),Or(X=arguments[0])==="object"&&!w(X)&&"imageData"in X){var St=X;X=St.imageData,ae=St.format||ae||t,le=St.x||le||0,ze=St.y||ze||0,nt=St.w||St.width||nt,je=St.h||St.height||je,Je=St.alias||Je,qe=St.compression||qe,ot=St.rotation||St.angle||ot}var Ne=this.internal.getFilters();if(qe===void 0&&Ne.indexOf("FlateEncode")!==-1&&(qe="SLOW"),isNaN(le)||isNaN(ze))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var se=J.call(this,X,ae,Je,qe);return W.call(this,le,ze,nt,je,se,ot),this};var J=function(X,ae,le,ze){var nt,je,Je;if(typeof X=="string"&&r(X)===t){X=unescape(X);var qe=ye(X,!1);(qe!==""||(qe=i.loadFile(X,!0))!==void 0)&&(X=qe)}if(w(X)&&(X=A(X,ae)),ae=r(X,ae),!g(ae))throw new Error("addImage does not support files of type '"+ae+"', please ensure that a plugin for '"+ae+"' support is added.");if(((Je=le)==null||Je.length===0)&&(le=(function(ot){return typeof ot=="string"||Ve(ot)?he(ot):Ve(ot.data)?he(ot.data):null})(X)),(nt=B.call(this,le))||(X instanceof Uint8Array||ae==="RGBA"||(je=X,X=pe(X)),nt=this["process"+ae.toUpperCase()](X,x.call(this),le,(function(ot){return ot&&typeof ot=="string"&&(ot=ot.toUpperCase()),ot in i.image_compression?ot:ge.NONE})(ze),je)),!nt)throw new Error("An unknown error occurred whilst processing the image.");return nt},ye=i.__addimage__.convertBase64ToBinaryString=function(X,ae){ae=typeof ae!="boolean"||ae;var le,ze="";if(typeof X=="string"){var nt;le=(nt=Ce(X))!==null&&nt!==void 0?nt:X;try{ze=C0(le)}catch(je){if(ae)throw me(le)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+je.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ze};i.getImageProperties=function(X){var ae,le,ze="";if(w(X)&&(X=A(X)),typeof X=="string"&&r(X)===t&&((ze=ye(X,!1))===""&&(ze=i.loadFile(X)||""),X=ze),le=r(X),!g(le))throw new Error("addImage does not support files of type '"+le+"', please ensure that a plugin for '"+le+"' support is added.");if(X instanceof Uint8Array||(X=pe(X)),!(ae=this["process"+le.toUpperCase()](X)))throw new Error("An unknown error occurred whilst processing the image");return ae.fileType=le,ae}})(In.API),(function(i){var e=function(t){if(t!==void 0&&t!="")return!0};In.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(t){for(var n,r,s,l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,h=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,x=!1,g=0;g<f.length&&!x;g++)switch((n=f[g]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(x=!0);break;case"reference":case"text":case"freetext":x=!0}if(x!=0){this.internal.write("/Annots [");for(var w=0;w<f.length;w++){n=f[w];var A=this.internal.pdfEscape,B=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var $=this.internal.newAdditionalObject(),W=this.internal.newAdditionalObject(),q=this.internal.getEncryptor($.objId),ge=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+l(n.bounds.x)+" "+u(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w)+" "+u(n.bounds.y)+"] ")+"/Contents ("+A(q(n.contents))+")",s+=" /Popup "+W.objId+" 0 R",s+=" /P "+h.objId+" 0 R",s+=" /T ("+A(q(ge))+") >>",$.content=s;var he=$.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+l(n.bounds.x+30)+" "+u(n.bounds.y+n.bounds.h)+" "+l(n.bounds.x+n.bounds.w+30)+" "+u(n.bounds.y)+"] ")+" /Parent "+he,n.open&&(s+=" /Open true"),s+=" >>",W.content=s,this.internal.write($.objId,"0 R",W.objId,"0 R");break;case"freetext":r="/Rect ["+l(n.bounds.x)+" "+u(n.bounds.y)+" "+l(n.bounds.x+n.bounds.w)+" "+u(n.bounds.y+n.bounds.h)+"] ";var me=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+A(B(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+me+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var Ce=this.annotations._nameMap[n.options.name];n.options.pageNumber=Ce.page,n.options.top=Ce.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+A(B(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var Ve=u(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+Ve+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),i.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},i.link=function(t,n,r,s,l){var u=this.internal.getCurrentPageInfo(),h=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:h(t),y:f(n),w:h(t+r),h:f(n+s)},options:l,type:"link"})},i.textWithLink=function(t,n,r,s){var l,u,h=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){u=s.maxWidth;var x=this.splitTextToSize(t,u).length;l=Math.ceil(f*x)}else u=h,l=f;return this.text(t,n,r,s),r+=.2*f,s.align==="center"&&(n-=h/2),s.align==="right"&&(n-=h),this.link(n,r-f,u,l,s),h},i.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}})(In.API),(function(i){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];i.__arabicParser__={};var s=i.__arabicParser__.isInArabicSubstitutionA=function($){return e[$.charCodeAt(0)]!==void 0},l=i.__arabicParser__.isArabicLetter=function($){return typeof $=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test($)},u=i.__arabicParser__.isArabicEndLetter=function($){return l($)&&s($)&&e[$.charCodeAt(0)].length<=2},h=i.__arabicParser__.isArabicAlfLetter=function($){return l($)&&r.indexOf($.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function($){return l($)&&s($)&&e[$.charCodeAt(0)].length>=1};var f=i.__arabicParser__.arabicLetterHasFinalForm=function($){return l($)&&s($)&&e[$.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function($){return l($)&&s($)&&e[$.charCodeAt(0)].length>=3};var x=i.__arabicParser__.arabicLetterHasMedialForm=function($){return l($)&&s($)&&e[$.charCodeAt(0)].length==4},g=i.__arabicParser__.resolveLigatures=function($){var W=0,q=t,ge="",he=0;for(W=0;W<$.length;W+=1)q[$.charCodeAt(W)]!==void 0?(he++,typeof(q=q[$.charCodeAt(W)])=="number"&&(ge+=String.fromCharCode(q),q=t,he=0),W===$.length-1&&(q=t,ge+=$.charAt(W-(he-1)),W-=he-1,he=0)):(q=t,ge+=$.charAt(W-he),W-=he,he=0);return ge};i.__arabicParser__.isArabicDiacritic=function($){return $!==void 0&&n[$.charCodeAt(0)]!==void 0};var w=i.__arabicParser__.getCorrectForm=function($,W,q){return l($)?s($)===!1?-1:!f($)||!l(W)&&!l(q)||!l(q)&&u(W)||u($)&&!l(W)||u($)&&h(W)||u($)&&u(W)?0:x($)&&l(W)&&!u(W)&&l(q)&&f(q)?3:u($)||!l(q)?1:2:-1},A=function($){var W=0,q=0,ge=0,he="",me="",Ce="",Ve=($=$||"").split("\\s+"),pe=[];for(W=0;W<Ve.length;W+=1){for(pe.push(""),q=0;q<Ve[W].length;q+=1)he=Ve[W][q],me=Ve[W][q-1],Ce=Ve[W][q+1],l(he)?(ge=w(he,me,Ce),pe[W]+=ge!==-1?String.fromCharCode(e[he.charCodeAt(0)][ge]):he):pe[W]+=he;pe[W]=g(pe[W])}return pe.join(" ")},B=i.__arabicParser__.processArabic=i.processArabic=function(){var $,W=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,q=[];if(Array.isArray(W)){var ge=0;for(q=[],ge=0;ge<W.length;ge+=1)Array.isArray(W[ge])?q.push([A(W[ge][0]),W[ge][1],W[ge][2]]):q.push([A(W[ge])]);$=q}else $=A(W);return typeof arguments[0]=="string"?$:(arguments[0].text=$,arguments[0])};i.events.push(["preProcessText",B])})(In.API),In.API.autoPrint=function(i){var e;return(i=i||{}).variant=i.variant||"non-conform",i.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(i){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(u){t=u}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(u){n=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(u){r=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(u){s=u}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(u){l=u}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var r;if((t=t||"2d")!=="2d")return null;for(r in n)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=n[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(In.API),(function(i){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var h=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return h},set:function($){h=$}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function($){f=$}});var x=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return x},set:function($){x=$}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function($){g=$}});var w=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return w},set:function($){w=$}});var A=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return A},set:function($){A=$}});var B=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return B},set:function($){B=$}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(h){return n.call(this),this.internal.__cell__.headerFunction=typeof h=="function"?h:void 0,this},i.getTextDimensions=function(h,f){n.call(this);var x=(f=f||{}).fontSize||this.getFontSize(),g=f.font||this.getFont(),w=f.scaleFactor||this.internal.scaleFactor,A=0,B=0,$=0,W=this;if(!Array.isArray(h)&&typeof h!="string"){if(typeof h!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");h=String(h)}var q=f.maxWidth;q>0?typeof h=="string"?h=this.splitTextToSize(h,q):Object.prototype.toString.call(h)==="[object Array]"&&(h=h.reduce(function(he,me){return he.concat(W.splitTextToSize(me,q))},[])):h=Array.isArray(h)?h:[h];for(var ge=0;ge<h.length;ge++)A<($=this.getStringUnitWidth(h[ge],{font:g})*x)&&(A=$);return A!==0&&(B=h.length),{w:A/=w,h:Math.max((B*x*this.getLineHeightFactor()-x*(this.getLineHeightFactor()-1))/w,0)}},i.cellAddPage=function(){n.call(this),this.addPage();var h=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(h.left,h.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=i.cell=function(){var h;h=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var f=this.internal.__cell__.lastCell,x=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,w=this.internal.__cell__.tableHeaderRow,A=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===h.lineNumber?(h.x=(f.x||0)+(f.width||0),h.y=f.y||0):f.y+f.height+h.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),h.y=g.top,A&&w&&(this.printHeaderRow(h.lineNumber,!0),h.y+=w[0].height)):h.y=f.y+f.height||h.y),h.text[0]!==void 0&&(this.rect(h.x,h.y,h.width,h.height,t===!0?"FD":void 0),h.align==="right"?this.text(h.text,h.x+h.width-x,h.y+x,{align:"right",baseline:"top"}):h.align==="center"?this.text(h.text,h.x+h.width/2,h.y+x,{align:"center",baseline:"top",maxWidth:h.width-x-x}):this.text(h.text,h.x+x,h.y+x,{align:"left",baseline:"top",maxWidth:h.width-x-x})),this.internal.__cell__.lastCell=h,this};i.table=function(h,f,x,g,w){if(n.call(this),!x)throw new Error("No data for PDF table.");var A,B,$,W,q=[],ge=[],he=[],me={},Ce={},Ve=[],pe=[],ee=(w=w||{}).autoSize||!1,J=w.printHeaders!==!1,ye=w.css&&w.css["font-size"]!==void 0?16*w.css["font-size"]:w.fontSize||12,X=w.margins||Object.assign({width:this.getPageWidth()},e),ae=typeof w.padding=="number"?w.padding:3,le=w.headerBackgroundColor||"#c8c8c8",ze=w.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=J,this.internal.__cell__.margins=X,this.internal.__cell__.table_font_size=ye,this.internal.__cell__.padding=ae,this.internal.__cell__.headerBackgroundColor=le,this.internal.__cell__.headerTextColor=ze,this.setFontSize(ye),g==null)ge=q=Object.keys(x[0]),he=q.map(function(){return"left"});else if(Array.isArray(g)&&Or(g[0])==="object")for(q=g.map(function(St){return St.name}),ge=g.map(function(St){return St.prompt||St.name||""}),he=g.map(function(St){return St.align||"left"}),A=0;A<g.length;A+=1)Ce[g[A].name]=.7499990551181103*g[A].width;else Array.isArray(g)&&typeof g[0]=="string"&&(ge=q=g,he=q.map(function(){return"left"}));if(ee||Array.isArray(g)&&typeof g[0]=="string")for(A=0;A<q.length;A+=1){for(me[W=q[A]]=x.map(function(St){return St[W]}),this.setFont(void 0,"bold"),Ve.push(this.getTextDimensions(ge[A],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),B=me[W],this.setFont(void 0,"normal"),$=0;$<B.length;$+=1)Ve.push(this.getTextDimensions(B[$],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Ce[W]=Math.max.apply(null,Ve)+ae+ae,Ve=[]}if(J){var nt={};for(A=0;A<q.length;A+=1)nt[q[A]]={},nt[q[A]].text=ge[A],nt[q[A]].align=he[A];var je=u.call(this,nt,Ce);pe=q.map(function(St){return new s(h,f,Ce[St],je,nt[St].text,void 0,nt[St].align)}),this.setTableHeaderRow(pe),this.printHeaderRow(1,!1)}var Je=g.reduce(function(St,Ne){return St[Ne.name]=Ne.align,St},{});for(A=0;A<x.length;A+=1){"rowStart"in w&&w.rowStart instanceof Function&&w.rowStart({row:A,data:x[A]},this);var qe=u.call(this,x[A],Ce);for($=0;$<q.length;$+=1){var ot=x[A][q[$]];"cellStart"in w&&w.cellStart instanceof Function&&w.cellStart({row:A,col:$,data:ot},this),l.call(this,new s(h,f,Ce[q[$]],qe,ot,A+2,Je[q[$]]))}}return this.internal.__cell__.table_x=h,this.internal.__cell__.table_y=f,this};var u=function(h,f){var x=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,w=this.internal.scaleFactor;return Object.keys(h).map(function(A){var B=h[A];return this.splitTextToSize(B.hasOwnProperty("text")?B.text:B,f[A]-x-x)},this).map(function(A){return this.getLineHeightFactor()*A.length*g/w+x+x},this).reduce(function(A,B){return Math.max(A,B)},0)};i.setTableHeaderRow=function(h){n.call(this),this.internal.__cell__.tableHeaderRow=h},i.printHeaderRow=function(h,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var x;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var w=[],A=0;A<this.internal.__cell__.tableHeaderRow.length;A+=1){x=this.internal.__cell__.tableHeaderRow[A].clone(),f&&(x.y=this.internal.__cell__.margins.top||0,w.push(x)),x.lineNumber=h;var B=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,x),this.setTextColor(B)}w.length>0&&this.setTableHeaderRow(w),this.setFont(void 0,"normal"),t=!1}})(In.API);var MD={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},FD=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Kx=OD(FD),jD=[100,200,300,400,500,600,700,800,900],vW=OD(jD);function Rb(i){var e=i.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return MD[s=s||"normal"]?s:"normal"})(i.style),n=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(i.weight),r=(function(s){return typeof Kx[s=s||"normal"]=="number"?s:"normal"})(i.stretch);return{family:e,style:t,weight:n,stretch:r,src:i.src||[],ref:i.ref||{name:e,style:[r,t,n].join(" ")}}}function Sk(i,e,t,n){var r;for(r=t;r>=0&&r<e.length;r+=n)if(i[e[r]])return i[e[r]];for(r=t;r>=0&&r<e.length;r-=n)if(i[e[r]])return i[e[r]]}var _W={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Tk={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Ak(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function Ek(i){return i.trimLeft()}function bW(i,e){for(var t=0;t<i.length;){if(i.charAt(t)===e)return[i.substring(0,t),i.substring(t+1)];t+=1}return null}function xW(i){var e=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],i.substring(e[0].length)]}var s0,Ik,kk,Vf,a0,Ck,Rk,Lk,Lb=["times"];function Dk(i,e,t,n,r){var s=4,l=Pk;switch(r){case In.API.image_compression.FAST:s=1,l=Nk;break;case In.API.image_compression.MEDIUM:s=6,l=Ok;break;case In.API.image_compression.SLOW:s=9,l=Mk}i=(function(h,f,x,g){for(var w,A=h.length/f,B=new Uint8Array(h.length+A),$=[wW,Nk,Pk,Ok,Mk],W=0;W<A;W+=1){var q=W*f,ge=h.subarray(q,q+f);if(g)B.set(g(ge,x,w),q+W);else{for(var he=$.length,me=[],Ce=0;Ce<he;Ce+=1)me[Ce]=$[Ce](ge,x,w);var Ve=TW(me.concat());B.set(me[Ve],q+W)}w=ge}return B})(i,e,Math.ceil(t*n/8),l);var u=Vx(i,{level:s});return In.API.__addimage__.arrayBufferToBinaryString(u)}function wW(i){var e=Array.apply([],i);return e.unshift(0),e}function Nk(i,e){var t=i.length,n=[];n[0]=1;for(var r=0;r<t;r+=1){var s=i[r-e]||0;n[r+1]=i[r]-s+256&255}return n}function Pk(i,e,t){var n=i.length,r=[];r[0]=2;for(var s=0;s<n;s+=1){var l=t&&t[s]||0;r[s+1]=i[s]-l+256&255}return r}function Ok(i,e,t){var n=i.length,r=[];r[0]=3;for(var s=0;s<n;s+=1){var l=i[s-e]||0,u=t&&t[s]||0;r[s+1]=i[s]+256-(l+u>>>1)&255}return r}function Mk(i,e,t){var n=i.length,r=[];r[0]=4;for(var s=0;s<n;s+=1){var l=SW(i[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);r[s+1]=i[s]-l+256&255}return r}function SW(i,e,t){if(i===e&&e===t)return i;var n=Math.abs(e-t),r=Math.abs(i-t),s=Math.abs(i+e-t-t);return n<=r&&n<=s?i:r<=s?e:t}function TW(i){var e=i.map(function(t){return t.reduce(function(n,r){return n+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function Db(i,e,t){var n=e*t,r=Math.floor(n/8),s=16-(n-8*r+t),l=(1<<t)-1;return VD(i,r)>>s&l}function Fk(i,e,t,n){var r=t*n,s=Math.floor(r/8),l=16-(r-8*s+n),u=(1<<n)-1,h=(e&u)<<l;(function(f,x,g){if(x+1<f.byteLength)f.setUint16(x,g,!1);else{var w=g>>8&255;f.setUint8(x,w)}})(i,s,VD(i,s)&~(u<<l)&65535|h)}function VD(i,e){return e+1<i.byteLength?i.getUint16(e,!1):i.getUint8(e)<<8}function AW(i){var e=0;if(i[e++]!==71||i[e++]!==73||i[e++]!==70||i[e++]!==56||(i[e++]+1&253)!=56||i[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=i[e++]|i[e++]<<8,n=i[e++]|i[e++]<<8,r=i[e++],s=r>>7,l=1<<1+(7&r);i[e++],i[e++];var u=null,h=null;s&&(u=e,h=l,e+=3*l);var f=!0,x=[],g=0,w=null,A=0,B=null;for(this.width=t,this.height=n;f&&e<i.length;)switch(i[e++]){case 33:switch(i[e++]){case 255:if(i[e]!==11||i[e+1]==78&&i[e+2]==69&&i[e+3]==84&&i[e+4]==83&&i[e+5]==67&&i[e+6]==65&&i[e+7]==80&&i[e+8]==69&&i[e+9]==50&&i[e+10]==46&&i[e+11]==48&&i[e+12]==3&&i[e+13]==1&&i[e+16]==0)e+=14,B=i[e++]|i[e++]<<8,e++;else for(e+=12;;){if(!((X=i[e++])>=0))throw Error("Invalid block size");if(X===0)break;e+=X}break;case 249:if(i[e++]!==4||i[e+4]!==0)throw new Error("Invalid graphics extension block.");var $=i[e++];g=i[e++]|i[e++]<<8,w=i[e++],1&$||(w=null),A=$>>2&7,e++;break;case 254:for(;;){if(!((X=i[e++])>=0))throw Error("Invalid block size");if(X===0)break;e+=X}break;default:throw new Error("Unknown graphic control label: 0x"+i[e-1].toString(16))}break;case 44:var W=i[e++]|i[e++]<<8,q=i[e++]|i[e++]<<8,ge=i[e++]|i[e++]<<8,he=i[e++]|i[e++]<<8,me=i[e++],Ce=me>>6&1,Ve=1<<1+(7&me),pe=u,ee=h,J=!1;me>>7&&(J=!0,pe=e,ee=Ve,e+=3*Ve);var ye=e;for(e++;;){var X;if(!((X=i[e++])>=0))throw Error("Invalid block size");if(X===0)break;e+=X}x.push({x:W,y:q,width:ge,height:he,has_local_palette:J,palette_offset:pe,palette_size:ee,data_offset:ye,data_length:e-ye,transparent_index:w,interlaced:!!Ce,delay:g,disposal:A});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+i[e-1].toString(16))}this.numFrames=function(){return x.length},this.loopCount=function(){return B},this.frameInfo=function(ae){if(ae<0||ae>=x.length)throw new Error("Frame index out of range.");return x[ae]},this.decodeAndBlitFrameBGRA=function(ae,le){var ze=this.frameInfo(ae),nt=ze.width*ze.height,je=new Uint8Array(nt);jk(i,ze.data_offset,je,nt);var Je=ze.palette_offset,qe=ze.transparent_index;qe===null&&(qe=256);var ot=ze.width,St=t-ot,Ne=ot,se=4*(ze.y*t+ze.x),Ee=4*((ze.y+ze.height)*t+ze.x),De=se,Be=4*St;ze.interlaced===!0&&(Be+=4*t*7);for(var $e=8,Ye=0,ct=je.length;Ye<ct;++Ye){var ut=je[Ye];if(Ne===0&&(Ne=ot,(De+=Be)>=Ee&&(Be=4*St+4*t*($e-1),De=se+(ot+St)*($e<<1),$e>>=1)),ut===qe)De+=4;else{var Tt=i[Je+3*ut],Ft=i[Je+3*ut+1],Wt=i[Je+3*ut+2];le[De++]=Wt,le[De++]=Ft,le[De++]=Tt,le[De++]=255}--Ne}},this.decodeAndBlitFrameRGBA=function(ae,le){var ze=this.frameInfo(ae),nt=ze.width*ze.height,je=new Uint8Array(nt);jk(i,ze.data_offset,je,nt);var Je=ze.palette_offset,qe=ze.transparent_index;qe===null&&(qe=256);var ot=ze.width,St=t-ot,Ne=ot,se=4*(ze.y*t+ze.x),Ee=4*((ze.y+ze.height)*t+ze.x),De=se,Be=4*St;ze.interlaced===!0&&(Be+=4*t*7);for(var $e=8,Ye=0,ct=je.length;Ye<ct;++Ye){var ut=je[Ye];if(Ne===0&&(Ne=ot,(De+=Be)>=Ee&&(Be=4*St+4*t*($e-1),De=se+(ot+St)*($e<<1),$e>>=1)),ut===qe)De+=4;else{var Tt=i[Je+3*ut],Ft=i[Je+3*ut+1],Wt=i[Je+3*ut+2];le[De++]=Tt,le[De++]=Ft,le[De++]=Wt,le[De++]=255}--Ne}}}function jk(i,e,t,n){for(var r=i[e++],s=1<<r,l=s+1,u=l+1,h=r+1,f=(1<<h)-1,x=0,g=0,w=0,A=i[e++],B=new Int32Array(4096),$=null;;){for(;x<16&&A!==0;)g|=i[e++]<<x,x+=8,A===1?A=i[e++]:--A;if(x<h)break;var W=g&f;if(g>>=h,x-=h,W!==s){if(W===l)break;for(var q=W<u?W:$,ge=0,he=q;he>s;)he=B[he]>>8,++ge;var me=he;if(w+ge+(q!==W?1:0)>n)return void Qr.log("Warning, gif stream longer than expected.");t[w++]=me;var Ce=w+=ge;for(q!==W&&(t[w++]=me),he=q;ge--;)he=B[he],t[--Ce]=255&he,he>>=8;$!==null&&u<4096&&(B[u++]=$<<8|me,u>=f+1&&h<12&&(++h,f=f<<1|1)),$=W}else u=l+1,f=(1<<(h=r+1))-1,$=null}return w!==n&&Qr.log("Warning, gif stream shorter than expected."),t}function Nb(i){var e,t,n,r,s,l=Math.floor,u=new Array(64),h=new Array(64),f=new Array(64),x=new Array(64),g=new Array(65535),w=new Array(65535),A=new Array(64),B=new Array(64),$=[],W=0,q=7,ge=new Array(64),he=new Array(64),me=new Array(64),Ce=new Array(256),Ve=new Array(2048),pe=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ee=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],ye=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],X=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ae=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],le=[0,1,2,3,4,5,6,7,8,9,10,11],ze=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],nt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function je(se,Ee){for(var De=0,Be=0,$e=new Array,Ye=1;Ye<=16;Ye++){for(var ct=1;ct<=se[Ye];ct++)$e[Ee[Be]]=[],$e[Ee[Be]][0]=De,$e[Ee[Be]][1]=Ye,Be++,De++;De*=2}return $e}function Je(se){for(var Ee=se[0],De=se[1]-1;De>=0;)Ee&1<<De&&(W|=1<<q),De--,--q<0&&(W==255?(qe(255),qe(0)):qe(W),q=7,W=0)}function qe(se){$.push(se)}function ot(se){qe(se>>8&255),qe(255&se)}function St(se,Ee,De,Be,$e){for(var Ye,ct=$e[0],ut=$e[240],Tt=(function(_t,en){var Xt,Tn,bn,Un,ii,Bn,li,Xn,ln,$n,cn=0;for(ln=0;ln<8;++ln){Xt=_t[cn],Tn=_t[cn+1],bn=_t[cn+2],Un=_t[cn+3],ii=_t[cn+4],Bn=_t[cn+5],li=_t[cn+6];var er=Xt+(Xn=_t[cn+7]),Jn=Xt-Xn,mn=Tn+li,On=Tn-li,qn=bn+Bn,on=bn-Bn,Ni=Un+ii,Mn=Un-ii,xn=er+Ni,Qn=er-Ni,Qt=mn+qn,Ht=mn-qn;_t[cn]=xn+Qt,_t[cn+4]=xn-Qt;var Kn=.707106781*(Ht+Qn);_t[cn+2]=Qn+Kn,_t[cn+6]=Qn-Kn;var kr=.382683433*((xn=Mn+on)-(Ht=On+Jn)),vr=.5411961*xn+kr,Cr=1.306562965*Ht+kr,Ci=.707106781*(Qt=on+On),dn=Jn+Ci,Aa=Jn-Ci;_t[cn+5]=Aa+vr,_t[cn+3]=Aa-vr,_t[cn+1]=dn+Cr,_t[cn+7]=dn-Cr,cn+=8}for(cn=0,ln=0;ln<8;++ln){Xt=_t[cn],Tn=_t[cn+8],bn=_t[cn+16],Un=_t[cn+24],ii=_t[cn+32],Bn=_t[cn+40],li=_t[cn+48];var ta=Xt+(Xn=_t[cn+56]),Rr=Xt-Xn,ms=Tn+li,Pi=Tn-li,tr=bn+Bn,cr=bn-Bn,os=Un+ii,Zr=Un-ii,qi=ta+os,Yi=ta-os,Kr=ms+tr,ls=ms-tr;_t[cn]=qi+Kr,_t[cn+32]=qi-Kr;var da=.707106781*(ls+Yi);_t[cn+16]=Yi+da,_t[cn+48]=Yi-da;var Va=.382683433*((qi=Zr+cr)-(ls=Pi+Rr)),ys=.5411961*qi+Va,es=1.306562965*ls+Va,to=.707106781*(Kr=cr+Pi),Ps=Rr+to,Os=Rr-to;_t[cn+40]=Os+ys,_t[cn+24]=Os-ys,_t[cn+8]=Ps+es,_t[cn+56]=Ps-es,cn++}for(ln=0;ln<64;++ln)$n=_t[ln]*en[ln],A[ln]=$n>0?$n+.5|0:$n-.5|0;return A})(se,Ee),Ft=0;Ft<64;++Ft)B[pe[Ft]]=Tt[Ft];var Wt=B[0]-De;De=B[0],Wt==0?Je(Be[0]):(Je(Be[w[Ye=32767+Wt]]),Je(g[Ye]));for(var qt=63;qt>0&&B[qt]==0;)qt--;if(qt==0)return Je(ct),De;for(var Et,Pe=1;Pe<=qt;){for(var $t=Pe;B[Pe]==0&&Pe<=qt;)++Pe;var Dt=Pe-$t;if(Dt>=16){Et=Dt>>4;for(var wn=1;wn<=Et;++wn)Je(ut);Dt&=15}Ye=32767+B[Pe],Je($e[(Dt<<4)+w[Ye]]),Je(g[Ye]),Pe++}return qt!=63&&Je(ct),De}function Ne(se){se=Math.min(Math.max(se,1),100),s!=se&&((function(Ee){for(var De=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Be=0;Be<64;Be++){var $e=l((De[Be]*Ee+50)/100);$e=Math.min(Math.max($e,1),255),u[pe[Be]]=$e}for(var Ye=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ct=0;ct<64;ct++){var ut=l((Ye[ct]*Ee+50)/100);ut=Math.min(Math.max(ut,1),255),h[pe[ct]]=ut}for(var Tt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ft=0,Wt=0;Wt<8;Wt++)for(var qt=0;qt<8;qt++)f[Ft]=1/(u[pe[Ft]]*Tt[Wt]*Tt[qt]*8),x[Ft]=1/(h[pe[Ft]]*Tt[Wt]*Tt[qt]*8),Ft++})(se<50?Math.floor(5e3/se):Math.floor(200-2*se)),s=se)}this.encode=function(se,Ee){Ee&&Ne(Ee),$=new Array,W=0,q=7,ot(65496),ot(65504),ot(16),qe(74),qe(70),qe(73),qe(70),qe(0),qe(1),qe(1),qe(0),ot(1),ot(1),qe(0),qe(0),(function(){ot(65499),ot(132),qe(0);for(var Tn=0;Tn<64;Tn++)qe(u[Tn]);qe(1);for(var bn=0;bn<64;bn++)qe(h[bn])})(),(function(Tn,bn){ot(65472),ot(17),qe(8),ot(bn),ot(Tn),qe(3),qe(1),qe(17),qe(0),qe(2),qe(17),qe(1),qe(3),qe(17),qe(1)})(se.width,se.height),(function(){ot(65476),ot(418),qe(0);for(var Tn=0;Tn<16;Tn++)qe(ee[Tn+1]);for(var bn=0;bn<=11;bn++)qe(J[bn]);qe(16);for(var Un=0;Un<16;Un++)qe(ye[Un+1]);for(var ii=0;ii<=161;ii++)qe(X[ii]);qe(1);for(var Bn=0;Bn<16;Bn++)qe(ae[Bn+1]);for(var li=0;li<=11;li++)qe(le[li]);qe(17);for(var Xn=0;Xn<16;Xn++)qe(ze[Xn+1]);for(var ln=0;ln<=161;ln++)qe(nt[ln])})(),ot(65498),ot(12),qe(3),qe(1),qe(0),qe(2),qe(17),qe(3),qe(17),qe(0),qe(63),qe(0);var De=0,Be=0,$e=0;W=0,q=7,this.encode.displayName="_encode_";for(var Ye,ct,ut,Tt,Ft,Wt,qt,Et,Pe,$t=se.data,Dt=se.width,wn=se.height,_t=4*Dt,en=0;en<wn;){for(Ye=0;Ye<_t;){for(Ft=_t*en+Ye,qt=-1,Et=0,Pe=0;Pe<64;Pe++)Wt=Ft+(Et=Pe>>3)*_t+(qt=4*(7&Pe)),en+Et>=wn&&(Wt-=_t*(en+1+Et-wn)),Ye+qt>=_t&&(Wt-=Ye+qt-_t+4),ct=$t[Wt++],ut=$t[Wt++],Tt=$t[Wt++],ge[Pe]=(Ve[ct]+Ve[ut+256|0]+Ve[Tt+512|0]>>16)-128,he[Pe]=(Ve[ct+768|0]+Ve[ut+1024|0]+Ve[Tt+1280|0]>>16)-128,me[Pe]=(Ve[ct+1280|0]+Ve[ut+1536|0]+Ve[Tt+1792|0]>>16)-128;De=St(ge,f,De,e,n),Be=St(he,x,Be,t,r),$e=St(me,x,$e,t,r),Ye+=32}en+=8}if(q>=0){var Xt=[];Xt[1]=q+1,Xt[0]=(1<<q+1)-1,Je(Xt)}return ot(65497),new Uint8Array($)},i=i||50,(function(){for(var se=String.fromCharCode,Ee=0;Ee<256;Ee++)Ce[Ee]=se(Ee)})(),e=je(ee,J),t=je(ae,le),n=je(ye,X),r=je(ze,nt),(function(){for(var se=1,Ee=2,De=1;De<=15;De++){for(var Be=se;Be<Ee;Be++)w[32767+Be]=De,g[32767+Be]=[],g[32767+Be][1]=De,g[32767+Be][0]=Be;for(var $e=-(Ee-1);$e<=-se;$e++)w[32767+$e]=De,g[32767+$e]=[],g[32767+$e][1]=De,g[32767+$e][0]=Ee-1+$e;se<<=1,Ee<<=1}})(),(function(){for(var se=0;se<256;se++)Ve[se]=19595*se,Ve[se+256|0]=38470*se,Ve[se+512|0]=7471*se+32768,Ve[se+768|0]=-11059*se,Ve[se+1024|0]=-21709*se,Ve[se+1280|0]=32768*se+8421375,Ve[se+1536|0]=-27439*se,Ve[se+1792|0]=-5329*se})(),Ne(i)}function Au(i,e){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Vk(i){function e(J){if(!J)throw Error("assert :P")}function t(J,ye,X){for(var ae=0;4>ae;ae++)if(J[ye+ae]!=X.charCodeAt(ae))return!0;return!1}function n(J,ye,X,ae,le){for(var ze=0;ze<le;ze++)J[ye+ze]=X[ae+ze]}function r(J,ye,X,ae){for(var le=0;le<ae;le++)J[ye+le]=X}function s(J){return new Int32Array(J)}function l(J,ye){for(var X=[],ae=0;ae<J;ae++)X.push(new ye);return X}function u(J,ye){var X=[];return(function ae(le,ze,nt){for(var je=nt[ze],Je=0;Je<je&&(le.push(nt.length>ze+1?[]:new ye),!(nt.length<ze+1));Je++)ae(le[Je],ze+1,nt)})(X,0,J),X}var h=function(){var J=this;function ye(v,I){for(var M=1<<I-1>>>0;v&M;)M>>>=1;return M?(v&M-1)+M:v}function X(v,I,M,G,oe){e(!(G%M));do v[I+(G-=M)]=oe;while(0<G)}function ae(v,I,M,G,oe){if(e(2328>=oe),512>=oe)var de=s(512);else if((de=s(oe))==null)return 0;return(function(ue,ve,xe,Re,Ue,Xe){var Ae,He,et=ve,at=1<<xe,Ze=s(16),gt=s(16);for(e(Ue!=0),e(Re!=null),e(ue!=null),e(0<xe),He=0;He<Ue;++He){if(15<Re[He])return 0;++Ze[Re[He]]}if(Ze[0]==Ue)return 0;for(gt[1]=0,Ae=1;15>Ae;++Ae){if(Ze[Ae]>1<<Ae)return 0;gt[Ae+1]=gt[Ae]+Ze[Ae]}for(He=0;He<Ue;++He)Ae=Re[He],0<Re[He]&&(Xe[gt[Ae]++]=He);if(gt[15]==1)return(Re=new le).g=0,Re.value=Xe[0],X(ue,et,1,at,Re),at;var wt,Lt=-1,ht=at-1,Ut=0,Bt=1,An=1,Zt=1<<xe;for(He=0,Ae=1,Ue=2;Ae<=xe;++Ae,Ue<<=1){if(Bt+=An<<=1,0>(An-=Ze[Ae]))return 0;for(;0<Ze[Ae];--Ze[Ae])(Re=new le).g=Ae,Re.value=Xe[He++],X(ue,et+Ut,Ue,Zt,Re),Ut=ye(Ut,Ae)}for(Ae=xe+1,Ue=2;15>=Ae;++Ae,Ue<<=1){if(Bt+=An<<=1,0>(An-=Ze[Ae]))return 0;for(;0<Ze[Ae];--Ze[Ae]){if(Re=new le,(Ut&ht)!=Lt){for(et+=Zt,wt=1<<(Lt=Ae)-xe;15>Lt&&!(0>=(wt-=Ze[Lt]));)++Lt,wt<<=1;at+=Zt=1<<(wt=Lt-xe),ue[ve+(Lt=Ut&ht)].g=wt+xe,ue[ve+Lt].value=et-ve-Lt}Re.g=Ae-xe,Re.value=Xe[He++],X(ue,et+(Ut>>xe),Ue,Zt,Re),Ut=ye(Ut,Ae)}}return Bt!=2*gt[15]-1?0:at})(v,I,M,G,oe,de)}function le(){this.value=this.g=0}function ze(){this.value=this.g=0}function nt(){this.G=l(5,le),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l($l,ze)}function je(v,I,M,G){e(v!=null),e(I!=null),e(2147483648>G),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=I,v.pa=M,v.Jd=I,v.Yc=M+G,v.Zc=4<=G?M+G-4+1:M,ct(v)}function Je(v,I){for(var M=0;0<I--;)M|=Tt(v,128)<<I;return M}function qe(v,I){var M=Je(v,I);return ut(v)?-M:M}function ot(v,I,M,G){var oe,de=0;for(e(v!=null),e(I!=null),e(4294967288>G),v.Sb=G,v.Ra=0,v.u=0,v.h=0,4<G&&(G=4),oe=0;oe<G;++oe)de+=I[M+oe]<<8*oe;v.Ra=de,v.bb=G,v.oa=I,v.pa=M}function St(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Go-8>>>0,++v.bb,v.u-=8;Be(v)&&(v.h=1,v.u=0)}function Ne(v,I){if(e(0<=I),!v.h&&I<=Ra){var M=De(v)&Ha[I];return v.u+=I,St(v),M}return v.h=1,v.u=0}function se(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ee(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function De(v){return v.Ra>>>(v.u&Go-1)>>>0}function Be(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Go}function $e(v,I){v.u=I,v.h=Be(v)}function Ye(v){v.u>=il&&(e(v.u>=il),St(v))}function ct(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function ut(v){return Je(v,1)}function Tt(v,I){var M=v.Ca;0>v.b&&ct(v);var G=v.b,oe=M*I>>>8,de=(v.I>>>G>oe)+0;for(de?(M-=oe,v.I-=oe+1<<G>>>0):M=oe+1,G=M,oe=0;256<=G;)oe+=8,G>>=8;return G=7^oe+rl[G],v.b-=G,v.Ca=(M<<G)-1,de}function Ft(v,I,M){v[I+0]=M>>24&255,v[I+1]=M>>16&255,v[I+2]=M>>8&255,v[I+3]=255&M}function Wt(v,I){return v[I+0]|v[I+1]<<8}function qt(v,I){return Wt(v,I)|v[I+2]<<16}function Et(v,I){return Wt(v,I)|Wt(v,I+2)<<16}function Pe(v,I){var M=1<<I;return e(v!=null),e(0<I),v.X=s(M),v.X==null?0:(v.Mb=32-I,v.Xa=I,1)}function $t(v,I){e(v!=null),e(I!=null),e(v.Xa==I.Xa),n(I.X,0,v.X,0,1<<I.Xa)}function Dt(){this.X=[],this.Xa=this.Mb=0}function wn(v,I,M,G){e(M!=null),e(G!=null);var oe=M[0],de=G[0];return oe==0&&(oe=(v*de+I/2)/I),de==0&&(de=(I*oe+v/2)/v),0>=oe||0>=de?0:(M[0]=oe,G[0]=de,1)}function _t(v,I){return v+(1<<I)-1>>>I}function en(v,I){return((4278255360&v)+(4278255360&I)>>>0&4278255360)+((16711935&v)+(16711935&I)>>>0&16711935)>>>0}function Xt(v,I){J[I]=function(M,G,oe,de,ue,ve,xe){var Re;for(Re=0;Re<ue;++Re){var Ue=J[v](ve[xe+Re-1],oe,de+Re);ve[xe+Re]=en(M[G+Re],Ue)}}}function Tn(){this.ud=this.hd=this.jd=0}function bn(v,I){return((4278124286&(v^I))>>>1)+(v&I)>>>0}function Un(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function ii(v,I){return Un(v+(v-I+.5>>1))}function Bn(v,I,M){return Math.abs(I-M)-Math.abs(v-M)}function li(v,I,M,G,oe,de,ue){for(G=de[ue-1],M=0;M<oe;++M)de[ue+M]=G=en(v[I+M],G)}function Xn(v,I,M,G,oe){var de;for(de=0;de<M;++de){var ue=v[I+de],ve=ue>>8&255,xe=16711935&(xe=(xe=16711935&ue)+((ve<<16)+ve));G[oe+de]=(4278255360&ue)+xe>>>0}}function ln(v,I){I.jd=255&v,I.hd=v>>8&255,I.ud=v>>16&255}function $n(v,I,M,G,oe,de){var ue;for(ue=0;ue<G;++ue){var ve=I[M+ue],xe=ve>>>8,Re=ve,Ue=255&(Ue=(Ue=ve>>>16)+((v.jd<<24>>24)*(xe<<24>>24)>>>5));Re=255&(Re=(Re+=(v.hd<<24>>24)*(xe<<24>>24)>>>5)+((v.ud<<24>>24)*(Ue<<24>>24)>>>5)),oe[de+ue]=(4278255360&ve)+(Ue<<16)+Re}}function cn(v,I,M,G,oe){J[I]=function(de,ue,ve,xe,Re,Ue,Xe,Ae,He){for(xe=Xe;xe<Ae;++xe)for(Xe=0;Xe<He;++Xe)Re[Ue++]=oe(ve[G(de[ue++])])},J[v]=function(de,ue,ve,xe,Re,Ue,Xe){var Ae=8>>de.b,He=de.Ea,et=de.K[0],at=de.w;if(8>Ae)for(de=(1<<de.b)-1,at=(1<<Ae)-1;ue<ve;++ue){var Ze,gt=0;for(Ze=0;Ze<He;++Ze)Ze&de||(gt=G(xe[Re++])),Ue[Xe++]=oe(et[gt&at]),gt>>=Ae}else J["VP8LMapColor"+M](xe,Re,et,at,Ue,Xe,ue,ve,He)}}function er(v,I,M,G,oe){for(M=I+M;I<M;){var de=v[I++];G[oe++]=de>>16&255,G[oe++]=de>>8&255,G[oe++]=255&de}}function Jn(v,I,M,G,oe){for(M=I+M;I<M;){var de=v[I++];G[oe++]=de>>16&255,G[oe++]=de>>8&255,G[oe++]=255&de,G[oe++]=de>>24&255}}function mn(v,I,M,G,oe){for(M=I+M;I<M;){var de=(ue=v[I++])>>16&240|ue>>12&15,ue=240&ue|ue>>28&15;G[oe++]=de,G[oe++]=ue}}function On(v,I,M,G,oe){for(M=I+M;I<M;){var de=(ue=v[I++])>>16&248|ue>>13&7,ue=ue>>5&224|ue>>3&31;G[oe++]=de,G[oe++]=ue}}function qn(v,I,M,G,oe){for(M=I+M;I<M;){var de=v[I++];G[oe++]=255&de,G[oe++]=de>>8&255,G[oe++]=de>>16&255}}function on(v,I,M,G,oe,de){if(de==0)for(M=I+M;I<M;)Ft(G,((de=v[I++])[0]>>24|de[1]>>8&65280|de[2]<<8&16711680|de[3]<<24)>>>0),oe+=32;else n(G,oe,v,I,M)}function Ni(v,I){J[I][0]=J[v+"0"],J[I][1]=J[v+"1"],J[I][2]=J[v+"2"],J[I][3]=J[v+"3"],J[I][4]=J[v+"4"],J[I][5]=J[v+"5"],J[I][6]=J[v+"6"],J[I][7]=J[v+"7"],J[I][8]=J[v+"8"],J[I][9]=J[v+"9"],J[I][10]=J[v+"10"],J[I][11]=J[v+"11"],J[I][12]=J[v+"12"],J[I][13]=J[v+"13"],J[I][14]=J[v+"0"],J[I][15]=J[v+"0"]}function Mn(v){return v==zu||v==yc||v==_u||v==vc}function xn(){this.eb=[],this.size=this.A=this.fb=0}function Qn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Qt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new xn,this.f.kb=new Qn,this.sd=null}function Ht(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Kn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function kr(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function vr(v,I){var M=v.T,G=I.ba.f.RGBA,oe=G.eb,de=G.fb+v.ka*G.A,ue=N[I.ba.S],ve=v.y,xe=v.O,Re=v.f,Ue=v.N,Xe=v.ea,Ae=v.W,He=I.cc,et=I.dc,at=I.Mc,Ze=I.Nc,gt=v.ka,wt=v.ka+v.T,Lt=v.U,ht=Lt+1>>1;for(gt==0?ue(ve,xe,null,null,Re,Ue,Xe,Ae,Re,Ue,Xe,Ae,oe,de,null,null,Lt):(ue(I.ec,I.fc,ve,xe,He,et,at,Ze,Re,Ue,Xe,Ae,oe,de-G.A,oe,de,Lt),++M);gt+2<wt;gt+=2)He=Re,et=Ue,at=Xe,Ze=Ae,Ue+=v.Rc,Ae+=v.Rc,de+=2*G.A,ue(ve,(xe+=2*v.fa)-v.fa,ve,xe,He,et,at,Ze,Re,Ue,Xe,Ae,oe,de-G.A,oe,de,Lt);return xe+=v.fa,v.j+wt<v.o?(n(I.ec,I.fc,ve,xe,Lt),n(I.cc,I.dc,Re,Ue,ht),n(I.Mc,I.Nc,Xe,Ae,ht),M--):1&wt||ue(ve,xe,null,null,Re,Ue,Xe,Ae,Re,Ue,Xe,Ae,oe,de+G.A,null,null,Lt),M}function Cr(v,I,M){var G=v.F,oe=[v.J];if(G!=null){var de=v.U,ue=I.ba.S,ve=ue==Kl||ue==_u;I=I.ba.f.RGBA;var xe=[0],Re=v.ka;xe[0]=v.T,v.Kb&&(Re==0?--xe[0]:(--Re,oe[0]-=v.width),v.j+v.ka+v.T==v.o&&(xe[0]=v.o-v.j-Re));var Ue=I.eb;Re=I.fb+Re*I.A,v=Hl(G,oe[0],v.width,de,xe,Ue,Re+(ve?0:3),I.A),e(M==xe),v&&Mn(ue)&&gu(Ue,Re,ve,de,xe,I.A)}return 0}function Ci(v){var I=v.ma,M=I.ba.S,G=11>M,oe=M==aa||M==co||M==Kl||M==Vu||M==12||Mn(M);if(I.memory=null,I.Ib=null,I.Jb=null,I.Nd=null,!wl(I.Oa,v,oe?11:12))return 0;if(oe&&Mn(M)&&Zn(),v.da)alert("todo:use_scaling");else{if(G){if(I.Ib=kr,v.Kb){if(M=v.U+1>>1,I.memory=s(v.U+2*M),I.memory==null)return 0;I.ec=I.memory,I.fc=0,I.cc=I.ec,I.dc=I.fc+v.U,I.Mc=I.cc,I.Nc=I.dc+M,I.Ib=vr,Zn()}}else alert("todo:EmitYUV");oe&&(I.Jb=Cr,G&&ft())}if(G&&!_e){for(v=0;256>v;++v)Y[v]=89858*(v-128)+H>>T,ke[v]=-22014*(v-128)+H,be[v]=-45773*(v-128),re[v]=113618*(v-128)+H>>T;for(v=te;v<Se;++v)I=76283*(v-16)+H>>T,it[v-te]=oi(I,255),vt[v-te]=oi(I+8>>4,15);_e=1}return 1}function dn(v){var I=v.ma,M=v.U,G=v.T;return e(!(1&v.ka)),0>=M||0>=G?0:(M=I.Ib(v,I),I.Jb!=null&&I.Jb(v,I,M),I.Dc+=M,1)}function Aa(v){v.ma.memory=null}function ta(v,I,M,G){return Ne(v,8)!=47?0:(I[0]=Ne(v,14)+1,M[0]=Ne(v,14)+1,G[0]=Ne(v,1),Ne(v,3)!=0?0:!v.h)}function Rr(v,I){if(4>v)return v+1;var M=v-2>>1;return(2+(1&v)<<M)+Ne(I,M)+1}function ms(v,I){return 120<I?I-120:1<=(M=((M=Ao[I-1])>>4)*v+(8-(15&M)))?M:1;var M}function Pi(v,I,M){var G=De(M),oe=v[I+=255&G].g-8;return 0<oe&&($e(M,M.u+8),G=De(M),I+=v[I].value,I+=G&(1<<oe)-1),$e(M,M.u+v[I].g),v[I].value}function tr(v,I,M){return M.g+=v.g,M.value+=v.value<<I>>>0,e(8>=M.g),v.g}function cr(v,I,M){var G=v.xc;return e((I=G==0?0:v.vc[v.md*(M>>G)+(I>>G)])<v.Wb),v.Ya[I]}function os(v,I,M,G){var oe=v.ab,de=v.c*I,ue=v.C;I=ue+I;var ve=M,xe=G;for(G=v.Ta,M=v.Ua;0<oe--;){var Re=v.gc[oe],Ue=ue,Xe=I,Ae=ve,He=xe,et=(xe=G,ve=M,Re.Ea);switch(e(Ue<Xe),e(Xe<=Re.nc),Re.hc){case 2:cs(Ae,He,(Xe-Ue)*et,xe,ve);break;case 0:var at=Ue,Ze=Xe,gt=xe,wt=ve,Lt=(Zt=Re).Ea;at==0&&(Fu(Ae,He,null,null,1,gt,wt),li(Ae,He+1,0,0,Lt-1,gt,wt+1),He+=Lt,wt+=Lt,++at);for(var ht=1<<Zt.b,Ut=ht-1,Bt=_t(Lt,Zt.b),An=Zt.K,Zt=Zt.w+(at>>Zt.b)*Bt;at<Ze;){var vi=An,Ui=Zt,si=1;for(fu(Ae,He,gt,wt-Lt,1,gt,wt);si<Lt;){var nn=(si&~Ut)+ht;nn>Lt&&(nn=Lt),(0,Sl[vi[Ui++]>>8&15])(Ae,He+ +si,gt,wt+si-Lt,nn-si,gt,wt+si),si=nn}He+=Lt,wt+=Lt,++at&Ut||(Zt+=Bt)}Xe!=Re.nc&&n(xe,ve-et,xe,ve+(Xe-Ue-1)*et,et);break;case 1:for(et=Ae,Ze=He,Lt=(Ae=Re.Ea)-(wt=Ae&~(gt=(He=1<<Re.b)-1)),at=_t(Ae,Re.b),ht=Re.K,Re=Re.w+(Ue>>Re.b)*at;Ue<Xe;){for(Ut=ht,Bt=Re,An=new Tn,Zt=Ze+wt,vi=Ze+Ae;Ze<Zt;)ln(Ut[Bt++],An),ao(An,et,Ze,He,xe,ve),Ze+=He,ve+=He;Ze<vi&&(ln(Ut[Bt++],An),ao(An,et,Ze,Lt,xe,ve),Ze+=Lt,ve+=Lt),++Ue&gt||(Re+=at)}break;case 3:if(Ae==xe&&He==ve&&0<Re.b){for(Ze=xe,Ae=et=ve+(Xe-Ue)*et-(wt=(Xe-Ue)*_t(Re.Ea,Re.b)),He=xe,gt=ve,at=[],wt=(Lt=wt)-1;0<=wt;--wt)at[wt]=He[gt+wt];for(wt=Lt-1;0<=wt;--wt)Ze[Ae+wt]=at[wt];dc(Re,Ue,Xe,xe,et,xe,ve)}else dc(Re,Ue,Xe,Ae,He,xe,ve)}ve=G,xe=M}xe!=M&&n(G,M,ve,xe,de)}function Zr(v,I){var M=v.V,G=v.Ba+v.c*v.C,oe=I-v.C;if(e(I<=v.l.o),e(16>=oe),0<oe){var de=v.l,ue=v.Ta,ve=v.Ua,xe=de.width;if(os(v,oe,M,G),oe=ve=[ve],e((M=v.C)<(G=I)),e(de.v<de.va),G>de.o&&(G=de.o),M<de.j){var Re=de.j-M;M=de.j,oe[0]+=Re*xe}if(M>=G?M=0:(oe[0]+=4*de.v,de.ka=M-de.j,de.U=de.va-de.v,de.T=G-M,M=1),M){if(ve=ve[0],11>(M=v.ca).S){var Ue=M.f.RGBA,Xe=(G=M.S,oe=de.U,de=de.T,Re=Ue.eb,Ue.A),Ae=de;for(Ue=Ue.fb+v.Ma*Ue.A;0<Ae--;){var He=ue,et=ve,at=oe,Ze=Re,gt=Ue;switch(G){case gc:ju(He,et,at,Ze,gt);break;case aa:Ho(He,et,at,Ze,gt);break;case zu:Ho(He,et,at,Ze,gt),gu(Ze,gt,0,at,1,0);break;case mc:Gl(He,et,at,Ze,gt);break;case co:on(He,et,at,Ze,gt,1);break;case yc:on(He,et,at,Ze,gt,1),gu(Ze,gt,0,at,1,0);break;case Kl:on(He,et,at,Ze,gt,0);break;case _u:on(He,et,at,Ze,gt,0),gu(Ze,gt,1,at,1,0);break;case Vu:oo(He,et,at,Ze,gt);break;case vc:oo(He,et,at,Ze,gt),So(Ze,gt,at,1,0);break;case El:al(He,et,at,Ze,gt);break;default:e(0)}ve+=xe,Ue+=Xe}v.Ma+=de}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=M.height)}}v.C=I,e(v.C<=v.i)}function qi(v){var I;if(0<v.ua)return 0;for(I=0;I<v.Wb;++I){var M=v.Ya[I].G,G=v.Ya[I].H;if(0<M[1][G[1]+0].g||0<M[2][G[2]+0].g||0<M[3][G[3]+0].g)return 0}return 1}function Yi(v,I,M,G,oe,de){if(v.Z!=0){var ue=v.qd,ve=v.rd;for(e(y[v.Z]!=null);I<M;++I)y[v.Z](ue,ve,G,oe,G,oe,de),ue=G,ve=oe,oe+=de;v.qd=ue,v.rd=ve}}function Kr(v,I){var M=v.l.ma,G=M.Z==0||M.Z==1?v.l.j:v.C;if(G=v.C<G?G:v.C,e(I<=v.l.o),I>G){var oe=v.l.width,de=M.ca,ue=M.tb+oe*G,ve=v.V,xe=v.Ba+v.c*G,Re=v.gc;e(v.ab==1),e(Re[0].hc==3),Is(Re[0],G,I,ve,xe,de,ue),Yi(M,G,I,de,ue,oe)}v.C=v.Ma=I}function ls(v,I,M,G,oe,de,ue){var ve=v.$/G,xe=v.$%G,Re=v.m,Ue=v.s,Xe=M+v.$,Ae=Xe;oe=M+G*oe;var He=M+G*de,et=280+Ue.ua,at=v.Pb?ve:16777216,Ze=0<Ue.ua?Ue.Wa:null,gt=Ue.wc,wt=Xe<He?cr(Ue,xe,ve):null;e(v.C<de),e(He<=oe);var Lt=!1;e:for(;;){for(;Lt||Xe<He;){var ht=0;if(ve>=at){var Ut=Xe-M;e((at=v).Pb),at.wd=at.m,at.xd=Ut,0<at.s.ua&&$t(at.s.Wa,at.s.vb),at=ve+Wl}if(xe&gt||(wt=cr(Ue,xe,ve)),e(wt!=null),wt.Qb&&(I[Xe]=wt.qb,Lt=!0),!Lt)if(Ye(Re),wt.jc){ht=Re,Ut=I;var Bt=Xe,An=wt.pd[De(ht)&$l-1];e(wt.jc),256>An.g?($e(ht,ht.u+An.g),Ut[Bt]=An.value,ht=0):($e(ht,ht.u+An.g-256),e(256<=An.value),ht=An.value),ht==0&&(Lt=!0)}else ht=Pi(wt.G[0],wt.H[0],Re);if(Re.h)break;if(Lt||256>ht){if(!Lt)if(wt.nd)I[Xe]=(wt.qb|ht<<8)>>>0;else{if(Ye(Re),Lt=Pi(wt.G[1],wt.H[1],Re),Ye(Re),Ut=Pi(wt.G[2],wt.H[2],Re),Bt=Pi(wt.G[3],wt.H[3],Re),Re.h)break;I[Xe]=(Bt<<24|Lt<<16|ht<<8|Ut)>>>0}if(Lt=!1,++Xe,++xe>=G&&(xe=0,++ve,ue!=null&&ve<=de&&!(ve%16)&&ue(v,ve),Ze!=null))for(;Ae<Xe;)ht=I[Ae++],Ze.X[(506832829*ht&4294967295)>>>Ze.Mb]=ht}else if(280>ht){if(ht=Rr(ht-256,Re),Ut=Pi(wt.G[4],wt.H[4],Re),Ye(Re),Ut=ms(G,Ut=Rr(Ut,Re)),Re.h)break;if(Xe-M<Ut||oe-Xe<ht)break e;for(Bt=0;Bt<ht;++Bt)I[Xe+Bt]=I[Xe+Bt-Ut];for(Xe+=ht,xe+=ht;xe>=G;)xe-=G,++ve,ue!=null&&ve<=de&&!(ve%16)&&ue(v,ve);if(e(Xe<=oe),xe&gt&&(wt=cr(Ue,xe,ve)),Ze!=null)for(;Ae<Xe;)ht=I[Ae++],Ze.X[(506832829*ht&4294967295)>>>Ze.Mb]=ht}else{if(!(ht<et))break e;for(Lt=ht-280,e(Ze!=null);Ae<Xe;)ht=I[Ae++],Ze.X[(506832829*ht&4294967295)>>>Ze.Mb]=ht;ht=Xe,e(!(Lt>>>(Ut=Ze).Xa)),I[ht]=Ut.X[Lt],Lt=!0}Lt||e(Re.h==Be(Re))}if(v.Pb&&Re.h&&Xe<oe)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&$t(v.s.vb,v.s.Wa);else{if(Re.h)break e;ue?.(v,ve>de?de:ve),v.a=0,v.$=Xe-M}return 1}return v.a=3,0}function da(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var I=v.Wa;I!=null&&(I.X=null),v.vb=null,e(v!=null)}function Va(){var v=new Vn;return v==null?null:(v.a=0,v.xb=p,Ni("Predictor","VP8LPredictors"),Ni("Predictor","VP8LPredictors_C"),Ni("PredictorAdd","VP8LPredictorsAdd"),Ni("PredictorAdd","VP8LPredictorsAdd_C"),cs=Xn,ao=$n,ju=er,Ho=Jn,oo=mn,al=On,Gl=qn,J.VP8LMapColor32b=sl,J.VP8LMapColor8b=ks,v)}function ys(v,I,M,G,oe){var de=1,ue=[v],ve=[I],xe=G.m,Re=G.s,Ue=null,Xe=0;e:for(;;){if(M)for(;de&&Ne(xe,1);){var Ae=ue,He=ve,et=G,at=1,Ze=et.m,gt=et.gc[et.ab],wt=Ne(Ze,2);if(et.Oc&1<<wt)de=0;else{switch(et.Oc|=1<<wt,gt.hc=wt,gt.Ea=Ae[0],gt.nc=He[0],gt.K=[null],++et.ab,e(4>=et.ab),wt){case 0:case 1:gt.b=Ne(Ze,3)+2,at=ys(_t(gt.Ea,gt.b),_t(gt.nc,gt.b),0,et,gt.K),gt.K=gt.K[0];break;case 3:var Lt,ht=Ne(Ze,8)+1,Ut=16<ht?0:4<ht?1:2<ht?2:3;if(Ae[0]=_t(gt.Ea,Ut),gt.b=Ut,Lt=at=ys(ht,1,0,et,gt.K)){var Bt,An=ht,Zt=gt,vi=1<<(8>>Zt.b),Ui=s(vi);if(Ui==null)Lt=0;else{var si=Zt.K[0],nn=Zt.w;for(Ui[0]=Zt.K[0][0],Bt=1;Bt<1*An;++Bt)Ui[Bt]=en(si[nn+Bt],Ui[Bt-1]);for(;Bt<4*vi;++Bt)Ui[Bt]=0;Zt.K[0]=null,Zt.K[0]=Ui,Lt=1}}at=Lt;break;case 2:break;default:e(0)}de=at}}if(ue=ue[0],ve=ve[0],de&&Ne(xe,1)&&!(de=1<=(Xe=Ne(xe,4))&&11>=Xe)){G.a=3;break e}var Gt;if(Gt=de)t:{var ei,Ln,Nn,ur=G,is=ue,Sn=ve,pr=Xe,vs=M,va=ur.m,zr=ur.s,di=[null],Bi=1,ir=0,sn=Wa[pr];n:for(;;){if(vs&&Ne(va,1)){var Cs=Ne(va,3)+2,Ir=_t(is,Cs),mi=_t(Sn,Cs),ds=Ir*mi;if(!ys(Ir,mi,0,ur,di))break n;for(di=di[0],zr.xc=Cs,ei=0;ei<ds;++ei){var Xi=di[ei]>>8&65535;di[ei]=Xi,Xi>=Bi&&(Bi=Xi+1)}}if(va.h)break n;for(Ln=0;5>Ln;++Ln){var Yr=bu[Ln];!Ln&&0<pr&&(Yr+=1<<pr),ir<Yr&&(ir=Yr)}var fs=l(Bi*sn,le),_i=Bi,Fn=l(_i,nt);if(Fn==null)var Rs=null;else e(65536>=_i),Rs=Fn;var Xr=s(ir);if(Rs==null||Xr==null||fs==null){ur.a=1;break n}var Pn=fs;for(ei=Nn=0;ei<Bi;++ei){var zn=Rs[ei],Ji=zn.G,Da=zn.H,po=0,_a=1,_s=0;for(Ln=0;5>Ln;++Ln){Yr=bu[Ln],Ji[Ln]=Pn,Da[Ln]=Nn,!Ln&&0<pr&&(Yr+=1<<pr);r:{var ql,Il=Yr,Bu=ur,Yt=Xr,Wo=Pn,$u=Nn,xc=0,kl=Bu.m,$p=Ne(kl,1);if(r(Yt,0,0,Il),$p){var oh=Ne(kl,1)+1,vd=Ne(kl,1),lh=Ne(kl,vd==0?1:8);Yt[lh]=1,oh==2&&(Yt[lh=Ne(kl,8)]=1);var Ls=1}else{var rs=s(19),Yl=Ne(kl,4)+4;if(19<Yl){Bu.a=3;var Cl=0;break r}for(ql=0;ql<Yl;++ql)rs[_c[ql]]=Ne(kl,3);var xu=void 0,Xl=void 0,go=Bu,bi=rs,Jl=Il,wc=Yt,Sc=0,Rl=go.m,_d=8,bd=l(128,le);i:for(;ae(bd,0,7,bi,19);){if(Ne(Rl,1)){var _=2+2*Ne(Rl,3);if((xu=2+Ne(Rl,_))>Jl)break i}else xu=Jl;for(Xl=0;Xl<Jl&&xu--;){Ye(Rl);var V=bd[0+(127&De(Rl))];$e(Rl,Rl.u+V.g);var ce=V.value;if(16>ce)wc[Xl++]=ce,ce!=0&&(_d=ce);else{var Le=ce==16,Ge=ce-16,mt=Uu[Ge],Ct=Ne(Rl,To[Ge])+mt;if(Xl+Ct>Jl)break i;for(var Jt=Le?_d:0;0<Ct--;)wc[Xl++]=Jt}}Sc=1;break i}Sc||(go.a=3),Ls=Sc}(Ls=Ls&&!kl.h)&&(xc=ae(Wo,$u,8,Yt,Il)),Ls&&xc!=0?Cl=xc:(Bu.a=3,Cl=0)}if(Cl==0)break n;if(_a&&sh[Ln]==1&&(_a=Pn[Nn].g==0),po+=Pn[Nn].g,Nn+=Cl,3>=Ln){var Dn,$i=Xr[0];for(Dn=1;Dn<Yr;++Dn)Xr[Dn]>$i&&($i=Xr[Dn]);_s+=$i}}if(zn.nd=_a,zn.Qb=0,_a&&(zn.qb=(Ji[3][Da[3]+0].value<<24|Ji[1][Da[1]+0].value<<16|Ji[2][Da[2]+0].value)>>>0,po==0&&256>Ji[0][Da[0]+0].value&&(zn.Qb=1,zn.qb+=Ji[0][Da[0]+0].value<<8)),zn.jc=!zn.Qb&&6>_s,zn.jc){var Ks,Ws=zn;for(Ks=0;Ks<$l;++Ks){var qa=Ks,Na=Ws.pd[qa],uh=Ws.G[0][Ws.H[0]+qa];256<=uh.value?(Na.g=uh.g+256,Na.value=uh.value):(Na.g=0,Na.value=0,qa>>=tr(uh,8,Na),qa>>=tr(Ws.G[1][Ws.H[1]+qa],16,Na),qa>>=tr(Ws.G[2][Ws.H[2]+qa],0,Na),tr(Ws.G[3][Ws.H[3]+qa],24,Na))}}}zr.vc=di,zr.Wb=Bi,zr.Ya=Rs,zr.yc=fs,Gt=1;break t}Gt=0}if(!(de=Gt)){G.a=3;break e}if(0<Xe){if(Re.ua=1<<Xe,!Pe(Re.Wa,Xe)){G.a=1,de=0;break e}}else Re.ua=0;var ch=G,Ql=ue,ty=ve,hh=ch.s,dh=hh.xc;if(ch.c=Ql,ch.i=ty,hh.md=_t(Ql,dh),hh.wc=dh==0?-1:(1<<dh)-1,M){G.xb=d;break e}if((Ue=s(ue*ve))==null){G.a=1,de=0;break e}de=(de=ls(G,Ue,0,ue,ve,ve,null))&&!xe.h;break e}return de?(oe!=null?oe[0]=Ue:(e(Ue==null),e(M)),G.$=0,M||da(Re)):da(Re),de}function es(v,I){var M=v.c*v.i,G=M+I+16*I;return e(v.c<=I),v.V=s(G),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+M+I,1)}function to(v,I){var M=v.C,G=I-M,oe=v.V,de=v.Ba+v.c*M;for(e(I<=v.l.o);0<G;){var ue=16<G?16:G,ve=v.l.ma,xe=v.l.width,Re=xe*ue,Ue=ve.ca,Xe=ve.tb+xe*M,Ae=v.Ta,He=v.Ua;os(v,ue,oe,de),lo(Ae,He,Ue,Xe,Re),Yi(ve,M,M+ue,Ue,Xe,xe),G-=ue,oe+=ue*v.c,M+=ue}e(M==I),v.C=v.Ma=I}function Ps(){this.ub=this.yd=this.td=this.Rb=0}function Os(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function na(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ms(){this.Yb=(function(){var v=[];return(function I(M,G,oe){for(var de=oe[G],ue=0;ue<de&&(M.push(oe.length>G+1?[]:0),!(oe.length<G+1));ue++)I(M[ue],G+1,oe)})(v,0,[3,11]),v})()}function hr(){this.jb=s(3),this.Wc=u([4,8],Ms),this.Xc=u([4,17],Ms)}function ml(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Fs(){this.ld=this.La=this.dd=this.tc=0}function fa(){this.Na=this.la=0}function Ts(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Mo(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function el(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fs),this.Y=0,this.ya=Array(new Mo),this.aa=0,this.l=new jr}function tl(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Fo(){this.cb=this.a=0,this.sc="",this.m=new se,this.Od=new Ps,this.Kc=new Os,this.ed=new ml,this.Qa=new na,this.Ic=this.$c=this.Aa=0,this.D=new el,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,se),this.ia=0,this.pb=l(4,Ts),this.Pa=new hr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new tl),this.Hd=0,this.rb=Array(new fa),this.sb=0,this.wa=Array(new Fs),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Mo),this.L=this.aa=0,this.gd=u([4,2],Fs),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function oi(v,I){return 0>v?0:v>I?I:v}function jr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function _r(){var v=new Fo;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,fo||(fo=gi)),v}function hn(v,I,M){return v.a==0&&(v.a=I,v.sc=M,v.cb=0),0}function Ea(v,I,M){return 3<=M&&v[I+0]==157&&v[I+1]==1&&v[I+2]==42}function js(v,I){if(v==null)return 0;if(v.a=0,v.sc="OK",I==null)return hn(v,2,"null VP8Io passed to VP8GetHeaders()");var M=I.data,G=I.w,oe=I.ha;if(4>oe)return hn(v,7,"Truncated header.");var de=M[G+0]|M[G+1]<<8|M[G+2]<<16,ue=v.Od;if(ue.Rb=!(1&de),ue.td=de>>1&7,ue.yd=de>>4&1,ue.ub=de>>5,3<ue.td)return hn(v,3,"Incorrect keyframe parameters.");if(!ue.yd)return hn(v,4,"Frame not displayable.");G+=3,oe-=3;var ve=v.Kc;if(ue.Rb){if(7>oe)return hn(v,7,"cannot parse picture header");if(!Ea(M,G,oe))return hn(v,3,"Bad code word");ve.c=16383&(M[G+4]<<8|M[G+3]),ve.Td=M[G+4]>>6,ve.i=16383&(M[G+6]<<8|M[G+5]),ve.Ud=M[G+6]>>6,G+=7,oe-=7,v.za=ve.c+15>>4,v.Ub=ve.i+15>>4,I.width=ve.c,I.height=ve.i,I.Da=0,I.j=0,I.v=0,I.va=I.width,I.o=I.height,I.da=0,I.ib=I.width,I.hb=I.height,I.U=I.width,I.T=I.height,r((de=v.Pa).jb,0,255,de.jb.length),e((de=v.Qa)!=null),de.Cb=0,de.Bb=0,de.Fb=1,r(de.Zb,0,0,de.Zb.length),r(de.Lb,0,0,de.Lb)}if(ue.ub>oe)return hn(v,7,"bad partition length");je(de=v.m,M,G,ue.ub),G+=ue.ub,oe-=ue.ub,ue.Rb&&(ve.Ld=ut(de),ve.Kd=ut(de)),ve=v.Qa;var xe,Re=v.Pa;if(e(de!=null),e(ve!=null),ve.Cb=ut(de),ve.Cb){if(ve.Bb=ut(de),ut(de)){for(ve.Fb=ut(de),xe=0;4>xe;++xe)ve.Zb[xe]=ut(de)?qe(de,7):0;for(xe=0;4>xe;++xe)ve.Lb[xe]=ut(de)?qe(de,6):0}if(ve.Bb)for(xe=0;3>xe;++xe)Re.jb[xe]=ut(de)?Je(de,8):255}else ve.Bb=0;if(de.Ka)return hn(v,3,"cannot parse segment header");if((ve=v.ed).zd=ut(de),ve.Tb=Je(de,6),ve.wb=Je(de,3),ve.Pc=ut(de),ve.Pc&&ut(de)){for(Re=0;4>Re;++Re)ut(de)&&(ve.vd[Re]=qe(de,6));for(Re=0;4>Re;++Re)ut(de)&&(ve.od[Re]=qe(de,6))}if(v.L=ve.Tb==0?0:ve.zd?1:2,de.Ka)return hn(v,3,"cannot parse filter header");var Ue=oe;if(oe=xe=G,G=xe+Ue,ve=Ue,v.Xb=(1<<Je(v.m,2))-1,Ue<3*(Re=v.Xb))M=7;else{for(xe+=3*Re,ve-=3*Re,Ue=0;Ue<Re;++Ue){var Xe=M[oe+0]|M[oe+1]<<8|M[oe+2]<<16;Xe>ve&&(Xe=ve),je(v.Jc[+Ue],M,xe,Xe),xe+=Xe,ve-=Xe,oe+=3}je(v.Jc[+Re],M,xe,ve),M=xe<G?0:5}if(M!=0)return hn(v,M,"cannot parse partitions");for(M=Je(xe=v.m,7),oe=ut(xe)?qe(xe,4):0,G=ut(xe)?qe(xe,4):0,ve=ut(xe)?qe(xe,4):0,Re=ut(xe)?qe(xe,4):0,xe=ut(xe)?qe(xe,4):0,Ue=v.Qa,Xe=0;4>Xe;++Xe){if(Ue.Cb){var Ae=Ue.Zb[Xe];Ue.Fb||(Ae+=M)}else{if(0<Xe){v.pb[Xe]=v.pb[0];continue}Ae=M}var He=v.pb[Xe];He.Sc[0]=ho[oi(Ae+oe,127)],He.Sc[1]=Eo[oi(Ae+0,127)],He.Eb[0]=2*ho[oi(Ae+G,127)],He.Eb[1]=101581*Eo[oi(Ae+ve,127)]>>16,8>He.Eb[1]&&(He.Eb[1]=8),He.Qc[0]=ho[oi(Ae+Re,117)],He.Qc[1]=Eo[oi(Ae+xe,127)],He.lc=Ae+xe}if(!ue.Rb)return hn(v,4,"Not a key frame.");for(ut(de),ue=v.Pa,M=0;4>M;++M){for(oe=0;8>oe;++oe)for(G=0;3>G;++G)for(ve=0;11>ve;++ve)Re=Tt(de,Dr[M][oe][G][ve])?Je(de,8):yd[M][oe][G][ve],ue.Wc[M][oe].Yb[G][ve]=Re;for(oe=0;17>oe;++oe)ue.Xc[M][oe]=ue.Wc[M][yi[oe]]}return v.kc=ut(de),v.kc&&(v.Bd=Je(de,8)),v.cb=1}function gi(v,I,M,G,oe,de,ue){var ve=I[oe].Yb[M];for(M=0;16>oe;++oe){if(!Tt(v,ve[M+0]))return oe;for(;!Tt(v,ve[M+1]);)if(ve=I[++oe].Yb[0],M=0,oe==16)return 16;var xe=I[oe+1].Yb;if(Tt(v,ve[M+2])){var Re=v,Ue=0;if(Tt(Re,(Ae=ve)[(Xe=M)+3]))if(Tt(Re,Ae[Xe+6])){for(ve=0,Xe=2*(Ue=Tt(Re,Ae[Xe+8]))+(Ae=Tt(Re,Ae[Xe+9+Ue])),Ue=0,Ae=bc[Xe];Ae[ve];++ve)Ue+=Ue+Tt(Re,Ae[ve]);Ue+=3+(8<<Xe)}else Tt(Re,Ae[Xe+7])?(Ue=7+2*Tt(Re,165),Ue+=Tt(Re,145)):Ue=5+Tt(Re,159);else Ue=Tt(Re,Ae[Xe+4])?3+Tt(Re,Ae[Xe+5]):2;ve=xe[2]}else Ue=1,ve=xe[1];xe=ue+md[oe],0>(Re=v).b&&ct(Re);var Xe,Ae=Re.b,He=(Xe=Re.Ca>>1)-(Re.I>>Ae)>>31;--Re.b,Re.Ca+=He,Re.Ca|=1,Re.I-=(Xe+1&He)<<Ae,de[xe]=((Ue^He)-He)*G[(0<oe)+0]}return 16}function za(v){var I=v.rb[v.sb-1];I.la=0,I.Na=0,r(v.zc,0,0,v.zc.length),v.ja=0}function ri(v,I,M,G,oe){oe=v[I+M+32*G]+(oe>>3),v[I+M+32*G]=-256&oe?0>oe?0:255:oe}function dr(v,I,M,G,oe,de){ri(v,I,0,M,G+oe),ri(v,I,1,M,G+de),ri(v,I,2,M,G-de),ri(v,I,3,M,G-oe)}function Lr(v){return(20091*v>>16)+v}function jo(v,I,M,G){var oe,de=0,ue=s(16);for(oe=0;4>oe;++oe){var ve=v[I+0]+v[I+8],xe=v[I+0]-v[I+8],Re=(35468*v[I+4]>>16)-Lr(v[I+12]),Ue=Lr(v[I+4])+(35468*v[I+12]>>16);ue[de+0]=ve+Ue,ue[de+1]=xe+Re,ue[de+2]=xe-Re,ue[de+3]=ve-Ue,de+=4,I++}for(oe=de=0;4>oe;++oe)ve=(v=ue[de+0]+4)+ue[de+8],xe=v-ue[de+8],Re=(35468*ue[de+4]>>16)-Lr(ue[de+12]),ri(M,G,0,0,ve+(Ue=Lr(ue[de+4])+(35468*ue[de+12]>>16))),ri(M,G,1,0,xe+Re),ri(M,G,2,0,xe-Re),ri(M,G,3,0,ve-Ue),de++,G+=32}function Bl(v,I,M,G){var oe=v[I+0]+4,de=35468*v[I+4]>>16,ue=Lr(v[I+4]),ve=35468*v[I+1]>>16;dr(M,G,0,oe+ue,v=Lr(v[I+1]),ve),dr(M,G,1,oe+de,v,ve),dr(M,G,2,oe-de,v,ve),dr(M,G,3,oe-ue,v,ve)}function Vo(v,I,M,G,oe){jo(v,I,M,G),oe&&jo(v,I+16,M,G+4)}function br(v,I,M,G){Wn(v,I+0,M,G,1),Wn(v,I+32,M,G+128,1)}function yl(v,I,M,G){var oe;for(v=v[I+0]+4,oe=0;4>oe;++oe)for(I=0;4>I;++I)ri(M,G,I,oe,v)}function ia(v,I,M,G){v[I+0]&&Li(v,I+0,M,G),v[I+16]&&Li(v,I+16,M,G+4),v[I+32]&&Li(v,I+32,M,G+128),v[I+48]&&Li(v,I+48,M,G+128+4)}function Oi(v,I,M,G){var oe,de=s(16);for(oe=0;4>oe;++oe){var ue=v[I+0+oe]+v[I+12+oe],ve=v[I+4+oe]+v[I+8+oe],xe=v[I+4+oe]-v[I+8+oe],Re=v[I+0+oe]-v[I+12+oe];de[0+oe]=ue+ve,de[8+oe]=ue-ve,de[4+oe]=Re+xe,de[12+oe]=Re-xe}for(oe=0;4>oe;++oe)ue=(v=de[0+4*oe]+3)+de[3+4*oe],ve=de[1+4*oe]+de[2+4*oe],xe=de[1+4*oe]-de[2+4*oe],Re=v-de[3+4*oe],M[G+0]=ue+ve>>3,M[G+16]=Re+xe>>3,M[G+32]=ue-ve>>3,M[G+48]=Re-xe>>3,G+=64}function no(v,I,M){var G,oe=I-32,de=Gs,ue=255-v[oe-1];for(G=0;G<M;++G){var ve,xe=de,Re=ue+v[I-1];for(ve=0;ve<M;++ve)v[I+ve]=xe[Re+v[oe+ve]];I+=32}}function vl(v,I){no(v,I,4)}function _l(v,I){no(v,I,8)}function zo(v,I){no(v,I,16)}function Ua(v,I){var M;for(M=0;16>M;++M)n(v,I+32*M,v,I-32,16)}function It(v,I){var M;for(M=16;0<M;--M)r(v,I,v[I-1],16),I+=32}function Mt(v,I,M){var G;for(G=0;16>G;++G)r(I,M+32*G,v,16)}function kn(v,I){var M,G=16;for(M=0;16>M;++M)G+=v[I-1+32*M]+v[I+M-32];Mt(G>>5,v,I)}function xi(v,I){var M,G=8;for(M=0;16>M;++M)G+=v[I-1+32*M];Mt(G>>4,v,I)}function or(v,I){var M,G=8;for(M=0;16>M;++M)G+=v[I+M-32];Mt(G>>4,v,I)}function Mi(v,I){Mt(128,v,I)}function rn(v,I,M){return v+2*I+M+2>>2}function Vs(v,I){var M,G=I-32;for(G=new Uint8Array([rn(v[G-1],v[G+0],v[G+1]),rn(v[G+0],v[G+1],v[G+2]),rn(v[G+1],v[G+2],v[G+3]),rn(v[G+2],v[G+3],v[G+4])]),M=0;4>M;++M)n(v,I+32*M,G,0,G.length)}function io(v,I){var M=v[I-1],G=v[I-1+32],oe=v[I-1+64],de=v[I-1+96];Ft(v,I+0,16843009*rn(v[I-1-32],M,G)),Ft(v,I+32,16843009*rn(M,G,oe)),Ft(v,I+64,16843009*rn(G,oe,de)),Ft(v,I+96,16843009*rn(oe,de,de))}function pa(v,I){var M,G=4;for(M=0;4>M;++M)G+=v[I+M-32]+v[I-1+32*M];for(G>>=3,M=0;4>M;++M)r(v,I+32*M,G,4)}function Wr(v,I){var M=v[I-1+0],G=v[I-1+32],oe=v[I-1+64],de=v[I-1-32],ue=v[I+0-32],ve=v[I+1-32],xe=v[I+2-32],Re=v[I+3-32];v[I+0+96]=rn(G,oe,v[I-1+96]),v[I+1+96]=v[I+0+64]=rn(M,G,oe),v[I+2+96]=v[I+1+64]=v[I+0+32]=rn(de,M,G),v[I+3+96]=v[I+2+64]=v[I+1+32]=v[I+0+0]=rn(ue,de,M),v[I+3+64]=v[I+2+32]=v[I+1+0]=rn(ve,ue,de),v[I+3+32]=v[I+2+0]=rn(xe,ve,ue),v[I+3+0]=rn(Re,xe,ve)}function wi(v,I){var M=v[I+1-32],G=v[I+2-32],oe=v[I+3-32],de=v[I+4-32],ue=v[I+5-32],ve=v[I+6-32],xe=v[I+7-32];v[I+0+0]=rn(v[I+0-32],M,G),v[I+1+0]=v[I+0+32]=rn(M,G,oe),v[I+2+0]=v[I+1+32]=v[I+0+64]=rn(G,oe,de),v[I+3+0]=v[I+2+32]=v[I+1+64]=v[I+0+96]=rn(oe,de,ue),v[I+3+32]=v[I+2+64]=v[I+1+96]=rn(de,ue,ve),v[I+3+64]=v[I+2+96]=rn(ue,ve,xe),v[I+3+96]=rn(ve,xe,xe)}function ga(v,I){var M=v[I-1+0],G=v[I-1+32],oe=v[I-1+64],de=v[I-1-32],ue=v[I+0-32],ve=v[I+1-32],xe=v[I+2-32],Re=v[I+3-32];v[I+0+0]=v[I+1+64]=de+ue+1>>1,v[I+1+0]=v[I+2+64]=ue+ve+1>>1,v[I+2+0]=v[I+3+64]=ve+xe+1>>1,v[I+3+0]=xe+Re+1>>1,v[I+0+96]=rn(oe,G,M),v[I+0+64]=rn(G,M,de),v[I+0+32]=v[I+1+96]=rn(M,de,ue),v[I+1+32]=v[I+2+96]=rn(de,ue,ve),v[I+2+32]=v[I+3+96]=rn(ue,ve,xe),v[I+3+32]=rn(ve,xe,Re)}function ki(v,I){var M=v[I+0-32],G=v[I+1-32],oe=v[I+2-32],de=v[I+3-32],ue=v[I+4-32],ve=v[I+5-32],xe=v[I+6-32],Re=v[I+7-32];v[I+0+0]=M+G+1>>1,v[I+1+0]=v[I+0+64]=G+oe+1>>1,v[I+2+0]=v[I+1+64]=oe+de+1>>1,v[I+3+0]=v[I+2+64]=de+ue+1>>1,v[I+0+32]=rn(M,G,oe),v[I+1+32]=v[I+0+96]=rn(G,oe,de),v[I+2+32]=v[I+1+96]=rn(oe,de,ue),v[I+3+32]=v[I+2+96]=rn(de,ue,ve),v[I+3+64]=rn(ue,ve,xe),v[I+3+96]=rn(ve,xe,Re)}function zs(v,I){var M=v[I-1+0],G=v[I-1+32],oe=v[I-1+64],de=v[I-1+96];v[I+0+0]=M+G+1>>1,v[I+2+0]=v[I+0+32]=G+oe+1>>1,v[I+2+32]=v[I+0+64]=oe+de+1>>1,v[I+1+0]=rn(M,G,oe),v[I+3+0]=v[I+1+32]=rn(G,oe,de),v[I+3+32]=v[I+1+64]=rn(oe,de,de),v[I+3+64]=v[I+2+64]=v[I+0+96]=v[I+1+96]=v[I+2+96]=v[I+3+96]=de}function Ba(v,I){var M=v[I-1+0],G=v[I-1+32],oe=v[I-1+64],de=v[I-1+96],ue=v[I-1-32],ve=v[I+0-32],xe=v[I+1-32],Re=v[I+2-32];v[I+0+0]=v[I+2+32]=M+ue+1>>1,v[I+0+32]=v[I+2+64]=G+M+1>>1,v[I+0+64]=v[I+2+96]=oe+G+1>>1,v[I+0+96]=de+oe+1>>1,v[I+3+0]=rn(ve,xe,Re),v[I+2+0]=rn(ue,ve,xe),v[I+1+0]=v[I+3+32]=rn(M,ue,ve),v[I+1+32]=v[I+3+64]=rn(G,M,ue),v[I+1+64]=v[I+3+96]=rn(oe,G,M),v[I+1+96]=rn(de,oe,G)}function Us(v,I){var M;for(M=0;8>M;++M)n(v,I+32*M,v,I-32,8)}function fn(v,I){var M;for(M=0;8>M;++M)r(v,I,v[I-1],8),I+=32}function As(v,I,M){var G;for(G=0;8>G;++G)r(I,M+32*G,v,8)}function Ia(v,I){var M,G=8;for(M=0;8>M;++M)G+=v[I+M-32]+v[I-1+32*M];As(G>>4,v,I)}function qr(v,I){var M,G=4;for(M=0;8>M;++M)G+=v[I+M-32];As(G>>3,v,I)}function Tr(v,I){var M,G=4;for(M=0;8>M;++M)G+=v[I-1+32*M];As(G>>3,v,I)}function ka(v,I){As(128,v,I)}function Vr(v,I,M){var G=v[I-M],oe=v[I+0],de=3*(oe-G)+uo[1020+v[I-2*M]-v[I+M]],ue=Al[112+(de+4>>3)];v[I-M]=Gs[255+G+Al[112+(de+3>>3)]],v[I+0]=Gs[255+oe-ue]}function Ca(v,I,M,G){var oe=v[I+0],de=v[I+M];return Hs[255+v[I-2*M]-v[I-M]]>G||Hs[255+de-oe]>G}function ma(v,I,M,G){return 4*Hs[255+v[I-M]-v[I+0]]+Hs[255+v[I-2*M]-v[I+M]]<=G}function us(v,I,M,G,oe){var de=v[I-3*M],ue=v[I-2*M],ve=v[I-M],xe=v[I+0],Re=v[I+M],Ue=v[I+2*M],Xe=v[I+3*M];return 4*Hs[255+ve-xe]+Hs[255+ue-Re]>G?0:Hs[255+v[I-4*M]-de]<=oe&&Hs[255+de-ue]<=oe&&Hs[255+ue-ve]<=oe&&Hs[255+Xe-Ue]<=oe&&Hs[255+Ue-Re]<=oe&&Hs[255+Re-xe]<=oe}function Cn(v,I,M,G){var oe=2*G+1;for(G=0;16>G;++G)ma(v,I+G,M,oe)&&Vr(v,I+G,M)}function Ri(v,I,M,G){var oe=2*G+1;for(G=0;16>G;++G)ma(v,I+G*M,1,oe)&&Vr(v,I+G*M,1)}function Es(v,I,M,G){var oe;for(oe=3;0<oe;--oe)Cn(v,I+=4*M,M,G)}function $a(v,I,M,G){var oe;for(oe=3;0<oe;--oe)Ri(v,I+=4,M,G)}function Bs(v,I,M,G,oe,de,ue,ve){for(de=2*de+1;0<oe--;){if(us(v,I,M,de,ue))if(Ca(v,I,M,ve))Vr(v,I,M);else{var xe=v,Re=I,Ue=M,Xe=xe[Re-2*Ue],Ae=xe[Re-Ue],He=xe[Re+0],et=xe[Re+Ue],at=xe[Re+2*Ue],Ze=27*(wt=uo[1020+3*(He-Ae)+uo[1020+Xe-et]])+63>>7,gt=18*wt+63>>7,wt=9*wt+63>>7;xe[Re-3*Ue]=Gs[255+xe[Re-3*Ue]+wt],xe[Re-2*Ue]=Gs[255+Xe+gt],xe[Re-Ue]=Gs[255+Ae+Ze],xe[Re+0]=Gs[255+He-Ze],xe[Re+Ue]=Gs[255+et-gt],xe[Re+2*Ue]=Gs[255+at-wt]}I+=G}}function wo(v,I,M,G,oe,de,ue,ve){for(de=2*de+1;0<oe--;){if(us(v,I,M,de,ue))if(Ca(v,I,M,ve))Vr(v,I,M);else{var xe=v,Re=I,Ue=M,Xe=xe[Re-Ue],Ae=xe[Re+0],He=xe[Re+Ue],et=Al[112+(4+(at=3*(Ae-Xe))>>3)],at=Al[112+(at+3>>3)],Ze=et+1>>1;xe[Re-2*Ue]=Gs[255+xe[Re-2*Ue]+Ze],xe[Re-Ue]=Gs[255+Xe+at],xe[Re+0]=Gs[255+Ae-et],xe[Re+Ue]=Gs[255+He-Ze]}I+=G}}function du(v,I,M,G,oe,de){Bs(v,I,M,1,16,G,oe,de)}function ro(v,I,M,G,oe,de){Bs(v,I,1,M,16,G,oe,de)}function bl(v,I,M,G,oe,de){var ue;for(ue=3;0<ue;--ue)wo(v,I+=4*M,M,1,16,G,oe,de)}function j(v,I,M,G,oe,de){var ue;for(ue=3;0<ue;--ue)wo(v,I+=4,1,M,16,G,oe,de)}function fe(v,I,M,G,oe,de,ue,ve){Bs(v,I,oe,1,8,de,ue,ve),Bs(M,G,oe,1,8,de,ue,ve)}function Me(v,I,M,G,oe,de,ue,ve){Bs(v,I,1,oe,8,de,ue,ve),Bs(M,G,1,oe,8,de,ue,ve)}function We(v,I,M,G,oe,de,ue,ve){wo(v,I+4*oe,oe,1,8,de,ue,ve),wo(M,G+4*oe,oe,1,8,de,ue,ve)}function tt(v,I,M,G,oe,de,ue,ve){wo(v,I+4,1,oe,8,de,ue,ve),wo(M,G+4,1,oe,8,de,ue,ve)}function At(){this.ba=new Qt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Kn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Pt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function an(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function pn(){this.ua=0,this.Wa=new Dt,this.vb=new Dt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new nt,this.yc=new le}function Vn(){this.xb=this.a=0,this.l=new jr,this.ca=new Qt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ee,this.Pb=0,this.wd=new Ee,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new pn,this.ab=0,this.gc=l(4,an),this.Oc=0}function Rn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new jr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Si(v,I,M,G,oe,de,ue){for(v=v==null?0:v[I+0],I=0;I<ue;++I)oe[de+I]=v+M[G+I]&255,v=oe[de+I]}function Ar(v,I,M,G,oe,de,ue){var ve;if(v==null)Si(null,null,M,G,oe,de,ue);else for(ve=0;ve<ue;++ve)oe[de+ve]=v[I+ve]+M[G+ve]&255}function fr(v,I,M,G,oe,de,ue){if(v==null)Si(null,null,M,G,oe,de,ue);else{var ve,xe=v[I+0],Re=xe,Ue=xe;for(ve=0;ve<ue;++ve)Re=Ue+(xe=v[I+ve])-Re,Ue=M[G+ve]+(-256&Re?0>Re?0:255:Re)&255,Re=xe,oe[de+ve]=Ue}}function E(v,I,M,G){var oe=I.width,de=I.o;if(e(v!=null&&I!=null),0>M||0>=G||M+G>de)return null;if(!v.Cc){if(v.ga==null){var ue;if(v.ga=new Rn,(ue=v.ga==null)||(ue=I.width*I.o,e(v.Gb.length==0),v.Gb=s(ue),v.Uc=0,v.Gb==null?ue=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,ue=1),ue=!ue),!ue){ue=v.ga;var ve=v.Fa,xe=v.P,Re=v.qc,Ue=v.mb,Xe=v.nb,Ae=xe+1,He=Re-1,et=ue.l;if(e(ve!=null&&Ue!=null&&I!=null),y[0]=null,y[1]=Si,y[2]=Ar,y[3]=fr,ue.ca=Ue,ue.tb=Xe,ue.c=I.width,ue.i=I.height,e(0<ue.c&&0<ue.i),1>=Re)I=0;else if(ue.$a=3&ve[xe+0],ue.Z=ve[xe+0]>>2&3,ue.Lc=ve[xe+0]>>4&3,xe=ve[xe+0]>>6&3,0>ue.$a||1<ue.$a||4<=ue.Z||1<ue.Lc||xe)I=0;else if(et.put=dn,et.ac=Ci,et.bc=Aa,et.ma=ue,et.width=I.width,et.height=I.height,et.Da=I.Da,et.v=I.v,et.va=I.va,et.j=I.j,et.o=I.o,ue.$a)e:{e(ue.$a==1),I=Va();t:for(;;){if(I==null){I=0;break e}if(e(ue!=null),ue.mc=I,I.c=ue.c,I.i=ue.i,I.l=ue.l,I.l.ma=ue,I.l.width=ue.c,I.l.height=ue.i,I.a=0,ot(I.m,ve,Ae,He),!ys(ue.c,ue.i,1,I,null)||(I.ab==1&&I.gc[0].hc==3&&qi(I.s)?(ue.ic=1,ve=I.c*I.i,I.Ta=null,I.Ua=0,I.V=s(ve),I.Ba=0,I.V==null?(I.a=1,I=0):I=1):(ue.ic=0,I=es(I,ue.c)),!I))break t;I=1;break e}ue.mc=null,I=0}else I=He>=ue.c*ue.i;ue=!I}if(ue)return null;v.ga.Lc!=1?v.Ga=0:G=de-M}e(v.ga!=null),e(M+G<=de);e:{if(I=(ve=v.ga).c,de=ve.l.o,ve.$a==0){if(Ae=v.rc,He=v.Vc,et=v.Fa,xe=v.P+1+M*I,Re=v.mb,Ue=v.nb+M*I,e(xe<=v.P+v.qc),ve.Z!=0)for(e(y[ve.Z]!=null),ue=0;ue<G;++ue)y[ve.Z](Ae,He,et,xe,Re,Ue,I),Ae=Re,He=Ue,Ue+=I,xe+=I;else for(ue=0;ue<G;++ue)n(Re,Ue,et,xe,I),Ae=Re,He=Ue,Ue+=I,xe+=I;v.rc=Ae,v.Vc=He}else{if(e(ve.mc!=null),I=M+G,e((ue=ve.mc)!=null),e(I<=ue.i),ue.C>=I)I=1;else if(ve.ic||ft(),ve.ic){ve=ue.V,Ae=ue.Ba,He=ue.c;var at=ue.i,Ze=(et=1,xe=ue.$/He,Re=ue.$%He,Ue=ue.m,Xe=ue.s,ue.$),gt=He*at,wt=He*I,Lt=Xe.wc,ht=Ze<wt?cr(Xe,Re,xe):null;e(Ze<=gt),e(I<=at),e(qi(Xe));t:for(;;){for(;!Ue.h&&Ze<wt;){if(Re&Lt||(ht=cr(Xe,Re,xe)),e(ht!=null),Ye(Ue),256>(at=Pi(ht.G[0],ht.H[0],Ue)))ve[Ae+Ze]=at,++Ze,++Re>=He&&(Re=0,++xe<=I&&!(xe%16)&&Kr(ue,xe));else{if(!(280>at)){et=0;break t}at=Rr(at-256,Ue);var Ut,Bt=Pi(ht.G[4],ht.H[4],Ue);if(Ye(Ue),!(Ze>=(Bt=ms(He,Bt=Rr(Bt,Ue)))&&gt-Ze>=at)){et=0;break t}for(Ut=0;Ut<at;++Ut)ve[Ae+Ze+Ut]=ve[Ae+Ze+Ut-Bt];for(Ze+=at,Re+=at;Re>=He;)Re-=He,++xe<=I&&!(xe%16)&&Kr(ue,xe);Ze<wt&&Re&Lt&&(ht=cr(Xe,Re,xe))}e(Ue.h==Be(Ue))}Kr(ue,xe>I?I:xe);break t}!et||Ue.h&&Ze<gt?(et=0,ue.a=Ue.h?5:3):ue.$=Ze,I=et}else I=ls(ue,ue.V,ue.Ba,ue.c,ue.i,I,to);if(!I){G=0;break e}}M+G>=de&&(v.Cc=1),G=1}if(!G)return null;if(v.Cc&&((G=v.ga)!=null&&(G.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+M*oe}function K(v,I,M,G,oe,de){for(;0<oe--;){var ue,ve=v,xe=I+(M?1:0),Re=v,Ue=I+(M?0:3);for(ue=0;ue<G;++ue){var Xe=Re[Ue+4*ue];Xe!=255&&(Xe*=32897,ve[xe+4*ue+0]=ve[xe+4*ue+0]*Xe>>23,ve[xe+4*ue+1]=ve[xe+4*ue+1]*Xe>>23,ve[xe+4*ue+2]=ve[xe+4*ue+2]*Xe>>23)}I+=de}}function ne(v,I,M,G,oe){for(;0<G--;){var de;for(de=0;de<M;++de){var ue=v[I+2*de+0],ve=15&(Re=v[I+2*de+1]),xe=4369*ve,Re=(240&Re|Re>>4)*xe>>16;v[I+2*de+0]=(240&ue|ue>>4)*xe>>16&240|(15&ue|ue<<4)*xe>>16>>4&15,v[I+2*de+1]=240&Re|ve}I+=oe}}function Ie(v,I,M,G,oe,de,ue,ve){var xe,Re,Ue=255;for(Re=0;Re<oe;++Re){for(xe=0;xe<G;++xe){var Xe=v[I+xe];de[ue+4*xe]=Xe,Ue&=Xe}I+=M,ue+=ve}return Ue!=255}function st(v,I,M,G,oe){var de;for(de=0;de<oe;++de)M[G+de]=v[I+de]>>8}function ft(){gu=K,So=ne,Hl=Ie,lo=st}function jt(v,I,M){J[v]=function(G,oe,de,ue,ve,xe,Re,Ue,Xe,Ae,He,et,at,Ze,gt,wt,Lt){var ht,Ut=Lt-1>>1,Bt=ve[xe+0]|Re[Ue+0]<<16,An=Xe[Ae+0]|He[et+0]<<16;e(G!=null);var Zt=3*Bt+An+131074>>2;for(I(G[oe+0],255&Zt,Zt>>16,at,Ze),de!=null&&(Zt=3*An+Bt+131074>>2,I(de[ue+0],255&Zt,Zt>>16,gt,wt)),ht=1;ht<=Ut;++ht){var vi=ve[xe+ht]|Re[Ue+ht]<<16,Ui=Xe[Ae+ht]|He[et+ht]<<16,si=Bt+vi+An+Ui+524296,nn=si+2*(vi+An)>>3;Zt=nn+Bt>>1,Bt=(si=si+2*(Bt+Ui)>>3)+vi>>1,I(G[oe+2*ht-1],255&Zt,Zt>>16,at,Ze+(2*ht-1)*M),I(G[oe+2*ht-0],255&Bt,Bt>>16,at,Ze+(2*ht-0)*M),de!=null&&(Zt=si+An>>1,Bt=nn+Ui>>1,I(de[ue+2*ht-1],255&Zt,Zt>>16,gt,wt+(2*ht-1)*M),I(de[ue+2*ht+0],255&Bt,Bt>>16,gt,wt+(2*ht+0)*M)),Bt=vi,An=Ui}1&Lt||(Zt=3*Bt+An+131074>>2,I(G[oe+Lt-1],255&Zt,Zt>>16,at,Ze+(Lt-1)*M),de!=null&&(Zt=3*An+Bt+131074>>2,I(de[ue+Lt-1],255&Zt,Zt>>16,gt,wt+(Lt-1)*M)))}}function Zn(){N[gc]=L,N[aa]=z,N[mc]=F,N[co]=P,N[Kl]=k,N[Vu]=R,N[El]=S,N[zu]=z,N[yc]=P,N[_u]=k,N[vc]=R}function lr(v){return v&-16384?0>v?0:255:v>>ie}function ui(v,I){return lr((19077*v>>8)+(26149*I>>8)-14234)}function nr(v,I,M){return lr((19077*v>>8)-(6419*I>>8)-(13320*M>>8)+8708)}function $s(v,I){return lr((19077*v>>8)+(33050*I>>8)-17685)}function ra(v,I,M,G,oe){G[oe+0]=ui(v,M),G[oe+1]=nr(v,I,M),G[oe+2]=$s(v,I)}function xr(v,I,M,G,oe){G[oe+0]=$s(v,I),G[oe+1]=nr(v,I,M),G[oe+2]=ui(v,M)}function sa(v,I,M,G,oe){var de=nr(v,I,M);I=de<<3&224|$s(v,I)>>3,G[oe+0]=248&ui(v,M)|de>>5,G[oe+1]=I}function Ga(v,I,M,G,oe){var de=240&$s(v,I)|15;G[oe+0]=240&ui(v,M)|nr(v,I,M)>>4,G[oe+1]=de}function Uo(v,I,M,G,oe){G[oe+0]=255,ra(v,I,M,G,oe+1)}function nl(v,I,M,G,oe){xr(v,I,M,G,oe),G[oe+3]=255}function ya(v,I,M,G,oe){ra(v,I,M,G,oe),G[oe+3]=255}function xl(v,I,M){J[v]=function(G,oe,de,ue,ve,xe,Re,Ue,Xe){for(var Ae=Ue+(-2&Xe)*M;Ue!=Ae;)I(G[oe+0],de[ue+0],ve[xe+0],Re,Ue),I(G[oe+1],de[ue+0],ve[xe+0],Re,Ue+M),oe+=2,++ue,++xe,Ue+=2*M;1&Xe&&I(G[oe+0],de[ue+0],ve[xe+0],Re,Ue)}}function Mu(v,I,M){return M==0?v==0?I==0?6:5:I==0?4:0:M}function cc(v,I,M,G,oe){switch(v>>>30){case 3:Wn(I,M,G,oe,0);break;case 2:Ti(I,M,G,oe);break;case 1:Li(I,M,G,oe)}}function so(v,I){var M,G,oe=I.M,de=I.Nb,ue=v.oc,ve=v.pc+40,xe=v.oc,Re=v.pc+584,Ue=v.oc,Xe=v.pc+600;for(M=0;16>M;++M)ue[ve+32*M-1]=129;for(M=0;8>M;++M)xe[Re+32*M-1]=129,Ue[Xe+32*M-1]=129;for(0<oe?ue[ve-1-32]=xe[Re-1-32]=Ue[Xe-1-32]=129:(r(ue,ve-32-1,127,21),r(xe,Re-32-1,127,9),r(Ue,Xe-32-1,127,9)),G=0;G<v.za;++G){var Ae=I.ya[I.aa+G];if(0<G){for(M=-1;16>M;++M)n(ue,ve+32*M-4,ue,ve+32*M+12,4);for(M=-1;8>M;++M)n(xe,Re+32*M-4,xe,Re+32*M+4,4),n(Ue,Xe+32*M-4,Ue,Xe+32*M+4,4)}var He=v.Gd,et=v.Hd+G,at=Ae.ad,Ze=Ae.Hc;if(0<oe&&(n(ue,ve-32,He[et].y,0,16),n(xe,Re-32,He[et].f,0,8),n(Ue,Xe-32,He[et].ea,0,8)),Ae.Za){var gt=ue,wt=ve-32+16;for(0<oe&&(G>=v.za-1?r(gt,wt,He[et].y[15],4):n(gt,wt,He[et+1].y,0,4)),M=0;4>M;M++)gt[wt+128+M]=gt[wt+256+M]=gt[wt+384+M]=gt[wt+0+M];for(M=0;16>M;++M,Ze<<=2)gt=ue,wt=ve+Q[M],ns[Ae.Ob[M]](gt,wt),cc(Ze,at,16*+M,gt,wt)}else if(gt=Mu(G,oe,Ae.Ob[0]),La[gt](ue,ve),Ze!=0)for(M=0;16>M;++M,Ze<<=2)cc(Ze,at,16*+M,ue,ve+Q[M]);for(M=Ae.Gc,gt=Mu(G,oe,Ae.Dd),O[gt](xe,Re),O[gt](Ue,Xe),Ze=at,gt=xe,wt=Re,255&(Ae=0|M)&&(170&Ae?ts(Ze,256,gt,wt):zi(Ze,256,gt,wt)),Ae=Ue,Ze=Xe,255&(M>>=8)&&(170&M?ts(at,320,Ae,Ze):zi(at,320,Ae,Ze)),oe<v.Ub-1&&(n(He[et].y,0,ue,ve+480,16),n(He[et].f,0,xe,Re+224,8),n(He[et].ea,0,Ue,Xe+224,8)),M=8*de*v.B,He=v.sa,et=v.ta+16*G+16*de*v.R,at=v.qa,Ae=v.ra+8*G+M,Ze=v.Ha,gt=v.Ia+8*G+M,M=0;16>M;++M)n(He,et+M*v.R,ue,ve+32*M,16);for(M=0;8>M;++M)n(at,Ae+M*v.B,xe,Re+32*M,8),n(Ze,gt+M*v.B,Ue,Xe+32*M,8)}}function Bo(v,I,M,G,oe,de,ue,ve,xe){var Re=[0],Ue=[0],Xe=0,Ae=xe!=null?xe.kd:0,He=xe??new Pt;if(v==null||12>M)return 7;He.data=v,He.w=I,He.ha=M,I=[I],M=[M],He.gb=[He.gb];e:{var et=I,at=M,Ze=He.gb;if(e(v!=null),e(at!=null),e(Ze!=null),Ze[0]=0,12<=at[0]&&!t(v,et[0],"RIFF")){if(t(v,et[0]+8,"WEBP")){Ze=3;break e}var gt=Et(v,et[0]+4);if(12>gt||4294967286<gt){Ze=3;break e}if(Ae&&gt>at[0]-8){Ze=7;break e}Ze[0]=gt,et[0]+=12,at[0]-=12}Ze=0}if(Ze!=0)return Ze;for(gt=0<He.gb[0],M=M[0];;){e:{var wt=v;at=I,Ze=M;var Lt=Re,ht=Ue,Ut=et=[0];if((Zt=Xe=[Xe])[0]=0,8>Ze[0])Ze=7;else{if(!t(wt,at[0],"VP8X")){if(Et(wt,at[0]+4)!=10){Ze=3;break e}if(18>Ze[0]){Ze=7;break e}var Bt=Et(wt,at[0]+8),An=1+qt(wt,at[0]+12);if(2147483648<=An*(wt=1+qt(wt,at[0]+15))){Ze=3;break e}Ut!=null&&(Ut[0]=Bt),Lt!=null&&(Lt[0]=An),ht!=null&&(ht[0]=wt),at[0]+=18,Ze[0]-=18,Zt[0]=1}Ze=0}}if(Xe=Xe[0],et=et[0],Ze!=0)return Ze;if(at=!!(2&et),!gt&&Xe)return 3;if(de!=null&&(de[0]=!!(16&et)),ue!=null&&(ue[0]=at),ve!=null&&(ve[0]=0),ue=Re[0],et=Ue[0],Xe&&at&&xe==null){Ze=0;break}if(4>M){Ze=7;break}if(gt&&Xe||!gt&&!Xe&&!t(v,I[0],"ALPH")){M=[M],He.na=[He.na],He.P=[He.P],He.Sa=[He.Sa];e:{Bt=v,Ze=I,gt=M;var Zt=He.gb;Lt=He.na,ht=He.P,Ut=He.Sa,An=22,e(Bt!=null),e(gt!=null),wt=Ze[0];var vi=gt[0];for(e(Lt!=null),e(Ut!=null),Lt[0]=null,ht[0]=null,Ut[0]=0;;){if(Ze[0]=wt,gt[0]=vi,8>vi){Ze=7;break e}var Ui=Et(Bt,wt+4);if(4294967286<Ui){Ze=3;break e}var si=8+Ui+1&-2;if(An+=si,0<Zt&&An>Zt){Ze=3;break e}if(!t(Bt,wt,"VP8 ")||!t(Bt,wt,"VP8L")){Ze=0;break e}if(vi[0]<si){Ze=7;break e}t(Bt,wt,"ALPH")||(Lt[0]=Bt,ht[0]=wt+8,Ut[0]=Ui),wt+=si,vi-=si}}if(M=M[0],He.na=He.na[0],He.P=He.P[0],He.Sa=He.Sa[0],Ze!=0)break}M=[M],He.Ja=[He.Ja],He.xa=[He.xa];e:if(Zt=v,Ze=I,gt=M,Lt=He.gb[0],ht=He.Ja,Ut=He.xa,Bt=Ze[0],wt=!t(Zt,Bt,"VP8 "),An=!t(Zt,Bt,"VP8L"),e(Zt!=null),e(gt!=null),e(ht!=null),e(Ut!=null),8>gt[0])Ze=7;else{if(wt||An){if(Zt=Et(Zt,Bt+4),12<=Lt&&Zt>Lt-12){Ze=3;break e}if(Ae&&Zt>gt[0]-8){Ze=7;break e}ht[0]=Zt,Ze[0]+=8,gt[0]-=8,Ut[0]=An}else Ut[0]=5<=gt[0]&&Zt[Bt+0]==47&&!(Zt[Bt+4]>>5),ht[0]=gt[0];Ze=0}if(M=M[0],He.Ja=He.Ja[0],He.xa=He.xa[0],I=I[0],Ze!=0)break;if(4294967286<He.Ja)return 3;if(ve==null||at||(ve[0]=He.xa?2:1),ue=[ue],et=[et],He.xa){if(5>M){Ze=7;break}ve=ue,Ae=et,at=de,v==null||5>M?v=0:5<=M&&v[I+0]==47&&!(v[I+4]>>5)?(gt=[0],Zt=[0],Lt=[0],ot(ht=new Ee,v,I,M),ta(ht,gt,Zt,Lt)?(ve!=null&&(ve[0]=gt[0]),Ae!=null&&(Ae[0]=Zt[0]),at!=null&&(at[0]=Lt[0]),v=1):v=0):v=0}else{if(10>M){Ze=7;break}ve=et,v==null||10>M||!Ea(v,I+3,M-3)?v=0:(Ae=v[I+0]|v[I+1]<<8|v[I+2]<<16,at=16383&(v[I+7]<<8|v[I+6]),v=16383&(v[I+9]<<8|v[I+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=He.Ja||!at||!v?v=0:(ue&&(ue[0]=at),ve&&(ve[0]=v),v=1))}if(!v||(ue=ue[0],et=et[0],Xe&&(Re[0]!=ue||Ue[0]!=et)))return 3;xe!=null&&(xe[0]=He,xe.offset=I-xe.w,e(4294967286>I-xe.w),e(xe.offset==xe.ha-M));break}return Ze==0||Ze==7&&Xe&&xe==null?(de!=null&&(de[0]|=He.na!=null&&0<He.na.length),G!=null&&(G[0]=ue),oe!=null&&(oe[0]=et),0):Ze}function wl(v,I,M){var G=I.width,oe=I.height,de=0,ue=0,ve=G,xe=oe;if(I.Da=v!=null&&0<v.Da,I.Da&&(ve=v.cd,xe=v.bd,de=v.v,ue=v.j,11>M||(de&=-2,ue&=-2),0>de||0>ue||0>=ve||0>=xe||de+ve>G||ue+xe>oe))return 0;if(I.v=de,I.j=ue,I.va=de+ve,I.o=ue+xe,I.U=ve,I.T=xe,I.da=v!=null&&0<v.da,I.da){if(!wn(ve,xe,M=[v.ib],de=[v.hb]))return 0;I.ib=M[0],I.hb=de[0]}return I.ob=v!=null&&v.ob,I.Kb=v==null||!v.Sd,I.da&&(I.ob=I.ib<3*G/4&&I.hb<3*oe/4,I.Kb=0),1}function hc(v){if(v==null)return 2;if(11>v.S){var I=v.f.RGBA;I.fb+=(v.height-1)*I.A,I.A=-I.A}else I=v.f.kb,v=v.height,I.O+=(v-1)*I.fa,I.fa=-I.fa,I.N+=(v-1>>1)*I.Ab,I.Ab=-I.Ab,I.W+=(v-1>>1)*I.Db,I.Db=-I.Db,I.F!=null&&(I.J+=(v-1)*I.lb,I.lb=-I.lb);return 0}function $o(v,I,M,G){if(G==null||0>=v||0>=I)return 2;if(M!=null){if(M.Da){var oe=M.cd,de=M.bd,ue=-2&M.v,ve=-2&M.j;if(0>ue||0>ve||0>=oe||0>=de||ue+oe>v||ve+de>I)return 2;v=oe,I=de}if(M.da){if(!wn(v,I,oe=[M.ib],de=[M.hb]))return 2;v=oe[0],I=de[0]}}G.width=v,G.height=I;e:{var xe=G.width,Re=G.height;if(v=G.S,0>=xe||0>=Re||!(v>=gc&&13>v))v=2;else{if(0>=G.Rd&&G.sd==null){ue=de=oe=I=0;var Ue=(ve=xe*bt[v])*Re;if(11>v||(de=(Re+1)/2*(I=(xe+1)/2),v==12&&(ue=(oe=xe)*Re)),(Re=s(Ue+2*de+ue))==null){v=1;break e}G.sd=Re,11>v?((xe=G.f.RGBA).eb=Re,xe.fb=0,xe.A=ve,xe.size=Ue):((xe=G.f.kb).y=Re,xe.O=0,xe.fa=ve,xe.Fd=Ue,xe.f=Re,xe.N=0+Ue,xe.Ab=I,xe.Cd=de,xe.ea=Re,xe.W=0+Ue+de,xe.Db=I,xe.Ed=de,v==12&&(xe.F=Re,xe.J=0+Ue+2*de),xe.Tc=ue,xe.lb=oe)}if(I=1,oe=G.S,de=G.width,ue=G.height,oe>=gc&&13>oe)if(11>oe)v=G.f.RGBA,I&=(ve=Math.abs(v.A))*(ue-1)+de<=v.size,I&=ve>=de*bt[oe],I&=v.eb!=null;else{v=G.f.kb,ve=(de+1)/2,Ue=(ue+1)/2,xe=Math.abs(v.fa),Re=Math.abs(v.Ab);var Xe=Math.abs(v.Db),Ae=Math.abs(v.lb),He=Ae*(ue-1)+de;I&=xe*(ue-1)+de<=v.Fd,I&=Re*(Ue-1)+ve<=v.Cd,I=(I&=Xe*(Ue-1)+ve<=v.Ed)&xe>=de&Re>=ve&Xe>=ve,I&=v.y!=null,I&=v.f!=null,I&=v.ea!=null,oe==12&&(I&=Ae>=de,I&=He<=v.Tc,I&=v.F!=null)}else I=0;v=I?0:2}}return v!=0||M!=null&&M.fd&&(v=hc(G)),v}var $l=64,Ha=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ra=24,Go=32,il=8,rl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Xt("Predictor0","PredictorAdd0"),J.Predictor0=function(){return 4278190080},J.Predictor1=function(v){return v},J.Predictor2=function(v,I,M){return I[M+0]},J.Predictor3=function(v,I,M){return I[M+1]},J.Predictor4=function(v,I,M){return I[M-1]},J.Predictor5=function(v,I,M){return bn(bn(v,I[M+1]),I[M+0])},J.Predictor6=function(v,I,M){return bn(v,I[M-1])},J.Predictor7=function(v,I,M){return bn(v,I[M+0])},J.Predictor8=function(v,I,M){return bn(I[M-1],I[M+0])},J.Predictor9=function(v,I,M){return bn(I[M+0],I[M+1])},J.Predictor10=function(v,I,M){return bn(bn(v,I[M-1]),bn(I[M+0],I[M+1]))},J.Predictor11=function(v,I,M){var G=I[M+0];return 0>=Bn(G>>24&255,v>>24&255,(I=I[M-1])>>24&255)+Bn(G>>16&255,v>>16&255,I>>16&255)+Bn(G>>8&255,v>>8&255,I>>8&255)+Bn(255&G,255&v,255&I)?G:v},J.Predictor12=function(v,I,M){var G=I[M+0];return(Un((v>>24&255)+(G>>24&255)-((I=I[M-1])>>24&255))<<24|Un((v>>16&255)+(G>>16&255)-(I>>16&255))<<16|Un((v>>8&255)+(G>>8&255)-(I>>8&255))<<8|Un((255&v)+(255&G)-(255&I)))>>>0},J.Predictor13=function(v,I,M){var G=I[M-1];return(ii((v=bn(v,I[M+0]))>>24&255,G>>24&255)<<24|ii(v>>16&255,G>>16&255)<<16|ii(v>>8&255,G>>8&255)<<8|ii(255&v,255&G))>>>0};var Fu=J.PredictorAdd0;J.PredictorAdd1=li,Xt("Predictor2","PredictorAdd2"),Xt("Predictor3","PredictorAdd3"),Xt("Predictor4","PredictorAdd4"),Xt("Predictor5","PredictorAdd5"),Xt("Predictor6","PredictorAdd6"),Xt("Predictor7","PredictorAdd7"),Xt("Predictor8","PredictorAdd8"),Xt("Predictor9","PredictorAdd9"),Xt("Predictor10","PredictorAdd10"),Xt("Predictor11","PredictorAdd11"),Xt("Predictor12","PredictorAdd12"),Xt("Predictor13","PredictorAdd13");var fu=J.PredictorAdd2;cn("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),cn("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var cs,dc=J.ColorIndexInverseTransform,sl=J.MapARGB,Is=J.VP8LColorIndexInverseTransformAlpha,ks=J.MapAlpha,Sl=J.VP8LPredictorsAdd=[];Sl.length=16,(J.VP8LPredictors=[]).length=16,(J.VP8LPredictorsAdd_C=[]).length=16,(J.VP8LPredictors_C=[]).length=16;var ao,ju,Ho,oo,al,Gl,Ka,Wn,Ti,ts,Li,zi,Er,hs,ol,Ko,pu,fc,fd,gf,mf,yf,pd,gd,gu,So,Hl,lo,mu=s(511),pc=s(2041),yu=s(225),vu=s(767),Tl=0,uo=pc,Al=yu,Gs=vu,Hs=mu,gc=0,aa=1,mc=2,co=3,Kl=4,Vu=5,El=6,zu=7,yc=8,_u=9,vc=10,To=[2,3,7],Uu=[3,3,11],bu=[280,256,256,256,40],sh=[0,1,1,1,0],_c=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ao=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Wa=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wl=8,ho=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Eo=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],fo=null,bc=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],md=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ah=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],yd=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],oa=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Dr=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],yi=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],La=[],ns=[],O=[],d=1,p=2,y=[],N=[];jt("UpsampleRgbLinePair",ra,3),jt("UpsampleBgrLinePair",xr,3),jt("UpsampleRgbaLinePair",ya,4),jt("UpsampleBgraLinePair",nl,4),jt("UpsampleArgbLinePair",Uo,4),jt("UpsampleRgba4444LinePair",Ga,2),jt("UpsampleRgb565LinePair",sa,2);var L=J.UpsampleRgbLinePair,F=J.UpsampleBgrLinePair,z=J.UpsampleRgbaLinePair,P=J.UpsampleBgraLinePair,k=J.UpsampleArgbLinePair,R=J.UpsampleRgba4444LinePair,S=J.UpsampleRgb565LinePair,T=16,H=1<<T-1,te=-227,Se=482,ie=6,_e=0,Y=s(256),re=s(256),be=s(256),ke=s(256),it=s(Se-te),vt=s(Se-te);xl("YuvToRgbRow",ra,3),xl("YuvToBgrRow",xr,3),xl("YuvToRgbaRow",ya,4),xl("YuvToBgraRow",nl,4),xl("YuvToArgbRow",Uo,4),xl("YuvToRgba4444Row",Ga,2),xl("YuvToRgb565Row",sa,2);var Q=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],U=[0,2,8],Oe=[8,7,6,4,4,2,2,2,1,1,1,1],Fe=1;this.WebPDecodeRGBA=function(v,I,M,G,oe){var de=aa,ue=new At,ve=new Qt;ue.ba=ve,ve.S=de,ve.width=[ve.width],ve.height=[ve.height];var xe=ve.width,Re=ve.height,Ue=new Ht;if(Ue==null||v==null)var Xe=2;else e(Ue!=null),Xe=Bo(v,I,M,Ue.width,Ue.height,Ue.Pd,Ue.Qd,Ue.format,null);if(Xe!=0?xe=0:(xe!=null&&(xe[0]=Ue.width[0]),Re!=null&&(Re[0]=Ue.height[0]),xe=1),xe){ve.width=ve.width[0],ve.height=ve.height[0],G!=null&&(G[0]=ve.width),oe!=null&&(oe[0]=ve.height);e:{if(G=new jr,(oe=new Pt).data=v,oe.w=I,oe.ha=M,oe.kd=1,I=[0],e(oe!=null),((v=Bo(oe.data,oe.w,oe.ha,null,null,null,I,null,oe))==0||v==7)&&I[0]&&(v=4),(I=v)==0){if(e(ue!=null),G.data=oe.data,G.w=oe.w+oe.offset,G.ha=oe.ha-oe.offset,G.put=dn,G.ac=Ci,G.bc=Aa,G.ma=ue,oe.xa){if((v=Va())==null){ue=1;break e}if((function(Ae,He){var et=[0],at=[0],Ze=[0];t:for(;;){if(Ae==null)return 0;if(He==null)return Ae.a=2,0;if(Ae.l=He,Ae.a=0,ot(Ae.m,He.data,He.w,He.ha),!ta(Ae.m,et,at,Ze)){Ae.a=3;break t}if(Ae.xb=p,He.width=et[0],He.height=at[0],!ys(et[0],at[0],1,Ae,null))break t;return 1}return e(Ae.a!=0),0})(v,G)){if(G=(I=$o(G.width,G.height,ue.Oa,ue.ba))==0){t:{G=v;n:for(;;){if(G==null){G=0;break t}if(e(G.s.yc!=null),e(G.s.Ya!=null),e(0<G.s.Wb),e((M=G.l)!=null),e((oe=M.ma)!=null),G.xb!=0){if(G.ca=oe.ba,G.tb=oe.tb,e(G.ca!=null),!wl(oe.Oa,M,co)){G.a=2;break n}if(!es(G,M.width)||M.da)break n;if((M.da||Mn(G.ca.S))&&ft(),11>G.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),G.ca.f.kb.F!=null&&ft()),G.Pb&&0<G.s.ua&&G.s.vb.X==null&&!Pe(G.s.vb,G.s.Wa.Xa)){G.a=1;break n}G.xb=0}if(!ls(G,G.V,G.Ba,G.c,G.i,M.o,Zr))break n;oe.Dc=G.Ma,G=1;break t}e(G.a!=0),G=0}G=!G}G&&(I=v.a)}else I=v.a}else{if((v=new _r)==null){ue=1;break e}if(v.Fa=oe.na,v.P=oe.P,v.qc=oe.Sa,js(v,G)){if((I=$o(G.width,G.height,ue.Oa,ue.ba))==0){if(v.Aa=0,M=ue.Oa,e((oe=v)!=null),M!=null){if(0<(xe=0>(xe=M.Md)?0:100<xe?255:255*xe/100)){for(Re=Ue=0;4>Re;++Re)12>(Xe=oe.pb[Re]).lc&&(Xe.ia=xe*Oe[0>Xe.lc?0:Xe.lc]>>3),Ue|=Xe.ia;Ue&&(alert("todo:VP8InitRandom"),oe.ia=1)}oe.Ga=M.Id,100<oe.Ga?oe.Ga=100:0>oe.Ga&&(oe.Ga=0)}(function(Ae,He){if(Ae==null)return 0;if(He==null)return hn(Ae,2,"NULL VP8Io parameter in VP8Decode().");if(!Ae.cb&&!js(Ae,He))return 0;if(e(Ae.cb),He.ac==null||He.ac(He)){He.ob&&(Ae.L=0);var et=U[Ae.L];if(Ae.L==2?(Ae.yb=0,Ae.zb=0):(Ae.yb=He.v-et>>4,Ae.zb=He.j-et>>4,0>Ae.yb&&(Ae.yb=0),0>Ae.zb&&(Ae.zb=0)),Ae.Va=He.o+15+et>>4,Ae.Hb=He.va+15+et>>4,Ae.Hb>Ae.za&&(Ae.Hb=Ae.za),Ae.Va>Ae.Ub&&(Ae.Va=Ae.Ub),0<Ae.L){var at=Ae.ed;for(et=0;4>et;++et){var Ze;if(Ae.Qa.Cb){var gt=Ae.Qa.Lb[et];Ae.Qa.Fb||(gt+=at.Tb)}else gt=at.Tb;for(Ze=0;1>=Ze;++Ze){var wt=Ae.gd[et][Ze],Lt=gt;if(at.Pc&&(Lt+=at.vd[0],Ze&&(Lt+=at.od[0])),0<(Lt=0>Lt?0:63<Lt?63:Lt)){var ht=Lt;0<at.wb&&(ht=4<at.wb?ht>>2:ht>>1)>9-at.wb&&(ht=9-at.wb),1>ht&&(ht=1),wt.dd=ht,wt.tc=2*Lt+ht,wt.ld=40<=Lt?2:15<=Lt?1:0}else wt.tc=0;wt.La=Ze}}}et=0}else hn(Ae,6,"Frame setup failed"),et=Ae.a;if(et=et==0){if(et){Ae.$c=0,0<Ae.Aa||(Ae.Ic=Fe);t:{et=Ae.Ic,at=4*(ht=Ae.za);var Ut=32*ht,Bt=ht+1,An=0<Ae.L?ht*(0<Ae.Aa?2:1):0,Zt=(Ae.Aa==2?2:1)*ht;if((wt=at+832+(Ze=3*(16*et+U[Ae.L])/2*Ut)+(gt=Ae.Fa!=null&&0<Ae.Fa.length?Ae.Kc.c*Ae.Kc.i:0))!=wt)et=0;else{if(wt>Ae.Vb){if(Ae.Vb=0,Ae.Ec=s(wt),Ae.Fc=0,Ae.Ec==null){et=hn(Ae,1,"no memory during frame initialization.");break t}Ae.Vb=wt}wt=Ae.Ec,Lt=Ae.Fc,Ae.Ac=wt,Ae.Bc=Lt,Lt+=at,Ae.Gd=l(Ut,tl),Ae.Hd=0,Ae.rb=l(Bt+1,fa),Ae.sb=1,Ae.wa=An?l(An,Fs):null,Ae.Y=0,Ae.D.Nb=0,Ae.D.wa=Ae.wa,Ae.D.Y=Ae.Y,0<Ae.Aa&&(Ae.D.Y+=ht),e(!0),Ae.oc=wt,Ae.pc=Lt,Lt+=832,Ae.ya=l(Zt,Mo),Ae.aa=0,Ae.D.ya=Ae.ya,Ae.D.aa=Ae.aa,Ae.Aa==2&&(Ae.D.aa+=ht),Ae.R=16*ht,Ae.B=8*ht,ht=(Ut=U[Ae.L])*Ae.R,Ut=Ut/2*Ae.B,Ae.sa=wt,Ae.ta=Lt+ht,Ae.qa=Ae.sa,Ae.ra=Ae.ta+16*et*Ae.R+Ut,Ae.Ha=Ae.qa,Ae.Ia=Ae.ra+8*et*Ae.B+Ut,Ae.$c=0,Lt+=Ze,Ae.mb=gt?wt:null,Ae.nb=gt?Lt:null,e(Lt+gt<=Ae.Fc+Ae.Vb),za(Ae),r(Ae.Ac,Ae.Bc,0,at),et=1}}if(et){if(He.ka=0,He.y=Ae.sa,He.O=Ae.ta,He.f=Ae.qa,He.N=Ae.ra,He.ea=Ae.Ha,He.Vd=Ae.Ia,He.fa=Ae.R,He.Rc=Ae.B,He.F=null,He.J=0,!Tl){for(et=-255;255>=et;++et)mu[255+et]=0>et?-et:et;for(et=-1020;1020>=et;++et)pc[1020+et]=-128>et?-128:127<et?127:et;for(et=-112;112>=et;++et)yu[112+et]=-16>et?-16:15<et?15:et;for(et=-255;510>=et;++et)vu[255+et]=0>et?0:255<et?255:et;Tl=1}Ka=Oi,Wn=Vo,ts=br,Li=yl,zi=ia,Ti=Bl,Er=du,hs=ro,ol=fe,Ko=Me,pu=bl,fc=j,fd=We,gf=tt,mf=Cn,yf=Ri,pd=Es,gd=$a,ns[0]=pa,ns[1]=vl,ns[2]=Vs,ns[3]=io,ns[4]=Wr,ns[5]=ga,ns[6]=wi,ns[7]=ki,ns[8]=Ba,ns[9]=zs,La[0]=kn,La[1]=zo,La[2]=Ua,La[3]=It,La[4]=xi,La[5]=or,La[6]=Mi,O[0]=Ia,O[1]=_l,O[2]=Us,O[3]=fn,O[4]=Tr,O[5]=qr,O[6]=ka,et=1}else et=0}et&&(et=(function(vi,Ui){for(vi.M=0;vi.M<vi.Va;++vi.M){var si,nn=vi.Jc[vi.M&vi.Xb],Gt=vi.m,ei=vi;for(si=0;si<ei.za;++si){var Ln=Gt,Nn=ei,ur=Nn.Ac,is=Nn.Bc+4*si,Sn=Nn.zc,pr=Nn.ya[Nn.aa+si];if(Nn.Qa.Bb?pr.$b=Tt(Ln,Nn.Pa.jb[0])?2+Tt(Ln,Nn.Pa.jb[2]):Tt(Ln,Nn.Pa.jb[1]):pr.$b=0,Nn.kc&&(pr.Ad=Tt(Ln,Nn.Bd)),pr.Za=!Tt(Ln,145)+0,pr.Za){var vs=pr.Ob,va=0;for(Nn=0;4>Nn;++Nn){var zr,di=Sn[0+Nn];for(zr=0;4>zr;++zr){di=oa[ur[is+zr]][di];for(var Bi=ah[Tt(Ln,di[0])];0<Bi;)Bi=ah[2*Bi+Tt(Ln,di[Bi])];di=-Bi,ur[is+zr]=di}n(vs,va,ur,is,4),va+=4,Sn[0+Nn]=di}}else di=Tt(Ln,156)?Tt(Ln,128)?1:3:Tt(Ln,163)?2:0,pr.Ob[0]=di,r(ur,is,di,4),r(Sn,0,di,4);pr.Dd=Tt(Ln,142)?Tt(Ln,114)?Tt(Ln,183)?1:3:2:0}if(ei.m.Ka)return hn(vi,7,"Premature end-of-partition0 encountered.");for(;vi.ja<vi.za;++vi.ja){if(ei=nn,Ln=(Gt=vi).rb[Gt.sb-1],ur=Gt.rb[Gt.sb+Gt.ja],si=Gt.ya[Gt.aa+Gt.ja],is=Gt.kc?si.Ad:0)Ln.la=ur.la=0,si.Za||(Ln.Na=ur.Na=0),si.Hc=0,si.Gc=0,si.ia=0;else{var ir,sn;if(Ln=ur,ur=ei,is=Gt.Pa.Xc,Sn=Gt.ya[Gt.aa+Gt.ja],pr=Gt.pb[Sn.$b],Nn=Sn.ad,vs=0,va=Gt.rb[Gt.sb-1],di=zr=0,r(Nn,vs,0,384),Sn.Za)var Cs=0,Ir=is[3];else{Bi=s(16);var mi=Ln.Na+va.Na;if(mi=fo(ur,is[1],mi,pr.Eb,0,Bi,0),Ln.Na=va.Na=(0<mi)+0,1<mi)Ka(Bi,0,Nn,vs);else{var ds=Bi[0]+3>>3;for(Bi=0;256>Bi;Bi+=16)Nn[vs+Bi]=ds}Cs=1,Ir=is[0]}var Xi=15&Ln.la,Yr=15&va.la;for(Bi=0;4>Bi;++Bi){var fs=1&Yr;for(ds=sn=0;4>ds;++ds)Xi=Xi>>1|(fs=(mi=fo(ur,Ir,mi=fs+(1&Xi),pr.Sc,Cs,Nn,vs))>Cs)<<7,sn=sn<<2|(3<mi?3:1<mi?2:Nn[vs+0]!=0),vs+=16;Xi>>=4,Yr=Yr>>1|fs<<7,zr=(zr<<8|sn)>>>0}for(Ir=Xi,Cs=Yr>>4,ir=0;4>ir;ir+=2){for(sn=0,Xi=Ln.la>>4+ir,Yr=va.la>>4+ir,Bi=0;2>Bi;++Bi){for(fs=1&Yr,ds=0;2>ds;++ds)mi=fs+(1&Xi),Xi=Xi>>1|(fs=0<(mi=fo(ur,is[2],mi,pr.Qc,0,Nn,vs)))<<3,sn=sn<<2|(3<mi?3:1<mi?2:Nn[vs+0]!=0),vs+=16;Xi>>=2,Yr=Yr>>1|fs<<5}di|=sn<<4*ir,Ir|=Xi<<4<<ir,Cs|=(240&Yr)<<ir}Ln.la=Ir,va.la=Cs,Sn.Hc=zr,Sn.Gc=di,Sn.ia=43690&di?0:pr.ia,is=!(zr|di)}if(0<Gt.L&&(Gt.wa[Gt.Y+Gt.ja]=Gt.gd[si.$b][si.Za],Gt.wa[Gt.Y+Gt.ja].La|=!is),ei.Ka)return hn(vi,7,"Premature end-of-file encountered.")}if(za(vi),Gt=Ui,ei=1,si=(nn=vi).D,Ln=0<nn.L&&nn.M>=nn.zb&&nn.M<=nn.Va,nn.Aa==0)t:{if(si.M=nn.M,si.uc=Ln,so(nn,si),ei=1,si=(sn=nn.D).Nb,Ln=(di=U[nn.L])*nn.R,ur=di/2*nn.B,Bi=16*si*nn.R,ds=8*si*nn.B,is=nn.sa,Sn=nn.ta-Ln+Bi,pr=nn.qa,Nn=nn.ra-ur+ds,vs=nn.Ha,va=nn.Ia-ur+ds,Yr=(Xi=sn.M)==0,zr=Xi>=nn.Va-1,nn.Aa==2&&so(nn,sn),sn.uc)for(fs=(mi=nn).D.M,e(mi.D.uc),sn=mi.yb;sn<mi.Hb;++sn){Cs=sn,Ir=fs;var _i=(Fn=(_s=mi).D).Nb;ir=_s.R;var Fn=Fn.wa[Fn.Y+Cs],Rs=_s.sa,Xr=_s.ta+16*_i*ir+16*Cs,Pn=Fn.dd,zn=Fn.tc;if(zn!=0)if(e(3<=zn),_s.L==1)0<Cs&&yf(Rs,Xr,ir,zn+4),Fn.La&&gd(Rs,Xr,ir,zn),0<Ir&&mf(Rs,Xr,ir,zn+4),Fn.La&&pd(Rs,Xr,ir,zn);else{var Ji=_s.B,Da=_s.qa,po=_s.ra+8*_i*Ji+8*Cs,_a=_s.Ha,_s=_s.Ia+8*_i*Ji+8*Cs;_i=Fn.ld,0<Cs&&(hs(Rs,Xr,ir,zn+4,Pn,_i),Ko(Da,po,_a,_s,Ji,zn+4,Pn,_i)),Fn.La&&(fc(Rs,Xr,ir,zn,Pn,_i),gf(Da,po,_a,_s,Ji,zn,Pn,_i)),0<Ir&&(Er(Rs,Xr,ir,zn+4,Pn,_i),ol(Da,po,_a,_s,Ji,zn+4,Pn,_i)),Fn.La&&(pu(Rs,Xr,ir,zn,Pn,_i),fd(Da,po,_a,_s,Ji,zn,Pn,_i))}}if(nn.ia&&alert("todo:DitherRow"),Gt.put!=null){if(sn=16*Xi,Xi=16*(Xi+1),Yr?(Gt.y=nn.sa,Gt.O=nn.ta+Bi,Gt.f=nn.qa,Gt.N=nn.ra+ds,Gt.ea=nn.Ha,Gt.W=nn.Ia+ds):(sn-=di,Gt.y=is,Gt.O=Sn,Gt.f=pr,Gt.N=Nn,Gt.ea=vs,Gt.W=va),zr||(Xi-=di),Xi>Gt.o&&(Xi=Gt.o),Gt.F=null,Gt.J=null,nn.Fa!=null&&0<nn.Fa.length&&sn<Xi&&(Gt.J=E(nn,Gt,sn,Xi-sn),Gt.F=nn.mb,Gt.F==null&&Gt.F.length==0)){ei=hn(nn,3,"Could not decode alpha data.");break t}sn<Gt.j&&(di=Gt.j-sn,sn=Gt.j,e(!(1&di)),Gt.O+=nn.R*di,Gt.N+=nn.B*(di>>1),Gt.W+=nn.B*(di>>1),Gt.F!=null&&(Gt.J+=Gt.width*di)),sn<Xi&&(Gt.O+=Gt.v,Gt.N+=Gt.v>>1,Gt.W+=Gt.v>>1,Gt.F!=null&&(Gt.J+=Gt.v),Gt.ka=sn-Gt.j,Gt.U=Gt.va-Gt.v,Gt.T=Xi-sn,ei=Gt.put(Gt))}si+1!=nn.Ic||zr||(n(nn.sa,nn.ta-Ln,is,Sn+16*nn.R,Ln),n(nn.qa,nn.ra-ur,pr,Nn+8*nn.B,ur),n(nn.Ha,nn.Ia-ur,vs,va+8*nn.B,ur))}if(!ei)return hn(vi,6,"Output aborted.")}return 1})(Ae,He)),He.bc!=null&&He.bc(He),et&=1}return et?(Ae.cb=0,et):0})(v,G)||(I=v.a)}}else I=v.a}I==0&&ue.Oa!=null&&ue.Oa.fd&&(I=hc(ue.ba))}ue=I}de=ue!=0?null:11>de?ve.f.RGBA.eb:ve.f.kb.y}else de=null;return de};var bt=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(J,ye){for(var X="",ae=0;ae<4;ae++)X+=String.fromCharCode(J[ye++]);return X}function x(J,ye){return J[ye+0]|J[ye+1]<<8}function g(J,ye){return(J[ye+0]|J[ye+1]<<8|J[ye+2]<<16)>>>0}function w(J,ye){return(J[ye+0]|J[ye+1]<<8|J[ye+2]<<16|J[ye+3]<<24)>>>0}new h;var A=[0],B=[0],$=[],W=new h,q=i,ge=(function(J,ye){var X={},ae=0,le=!1,ze=0,nt=0;if(X.frames=[],!(function(se,Ee){for(var De=0;De<4;De++)if(se[Ee+De]!="RIFF".charCodeAt(De))return!0;return!1})(J,ye)){for(w(J,ye+=4),ye+=8;ye<J.length;){var je=f(J,ye),Je=w(J,ye+=4);ye+=4;var qe=Je+(1&Je);switch(je){case"VP8 ":case"VP8L":X.frames[ae]===void 0&&(X.frames[ae]={}),(Ne=X.frames[ae]).src_off=le?nt:ye-8,Ne.src_size=ze+Je+8,ae++,le&&(le=!1,ze=0,nt=0);break;case"VP8X":(Ne=X.header={}).feature_flags=J[ye];var ot=ye+4;Ne.canvas_width=1+g(J,ot),ot+=3,Ne.canvas_height=1+g(J,ot),ot+=3;break;case"ALPH":le=!0,ze=qe+8,nt=ye-8;break;case"ANIM":(Ne=X.header).bgcolor=w(J,ye),ot=ye+4,Ne.loop_count=x(J,ot),ot+=2;break;case"ANMF":var St,Ne;(Ne=X.frames[ae]={}).offset_x=2*g(J,ye),ye+=3,Ne.offset_y=2*g(J,ye),ye+=3,Ne.width=1+g(J,ye),ye+=3,Ne.height=1+g(J,ye),ye+=3,Ne.duration=g(J,ye),ye+=3,St=J[ye++],Ne.dispose=1&St,Ne.blend=St>>1&1}je!="ANMF"&&(ye+=qe)}return X}})(q,0);ge.response=q,ge.rgbaoutput=!0,ge.dataurl=!1;var he=ge.header?ge.header:null,me=ge.frames?ge.frames:null;if(he){he.loop_counter=he.loop_count,A=[he.canvas_height],B=[he.canvas_width];for(var Ce=0;Ce<me.length&&me[Ce].blend!=0;Ce++);}var Ve=me[0],pe=W.WebPDecodeRGBA(q,Ve.src_off,Ve.src_size,B,A);Ve.rgba=pe,Ve.imgwidth=B[0],Ve.imgheight=A[0];for(var ee=0;ee<B[0]*A[0]*4;ee++)$[ee]=pe[ee];return this.width=B,this.height=A,this.data=$,this}(function(i){var e,t,n,r,s,l,u,h,f,x=function(se){return se=se||{},this.isStrokeTransparent=se.isStrokeTransparent||!1,this.strokeOpacity=se.strokeOpacity||1,this.strokeStyle=se.strokeStyle||"#000000",this.fillStyle=se.fillStyle||"#000000",this.isFillTransparent=se.isFillTransparent||!1,this.fillOpacity=se.fillOpacity||1,this.font=se.font||"10px sans-serif",this.textBaseline=se.textBaseline||"alphabetic",this.textAlign=se.textAlign||"left",this.lineWidth=se.lineWidth||1,this.lineJoin=se.lineJoin||"miter",this.lineCap=se.lineCap||"butt",this.path=se.path||[],this.transform=se.transform!==void 0?se.transform.clone():new h,this.globalCompositeOperation=se.globalCompositeOperation||"normal",this.globalAlpha=se.globalAlpha||1,this.clip_path=se.clip_path||[],this.currentPoint=se.currentPoint||new l,this.miterLimit=se.miterLimit||10,this.lastPoint=se.lastPoint||new l,this.lineDashOffset=se.lineDashOffset||0,this.lineDash=se.lineDash||[],this.margin=se.margin||[0,0,0,0],this.prevPageLastElemOffset=se.prevPageLastElemOffset||0,this.ignoreClearRect=typeof se.ignoreClearRect!="boolean"||se.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,u=this.internal.Rectangle,h=this.internal.Matrix,f=new x}]);var g=function(se){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ee=se;Object.defineProperty(this,"pdf",{get:function(){return Ee}});var De=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return De},set:function(Pe){De=!!Pe}});var Be=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Be},set:function(Pe){Be=!!Pe}});var $e=0;Object.defineProperty(this,"posX",{get:function(){return $e},set:function(Pe){isNaN(Pe)||($e=Pe)}});var Ye=0;Object.defineProperty(this,"posY",{get:function(){return Ye},set:function(Pe){isNaN(Pe)||(Ye=Pe)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(Pe){var $t;typeof Pe=="number"?$t=[Pe,Pe,Pe,Pe]:(($t=new Array(4))[0]=Pe[0],$t[1]=Pe.length>=2?Pe[1]:$t[0],$t[2]=Pe.length>=3?Pe[2]:$t[0],$t[3]=Pe.length>=4?Pe[3]:$t[1]),f.margin=$t}});var ct=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ct},set:function(Pe){ct=Pe}});var ut=0;Object.defineProperty(this,"lastBreak",{get:function(){return ut},set:function(Pe){ut=Pe}});var Tt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Tt},set:function(Pe){Tt=Pe}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(Pe){Pe instanceof x&&(f=Pe)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(Pe){f.path=Pe}});var Ft=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ft},set:function(Pe){Ft=Pe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Pe){var $t;$t=w(Pe),this.ctx.fillStyle=$t.style,this.ctx.isFillTransparent=$t.a===0,this.ctx.fillOpacity=$t.a,this.pdf.setFillColor($t.r,$t.g,$t.b,{a:$t.a}),this.pdf.setTextColor($t.r,$t.g,$t.b,{a:$t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Pe){var $t=w(Pe);this.ctx.strokeStyle=$t.style,this.ctx.isStrokeTransparent=$t.a===0,this.ctx.strokeOpacity=$t.a,$t.a===0?this.pdf.setDrawColor(255,255,255):($t.a,this.pdf.setDrawColor($t.r,$t.g,$t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Pe){["butt","round","square"].indexOf(Pe)!==-1&&(this.ctx.lineCap=Pe,this.pdf.setLineCap(Pe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Pe){isNaN(Pe)||(this.ctx.lineWidth=Pe,this.pdf.setLineWidth(Pe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Pe){["bevel","round","miter"].indexOf(Pe)!==-1&&(this.ctx.lineJoin=Pe,this.pdf.setLineJoin(Pe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Pe){isNaN(Pe)||(this.ctx.miterLimit=Pe,this.pdf.setMiterLimit(Pe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Pe){this.ctx.textBaseline=Pe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Pe){["right","end","center","left","start"].indexOf(Pe)!==-1&&(this.ctx.textAlign=Pe)}});var Wt=null,qt=null,Et=null;Object.defineProperty(this,"fontFaces",{get:function(){return Et},set:function(Pe){Wt=null,qt=null,Et=Pe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Pe){var $t;if(this.ctx.font=Pe,($t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Pe))!==null){var Dt=$t[1];$t[2];var wn=$t[3],_t=$t[4];$t[5];var en=$t[6],Xt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(_t)[2];_t=Math.floor(Xt==="px"?parseFloat(_t)*this.pdf.internal.scaleFactor:Xt==="em"?parseFloat(_t)*this.pdf.getFontSize():parseFloat(_t)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(_t);var Tn=(function(cn){var er,Jn,mn=[],On=cn.trim();if(On==="")return Lb;if(On in Tk)return[Tk[On]];for(;On!=="";){switch(Jn=null,er=(On=Ek(On)).charAt(0)){case'"':case"'":Jn=bW(On.substring(1),er);break;default:Jn=xW(On)}if(Jn===null||(mn.push(Jn[0]),(On=Ek(Jn[1]))!==""&&On.charAt(0)!==","))return Lb;On=On.replace(/^,/,"")}return mn})(en);if(this.fontFaces){var bn=(function(cn,er){var Jn=cn.getFontList(),mn=JSON.stringify(Jn);if(Wt===null||qt!==mn){var On=(function(qn){var on=[];return Object.keys(qn).forEach(function(Ni){qn[Ni].forEach(function(Mn){var xn=null;switch(Mn){case"bold":xn={family:Ni,weight:"bold"};break;case"italic":xn={family:Ni,style:"italic"};break;case"bolditalic":xn={family:Ni,weight:"bold",style:"italic"};break;case"":case"normal":xn={family:Ni}}xn!==null&&(xn.ref={name:Ni,style:Mn},on.push(xn))})}),on})(Jn);Wt=(function(qn){for(var on={},Ni=0;Ni<qn.length;++Ni){var Mn=Rb(qn[Ni]),xn=Mn.family,Qn=Mn.stretch,Qt=Mn.style,Ht=Mn.weight;on[xn]=on[xn]||{},on[xn][Qn]=on[xn][Qn]||{},on[xn][Qn][Qt]=on[xn][Qn][Qt]||{},on[xn][Qn][Qt][Ht]=Mn}return on})(On.concat(er)),qt=mn}return Wt})(this.pdf,this.fontFaces),Un=Tn.map(function(cn){return{family:cn,stretch:"normal",weight:wn,style:Dt}}),ii=(function(cn,er,Jn){for(var mn=(Jn=Jn||{}).defaultFontFamily||"times",On=Object.assign({},_W,Jn.genericFontFamilies||{}),qn=null,on=null,Ni=0;Ni<er.length;++Ni)if(On[(qn=Rb(er[Ni])).family]&&(qn.family=On[qn.family]),cn.hasOwnProperty(qn.family)){on=cn[qn.family];break}if(!(on=on||cn[mn]))throw new Error("Could not find a font-family for the rule '"+Ak(qn)+"' and default family '"+mn+"'.");if(on=(function(Mn,xn){if(xn[Mn])return xn[Mn];var Qn=Kx[Mn],Qt=Qn<=Kx.normal?-1:1,Ht=Sk(xn,FD,Qn,Qt);if(!Ht)throw new Error("Could not find a matching font-stretch value for "+Mn);return Ht})(qn.stretch,on),on=(function(Mn,xn){if(xn[Mn])return xn[Mn];for(var Qn=MD[Mn],Qt=0;Qt<Qn.length;++Qt)if(xn[Qn[Qt]])return xn[Qn[Qt]];throw new Error("Could not find a matching font-style for "+Mn)})(qn.style,on),!(on=(function(Mn,xn){if(xn[Mn])return xn[Mn];if(Mn===400&&xn[500])return xn[500];if(Mn===500&&xn[400])return xn[400];var Qn=vW[Mn],Qt=Sk(xn,jD,Qn,Mn<400?-1:1);if(!Qt)throw new Error("Could not find a matching font-weight for value "+Mn);return Qt})(qn.weight,on)))throw new Error("Failed to resolve a font for the rule '"+Ak(qn)+"'.");return on})(bn,Un);this.pdf.setFont(ii.ref.name,ii.ref.style)}else{var Bn="";(wn==="bold"||parseInt(wn,10)>=700||Dt==="bold")&&(Bn="bold"),Dt==="italic"&&(Bn+="italic"),Bn.length===0&&(Bn="normal");for(var li="",Xn={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ln=0;ln<Tn.length;ln++){if(this.pdf.internal.getFont(Tn[ln],Bn,{noFallback:!0,disableWarning:!0})!==void 0){li=Tn[ln];break}if(Bn==="bolditalic"&&this.pdf.internal.getFont(Tn[ln],"bold",{noFallback:!0,disableWarning:!0})!==void 0)li=Tn[ln],Bn="bold";else if(this.pdf.internal.getFont(Tn[ln],"normal",{noFallback:!0,disableWarning:!0})!==void 0){li=Tn[ln],Bn="normal";break}}if(li===""){for(var $n=0;$n<Tn.length;$n++)if(Xn[Tn[$n]]){li=Xn[Tn[$n]];break}}li=li===""?"Times":li,this.pdf.setFont(li,Bn)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Pe){this.ctx.globalCompositeOperation=Pe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Pe){this.ctx.globalAlpha=Pe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Pe){this.ctx.lineDashOffset=Pe,Ne.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Pe){this.ctx.lineDash=Pe,Ne.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Pe){this.ctx.ignoreClearRect=!!Pe}})};g.prototype.setLineDash=function(se){this.lineDash=se},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){me.call(this,"fill",!1)},g.prototype.stroke=function(){me.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(se,Ee){if(isNaN(se)||isNaN(Ee))throw Qr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var De=this.ctx.transform.applyToPoint(new l(se,Ee));this.path.push({type:"mt",x:De.x,y:De.y}),this.ctx.lastPoint=new l(se,Ee)},g.prototype.closePath=function(){var se=new l(0,0),Ee=0;for(Ee=this.path.length-1;Ee!==-1;Ee--)if(this.path[Ee].type==="begin"&&Or(this.path[Ee+1])==="object"&&typeof this.path[Ee+1].x=="number"){se=new l(this.path[Ee+1].x,this.path[Ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(se.x,se.y)},g.prototype.lineTo=function(se,Ee){if(isNaN(se)||isNaN(Ee))throw Qr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var De=this.ctx.transform.applyToPoint(new l(se,Ee));this.path.push({type:"lt",x:De.x,y:De.y}),this.ctx.lastPoint=new l(De.x,De.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),me.call(this,null,!0)},g.prototype.quadraticCurveTo=function(se,Ee,De,Be){if(isNaN(De)||isNaN(Be)||isNaN(se)||isNaN(Ee))throw Qr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var $e=this.ctx.transform.applyToPoint(new l(De,Be)),Ye=this.ctx.transform.applyToPoint(new l(se,Ee));this.path.push({type:"qct",x1:Ye.x,y1:Ye.y,x:$e.x,y:$e.y}),this.ctx.lastPoint=new l($e.x,$e.y)},g.prototype.bezierCurveTo=function(se,Ee,De,Be,$e,Ye){if(isNaN($e)||isNaN(Ye)||isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be))throw Qr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ct=this.ctx.transform.applyToPoint(new l($e,Ye)),ut=this.ctx.transform.applyToPoint(new l(se,Ee)),Tt=this.ctx.transform.applyToPoint(new l(De,Be));this.path.push({type:"bct",x1:ut.x,y1:ut.y,x2:Tt.x,y2:Tt.y,x:ct.x,y:ct.y}),this.ctx.lastPoint=new l(ct.x,ct.y)},g.prototype.arc=function(se,Ee,De,Be,$e,Ye){if(isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be)||isNaN($e))throw Qr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ye=!!Ye,!this.ctx.transform.isIdentity){var ct=this.ctx.transform.applyToPoint(new l(se,Ee));se=ct.x,Ee=ct.y;var ut=this.ctx.transform.applyToPoint(new l(0,De)),Tt=this.ctx.transform.applyToPoint(new l(0,0));De=Math.sqrt(Math.pow(ut.x-Tt.x,2)+Math.pow(ut.y-Tt.y,2))}Math.abs($e-Be)>=2*Math.PI&&(Be=0,$e=2*Math.PI),this.path.push({type:"arc",x:se,y:Ee,radius:De,startAngle:Be,endAngle:$e,counterclockwise:Ye})},g.prototype.arcTo=function(se,Ee,De,Be,$e){throw new Error("arcTo not implemented.")},g.prototype.rect=function(se,Ee,De,Be){if(isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be))throw Qr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(se,Ee),this.lineTo(se+De,Ee),this.lineTo(se+De,Ee+Be),this.lineTo(se,Ee+Be),this.lineTo(se,Ee),this.lineTo(se+De,Ee),this.lineTo(se,Ee)},g.prototype.fillRect=function(se,Ee,De,Be){if(isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be))throw Qr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!A.call(this)){var $e={};this.lineCap!=="butt"&&($e.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&($e.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(se,Ee,De,Be),this.fill(),$e.hasOwnProperty("lineCap")&&(this.lineCap=$e.lineCap),$e.hasOwnProperty("lineJoin")&&(this.lineJoin=$e.lineJoin)}},g.prototype.strokeRect=function(se,Ee,De,Be){if(isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be))throw Qr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");B.call(this)||(this.beginPath(),this.rect(se,Ee,De,Be),this.stroke())},g.prototype.clearRect=function(se,Ee,De,Be){if(isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be))throw Qr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(se,Ee,De,Be))},g.prototype.save=function(se){se=typeof se!="boolean"||se;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,De=0;De<this.pdf.internal.getNumberOfPages();De++)this.pdf.setPage(De+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ee),se){this.ctx.fontSize=this.pdf.internal.getFontSize();var Be=new x(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Be}},g.prototype.restore=function(se){se=typeof se!="boolean"||se;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,De=0;De<this.pdf.internal.getNumberOfPages();De++)this.pdf.setPage(De+1),this.pdf.internal.out("Q");this.pdf.setPage(Ee),se&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var w=function(se){var Ee,De,Be,$e;if(se.isCanvasGradient===!0&&(se=se.getColor()),!se)return{r:0,g:0,b:0,a:0,style:se};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(se))Ee=0,De=0,Be=0,$e=0;else{var Ye=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(se);if(Ye!==null)Ee=parseInt(Ye[1]),De=parseInt(Ye[2]),Be=parseInt(Ye[3]),$e=1;else if((Ye=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(se))!==null)Ee=parseInt(Ye[1]),De=parseInt(Ye[2]),Be=parseInt(Ye[3]),$e=parseFloat(Ye[4]);else{if($e=1,typeof se=="string"&&se.charAt(0)!=="#"){var ct=new CD(se);se=ct.ok?ct.toHex():"#000000"}se.length===4?(Ee=se.substring(1,2),Ee+=Ee,De=se.substring(2,3),De+=De,Be=se.substring(3,4),Be+=Be):(Ee=se.substring(1,3),De=se.substring(3,5),Be=se.substring(5,7)),Ee=parseInt(Ee,16),De=parseInt(De,16),Be=parseInt(Be,16)}}return{r:Ee,g:De,b:Be,a:$e,style:se}},A=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},B=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(se,Ee,De,Be){if(isNaN(Ee)||isNaN(De)||typeof se!="string")throw Qr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Be=isNaN(Be)?void 0:Be,!A.call(this)){var $e=qe(this.ctx.transform.rotation),Ye=this.ctx.transform.scaleX;ae.call(this,{text:se,x:Ee,y:De,scale:Ye,angle:$e,align:this.textAlign,maxWidth:Be})}},g.prototype.strokeText=function(se,Ee,De,Be){if(isNaN(Ee)||isNaN(De)||typeof se!="string")throw Qr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!B.call(this)){Be=isNaN(Be)?void 0:Be;var $e=qe(this.ctx.transform.rotation),Ye=this.ctx.transform.scaleX;ae.call(this,{text:se,x:Ee,y:De,scale:Ye,renderingMode:"stroke",angle:$e,align:this.textAlign,maxWidth:Be})}},g.prototype.measureText=function(se){if(typeof se!="string")throw Qr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ee=this.pdf,De=this.pdf.internal.scaleFactor,Be=Ee.internal.getFontSize(),$e=Ee.getStringUnitWidth(se)*Be/Ee.internal.scaleFactor;return new function(Ye){var ct=(Ye=Ye||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ct}}),this}({width:$e*=Math.round(96*De/72*1e4)/1e4})},g.prototype.scale=function(se,Ee){if(isNaN(se)||isNaN(Ee))throw Qr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var De=new h(se,0,0,Ee,0,0);this.ctx.transform=this.ctx.transform.multiply(De)},g.prototype.rotate=function(se){if(isNaN(se))throw Qr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ee=new h(Math.cos(se),Math.sin(se),-Math.sin(se),Math.cos(se),0,0);this.ctx.transform=this.ctx.transform.multiply(Ee)},g.prototype.translate=function(se,Ee){if(isNaN(se)||isNaN(Ee))throw Qr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var De=new h(1,0,0,1,se,Ee);this.ctx.transform=this.ctx.transform.multiply(De)},g.prototype.transform=function(se,Ee,De,Be,$e,Ye){if(isNaN(se)||isNaN(Ee)||isNaN(De)||isNaN(Be)||isNaN($e)||isNaN(Ye))throw Qr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ct=new h(se,Ee,De,Be,$e,Ye);this.ctx.transform=this.ctx.transform.multiply(ct)},g.prototype.setTransform=function(se,Ee,De,Be,$e,Ye){se=isNaN(se)?1:se,Ee=isNaN(Ee)?0:Ee,De=isNaN(De)?0:De,Be=isNaN(Be)?1:Be,$e=isNaN($e)?0:$e,Ye=isNaN(Ye)?0:Ye,this.ctx.transform=new h(se,Ee,De,Be,$e,Ye)};var $=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(se,Ee,De,Be,$e,Ye,ct,ut,Tt){var Ft=this.pdf.getImageProperties(se),Wt=1,qt=1,Et=1,Pe=1;Be!==void 0&&ut!==void 0&&(Et=ut/Be,Pe=Tt/$e,Wt=Ft.width/Be*ut/Be,qt=Ft.height/$e*Tt/$e),Ye===void 0&&(Ye=Ee,ct=De,Ee=0,De=0),Be!==void 0&&ut===void 0&&(ut=Be,Tt=$e),Be===void 0&&ut===void 0&&(ut=Ft.width,Tt=Ft.height);var $t=this.ctx.transform.decompose(),Dt=qe($t.rotate.shx),wn=new h,_t=(wn=(wn=(wn=wn.multiply($t.translate)).multiply($t.skew)).multiply($t.scale)).applyToRectangle(new u(Ye-Ee*Et,ct-De*Pe,Be*Wt,$e*qt));if(this.autoPaging){for(var en,Xt=W.call(this,_t),Tn=[],bn=0;bn<Xt.length;bn+=1)Tn.indexOf(Xt[bn])===-1&&Tn.push(Xt[bn]);he(Tn);for(var Un=Tn[0],ii=Tn[Tn.length-1],Bn=Un;Bn<ii+1;Bn++){this.pdf.setPage(Bn);var li=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Xn=Bn===1?this.posY+this.margin[0]:this.margin[0],ln=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$n=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],cn=Bn===1?0:ln+(Bn-2)*$n;if(this.ctx.clip_path.length!==0){var er=this.path;en=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ge(en,this.posX+this.margin[3],-cn+Xn+this.ctx.prevPageLastElemOffset),Ce.call(this,"fill",!0),this.path=er}var Jn=JSON.parse(JSON.stringify(_t));Jn=ge([Jn],this.posX+this.margin[3],-cn+Xn+this.ctx.prevPageLastElemOffset)[0];var mn=(Bn>Un||Bn<ii)&&$.call(this);mn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],li,$n,null).clip().discardPath()),this.pdf.addImage(se,"JPEG",Jn.x,Jn.y,Jn.w,Jn.h,null,null,Dt),mn&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(se,"JPEG",_t.x,_t.y,_t.w,_t.h,null,null,Dt)};var W=function(se,Ee,De){var Be=[];Ee=Ee||this.pdf.internal.pageSize.width,De=De||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var $e=this.posY+this.ctx.prevPageLastElemOffset;switch(se.type){default:case"mt":case"lt":Be.push(Math.floor((se.y+$e)/De)+1);break;case"arc":Be.push(Math.floor((se.y+$e-se.radius)/De)+1),Be.push(Math.floor((se.y+$e+se.radius)/De)+1);break;case"qct":var Ye=ot(this.ctx.lastPoint.x,this.ctx.lastPoint.y,se.x1,se.y1,se.x,se.y);Be.push(Math.floor((Ye.y+$e)/De)+1),Be.push(Math.floor((Ye.y+Ye.h+$e)/De)+1);break;case"bct":var ct=St(this.ctx.lastPoint.x,this.ctx.lastPoint.y,se.x1,se.y1,se.x2,se.y2,se.x,se.y);Be.push(Math.floor((ct.y+$e)/De)+1),Be.push(Math.floor((ct.y+ct.h+$e)/De)+1);break;case"rect":Be.push(Math.floor((se.y+$e)/De)+1),Be.push(Math.floor((se.y+se.h+$e)/De)+1)}for(var ut=0;ut<Be.length;ut+=1)for(;this.pdf.internal.getNumberOfPages()<Be[ut];)q.call(this);return Be},q=function(){var se=this.fillStyle,Ee=this.strokeStyle,De=this.font,Be=this.lineCap,$e=this.lineWidth,Ye=this.lineJoin;this.pdf.addPage(),this.fillStyle=se,this.strokeStyle=Ee,this.font=De,this.lineCap=Be,this.lineWidth=$e,this.lineJoin=Ye},ge=function(se,Ee,De){for(var Be=0;Be<se.length;Be++)switch(se[Be].type){case"bct":se[Be].x2+=Ee,se[Be].y2+=De;case"qct":se[Be].x1+=Ee,se[Be].y1+=De;default:se[Be].x+=Ee,se[Be].y+=De}return se},he=function(se){return se.sort(function(Ee,De){return Ee-De})},me=function(se,Ee){var De=this.fillStyle,Be=this.strokeStyle,$e=this.lineCap,Ye=this.lineWidth,ct=Math.abs(Ye*this.ctx.transform.scaleX),ut=this.lineJoin;if(this.autoPaging){for(var Tt,Ft,Wt=JSON.parse(JSON.stringify(this.path)),qt=JSON.parse(JSON.stringify(this.path)),Et=[],Pe=0;Pe<qt.length;Pe++)if(qt[Pe].x!==void 0)for(var $t=W.call(this,qt[Pe]),Dt=0;Dt<$t.length;Dt+=1)Et.indexOf($t[Dt])===-1&&Et.push($t[Dt]);for(var wn=0;wn<Et.length;wn++)for(;this.pdf.internal.getNumberOfPages()<Et[wn];)q.call(this);he(Et);for(var _t=Et[0],en=Et[Et.length-1],Xt=_t;Xt<en+1;Xt++){this.pdf.setPage(Xt),this.fillStyle=De,this.strokeStyle=Be,this.lineCap=$e,this.lineWidth=ct,this.lineJoin=ut;var Tn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],bn=Xt===1?this.posY+this.margin[0]:this.margin[0],Un=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ii=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Bn=Xt===1?0:Un+(Xt-2)*ii;if(this.ctx.clip_path.length!==0){var li=this.path;Tt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ge(Tt,this.posX+this.margin[3],-Bn+bn+this.ctx.prevPageLastElemOffset),Ce.call(this,se,!0),this.path=li}if(Ft=JSON.parse(JSON.stringify(Wt)),this.path=ge(Ft,this.posX+this.margin[3],-Bn+bn+this.ctx.prevPageLastElemOffset),Ee===!1||Xt===0){var Xn=(Xt>_t||Xt<en)&&$.call(this);Xn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tn,ii,null).clip().discardPath()),Ce.call(this,se,Ee),Xn&&this.pdf.restoreGraphicsState()}this.lineWidth=Ye}this.path=Wt}else this.lineWidth=ct,Ce.call(this,se,Ee),this.lineWidth=Ye},Ce=function(se,Ee){if((se!=="stroke"||Ee||!B.call(this))&&(se==="stroke"||Ee||!A.call(this))){for(var De,Be,$e=[],Ye=this.path,ct=0;ct<Ye.length;ct++){var ut=Ye[ct];switch(ut.type){case"begin":$e.push({begin:!0});break;case"close":$e.push({close:!0});break;case"mt":$e.push({start:ut,deltas:[],abs:[]});break;case"lt":var Tt=$e.length;if(Ye[ct-1]&&!isNaN(Ye[ct-1].x)&&(De=[ut.x-Ye[ct-1].x,ut.y-Ye[ct-1].y],Tt>0)){for(;Tt>=0;Tt--)if($e[Tt-1].close!==!0&&$e[Tt-1].begin!==!0){$e[Tt-1].deltas.push(De),$e[Tt-1].abs.push(ut);break}}break;case"bct":De=[ut.x1-Ye[ct-1].x,ut.y1-Ye[ct-1].y,ut.x2-Ye[ct-1].x,ut.y2-Ye[ct-1].y,ut.x-Ye[ct-1].x,ut.y-Ye[ct-1].y],$e[$e.length-1].deltas.push(De);break;case"qct":var Ft=Ye[ct-1].x+2/3*(ut.x1-Ye[ct-1].x),Wt=Ye[ct-1].y+2/3*(ut.y1-Ye[ct-1].y),qt=ut.x+2/3*(ut.x1-ut.x),Et=ut.y+2/3*(ut.y1-ut.y),Pe=ut.x,$t=ut.y;De=[Ft-Ye[ct-1].x,Wt-Ye[ct-1].y,qt-Ye[ct-1].x,Et-Ye[ct-1].y,Pe-Ye[ct-1].x,$t-Ye[ct-1].y],$e[$e.length-1].deltas.push(De);break;case"arc":$e.push({deltas:[],abs:[],arc:!0}),Array.isArray($e[$e.length-1].abs)&&$e[$e.length-1].abs.push(ut)}}Be=Ee?null:se==="stroke"?"stroke":"fill";for(var Dt=!1,wn=0;wn<$e.length;wn++)if($e[wn].arc)for(var _t=$e[wn].abs,en=0;en<_t.length;en++){var Xt=_t[en];Xt.type==="arc"?ee.call(this,Xt.x,Xt.y,Xt.radius,Xt.startAngle,Xt.endAngle,Xt.counterclockwise,void 0,Ee,!Dt):le.call(this,Xt.x,Xt.y),Dt=!0}else if($e[wn].close===!0)this.pdf.internal.out("h"),Dt=!1;else if($e[wn].begin!==!0){var Tn=$e[wn].start.x,bn=$e[wn].start.y;ze.call(this,$e[wn].deltas,Tn,bn),Dt=!0}Be&&J.call(this,Be),Ee&&ye.call(this)}},Ve=function(se){var Ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,De=Ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return se-De;case"top":return se+Ee-De;case"hanging":return se+Ee-2*De;case"middle":return se+Ee/2-De;default:return se}},pe=function(se){return se+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var se=function(){};return se.colorStops=[],se.addColorStop=function(Ee,De){this.colorStops.push([Ee,De])},se.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},se.isCanvasGradient=!0,se},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ee=function(se,Ee,De,Be,$e,Ye,ct,ut,Tt){for(var Ft=je.call(this,De,Be,$e,Ye),Wt=0;Wt<Ft.length;Wt++){var qt=Ft[Wt];Wt===0&&(Tt?X.call(this,qt.x1+se,qt.y1+Ee):le.call(this,qt.x1+se,qt.y1+Ee)),nt.call(this,se,Ee,qt.x2,qt.y2,qt.x3,qt.y3,qt.x4,qt.y4)}ut?ye.call(this):J.call(this,ct)},J=function(se){switch(se){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ye=function(){this.pdf.clip(),this.pdf.discardPath()},X=function(se,Ee){this.pdf.internal.out(t(se)+" "+n(Ee)+" m")},ae=function(se){var Ee;switch(se.align){case"right":case"end":Ee="right";break;case"center":Ee="center";break;default:Ee="left"}var De,Be,$e,Ye=this.pdf.getTextDimensions(se.text),ct=Ve.call(this,se.y),ut=pe.call(this,ct)-Ye.h,Tt=this.ctx.transform.applyToPoint(new l(se.x,ct));if(this.autoPaging){var Ft=this.ctx.transform.decompose(),Wt=new h;Wt=(Wt=(Wt=Wt.multiply(Ft.translate)).multiply(Ft.skew)).multiply(Ft.scale);for(var qt=this.ctx.transform.applyToRectangle(new u(se.x,ct,Ye.w,Ye.h)),Et=Wt.applyToRectangle(new u(se.x,ut,Ye.w,Ye.h)),Pe=W.call(this,Et),$t=[],Dt=0;Dt<Pe.length;Dt+=1)$t.indexOf(Pe[Dt])===-1&&$t.push(Pe[Dt]);he($t);for(var wn=$t[0],_t=$t[$t.length-1],en=wn;en<_t+1;en++){this.pdf.setPage(en);var Xt=en===1?this.posY+this.margin[0]:this.margin[0],Tn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bn=this.pdf.internal.pageSize.height-this.margin[2],Un=bn-this.margin[0],ii=this.pdf.internal.pageSize.width-this.margin[1],Bn=ii-this.margin[3],li=en===1?0:Tn+(en-2)*Un;if(this.ctx.clip_path.length!==0){var Xn=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ge(De,this.posX+this.margin[3],-1*li+Xt),Ce.call(this,"fill",!0),this.path=Xn}var ln=ge([JSON.parse(JSON.stringify(Et))],this.posX+this.margin[3],-li+Xt+this.ctx.prevPageLastElemOffset)[0];se.scale>=.01&&(Be=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Be*se.scale),$e=this.lineWidth,this.lineWidth=$e*se.scale);var $n=this.autoPaging!=="text";if($n||ln.y+ln.h<=bn){if($n||ln.y>=Xt&&ln.x<=ii){var cn=$n?se.text:this.pdf.splitTextToSize(se.text,se.maxWidth||ii-ln.x)[0],er=ge([JSON.parse(JSON.stringify(qt))],this.posX+this.margin[3],-li+Xt+this.ctx.prevPageLastElemOffset)[0],Jn=$n&&(en>wn||en<_t)&&$.call(this);Jn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bn,Un,null).clip().discardPath()),this.pdf.text(cn,er.x,er.y,{angle:se.angle,align:Ee,renderingMode:se.renderingMode}),Jn&&this.pdf.restoreGraphicsState()}}else ln.y<bn&&(this.ctx.prevPageLastElemOffset+=bn-ln.y);se.scale>=.01&&(this.pdf.setFontSize(Be),this.lineWidth=$e)}}else se.scale>=.01&&(Be=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Be*se.scale),$e=this.lineWidth,this.lineWidth=$e*se.scale),this.pdf.text(se.text,Tt.x+this.posX,Tt.y+this.posY,{angle:se.angle,align:Ee,renderingMode:se.renderingMode,maxWidth:se.maxWidth}),se.scale>=.01&&(this.pdf.setFontSize(Be),this.lineWidth=$e)},le=function(se,Ee,De,Be){De=De||0,Be=Be||0,this.pdf.internal.out(t(se+De)+" "+n(Ee+Be)+" l")},ze=function(se,Ee,De){return this.pdf.lines(se,Ee,De,null,null)},nt=function(se,Ee,De,Be,$e,Ye,ct,ut){this.pdf.internal.out([e(r(De+se)),e(s(Be+Ee)),e(r($e+se)),e(s(Ye+Ee)),e(r(ct+se)),e(s(ut+Ee)),"c"].join(" "))},je=function(se,Ee,De,Be){for(var $e=2*Math.PI,Ye=Math.PI/2;Ee>De;)Ee-=$e;var ct=Math.abs(De-Ee);ct<$e&&Be&&(ct=$e-ct);for(var ut=[],Tt=Be?-1:1,Ft=Ee;ct>1e-5;){var Wt=Ft+Tt*Math.min(ct,Ye);ut.push(Je.call(this,se,Ft,Wt)),ct-=Math.abs(Wt-Ft),Ft=Wt}return ut},Je=function(se,Ee,De){var Be=(De-Ee)/2,$e=se*Math.cos(Be),Ye=se*Math.sin(Be),ct=$e,ut=-Ye,Tt=ct*ct+ut*ut,Ft=Tt+ct*$e+ut*Ye,Wt=4/3*(Math.sqrt(2*Tt*Ft)-Ft)/(ct*Ye-ut*$e),qt=ct-Wt*ut,Et=ut+Wt*ct,Pe=qt,$t=-Et,Dt=Be+Ee,wn=Math.cos(Dt),_t=Math.sin(Dt);return{x1:se*Math.cos(Ee),y1:se*Math.sin(Ee),x2:qt*wn-Et*_t,y2:qt*_t+Et*wn,x3:Pe*wn-$t*_t,y3:Pe*_t+$t*wn,x4:se*Math.cos(De),y4:se*Math.sin(De)}},qe=function(se){return 180*se/Math.PI},ot=function(se,Ee,De,Be,$e,Ye){var ct=se+.5*(De-se),ut=Ee+.5*(Be-Ee),Tt=$e+.5*(De-$e),Ft=Ye+.5*(Be-Ye),Wt=Math.min(se,$e,ct,Tt),qt=Math.max(se,$e,ct,Tt),Et=Math.min(Ee,Ye,ut,Ft),Pe=Math.max(Ee,Ye,ut,Ft);return new u(Wt,Et,qt-Wt,Pe-Et)},St=function(se,Ee,De,Be,$e,Ye,ct,ut){var Tt,Ft,Wt,qt,Et,Pe,$t,Dt,wn,_t,en,Xt,Tn,bn,Un=De-se,ii=Be-Ee,Bn=$e-De,li=Ye-Be,Xn=ct-$e,ln=ut-Ye;for(Ft=0;Ft<41;Ft++)wn=($t=(Wt=se+(Tt=Ft/40)*Un)+Tt*((Et=De+Tt*Bn)-Wt))+Tt*(Et+Tt*($e+Tt*Xn-Et)-$t),_t=(Dt=(qt=Ee+Tt*ii)+Tt*((Pe=Be+Tt*li)-qt))+Tt*(Pe+Tt*(Ye+Tt*ln-Pe)-Dt),Ft==0?(en=wn,Xt=_t,Tn=wn,bn=_t):(en=Math.min(en,wn),Xt=Math.min(Xt,_t),Tn=Math.max(Tn,wn),bn=Math.max(bn,_t));return new u(Math.round(en),Math.round(Xt),Math.round(Tn-en),Math.round(bn-Xt))},Ne=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var se,Ee,De=(se=this.ctx.lineDash,Ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:se,lineDashOffset:Ee}));this.prevLineDash!==De&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=De)}}})(In.API),(function(i){var e=function(l){var u,h,f,x,g,w,A,B,$,W;for(h=[],f=0,x=(l+=u="\0\0\0\0".slice(l.length%4||4)).length;x>f;f+=4)(g=(l.charCodeAt(f)<<24)+(l.charCodeAt(f+1)<<16)+(l.charCodeAt(f+2)<<8)+l.charCodeAt(f+3))!==0?(w=(g=((g=((g=((g=(g-(W=g%85))/85)-($=g%85))/85)-(B=g%85))/85)-(A=g%85))/85)%85,h.push(w+33,A+33,B+33,$+33,W+33)):h.push(122);return(function(q,ge){for(var he=ge;he>0;he--)q.pop()})(h,u.length),String.fromCharCode.apply(String,h)+"~>"},t=function(l){var u,h,f,x,g,w=String,A="length",B=255,$="charCodeAt",W="slice",q="replace";for(l[W](-2),l=l[W](0,-2)[q](/\s/g,"")[q]("z","!!!!!"),f=[],x=0,g=(l+=u="uuuuu"[W](l[A]%5||5))[A];g>x;x+=5)h=52200625*(l[$](x)-33)+614125*(l[$](x+1)-33)+7225*(l[$](x+2)-33)+85*(l[$](x+3)-33)+(l[$](x+4)-33),f.push(B&h>>24,B&h>>16,B&h>>8,B&h);return(function(ge,he){for(var me=he;me>0;me--)ge.pop()})(f,u[A]),w.fromCharCode.apply(w,f)},n=function(l){return l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(l){var u=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),u.test(l)===!1)return"";for(var h="",f=0;f<l.length;f+=2)h+=String.fromCharCode("0x"+(l[f]+l[f+1]));return h},s=function(l){for(var u=new Uint8Array(l.length),h=l.length;h--;)u[h]=l.charCodeAt(h);return(u=Vx(u)).reduce(function(f,x){return f+String.fromCharCode(x)},"")};i.processDataByFilters=function(l,u){var h=0,f=l||"",x=[];for(typeof(u=u||[])=="string"&&(u=[u]),h=0;h<u.length;h+=1)switch(u[h]){case"ASCII85Decode":case"/ASCII85Decode":f=t(f),x.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),x.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=r(f),x.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=n(f),x.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=s(f),x.push("/FlateDecode");break;default:throw new Error('The filter: "'+u[h]+'" is not implemented')}return{data:f,reverseChain:x.reverse().join(" ")}}})(In.API),(function(i){i.loadFile=function(e,t,n){return(function(r,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var u=void 0;try{u=(function(h,f,x){var g=new XMLHttpRequest,w=0,A=function(B){var $=B.length,W=[],q=String.fromCharCode;for(w=0;w<$;w+=1)W.push(q(255&B.charCodeAt(w)));return W.join("")};if(g.open("GET",h,!f),g.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(g.onload=function(){g.status===200?x(A(this.responseText)):x(void 0)}),g.send(null),f&&g.status===200)return A(g.responseText)})(r,s,l)}catch{}return u})(e,t,n)},i.loadImageFile=i.loadFile})(In.API),(function(i){function e(){return(ai.html2canvas?Promise.resolve(ai.html2canvas):Vt(()=>import("./chunk-1765759384263-html2canvas.esm.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load html2canvas: "+u))}).then(function(u){return u.default?u.default:u})}function t(){return(ai.DOMPurify?Promise.resolve(ai.DOMPurify):Vt(()=>import("./chunk-1765759384263-purify.es.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load dompurify: "+u))}).then(function(u){return u.default?u.default:u})}var n=function(u){var h=Or(u);return h==="undefined"?"undefined":h==="string"||u instanceof String?"string":h==="number"||u instanceof Number?"number":h==="function"||u instanceof Function?"function":u&&u.constructor===Array?"array":u&&u.nodeType===1?"element":h==="object"?"object":"unknown"},r=function(u,h){var f=document.createElement(u);for(var x in h.className&&(f.className=h.className),h.innerHTML&&h.dompurify&&(f.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)f.style[x]=h.style[x];return f},s=function u(h,f){for(var x=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),g=h.firstChild;g;g=g.nextSibling)f!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||x.appendChild(u(g,f));return h.nodeType===1&&(h.nodeName==="CANVAS"?(x.width=h.width,x.height=h.height,x.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(x.value=h.value),x.addEventListener("load",function(){x.scrollTop=h.scrollTop,x.scrollLeft=h.scrollLeft},!0)),x},l=function u(h){var f=Object.assign(u.convert(Promise.resolve()),JSON.parse(JSON.stringify(u.template))),x=u.convert(Promise.resolve(),f);return(x=x.setProgress(1,u,1,[u])).set(h)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(u,h){return u.__proto__=h||l.prototype,u},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(u,h){return this.then(function(){switch(h=h||(function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(u),h){case"string":return this.then(t).then(function(f){return this.set({src:r("div",{innerHTML:u,dompurify:f})})});case"element":return this.set({src:u});case"canvas":return this.set({canvas:u});case"img":return this.set({img:u});default:return this.error("Unknown source type.")}})},l.prototype.to=function(u){switch(u){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var u={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(u.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:u}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(e).then(function(h){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,h(this.prop.container,f)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(e).then(function(h){var f=this.opt.jsPDF,x=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,w=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete w.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=x,x)for(var A=0;A<x.length;++A){var B=x[A],$=B.src.find(function(W){return W.format==="truetype"});$&&f.addFont($.url,B.ref.name,B.ref.style)}return w.windowHeight=w.windowHeight||0,w.windowHeight=w.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):w.windowHeight,f.context2d.save(!0),h(this.prop.container,w)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var u=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=u})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(u,h,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(u,h):this.outputPdf(u,h)},l.prototype.outputPdf=function(u,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(u,h)})},l.prototype.outputImg=function(u){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(u){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+u+'" is not supported.'}})},l.prototype.save=function(u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(u?{filename:u}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(u){if(n(u)!=="object")return this;var h=Object.keys(u||{}).map(function(f){if(f in l.template.prop)return function(){this.prop[f]=u[f]};switch(f){case"margin":return this.setMargin.bind(this,u.margin);case"jsPDF":return function(){return this.opt.jsPDF=u.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,u.pageSize);default:return function(){this.opt[f]=u[f]}}},this);return this.then(function(){return this.thenList(h)})},l.prototype.get=function(u,h){return this.then(function(){var f=u in l.template.prop?this.prop[u]:this.opt[u];return h?h(f):f})},l.prototype.setMargin=function(u){return this.then(function(){switch(n(u)){case"number":u=[u,u,u,u];case"array":if(u.length===2&&(u=[u[0],u[1],u[0],u[1]]),u.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=u}).then(this.setPageSize)},l.prototype.setPageSize=function(u){function h(f,x){return Math.floor(f*x/72*96)}return this.then(function(){(u=u||In.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(u.inner={width:u.width-this.opt.margin[1]-this.opt.margin[3],height:u.height-this.opt.margin[0]-this.opt.margin[2]},u.inner.px={width:h(u.inner.width,u.k),height:h(u.inner.height,u.k)},u.inner.ratio=u.inner.height/u.inner.width),this.prop.pageSize=u})},l.prototype.setProgress=function(u,h,f,x){return u!=null&&(this.progress.val=u),h!=null&&(this.progress.state=h),f!=null&&(this.progress.n=f),x!=null&&(this.progress.stack=x),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(u,h,f,x){return this.setProgress(u?this.progress.val+u:null,h||null,f?this.progress.n+f:null,x?this.progress.stack.concat(x):null)},l.prototype.then=function(u,h){var f=this;return this.thenCore(u,h,function(x,g){return f.updateProgress(null,null,1,[x]),Promise.prototype.then.call(this,function(w){return f.updateProgress(null,x),w}).then(x,g).then(function(w){return f.updateProgress(1),w})})},l.prototype.thenCore=function(u,h,f){f=f||Promise.prototype.then;var x=this;u&&(u=u.bind(x)),h&&(h=h.bind(x));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?x:l.convert(Object.assign({},x),Promise.prototype),w=f.call(g,u,h);return l.convert(w,x.__proto__)},l.prototype.thenExternal=function(u,h){return Promise.prototype.then.call(this,u,h)},l.prototype.thenList=function(u){var h=this;return u.forEach(function(f){h=h.thenCore(f)}),h},l.prototype.catch=function(u){u&&(u=u.bind(this));var h=Promise.prototype.catch.call(this,u);return l.convert(h,this)},l.prototype.catchExternal=function(u){return Promise.prototype.catch.call(this,u)},l.prototype.error=function(u){return this.then(function(){throw new Error(u)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,In.getPageSize=function(u,h,f){if(Or(u)==="object"){var x=u;u=x.orientation,h=x.unit||h,f=x.format||f}h=h||"mm",f=f||"a4",u=(""+(u||"P")).toLowerCase();var g,w=(""+f).toLowerCase(),A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+h}var B,$=0,W=0;if(A.hasOwnProperty(w))$=A[w][1]/g,W=A[w][0]/g;else try{$=f[1],W=f[0]}catch{throw new Error("Invalid format: "+f)}if(u==="p"||u==="portrait")u="p",W>$&&(B=W,W=$,$=B);else{if(u!=="l"&&u!=="landscape")throw"Invalid orientation: "+u;u="l",$>W&&(B=W,W=$,$=B)}return{width:W,height:$,unit:h,k:g,orientation:u}},i.html=function(u,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Rb):null;var f=new l(h);return h.worker?f:f.from(u).doCallback()}})(In.API),In.API.addJS=function(i){return kk=i,this.internal.events.subscribe("postPutResources",function(){s0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(s0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Ik=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+kk+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){s0!==void 0&&Ik!==void 0&&this.internal.out("/Names <</JavaScript "+s0+" 0 R>>")}),this},(function(i){var e;i.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),s=0;s<r.length;s++){var l=r[s],u=n.exec(l);if(u!=null){var h=u[1];t.internal.newObjectDeferredBegin(h,!1)}t.internal.write(l)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,x=[];for(s=0;s<f;s++){var g=t.internal.newObject();x.push(g);var w=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+w.objId+" 0 R /XYZ null null null]>> endobj")}var A=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<x.length;s++)t.internal.write("(page_"+(s+1)+")"+x[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+A+" 0 R"),t.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),i.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,r,s){var l={title:r,options:s,children:[]};return n==null&&(n=this.root),n.children.push(l),l},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var r=0;r<n.children.length;r++)this.genIds_r(n.children[r])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var l=n.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var u=this.count=this.count_r({count:0},l);if(u>0&&this.line("/Count "+u),l.options&&l.options.pageNumber){var h=t.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+h.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,r){for(var s=0;s<r.children.length;s++)n.count++,this.count_r(n,r.children[s]);return n.count}}])})(In.API),(function(i){var e=[192,193,194,195,196,197,198,199];i.processJPEG=function(t,n,r,s,l,u){var h,f=this.decode.DCT_DECODE,x=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=l||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,h=(function(g){for(var w,A=256*g.charCodeAt(4)+g.charCodeAt(5),B=g.length,$={width:0,height:0,numcomponents:1},W=4;W<B;W+=2){if(W+=A,e.indexOf(g.charCodeAt(W+1))!==-1){w=256*g.charCodeAt(W+5)+g.charCodeAt(W+6),$={width:256*g.charCodeAt(W+7)+g.charCodeAt(W+8),height:w,numcomponents:g.charCodeAt(W+9)};break}A=256*g.charCodeAt(W+2)+g.charCodeAt(W+3)}return $})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),h.numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}x={data:t,width:h.width,height:h.height,colorSpace:u,bitsPerComponent:8,filter:f,index:n,alias:r}}return x}})(In.API),In.API.processPNG=function(i,e,t,n){if(this.__addimage__.isArrayBuffer(i)&&(i=new Uint8Array(i)),this.__addimage__.isArrayBufferView(i)){var r,s=rW(i,{checkCrc:!0}),l=s.width,u=s.height,h=s.channels,f=s.palette,x=s.depth;r=f&&h===1?(function(ee){for(var J=ee.width,ye=ee.height,X=ee.data,ae=ee.palette,le=ee.depth,ze=!1,nt=[],je=[],Je=void 0,qe=!1,ot=0,St=0;St<ae.length;St++){var Ne=DI(ae[St],4),se=Ne[0],Ee=Ne[1],De=Ne[2],Be=Ne[3];nt.push(se,Ee,De),Be!=null&&(Be===0?(ot++,je.length<1&&je.push(St)):Be<255&&(qe=!0))}if(qe||ot>1){ze=!0,je=void 0;var $e=J*ye;Je=new Uint8Array($e);for(var Ye=new DataView(X.buffer),ct=0;ct<$e;ct++){var ut=Db(Ye,ct,le),Tt=DI(ae[ut],4)[3];Je[ct]=Tt}}else ot===0&&(je=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:ze?8:void 0,colorBytes:X,alphaBytes:Je,needSMask:ze,palette:nt,mask:je}})(s):h===2||h===4?(function(ee){for(var J=ee.data,ye=ee.width,X=ee.height,ae=ee.channels,le=ee.depth,ze=ae===2?"DeviceGray":"DeviceRGB",nt=ae-1,je=ye*X,Je=nt,qe=je*Je,ot=1*je,St=Math.ceil(qe*le/8),Ne=Math.ceil(ot*le/8),se=new Uint8Array(St),Ee=new Uint8Array(Ne),De=new DataView(J.buffer),Be=new DataView(se.buffer),$e=new DataView(Ee.buffer),Ye=!1,ct=0;ct<je;ct++){for(var ut=ct*ae,Tt=0;Tt<Je;Tt++)Fk(Be,Db(De,ut+Tt,le),ct*Je+Tt,le);var Ft=Db(De,ut+Je,le);Ft<(1<<le)-1&&(Ye=!0),Fk($e,Ft,1*ct,le)}return{colorSpace:ze,colorsPerPixel:nt,sMaskBitsPerComponent:Ye?le:void 0,colorBytes:se,alphaBytes:Ee,needSMask:Ye}})(s):(function(ee){var J=ee.data,ye=ee.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:ye,colorsPerPixel:ye==="DeviceGray"?1:3,colorBytes:J instanceof Uint16Array?(function(X){for(var ae=X.length,le=new Uint8Array(2*ae),ze=new DataView(le.buffer,le.byteOffset,le.byteLength),nt=0;nt<ae;nt++)ze.setUint16(2*nt,X[nt],!1);return le})(J):J,needSMask:!1}})(s);var g,w,A,B=r,$=B.colorSpace,W=B.colorsPerPixel,q=B.sMaskBitsPerComponent,ge=B.colorBytes,he=B.alphaBytes,me=B.needSMask,Ce=B.palette,Ve=B.mask,pe=null;return n!==In.API.image_compression.NONE&&typeof Vx=="function"?(pe=(function(ee){var J;switch(ee){case In.API.image_compression.FAST:J=11;break;case In.API.image_compression.MEDIUM:J=13;break;case In.API.image_compression.SLOW:J=14;break;default:J=12}return J})(n),g=this.decode.FLATE_DECODE,w="/Predictor ".concat(pe," /Colors ").concat(W," /BitsPerComponent ").concat(x," /Columns ").concat(l),i=Dk(ge,Math.ceil(l*W*x/8),W,x,n),me&&(A=Dk(he,Math.ceil(l*q/8),1,q,n))):(g=void 0,w=void 0,i=ge,me&&(A=he)),(this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i))&&(i=this.__addimage__.arrayBufferToBinaryString(i)),(A&&this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),{alias:t,data:i,index:e,filter:g,decodeParameters:w,transparency:Ve,palette:Ce,sMask:A,predictor:pe,width:l,height:u,bitsPerComponent:x,sMaskBitsPerComponent:q,colorSpace:$}}},(function(i){i.processGIF89A=function(e,t,n,r){var s=new AW(e),l=s.width,u=s.height,h=[];s.decodeAndBlitFrameRGBA(0,h);var f={data:h,width:l,height:u},x=new Nb(100).encode(f,100);return i.processJPEG.call(this,x,t,n,r)},i.processGIF87A=i.processGIF89A})(In.API),Au.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var e=0;e<i;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:n,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Au.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[i]()}catch(t){Qr.log("bit decode error:"+t)}},Au.prototype.bit1=function(){var i,e=Math.ceil(this.width/8),t=e%4;for(i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+8*r*4,u=0;u<8&&8*r+u<this.width;u++){var h=this.palette[s>>7-u&1];this.data[l+4*u]=h.blue,this.data[l+4*u+1]=h.green,this.data[l+4*u+2]=h.red,this.data[l+4*u+3]=255}t!==0&&(this.pos+=4-t)}},Au.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),e=i%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<i;r++){var s=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+2*r*4,u=s>>4,h=15&s,f=this.palette[u];if(this.data[l]=f.blue,this.data[l+1]=f.green,this.data[l+2]=f.red,this.data[l+3]=255,2*r+1>=this.width)break;f=this.palette[h],this.data[l+4]=f.blue,this.data[l+4+1]=f.green,this.data[l+4+2]=f.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},Au.prototype.bit8=function(){for(var i=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;if(r<this.palette.length){var l=this.palette[r];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}i!==0&&(this.pos+=4-i)}},Au.prototype.bit15=function(){for(var i=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,u=(s>>5&e)/e*255|0,h=(s>>10&e)/e*255|0,f=s>>15?255:0,x=n*this.width*4+4*r;this.data[x]=h,this.data[x+1]=u,this.data[x+2]=l,this.data[x+3]=f}this.pos+=i}},Au.prototype.bit16=function(){for(var i=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(l&e)/e*255|0,h=(l>>5&t)/t*255|0,f=(l>>11)/e*255|0,x=r*this.width*4+4*s;this.data[x]=f,this.data[x+1]=h,this.data[x+2]=u,this.data[x+3]=255}this.pos+=i}},Au.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var e=this.bottom_up?i:this.height-1-i,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=s,this.data[l+1]=r,this.data[l+2]=n,this.data[l+3]=255}this.pos+=this.width%4}},Au.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var e=this.bottom_up?i:this.height-1-i,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),u=e*this.width*4+4*t;this.data[u]=s,this.data[u+1]=r,this.data[u+2]=n,this.data[u+3]=l}},Au.prototype.getData=function(){return this.data},(function(i){i.processBMP=function(e,t,n,r){var s=new Au(e,!1),l=s.width,u=s.height,h={data:s.getData(),width:l,height:u},f=new Nb(100).encode(h,100);return i.processJPEG.call(this,f,t,n,r)}})(In.API),Vk.prototype.getData=function(){return this.data},(function(i){i.processWEBP=function(e,t,n,r){var s=new Vk(e),l=s.width,u=s.height,h={data:s.getData(),width:l,height:u},f=new Nb(100).encode(h,100);return i.processJPEG.call(this,f,t,n,r)}})(In.API),In.API.processRGBA=function(i,e,t){for(var n=i.data,r=n.length,s=new Uint8Array(r/4*3),l=new Uint8Array(r/4),u=0,h=0,f=0;f<r;f+=4){var x=n[f],g=n[f+1],w=n[f+2],A=n[f+3];s[u++]=x,s[u++]=g,s[u++]=w,l[h++]=A}var B=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:B,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},In.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Vf=In.API,a0=Vf.getCharWidthsArray=function(i,e){var t,n,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),u=e.widths?e.widths:r.metadata.Unicode.widths,h=u.fof?u.fof:1,f=e.kerning?e.kerning:r.metadata.Unicode.kerning,x=f.fof?f.fof:1,g=e.doKerning!==!1,w=0,A=i.length,B=0,$=u[0]||h,W=[];for(t=0;t<A;t++)n=i.charCodeAt(t),typeof r.metadata.widthOfString=="function"?W.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+l*(1e3/s)||0)/1e3):(w=g&&Or(f[n])==="object"&&!isNaN(parseInt(f[n][B],10))?f[n][B]/x:0,W.push((u[n]||$)/h+w)),B=n;return W},Ck=Vf.getStringUnitWidth=function(i,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return Vf.processArabic&&(i=Vf.processArabic(i)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(i,t,r)/t:a0.apply(this,arguments).reduce(function(s,l){return s+l},0)},Rk=function(i,e,t,n){for(var r=[],s=0,l=i.length,u=0;s!==l&&u+e[s]<t;)u+=e[s],s++;r.push(i.slice(0,s));var h=s;for(u=0;s!==l;)u+e[s]>n&&(r.push(i.slice(h,s)),u=0,h=s),u+=e[s],s++;return h!==s&&r.push(i.slice(h,s)),r},Lk=function(i,e,t){t||(t={});var n,r,s,l,u,h,f,x=[],g=[x],w=t.textIndent||0,A=0,B=0,$=i.split(" "),W=a0.apply(this,[" ",t])[0];if(h=t.lineIndent===-1?$[0].length+2:t.lineIndent||0){var q=Array(h).join(" "),ge=[];$.map(function(me){(me=me.split(/\s*\n/)).length>1?ge=ge.concat(me.map(function(Ce,Ve){return(Ve&&Ce.length?`
`:"")+Ce})):ge.push(me[0])}),$=ge,h=Ck.apply(this,[q,t])}for(s=0,l=$.length;s<l;s++){var he=0;if(n=$[s],h&&n[0]==`
`&&(n=n.substr(1),he=1),w+A+(B=(r=a0.apply(this,[n,t])).reduce(function(me,Ce){return me+Ce},0))>e||he){if(B>e){for(u=Rk.apply(this,[n,r,e-(w+A),e]),x.push(u.shift()),x=[u.pop()];u.length;)g.push([u.shift()]);B=r.slice(n.length-(x[0]?x[0].length:0)).reduce(function(me,Ce){return me+Ce},0)}else x=[n];g.push(x),w=B+h,A=W}else x.push(n),w+=A+B,A=W}return f=h?function(me,Ce){return(Ce?q:"")+me.join(" ")}:function(me){return me.join(" ")},g.map(f)},Vf.splitTextToSize=function(i,e,t){var n,r=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(x){if(x.widths&&x.kerning)return{widths:x.widths,kerning:x.kerning};var g=this.internal.getFont(x.fontName,x.fontStyle),w="Unicode";return g.metadata[w]?{widths:g.metadata[w].widths||{0:1},kerning:g.metadata[w].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(i)?i:String(i).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/r;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=t.lineIndent;var u,h,f=[];for(u=0,h=n.length;u<h;u++)f=f.concat(Lk.apply(this,[n[u],l,s]));return f},(function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",n={},r={},s=0;s<16;s++)n[t[s]]=e[s],r[e[s]]=t[s];var l=function(w){return"0x"+parseInt(w,10).toString(16)},u=i.__fontmetrics__.compress=function(w){var A,B,$,W,q=["{"];for(var ge in w){if(A=w[ge],isNaN(parseInt(ge,10))?B="'"+ge+"'":(ge=parseInt(ge,10),B=(B=l(ge).slice(2)).slice(0,-1)+r[B.slice(-1)]),typeof A=="number")A<0?($=l(A).slice(3),W="-"):($=l(A).slice(2),W=""),$=W+$.slice(0,-1)+r[$.slice(-1)];else{if(Or(A)!=="object")throw new Error("Don't know what to do with value type "+Or(A)+".");$=u(A)}q.push(B+$)}return q.push("}"),q.join("")},h=i.__fontmetrics__.uncompress=function(w){if(typeof w!="string")throw new Error("Invalid argument passed to uncompress.");for(var A,B,$,W,q={},ge=1,he=q,me=[],Ce="",Ve="",pe=w.length-1,ee=1;ee<pe;ee+=1)(W=w[ee])=="'"?A?($=A.join(""),A=void 0):A=[]:A?A.push(W):W=="{"?(me.push([he,$]),he={},$=void 0):W=="}"?((B=me.pop())[0][B[1]]=he,$=void 0,he=B[0]):W=="-"?ge=-1:$===void 0?n.hasOwnProperty(W)?(Ce+=n[W],$=parseInt(Ce,16)*ge,ge=1,Ce=""):Ce+=W:n.hasOwnProperty(W)?(Ve+=n[W],he[$]=parseInt(Ve,16)*ge,ge=1,$=void 0,Ve=""):Ve+=W;return q},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},x={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},g={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(w){var A=w.font,B=g.Unicode[A.postScriptName];B&&(A.metadata.Unicode={},A.metadata.Unicode.widths=B.widths,A.metadata.Unicode.kerning=B.kerning);var $=x.Unicode[A.postScriptName];$&&(A.metadata.Unicode.encoding=$,A.encoding=$.codePages[0])}])})(In.API),(function(i){var e=function(t){for(var n=t.length,r=new Uint8Array(n),s=0;s<n;s++)r[s]=t.charCodeAt(s);return r};i.API.events.push(["addFont",function(t){var n=void 0,r=t.font,s=t.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(n=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(l,u){u=/^\x00\x01\x00\x00/.test(u)?e(u):e(C0(u)),l.metadata=i.API.TTFFont.open(u),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(r,n)}}])})(In),In.API.addSvgAsImage=function(i,e,t,n,r,s,l,u){if(isNaN(e)||isNaN(t))throw Qr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(r))throw Qr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=n,h.height=r;var f=h.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,h.width,h.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(ai.canvg?Promise.resolve(ai.canvg):Vt(()=>import("./chunk-1765759384263-index.es.js"),[])).catch(function(w){return Promise.reject(new Error("Could not load canvg: "+w))}).then(function(w){return w.default?w.default:w}).then(function(w){return w.fromString(f,i,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(x)}).then(function(){g.addImage(h.toDataURL("image/jpeg",1),e,t,n,r,l,u)})},In.API.putTotalPages=function(i){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(i,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(e,t);return this},In.API.viewerPreferences=function(i,e){var t;i=i||{},e=e||!1;var n,r,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(l),h=[],f=0,x=0,g=0;function w(B,$){var W,q=!1;for(W=0;W<B.length;W+=1)B[W]===$&&(q=!0);return q}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,i==="reset"||e===!0){var A=u.length;for(g=0;g<A;g+=1)t[u[g]].value=t[u[g]].defaultValue,t[u[g]].explicitSet=!1}if(Or(i)==="object"){for(r in i)if(s=i[r],w(u,r)&&s!==void 0){if(t[r].type==="boolean"&&typeof s=="boolean")t[r].value=s;else if(t[r].type==="name"&&w(t[r].valueSet,s))t[r].value=s;else if(t[r].type==="integer"&&Number.isInteger(s))t[r].value=s;else if(t[r].type==="array"){for(f=0;f<s.length;f+=1)if(n=!0,s[f].length===1&&typeof s[f][0]=="number")h.push(String(s[f]-1));else if(s[f].length>1){for(x=0;x<s[f].length;x+=1)typeof s[f][x]!="number"&&(n=!1);n===!0&&h.push([s[f][0]-1,s[f][1]-1].join(" "))}t[r].value="["+h.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var B,$=[];for(B in t)t[B].explicitSet===!0&&(t[B].type==="name"?$.push("/"+B+" /"+t[B].value):$.push("/"+B+" "+t[B].value));$.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+$.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(i){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),h=unescape(encodeURIComponent("</x:xmpmeta>")),f=s.length+l.length+u.length+r.length+h.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(r+s+l+u+h),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(n,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(In.API),(function(i){var e=i.API,t=e.pdfEscape16=function(s,l){for(var u,h=l.metadata.Unicode.widths,f=["","0","00","000","0000"],x=[""],g=0,w=s.length;g<w;++g){if(u=l.metadata.characterToGlyph(s.charCodeAt(g)),l.metadata.glyIdsUsed.push(u),l.metadata.toUnicode[u]=s.charCodeAt(g),h.indexOf(u)==-1&&(h.push(u),h.push([parseInt(l.metadata.widthOfGlyph(u),10)])),u=="0")return x.join("");u=u.toString(16),x.push(f[4-u.length],u)}return x.join("")},n=function(s){var l,u,h,f,x,g,w;for(x=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,h=[],g=0,w=(u=Object.keys(s).sort(function(A,B){return A-B})).length;g<w;g++)l=u[g],h.length>=100&&(x+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar`,h=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(f=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),h.push("<"+l+"><"+f+">"));return h.length&&(x+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar
`),x+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(l){var u=l.font,h=l.out,f=l.newObject,x=l.putStream;if(u.metadata instanceof i.API.TTFFont&&u.encoding==="Identity-H"){for(var g=u.metadata.Unicode.widths,w=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),A="",B=0;B<w.length;B++)A+=String.fromCharCode(w[B]);var $=f();x({data:A,addLength1:!0,objectId:$}),h("endobj");var W=f();x({data:n(u.metadata.toUnicode),addLength1:!0,objectId:W}),h("endobj");var q=f();h("<<"),h("/Type /FontDescriptor"),h("/FontName /"+Wf(u.fontName)),h("/FontFile2 "+$+" 0 R"),h("/FontBBox "+i.API.PDFObject.convert(u.metadata.bbox)),h("/Flags "+u.metadata.flags),h("/StemV "+u.metadata.stemV),h("/ItalicAngle "+u.metadata.italicAngle),h("/Ascent "+u.metadata.ascender),h("/Descent "+u.metadata.decender),h("/CapHeight "+u.metadata.capHeight),h(">>"),h("endobj");var ge=f();h("<<"),h("/Type /Font"),h("/BaseFont /"+Wf(u.fontName)),h("/FontDescriptor "+q+" 0 R"),h("/W "+i.API.PDFObject.convert(g)),h("/CIDToGIDMap /Identity"),h("/DW 1000"),h("/Subtype /CIDFontType2"),h("/CIDSystemInfo"),h("<<"),h("/Supplement 0"),h("/Registry (Adobe)"),h("/Ordering ("+u.encoding+")"),h(">>"),h(">>"),h("endobj"),u.objectNumber=f(),h("<<"),h("/Type /Font"),h("/Subtype /Type0"),h("/ToUnicode "+W+" 0 R"),h("/BaseFont /"+Wf(u.fontName)),h("/Encoding /"+u.encoding),h("/DescendantFonts ["+ge+" 0 R]"),h(">>"),h("endobj"),u.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(l){var u=l.font,h=l.out,f=l.newObject,x=l.putStream;if(u.metadata instanceof i.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var g=u.metadata.rawData,w="",A=0;A<g.length;A++)w+=String.fromCharCode(g[A]);var B=f();x({data:w,addLength1:!0,objectId:B}),h("endobj");var $=f();x({data:n(u.metadata.toUnicode),addLength1:!0,objectId:$}),h("endobj");var W=f();h("<<"),h("/Descent "+u.metadata.decender),h("/CapHeight "+u.metadata.capHeight),h("/StemV "+u.metadata.stemV),h("/Type /FontDescriptor"),h("/FontFile2 "+B+" 0 R"),h("/Flags 96"),h("/FontBBox "+i.API.PDFObject.convert(u.metadata.bbox)),h("/FontName /"+Wf(u.fontName)),h("/ItalicAngle "+u.metadata.italicAngle),h("/Ascent "+u.metadata.ascender),h(">>"),h("endobj"),u.objectNumber=f();for(var q=0;q<u.metadata.hmtx.widths.length;q++)u.metadata.hmtx.widths[q]=parseInt(u.metadata.hmtx.widths[q]*(1e3/u.metadata.head.unitsPerEm));h("<</Subtype/TrueType/Type/Font/ToUnicode "+$+" 0 R/BaseFont/"+Wf(u.fontName)+"/FontDescriptor "+W+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),h("endobj"),u.isAlreadyPutted=!0}})(s)}]);var r=function(s){var l,u=s.text||"",h=s.x,f=s.y,x=s.options||{},g=s.mutex||{},w=g.pdfEscape,A=g.activeFontKey,B=g.fonts,$=A,W="",q=0,ge="",he=B[$].encoding;if(B[$].encoding!=="Identity-H")return{text:u,x:h,y:f,options:x,mutex:g};for(ge=u,$=A,Array.isArray(u)&&(ge=u[0]),q=0;q<ge.length;q+=1)B[$].metadata.hasOwnProperty("cmap")&&(l=B[$].metadata.cmap.unicode.codeMap[ge[q].charCodeAt(0)]),l||ge[q].charCodeAt(0)<256&&B[$].metadata.hasOwnProperty("Unicode")?W+=ge[q]:W+="";var me="";return parseInt($.slice(1))<14||he==="WinAnsiEncoding"?me=w(W,$).split("").map(function(Ce){return Ce.charCodeAt(0).toString(16)}).join(""):he==="Identity-H"&&(me=t(W,B[$])),g.isHex=!0,{text:me,x:h,y:f,options:x,mutex:g}};e.events.push(["postProcessText",function(s){var l=s.text||"",u=[],h={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var f=0;for(f=0;f<l.length;f+=1)Array.isArray(l[f])&&l[f].length===3?u.push([r(Object.assign({},h,{text:l[f][0]})).text,l[f][1],l[f][2]]):u.push(r(Object.assign({},h,{text:l[f]})).text);s.text=u}else s.text=r(Object.assign({},h,{text:l})).text}])})(In),(function(i){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},i.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},i.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(In.API),(function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(n){var r,s,l,u,h,f,x,g=e,w=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],A=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],B={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},$={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},W=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],q=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ge=!1,he=0;this.__bidiEngine__={};var me=function(X){var ae=X.charCodeAt(),le=ae>>8,ze=$[le];return ze!==void 0?g[256*ze+(255&ae)]:le===252||le===253?"AL":q.test(le)?"L":le===8?"R":"N"},Ce=function(X){for(var ae,le=0;le<X.length;le++){if((ae=me(X.charAt(le)))==="L")return!1;if(ae==="R")return!0}return!1},Ve=function(X,ae,le,ze){var nt,je,Je,qe,ot=ae[ze];switch(ot){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ge=!1;break;case"N":case"AN":break;case"EN":ge&&(ot="AN");break;case"AL":ge=!0,ot="R";break;case"WS":case"BN":ot="N";break;case"CS":ze<1||ze+1>=ae.length||(nt=le[ze-1])!=="EN"&&nt!=="AN"||(je=ae[ze+1])!=="EN"&&je!=="AN"?ot="N":ge&&(je="AN"),ot=je===nt?je:"N";break;case"ES":ot=(nt=ze>0?le[ze-1]:"B")==="EN"&&ze+1<ae.length&&ae[ze+1]==="EN"?"EN":"N";break;case"ET":if(ze>0&&le[ze-1]==="EN"){ot="EN";break}if(ge){ot="N";break}for(Je=ze+1,qe=ae.length;Je<qe&&ae[Je]==="ET";)Je++;ot=Je<qe&&ae[Je]==="EN"?"EN":"N";break;case"NSM":if(l&&!u){for(qe=ae.length,Je=ze+1;Je<qe&&ae[Je]==="NSM";)Je++;if(Je<qe){var St=X[ze],Ne=St>=1425&&St<=2303||St===64286;if(nt=ae[Je],Ne&&(nt==="R"||nt==="AL")){ot="R";break}}}ot=ze<1||(nt=ae[ze-1])==="B"?"N":le[ze-1];break;case"B":ge=!1,r=!0,ot=he;break;case"S":s=!0,ot="N"}return ot},pe=function(X,ae,le){var ze=X.split("");return le&&ee(ze,le,{hiLevel:he}),ze.reverse(),ae&&ae.reverse(),ze.join("")},ee=function(X,ae,le){var ze,nt,je,Je,qe,ot=-1,St=X.length,Ne=0,se=[],Ee=he?A:w,De=[];for(ge=!1,r=!1,s=!1,nt=0;nt<St;nt++)De[nt]=me(X[nt]);for(je=0;je<St;je++){if(qe=Ne,se[je]=Ve(X,De,se,je),ze=240&(Ne=Ee[qe][B[se[je]]]),Ne&=15,ae[je]=Je=Ee[Ne][5],ze>0)if(ze===16){for(nt=ot;nt<je;nt++)ae[nt]=1;ot=-1}else ot=-1;if(Ee[Ne][6])ot===-1&&(ot=je);else if(ot>-1){for(nt=ot;nt<je;nt++)ae[nt]=Je;ot=-1}De[je]==="B"&&(ae[je]=0),le.hiLevel|=Je}s&&(function(Be,$e,Ye){for(var ct=0;ct<Ye;ct++)if(Be[ct]==="S"){$e[ct]=he;for(var ut=ct-1;ut>=0&&Be[ut]==="WS";ut--)$e[ut]=he}})(De,ae,St)},J=function(X,ae,le,ze,nt){if(!(nt.hiLevel<X)){if(X===1&&he===1&&!r)return ae.reverse(),void(le&&le.reverse());for(var je,Je,qe,ot,St=ae.length,Ne=0;Ne<St;){if(ze[Ne]>=X){for(qe=Ne+1;qe<St&&ze[qe]>=X;)qe++;for(ot=Ne,Je=qe-1;ot<Je;ot++,Je--)je=ae[ot],ae[ot]=ae[Je],ae[Je]=je,le&&(je=le[ot],le[ot]=le[Je],le[Je]=je);Ne=qe}Ne++}}},ye=function(X,ae,le){var ze=X.split(""),nt={hiLevel:he};return le||(le=[]),ee(ze,le,nt),(function(je,Je,qe){if(qe.hiLevel!==0&&x)for(var ot,St=0;St<je.length;St++)Je[St]===1&&(ot=W.indexOf(je[St]))>=0&&(je[St]=W[ot+1])})(ze,le,nt),J(2,ze,ae,le,nt),J(1,ze,ae,le,nt),ze.join("")};return this.__bidiEngine__.doBidiReorder=function(X,ae,le){if((function(nt,je){if(je)for(var Je=0;Je<nt.length;Je++)je[Je]=Je;u===void 0&&(u=Ce(nt)),f===void 0&&(f=Ce(nt))})(X,ae),l||!h||f)if(l&&h&&u^f)he=u?1:0,X=pe(X,ae,le);else if(!l&&h&&f)he=u?1:0,X=ye(X,ae,le),X=pe(X,ae);else if(!l||u||h||f){if(l&&!h&&u^f)X=pe(X,ae),u?(he=0,X=ye(X,ae,le)):(he=1,X=ye(X,ae,le),X=pe(X,ae));else if(l&&u&&!h&&f)he=1,X=ye(X,ae,le),X=pe(X,ae);else if(!l&&!h&&u^f){var ze=x;u?(he=1,X=ye(X,ae,le),he=0,x=!1,X=ye(X,ae,le),x=ze):(he=0,X=ye(X,ae,le),X=pe(X,ae),he=1,x=!1,X=ye(X,ae,le),x=ze,X=pe(X,ae))}}else he=0,X=ye(X,ae,le);else he=u?1:0,X=ye(X,ae,le);return X},this.__bidiEngine__.setOptions=function(X){X&&(l=X.isInputVisual,h=X.isOutputVisual,u=X.isInputRtl,f=X.isOutputRtl,x=X.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(n){var r=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var u=0;for(l=[],u=0;u<r.length;u+=1)Object.prototype.toString.call(r[u])==="[object Array]"?l.push([t.doBidiReorder(r[u][0]),r[u][1],r[u][2]]):l.push([t.doBidiReorder(r[u])]);n.text=l}else n.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])})(In),In.API.TTFFont=(function(){function i(e){var t;if(this.rawData=e,t=this.contents=new ad(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new zW(this),this.registerTTF()}return i.open=function(e){return new i(e)},i.prototype.parse=function(){return this.directory=new EW(this.contents),this.head=new kW(this),this.name=new NW(this),this.cmap=new zD(this),this.toUnicode={},this.hhea=new CW(this),this.maxp=new PW(this),this.hmtx=new OW(this),this.post=new LW(this),this.os2=new RW(this),this.loca=new VW(this),this.glyf=new MW(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var e,t,n,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,u,h,f;for(f=[],l=0,u=(h=this.bbox).length;l<u;l++)e=h[l],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},i.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},i.prototype.widthOfString=function(e,t,n){var r,s,l,u;for(l=0,s=0,u=(e=""+e).length;0<=u?s<u:s>u;s=0<=u?++s:--s)r=e.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return l*(t/1e3)},i.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},i})();var Ou,ad=(function(){function i(e){this.data=e??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(e){return this.data[this.pos++]=e},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},i.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},i.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},i.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},i.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},i.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},i.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(e){return this.writeInt16(e)},i.prototype.readLongLong=function(){var e,t,n,r,s,l,u,h;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),l=this.readByte(),u=this.readByte(),h=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^s)+65536*(255^l)+256*(255^u)+(255^h)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*s+65536*l+256*u+h},i.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(e){return this.writeInt32(e)},i.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},i.prototype.write=function(e){var t,n,r,s;for(s=[],n=0,r=e.length;n<r;n++)t=e[n],s.push(this.writeByte(t));return s},i})(),EW=(function(){var i;function e(t){var n,r,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,r,s,l,u,h,f,x,g,w,A,B,$;for($ in A=Object.keys(t).length,h=Math.log(2),g=16*Math.floor(Math.log(A)/h),l=Math.floor(g/h),x=16*A-g,(r=new ad).writeInt(this.scalarType),r.writeShort(A),r.writeShort(g),r.writeShort(l),r.writeShort(x),s=16*A,f=r.pos+s,u=null,B=[],t)for(w=t[$],r.writeString($),r.writeInt(i(w)),r.writeInt(f),r.writeInt(w.length),B=B.concat(w),$==="head"&&(u=f),f+=w.length;f%4;)B.push(0),f++;return r.write(B),n=2981146554-i(r.data),r.pos=u+8,r.writeUInt32(n),r.data},i=function(t){var n,r,s,l;for(t=UD.call(t);t.length%4;)t.push(0);for(s=new ad(t),r=0,n=0,l=t.length;n<l;n=n+=4)r+=s.readUInt32();return 4294967295&r},e})(),IW={}.hasOwnProperty,uc=function(i,e){for(var t in e)IW.call(e,t)&&(i[t]=e[t]);function n(){this.constructor=i}return n.prototype=e.prototype,i.prototype=new n,i.__super__=e.prototype,i};Ou=(function(){function i(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i})();var kW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="head",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},i.prototype.encode=function(e){var t;return(t=new ad).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},i})(),zk=(function(){function i(e,t){var n,r,s,l,u,h,f,x,g,w,A,B,$,W,q,ge,he;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(h=0;h<256;++h)this.codeMap[h]=e.readByte();break;case 4:for(A=e.readUInt16(),w=A/2,e.pos+=6,s=(function(){var me,Ce;for(Ce=[],h=me=0;0<=w?me<w:me>w;h=0<=w?++me:--me)Ce.push(e.readUInt16());return Ce})(),e.pos+=2,$=(function(){var me,Ce;for(Ce=[],h=me=0;0<=w?me<w:me>w;h=0<=w?++me:--me)Ce.push(e.readUInt16());return Ce})(),f=(function(){var me,Ce;for(Ce=[],h=me=0;0<=w?me<w:me>w;h=0<=w?++me:--me)Ce.push(e.readUInt16());return Ce})(),x=(function(){var me,Ce;for(Ce=[],h=me=0;0<=w?me<w:me>w;h=0<=w?++me:--me)Ce.push(e.readUInt16());return Ce})(),r=(this.length-e.pos+this.offset)/2,u=(function(){var me,Ce;for(Ce=[],h=me=0;0<=r?me<r:me>r;h=0<=r?++me:--me)Ce.push(e.readUInt16());return Ce})(),h=q=0,he=s.length;q<he;h=++q)for(W=s[h],n=ge=B=$[h];B<=W?ge<=W:ge>=W;n=B<=W?++ge:--ge)x[h]===0?l=n+f[h]:(l=u[x[h]/2+(n-B)-(w-h)]||0)!==0&&(l+=f[h]),this.codeMap[n]=65535&l}e.pos=g}return i.encode=function(e,t){var n,r,s,l,u,h,f,x,g,w,A,B,$,W,q,ge,he,me,Ce,Ve,pe,ee,J,ye,X,ae,le,ze,nt,je,Je,qe,ot,St,Ne,se,Ee,De,Be,$e,Ye,ct,ut,Tt,Ft,Wt;switch(ze=new ad,l=Object.keys(e).sort(function(qt,Et){return qt-Et}),t){case"macroman":for($=0,W=(function(){var qt=[];for(B=0;B<256;++B)qt.push(0);return qt})(),ge={0:0},s={},nt=0,ot=l.length;nt<ot;nt++)ge[ut=e[r=l[nt]]]==null&&(ge[ut]=++$),s[r]={old:e[r],new:ge[e[r]]},W[r]=ge[e[r]];return ze.writeUInt16(1),ze.writeUInt16(0),ze.writeUInt32(12),ze.writeUInt16(0),ze.writeUInt16(262),ze.writeUInt16(0),ze.write(W),{charMap:s,subtable:ze.data,maxGlyphID:$+1};case"unicode":for(ae=[],g=[],he=0,ge={},n={},q=f=null,je=0,St=l.length;je<St;je++)ge[Ce=e[r=l[je]]]==null&&(ge[Ce]=++he),n[r]={old:Ce,new:ge[Ce]},u=ge[Ce]-r,q!=null&&u===f||(q&&g.push(q),ae.push(r),f=u),q=r;for(q&&g.push(q),g.push(65535),ae.push(65535),ye=2*(J=ae.length),ee=2*Math.pow(Math.log(J)/Math.LN2,2),w=Math.log(ee/2)/Math.LN2,pe=2*J-ee,h=[],Ve=[],A=[],B=Je=0,Ne=ae.length;Je<Ne;B=++Je){if(X=ae[B],x=g[B],X===65535){h.push(0),Ve.push(0);break}if(X-(le=n[X].new)>=32768)for(h.push(0),Ve.push(2*(A.length+J-B)),r=qe=X;X<=x?qe<=x:qe>=x;r=X<=x?++qe:--qe)A.push(n[r].new);else h.push(le-X),Ve.push(0)}for(ze.writeUInt16(3),ze.writeUInt16(1),ze.writeUInt32(12),ze.writeUInt16(4),ze.writeUInt16(16+8*J+2*A.length),ze.writeUInt16(0),ze.writeUInt16(ye),ze.writeUInt16(ee),ze.writeUInt16(w),ze.writeUInt16(pe),Ye=0,se=g.length;Ye<se;Ye++)r=g[Ye],ze.writeUInt16(r);for(ze.writeUInt16(0),ct=0,Ee=ae.length;ct<Ee;ct++)r=ae[ct],ze.writeUInt16(r);for(Tt=0,De=h.length;Tt<De;Tt++)u=h[Tt],ze.writeUInt16(u);for(Ft=0,Be=Ve.length;Ft<Be;Ft++)me=Ve[Ft],ze.writeUInt16(me);for(Wt=0,$e=A.length;Wt<$e;Wt++)$=A[Wt],ze.writeUInt16($);return{charMap:n,subtable:ze.data,maxGlyphID:he+1}}},i})(),zD=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="cmap",i.prototype.parse=function(e){var t,n,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t=new zk(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},i.encode=function(e,t){var n,r;return t==null&&(t="macroman"),n=zk.encode(e,t),(r=new ad).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},i})(),CW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="hhea",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},i})(),RW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="OS/2",i.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n})(),this.charRange=(function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},i})(),LW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="post",i.prototype.parse=function(e){var t,n,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var l,u,h;for(h=[],s=l=0,u=this.file.maxp.numGlyphs;0<=u?l<u:l>u;s=0<=u?++l:--l)h.push(e.readUInt32());return h}).call(this)}},i})(),DW=function(i,e){this.raw=i,this.length=i.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},NW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="name",i.prototype.parse=function(e){var t,n,r,s,l,u,h,f,x,g,w;for(e.pos=this.offset,e.readShort(),t=e.readShort(),u=e.readShort(),n=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+u+e.readShort()});for(h={},s=x=0,g=n.length;x<g;s=++x)r=n[s],e.pos=r.offset,f=e.readString(r.length),l=new DW(f,r),h[w=r.nameID]==null&&(h[w]=[]),h[r.nameID].push(l);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},i})(),PW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="maxp",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},i})(),OW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="hmtx",i.prototype.parse=function(e){var t,n,r,s,l,u,h;for(e.pos=this.offset,this.metrics=[],t=0,u=this.file.hhea.numberOfMetrics;0<=u?t<u:t>u;t=0<=u?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,x;for(x=[],t=f=0;0<=r?f<r:f>r;t=0<=r?++f:--f)x.push(e.readInt16());return x})(),this.widths=(function(){var f,x,g,w;for(w=[],f=0,x=(g=this.metrics).length;f<x;f++)s=g[f],w.push(s.advance);return w}).call(this),n=this.widths[this.widths.length-1],h=[],t=l=0;0<=r?l<r:l>r;t=0<=r?++l:--l)h.push(this.widths.push(n));return h},i.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},i})(),UD=[].slice,MW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(e){var t,n,r,s,l,u,h,f,x,g;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,n=s.indexOf(e),(r=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+n,l=(u=new ad(t.read(r))).readShort(),f=u.readShort(),g=u.readShort(),h=u.readShort(),x=u.readShort(),this.cache[e]=l===-1?new jW(u,f,g,h,x):new FW(u,l,f,g,h,x),this.cache[e]))},i.prototype.encode=function(e,t,n){var r,s,l,u,h;for(l=[],s=[],u=0,h=t.length;u<h;u++)r=e[t[u]],s.push(l.length),r&&(l=l.concat(r.encode(n)));return s.push(l.length),{table:l,offsets:s}},i})(),FW=(function(){function i(e,t,n,r,s,l){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=s,this.yMax=l,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i})(),jW=(function(){function i(e,t,n,r,s){var l,u;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;u=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&u;)l.pos+=1&u?4:2,128&u?l.pos+=8:64&u?l.pos+=4:8&u&&(l.pos+=2)}return i.prototype.encode=function(){var e,t,n;for(t=new ad(UD.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},i})(),VW=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return uc(i,Ou),i.prototype.tag="loca",i.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var r,s;for(s=[],n=0,r=this.length;n<r;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var r,s;for(s=[],n=0,r=this.length;n<r;n+=4)s.push(e.readUInt32());return s}).call(this)},i.prototype.indexOf=function(e){return this.offsets[e]},i.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},i.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),r=0,s=0,l=0;l<n.length;++l)if(n[l]=r,s<t.length&&t[s]==l){++s,n[l]=r;var u=this.offsets[l],h=this.offsets[l+1]-u;h>0&&(r+=h)}for(var f=new Array(4*n.length),x=0;x<n.length;++x)f[4*x+3]=255&n[x],f[4*x+2]=(65280&n[x])>>8,f[4*x+1]=(16711680&n[x])>>16,f[4*x]=(4278190080&n[x])>>24;return f},i})(),zW=(function(){function i(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var e,t,n,r,s;for(t in r=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[t],e[t]=r[n];return e},i.prototype.glyphsFor=function(e){var t,n,r,s,l,u,h;for(r={},l=0,u=e.length;l<u;l++)r[s=e[l]]=this.font.glyf.glyphFor(s);for(s in t=[],r)(n=r[s])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(s in h=this.glyphsFor(t))n=h[s],r[s]=n;return r},i.prototype.encode=function(e,t){var n,r,s,l,u,h,f,x,g,w,A,B,$,W,q;for(r in n=zD.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),A={0:0},q=n.charMap)A[(h=q[r]).old]=h.new;for(B in w=n.maxGlyphID,l)B in A||(A[B]=w++);return x=(function(ge){var he,me;for(he in me={},ge)me[ge[he]]=he;return me})(A),g=Object.keys(x).sort(function(ge,he){return ge-he}),$=(function(){var ge,he,me;for(me=[],ge=0,he=g.length;ge<he;ge++)u=g[ge],me.push(x[u]);return me})(),s=this.font.glyf.encode(l,$,A),f=this.font.loca.encode(s.offsets,$),W={cmap:this.font.cmap.raw(),glyf:s.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(W["OS/2"]=this.font.os2.raw()),this.font.directory.encode(W)},i})();In.API.PDFObject=(function(){var i;function e(){}return i=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,r,s,l;if(Array.isArray(t))return"["+(function(){var u,h,f;for(f=[],u=0,h=t.length;u<h;u++)n=t[u],f.push(e.convert(n));return f})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+i(t.getUTCFullYear(),4)+i(t.getUTCMonth(),2)+i(t.getUTCDate(),2)+i(t.getUTCHours(),2)+i(t.getUTCMinutes(),2)+i(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in s=["<<"],t)l=t[r],s.push("/"+r+" "+e.convert(l));return s.push(">>"),s.join(`
`)}return""+t},e})();const P0=Ul("Share",{web:()=>Vt(()=>import("./chunk-1765759384263-web10.js"),[]).then(i=>new i.ShareWeb)}),pY=Object.freeze(Object.defineProperty({__proto__:null,Share:P0},Symbol.toStringTag,{value:"Module"}));class UW{async savePDFMobile(e,t){try{if(bo.isNativePlatform()){const n=e.output("datauristring").split(",")[1],r=await I0.writeFile({path:t,data:n,directory:rp.Cache});await P0.share({title:"Helio Health Report",text:"Your health report from Helio",url:r.uri,dialogTitle:"Share your report"}),alert(" PDF ready to share!")}else e.save(t)}catch(n){alert("Failed to save PDF: "+n.message)}}async exportDailyStats(e){const t=new In,n=new Date().toLocaleDateString();t.setFontSize(20),t.text("Helio Daily Health Report",20,20),t.setFontSize(12),t.text(`Date: ${n}`,20,30),t.setFontSize(14),t.text("Daily Activity Summary",20,45),t.setFontSize(11);let r=55;t.text(`Steps: ${e.todaySteps} / ${e.goalSteps}`,25,r),r+=8,t.text(`Water: ${e.waterCups} / 8 cups`,25,r),r+=8,t.text(`Meals Logged: ${e.mealsLogged}`,25,r),r+=8,t.text(`Streak: ${e.streak} days`,25,r),r+=8,t.text(`Level: ${e.level} | XP: ${e.xp}`,25,r),r+=8,t.text(`Wellness Score: ${e.wellnessScore}/100`,25,r),r+=15,t.setFontSize(14),t.text("Weekly Steps Summary",20,r),r+=10,t.setFontSize(10);const s=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];e.weeklySteps?.forEach((l,u)=>{t.text(`${s[u]}: ${l.steps||0} steps`,25,r),r+=7}),t.setFontSize(8),t.text("Generated by Helio/WellnessAI",20,280),t.text("This report is for informational purposes only",20,285),await this.savePDFMobile(t,`helio-daily-report-${n.replace(/\//g,"-")}.pdf`)}async exportWorkoutHistory(){const e=new In,t=JSON.parse(localStorage.getItem("workoutHistory")||"[]"),n=new Date().toLocaleDateString();e.setFontSize(20),e.text("Workout History",20,20),e.setFontSize(12),e.text(`Total Workouts: ${t.length}`,20,30),e.text(`Exported: ${n}`,20,37),e.setFontSize(11);let r=50;t.length===0?e.text("No workouts logged yet",25,r):t.slice(0,30).forEach((s,l)=>{r>270&&(e.addPage(),r=20);const u=new Date(s.date).toLocaleDateString();e.text(`${l+1}. ${s.name}`,25,r),r+=6,e.setFontSize(9),e.text(`   Date: ${u} | Duration: ${s.duration||"N/A"} | Calories: ${s.calories||"N/A"}`,25,r),r+=8,e.setFontSize(11)}),e.setFontSize(8),e.text("Generated by Helio/WellnessAI",20,285),await this.savePDFMobile(e,`helio-workout-history-${n.replace(/\//g,"-")}.pdf`)}async exportFoodLog(){const e=new In,t=JSON.parse(localStorage.getItem("foodLog")||"[]"),n=new Date().toISOString().split("T")[0],r=new Date;r.setDate(r.getDate()-30);const s=t.filter(W=>new Date(W.timestamp||W.date)>=r).sort((W,q)=>new Date(q.timestamp||q.date)-new Date(W.timestamp||W.date));e.setFontSize(20),e.text("Complete Nutrition History",20,20),e.setFontSize(12),e.text("Period: Last 30 Days",20,30),e.text(`Total Meals: ${s.length}`,20,37);let l=0,u=0,h=0,f=0;s.forEach(W=>{l+=W.calories||0,u+=W.protein||0,h+=W.carbs||0,f+=W.fat||0});const x=Math.max(1,s.length>0?30:1),g=Math.round(l/x),w=Math.round(u/x),A=Math.round(h/x),B=Math.round(f/x);e.setFontSize(14),e.text("30-Day Totals & Averages",20,50),e.setFontSize(11),e.text(`Total Calories: ${l} kcal (Avg: ${g}/day)`,25,58),e.text(`Total Protein: ${u}g (Avg: ${w}g/day)`,25,65),e.text(`Total Carbs: ${h}g (Avg: ${A}g/day)`,25,72),e.text(`Total Fat: ${f}g (Avg: ${B}g/day)`,25,79),e.setFontSize(14),e.text("Recent Meals (Last 30 Days)",20,95),e.setFontSize(10);let $=105;s.length===0?e.text("No foods logged in last 30 days",25,$):s.slice(0,100).forEach((W,q)=>{$>270&&(e.addPage(),$=20);const ge=new Date(W.timestamp||W.date),he=ge.toLocaleDateString(),me=ge.toLocaleTimeString();e.text(`${q+1}. ${W.name}`,25,$),$+=5,e.setFontSize(8),e.text(`   ${he} ${me} | ${W.calories}cal | P:${W.protein}g C:${W.carbs}g F:${W.fat}g`,25,$),$+=8,e.setFontSize(10)}),e.setFontSize(8),e.text("Generated by Helio/WellnessAI",20,285),await this.savePDFMobile(e,`helio-nutrition-${n}.pdf`)}async exportFullReport(e){const t=new In,n=new Date().toLocaleDateString();t.setFontSize(24),t.text("Helio Health Report",20,30),t.setFontSize(14),t.text("Complete Wellness Summary",20,45),t.setFontSize(12),t.text(`Generated: ${n}`,20,55),t.text(`User: ${localStorage.getItem("userName")||"User"}`,20,62),t.addPage(),t.setFontSize(18),t.text("Activity & Fitness",20,20),t.setFontSize(11);let r=35;t.text(`Steps Today: ${e.todaySteps}`,25,r),r+=8,t.text(`Goal: ${e.goalSteps} steps`,25,r),r+=8,t.text(`Completion: ${Math.round(e.todaySteps/e.goalSteps*100)}%`,25,r),r+=8,t.text(`Active Streak: ${e.streak} days`,25,r),r+=8,t.text(`Level: ${e.level} (${e.xp} XP)`,25,r),r+=15,t.setFontSize(14),t.text("Weekly Steps",25,r),r+=10,t.setFontSize(10);const s=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];e.weeklySteps?.forEach((x,g)=>{t.text(`${s[g]}: ${x.steps||0} steps`,30,r),r+=7}),t.addPage(),t.setFontSize(18),t.text("Workouts & Nutrition",20,20),t.setFontSize(14),r=35;const l=JSON.parse(localStorage.getItem("workoutHistory")||"[]"),u=l.length,h=l.reduce((x,g)=>x+(g.calories||0),0),f=l.filter(x=>{const g=new Date(x.date),w=new Date;return w.setDate(w.getDate()-7),g>=w}).length;t.text("Workout Summary",25,r),r+=10,t.setFontSize(11),t.text(`Total Workouts: ${u}`,30,r),r+=7,t.text(`Workouts Last 7 Days: ${f}`,30,r),r+=7,t.text(`Total Calories Burned: ${h}`,30,r),r+=15,t.setFontSize(14),t.text("Nutrition & Hydration",25,r),r+=10,t.setFontSize(11),t.text(`Water Intake Today: ${e.waterCups} / 8 cups`,30,r),r+=7,t.text(`Meals Logged Today: ${e.mealsLogged}`,30,r),r+=7,t.text(`Hydration Level: ${Math.round(e.waterCups/8*100)}%`,30,r),r+=15,t.addPage(),t.setFontSize(18),t.text("Health Monitoring & Wellness",20,20),t.setFontSize(14),r=35,t.text("24/7 Health Monitoring",25,r),r+=10,t.setFontSize(11),t.text(`Heart Rate: ${e.heartRate?e.heartRate+" bpm":"Not monitored"}`,30,r),r+=7,t.text(`Sleep Last Night: ${e.sleepHours?e.sleepHours+" hours":"Not tracked"}`,30,r),r+=7,t.text("Fall Detection: Active",30,r),r+=7,t.text("Emergency Features: Enabled",30,r),r+=15,t.setFontSize(14),t.text("Wellness Analysis",25,r),r+=10,t.setFontSize(11),t.text(`Overall Wellness Score: ${e.wellnessScore}/100`,25,r),r+=10,t.setFontSize(10),t.text("This score is calculated based on:",25,r),r+=7,t.text(" Daily activity and steps",30,r),r+=6,t.text(" Nutrition and hydration",30,r),r+=6,t.text(" Sleep quality",30,r),r+=6,t.text(" Consistency and streaks",30,r),r+=6,t.text(" Mental wellness activities",30,r),t.setFontSize(8),t.text("Generated by Helio/WellnessAI",20,280),t.text("This report is for informational purposes only and not medical advice",20,285),await this.savePDFMobile(t,`helio-full-report-${n.replace(/\//g,"-")}.pdf`)}async exportWorkoutHistoryCSV(){try{const e=JSON.parse(localStorage.getItem("workoutHistory")||"[]"),t=new Date().toLocaleDateString().replace(/\//g,"-");if(e.length===0){alert("No workout data to export");return}let n=`Date,Workout Name,Type,Duration (min),Calories,Sets,Reps,Notes
`;if(e.forEach(r=>{const s=new Date(r.date).toLocaleDateString(),l=(r.name||"Workout").replace(/,/g,";"),u=r.type||"General",h=r.duration||"N/A",f=r.calories||0,x=r.sets||"N/A",g=r.reps||"N/A",w=(r.notes||"").replace(/,/g,";").replace(/\n/g," ");n+=`${s},${l},${u},${h},${f},${x},${g},${w}
`}),bo.isNativePlatform()){const r=btoa(unescape(encodeURIComponent(n))),s=await I0.writeFile({path:`helio-workouts-${t}.csv`,data:r,directory:rp.Cache});await P0.share({title:"Helio Workout History",text:"Your workout history CSV",url:s.uri,dialogTitle:"Share workout data"}),alert(" CSV ready to share!")}else{const r=new Blob([n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(r),s.download=`helio-workouts-${t}.csv`,s.click()}}catch(e){console.error(" CSV export error:",e),alert("Failed to export CSV: "+e.message)}}async exportFoodLogCSV(){try{const e=JSON.parse(localStorage.getItem("foodLog")||"[]"),t=new Date().toLocaleDateString().replace(/\//g,"-"),n=new Date;n.setDate(n.getDate()-30);const r=e.filter(l=>new Date(l.timestamp||l.date)>=n).sort((l,u)=>new Date(u.timestamp||u.date)-new Date(l.timestamp||l.date));if(r.length===0){alert("No food data to export");return}let s=`Date,Time,Food Name,Calories,Protein (g),Carbs (g),Fat (g),Meal Type
`;if(r.forEach(l=>{const u=new Date(l.timestamp||l.date),h=u.toLocaleDateString(),f=u.toLocaleTimeString(),x=(l.name||"Food").replace(/,/g,";"),g=l.calories||0,w=l.protein||0,A=l.carbs||0,B=l.fat||0,$=l.mealType||"Snack";s+=`${h},${f},${x},${g},${w},${A},${B},${$}
`}),bo.isNativePlatform()){const l=btoa(unescape(encodeURIComponent(s))),u=await I0.writeFile({path:`helio-nutrition-${t}.csv`,data:l,directory:rp.Cache});await P0.share({title:"Helio Nutrition History",text:"Your nutrition history CSV",url:u.uri,dialogTitle:"Share nutrition data"}),alert(" CSV ready to share!")}else{const l=new Blob([s],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.href=URL.createObjectURL(l),u.download=`helio-nutrition-${t}.csv`,u.click()}}catch(e){console.error(" CSV export error:",e),alert("Failed to export CSV: "+e.message)}}}const Dh=new UW;class BW{constructor(){this.authorizedDeviceIds=["85e89dbedd0cda70","a8f5d227622e766f","CPH2551","OPPO CPH2551","cph2551","oppo cph2551"],this.devPassword="helio2025dev",this.isDevMode=!1,this.storageKey="helio_dev_mode"}async initialize(){try{if(!bo.isNativePlatform())return this.isDevMode=!1,!1;const t=(await Hf.getId()).identifier;return this.authorizedDeviceIds.some(s=>t.includes(s)||s.includes(t))?(localStorage.getItem(this.storageKey)==="true"&&(this.isDevMode=!0),!0):(this.isDevMode=!1,!1)}catch{return!1}}async isAuthorizedDevice(){try{if(!bo.isNativePlatform())return!1;const e=await Hf.getId(),n=(e.identifier||e.uuid||"").toLowerCase(),r=this.authorizedDeviceIds.some(s=>{const l=s.toLowerCase(),u=n.includes(l)||l.includes(n);return u});return r}catch{return!1}}async unlockDevMode(e){try{if(bo.isNativePlatform()){const n=await Hf.getId()}return await this.isAuthorizedDevice()?e===this.devPassword?(this.isDevMode=!0,localStorage.setItem(this.storageKey,"true"),{success:!0,message:"Developer mode enabled"}):{success:!1,message:"Incorrect password"}:{success:!1,message:"Unauthorized device - Check console for device ID"}}catch{return{success:!1,message:"Authentication failed"}}}lockDevMode(){this.isDevMode=!1,localStorage.removeItem(this.storageKey)}isDevModeActive(){return this.isDevMode}async getDeviceInfo(){try{const e=await Hf.getInfo(),t=await Hf.getId();return{...e,identifier:t.identifier,isAuthorized:await this.isAuthorizedDevice()}}catch{return null}}changePassword(e,t){return e===this.devPassword?(this.devPassword=t,!0):!1}resetAuthorization(){localStorage.removeItem("authorized_device_id"),localStorage.removeItem(this.storageKey),this.authorizedDeviceId=null,this.isDevMode=!1}}const Pb=new BW,Uk="G-N7GR8ES3GW";class $W{constructor(){this.events=[],this.sessionStart=Date.now(),this.sessionId=this.generateSessionId(),this.maxEvents=1e3,this.analyticsInitialized=!1}initGoogleAnalytics(){if(this.analyticsInitialized)return;const e=document.createElement("script");e.async=!0,e.src=`https://www.googletagmanager.com/gtag/js?id=${Uk}`,document.head.appendChild(e),window.dataLayer=window.dataLayer||[];function t(){window.dataLayer.push(arguments)}window.gtag=t,t("js",new Date),t("config",Uk,{send_page_view:!1,app_name:"Helio WellnessAI",app_version:"1.0.0"}),this.analyticsInitialized=!0}generateSessionId(){return`analytics_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}trackPageView(e){this.trackEvent("page_view",{page:e,url:window.location.href}),window.gtag&&window.gtag("event","screen_view",{screen_name:e,app_name:"Helio WellnessAI"})}trackFeatureUse(e,t={}){this.trackEvent("feature_use",{feature:e,...t}),window.gtag&&window.gtag("event","feature_use",{feature_name:e,...t})}trackAction(e,t={}){this.trackEvent("user_action",{action:e,...t}),window.gtag&&window.gtag("event",e,{event_category:"engagement",...t})}trackConversion(e,t=0){this.trackEvent("conversion",{type:e,value:t}),window.gtag&&window.gtag("event","conversion",{conversion_type:e,value:t,currency:"GBP"})}trackPerformance(e,t){this.trackEvent("performance",{metric:e,duration:t})}trackEvent(e,t={}){const n={type:e,data:t,timestamp:new Date().toISOString(),sessionId:this.sessionId,sessionDuration:Date.now()-this.sessionStart};this.events.push(n),this.events.length>this.maxEvents&&this.events.shift(),this.saveEvents()}saveEvents(){try{localStorage.setItem("analytics_events",JSON.stringify(this.events))}catch{this.events=this.events.slice(-500),localStorage.setItem("analytics_events",JSON.stringify(this.events))}}loadEvents(){try{const e=localStorage.getItem("analytics_events");e&&(this.events=JSON.parse(e))}catch{}}getStats(){const e={totalEvents:this.events.length,sessionDuration:Date.now()-this.sessionStart,eventsByType:{},mostUsedFeatures:[],pageViews:[]};this.events.forEach(n=>{e.eventsByType[n.type]=(e.eventsByType[n.type]||0)+1});const t={};return this.events.filter(n=>n.type==="feature_use").forEach(n=>{const r=n.data.feature;t[r]=(t[r]||0)+1}),e.mostUsedFeatures=Object.entries(t).sort((n,r)=>r[1]-n[1]).slice(0,10).map(([n,r])=>({name:n,count:r})),e.pageViews=this.events.filter(n=>n.type==="page_view").map(n=>({page:n.data.page,timestamp:n.timestamp})),e}getEngagementMetrics(){const e=Date.now(),t=e-1440*60*1e3,n=e-10080*60*1e3,r=this.events.filter(l=>new Date(l.timestamp).getTime()>t),s=this.events.filter(l=>new Date(l.timestamp).getTime()>n);return{dailyActiveUse:r.length>0,eventsLast24h:r.length,eventsLast7days:s.length,averageSessionLength:(Date.now()-this.sessionStart)/1e3,totalSessions:1}}clearAnalytics(){this.events=[],localStorage.removeItem("analytics_events")}exportAnalytics(){return{sessionId:this.sessionId,events:this.events,stats:this.getStats(),engagement:this.getEngagementMetrics(),exportDate:new Date().toISOString()}}}const BD=new $W;BD.loadEvents();const Sr=BD;class GW{constructor(){this.conversationHistory=[],this.userPreferences={},this.userContext={},this.maxHistoryLength=50}async initialize(){try{const{value:e}=await gn.get({key:"ai_conversation_history"});e&&(this.conversationHistory=JSON.parse(e));const{value:t}=await gn.get({key:"ai_user_preferences"});t&&(this.userPreferences=JSON.parse(t));const{value:n}=await gn.get({key:"ai_user_context"});return n&&(this.userContext=JSON.parse(n)),!0}catch{return!1}}async addConversation(e,t,n="general"){const r={id:Date.now(),timestamp:new Date().toISOString(),userMessage:e,aiResponse:t,topic:n,date:new Date().toLocaleDateString()};return this.conversationHistory.push(r),this.conversationHistory.length>this.maxHistoryLength&&(this.conversationHistory=this.conversationHistory.slice(-this.maxHistoryLength)),await this.extractPreferences(e,t),await this.saveConversationHistory(),r}async extractPreferences(e,t){const n=e.toLowerCase();(n.includes("like")||n.includes("love")||n.includes("favorite"))&&(n.includes("chicken")&&(this.userPreferences.likesChicken=!0),n.includes("fish")&&(this.userPreferences.likesFish=!0),n.includes("vegetable")&&(this.userPreferences.likesVegetables=!0),n.includes("fruit")&&(this.userPreferences.likesFruits=!0),n.includes("salad")&&(this.userPreferences.likesSalads=!0)),(n.includes("hate")||n.includes("dislike")||n.includes("don't like"))&&(n.includes("broccoli")&&(this.userPreferences.dislikesBroccoli=!0),n.includes("spinach")&&(this.userPreferences.dislikesSpinach=!0)),n.includes("vegetarian")&&(this.userPreferences.vegetarian=!0),n.includes("vegan")&&(this.userPreferences.vegan=!0),n.includes("keto")&&(this.userPreferences.keto=!0),n.includes("paleo")&&(this.userPreferences.paleo=!0),(n.includes("gluten free")||n.includes("gluten-free"))&&(this.userPreferences.glutenFree=!0),n.includes("gym")&&(this.userPreferences.likesGym=!0),(n.includes("running")||n.includes("run"))&&(this.userPreferences.likesRunning=!0),n.includes("yoga")&&(this.userPreferences.likesYoga=!0),n.includes("cardio")&&(this.userPreferences.likesCardio=!0),(n.includes("weights")||n.includes("lifting"))&&(this.userPreferences.likesWeightlifting=!0),(n.includes("lose weight")||n.includes("weight loss"))&&(this.userPreferences.goalWeightLoss=!0),(n.includes("build muscle")||n.includes("gain muscle"))&&(this.userPreferences.goalMuscleGain=!0),(n.includes("get fit")||n.includes("fitness"))&&(this.userPreferences.goalFitness=!0),await this.savePreferences()}getConversationContext(e=10){return this.conversationHistory.slice(-e).map(n=>({user:n.userMessage,ai:n.aiResponse,topic:n.topic}))}getPreferencesSummary(){const e=[];return this.userPreferences.likesChicken&&e.push("likes chicken"),this.userPreferences.likesFish&&e.push("likes fish"),this.userPreferences.likesVegetables&&e.push("likes vegetables"),this.userPreferences.dislikesBroccoli&&e.push("dislikes broccoli"),this.userPreferences.vegetarian&&e.push("vegetarian"),this.userPreferences.vegan&&e.push("vegan"),this.userPreferences.keto&&e.push("follows keto diet"),this.userPreferences.glutenFree&&e.push("gluten-free"),this.userPreferences.likesGym&&e.push("enjoys gym workouts"),this.userPreferences.likesRunning&&e.push("enjoys running"),this.userPreferences.likesYoga&&e.push("practices yoga"),this.userPreferences.goalWeightLoss&&e.push("goal: lose weight"),this.userPreferences.goalMuscleGain&&e.push("goal: build muscle"),this.userPreferences.goalFitness&&e.push("goal: improve fitness"),e.join(", ")}buildContextualPrompt(e){const t=[],n=this.getPreferencesSummary();n&&t.push(`User preferences: ${n}`);const r=this.getConversationContext(5);return r.length>0&&(t.push("Previous conversations:"),r.forEach((l,u)=>{t.push(`${u+1}. User: "${l.user}" AI: "${l.ai.substring(0,100)}..."`)})),Object.keys(this.userContext).length>0&&t.push(`User context: ${JSON.stringify(this.userContext)}`),t.length>0?`CONTEXT (remember this about the user):
${t.join(`
`)}

USER MESSAGE: ${e}`:e}async updateUserContext(e){this.userContext={...this.userContext,...e,lastUpdated:new Date().toISOString()},await gn.set({key:"ai_user_context",value:JSON.stringify(this.userContext)})}getConversationsByTopic(e){return this.conversationHistory.filter(t=>t.topic===e)}searchConversations(e){const t=e.toLowerCase();return this.conversationHistory.filter(n=>n.userMessage.toLowerCase().includes(t)||n.aiResponse.toLowerCase().includes(t))}async clearOldConversations(){const e=Date.now()-2592e6;this.conversationHistory=this.conversationHistory.filter(t=>new Date(t.timestamp).getTime()>e),await this.saveConversationHistory()}async saveConversationHistory(){try{await gn.set({key:"ai_conversation_history",value:JSON.stringify(this.conversationHistory)})}catch{}}async savePreferences(){try{await gn.set({key:"ai_user_preferences",value:JSON.stringify(this.userPreferences)})}catch{}}getMemoryStats(){return{totalConversations:this.conversationHistory.length,preferencesLearned:Object.keys(this.userPreferences).length,contextData:Object.keys(this.userContext).length,oldestConversation:this.conversationHistory[0]?.date||"None",newestConversation:this.conversationHistory[this.conversationHistory.length-1]?.date||"None"}}async resetMemory(){this.conversationHistory=[],this.userPreferences={},this.userContext={},await gn.remove({key:"ai_conversation_history"}),await gn.remove({key:"ai_user_preferences"}),await gn.remove({key:"ai_user_context"})}}const Wx=new GW,qx=async(i,e={})=>{try{const t=Wx.buildContextualPrompt(i),n=await fetch("https://helio-wellness-app-production.up.railway.app/api/chat",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({message:t}),mode:"cors"});if(!n.ok){const s=await n.text();throw new Error(`API request failed: ${n.status}`)}const r=await n.json();return await Wx.addConversation(i,r.response,e.topic||"general"),r.response}catch(t){throw t}},$D=async i=>{try{const e=getGeminiVisionModel(),t=await YD(i);return(await(await e.generateContent([`Analyze this progress photo for fitness tracking. Provide:
1. Observable physical changes or current state
2. Areas of visible progress (if comparing to baseline)
3. Encouraging feedback
4. One specific tip for improvement

Keep it positive and motivating!`,t])).response).text()}catch{return"Photo uploaded! I'll analyze your progress. Keep taking regular photos to track changes!"}},GD=async i=>{try{const e=getGeminiVisionModel(),t=await YD(i);return(await(await e.generateContent([`Analyze this food photo. Provide:
1. Food items identified
2. Estimated portion sizes
3. Total calories (estimate)
4. Protein, carbs, and fat breakdown (in grams)
5. Brief nutritional assessment

Format response as:
 MEAL: [meal name]
 CALORIES: [number] kcal
 PROTEIN: [number]g | CARBS: [number]g | FAT: [number]g
 TIP: [one healthy tip]`,t])).response).text()}catch{return"Meal logged! For accurate tracking, try to include variety and watch portion sizes."}},HD=async i=>{try{const e=`Create a personalized workout plan for:
- Fitness Level: ${i.fitnessLevel||"Beginner"}
- Goal: ${i.goal||"General fitness"}
- Available Time: ${i.timeAvailable||"30 minutes"}
- Equipment: ${i.equipment||"Bodyweight only"}

Provide:
1. Warm-up (5 min)
2. Main workout (3-5 exercises with sets/reps)
3. Cool-down (5 min)

Make it practical and achievable!`;return(await(await model.generateContent(e)).response).text()}catch{return"Start with: 10 squats, 10 push-ups (or knee push-ups), 30 sec plank, 20 jumping jacks. Repeat 3 times!"}},KD=async i=>{try{const e=`Create a daily meal plan for:
- Goal: ${i.goal||"Balanced nutrition"}
- Calories: ${i.targetCalories||"2000"} kcal/day
- Dietary Preferences: ${i.dietPreference||"None"}
- Meals: Breakfast, Lunch, Dinner, 1 Snack

For each meal provide:
- Meal name
- Key ingredients
- Approximate calories
- Quick prep tip

Keep meals simple and realistic!`;return(await(await model.generateContent(e)).response).text()}catch{return"Focus on: Lean protein, whole grains, lots of vegetables, healthy fats, and stay hydrated!"}},WD=async i=>{try{const e=`Analyze this user's wellness habits and provide insights:

Habit Data:
- Workouts completed: ${i.workouts||0}
- Meals logged: ${i.meals||0}
- Current streak: ${i.streak||0} days
- Skipped days pattern: ${i.skippedDays||"None"}
- Best time for activity: ${i.bestTime||"Not identified"}

Provide:
1. One major pattern noticed
2. One specific recommendation to improve consistency
3. One motivational insight

Keep it brief and actionable!`;return(await(await model.generateContent(e)).response).text()}catch{return"You're building great habits! Consistency is key. Try setting a specific time each day for your wellness routine."}},qD=async i=>{try{const e=`Generate a motivational message for a wellness app user:
- Current streak: ${i.streak||0} days
- Progress: ${i.progress||"Starting journey"}
- Recent challenge: ${i.challenge||"None"}

Create a short, encouraging message (2-3 sentences). Be specific to their situation and inspiring!`;return(await(await model.generateContent(e)).response).text()}catch{return"You're doing amazing! Every small step counts toward your bigger goal. Keep showing up! "}};async function YD(i){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{const r=n.result.split(",")[1];e({inlineData:{data:r,mimeType:i.type}})},n.onerror=t,n.readAsDataURL(i)})}const Yx={chat:qx,chatWithAI:qx,analyzeProgressPhoto:$D,analyzeFoodPhoto:GD,generateWorkoutPlan:HD,generateMealPlan:KD,getHabitInsights:WD,getMotivationalMessage:qD},Bk=Object.freeze(Object.defineProperty({__proto__:null,analyzeFoodPhoto:GD,analyzeProgressPhoto:$D,chatWithAI:qx,default:Yx,generateMealPlan:KD,generateWorkoutPlan:HD,getHabitInsights:WD,getMotivationalMessage:qD},Symbol.toStringTag,{value:"Module"}));class HW{constructor(){this.geneticData=null,this.analysisComplete=!1,this.dailyTipHistory=[]}async loadSavedData(){try{const{value:e}=await gn.get({key:"dna_genetic_data"}),{value:t}=await gn.get({key:"dna_analysis"}),{value:n}=await gn.get({key:"dna_analysis_complete"});if(e){this.geneticData=JSON.parse(e);try{const{default:r}=await Vt(async()=>{const{default:l}=await import("./chunk-1765759384263-encryptionService.js");return{default:l}},[]),s=await r.encrypt(e);localStorage.setItem("dnaAnalysis",s)}catch{}}return t&&(this.analysis=JSON.parse(t)),n==="true"&&(this.analysisComplete=!0),this.geneticData!==null}catch{return!1}}async generateDailyTip(){try{const e=new Date().toISOString().split("T")[0],{value:t}=await gn.get({key:"dna_last_tip_date"}),{value:n}=await gn.get({key:"dna_last_tip"});if(t===e&&n)return JSON.parse(n);if(!this.geneticData){const{value:u}=await gn.get({key:"dna_genetic_data"});if(u)this.geneticData=JSON.parse(u);else return null}const r=this.geneticData.traits||[];if(r.length===0)return null;const s=r[Math.floor(Math.random()*r.length)],l=await this.generateTipForTrait(s);return await gn.set({key:"dna_last_tip_date",value:e}),await gn.set({key:"dna_last_tip",value:JSON.stringify(l)}),l}catch{return null}}async generateTipForTrait(e){const n={metabolism:{slow:[{icon:"",title:"Portion Control",tip:"Your FTO gene means slower metabolism. Try smaller portions and track calories more carefully."},{icon:"",title:"Boost Activity",tip:"Your genetics favor fat storage. Aim for 150+ mins of cardio weekly to counteract this."},{icon:"",title:"Timing Matters",tip:"With your metabolism, eat larger meals earlier in the day when metabolism is naturally higher."}],fast:[{icon:"",title:"Fuel Up",tip:"Your fast metabolism burns calories quickly. Don't forget to eat enough to maintain energy!"},{icon:"",title:"Protein Power",tip:"Your metabolism needs fuel. Aim for 1g protein per lb body weight to maintain muscle."}]},caffeine:{slow:[{icon:"",title:"Cut the Coffee",tip:"Your CYP1A2 gene makes you a slow caffeine metabolizer. Stop coffee after 2 PM for better sleep."},{icon:"",title:"Switch to Green Tea",tip:"Your body processes caffeine slowly. Try green tea (less caffeine) instead of coffee."}],fast:[{icon:"",title:"Coffee Champion",tip:"Your CYP1A2 gene means you process caffeine quickly. You can enjoy that afternoon coffee!"}]},lactose:{intolerant:[{icon:"",title:"Dairy Alternative",tip:"Your LCT gene means lactose intolerance. Try lactose-free milk, almond milk, or take lactase pills."},{icon:"",title:"Aged Cheese OK",tip:"With your genetics, aged cheeses (cheddar, parmesan) have less lactose and may be tolerable."}],tolerant:[{icon:"",title:"Dairy Friendly",tip:"Your genetics allow lactose digestion. Dairy is a great protein source for you!"}]},carbs:{sensitive:[{icon:"",title:"Low-Carb Works",tip:"Your TCF7L2 gene means carb sensitivity. Consider lower carb diet (<150g/day) for better weight control."},{icon:"",title:"Veggies First",tip:"Your genetics favor low-carb. Fill up on non-starchy veggies before eating carbs."}],tolerant:[{icon:"",title:"Carb Friendly",tip:"Your genetics handle carbs well. Sweet potatoes, rice, and oats are great fuel for you!"}]},vitamin_d:{deficiency:[{icon:"",title:"Sunshine Vitamin",tip:"Your VDR gene means vitamin D deficiency risk. Get 15 mins sun daily or take 2000 IU supplement."},{icon:"",title:"Fatty Fish",tip:"Your genetics need more vitamin D. Eat salmon, mackerel, or sardines 2-3x per week."}],sufficient:[{icon:"",title:"D is Good",tip:"Your VDR gene processes vitamin D well. Keep up the sunshine and salmon!"}]},exercise:{power:[{icon:"",title:"Built for Strength",tip:"Your ACTN3 gene means you're built for power! Focus on weightlifting and sprints."},{icon:"",title:"HIIT Perfect",tip:"Your genetics favor explosive movements. HIIT and plyometrics will give you best results."}],endurance:[{icon:"",title:"Endurance King",tip:"Your ACE gene means endurance is your strength. Long runs, cycling, and swimming suit you best."},{icon:"",title:"Go Long",tip:"Your genetics favor sustained effort. Train for marathons or long-distance cycling!"}]},salt:{sensitive:[{icon:"",title:"Watch the Salt",tip:"Your AGT gene means salt sensitivity. Keep sodium under 2000mg/day to control blood pressure."},{icon:"",title:"Cook at Home",tip:"With your genetics, restaurant food is too salty. Cook at home to control sodium better."}]}}[e.trait];if(!n)return{icon:"",title:"DNA Insight",tip:`Your ${e.gene} gene (${e.trait}) - ${e.value}. Check your full DNA report for details.`};const r=n[e.value];return!r||r.length===0?{icon:"",title:"DNA Insight",tip:`Your ${e.gene} gene shows ${e.value} ${e.trait}. This affects how your body responds.`}:{...r[Math.floor(Math.random()*r.length)],gene:e.gene,trait:e.trait,value:e.value}}async getDailyTipHistory(){try{const{value:e}=await gn.get({key:"dna_tip_history"});return e?JSON.parse(e):[]}catch{return[]}}async saveTipToHistory(e){try{const t=await this.getDailyTipHistory();t.push({...e,date:new Date().toISOString()});const n=t.slice(-30);await gn.set({key:"dna_tip_history",value:JSON.stringify(n)})}catch{}}async uploadDNAData(e,t){try{const n=await this.parseDNAFile(e,t);return n.success?(this.geneticData=n.data,await this.analyzeGenetics(),{success:!0,message:"DNA data uploaded successfully",traitsFound:this.geneticData.traits.length}):{success:!1,error:"Failed to parse DNA data"}}catch(n){return{success:!1,error:n.message}}}getSnpDatabase(){return{rs9939609:{gene:"FTO",trait:"metabolism",interpretations:{AA:{value:"slow",risk:"high",description:"30% higher obesity risk, need fewer calories"},AT:{value:"moderate",risk:"medium",description:"20% higher obesity risk"},TT:{value:"fast",risk:"low",description:"Normal metabolism"}}},rs4988235:{gene:"LCT",trait:"lactoseIntolerance",interpretations:{AA:{value:"unlikely",risk:"low",description:"Can digest dairy normally"},AG:{value:"possible",risk:"medium",description:"May have mild lactose sensitivity"},GG:{value:"likely",risk:"high",description:"Likely lactose intolerant - avoid dairy"}}},rs762551:{gene:"CYP1A2",trait:"caffeineMetabolism",interpretations:{AA:{value:"fast",risk:"low",description:"Can handle 3+ cups/day"},AC:{value:"moderate",risk:"medium",description:"Limit to 2 cups/day"},CC:{value:"slow",risk:"high",description:"Slow metabolizer - limit to 1 cup, increased heart risk"}}},rs1815739:{gene:"ACTN3",trait:"muscleType",interpretations:{CC:{value:"power-oriented",risk:"low",description:"Fast-twitch dominant - better at sprints/strength"},CT:{value:"balanced",risk:"low",description:"Mixed muscle fibers - good all-around"},TT:{value:"endurance-oriented",risk:"low",description:"Slow-twitch dominant - better at marathons"}}},rs1799983:{gene:"NOS3",trait:"enduranceCapacity",interpretations:{GG:{value:"high",risk:"low",description:"Elite endurance potential"},GT:{value:"moderate",risk:"low",description:"Good endurance capacity"},TT:{value:"low",risk:"medium",description:"Lower endurance - focus on shorter workouts"}}},rs2228570:{gene:"VDR",trait:"vitaminDAbsorption",interpretations:{AA:{value:"low",risk:"high",description:"Poor vitamin D absorption - need 2000+ IU daily"},AG:{value:"moderate",risk:"medium",description:"Moderate absorption - need 1000 IU daily"},GG:{value:"high",risk:"low",description:"Good vitamin D absorption"}}},rs174537:{gene:"FADS1",trait:"omega3Conversion",interpretations:{GG:{value:"efficient",risk:"low",description:"Good omega-3 metabolism"},GT:{value:"moderate",risk:"medium",description:"Moderate conversion - eat more fish"},TT:{value:"inefficient",risk:"high",description:"Poor conversion - need fish oil supplements"}}},rs2187668:{gene:"HLA-DQA1",trait:"glutenSensitivity",interpretations:{CC:{value:"high-risk",risk:"high",description:"High celiac risk - consider gluten-free diet"},CT:{value:"moderate-risk",risk:"medium",description:"Moderate gluten sensitivity"},TT:{value:"low-risk",risk:"low",description:"Can tolerate gluten normally"}}},rs671:{gene:"ALDH2",trait:"alcoholMetabolism",interpretations:{GG:{value:"normal",risk:"low",description:"Normal alcohol tolerance"},GA:{value:"slow",risk:"medium",description:"Slower metabolism - limit alcohol intake"},AA:{value:"very-slow",risk:"high",description:"Asian flush variant - avoid alcohol"}}},rs5068:{gene:"NPPA",trait:"saltSensitivity",interpretations:{GG:{value:"high",risk:"high",description:"Very salt sensitive - limit sodium to <1500mg/day"},AG:{value:"moderate",risk:"medium",description:"Moderately salt sensitive"},AA:{value:"low",risk:"low",description:"Not salt sensitive"}}},rs1801282:{gene:"PPARG",trait:"carbohydrateSensitivity",interpretations:{CC:{value:"high",risk:"high",description:"Carb sensitive - better on low-carb diet"},CG:{value:"moderate",risk:"medium",description:"Moderate carb tolerance"},GG:{value:"low",risk:"low",description:"Good carb tolerance"}}},rs429358:{gene:"APOE",trait:"saturatedFatResponse",interpretations:{CC:{value:"increased-risk",risk:"high",description:"APOE4 carrier - limit saturated fat, higher Alzheimer's risk"},CT:{value:"moderate-risk",risk:"medium",description:"APOE3/4 - moderate fat sensitivity"},TT:{value:"normal",risk:"low",description:"APOE3/3 - normal fat metabolism"}}},rs1801133:{gene:"MTHFR",trait:"folateMetabolism",interpretations:{AA:{value:"impaired",risk:"high",description:"MTHFR mutation - need 40% more folate (leafy greens, supplements)"},AG:{value:"reduced",risk:"medium",description:"Slightly reduced folate processing"},GG:{value:"normal",risk:"low",description:"Normal folate metabolism"}}}}}async parseDNAFile(e,t){try{const n=this.getSnpDatabase(),r=e.split(`
`),s={};let l="unknown";for(let f of r){if(f=f.trim(),!f||f.startsWith("#")){(f.includes("23andMe")||f.includes("23andme"))&&(l="23andMe"),(f.includes("AncestryDNA")||f.includes("Ancestry"))&&(l="AncestryDNA");continue}const x=f.split(/\s+/);if(x.length>=4){const g=x[0],w=x[3];n[g]&&(s[g]=w)}}const u=[],h=Object.keys(s).length;if(h===0)return this.getDemoGeneticData(t);for(const[f,x]of Object.entries(s)){const g=n[f],w=g.interpretations[x];w&&u.push({rsid:f,gene:g.gene,genotype:x,trait:g.trait,value:w.value,risk:w.risk,description:w.description})}return{success:!0,data:{source:l!=="unknown"?l:t,uploadDate:new Date().toISOString(),traits:u,snpsAnalyzed:h,raw:null}}}catch{return this.getDemoGeneticData(t)}}getDemoGeneticData(e){const t=[{rsid:"demo",gene:"FTO",trait:"metabolism",value:"moderate",risk:"medium",description:"Demo: Moderate metabolism"},{rsid:"demo",gene:"LCT",trait:"lactoseIntolerance",value:"possible",risk:"medium",description:"Demo: May have mild lactose sensitivity"},{rsid:"demo",gene:"CYP1A2",trait:"caffeineMetabolism",value:"slow",risk:"high",description:"Demo: Slow caffeine metabolizer"},{rsid:"demo",gene:"ACTN3",trait:"muscleType",value:"balanced",risk:"low",description:"Demo: Mixed muscle fibers"},{rsid:"demo",gene:"NOS3",trait:"enduranceCapacity",value:"moderate",risk:"low",description:"Demo: Good endurance capacity"}];return{success:!0,data:{source:e+" (Demo Mode)",uploadDate:new Date().toISOString(),traits:t,snpsAnalyzed:0,raw:null}}}async analyzeGenetics(){if(!this.geneticData)return;const n=`Based on these genetic traits: ${this.geneticData.traits.map(s=>`${s.trait}: ${s.value}`).join(", ")}

Generate personalized health recommendations in JSON format:
{
  "dietRecommendations": ["rec1", "rec2"],
  "exerciseRecommendations": ["rec1", "rec2"],
  "supplementAdvice": ["sup1", "sup2"],
  "foodsToAvoid": ["food1", "food2"],
  "foodsToEmphasize": ["food1", "food2"],
  "healthRisks": ["risk1", "risk2"],
  "preventionStrategies": ["strategy1", "strategy2"]
}`;try{const h=(await(await Yx.getGeminiModel()).generateContent(n)).response.text().match(/\{[\s\S]*\}/);h&&(this.analysis=JSON.parse(h[0]),this.analysisComplete=!0)}catch{this.analysis={dietRecommendations:["Follow Mediterranean diet","Eat 5-6 small meals daily"],exerciseRecommendations:["Mix cardio and strength training","Exercise 150 min/week"],supplementAdvice:["Vitamin D3 1000 IU","Omega-3 fish oil","Multivitamin"],foodsToAvoid:["Processed foods","Excess saturated fats","High sodium foods"],foodsToEmphasize:["Leafy greens","Fatty fish","Whole grains","Nuts and seeds"],healthRisks:["Moderate obesity risk","Possible lactose sensitivity"],preventionStrategies:["Maintain healthy weight","Regular exercise","Balanced nutrition"]},this.analysisComplete=!0}const r={...this.geneticData,analysis:this.analysis,analysisComplete:!0};await gn.set({key:"dna_genetic_data",value:JSON.stringify(r)}),await gn.set({key:"dna_analysis",value:JSON.stringify(this.analysis)}),await gn.set({key:"dna_analysis_complete",value:"true"}),localStorage.setItem("dnaAnalysis",JSON.stringify(r));try{const s=Ii.getCurrentUser()?.uid;await Ei.save("dnaAnalysis",r,s)}catch{}}async getGeneticMealPlan(e=7){if(!this.geneticData||!this.analysisComplete)return{success:!1,message:"Upload DNA data first"};const t=this.geneticData.traits,n=this.analysis,r=`Create a ${e}-day meal plan optimized for someone with these genetic traits:
${t.map(h=>`- ${h.trait}: ${h.value}`).join(`
`)}

Foods to emphasize: ${n.foodsToEmphasize?.join(", ")}
Foods to avoid: ${n.foodsToAvoid?.join(", ")}

Return JSON:
{
  "days": [
    {
      "day": 1,
      "breakfast": {"meal": "name", "calories": 400, "why": "genetic reason"},
      "lunch": {"meal": "name", "calories": 600, "why": "genetic reason"},
      "dinner": {"meal": "name", "calories": 600, "why": "genetic reason"},
      "snacks": [{"snack": "name", "calories": 150, "why": "genetic reason"}]
    }
  ]
}`,u=(await Yx.getGeminiModel().generateContent(r)).response.text();try{const h=u.match(/\{[\s\S]*\}/);if(h)return{success:!0,mealPlan:JSON.parse(h[0])}}catch{}return{success:!1,message:"Failed to generate meal plan"}}async getGeneticExercisePlan(){if(!this.geneticData)return{success:!1,message:"Upload DNA data first"};const e=this.geneticData.traits.find(r=>r.trait==="muscleType")?.value,t=this.geneticData.traits.find(r=>r.trait==="enduranceCapacity")?.value;let n=[];return e==="power-oriented"?n.push({type:"Strength Training",frequency:"4x/week",exercises:["Squats","Deadlifts","Bench Press","Overhead Press"],sets:"3-5 sets",reps:"4-6 reps",reason:"Your genetics favor power development"}):n.push({type:"Endurance Training",frequency:"5x/week",exercises:["Running","Cycling","Swimming","Rowing"],duration:"45-60 min",reason:"Your genetics favor endurance activities"}),t==="high"&&n.push({type:"HIIT",frequency:"2x/week",duration:"20-30 min",reason:"Your high endurance capacity allows for intense intervals"}),{success:!0,plan:n}}getPredictedHealthRisks(){return this.analysis?this.analysis.healthRisks||[]:[]}getSupplementAdvice(){return this.analysis?this.analysis.supplementAdvice||[]:[]}getFullDNAReport(){return!this.geneticData||!this.analysisComplete?null:{geneticTraits:this.geneticData.traits,analysis:this.analysis,uploadDate:this.geneticData.uploadDate,source:this.geneticData.source,ancestryBreakdown:this.getAncestryBreakdown(),pharmacogenomics:this.getPharmacogenomics(),athleticProfile:this.getAthleticProfile(),nutritionGenetics:this.getNutritionGenetics(),healthRiskScores:this.getHealthRiskScores()}}getAncestryBreakdown(){const e=[{region:"Northern European",percentage:42.3,countries:["UK","Ireland","Scandinavia"]},{region:"Southern European",percentage:28.7,countries:["Italy","Greece","Spain"]},{region:"Eastern European",percentage:18.5,countries:["Poland","Russia","Ukraine"]},{region:"Middle Eastern",percentage:7.2,countries:["Turkey","Lebanon"]},{region:"Other",percentage:3.3,countries:["Various"]}];return{breakdown:e,mainRegion:e[0].region,diversityScore:68}}getPharmacogenomics(){return[{drug:"Warfarin",gene:"CYP2C9",recommendation:"Normal Dose",description:"Standard blood thinner dosing recommended",riskLevel:"low"},{drug:"Clopidogrel (Plavix)",gene:"CYP2C19",recommendation:"Consider Alternative",description:"May be less effective - discuss with doctor",riskLevel:"medium"},{drug:"Codeine",gene:"CYP2D6",recommendation:"Use with Caution",description:"May be ultra-metabolizer - higher side effect risk",riskLevel:"high"},{drug:"Statins",gene:"SLCO1B1",recommendation:"Normal Response",description:"Standard cholesterol medication dosing",riskLevel:"low"},{drug:"SSRIs (Antidepressants)",gene:"CYP2D6",recommendation:"May Need Higher Dose",description:"Fast metabolizer - may require dose adjustment",riskLevel:"low"}]}getAthleticProfile(){return{powerScore:72,enduranceScore:58,recoverySpeed:"Fast",injuryRisk:"Low",optimalTrainingType:"Mixed - Slightly power-biased",genes:[{gene:"ACTN3",result:"CT",trait:"Power potential - Sprint ability",score:75},{gene:"ACE",result:"ID",trait:"Endurance capacity",score:60},{gene:"COL1A1",result:"GG",trait:"Injury resistance - Strong tendons",score:85},{gene:"IL6",result:"GG",trait:"Recovery speed - Fast inflammation response",score:80}],recommendations:["Focus on explosive movements: sprints, plyometrics, Olympic lifts","Include endurance work but don't overdo long slow cardio","Your injury risk is low - can train frequently","Recovery is fast - can handle 5-6 training days per week"]}}getNutritionGenetics(){return{macronutrients:{carbs:{tolerance:"Medium",recommendation:"40-45% of calories"},fats:{tolerance:"High",recommendation:"30-35% of calories"},protein:{needs:"Standard",recommendation:"1.6g per kg bodyweight"}},intolerances:[{food:"Lactose",gene:"LCT",likelihood:"Low",canConsume:!0},{food:"Gluten",gene:"HLA-DQ",likelihood:"Very Low",canConsume:!0},{food:"Caffeine",gene:"CYP1A2",metabolism:"Fast",safeAmount:"400mg/day"},{food:"Alcohol",gene:"ALDH2",metabolism:"Normal",safeAmount:"Moderate"}],vitamins:[{vitamin:"Vitamin D",gene:"VDR",absorption:"Low",recommendedIU:2e3},{vitamin:"Vitamin B12",gene:"FUT2",absorption:"Normal",recommendedMCG:2.4},{vitamin:"Folate",gene:"MTHFR",conversion:"Reduced",recommendation:"Methylfolate supplement"},{vitamin:"Omega-3",gene:"FADS1",conversion:"Low",recommendation:"Eat fish or supplement EPA/DHA"}],dietType:"Mediterranean",reason:"Your genetics respond well to moderate carbs, healthy fats, and lean proteins"}}getHealthRiskScores(){return[{condition:"Type 2 Diabetes",yourRisk:18,populationAverage:15,riskLevel:"Slightly Elevated",genes:["TCF7L2","FTO"],preventionTips:["Maintain healthy weight","Regular exercise","Low glycemic diet"]},{condition:"Heart Disease",yourRisk:22,populationAverage:25,riskLevel:"Lower Than Average",genes:["APOE","PCSK9"],preventionTips:["Mediterranean diet","Cardio exercise","Manage stress"]},{condition:"Obesity",yourRisk:35,populationAverage:30,riskLevel:"Elevated",genes:["FTO","MC4R"],preventionTips:["Calorie tracking","Strength training","Protein-rich diet"]},{condition:"Alzheimer's Disease",yourRisk:12,populationAverage:10,riskLevel:"Average",genes:["APOE"],preventionTips:["Brain exercises","Social engagement","Mediterranean diet"]},{condition:"Osteoporosis",yourRisk:8,populationAverage:12,riskLevel:"Lower Than Average",genes:["VDR","COL1A1"],preventionTips:["Calcium intake","Weight-bearing exercise","Vitamin D"]}]}hasDNAData(){return this.geneticData!==null}}const KW=new HW;var Xx;(function(i){i[i.Sunday=1]="Sunday",i[i.Monday=2]="Monday",i[i.Tuesday=3]="Tuesday",i[i.Wednesday=4]="Wednesday",i[i.Thursday=5]="Thursday",i[i.Friday=6]="Friday",i[i.Saturday=7]="Saturday"})(Xx||(Xx={}));const Eu=Ul("LocalNotifications",{web:()=>Vt(()=>import("./chunk-1765759384263-web11.js"),[]).then(i=>new i.LocalNotificationsWeb)}),C1=Object.freeze(Object.defineProperty({__proto__:null,LocalNotifications:Eu,get Weekday(){return Xx}},Symbol.toStringTag,{value:"Module"}));class WW{constructor(){this.settings=this.getDefaultSettings(),this.scheduledIds={dailyReminders:[1001,1002,1003],streakReminders:[2001],healthTips:[3001,3002,3003],goalAlerts:[4001,4002,4003,4004]},this.initialized=!1,this.goalCheckInterval=null}getDefaultSettings(){return{dailyReminders:!1,goalAlerts:!1,streakReminders:!1,healthTips:!1,emergencyAlerts:!0}}async initialize(){if(!this.initialized)try{if(!Eu){console.warn("LocalNotifications not available");return}if((await Eu.requestPermissions()).display!=="granted"){console.warn("Notification permission not granted");return}this.loadSettings(),await this.scheduleAllNotifications(),this.settings.goalAlerts&&this.startGoalMonitoring(),this.initialized=!0}catch(e){console.warn("Failed to initialize notifications:",e)}}loadSettings(){try{const e=localStorage.getItem("notificationSettings");e&&(this.settings={...this.getDefaultSettings(),...JSON.parse(e)})}catch(e){console.warn("Failed to load notification settings:",e),this.settings=this.getDefaultSettings()}}async updateSettings(e){this.settings={...this.settings,...e};try{await this.cancelAllNotifications(),await this.scheduleAllNotifications(),this.settings.goalAlerts&&!this.goalCheckInterval?this.startGoalMonitoring():!this.settings.goalAlerts&&this.goalCheckInterval&&this.stopGoalMonitoring()}catch(t){console.warn("Failed to update notifications:",t)}}async scheduleAllNotifications(){try{this.settings.dailyReminders&&await this.scheduleDailyReminders(),this.settings.streakReminders&&await this.scheduleStreakReminders(),this.settings.healthTips&&await this.scheduleHealthTips()}catch(e){console.warn("Failed to schedule notifications:",e)}}async cancelAllNotifications(){try{const e=[...this.scheduledIds.dailyReminders,...this.scheduledIds.streakReminders,...this.scheduledIds.healthTips,...this.scheduledIds.goalAlerts];await Eu.cancel({notifications:e.map(t=>({id:t}))})}catch(e){console.warn("Failed to cancel notifications:",e)}}async scheduleDailyReminders(){try{const e=[],t=new Date,n=new Date;n.setHours(9,0,0,0),n<=t&&n.setDate(n.getDate()+1),e.push({id:this.scheduledIds.dailyReminders[0],title:" Good Morning!",body:"Start your day right! Log your breakfast and water intake.",schedule:{at:n,repeats:!0,every:"day"}});const r=new Date;r.setHours(12,0,0,0),r<=t&&r.setDate(r.getDate()+1),e.push({id:this.scheduledIds.dailyReminders[1],title:" Lunch Time!",body:"Don't forget to log your lunch and stay hydrated.",schedule:{at:r,repeats:!0,every:"day"}});const s=new Date;s.setHours(18,0,0,0),s<=t&&s.setDate(s.getDate()+1),e.push({id:this.scheduledIds.dailyReminders[2],title:" Evening Check-in",body:"Log your dinner and check your daily progress!",schedule:{at:s,repeats:!0,every:"day"}}),await Eu.schedule({notifications:e})}catch(e){console.warn("Failed to schedule daily reminders:",e)}}startGoalMonitoring(){this.goalCheckInterval=setInterval(()=>{this.checkGoalCompletion()},300*1e3),this.checkGoalCompletion()}stopGoalMonitoring(){this.goalCheckInterval&&(clearInterval(this.goalCheckInterval),this.goalCheckInterval=null)}async checkGoalCompletion(){try{await this.checkStepGoal(),await this.checkWaterGoal(),await this.checkCalorieGoal()}catch(e){console.warn("Failed to check goals:",e)}}async checkStepGoal(){try{if(window.AndroidStepCounter){const e=await new Promise(r=>{try{const s=parseInt(window.AndroidStepCounter.getTodaySteps()||"0");r(s)}catch{r(0)}}),t=1e4,n=`stepGoalNotified_${new Date().toDateString()}`;e>=t&&!localStorage.getItem(n)&&(await Eu.schedule({notifications:[{id:this.scheduledIds.goalAlerts[0],title:" Step Goal Achieved!",body:`Awesome! You've reached ${e.toLocaleString()} steps today!`,schedule:{at:new Date(Date.now()+1e3)}}]}),localStorage.setItem(n,"true"))}}catch(e){console.warn("Failed to check step goal:",e)}}async checkWaterGoal(){try{const e=localStorage.getItem("waterIntake");if(e){const t=JSON.parse(e),n=new Date().toDateString(),r=t[n]||0,s=2e3,l=`waterGoalNotified_${n}`;r>=s&&!localStorage.getItem(l)&&(await Eu.schedule({notifications:[{id:this.scheduledIds.goalAlerts[1],title:" Hydration Goal Achieved!",body:`Great job! You've reached your water intake goal of ${s}ml!`,schedule:{at:new Date(Date.now()+1e3)}}]}),localStorage.setItem(l,"true"))}}catch(e){console.warn("Failed to check water goal:",e)}}async checkCalorieGoal(){try{const e=localStorage.getItem("meals");if(e){const t=JSON.parse(e),n=new Date().toDateString(),s=t.filter(h=>new Date(h.date).toDateString()===n).reduce((h,f)=>h+(f.calories||0),0),l=2e3,u=`calorieGoalNotified_${n}`;s>=l&&!localStorage.getItem(u)&&(await Eu.schedule({notifications:[{id:this.scheduledIds.goalAlerts[2],title:" Calorie Goal Reached!",body:`You've logged ${s} calories today. Great tracking!`,schedule:{at:new Date(Date.now()+1e3)}}]}),localStorage.setItem(u,"true"))}}catch(e){console.warn("Failed to check calorie goal:",e)}}async scheduleStreakReminders(){try{const e=new Date,t=new Date;t.setHours(20,0,0,0),t<=e&&t.setDate(t.getDate()+1),await Eu.schedule({notifications:[{id:this.scheduledIds.streakReminders[0],title:" Keep Your Streak Alive!",body:"Complete your daily goal to maintain your winning streak!",schedule:{at:t,repeats:!0,every:"day"}}]})}catch(e){console.warn("Failed to schedule streak reminders:",e)}}async scheduleHealthTips(){try{const e=this.getHealthTips(),t=[],n=new Date,r=new Date;r.setHours(10,0,0,0),r<=n&&r.setDate(r.getDate()+1),t.push({id:this.scheduledIds.healthTips[0],title:" Health Tip",body:e[Math.floor(Math.random()*e.length)],schedule:{at:r,repeats:!0,every:"day"}});const s=new Date;s.setHours(15,0,0,0),s<=n&&s.setDate(s.getDate()+1),t.push({id:this.scheduledIds.healthTips[1],title:" Wellness Advice",body:e[Math.floor(Math.random()*e.length)],schedule:{at:s,repeats:!0,every:"day"}});const l=new Date;l.setHours(19,0,0,0),l<=n&&l.setDate(l.getDate()+1),t.push({id:this.scheduledIds.healthTips[2],title:" Health Reminder",body:e[Math.floor(Math.random()*e.length)],schedule:{at:l,repeats:!0,every:"day"}}),await Eu.schedule({notifications:t})}catch(e){console.warn("Failed to schedule health tips:",e)}}getHealthTips(){return[" Drink water regularly throughout the day to stay hydrated!"," Take a 5-minute walk every hour to boost circulation."," Practice deep breathing for 2 minutes to reduce stress."," Include more vegetables in your meals for better nutrition."," Aim for 7-8 hours of quality sleep each night."," Regular exercise strengthens your immune system."," Choose whole fruits over fruit juice for more fiber."," Take breaks from screens to reduce eye strain."," Stretch your muscles daily to improve flexibility."," Get some sunlight daily for vitamin D."," Limit sugary drinks and opt for water or tea."," Eat slowly and mindfully to improve digestion."," Strength training helps maintain bone density."," Challenge your brain with puzzles or learning new skills."," Practice gratitude daily for better mental health."," Avoid smoking and limit alcohol for better health."," Include healthy fats like nuts and avocados in your diet."," Find physical activities you enjoy for sustainable fitness."," Stay connected with friends and family for emotional wellbeing."," Green tea is rich in antioxidants and supports metabolism."]}async testNotification(e){try{const t={dailyReminders:{title:" Test: Daily Reminder",body:"This is what your daily reminders will look like!"},goalAlerts:{title:" Test: Goal Alert",body:"This is what goal completion alerts will look like!"},streakReminders:{title:" Test: Streak Reminder",body:"This is what streak reminders will look like!"},healthTips:{title:" Test: Health Tip",body:"This is what health tips will look like!"}},n=t[e]||t.dailyReminders;await Eu.schedule({notifications:[{id:9999,title:n.title,body:n.body,schedule:{at:new Date(Date.now()+2e3)}}]})}catch(t){console.warn("Failed to send test notification:",t)}}getStatus(){return{initialized:this.initialized,settings:this.settings,goalMonitoring:!!this.goalCheckInterval}}}const Jx=new WW;class qW{constructor(){this.errors=[],this.maxErrors=100,this.sessionId=this.generateSessionId(),this.setupGlobalErrorHandlers()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setupGlobalErrorHandlers(){window.addEventListener("error",e=>{this.logError({type:"unhandled_error",message:e.message,filename:e.filename,line:e.lineno,column:e.colno,stack:e.error?.stack,timestamp:new Date().toISOString()})}),window.addEventListener("unhandledrejection",e=>{this.logError({type:"unhandled_promise_rejection",message:e.reason?.message||String(e.reason),stack:e.reason?.stack,timestamp:new Date().toISOString()})})}logError(e){const t={...e,sessionId:this.sessionId,userAgent:navigator.userAgent,url:window.location.href,timestamp:e.timestamp||new Date().toISOString()};this.errors.push(t),this.errors.length>this.maxErrors&&this.errors.shift(),this.saveErrors()}logAPIError(e,t,n){this.logError({type:"api_error",endpoint:e,status:t,message:n,timestamp:new Date().toISOString()})}logUserActionError(e,t){this.logError({type:"user_action_error",action:e,message:t.message,stack:t.stack,timestamp:new Date().toISOString()})}saveErrors(){try{localStorage.setItem("error_logs",JSON.stringify(this.errors))}catch{this.errors=this.errors.slice(-50),localStorage.setItem("error_logs",JSON.stringify(this.errors))}}loadErrors(){try{const e=localStorage.getItem("error_logs");e&&(this.errors=JSON.parse(e))}catch{}}getAllErrors(){return[...this.errors]}getErrorsByType(e){return this.errors.filter(t=>t.type===e)}clearErrors(){this.errors=[],localStorage.removeItem("error_logs")}getErrorReport(){return{sessionId:this.sessionId,totalErrors:this.errors.length,errors:this.errors,userAgent:navigator.userAgent,platform:navigator.platform,timestamp:new Date().toISOString()}}exportErrors(){const e=this.getErrorReport(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`error_report_${Date.now()}.json`,r.click(),URL.revokeObjectURL(n)}}const XD=new qW;XD.loadErrors();class tu extends lP.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){XD.logError({type:"component_crash",message:e.message,stack:e.stack,componentStack:t.componentStack,timestamp:new Date().toISOString()}),this.setState({error:e,errorInfo:t})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};render(){return this.state.hasError?b.jsx("div",{className:"error-boundary-container",children:b.jsxs("div",{className:"error-boundary-content",children:[b.jsx("div",{className:"error-icon",children:""}),b.jsx("h2",{children:"Oops! Something went wrong"}),b.jsx("p",{children:this.props.fallbackMessage||"We're sorry, but this feature encountered an error. Don't worry, your data is safe."}),b.jsxs("div",{className:"error-actions",children:[b.jsx("button",{className:"error-btn-primary",onClick:this.handleReset,children:"Try Again"}),b.jsx("button",{className:"error-btn-secondary",onClick:()=>window.location.href="/",children:"Go to Home"})]}),!1]})}):this.props.children}}T1.setSyncService(Xh);const YW=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-FoodScanner.js"),__vite__mapDeps([0,1,2,3,4]))),XW=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-ProfileSetup.js"),__vite__mapDeps([5,2,6,7]))),JW=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-HealthAvatar.js"),__vite__mapDeps([8,6,9]))),QW=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-ARScanner.js"),__vite__mapDeps([10,2,1,11,4,12]))),ZW=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-EmergencyPanel.js"),__vite__mapDeps([13,14,15]))),eq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-InsuranceRewards.js"),__vite__mapDeps([16,6,17]))),tq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-DNAUpload.js"),__vite__mapDeps([18,11,4,19]))),nq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-SocialBattles.js"),__vite__mapDeps([20,21,6,22]))),iq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-MealAutomation.js"),__vite__mapDeps([23,11,4,24]))),rq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-GratitudeJournal.js"),[])),sq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384263-LegalModal.js"),__vite__mapDeps([25,26]))),aq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-StripePayment.js"),__vite__mapDeps([27,28]))),oq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-AppleHealthSync.js"),__vite__mapDeps([29,30]))),lq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-WearableSync.js"),__vite__mapDeps([31,32]))),uq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-PaywallModal.js"),__vite__mapDeps([11,4]))),cq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-Onboarding.js"),__vite__mapDeps([33,34]))),hq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-DevUnlock.js"),__vite__mapDeps([35,36]))),dq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-DataRecovery.js"),__vite__mapDeps([37,38]))),fq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-BarcodeScanner.js"),__vite__mapDeps([39,40,2,41]))),pq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-RepCounter.js"),__vite__mapDeps([42,43]))),gq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-GlobalFallAlert.js"),__vite__mapDeps([44,14]))),mq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-BrainInsightsDashboard.js"),__vite__mapDeps([45,46]))),yq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-TodayOverview.js"),__vite__mapDeps([47,48]))),vq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-HomeActionButton.js"),__vite__mapDeps([49,50]))),_q=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-StatsModal.js"),__vite__mapDeps([51,52]))),bq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-PremiumModal.js"),__vite__mapDeps([53,11,4,54]))),xq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-BattlesModal.js"),__vite__mapDeps([55,20,21,6,22,56]))),wq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-FoodModal.js"),__vite__mapDeps([57,0,1,2,3,4,58]))),Sq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-DNAModal.js"),__vite__mapDeps([59,18,11,4,19,60]))),JD=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-WorkoutsModalNew.js"),__vite__mapDeps([61,62]))),Tq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-HealthModal.js"),__vite__mapDeps([63,8,6,9,64]))),Aq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-GoalsModal.js"),__vite__mapDeps([65,66]))),Eq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-ProgressModal.js"),__vite__mapDeps([67,68]))),Iq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-StreakCounter.js"),__vite__mapDeps([69,70]))),kq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-LevelProgressBar.js"),__vite__mapDeps([71,72]))),Cq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-DailyChallenges.js"),__vite__mapDeps([73,74]))),Rq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-AchievementUnlock.js"),__vite__mapDeps([75,76]))),Lq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-VoiceTabRedesign.js"),__vite__mapDeps([77,78,79,80]))),Dq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-ZenTabRedesign.js"),__vite__mapDeps([81,78,79,82]))),Nq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-ScanTabRedesign.js"),__vite__mapDeps([83,78,79,84]))),Pq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-ProfileTabRedesign.js"),__vite__mapDeps([85,86]))),Oq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-AIAssistantModal.js"),__vite__mapDeps([87,88]))),Mq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-HealthToolsModal.js"),__vite__mapDeps([89,90]))),Fq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-DataManagementModal.js"),__vite__mapDeps([91,92]))),jq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-SocialFeaturesModal.js"),__vite__mapDeps([93,94]))),Vq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-SettingsHubModal.js"),__vite__mapDeps([95,96]))),zq=Te.lazy(()=>Vt(()=>import("./chunk-1765759384264-QuickLogModal.js"),__vite__mapDeps([97,98])));function Uq(){const i=Dp(),[e,t]=Te.useState("home"),[n,r]=Te.useState(null),[s,l]=Te.useState(!1),[u,h]=Te.useState(!1),[f,x]=Te.useState(!1),[g,w]=Te.useState([]),[A,B]=Te.useState(0),[$,W]=Te.useState(!1),[q,ge]=Te.useState(!1),[he,me]=Te.useState(!1),[Ce,Ve]=Te.useState(!1),[pe,ee]=Te.useState(!1),[J,ye]=Te.useState(!1),[X,ae]=Te.useState(!1),[le,ze]=Te.useState(!1),[nt,je]=Te.useState(!1),[Je,qe]=Te.useState(!1),[ot,St]=Te.useState(null),[Ne,se]=Te.useState(!1),[Ee,De]=Te.useState(!1),[Be,$e]=Te.useState(!1),[Ye,ct]=Te.useState(!1),[ut,Tt]=Te.useState(!1),[Ft,Wt]=Te.useState(!1),[qt,Et]=Te.useState(!1),[Pe,$t]=Te.useState(!1),[Dt,wn]=Te.useState(null),[_t,en]=Te.useState(!0),[Xt,Tn]=Te.useState(!1),[bn,Un]=Te.useState(!1),[ii,Bn]=Te.useState(!1),[li,Xn]=Te.useState(!1),[ln,$n]=Te.useState(!1),[cn,er]=Te.useState(!1),[Jn,mn]=Te.useState(!1);Te.useEffect(()=>{const It=Mt=>{const{level:kn}=Mt.detail;wn({id:"level_up",icon:"",name:`Level ${kn} Reached!`,description:`You've reached level ${kn}! Keep going!`,xp:kn*100})};return window.addEventListener("levelUp",It),()=>window.removeEventListener("levelUp",It)},[]);const[On,qn]=Te.useState(!1),[on,Ni]=Te.useState(!1),[Mn,xn]=Te.useState(null),[Qn,Qt]=Te.useState(!1),[Ht,Kn]=Te.useState(!1),[kr,vr]=Te.useState(!1),[Cr,Ci]=Te.useState({show:!1,featureName:"",message:"",currentPlan:"",requiredPlan:"",onUpgrade:null}),[dn,Aa]=Te.useState(!1),[ta,Rr]=Te.useState(!1),[ms,Pi]=Te.useState(()=>localStorage.getItem("helio_dev_mode")==="true"),[tr,cr]=Te.useState(!0),[os,Zr]=Te.useState(!1),[qi,Yi]=Te.useState("detecting"),[Kr,ls]=Te.useState(!1),[da,Va]=Te.useState(!1),[ys,es]=Te.useState({streak:7,todaySteps:0,goalSteps:1e4,waterCups:0,waterGoal:8,mealsLogged:0,mealsGoal:3,wellnessScore:78,level:5,xp:450,xpToNext:600,weeklySteps:Array.from({length:7},()=>({steps:0,date:null})),heartRate:null,sleepHours:0,sleepQuality:null}),[to,Ps]=Te.useState(!1),[Os,na]=Te.useState(!1),[Ms,hr]=Te.useState(!1),[ml,Fs]=Te.useState(!1),[fa,Ts]=Te.useState(!1),[Mo,el]=Te.useState(!1),[tl,Fo]=Te.useState(!1),oi=()=>{if(!ar.hasAccess("meditation")){const It=ar.showPaywall("meditation",()=>Qt(!0));Ci(It);return}Et(!0)},jr=()=>{if(!ar.hasAccess("breathing")){const It=ar.showPaywall("breathing",()=>Qt(!0));Ci(It);return}Tt(!0)},_r=()=>{if(!ar.hasAccess("workouts")){const It=ar.showPaywall("workouts",()=>Qt(!0));Ci(It);return}Fo(!0)},hn=()=>{if(!ar.hasAccess("heartRate")){const It=ar.showPaywall("heartRate",()=>Qt(!0));Ci(It);return}hr(!0)},Ea=()=>{if(!ar.hasAccess("sleepTracking")){const It=ar.showPaywall("sleepTracking",()=>Qt(!0));Ci(It);return}Fs(!0)};Te.useCallback(()=>{console.log(" REP COUNTER HANDLER CALLED"),qe(!0)},[]);function js(){if(!ar.checkLimit("foodScans").allowed){const Mt=ar.showPaywall("foodScanner",()=>Qt(!0));Ci(Mt);return}me(!0)}const gi=(It,...Mt)=>{if(!ar.hasAccess("pdfExport")){const kn=ar.showPaywall("pdfExport",()=>Qt(!0));Ci(kn);return}It(...Mt)},za=async()=>{await Oi(),gi(Dh.exportDailyStats.bind(Dh),ys)},ri=async()=>{await Oi(),gi(Dh.exportWorkoutHistory.bind(Dh))},dr=async()=>{await Oi(),gi(Dh.exportFoodLog.bind(Dh))},Lr=async()=>{await Oi(),gi(Dh.exportFullReport.bind(Dh),ys)};Te.useEffect(()=>{Vt(async()=>{const{default:It}=await import("./chunk-1765759384264-emergencyService.js");return{default:It}},[]).then(({default:It})=>{It.setGlobalFallAlertCallback(Mt=>{xn(Mt),Ni(!0)}),setTimeout(async()=>{try{if((await It.loadEmergencyData())?.fallDetection)if(console.log(" [AUTO-START] Fall detection was enabled, resuming..."),window.AndroidFallDetection){console.log(" [AUTO-START] Starting native fall detection service (24/7)...");const kn=await Vt(()=>import("./chunk-1765759384264-nativeFallDetectionService.js"),[]),{default:xi}=kn;await xi.start(),console.log(" [AUTO-START] Native fall detection resumed - works 24/7 even when app closed!")}else console.log(" [AUTO-START] Starting JS fall detection (only works when app open)..."),await It.startFallDetection(It.globalFallAlertCallback),console.log(" [AUTO-START] JS fall detection resumed - only works while app is open");else console.log(" [AUTO-START] Fall detection was not previously enabled, skipping auto-resume")}catch(Mt){console.error(" [AUTO-START] Fall detection auto-resume failed:",Mt)}},2e3)})},[]),Te.useEffect(()=>{(async()=>{await Jx.initialize()})()},[]),Te.useEffect(()=>{localStorage.getItem("onboardingCompleted")||Aa(!0)},[]);const jo=async()=>{if(console.log(" CLEARING ALL CACHES..."),"caches"in window){const It=await caches.keys();await Promise.all(It.map(Mt=>caches.delete(Mt))),console.log(" Service worker caches cleared")}if("serviceWorker"in navigator){const It=await navigator.serviceWorker.getRegistrations();await Promise.all(It.map(Mt=>Mt.unregister())),console.log(" Service workers unregistered")}console.log(" RELOADING APP..."),window.location.reload(!0)};Te.useEffect(()=>{window.clearCache=jo,console.log(" Emergency function available: window.clearCache()")},[]),Te.useEffect(()=>{(async()=>{await Pb.initialize()})(),localStorage.getItem("helio_dev_mode")==="true"&&Pi(!0)},[]),Te.useEffect(()=>{(async()=>{await Wx.initialize();const Mt=await KW.generateDailyTip();Mt&&(St(Mt),window.dnaDailyTip=Mt)})()},[]),Te.useEffect(()=>{document.body.classList.remove("barcode-scanning-active"),document.querySelector("html")?.classList.remove("barcode-scanning-active"),document.body.offsetHeight},[]),Te.useEffect(()=>{if(e==="home"){try{kG.showBackground()}catch{}document.body.classList.remove("barcode-scanning-active"),document.querySelector("html")?.classList.remove("barcode-scanning-active"),document.body.offsetHeight,requestAnimationFrame(()=>{document.body.offsetHeight})}},[e]);const Bl=async It=>{try{const Mt=await Pb.unlockDevMode(It);return Mt.success?(Pi(!0),Rr(!1),alert(` Developer Mode Activated!

All premium features unlocked for testing.`),{success:!0}):{success:!1,message:Mt.message}}catch{return{success:!1,message:"Authentication failed"}}},Vo=()=>{confirm(` Disable Developer Mode?

This will lock all premium features and require password to re-enable.`)&&(localStorage.removeItem("helio_dev_mode"),Pb.isDevMode=!1,Pi(!1),alert(" Developer mode disabled. App will reload."),window.location.reload())},br=async()=>{try{const It=Nc.getStepCount(),Mt=new Date().toISOString().split("T")[0],kn=Ii.getCurrentUser()?.uid;await gn.set({key:"stepBaseline",value:It.toString()}),await gn.set({key:"stepBaselineDate",value:Mt}),await Ei.save("stepBaseline",It.toString(),kn),await Ei.save("stepBaselineDate",Mt,kn);const xi=new Date().getDay(),or=xi===0?6:xi-1,Mi=await Ei.get("weeklySteps",kn)||[];for(;Mi.length<7;)Mi.push({steps:0,date:null});Mi[or]={steps:0,date:Mt},await Ei.save("weeklySteps",Mi,kn),es(rn=>({...rn,todaySteps:0,weeklySteps:Mi})),alert(` Step Counter Reset!

Baseline: ${It}
Date: ${Mt}

Today's steps will now start from 0.`),window.location.reload()}catch(It){alert(" Reset failed: "+It.message)}},yl=async()=>{console.log(" User requested background step tracking"),Va(!0);try{console.log(" Step 1: Requesting notification permission...");const{LocalNotifications:It}=await Vt(async()=>{const{LocalNotifications:Mi}=await Promise.resolve().then(()=>C1);return{LocalNotifications:Mi}},void 0),Mt=await It.checkPermissions();if(console.log("Current notification permission:",Mt),Mt.display!=="granted"){console.log("Requesting notification permission...");const Mi=await It.requestPermissions();if(console.log("Notification permission result:",Mi),Mi.display!=="granted"){alert(` Notification Permission Required

Foreground services need notification permission to run 24/7.

Please grant notification permission in the next dialog.`),Va(!1);return}}console.log(" Notification permission granted"),console.log(" Step 2: Starting native step counter service...");const kn=await Vt(()=>import("./chunk-1765759384263-nativeStepService.js"),[]).catch(Mi=>{throw console.error(" Failed to import nativeStepService:",Mi),new Error("Service module not available")}),{default:xi}=kn;if(await xi.start()){ls(!0),console.log(" Service started successfully!");let Mi=!1;const rn=setInterval(async()=>{if(Mi){console.log(" Polling: Skipping - previous save still in progress");return}try{Mi=!0,console.log(" [POLLING] Refreshing dashboard stats..."),await ia(),Ua(),console.log(" [POLLING] Dashboard updated successfully")}catch(Vs){console.error(" [POLLING] Error:",Vs)}finally{Mi=!1}},3e4);window.__stepPollingInterval=rn,setTimeout(async()=>{console.log(" [STARTUP] Loading initial data..."),await ia(),Ua(),console.log(" [STARTUP] Initial data loaded"),alert(` 24/7 Step Tracking Enabled!

 Persistent notification showing
 Steps count even when app is closed
 Dashboard syncs every 30 seconds

Walk around and watch both notification and dashboard update!`)},500)}else alert(` Failed to Start Service

Possible reasons:
 No step counter sensor on device
 Permission denied
 Service already running

Check notification area for " Helio Active"`)}catch(It){console.error(" Failed to start background tracking:",It),alert(` Error Starting Service

`+It.message+`

Try restarting the app or checking app permissions in settings.`)}finally{Va(!1)}},ia=async()=>{if(f){console.log(" loadRealData: Skipping - already in progress");return}x(!0);const It=new Date().toISOString().split("T")[0];try{let Mt=0;try{const{Preferences:Cn}=await Vt(async()=>{const{Preferences:Ri}=await Promise.resolve().then(()=>_L);return{Preferences:Ri}},void 0);try{const Es=(await Cn.get({key:"wellnessai_todaySteps"})).value||"0";try{Mt=parseInt(JSON.parse(Es))}catch{Mt=parseInt(Es)}console.log(" [DASHBOARD] Today steps from notification service:",Mt)}catch(Ri){console.warn(" Could not read today steps:",Ri),Mt=0}console.log(" [DASHBOARD] Using today steps:",Mt)}catch(Cn){console.error(" Error reading steps:",Cn),Mt=0}const kn=Ii.getCurrentUser()?.uid,Mi=(await Ei.get("waterLog",kn)||[]).filter(Cn=>Cn.date===It).reduce((Cn,Ri)=>Cn+(Ri.cups||1),0),pa=(Ii.getCurrentUser()?.profile?.foodLog||[]).filter(Cn=>Cn.date===It||Cn.timestamp&&new Date(Cn.timestamp).toISOString().split("T")[0]===It).length,Wr=await Ei.get("workoutHistory",kn)||[],wi=JSON.parse(localStorage.getItem("workoutHistory")||"[]"),ga=new Map;wi.forEach(Cn=>ga.set(Cn.timestamp,Cn)),Wr.forEach(Cn=>ga.set(Cn.timestamp,Cn));const ki=Array.from(ga.values()).sort((Cn,Ri)=>(Ri.timestamp||0)-(Cn.timestamp||0));localStorage.setItem("workoutHistory",JSON.stringify(ki)),await Ei.save("workoutHistory",ki,kn);const zs=await Ei.get("sleepLog",kn)||[],Ba=JSON.parse(localStorage.getItem("sleepLog")||"[]"),Us=new Map;Ba.forEach(Cn=>Us.set(Cn.timestamp,Cn)),zs.forEach(Cn=>Us.set(Cn.timestamp,Cn));const fn=Array.from(Us.values()).sort((Cn,Ri)=>(Ri.timestamp||0)-(Cn.timestamp||0));localStorage.setItem("sleepLog",JSON.stringify(fn)),await Ei.save("sleepLog",fn,kn);try{const{default:Cn}=await Vt(async()=>{const{default:Ri}=await import("./chunk-1765759384264-socialBattlesService.js");return{default:Ri}},__vite__mapDeps([21,6]));await Cn.init()}catch(Cn){console.warn("Failed to sync battle data:",Cn)}const As=await Ei.get("loginHistory",kn)||[];let Ia=0;if(As.length>0){const Cn=As.sort((Es,$a)=>new Date($a.date)-new Date(Es.date));let Ri=new Date;Ia=1;for(let Es=1;Es<Cn.length;Es++){const $a=new Date(Cn[Es].date),Bs=Math.floor((Ri-$a)/(1e3*60*60*24));if(Bs===1)Ia++,Ri=$a;else if(Bs>1)break}}const qr=await Ei.get("weeklySteps",kn)||[],Tr=new Date().getDay(),ka=Tr===0?6:Tr-1,Vr=new Date().toISOString().split("T")[0];for(;qr.length<7;)qr.push({steps:0,date:null});if(Tr===1){const Cn=qr[0]?.date;if(Cn&&Cn!==Vr)for(let Ri=0;Ri<7;Ri++)qr[Ri]={steps:0,date:null}}qr[ka]={steps:Mt,date:Vr},await Ei.save("weeklySteps",qr,kn);const Ca=JSON.parse(localStorage.getItem("stepHistory")||"[]"),ma=Array.isArray(Ca)?Ca:[],us=ma.findIndex(Cn=>Cn.date===Vr);us>=0?ma[us]={date:Vr,steps:Mt,timestamp:Date.now()}:ma.push({date:Vr,steps:Mt,timestamp:Date.now()}),localStorage.setItem("stepHistory",JSON.stringify(ma)),console.log(" [DASHBOARD] Setting stats.todaySteps to:",Mt),es(Cn=>({...Cn,todaySteps:Mt,waterCups:Mi,mealsLogged:pa,streak:Ia||Cn.streak,weeklySteps:qr})),console.log(" [DASHBOARD] Stats updated! Should now show:",Mt,"steps")}catch{}finally{x(!1)}};Te.useEffect(()=>((async()=>{console.log(" [MOUNT] Loading dashboard data immediately..."),await ia(),Ua(),console.log(" [MOUNT] Initial data loaded");try{console.log(" [AUTO-START] Checking if foreground service is running...");const Mt=await Vt(()=>import("./chunk-1765759384263-nativeStepService.js"),[]).catch(or=>(console.error(" Failed to import nativeStepService:",or),null));if(!Mt){console.warn(" [AUTO-START] Service module not available");return}const{default:kn}=Mt,xi=kn.isRunning;if(console.log(" [AUTO-START] Service running status:",xi),xi)console.log(" [AUTO-START] Foreground service already running"),ls(!0);else{console.log(" [AUTO-START] Foreground service not running - starting automatically...");const{LocalNotifications:or}=await Vt(async()=>{const{LocalNotifications:rn}=await Promise.resolve().then(()=>C1);return{LocalNotifications:rn}},void 0),Mi=await or.checkPermissions();if(console.log(" [AUTO-START] Notification permission:",Mi.display),Mi.display==="granted"){console.log(" [AUTO-START] Permission granted, starting service...");const rn=await kn.start();if(console.log(" [AUTO-START] Service start result:",rn),rn){ls(!0),console.log(" [AUTO-START] Foreground service started successfully!");const Vs=setInterval(async()=>{console.log(" [POLLING] Refreshing dashboard stats..."),await ia()},3e4);window._stepPollInterval=Vs}}else console.log(" [AUTO-START] Notification permission not granted - service needs manual start")}}catch(Mt){console.error(" [AUTO-START] Failed to auto-start service:",Mt)}})(),()=>{window._stepPollInterval&&(console.log(" Cleaning up polling interval"),clearInterval(window._stepPollInterval))}),[]),Te.useEffect(()=>{Sr.trackPageView("Dashboard_Home"),window.subscriptionService=ar,(async()=>{await Ii.initialize(),await Xh.initialize();const xi=Ii.getCurrentUser();xi&&(r(xi),!xi.profile?.allergens&&!xi.profile?.age&&l(!0))})();let Mt=null;return(async()=>{try{await Nc.initialize(),await new Promise(xi=>setTimeout(xi,100)),Nc.isUsingMultiSensor?(Yi("multisensor"),window.stepMethod="multisensor",window.activeSensorCount=Nc.activeSensorCount):Nc.isUsingHardware?(Yi("hardware"),window.stepMethod="hardware"):(Yi("software"),window.stepMethod="software"),Mt=()=>{const xi=Nc.stepListeners.indexOf(stepListener);xi>-1&&Nc.stepListeners.splice(xi,1),Nc.cleanup()}}catch{}})(),()=>{Mt&&Mt()}},[]);const Oi=async()=>{const It=new Date().toISOString().split("T")[0],Mt=Nc.getStepCount(),or=JSON.parse(localStorage.getItem("waterLog")||"[]").filter(wi=>wi.date===It).reduce((wi,ga)=>wi+(ga.cups||1),0),io=(Ii.getCurrentUser()?.profile?.foodLog||[]).filter(wi=>wi.date===It||wi.timestamp&&new Date(wi.timestamp).toISOString().split("T")[0]===It).length;JSON.parse(localStorage.getItem("workoutHistory")||"[]").filter(wi=>wi.date===It).length,es(wi=>({...wi,todaySteps:Mt,waterCups:or,mealsLogged:io})),await Ua()};Te.useEffect(()=>{S1.initialize(),BG.initialize(),Od.isConnected()&&(Ps(!0),Od.subscribe(Mt=>{es(kn=>({...kn,heartRate:Mt.bpm}))})),Xf.isTracking&&na(!0),Xf.restoreSleepSession();const It=()=>{Ts(!0)};return window.addEventListener("openHeartRate",hn),window.addEventListener("openSleep",Ea),window.addEventListener("openWaterModal",It),window.addEventListener("openWorkouts",_r),window.addEventListener("openFoodScanner",js),window.addEventListener("openBreathing",jr),window.addEventListener("openGuidedMeditation",oi),()=>{window.removeEventListener("openHeartRate",hn),window.removeEventListener("openSleep",Ea),window.removeEventListener("openWaterModal",It),window.removeEventListener("openWorkouts",_r),window.removeEventListener("openFoodScanner",js),window.removeEventListener("openBreathing",jr),window.removeEventListener("openGuidedMeditation",oi)}},[]);const no=()=>{const It=new Date().getHours(),Mt=n?.profile?.fullName||n?.displayName||n?.name||n?.profile?.name||"Champion";return It<12?`Good morning, ${Mt}! `:It<18?`Good afternoon, ${Mt}! `:`Good evening, ${Mt}! `},vl=()=>{const It=["You're absolutely crushing it today! ","Keep going, you're unstoppable! ","Your future self will thank you! ","Every step counts. You got this! ","Small wins lead to big victories! "];return It[Math.floor(Math.random()*It.length)]},_l=()=>{h(!0),setTimeout(()=>h(!1),3e3)},zo=async()=>{const It=[],Mt=new Date().toISOString().split("T")[0];try{const kn=JSON.parse(localStorage.getItem("stepHistory")||"[]");(Array.isArray(kn)?kn:[]).filter(fn=>fn.date===Mt).forEach(fn=>{It.push({type:"steps",icon:"",text:`${fn.steps} steps`,time:new Date(fn.timestamp||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.timestamp||Date.now(),calories:Math.floor(fn.steps*.04)})});const or=JSON.parse(localStorage.getItem("workoutHistory")||"[]");(Array.isArray(or)?or:[]).filter(fn=>fn.date===Mt).forEach(fn=>{It.push({type:"workout",icon:"",text:`${fn.type||"Workout"} - ${fn.duration||0} min`,time:new Date(fn.timestamp||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.timestamp||Date.now(),calories:fn.calories||0})});const{value:rn}=await gn.get({key:"foodLog"}),Vs=rn?JSON.parse(rn):[];(Array.isArray(Vs)?Vs:[]).filter(fn=>fn.date===Mt||new Date(fn.timestamp).toISOString().split("T")[0]===Mt).forEach(fn=>{It.push({type:"meal",icon:"",text:fn.name||"Meal logged",time:new Date(fn.timestamp||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.timestamp||Date.now(),calories:fn.calories||0})});const pa=JSON.parse(localStorage.getItem("sleepLog")||"[]");(Array.isArray(pa)?pa:[]).filter(fn=>fn.date===Mt).forEach(fn=>{It.push({type:"sleep",icon:"",text:`${fn.hours||0}h ${fn.minutes||0}m sleep`,time:new Date(fn.timestamp||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.timestamp||Date.now()})});const wi=JSON.parse(localStorage.getItem("waterLog")||"[]");(Array.isArray(wi)?wi:[]).filter(fn=>fn.date===Mt).forEach(fn=>{It.push({type:"water",icon:"",text:`${fn.cups||1} cup water`,time:new Date(fn.timestamp||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.timestamp||Date.now()})});const ki=JSON.parse(localStorage.getItem("meditationLog")||"[]");(Array.isArray(ki)?ki:[]).filter(fn=>fn.date===Mt).forEach(fn=>{It.push({type:"meditation",icon:"",text:`${fn.duration||0} min meditation`,time:new Date(fn.timestamp||Date.now()).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.timestamp||Date.now()})});const Ba=JSON.parse(localStorage.getItem("activityLog")||"[]");(Array.isArray(Ba)?Ba:[]).filter(fn=>new Date(fn.startTime).toISOString().split("T")[0]===Mt).forEach(fn=>{fn.activity&&fn.activity!=="stationary"&&It.push({type:"activity",icon:fn.activity==="running"?"":fn.activity==="walking"?"":"",text:`${fn.activity} detected`,time:new Date(fn.startTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),timestamp:fn.startTime})})}catch{}return It.sort((kn,xi)=>(xi.timestamp||0)-(kn.timestamp||0))},Ua=async()=>{const It=await zo();w(It.slice(0,10)),B(It.length)};return Te.useEffect(()=>{e==="home"&&Ua()},[e]),b.jsxs("div",{className:"new-dashboard",children:[b.jsx(Te.Suspense,{fallback:null,children:b.jsx(Iq,{})}),Dt&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(Rq,{achievement:Dt,onClose:()=>wn(null)})}),Xt&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(Oq,{userName:n?.name||n?.profile?.name||"Friend",onClose:()=>Tn(!1)})}),li&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(mq,{onClose:()=>Xn(!1)})}),bn&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(Mq,{onClose:()=>Un(!1),onOpenHealthAvatar:()=>{Un(!1),Sr.trackFeatureUse("Health_Avatar"),W(!0)},onOpenARScanner:()=>{Un(!1),Sr.trackFeatureUse("AR_Scanner"),ge(!0)},onOpenEmergency:()=>{Un(!1),Sr.trackFeatureUse("Emergency_Panel"),Ve(!0)},onOpenInsurance:()=>{Un(!1),Sr.trackFeatureUse("Insurance_Rewards"),ee(!0)}})}),ii&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(Fq,{onClose:()=>Bn(!1),onOpenDNA:()=>{Bn(!1),Sr.trackFeatureUse("DNA_Analysis"),ye(!0)},onExportDailyStats:za,onExportWorkoutHistory:ri,onExportFoodLog:dr,onExportFullReport:Lr,checkFeatureAccess:(It,Mt)=>{if(ar.hasAccess(It))Mt();else{Bn(!1);const kn=ar.showPaywall(It,()=>Qt(!0));Ci(kn)}}})}),ln&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(jq,{onClose:()=>$n(!1),onOpenBattles:()=>{$n(!1),Sr.trackFeatureUse("Social_Battles"),ae(!0)},onOpenMeals:()=>{$n(!1),Sr.trackFeatureUse("Meal_Automation"),ze(!0)},checkFeatureAccess:(It,Mt)=>{if(ar.hasAccess(It))Mt();else{$n(!1);const kn=ar.showPaywall(It,()=>Qt(!0));Ci(kn)}}})}),cn&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(Vq,{onClose:()=>er(!1),onOpenNotifications:()=>{er(!1),De(!0)},onOpenTheme:()=>{er(!1),$e(!0)},onOpenDevUnlock:()=>{er(!1),Rr(!0)},onLogout:()=>{er(!1),Ii.signOut(),i("/")},showDevButton:tr,isDevMode:ms,onDisableDevMode:Vo,onResetStepCounter:br,user:{...n,onOpenStripePayment:()=>Qt(!0),onOpenAppleHealth:()=>Kn(!0),onOpenWearables:()=>vr(!0),onOpenDataRecovery:()=>Zr(!0)}})}),Jn&&b.jsx(Te.Suspense,{fallback:null,children:b.jsx(zq,{isOpen:Jn,onClose:()=>mn(!1)})}),u&&b.jsx("div",{className:"confetti-container",children:[...Array(50)].map((It,Mt)=>b.jsx("div",{className:"confetti",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*.5}s`,background:["#FF6B35","#FFB84D","#44FF44","#00C8FF","#FF00FF"][Math.floor(Math.random()*5)]}},Mt))}),b.jsxs("div",{className:"dashboard-content",children:[e==="home"&&b.jsxs(b.Fragment,{children:[b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(kq,{})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Cq,{onChallengeComplete:It=>{}})}),b.jsx(Bq,{stats:ys,greeting:no(),motivation:vl(),onGoalComplete:_l,recentActivities:g,activityCount:A,onOpenActivityPulse:()=>ct(!0),stepMethod:qi,handleOpenWorkouts:_r,handleOpenFoodScanner:js,handleOpenHeartRate:hn,handleOpenSleep:Ea,onOpenBarcodeScanner:()=>{Sr.trackFeatureUse("Barcode_Scanner"),je(!0)},onOpenRecipeCreator:()=>{Sr.trackFeatureUse("Recipe_Creator"),ze(!0)},onOpenRestaurants:()=>{Sr.trackFeatureUse("Restaurants"),je(!0)},onOpenSocial:()=>{Sr.trackFeatureUse("Social_Battles"),ae(!0)},onOpenRepCounter:()=>{Sr.trackFeatureUse("Rep_Counter"),qe(!0)},onOpenBrainInsights:()=>{Sr.trackFeatureUse("Brain_Insights"),Xn(!0)},nativeServiceRunning:Kr,nativeServiceStarting:da,onStartNativeService:yl,setNativeServiceRunning:ls,onOpenQuickLog:()=>mn(!0)})]}),e==="voice"&&_t&&b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Lq,{userName:n?.name||n?.profile?.name||"Friend",onOpenVoiceChat:It=>{},onOpenAIAssistant:()=>Tn(!0)})}),e==="voice"&&!_t&&b.jsx($q,{userName:n?.name||n?.profile?.name||"Friend"}),e==="scan"&&_t&&b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Nq,{onOpenFoodScanner:()=>{Sr.trackFeatureUse("Food_Scanner"),me(!0)},onOpenARScanner:()=>{Sr.trackFeatureUse("AR_Scanner"),ge(!0)},onOpenBarcodeScanner:()=>{Sr.trackFeatureUse("Barcode_Scanner"),je(!0)},onOpenRepCounter:()=>{Sr.trackFeatureUse("Rep_Counter"),qe(!0)}})}),e==="scan"&&!_t&&b.jsx(Gq,{onOpenFoodScanner:()=>{Sr.trackFeatureUse("Food_Scanner"),me(!0)},onOpenARScanner:()=>{Sr.trackFeatureUse("AR_Scanner"),ge(!0)},onOpenBarcodeScanner:()=>{Sr.trackFeatureUse("Barcode_Scanner"),je(!0)},onOpenRepCounter:()=>{Sr.trackFeatureUse("Rep_Counter"),qe(!0)}}),e==="zen"&&_t&&b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Dq,{onOpenBreathing:jr,onOpenMeditation:oi})}),e==="zen"&&!_t&&b.jsx(Hq,{onOpenBreathing:jr,onOpenStressRelief:jr,onOpenGuidedMeditation:oi,onOpenGratitudeJournal:()=>$t(!0)}),e==="me"&&_t&&b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Pq,{user:n,onOpenSettings:It=>{},onOpenPremium:()=>Qt(!0),onOpenHealthTools:()=>Un(!0),onOpenDataManagement:()=>Bn(!0),onOpenSocialFeatures:()=>$n(!0),onOpenSettingsHub:()=>er(!0),onEditProfile:()=>l(!0),onOpenFullStats:()=>se(!0)})}),e==="me"&&!_t&&b.jsx(Kq,{user:{...n,onOpenStripePayment:()=>Qt(!0),onOpenAppleHealth:()=>Kn(!0),onOpenWearables:()=>vr(!0),onOpenDataRecovery:()=>Zr(!0)},stats:ys,onOpenHealthAvatar:()=>{Sr.trackFeatureUse("Health_Avatar"),W(!0)},onOpenARScanner:()=>{Sr.trackFeatureUse("AR_Scanner"),ge(!0)},onOpenEmergency:()=>{Sr.trackFeatureUse("Emergency_Panel"),Ve(!0)},onOpenInsurance:()=>{Sr.trackFeatureUse("Insurance_Rewards"),ee(!0)},onOpenDNA:()=>{Sr.trackFeatureUse("DNA_Analysis"),ye(!0)},onOpenBattles:()=>{Sr.trackFeatureUse("Social_Battles"),ae(!0)},onOpenMeals:()=>{Sr.trackFeatureUse("Meal_Automation"),ze(!0)},onEditProfile:()=>l(!0),onOpenFullStats:async()=>{await Oi(),se(!0)},onOpenNotifications:()=>De(!0),onOpenTheme:()=>$e(!0),onLogout:()=>{Ii.signOut(),i("/")},checkFeatureAccess:(It,Mt)=>{if(ar.hasAccess(It))Mt();else{const kn=ar.showPaywall(It,()=>Qt(!0));Ci(kn)}},onExportDailyStats:za,onExportWorkoutHistory:ri,onExportFoodLog:dr,onExportFullReport:Lr,showDevButton:tr,isDevMode:ms,onOpenDevUnlock:()=>Rr(!0),onResetStepCounter:br,onDisableDevMode:Vo})]}),b.jsxs("nav",{className:"bottom-nav",children:[b.jsxs("button",{className:`nav-item ${e==="home"?"active":""}`,onClick:()=>t("home"),children:[b.jsx("span",{className:"nav-icon",children:""}),b.jsx("span",{className:"nav-label",children:"Home"})]}),b.jsxs("button",{className:`nav-item ${e==="voice"?"active":""}`,onClick:()=>t("voice"),children:[b.jsx("span",{className:"nav-icon",children:""}),b.jsx("span",{className:"nav-label",children:"Voice"})]}),b.jsx("button",{className:`nav-item center ${e==="scan"?"active":""}`,onClick:()=>t("scan"),children:b.jsx("span",{className:"nav-icon-center",children:""})}),b.jsxs("button",{className:`nav-item ${e==="zen"?"active":""}`,onClick:()=>t("zen"),children:[b.jsx("span",{className:"nav-icon",children:""}),b.jsx("span",{className:"nav-label",children:"Zen"})]}),b.jsxs("button",{className:`nav-item ${e==="me"?"active":""}`,onClick:()=>t("me"),children:[b.jsx("span",{className:"nav-icon",children:""}),b.jsx("span",{className:"nav-label",children:"Me"})]})]}),b.jsxs(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:[s&&b.jsx(tu,{fallbackMessage:"Profile setup encountered an error. Please try again.",children:b.jsx(XW,{onComplete:()=>{l(!1);const It=Ii.getCurrentUser();r(It)}})}),$&&b.jsx(tu,{fallbackMessage:"Health avatar encountered an error. Please try again.",onReset:()=>W(!1),children:b.jsx(JW,{onClose:()=>W(!1)})}),q&&b.jsx(tu,{fallbackMessage:"AR scanner encountered an error. Please try again.",onReset:()=>ge(!1),children:b.jsx(QW,{onClose:()=>ge(!1)})}),he&&b.jsx(tu,{fallbackMessage:"Food scanner encountered an error. Please try again.",onReset:()=>me(!1),children:b.jsx(YW,{onClose:()=>{me(!1),Oi()}})}),Ce&&b.jsx(tu,{fallbackMessage:"Emergency panel encountered an error. Please try again.",onReset:()=>Ve(!1),children:b.jsx(ZW,{onClose:()=>Ve(!1)})}),pe&&b.jsx(tu,{fallbackMessage:"Insurance rewards encountered an error. Please try again.",onReset:()=>ee(!1),children:b.jsx(eq,{onClose:()=>ee(!1)})}),J&&b.jsx(tu,{fallbackMessage:"DNA upload encountered an error. Please try again.",onReset:()=>ye(!1),children:b.jsx(tq,{onClose:()=>ye(!1)})}),X&&b.jsx(tu,{fallbackMessage:"Social battles encountered an error. Please try again.",onReset:()=>ae(!1),children:b.jsx(nq,{onClose:async()=>{ae(!1),await Oi();const{default:It}=await Vt(async()=>{const{default:Mt}=await import("./chunk-1765759384264-socialBattlesService.js");return{default:Mt}},__vite__mapDeps([21,6]));await It.init()}})}),le&&b.jsx(tu,{fallbackMessage:"Meal automation encountered an error. Please try again.",onReset:()=>ze(!1),children:b.jsx(iq,{onClose:()=>ze(!1)})}),nt&&b.jsx(tu,{fallbackMessage:"Barcode scanner encountered an error. Please try again.",onReset:()=>je(!1),children:b.jsx(fq,{onClose:()=>je(!1),onFoodScanned:It=>{}})}),Je&&b.jsx(tu,{fallbackMessage:"Rep counter encountered an error. Please try again.",onReset:()=>qe(!1),children:b.jsx(pq,{onClose:()=>qe(!1),onWorkoutComplete:It=>{T1.addXP(It.reps*2),qe(!1),Oi()}})})]}),Ee&&b.jsx(qq,{user:n,onClose:()=>De(!1)}),Be&&b.jsx(Yq,{onClose:()=>$e(!1)}),Ne&&b.jsx(Wq,{user:n,stats:ys,onClose:()=>se(!1)}),Ye&&b.jsx(Xq,{activitiesPromise:zo(),onClose:()=>ct(!1)}),Ft&&b.jsx(tY,{onClose:()=>Wt(!1)}),qt&&b.jsx(nY,{onClose:()=>Et(!1)}),Ms&&b.jsx(Jq,{onClose:()=>{hr(!1),Oi()}}),ml&&b.jsx(Qq,{onClose:async()=>{Fs(!1),await Oi();try{const{default:It}=await Vt(async()=>{const{default:Mt}=await import("./chunk-1765759384264-healthAvatarService.js");return{default:Mt}},[]);It.cachedState=null,It.cacheTimestamp=0}catch(It){console.warn("Could not clear avatar cache:",It)}}}),fa&&b.jsx(Zq,{onClose:()=>{Ts(!1),Oi()}}),tl&&b.jsx(JD,{onClose:async()=>{Fo(!1),await Oi();try{const{default:It}=await Vt(async()=>{const{default:Mt}=await import("./chunk-1765759384264-healthAvatarService.js");return{default:Mt}},[]);It.cachedState=null,It.cacheTimestamp=0}catch(It){console.warn("Could not clear avatar cache:",It)}}}),ut&&b.jsx(eY,{onClose:()=>{Tt(!1),Oi()}}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:On&&b.jsx(sq,{isOpen:On,onClose:()=>qn(!1)})}),b.jsx(Te.Suspense,{fallback:null,children:on&&b.jsx(gq,{fallData:Mn,onDismiss:()=>{Ni(!1),xn(null)}})}),b.jsxs(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:[Qn&&b.jsx(aq,{isOpen:Qn,onClose:()=>Qt(!1)}),Ht&&b.jsx(oq,{isOpen:Ht,onClose:()=>Kn(!1)}),kr&&b.jsx(lq,{isOpen:kr,onClose:()=>vr(!1)})]}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:Cr.show&&b.jsx(uq,{isOpen:Cr.show,onClose:()=>Ci({...Cr,show:!1}),featureName:Cr.featureName,message:Cr.message,currentPlan:Cr.currentPlan,requiredPlan:Cr.requiredPlan,onUpgrade:Cr.onUpgrade})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:dn&&b.jsx(cq,{onComplete:()=>Aa(!1),onSkip:()=>Aa(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:ta&&b.jsx(hq,{onUnlock:Bl,onCancel:()=>Rr(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:os&&b.jsx(dq,{onClose:()=>Zr(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{className:"modal-loading",children:"Loading..."}),children:Pe&&b.jsx(rq,{onClose:()=>$t(!1)})}),b.jsxs("button",{className:"floating-help-btn",onClick:()=>qn(!0),title:"Legal Information & Help",children:[b.jsx("span",{className:"help-icon",children:""}),b.jsx("span",{className:"help-text",children:"Legal"})]})]})}function Bq({stats:i,greeting:e,motivation:t,onGoalComplete:n,recentActivities:r,activityCount:s,onOpenActivityPulse:l,stepMethod:u,handleOpenWorkouts:h,handleOpenFoodScanner:f,handleOpenHeartRate:x,handleOpenSleep:g,onOpenBarcodeScanner:w,onOpenRecipeCreator:A,onOpenRestaurants:B,onOpenSocial:$,onOpenRepCounter:W,onOpenBrainInsights:q,nativeServiceRunning:ge,nativeServiceStarting:he,onStartNativeService:me,setNativeServiceRunning:Ce,onOpenQuickLog:Ve}){const[pe,ee]=Te.useState(!1),[J,ye]=Te.useState(!1),[X,ae]=Te.useState(!1),[le,ze]=Te.useState(!1),[nt,je]=Te.useState(!1),[Je,qe]=Te.useState(!1),[ot,St]=Te.useState(!1),[Ne,se]=Te.useState(!1),[Ee,De]=Te.useState(!1),Be=[{icon:"",label:"AI INSIGHTS",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",onClick:q},{icon:"",label:"MY STATS",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",onClick:()=>ee(!0)},{icon:"",label:"BATTLES",gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",onClick:()=>ae(!0)},{icon:"",label:"FOOD",gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",onClick:()=>ze(!0)},{icon:"",label:"DNA",gradient:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",onClick:()=>je(!0)},{icon:"",label:"WORKOUTS",gradient:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",onClick:()=>qe(!0)},{icon:"",label:"HEALTH",gradient:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",onClick:()=>St(!0)},{icon:"",label:"GOALS",gradient:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",onClick:()=>se(!0)},{icon:"",label:"PROGRESS",gradient:"linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)",onClick:()=>De(!0)},{icon:"",label:"PREMIUM",gradient:"linear-gradient(135deg, #ffd700 0%, #ffed4e 100%)",onClick:()=>ye(!0)}];return b.jsxs("div",{className:"home-tab",style:{paddingBottom:"100px",overflowY:"auto",height:"100%"},children:[b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(yq,{todaySteps:i.todaySteps})}),!ge&&b.jsxs("button",{onClick:me,disabled:he,style:{width:"100%",padding:"12px 16px",background:"linear-gradient(135deg, #00C8FF 0%, #0088FF 100%)",border:"none",borderRadius:"12px",color:"white",fontSize:"14px",fontWeight:"600",cursor:he?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"12px",boxShadow:"0 2px 8px rgba(0, 136, 255, 0.3)",transition:"all 0.3s ease",opacity:he?.7:1},onMouseOver:$e=>{he||($e.currentTarget.style.transform="translateY(-1px)"),$e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 136, 255, 0.4)"},onMouseOut:$e=>{$e.currentTarget.style.transform="translateY(0)",$e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 136, 255, 0.3)"},children:[b.jsx("span",{style:{fontSize:"18px"},children:he?"":""}),b.jsx("span",{children:he?"Starting...":"Enable 24/7 Step Tracking"})]}),ge&&b.jsxs("button",{onClick:async()=>{try{const{default:$e}=await Vt(async()=>{const{default:Ye}=await import("./chunk-1765759384263-nativeStepService.js");return{default:Ye}},[]);await $e.stop(),Ce(!1),window.__stepPollingInterval&&clearInterval(window.__stepPollingInterval)}catch($e){console.error("Failed to stop native service:",$e),alert("Failed to stop tracking service")}},style:{width:"100%",padding:"12px 16px",background:"linear-gradient(135deg, #44FF44 0%, #00FF88 100%)",border:"none",borderRadius:"12px",color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px",boxShadow:"0 2px 8px rgba(68, 255, 68, 0.3)",transition:"all 0.3s ease"},children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[b.jsx("span",{style:{fontSize:"18px"},children:""}),b.jsx("span",{children:"24/7 Tracking Active"})]}),b.jsx("span",{style:{fontSize:"12px",opacity:.9},children:"Tap to stop"})]}),window.dnaDailyTip&&b.jsxs("div",{className:"dna-tip-banner",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"16px",borderRadius:"16px",margin:"16px 0",display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.3)",cursor:"pointer"},onClick:()=>alert(`${window.dnaDailyTip.tip}

Based on your ${window.dnaDailyTip.gene} gene (${window.dnaDailyTip.trait}: ${window.dnaDailyTip.value})`),children:[b.jsx("span",{style:{fontSize:"32px"},children:window.dnaDailyTip.icon}),b.jsxs("div",{style:{flex:1},children:[b.jsx("div",{style:{color:"white",fontWeight:"bold",fontSize:"14px",marginBottom:"4px"},children:" DNA Daily Tip"}),b.jsx("div",{style:{color:"rgba(255,255,255,0.9)",fontSize:"13px"},children:window.dnaDailyTip.title}),b.jsxs("div",{style:{color:"rgba(255,255,255,0.7)",fontSize:"12px",marginTop:"4px"},children:[window.dnaDailyTip.tip.substring(0,80),"..."]})]}),b.jsx("span",{style:{color:"white",fontSize:"20px"},children:""})]}),b.jsxs("button",{onClick:Ve,style:{width:"100%",padding:"12px 16px",background:"linear-gradient(135deg, #8B5FE8 0%, #C084FC 100%)",border:"none",borderRadius:"12px",color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"12px",boxShadow:"0 2px 8px rgba(139, 95, 232, 0.3)",transition:"all 0.3s ease"},onMouseOver:$e=>{$e.currentTarget.style.transform="translateY(-1px)",$e.currentTarget.style.boxShadow="0 4px 12px rgba(139, 95, 232, 0.4)"},onMouseOut:$e=>{$e.currentTarget.style.transform="translateY(0)",$e.currentTarget.style.boxShadow="0 2px 8px rgba(139, 95, 232, 0.3)"},children:[b.jsx("span",{style:{fontSize:"18px"},children:""}),b.jsx("span",{children:"Quick Log - Water/Sleep/Workout"})]}),b.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",padding:"0 4px",marginBottom:"20px"},children:Be.map(($e,Ye)=>b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(vq,{icon:$e.icon,label:$e.label,gradient:$e.gradient,onClick:$e.onClick})},Ye))}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(_q,{isOpen:pe,onClose:()=>ee(!1),todaySteps:i.todaySteps})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(bq,{isOpen:J,onClose:()=>ye(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(xq,{isOpen:X,onClose:()=>ae(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(wq,{isOpen:le,onClose:()=>ze(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Sq,{isOpen:nt,onClose:()=>je(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(JD,{isOpen:Je,onClose:()=>qe(!1),onOpenRepCounter:W,onOpenWorkouts:h})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Tq,{isOpen:ot,onClose:()=>St(!1)})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Aq,{isOpen:Ne,onClose:()=>se(!1),todaySteps:i.todaySteps})}),b.jsx(Te.Suspense,{fallback:b.jsx("div",{children:"Loading..."}),children:b.jsx(Eq,{isOpen:Ee,onClose:()=>De(!1),todaySteps:i.todaySteps})}),b.jsx("div",{style:{height:"20px",flexShrink:0}})]})}function $q({userName:i}){const[e,t]=Te.useState(!1),[n,r]=Te.useState(!1),[s,l]=Te.useState(!1),[u,h]=Te.useState(""),[f,x]=Te.useState(!1),[g,w]=Te.useState([{type:"ai",text:`Hey ${i}! I'm here to help. What's on your mind?`}]),A=async()=>{t(!0);try{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const Ce=window.SpeechRecognition||window.webkitSpeechRecognition,Ve=new Ce;Ve.continuous=!1,Ve.interimResults=!1,Ve.lang="en-US",Ve.onresult=pe=>{const ee=pe.results[0][0].transcript;t(!1),W(ee)},Ve.onerror=pe=>{t(!1),w(ee=>[...ee,{type:"ai",text:"I couldn't hear you. Try typing instead!"}])},Ve.onend=()=>{t(!1)},Ve.start();return}const{SpeechRecognition:he}=await Vt(async()=>{const{SpeechRecognition:Ce}=await import("./chunk-1765759384264-index.js");return{SpeechRecognition:Ce}},[]);try{if(!(await he.available()).available)throw new Error("Speech recognition not available")}catch{throw new Error("Speech not supported")}try{if((await he.requestPermissions()).speechRecognition!=="granted"){alert("Please allow microphone access in your phone settings"),t(!1);return}}catch{alert("Microphone permission required. Please enable it in Settings."),t(!1);return}try{await he.removeAllListeners()}catch{}let me=!1;he.addListener("error",Ce=>{me||(w(Ve=>[...Ve,{type:"ai",text:"I couldn't hear you clearly. Please try again or use the suggestion buttons below!"}]),t(!1))}),he.addListener("result",async Ce=>{if(me=!0,Ce.matches&&Ce.matches.length>0){const Ve=Ce.matches[0];w(pe=>[...pe,{type:"user",text:Ve}]),t(!1),r(!0);try{await he.stop()}catch{}x(!1);try{const pe=(await Vt(async()=>{const{default:ye}=await Promise.resolve().then(()=>Bk);return{default:ye}},void 0)).default,ee=JSON.parse(localStorage.getItem("wellnessai_user")||"{}"),J=await pe.chat(Ve,{allergens:ee.profile?.allergens||[],dietaryPreferences:ee.profile?.dietaryPreferences||[],healthGoals:ee.profile?.healthGoals||[]});w(ye=>[...ye,{type:"ai",text:J}]),await $(J)}catch{w(ee=>[...ee,{type:"ai",text:"Oops! I had trouble with that. Can you try asking in a different way?"}])}r(!1)}else t(!1)}),await he.start({language:"en-US",maxResults:5,prompt:"Speak now",partialResults:!1,popup:!0}),setTimeout(async()=>{if(!me){try{await he.stop(),w(Ce=>[...Ce,{type:"ai",text:"I didn't catch that. Try speaking again or use the suggestion buttons!"}])}catch{}t(!1)}},1e4)}catch{w(me=>[...me,{type:"ai",text:"Voice input not available right now  But I can still help! Try clicking the suggestion buttons below or typing your question."}]),t(!1)}},B=async()=>{try{const{SpeechRecognition:he}=await Vt(async()=>{const{SpeechRecognition:me}=await import("./chunk-1765759384264-index.js");return{SpeechRecognition:me}},[]);await he.stop(),await he.removeAllListeners()}catch{}t(!1)},$=async he=>{try{const{TextToSpeech:me}=await Vt(async()=>{const{TextToSpeech:Ce}=await Promise.resolve().then(()=>$G);return{TextToSpeech:Ce}},void 0);l(!0),await me.speak({text:he,lang:"en-US",rate:1,pitch:1,volume:1,category:"ambient"}),l(!1)}catch{l(!1)}},W=async(he,me=!1)=>{const Ce=localStorage.getItem("helio_dev_mode")==="true";if(!Ce){const Ve=ar.checkLimit("aiMessages");if(!Ve.allowed){w(pe=>[...pe,{type:"user",text:he},{type:"ai",text:` You've reached your daily limit of ${Ve.limit} AI messages.

Upgrade for more:
 Essential 4.99/mo - 30 messages/day
 Premium 14.99/mo - 50 messages/day
 Ultimate 29.99/mo - UNLIMITED messages`}]),setPaywallData(ar.showPaywall("aiVoiceCoach",()=>setShowStripePayment(!0)));return}}w(Ve=>[...Ve,{type:"user",text:he}]),r(!0);try{const Ve=(await Vt(async()=>{const{default:J}=await Promise.resolve().then(()=>Bk);return{default:J}},void 0)).default,pe=JSON.parse(localStorage.getItem("wellnessai_user")||"{}"),ee=await Ve.chat(he,{allergens:pe.profile?.allergens||[],dietaryPreferences:pe.profile?.dietaryPreferences||[],healthGoals:pe.profile?.healthGoals||[]});if(w(J=>[...J,{type:"ai",text:ee}]),!Ce){ar.incrementUsage("aiMessages");const J=ar.checkLimit("aiMessages")}me||await $(ee)}catch(Ve){const pe=`Error: ${Ve.message}. Check console for details.`;w(ee=>[...ee,{type:"ai",text:pe}]),await $("There was an error. Please check your internet connection and try again.")}r(!1)},q=he=>{x(!1),W(he,!1)},ge=he=>{he.preventDefault(),u.trim()&&(x(!0),W(u,!0),h(""))};return b.jsxs("div",{className:"voice-tab",children:[b.jsxs("div",{className:"voice-header",children:[b.jsx("h1",{children:"AI Voice Coach "}),b.jsx("p",{children:"Just talk to me like a friend"}),(()=>{if(localStorage.getItem("helio_dev_mode")==="true")return null;const me=window.subscriptionService?.checkLimit("aiMessages");return me&&!window.subscriptionService?.hasAccess("aiVoiceCoach")?b.jsx("div",{style:{marginTop:"10px",padding:"8px 16px",background:me.remaining<=1?"rgba(255, 68, 68, 0.2)":"rgba(139, 95, 232, 0.2)",borderRadius:"20px",fontSize:"13px",color:me.remaining<=1?"#FF4444":"#C084FC",fontWeight:"bold",border:`2px solid ${me.remaining<=1?"#FF4444":"rgba(139, 95, 232, 0.4)"}`},children:me.remaining>0?b.jsxs(b.Fragment,{children:[" ",me.remaining,"/",me.limit," messages left today"]}):b.jsx(b.Fragment,{children:" Daily limit reached - Upgrade for unlimited!"})}):null})()]}),b.jsxs("div",{className:"voice-messages",children:[g.map((he,me)=>b.jsxs("div",{className:`voice-message ${he.type}`,onClick:()=>he.type==="ai"&&$(he.text),title:he.type==="ai"?"Click to hear again":"",children:[b.jsx("span",{className:"message-icon",children:he.type==="ai"?"":""}),b.jsx("p",{children:he.text})]},me)),n&&b.jsxs("div",{className:"voice-message ai loading-message",children:[b.jsx("span",{className:"message-icon",children:""}),b.jsxs("p",{children:[b.jsxs("span",{className:"typing-indicator",children:[b.jsx("span",{}),b.jsx("span",{}),b.jsx("span",{})]}),"Thinking..."]})]})]}),b.jsx("button",{className:`voice-button ${e?"listening":""}`,onClick:e?B:A,disabled:n,children:e?b.jsxs(b.Fragment,{children:[b.jsx("span",{className:"pulse-ring"}),b.jsx("span",{className:"voice-icon",children:""}),b.jsx("p",{children:"I'm listening..."})]}):n?b.jsxs(b.Fragment,{children:[b.jsx("span",{className:"voice-icon",children:""}),b.jsx("p",{children:"Processing..."})]}):b.jsxs(b.Fragment,{children:[b.jsx("span",{className:"voice-icon",children:""}),b.jsx("p",{children:"Tap to talk"})]})}),b.jsxs("form",{className:"voice-text-input",onSubmit:ge,children:[b.jsx("input",{type:"text",value:u,onChange:he=>h(he.target.value),placeholder:"Or type your message...",disabled:n||e,className:"text-input-field"}),b.jsx("button",{type:"submit",className:"text-send-btn",disabled:!u.trim()||n||e,children:"Send "})]}),b.jsxs("div",{className:"voice-suggestions",children:[b.jsx("p",{className:"suggestions-label",children:"Or try these quick questions:"}),b.jsx("button",{className:"suggestion-chip",onClick:()=>q("What should I eat for lunch?"),disabled:e||n,children:'"What should I eat for lunch?"'}),b.jsx("button",{className:"suggestion-chip",onClick:()=>q("How am I doing today?"),disabled:e||n,children:'"How am I doing today?"'}),b.jsx("button",{className:"suggestion-chip",onClick:()=>q("Show me my progress"),disabled:e||n,children:'"Show me my progress"'})]}),s&&b.jsxs("div",{className:"speaking-indicator",children:[b.jsx("span",{className:"speaker-icon",children:""}),b.jsx("p",{children:"AI is speaking..."})]})]})}function Gq({onOpenFoodScanner:i,onOpenARScanner:e,onOpenBarcodeScanner:t,onOpenRepCounter:n}){return b.jsxs("div",{className:"scan-tab",children:[b.jsxs("div",{className:"scan-header",children:[b.jsx("h1",{children:"Scan Anything "}),b.jsx("p",{children:"I'll tell you everything about it"})]}),b.jsxs("div",{className:"scan-options",children:[b.jsxs("button",{className:"scan-option-card new-feature",onClick:()=>{t()},style:{border:"3px solid #11998e",transform:"scale(1.02)"},children:[b.jsx("span",{className:"scan-option-icon",children:""}),b.jsx("h3",{children:"Barcode Scanner "}),b.jsx("p",{children:"Scan product barcodes instantly"}),b.jsx("span",{className:"scan-badge",style:{background:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",fontSize:"16px",fontWeight:"bold"},children:"NEW!"})]}),b.jsxs("button",{className:"scan-option-card",onClick:i,children:[b.jsx("span",{className:"scan-option-icon",children:""}),b.jsx("h3",{children:"Food Scanner"}),b.jsx("p",{children:"See if it's safe for you"}),b.jsx("span",{className:"scan-badge",children:"AI Powered"})]}),b.jsxs("button",{className:"scan-option-card",onClick:e,children:[b.jsx("span",{className:"scan-option-icon",children:""}),b.jsx("h3",{children:"AR Scanner"}),b.jsx("p",{children:"See calories & nutrition in real-time"}),b.jsx("span",{className:"scan-badge",children:"Augmented Reality"})]}),b.jsxs("button",{className:"scan-option-card new-feature",onClick:()=>{n()},style:{border:"3px solid #ff6b6b",transform:"scale(1.02)"},children:[b.jsx("span",{className:"scan-option-icon",children:""}),b.jsx("h3",{children:"Rep Counter "}),b.jsx("p",{children:"AI-powered workout tracking"}),b.jsx("span",{className:"scan-badge",style:{background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)",fontSize:"16px",fontWeight:"bold"},children:"NEW!"})]})]}),b.jsxs("div",{className:"scan-features",children:[b.jsx("h3",{children:"What I can detect:"}),b.jsxs("div",{className:"feature-list",children:[b.jsx("div",{className:"feature-item",children:" Hidden allergens"}),b.jsx("div",{className:"feature-item",children:" Calories & macros"}),b.jsx("div",{className:"feature-item",children:" Ingredient analysis"}),b.jsx("div",{className:"feature-item",children:" Healthy alternatives"}),b.jsx("div",{className:"feature-item",children:" Product barcodes (NEW!)"}),b.jsx("div",{className:"feature-item",children:" Exercise reps (NEW!)"})]})]})]})}function Hq({onOpenBreathing:i,onOpenStressRelief:e,onOpenGuidedMeditation:t,onOpenGratitudeJournal:n}){return b.jsxs("div",{className:"zen-tab",children:[b.jsxs("div",{className:"zen-header",children:[b.jsx("h1",{children:"Zen Mode "}),b.jsx("p",{children:"Take a moment for yourself"})]}),b.jsxs("div",{className:"breathing-exercise",children:[b.jsx("div",{className:"breath-circle",children:b.jsx("p",{className:"breath-text",children:"Tap to start"})}),b.jsxs("button",{className:"breath-button",onClick:i,style:{position:"relative"},children:["Start Breathing Exercise",!window.subscriptionService?.hasAccess("breathing")&&b.jsx("span",{style:{position:"absolute",top:"10px",right:"10px",fontSize:"16px"},children:""})]})]}),b.jsxs("div",{className:"zen-activities",children:[b.jsx("h3",{children:"Mental Wellness Activities"}),b.jsxs("button",{className:"zen-card",onClick:t,style:{position:"relative"},children:[b.jsx("span",{className:"zen-icon",children:""}),b.jsxs("div",{children:[b.jsxs("h4",{children:["Guided Meditation ",!window.subscriptionService?.hasAccess("meditation")&&""]}),b.jsx("p",{children:"Powerful & energizing sessions"})]})]}),b.jsxs("button",{className:"zen-card",onClick:n,children:[b.jsx("span",{className:"zen-icon",children:""}),b.jsxs("div",{children:[b.jsx("h4",{children:"Gratitude Journal"}),b.jsx("p",{children:"Write what you're thankful for"})]})]}),b.jsxs("button",{className:"zen-card",onClick:e,style:{position:"relative"},children:[b.jsx("span",{className:"zen-icon",children:""}),b.jsxs("div",{children:[b.jsxs("h4",{children:["Stress Relief ",!window.subscriptionService?.hasAccess("breathing")&&""]}),b.jsx("p",{children:"Quick relaxation techniques"})]})]})]})]})}function Kq({user:i,stats:e,onOpenHealthAvatar:t,onOpenARScanner:n,onOpenEmergency:r,onOpenInsurance:s,onOpenDNA:l,onOpenBattles:u,onOpenMeals:h,onEditProfile:f,onOpenFullStats:x,onOpenNotifications:g,onOpenTheme:w,onLogout:A,checkFeatureAccess:B,onExportDailyStats:$,onExportWorkoutHistory:W,onExportFoodLog:q,onExportFullReport:ge,showDevButton:he,isDevMode:me,onOpenDevUnlock:Ce,onResetStepCounter:Ve,onDisableDevMode:pe}){const ee=i?.profile?.height?i.profile.height/100:null,J=ee&&i?.profile?.weight?(i.profile.weight/(ee*ee)).toFixed(1):i?.profile?.bmi||null;return b.jsxs("div",{className:"me-tab-grid",children:[b.jsxs("div",{className:"profile-compact",children:[b.jsx("div",{className:"profile-compact-avatar",children:i?.profile?.photo?b.jsx("img",{src:i.profile.photo,alt:"Profile"}):b.jsx("span",{children:i?.profile?.avatar||""})}),b.jsxs("div",{className:"profile-compact-info",children:[b.jsx("h2",{className:"profile-compact-name",children:i?.profile?.fullName||i?.profile?.name||"Wellness Warrior"}),b.jsxs("p",{className:"profile-compact-level",children:[" Level ",e.level,"   ",e.streak," Day Streak"]}),b.jsxs("div",{className:"profile-compact-stats",children:[i?.profile?.age&&b.jsxs("span",{className:"profile-stat-mini",children:[" ",i.profile.age,"y"]}),i?.profile?.height&&b.jsxs("span",{className:"profile-stat-mini",children:[" ",i.profile.height,"cm"]}),i?.profile?.weight&&b.jsxs("span",{className:"profile-stat-mini",children:[" ",i.profile.weight,"kg"]}),J&&b.jsxs("span",{className:"profile-stat-mini",style:{color:J<18.5?"#FFA500":J<25?"#44FF44":J<30?"#FFA500":"#FF4444"},children:["BMI ",J]})]})]}),b.jsx("button",{className:"edit-profile-mini-btn",onClick:f,children:" Edit"})]}),me&&b.jsxs("div",{className:"dev-mode-card",children:[b.jsx("div",{className:"dev-mode-title",children:" DEVELOPER MODE ACTIVE"}),b.jsx("div",{className:"dev-mode-subtitle",children:"All Premium Features Unlocked "}),b.jsx("button",{onClick:Ve,className:"dev-mode-btn reset",children:" Reset Step Counter"}),b.jsx("button",{onClick:pe,className:"dev-mode-btn disable",children:" Disable Developer Mode"})]}),b.jsxs("div",{className:"me-icon-grid",children:[b.jsxs("button",{className:"me-icon-btn",onClick:t,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Health Avatar"})]}),b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:n,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"AR Scanner"}),b.jsx("span",{className:"premium-tag",children:""})]}),b.jsxs("button",{className:"me-icon-btn",onClick:r,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Emergency"})]}),b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:()=>B("dnaAnalysis",l),children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"DNA Analysis"}),!ar.hasAccess("dnaAnalysis")&&b.jsx("span",{className:"premium-tag",children:""})]}),b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:()=>B("socialBattles",u),children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Battles"}),!ar.hasAccess("socialBattles")&&b.jsx("span",{className:"premium-tag",children:""})]}),b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:()=>B("mealAutomation",h),children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Meal Auto"}),!ar.hasAccess("mealAutomation")&&b.jsx("span",{className:"premium-tag",children:""})]}),b.jsxs("button",{className:"me-icon-btn",onClick:f,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Profile"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:x,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Full Stats"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:g,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Notifications"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:w,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Theme"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:$,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Daily PDF"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:W,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Workouts PDF"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:q,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Food PDF"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:ge,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Full Report"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:()=>i.onOpenDataRecovery(),children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Backup/Restore"})]}),b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:()=>B("appleHealthSync",i.onOpenAppleHealth),children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Apple Health"}),!ar.hasAccess("appleHealthSync")&&b.jsx("span",{className:"premium-tag",children:""})]}),b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:()=>B("wearableSync",i.onOpenWearables),children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Wearables"}),!ar.hasAccess("wearableSync")&&b.jsx("span",{className:"premium-tag",children:""})]}),he&&!me&&b.jsxs("button",{className:"me-icon-btn premium-feature",onClick:Ce,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Dev Mode"})]}),b.jsxs("button",{className:"me-icon-btn",onClick:A,children:[b.jsx("div",{className:"icon-circle",children:b.jsx("span",{children:""})}),b.jsx("span",{className:"icon-label",children:"Sign Out"})]})]}),b.jsxs("div",{className:"upgrade-cta-card",onClick:()=>i.onOpenStripePayment(),children:[b.jsx("div",{className:"upgrade-cta-icon",children:""}),b.jsxs("h3",{className:"upgrade-cta-title",children:["Upgrade to ",ar.getPlanBadge()===" FREE"?"Premium":"VIP"]}),b.jsx("p",{className:"upgrade-cta-text",children:"Join 50,000+ users unlocking DNA, Battles & AI!"}),b.jsx("button",{className:"upgrade-cta-btn",children:"See Plans "})]}),b.jsx("div",{style:{height:"120px",flexShrink:0}})]})}function Wq({user:i,stats:e,onClose:t}){const[n,r]=Te.useState([]),[s,l]=Te.useState(!1);Te.useEffect(()=>{(async()=>{try{console.log(" [FullStatsModal] Loading data from localStorage...");const Ve=JSON.parse(localStorage.getItem("foodLog")||"[]");console.log(" [FullStatsModal] localStorage foodLog:",Ve.length,"meals"),r(Ve)}catch{}l(!0)})()},[]);let u=[],h=[],f=[];console.log(" [FullStatsModal] Loading data sources..."),console.log(" [FullStatsModal] Live stats from parent:",{todaySteps:e?.todaySteps,waterCups:e?.waterCups,mealsLogged:e?.mealsLogged,streak:e?.streak,wellnessScore:e?.wellnessScore});try{const Ce=localStorage.getItem("stepHistory");u=JSON.parse(Ce||"[]"),console.log(" [FullStatsModal] stepHistory length:",u.length),console.log(" [FullStatsModal] Last 3 entries:",u.slice(-3))}catch{}try{const Ce=localStorage.getItem("workoutHistory");console.log(" [FullStatsModal] Raw workoutHistory:",Ce),h=JSON.parse(Ce||"[]"),console.log(" [FullStatsModal] Parsed workoutHistory length:",h.length),console.log(" [FullStatsModal] Workout entries:",h)}catch{}try{f=JSON.parse(localStorage.getItem("sleepLog")||"[]")}catch{}console.log(" [FullStatsModal] Calculating stats...");const x=Array.isArray(u)?u.reduce((Ce,Ve)=>Ce+(Number(Ve?.steps)||0),0):0,g=x+(e?.todaySteps||0);console.log(" [FullStatsModal] Historical:",x,"Today:",e?.todaySteps,"Total:",g);const w=u.length+1,A=w>0?Math.round(g/w):0,B=Array.isArray(n)?n.length:0,$=Array.isArray(h)?h.length:0,W=Array.isArray(f)?f.reduce((Ce,Ve)=>Ce+(Number(Ve?.hours)||0),0):0,q=f.length>0?(W/f.length).toFixed(1):0,ge=e?.streak||0,he=u.filter(Ce=>Ce?.date).length+1;console.log(" [FullStatsModal] FINAL STATS:",{totalSteps:g,avgSteps:A,totalFoodScans:B,totalWorkouts:$,totalSleepHours:W,avgSleepHours:q,activeDays:he,currentStreak:ge});const me={background:"linear-gradient(135deg, rgba(139, 95, 232, 0.2), rgba(139, 95, 232, 0.05))",border:"1px solid rgba(139, 95, 232, 0.3)",borderRadius:"15px",padding:"20px",textAlign:"center"};return b.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:b.jsxs("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflowY:"auto",position:"relative",color:"white"},children:[b.jsx("button",{onClick:t,style:{position:"absolute",top:"15px",right:"15px",background:"#8B5FE8",border:"none",color:"white",fontSize:"28px",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer",zIndex:1},children:""}),b.jsx("h2",{style:{fontSize:"28px",marginBottom:"5px",color:"white"},children:" Your Full Stats"}),b.jsx("p",{style:{fontSize:"14px",color:"#888",marginBottom:"25px"},children:"Complete health overview"}),b.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(139, 95, 232, 0.3), rgba(139, 95, 232, 0.1))",border:"2px solid rgba(139, 95, 232, 0.5)",borderRadius:"15px",padding:"20px",marginBottom:"20px"},children:[b.jsx("h3",{style:{fontSize:"18px",marginBottom:"15px",color:"white"},children:" Today's Progress"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:[b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"24px"},children:""}),b.jsx("p",{style:{color:"white",fontSize:"20px",margin:"5px 0"},children:(e?.todaySteps||0).toLocaleString()}),b.jsx("small",{style:{color:"#aaa",fontSize:"12px"},children:"Steps"})]}),b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"24px"},children:""}),b.jsxs("p",{style:{color:"white",fontSize:"20px",margin:"5px 0"},children:[e?.waterCups||0,"/8"]}),b.jsx("small",{style:{color:"#aaa",fontSize:"12px"},children:"Water"})]}),b.jsxs("div",{style:{textAlign:"center"},children:[b.jsx("div",{style:{fontSize:"24px"},children:""}),b.jsx("p",{style:{color:"white",fontSize:"20px",margin:"5px 0"},children:e?.mealsLogged||0}),b.jsx("small",{style:{color:"#aaa",fontSize:"12px"},children:"Meals"})]})]})]}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px",marginBottom:"30px"},children:[b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:g.toLocaleString()}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Total Steps"}),b.jsxs("small",{style:{color:"#888",fontSize:"12px"},children:["Avg: ",A.toLocaleString(),"/day"]})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:e?.wellnessScore||0}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Wellness Score"}),b.jsx("small",{style:{color:"#888",fontSize:"12px"},children:"Out of 100"})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:B}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Food Scans"}),b.jsx("small",{style:{color:"#888",fontSize:"12px"},children:"Meals logged"})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:$}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Workouts"}),b.jsx("small",{style:{color:"#888",fontSize:"12px"},children:"Total sessions"})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:e?.waterCups||0}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Water Today"}),b.jsx("small",{style:{color:"#888",fontSize:"12px"},children:"Goal: 8 cups"})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsxs("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:[q,"h"]}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Avg Sleep"}),b.jsxs("small",{style:{color:"#888",fontSize:"12px"},children:[f.length," nights"]})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsxs("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:["Level ",e?.level||1]}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Progress"}),b.jsxs("small",{style:{color:"#888",fontSize:"12px"},children:[e?.xp||0," XP"]})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:ge}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Day Streak"}),b.jsxs("small",{style:{color:"#888",fontSize:"12px"},children:[he," active days"]})]}),b.jsxs("div",{style:me,children:[b.jsx("div",{style:{fontSize:"32px",marginBottom:"10px"},children:""}),b.jsx("h3",{style:{color:"white",fontSize:"24px",margin:"5px 0"},children:he}),b.jsx("p",{style:{color:"#8B5FE8",margin:"5px 0",fontSize:"14px"},children:"Active Days"}),b.jsx("small",{style:{color:"#888",fontSize:"12px"},children:"Total logins"})]})]}),b.jsxs("div",{style:{background:"rgba(139, 95, 232, 0.1)",border:"1px solid rgba(139, 95, 232, 0.3)",borderRadius:"15px",padding:"20px",marginBottom:"20px"},children:[b.jsx("h3",{style:{fontSize:"18px",marginBottom:"15px",color:"white"},children:" 7-Day Step Activity"}),b.jsx("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",height:"120px",gap:"8px"},children:[0,1,2,3,4,5,6].map(Ce=>{const pe=(e?.weeklySteps?.[Ce]||{steps:0}).steps||0,ee=Math.max(pe/1e4*100,5);return b.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[b.jsx("small",{style:{color:"#8B5FE8",fontSize:"10px",marginBottom:"3px"},children:pe>0?(pe/1e3).toFixed(1)+"k":"0"}),b.jsx("div",{style:{width:"100%",height:`${ee}%`,background:pe>0?"linear-gradient(to top, #8B5FE8, #B794F6)":"rgba(139, 95, 232, 0.2)",borderRadius:"6px 6px 0 0",minHeight:"5px"}}),b.jsx("small",{style:{color:"#666",fontSize:"11px",marginTop:"5px"},children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][Ce]})]},Ce)})})]}),b.jsxs("div",{style:{background:"rgba(139, 95, 232, 0.1)",border:"1px solid rgba(139, 95, 232, 0.3)",borderRadius:"15px",padding:"20px"},children:[b.jsx("h3",{style:{fontSize:"18px",marginBottom:"10px",color:"white"},children:" Health Summary"}),b.jsxs("p",{style:{color:"#aaa",fontSize:"14px",marginBottom:"5px"},children:[" ",i?.name||i?.profile?.fullName||"Champion"]}),b.jsxs("p",{style:{color:"#aaa",fontSize:"14px",marginBottom:"5px"},children:[" Level ",e?.level||1," | ",e?.xp||0," XP"]}),b.jsxs("p",{style:{color:"#aaa",fontSize:"14px",marginBottom:"5px"},children:[" ",ge," day streak | ",he," active days"]}),b.jsxs("p",{style:{color:"#aaa",fontSize:"14px",marginBottom:"10px"},children:[" Wellness Score: ",e?.wellnessScore||0,"/100"]}),b.jsx("p",{style:{color:"#8B5FE8",fontSize:"14px",fontWeight:"bold"},children:"Keep crushing your goals! "})]})]})})}function qq({user:i,onClose:e}){const[t,n]=Te.useState(!0),[r,s]=Te.useState(!0),[l,u]=Te.useState(!0),[h,f]=Te.useState(!0),[x,g]=Te.useState(!0),[w,A]=Te.useState(!0),[B,$]=Te.useState(!1),[W,q]=Te.useState(!1);Te.useEffect(()=>{ge()},[]);const ge=async()=>{try{const{LocalNotifications:Ve}=await Vt(async()=>{const{LocalNotifications:ee}=await Promise.resolve().then(()=>C1);return{LocalNotifications:ee}},void 0),pe=await Ve.checkPermissions();$(pe.display==="granted")}catch(Ve){console.warn("Failed to check notification permission:",Ve)}},he=async()=>{try{const{LocalNotifications:Ve}=await Vt(async()=>{const{LocalNotifications:ee}=await Promise.resolve().then(()=>C1);return{LocalNotifications:ee}},void 0);(await Ve.requestPermissions()).display==="granted"?($(!0),alert(" Notification permission granted!")):alert(" Please enable notifications in your device settings.")}catch(Ve){console.error("Failed to request permission:",Ve),alert(" Failed to request notification permission")}},me=async()=>{if(!B){alert(" Please grant notification permission first");return}try{await Jx.testNotification("dailyReminders"),q(!0),setTimeout(()=>q(!1),3e3),alert(" Test notification sent! Check your notification bar in 2 seconds.")}catch(Ve){console.error("Failed to send test notification:",Ve),alert(" Failed to send test notification")}},Ce=async()=>{if(!B){alert(" Please grant notification permission first to enable notifications.");return}const Ve={notificationsEnabled:t,dailyReminders:r,goalAlerts:l,streakReminders:h,healthTips:x,emergencyAlerts:w};localStorage.setItem("notificationSettings",JSON.stringify(Ve)),await Jx.updateSettings(Ve);const pe=[];r&&pe.push("Daily Reminders (9 AM, 12 PM, 6 PM)"),l&&pe.push("Goal Alerts (Real-time)"),h&&pe.push("Streak Reminders (8 PM)"),x&&pe.push("Health Tips (10 AM, 3 PM, 7 PM)");const ee=pe.length>0?` Scheduled:

${pe.join(`
`)}`:" All notifications disabled";alert(ee),e()};return Te.useEffect(()=>{const Ve=localStorage.getItem("notificationSettings");if(Ve){const pe=JSON.parse(Ve);n(pe.notificationsEnabled??!0),s(pe.dailyReminders??!0),u(pe.goalAlerts??!0),f(pe.streakReminders??!0),g(pe.healthTips??!0),A(pe.emergencyAlerts??!0)}},[]),b.jsx("div",{className:"modal-overlay",onClick:e,children:b.jsxs("div",{className:"modal-content notifications-modal",onClick:Ve=>Ve.stopPropagation(),children:[b.jsx("button",{className:"modal-close",onClick:e,children:""}),b.jsxs("div",{className:"modal-header",children:[b.jsx("h2",{children:" Notification Settings"}),b.jsx("p",{children:"Manage how we keep you informed"}),!B&&b.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",border:"1px solid rgba(255, 165, 0, 0.3)",borderRadius:"8px",padding:"12px",marginTop:"10px",textAlign:"center"},children:[b.jsx("p",{style:{color:"#FFB84D",margin:"0 0 8px 0",fontSize:"14px"},children:" Notification permission required"}),b.jsx("button",{onClick:he,style:{background:"#FFB84D",color:"black",border:"none",borderRadius:"8px",padding:"8px 16px",fontWeight:"bold",cursor:"pointer"},children:"Enable Notifications"})]}),B&&b.jsxs("div",{style:{background:"rgba(68, 255, 68, 0.1)",border:"1px solid rgba(68, 255, 68, 0.3)",borderRadius:"8px",padding:"12px",marginTop:"10px",textAlign:"center"},children:[b.jsx("p",{style:{color:"#44FF44",margin:"0 0 8px 0",fontSize:"14px"},children:" Notifications enabled"}),b.jsx("button",{onClick:me,disabled:W,style:{background:W?"#666":"#44FF44",color:"black",border:"none",borderRadius:"8px",padding:"8px 16px",fontWeight:"bold",cursor:W?"not-allowed":"pointer",opacity:W?.6:1},children:W?" Sent!":" Send Test Notification"})]})]}),b.jsxs("div",{className:"notification-settings",children:[b.jsxs("div",{className:"setting-item",children:[b.jsxs("div",{className:"setting-info",children:[b.jsx("h3",{children:" Enable Notifications"}),b.jsx("p",{children:"Master switch for all notifications"})]}),b.jsxs("label",{className:"toggle",children:[b.jsx("input",{type:"checkbox",checked:t,onChange:Ve=>n(Ve.target.checked)}),b.jsx("span",{className:"toggle-slider"})]})]}),b.jsxs("div",{className:"setting-item",children:[b.jsxs("div",{className:"setting-info",children:[b.jsx("h3",{children:" Daily Reminders"}),b.jsx("p",{children:"Log your meals, steps, and water"})]}),b.jsxs("label",{className:"toggle",children:[b.jsx("input",{type:"checkbox",checked:r,onChange:Ve=>s(Ve.target.checked),disabled:!t}),b.jsx("span",{className:"toggle-slider"})]})]}),b.jsxs("div",{className:"setting-item",children:[b.jsxs("div",{className:"setting-info",children:[b.jsx("h3",{children:" Goal Alerts"}),b.jsx("p",{children:"Get notified when you hit your goals"})]}),b.jsxs("label",{className:"toggle",children:[b.jsx("input",{type:"checkbox",checked:l,onChange:Ve=>u(Ve.target.checked),disabled:!t}),b.jsx("span",{className:"toggle-slider"})]})]}),b.jsxs("div",{className:"setting-item",children:[b.jsxs("div",{className:"setting-info",children:[b.jsx("h3",{children:" Streak Reminders"}),b.jsx("p",{children:"Don't break your streak!"})]}),b.jsxs("label",{className:"toggle",children:[b.jsx("input",{type:"checkbox",checked:h,onChange:Ve=>f(Ve.target.checked),disabled:!t}),b.jsx("span",{className:"toggle-slider"})]})]}),b.jsxs("div",{className:"setting-item",children:[b.jsxs("div",{className:"setting-info",children:[b.jsx("h3",{children:" Health Tips"}),b.jsx("p",{children:"Personalized wellness advice"})]}),b.jsxs("label",{className:"toggle",children:[b.jsx("input",{type:"checkbox",checked:x,onChange:Ve=>g(Ve.target.checked),disabled:!t}),b.jsx("span",{className:"toggle-slider"})]})]}),b.jsxs("div",{className:"setting-item",children:[b.jsxs("div",{className:"setting-info",children:[b.jsx("h3",{children:" Emergency Alerts"}),b.jsx("p",{children:"Critical health notifications (Always On)"})]}),b.jsxs("label",{className:"toggle",children:[b.jsx("input",{type:"checkbox",checked:w,disabled:!0}),b.jsx("span",{className:"toggle-slider"})]})]})]}),b.jsxs("div",{className:"modal-actions",children:[b.jsx("button",{className:"secondary-button",onClick:e,children:"Cancel"}),b.jsx("button",{className:"primary-button",onClick:Ce,children:"Save Settings"})]})]})})}function Yq({onClose:i}){const[e,t]=Te.useState("dark"),[n,r]=Te.useState("#8B5FE8"),s=[{id:"dark",name:"Dark Mode",icon:"",colors:{bg:"#0F0F23",card:"#1A1A2E"}},{id:"light",name:"Light Mode",icon:"",colors:{bg:"#FFFFFF",card:"#F5F5F5"}},{id:"midnight",name:"Midnight",icon:"",colors:{bg:"#000000",card:"#1A1A1A"}},{id:"ocean",name:"Ocean",icon:"",colors:{bg:"#001F3F",card:"#003D5C"}}],l=[{name:"Purple",color:"#8B5FE8"},{name:"Blue",color:"#00C8FF"},{name:"Green",color:"#44FF44"},{name:"Pink",color:"#FF00FF"},{name:"Orange",color:"#FFB84D"},{name:"Red",color:"#FF6B35"}],u=()=>{const h={theme:e,accentColor:n};localStorage.setItem("themeSettings",JSON.stringify(h)),alert(" Theme saved! (Full theme customization coming soon)"),i()};return Te.useEffect(()=>{const h=localStorage.getItem("themeSettings");if(h){const f=JSON.parse(h);t(f.theme||"dark"),r(f.accentColor||"#8B5FE8")}},[]),b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content theme-modal",onClick:h=>h.stopPropagation(),children:[b.jsx("button",{className:"modal-close",onClick:i,children:""}),b.jsxs("div",{className:"modal-header",children:[b.jsx("h2",{children:" Customize Theme"}),b.jsx("p",{children:"Make the app your own"})]}),b.jsxs("div",{className:"theme-section",children:[b.jsx("h3",{children:"Theme Style"}),b.jsx("div",{className:"theme-grid",children:s.map(h=>b.jsxs("button",{className:`theme-card ${e===h.id?"selected":""}`,onClick:()=>t(h.id),style:{background:h.colors.bg,border:e===h.id?`2px solid ${n}`:"2px solid #333"},children:[b.jsx("span",{className:"theme-icon",style:{fontSize:"40px"},children:h.icon}),b.jsx("h4",{style:{color:h.id==="light"?"#000":"#fff"},children:h.name}),e===h.id&&b.jsx("span",{className:"selected-check",children:""})]},h.id))})]}),b.jsxs("div",{className:"theme-section",children:[b.jsx("h3",{children:"Accent Color"}),b.jsx("div",{className:"color-grid",children:l.map(h=>b.jsx("button",{className:`color-option ${n===h.color?"selected":""}`,onClick:()=>r(h.color),style:{background:h.color,border:n===h.color?"3px solid #fff":"3px solid transparent"},children:n===h.color&&b.jsx("span",{className:"color-check",children:""})},h.color))})]}),b.jsxs("div",{className:"theme-preview",children:[b.jsx("h3",{children:"Preview"}),b.jsxs("div",{className:"preview-card",style:{background:s.find(h=>h.id===e)?.colors.card},children:[b.jsx("div",{className:"preview-button",style:{background:n},children:"Button"}),b.jsx("div",{className:"preview-text",children:"Sample Text"}),b.jsx("div",{className:"preview-icon",style:{color:n},children:""})]})]}),b.jsxs("div",{className:"modal-actions",children:[b.jsx("button",{className:"secondary-button",onClick:i,children:"Cancel"}),b.jsx("button",{className:"primary-button",style:{background:n},onClick:u,children:"Apply Theme"})]})]})})}function Xq({activitiesPromise:i,onClose:e}){const[t,n]=Te.useState([]),[r,s]=Te.useState(!0),[l,u]=Te.useState("all");Te.useEffect(()=>{i.then(g=>{n(g),s(!1)})},[i]);const h=()=>l==="all"?t:t.filter(g=>g.type===l),f=()=>t.reduce((g,w)=>g+(w.calories||0),0),x=g=>t.filter(w=>w.type===g).length;return b.jsx("div",{className:"modal-overlay",onClick:e,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,padding:"20px"},children:b.jsxs("div",{className:"activity-pulse-modal",onClick:g=>g.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"25px",padding:"30px",maxWidth:"500px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(139, 95, 232, 0.3)"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px"},children:[b.jsxs("div",{children:[b.jsx("h2",{style:{color:"white",fontSize:"28px",margin:"0 0 5px 0"},children:" Activity Pulse"}),b.jsxs("p",{style:{color:"#888",fontSize:"14px",margin:0},children:[t.length," activities  ",f()," calories"]})]}),b.jsx("button",{onClick:e,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",fontSize:"28px",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),b.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"},children:[{id:"all",label:"All",icon:""},{id:"steps",label:"Steps",icon:""},{id:"workout",label:"Workouts",icon:""},{id:"meal",label:"Meals",icon:""},{id:"water",label:"Water",icon:""},{id:"meditation",label:"Zen",icon:""},{id:"sleep",label:"Sleep",icon:""}].map(g=>b.jsxs("button",{onClick:()=>u(g.id),style:{background:l===g.id?"rgba(139, 95, 232, 0.3)":"rgba(255, 255, 255, 0.05)",border:l===g.id?"2px solid #8B5FE8":"2px solid transparent",borderRadius:"20px",padding:"8px 16px",color:"white",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[b.jsx("span",{children:g.icon}),b.jsx("span",{children:g.label}),b.jsx("span",{style:{background:"rgba(255, 255, 255, 0.15)",borderRadius:"10px",padding:"2px 8px",fontSize:"11px",fontWeight:"bold"},children:g.id==="all"?t.length:x(g.id)})]},g.id))}),b.jsx("div",{className:"activity-timeline",style:{display:"flex",flexDirection:"column",gap:"12px"},children:h().length===0?b.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#666"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"10px"},children:""}),b.jsxs("p",{children:["No ",l!=="all"?l:""," activities yet today"]}),b.jsx("p",{style:{fontSize:"14px"},children:"Start moving to see your pulse!"})]}):h().map((g,w)=>b.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"15px",padding:"15px",display:"flex",alignItems:"center",gap:"15px",transition:"all 0.3s ease",cursor:"pointer"},onMouseEnter:A=>A.currentTarget.style.background="rgba(139, 95, 232, 0.15)",onMouseLeave:A=>A.currentTarget.style.background="rgba(255, 255, 255, 0.05)",children:[b.jsx("div",{style:{background:g.type==="steps"?"rgba(0, 200, 255, 0.2)":g.type==="workout"?"rgba(255, 68, 68, 0.2)":g.type==="meal"?"rgba(68, 255, 68, 0.2)":g.type==="water"?"rgba(0, 150, 255, 0.2)":g.type==="meditation"?"rgba(160, 82, 255, 0.2)":g.type==="sleep"?"rgba(255, 184, 77, 0.2)":"rgba(255, 255, 255, 0.1)",width:"50px",height:"50px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",flexShrink:0},children:g.icon}),b.jsxs("div",{style:{flex:1},children:[b.jsx("div",{style:{color:"white",fontSize:"16px",fontWeight:"bold",marginBottom:"4px"},children:g.text}),b.jsxs("div",{style:{color:"#888",fontSize:"13px"},children:[g.time,g.calories>0&&b.jsxs("span",{style:{marginLeft:"10px",color:"#FFB84D"},children:[" ",g.calories," cal"]})]})]}),b.jsx("div",{style:{background:g.type==="steps"?"linear-gradient(135deg, #00C8FF, #0088FF)":g.type==="workout"?"linear-gradient(135deg, #FF4444, #FF6B6B)":g.type==="meal"?"linear-gradient(135deg, #44FF44, #00FF88)":g.type==="water"?"linear-gradient(135deg, #0096FF, #00C8FF)":g.type==="meditation"?"linear-gradient(135deg, #A052FF, #C084FC)":g.type==="sleep"?"linear-gradient(135deg, #FFB84D, #FFA500)":"linear-gradient(135deg, #8B5FE8, #B794F6)",color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"bold",textTransform:"capitalize"},children:g.type})]},w))}),(()=>{const g=T1.getLevelInfo(),w=T1.data.achievements.length,A=g.level+1,B=g.progress,$=t.reduce((W,q)=>{let ge=0;return q.type==="steps"&&(ge=10),q.type==="workout"&&(ge=15),q.type==="meal"&&(ge=15),q.type==="water"&&(ge=5),q.type==="meditation"&&(ge=10),q.type==="sleep"&&(ge=10),W+ge},0);return b.jsxs("div",{style:{marginTop:"25px",padding:"25px",background:"linear-gradient(135deg, rgba(139, 95, 232, 0.2), rgba(160, 82, 255, 0.15))",borderRadius:"20px",border:"2px solid rgba(139, 95, 232, 0.4)",boxShadow:"0 10px 30px rgba(139, 95, 232, 0.2)"},children:[b.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[b.jsx("div",{style:{color:"#8B5FE8",fontSize:"14px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px",marginBottom:"10px"},children:" Today's XP Progress"}),b.jsxs("div",{style:{color:"white",fontSize:"48px",fontWeight:"bold",textShadow:"0 0 20px rgba(139, 95, 232, 0.5)"},children:["+",$," XP"]}),b.jsxs("div",{style:{color:"#888",fontSize:"13px",marginTop:"5px"},children:["Earned from ",t.length," ",t.length===1?"activity":"activities"]})]}),b.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"15px",padding:"20px",marginBottom:"15px"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[b.jsxs("div",{style:{color:"white",fontSize:"16px",fontWeight:"bold"},children:["Level ",g.level]}),b.jsxs("div",{style:{color:"#8B5FE8",fontSize:"16px",fontWeight:"bold"},children:["Level ",A]})]}),b.jsx("div",{style:{width:"100%",height:"12px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"10px",overflow:"hidden",position:"relative",marginBottom:"8px"},children:b.jsx("div",{style:{width:`${Math.min(B,100)}%`,height:"100%",background:"linear-gradient(90deg, #8B5FE8, #C084FC, #8B5FE8)",backgroundSize:"200% 100%",animation:"shimmer 2s infinite",borderRadius:"10px",transition:"width 0.5s ease"}})}),b.jsxs("div",{style:{color:"#888",fontSize:"13px",textAlign:"center"},children:[g.totalXP.toLocaleString()," / ",(g.totalXP+g.xpToNext).toLocaleString()," XP",b.jsxs("span",{style:{color:"#8B5FE8",marginLeft:"8px"},children:["(",g.xpToNext," XP to next level)"]})]})]}),b.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",padding:"15px",background:"rgba(255, 184, 77, 0.1)",borderRadius:"12px",border:"1px solid rgba(255, 184, 77, 0.3)"},children:[b.jsx("span",{style:{fontSize:"24px"},children:""}),b.jsxs("div",{children:[b.jsxs("div",{style:{color:"white",fontSize:"18px",fontWeight:"bold"},children:[w," Achievement",w!==1?"s":""]}),b.jsx("div",{style:{color:"#888",fontSize:"12px"},children:"Unlocked"})]})]})]})})(),t.length>0&&b.jsxs("div",{style:{marginTop:"25px",padding:"20px",background:"rgba(139, 95, 232, 0.1)",borderRadius:"15px",border:"2px solid rgba(139, 95, 232, 0.3)"},children:[b.jsx("div",{style:{color:"white",fontSize:"16px",fontWeight:"bold",marginBottom:"10px"},children:" Today's Impact"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},children:[b.jsxs("div",{children:[b.jsx("div",{style:{color:"#888",fontSize:"12px"},children:"Total Activities"}),b.jsx("div",{style:{color:"white",fontSize:"24px",fontWeight:"bold"},children:t.length})]}),b.jsxs("div",{children:[b.jsx("div",{style:{color:"#888",fontSize:"12px"},children:"Calories Burned"}),b.jsx("div",{style:{color:"#FFB84D",fontSize:"24px",fontWeight:"bold"},children:f()})]})]})]})]})})}function Jq({onClose:i}){const[e,t]=Te.useState(null),[n,r]=Te.useState(!1),[s,l]=Te.useState(!1);Te.useEffect(()=>{if(Od.isConnected())return r(!0),t(Od.getCurrentHeartRate()),Od.subscribe(x=>{t(x.bpm)})},[]);const u=async()=>{l(!0);try{const f=await Od.connectDevice();r(!0),alert(` Connected to ${f.deviceName}!`)}catch(f){alert(` Connection failed: ${f.message}`)}finally{l(!1)}},h=async()=>{await Od.disconnect(),r(!1),t(null)};return b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content",onClick:f=>f.stopPropagation(),style:{maxWidth:"400px"},children:[b.jsx("h2",{children:" Heart Rate Monitor"}),n?b.jsxs("div",{style:{textAlign:"center",padding:"30px"},children:[b.jsx("div",{style:{fontSize:"72px",fontWeight:"bold",color:"#FF4D6A",marginBottom:"10px"},children:e||"--"}),b.jsx("div",{style:{fontSize:"18px",color:"#888",marginBottom:"20px"},children:"BPM"}),b.jsx("div",{style:{fontSize:"24px",marginBottom:"30px"},children:""}),b.jsx("button",{onClick:h,style:{padding:"10px 25px",background:"#333",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Disconnect"})]}):b.jsxs("div",{style:{textAlign:"center",padding:"30px"},children:[b.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),b.jsx("p",{children:"Connect a Bluetooth heart rate monitor to track your heart rate in real-time."}),b.jsx("button",{onClick:u,disabled:s,style:{marginTop:"20px",padding:"12px 30px",background:"linear-gradient(135deg, #FF4D6A, #FF758C)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:s?"Connecting...":"Connect Device"})]}),b.jsx("button",{onClick:i,className:"close-button",children:""})]})})}function Qq({onClose:i}){const[e,t]=Te.useState(Xf.isTracking),[n,r]=Te.useState(null);Te.useEffect(()=>{if(e){const u=setInterval(()=>{r(Xf.getSleepStats())},5e3);return()=>clearInterval(u)}},[e]);const s=async()=>{await Xf.startTracking(),t(!0),alert(" Sleep tracking started! Leave your phone on the nightstand.")},l=async()=>{const u=await Xf.stopTracking();t(!1),u&&alert(` Slept for ${u.duration} hours! Quality: ${u.quality}/100`)};return b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content",onClick:u=>u.stopPropagation(),style:{maxWidth:"400px"},children:[b.jsx("h2",{children:" Sleep Tracking"}),e?b.jsxs("div",{style:{padding:"20px"},children:[b.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[b.jsx("div",{style:{fontSize:"48px",marginBottom:"10px"},children:""}),b.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold"},children:[n?.duration||"0.0","h"]}),b.jsx("div",{style:{color:"#888"},children:"Sleep Duration"})]}),n&&b.jsxs("div",{style:{marginBottom:"20px"},children:[b.jsxs("div",{style:{marginBottom:"15px"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[b.jsx("span",{children:"Deep Sleep"}),b.jsxs("span",{children:[n.phases.deep,"%"]})]}),b.jsx("div",{style:{background:"#333",height:"8px",borderRadius:"4px",overflow:"hidden"},children:b.jsx("div",{style:{background:"#A052FF",width:`${n.phases.deep}%`,height:"100%"}})})]}),b.jsxs("div",{style:{marginBottom:"15px"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[b.jsx("span",{children:"REM Sleep"}),b.jsxs("span",{children:[n.phases.rem,"%"]})]}),b.jsx("div",{style:{background:"#333",height:"8px",borderRadius:"4px",overflow:"hidden"},children:b.jsx("div",{style:{background:"#FF758C",width:`${n.phases.rem}%`,height:"100%"}})})]}),b.jsxs("div",{style:{marginBottom:"15px"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[b.jsx("span",{children:"Light Sleep"}),b.jsxs("span",{children:[n.phases.light,"%"]})]}),b.jsx("div",{style:{background:"#333",height:"8px",borderRadius:"4px",overflow:"hidden"},children:b.jsx("div",{style:{background:"#00C8FF",width:`${n.phases.light}%`,height:"100%"}})})]})]}),b.jsx("button",{onClick:l,style:{width:"100%",padding:"12px",background:"#FF4D6A",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Stop & Save"})]}):b.jsxs("div",{style:{textAlign:"center",padding:"30px"},children:[b.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),b.jsx("p",{children:"Track your sleep quality using your phone's motion sensors."}),b.jsx("button",{onClick:s,style:{marginTop:"20px",padding:"12px 30px",background:"linear-gradient(135deg, #A052FF, #C084FC)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Start Tracking"})]}),b.jsx("button",{onClick:i,className:"close-button",children:""})]})})}function Zq({onClose:i}){const[e,t]=Te.useState(S1.getTodayProgress()),n=r=>{const s=S1.addIntake(r);t(s),s.goalReached&&alert(" Daily water goal reached!")};return b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content",onClick:r=>r.stopPropagation(),style:{maxWidth:"400px"},children:[b.jsx("h2",{children:" Water Intake"}),b.jsxs("div",{style:{textAlign:"center",padding:"30px 20px"},children:[b.jsxs("div",{style:{fontSize:"48px",fontWeight:"bold",marginBottom:"10px"},children:[e.intake,"ml"]}),b.jsxs("div",{style:{color:"#888",marginBottom:"20px"},children:["of ",e.goal,"ml (",e.percentage,"%)"]}),b.jsx("div",{style:{background:"#333",height:"20px",borderRadius:"10px",overflow:"hidden",marginBottom:"30px"},children:b.jsx("div",{style:{background:"linear-gradient(90deg, #0096FF, #00C8FF)",width:`${Math.min(e.percentage,100)}%`,height:"100%",transition:"width 0.3s ease"}})}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},children:[b.jsxs("button",{onClick:()=>n(250),style:{padding:"20px",background:"linear-gradient(135deg, #0096FF, #00C8FF)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:[" Glass",b.jsx("br",{}),"(250ml)"]}),b.jsxs("button",{onClick:()=>n(500),style:{padding:"20px",background:"linear-gradient(135deg, #00C8FF, #00E5FF)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:[" Bottle",b.jsx("br",{}),"(500ml)"]}),b.jsxs("button",{onClick:()=>n(1e3),style:{padding:"20px",background:"linear-gradient(135deg, #00E5FF, #00FFD1)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:[" Large",b.jsx("br",{}),"(1000ml)"]}),b.jsxs("button",{onClick:()=>n(200),style:{padding:"20px",background:"linear-gradient(135deg, #0096FF, #00A8FF)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:[" Cup",b.jsx("br",{}),"(200ml)"]})]})]}),b.jsx("button",{onClick:i,className:"close-button",children:""})]})})}function eY({onClose:i}){const[e,t]=Te.useState("select"),[n,r]=Te.useState(null),[s]=Te.useState("female"),[l,u]=Te.useState(5),[h,f]=Te.useState(null),[x,g]=Te.useState(!1),w=Ag.getPatterns(),A=()=>{t("active"),g(!0),Ag.setVoice(s),Ag.startExercise(n,l,$=>{f($)},($,W)=>{},$=>{g(!1),t("complete")})},B=()=>{Ag.stopExercise(),g(!1),t("select"),f(null)};if(e==="select")return b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content",onClick:$=>$.stopPropagation(),style:{maxWidth:"500px"},children:[b.jsx("h2",{children:" Choose Breathing Pattern"}),b.jsx("div",{style:{display:"grid",gap:"15px",marginTop:"20px"},children:w.map($=>b.jsxs("button",{onClick:()=>{r($.id),t("settings")},style:{padding:"20px",background:"#1a1a1a",border:"2px solid #333",borderRadius:"15px",textAlign:"left",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:W=>W.currentTarget.style.borderColor="#8B5FE8",onMouseLeave:W=>W.currentTarget.style.borderColor="#333",children:[b.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"10px"},children:[b.jsx("span",{style:{fontSize:"32px"},children:$.icon}),b.jsxs("div",{style:{flex:1},children:[b.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"white",marginBottom:"5px"},children:$.name}),b.jsx("div",{style:{fontSize:"14px",color:"#888"},children:$.description})]})]}),b.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:$.benefits.map((W,q)=>b.jsx("span",{style:{background:"#8B5FE8",padding:"4px 10px",borderRadius:"12px",fontSize:"12px",color:"white"},children:W},q))})]},$.id))}),b.jsx("button",{onClick:i,style:{marginTop:"20px",width:"100%",padding:"12px",background:"#333",border:"none",borderRadius:"10px",color:"white",fontSize:"16px",cursor:"pointer"},children:"Cancel"})]})});if(e==="settings")return b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content",onClick:$=>$.stopPropagation(),style:{maxWidth:"450px"},children:[b.jsx("h2",{children:" Exercise Settings"}),b.jsxs("div",{style:{marginTop:"30px"},children:[b.jsxs("div",{style:{marginBottom:"30px"},children:[b.jsx("label",{style:{display:"block",fontSize:"16px",fontWeight:"bold",color:"white",marginBottom:"15px"},children:" Duration"}),b.jsx("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[1,3,5,10,15].map($=>b.jsxs("button",{onClick:()=>u($),style:{padding:"12px 20px",background:l===$?"linear-gradient(135deg, #8B5FE8, #B794F6)":"#333",border:l===$?"2px solid #B794F6":"1px solid #555",borderRadius:"12px",color:"white",fontSize:"15px",cursor:"pointer",flex:"1",minWidth:"60px"},children:[$," min"]},$))})]}),b.jsx("button",{onClick:A,style:{width:"100%",padding:"16px",background:"linear-gradient(135deg, #44FF44, #00FF88)",border:"none",borderRadius:"12px",color:"white",fontSize:"18px",fontWeight:"bold",cursor:"pointer",marginBottom:"10px",boxShadow:"0 4px 20px rgba(68, 255, 68, 0.4)"},children:" Begin Exercise"}),b.jsx("button",{onClick:()=>t("select"),style:{width:"100%",padding:"12px",background:"#333",border:"none",borderRadius:"10px",color:"white",fontSize:"16px",cursor:"pointer"},children:" Back"})]})]})});if(e==="active"){const $=h?h.cycle/h.totalCycles*100:0;return b.jsx("div",{className:"modal-overlay",style:{background:"rgba(0, 0, 0, 0.95)"},children:b.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"},children:[b.jsx("div",{style:{position:"absolute",top:"40px",color:"white",fontSize:"16px",opacity:.7},children:h&&`${h.cycle} / ${h.totalCycles} cycles`}),b.jsx("div",{style:{width:"min(300px, 70vw)",height:"min(300px, 70vw)",borderRadius:"50%",background:"linear-gradient(135deg, #8B5FE8, #00C8FF)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"40px",transform:h?.phase==="inhale"?"scale(1.3)":h?.phase==="exhale"?"scale(0.8)":"scale(1)",transition:"transform 1s ease-in-out",boxShadow:"0 0 60px rgba(139, 95, 232, 0.6)"},children:b.jsx("div",{style:{fontSize:"clamp(24px, 6vw, 32px)",fontWeight:"bold",color:"white",textAlign:"center"},children:h?.text||"Prepare..."})}),b.jsx("div",{style:{width:"min(300px, 80%)",height:"8px",background:"#333",borderRadius:"10px",overflow:"hidden",marginBottom:"40px"},children:b.jsx("div",{style:{width:`${$}%`,height:"100%",background:"linear-gradient(90deg, #44FF44, #00FF88)",transition:"width 1s ease"}})}),b.jsx("button",{onClick:B,style:{padding:"15px 40px",background:"rgba(255, 68, 68, 0.2)",border:"2px solid #FF4444",borderRadius:"25px",color:"#FF4444",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:" Stop Exercise"})]})})}if(e==="complete"){const $=Ag.getStats();return b.jsx("div",{className:"modal-overlay",onClick:i,children:b.jsxs("div",{className:"modal-content",onClick:W=>W.stopPropagation(),style:{maxWidth:"400px",textAlign:"center"},children:[b.jsx("h2",{style:{fontSize:"48px",margin:"20px 0"},children:""}),b.jsx("h2",{children:"Exercise Complete!"}),b.jsx("p",{style:{fontSize:"16px",color:"#888",margin:"20px 0"},children:"Well done! You've completed your breathing exercise."}),b.jsxs("div",{style:{background:"#1a1a1a",padding:"20px",borderRadius:"15px",marginTop:"20px"},children:[b.jsx("div",{style:{fontSize:"14px",color:"#888",marginBottom:"15px"},children:"Your Stats"}),b.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[b.jsxs("div",{children:[b.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"white"},children:$.totalSessions}),b.jsx("div",{style:{fontSize:"12px",color:"#888"},children:"Total Sessions"})]}),b.jsxs("div",{children:[b.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"white"},children:$.totalMinutes}),b.jsx("div",{style:{fontSize:"12px",color:"#888"},children:"Minutes"})]}),b.jsxs("div",{children:[b.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#44FF44"},children:$.streak}),b.jsx("div",{style:{fontSize:"12px",color:"#888"},children:"Day Streak"})]}),b.jsxs("div",{children:[b.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#8B5FE8"},children:$.totalCycles}),b.jsx("div",{style:{fontSize:"12px",color:"#888"},children:"Total Cycles"})]})]})]}),b.jsx("button",{onClick:i,style:{marginTop:"30px",width:"100%",padding:"15px",background:"linear-gradient(135deg, #8B5FE8, #B794F6)",border:"none",borderRadius:"12px",color:"white",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},children:"Close"})]})})}return null}function tY({onClose:i}){const[e,t]=Te.useState(null),[n,r]=Te.useState(!1),[s,l]=Te.useState(0),u={pmr:{name:"Progressive Muscle Relaxation",icon:"",duration:"10-15 min",benefits:["Reduces physical tension","Improves sleep","Decreases anxiety"],when:"When you feel physically tense or before sleep",steps:["Find a comfortable position, sitting or lying down.","Take 3 deep breaths to center yourself.","Tense your right fist as tightly as you can for 5 seconds.","Release and feel the tension flowing out. Notice the difference.","Tense your right bicep for 5 seconds, then release.","Repeat with your left arm: fist, then bicep.","Raise your shoulders to your ears, hold 5 seconds, release.","Scrunch your face muscles tightly, hold, then release.","Press your tongue to the roof of your mouth, hold, release.","Arch your back gently, hold 5 seconds, release.","Tighten your stomach muscles, hold, release.","Squeeze your buttocks together, hold, release.","Tense your right thigh, hold, release. Then left thigh.","Point your right toes away from you, hold, release. Repeat left.","Curl your toes tightly, hold, release.","Take 3 deep breaths and scan your body for any remaining tension.","Rest for a moment and enjoy the feeling of complete relaxation."],audioScript:"Welcome to Progressive Muscle Relaxation. Find a comfortable position and close your eyes. We will tense and release each muscle group to help you deeply relax."},breathing478:{name:"4-7-8 Breathing",icon:"",duration:"5 min",benefits:["Calms nervous system","Reduces stress instantly","Helps with sleep"],when:"When feeling anxious or unable to sleep",steps:["Sit comfortably with your back straight.","Place the tip of your tongue behind your upper front teeth.","Exhale completely through your mouth, making a whoosh sound.","Close your mouth and inhale quietly through your nose for 4 counts.","Hold your breath for 7 counts.","Exhale completely through your mouth for 8 counts, making a whoosh sound.","This completes one breath cycle.","Repeat for 4 complete cycles (about 1 minute).","Breathe normally and notice how calm you feel.","You can repeat this 3-4 times throughout the day."],audioScript:"Four seven eight breathing. This ancient technique activates your relaxation response. Let us begin."},bodyscan:{name:"Body Scan Meditation",icon:"",duration:"10 min",benefits:["Releases unconscious tension","Improves body awareness","Promotes deep relaxation"],when:"Anytime you need to reset and reconnect with your body",steps:["Lie down or sit comfortably. Close your eyes.","Take 3 deep breaths, letting go of tension with each exhale.","Bring awareness to the top of your head. Notice any sensations.","Slowly move attention to your forehead. Release any tension.","Notice your eyes, cheeks, jaw. Let them soften.","Move to your neck and shoulders. Feel them relax and drop.","Scan down your right arm to your fingertips. Feel the weight.","Repeat with your left arm.","Bring awareness to your chest. Feel it rise and fall with your breath.","Notice your stomach and lower back. Let them soften.","Scan your hips and pelvis. Release any holding.","Move down your right leg to your toes. Notice temperature and sensation.","Repeat with your left leg.","Take a moment to feel your whole body at once.","Notice the support beneath you.","Take 3 deep breaths and slowly open your eyes when ready."],audioScript:"Body scan meditation. We will journey through your body, releasing tension and finding peace."},autogenic:{name:"Autogenic Training",icon:"",duration:"8 min",benefits:["Self-hypnosis for deep calm","Lowers blood pressure","Reduces stress hormones"],when:"For deep relaxation or before important events",steps:["Lie down comfortably. Close your eyes.","Take 3 deep, calming breaths.",'Silently repeat: "My right arm is heavy." Feel the weight.','Repeat: "My left arm is heavy."','Repeat: "Both arms are heavy."','Now say: "My right arm is warm." Feel warmth spreading.','Repeat: "My left arm is warm."','Say: "My heartbeat is calm and regular." Listen to your heart.','Say: "My breathing is calm and effortless." Notice your breath.','Say: "My stomach is soft and warm." Feel warmth in your belly.','Say: "My forehead is cool and clear." Feel a cooling sensation.',"Rest in this state of deep relaxation for 2-3 minutes.","To finish, take a deep breath, stretch gently, and open your eyes."],audioScript:"Autogenic training. Through self-suggestion, we will guide your body into deep relaxation."},grounding:{name:"5-4-3-2-1 Grounding",icon:"",duration:"3-5 min",benefits:["Stops panic attacks","Grounds you in the present","Reduces anxiety quickly"],when:"During anxiety, panic, or when feeling overwhelmed",steps:["Pause and take a deep breath.","Look around and name 5 things you can SEE.","Really look at them - colors, shapes, details.","Now notice 4 things you can TOUCH or FEEL.","The texture of your clothes, the chair beneath you, the air on your skin.","Listen carefully for 3 things you can HEAR.","Distant sounds, nearby sounds, subtle sounds.","Identify 2 things you can SMELL.","If you can not smell anything, think of 2 favorite scents.","Finally, notice 1 thing you can TASTE.","Or think of your favorite flavor.","Take another deep breath.","Notice how you feel more present and grounded."],audioScript:"Five four three two one grounding. This technique brings you back to the present moment when anxiety tries to pull you away."},mindful:{name:"Mindful Breathing",icon:"",duration:"5 min",benefits:["Calms the mind","Reduces rumination","Increases focus"],when:"Anytime you need mental clarity or calm",steps:["Sit comfortably with your spine straight.","Close your eyes or lower your gaze.","Bring attention to your natural breath.","Notice the sensation of air entering your nostrils.","Feel your chest and belly rise with each inhale.","Notice the natural pause at the top of the inhale.","Feel the air leaving as you exhale.","Notice your belly and chest falling.","When your mind wanders (it will), gently bring it back to your breath.","Count your breaths if it helps: Inhale one, exhale one. Inhale two, exhale two.","Continue for 5 minutes.","Slowly open your eyes and notice how you feel."],audioScript:"Mindful breathing meditation. Simply observe your breath without trying to change it."},visualization:{name:"Safe Place Visualization",icon:"",duration:"10 min",benefits:["Creates instant calm","Reduces stress hormones","Provides mental escape"],when:"When overwhelmed or needing mental peace",steps:["Close your eyes and take 3 deep breaths.","Imagine a place where you feel completely safe and calm.","It could be a beach, forest, mountain, or imaginary place.","See it clearly: What colors do you see?","What time of day is it? What is the light like?","What sounds do you hear? Birds, waves, wind?","What do you smell? Ocean air, pine trees, flowers?","What do you feel on your skin? Warmth, breeze, softness?","Notice how your body feels in this safe place.","Stay here as long as you need.","Know you can return to this place anytime.","When ready, take a deep breath and slowly open your eyes.","Bring that feeling of calm with you."],audioScript:"Safe place visualization. We will journey to a place of complete peace and safety that exists within your imagination."}},h=async()=>{if(!e)return;r(!0),l(0);const g=u[e];await $c.speak(g.audioScript);for(let w=0;w<g.steps.length;w++)l(w),await $c.speak(g.steps[w]),await new Promise(A=>setTimeout(A,1e3));await $c.speak("You have completed this relaxation technique. Take a moment to notice how you feel."),r(!1),l(0)},f=()=>{$c.stop(),r(!1),l(0)};if(!e)return b.jsx("div",{className:"modal-overlay",onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,padding:"20px"},children:b.jsxs("div",{onClick:g=>g.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"25px",padding:"30px",maxWidth:"500px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(139, 95, 232, 0.3)"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[b.jsx("h2",{style:{color:"white",fontSize:"28px",margin:0},children:" Stress Relief"}),b.jsx("button",{onClick:i,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",fontSize:"28px",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer"},children:""})]}),b.jsx("p",{style:{color:"#888",marginBottom:"25px",fontSize:"14px"},children:"Choose a scientifically-proven relaxation technique. Each includes audio guidance and written instructions."}),b.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:Object.entries(u).map(([g,w])=>b.jsx("button",{onClick:()=>t(g),style:{background:"rgba(255, 255, 255, 0.05)",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"15px",padding:"20px",cursor:"pointer",textAlign:"left",transition:"all 0.3s ease"},onMouseEnter:A=>{A.currentTarget.style.background="rgba(139, 95, 232, 0.15)",A.currentTarget.style.borderColor="#8B5FE8"},onMouseLeave:A=>{A.currentTarget.style.background="rgba(255, 255, 255, 0.05)",A.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)"},children:b.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px"},children:[b.jsx("span",{style:{fontSize:"36px"},children:w.icon}),b.jsxs("div",{style:{flex:1},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[b.jsx("h3",{style:{color:"white",fontSize:"18px",margin:0},children:w.name}),b.jsx("span",{style:{color:"#8B5FE8",fontSize:"12px",fontWeight:"bold"},children:w.duration})]}),b.jsx("p",{style:{color:"#888",fontSize:"13px",margin:"0 0 10px 0"},children:w.when}),b.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:w.benefits.map((A,B)=>b.jsx("span",{style:{background:"rgba(139, 95, 232, 0.2)",color:"#C084FC",fontSize:"11px",padding:"4px 8px",borderRadius:"8px"},children:A},B))})]})]})},g))})]})});const x=u[e];return b.jsx("div",{className:"modal-overlay",onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,padding:"20px"},children:b.jsxs("div",{onClick:g=>g.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"25px",padding:"30px",maxWidth:"500px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(139, 95, 232, 0.3)"},children:[b.jsx("button",{onClick:()=>t(null),style:{background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",fontSize:"14px",padding:"8px 16px",borderRadius:"20px",cursor:"pointer",marginBottom:"20px"},children:" Back"}),b.jsxs("div",{style:{textAlign:"center",marginBottom:"25px"},children:[b.jsx("span",{style:{fontSize:"60px"},children:x.icon}),b.jsx("h2",{style:{color:"white",fontSize:"24px",margin:"10px 0"},children:x.name}),b.jsx("p",{style:{color:"#8B5FE8",fontSize:"14px",fontWeight:"bold"},children:x.duration})]}),b.jsxs("div",{style:{marginBottom:"25px"},children:[b.jsx("h4",{style:{color:"white",fontSize:"16px",marginBottom:"10px"},children:"Benefits:"}),x.benefits.map((g,w)=>b.jsxs("div",{style:{color:"#888",fontSize:"14px",marginBottom:"5px",paddingLeft:"10px"},children:[" ",g]},w))]}),n?b.jsx("button",{onClick:f,style:{width:"100%",padding:"18px",background:"linear-gradient(135deg, #FF4444, #FF6B6B)",border:"none",borderRadius:"15px",color:"white",fontSize:"18px",fontWeight:"bold",cursor:"pointer",marginBottom:"20px"},children:" Stop"}):b.jsx("button",{onClick:h,style:{width:"100%",padding:"18px",background:"linear-gradient(135deg, #8B5FE8, #B794F6)",border:"none",borderRadius:"15px",color:"white",fontSize:"18px",fontWeight:"bold",cursor:"pointer",marginBottom:"20px",boxShadow:"0 5px 20px rgba(139, 95, 232, 0.4)"},children:" Start Audio Guide"}),b.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"15px",padding:"20px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[b.jsx("h4",{style:{color:"white",fontSize:"16px",marginBottom:"15px"},children:" Step-by-Step Instructions:"}),x.steps.map((g,w)=>b.jsxs("div",{style:{color:n&&w===s?"#FFB84D":w<s?"#888":"white",fontSize:"14px",marginBottom:"12px",paddingLeft:"25px",position:"relative",transition:"color 0.3s ease"},children:[b.jsxs("span",{style:{position:"absolute",left:0,color:n&&w===s?"#FFB84D":"#8B5FE8",fontWeight:"bold"},children:[w+1,"."]}),g]},w))]}),b.jsx("button",{onClick:i,style:{width:"100%",padding:"15px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",color:"white",fontSize:"16px",cursor:"pointer",marginTop:"20px"},children:"Close"})]})})}function nY({onClose:i}){const[e,t]=Te.useState(null),[n,r]=Te.useState(!1),[s,l]=Te.useState(0),u={morning:{name:"Morning Energy Activation",icon:"",duration:"10 min",benefits:["Energizes your day","Boosts motivation","Clears mental fog"],when:"First thing in the morning",steps:["Sit comfortably with your spine straight. Feel powerful and alert.","Take a deep breath in through your nose, filling your lungs completely.","Exhale fully, releasing any sleepiness or doubt.","Visualize golden sunlight pouring down from above.","See it entering through the top of your head, filling your entire body with energy.","Feel this warm, powerful light awakening every cell.","Say to yourself: I am fully awake. I am powerful. I am ready.","Breathe in confidence. Breathe out hesitation.","Visualize your day ahead going perfectly.","See yourself handling challenges with ease and grace.","Feel the energy building in your core, like a fire growing stronger.","Stand up slowly, feeling tall, strong, and unstoppable.","Take one final deep breath and smile.","You are ready to conquer this day."],audioScript:"Morning energy activation. Rise like the sun and feel your power awaken. Let us begin."},innerPower:{name:"Inner Power Meditation",icon:"",duration:"12 min",benefits:["Unlocks inner strength","Builds resilience","Increases self-confidence"],when:"When you need to feel strong",steps:["Sit in a powerful posture. Shoulders back, head high.","Close your eyes and take three powerful breaths.","Imagine a diamond at the center of your chest.","This diamond represents your unbreakable inner strength.","With each breath, the diamond glows brighter.","Feel its energy radiating through your entire body.","Remember a time when you were strong, when you overcame something difficult.","Feel that strength now, in this moment.","Say to yourself: I am strong. I am capable. I am unstoppable.","Visualize challenges before you crumbling like dust.","Nothing can break you. You are solid as diamond.","Feel this power in your bones, in your blood.","Let it fill every cell until you vibrate with strength.","Open your eyes. You are power itself."],audioScript:"Inner power meditation. Deep within you lies unbreakable strength. We will awaken it now."},confidence:{name:"Confidence Boost",icon:"",duration:"8 min",benefits:["Builds unshakeable confidence","Eliminates self-doubt","Radiates charisma"],when:"Before important events or presentations",steps:["Stand tall with your feet shoulder-width apart.","Place your hands on your hips in a power pose.","Breathe deeply and feel your presence expanding.","You are not small. You are magnificent.","Say out loud: I am confident. I am worthy. I am enough.","Visualize yourself succeeding brilliantly at your goal.","See people responding positively to you.","Feel what it feels like to be completely confident.","Your voice is strong. Your presence commands respect.","Doubt has no place here. Only certainty.","You were born for this moment.","Breathe in power. Breathe out fear.","Smile confidently. You already know you will succeed.","Now go and show the world who you are."],audioScript:"Confidence boost. You are about to remember who you truly are. Powerful. Confident. Unstoppable."},quickEnergy:{name:"Quick Energy Reset",icon:"",duration:"5 min",benefits:["Instant energy surge","Clears mental fatigue","Sharpens focus"],when:"Afternoon slump or when tired",steps:["Stand up and shake out your body vigorously for 10 seconds.","Take a huge breath in and hold it for 5 seconds.","Exhale forcefully through your mouth with a HA sound.","Repeat this power breath 3 times.","Jump in place 10 times, feeling energy surge with each jump.","Rub your palms together rapidly until they are hot.","Place your warm palms over your closed eyes.","Feel energy transferring from your hands to your brain.","Tap your chest firmly with your fist, like a drum.","Say loudly: I am awake! I am alive! I am energized!","Do 10 arm circles forward, then 10 backward.","Take one final deep breath and feel completely refreshed.","You are recharged and ready."],audioScript:"Quick energy reset. In just five minutes, you will feel completely recharged. Let us activate your energy now."},warrior:{name:"Warrior Mindset",icon:"",duration:"10 min",benefits:["Builds mental toughness","Conquers fear","Prepares for challenges"],when:"Before facing difficult situations",steps:["Stand in warrior pose: feet wide, arms extended.","Feel your connection to the ground beneath you.","You are immovable. You are a warrior.","Breathe like a warrior: strong, powerful breaths.","Visualize yourself as a lion, king of the jungle.","No challenge is too great. No obstacle too high.","Remember: warriors are not born, they are forged.","Every challenge you have faced has made you stronger.","You have survived 100% of your worst days.","Today will be no different. You will prevail.","Say: I am a warrior. I face fear with courage.","Feel strength flowing through your veins.","Your spirit is unbreakable. Your will is iron.","Open your eyes. You are ready for battle."],audioScript:"Warrior mindset meditation. The warrior within you is awakening. Feel your courage rising."},chakra:{name:"Chakra Energy Activation",icon:"",duration:"15 min",benefits:["Activates all energy centers","Balances life force","Awakens kundalini"],when:"For deep energy work",steps:["Sit comfortably with your spine perfectly straight.","Close your eyes and breathe naturally.","Bring awareness to the base of your spine. See a red glowing light.","As you breathe, this red light grows brighter. Root chakra activated.","Move to your lower belly. See an orange light glowing. Sacral chakra awakening.","Feel creativity and passion flowing through you.","Move to your solar plexus. A yellow sun burns bright. Power chakra activated.","Feel confidence and personal power radiating.","Move to your heart center. A green light expands. Heart chakra opening.","Feel love and compassion flowing infinitely.","Move to your throat. A blue light glows. Throat chakra activated.","Your voice carries truth and power.","Move to your third eye, between your brows. Indigo light shines. Intuition awakens.","Move to the crown of your head. Violet light explodes outward. Connection to universe.","Feel all seven chakras spinning and glowing in harmony.","You are pure energy. You are infinite."],audioScript:"Chakra energy activation. We will awaken each energy center from root to crown. Feel your power multiply."},affirmation:{name:"Positive Affirmation Power",icon:"",duration:"8 min",benefits:["Reprograms subconscious","Builds positive beliefs","Manifests success"],when:"Daily practice for transformation",steps:["Sit comfortably and place your hand over your heart.","Take a deep breath and feel your heartbeat.","Say each affirmation with total conviction.","I am powerful beyond measure.","I am worthy of all good things.","I am capable of achieving anything I set my mind to.","I radiate confidence and positive energy.","Opportunities flow to me effortlessly.","I am healthy, wealthy, and wise.","I am loved, supported, and appreciated.","I trust myself completely.","I am exactly where I need to be.","Every day I am becoming better and stronger.","I am grateful for my incredible life.","I am unstoppable.","Feel these truths settling into your bones.","They are not wishes. They are facts.","You are all of these things right now."],audioScript:"Positive affirmation meditation. Words have power. These affirmations will reprogram your mind for success."},mountain:{name:"Mountain Strength",icon:"",duration:"10 min",benefits:["Unshakeable stability","Emotional resilience","Grounded power"],when:"When feeling unstable or anxious",steps:["Sit in a solid, grounded position.","Feel the weight of your body pressing down.","You are not fragile. You are a mountain.","Visualize yourself as a massive mountain peak.","Your base is deep in the earth, immovable.","Storms come. Winds blow. You do not move.","Rain falls. Snow covers you. You remain.","Centuries pass. You stand eternal.","Feel this mountain strength in your body.","Nothing can shake you. Nothing can move you.","Emotions are like weather passing over the mountain.","They come. They go. The mountain remains.","You are solid. You are stable. You are strong.","Breathe with the patience of mountains.","You have all the time in the world.","You are unshakeable."],audioScript:"Mountain strength visualization. You are about to become as solid and unshakeable as an ancient mountain."}},h=async()=>{if(!e)return;r(!0),l(0);const g=u[e];await $c.speak(g.audioScript),await new Promise(w=>setTimeout(w,1500));for(let w=0;w<g.steps.length;w++)l(w),await $c.speak(g.steps[w]),await new Promise(A=>setTimeout(A,2e3));await $c.speak("You have completed this powerful meditation. Notice how strong and energized you feel."),r(!1),l(0)},f=()=>{$c.stop(),r(!1),l(0)};if(!e)return b.jsx("div",{className:"modal-overlay",onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,padding:"20px"},children:b.jsxs("div",{onClick:g=>g.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"25px",padding:"30px",maxWidth:"500px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(255, 184, 77, 0.3)"},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[b.jsx("h2",{style:{color:"white",fontSize:"28px",margin:0},children:" Guided Meditation"}),b.jsx("button",{onClick:i,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",fontSize:"28px",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer"},children:""})]}),b.jsx("p",{style:{color:"#888",marginBottom:"25px",fontSize:"14px"},children:"Choose an energizing meditation to feel powerful, confident, and unstoppable. Each includes audio guidance."}),b.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:Object.entries(u).map(([g,w])=>b.jsx("button",{onClick:()=>t(g),style:{background:"rgba(255, 255, 255, 0.05)",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"15px",padding:"20px",cursor:"pointer",textAlign:"left",transition:"all 0.3s ease"},onMouseEnter:A=>{A.currentTarget.style.background="rgba(255, 184, 77, 0.15)",A.currentTarget.style.borderColor="#FFB84D"},onMouseLeave:A=>{A.currentTarget.style.background="rgba(255, 255, 255, 0.05)",A.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)"},children:b.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px"},children:[b.jsx("span",{style:{fontSize:"36px"},children:w.icon}),b.jsxs("div",{style:{flex:1},children:[b.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[b.jsx("h3",{style:{color:"white",fontSize:"18px",margin:0},children:w.name}),b.jsx("span",{style:{color:"#FFB84D",fontSize:"12px",fontWeight:"bold"},children:w.duration})]}),b.jsx("p",{style:{color:"#888",fontSize:"13px",margin:"0 0 10px 0"},children:w.when}),b.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:w.benefits.map((A,B)=>b.jsx("span",{style:{background:"rgba(255, 184, 77, 0.2)",color:"#FFD700",fontSize:"11px",padding:"4px 8px",borderRadius:"8px"},children:A},B))})]})]})},g))})]})});const x=u[e];return b.jsx("div",{className:"modal-overlay",onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,padding:"20px"},children:b.jsxs("div",{onClick:g=>g.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"25px",padding:"30px",maxWidth:"500px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(255, 184, 77, 0.3)"},children:[b.jsx("button",{onClick:()=>t(null),style:{background:"rgba(255, 255, 255, 0.1)",border:"none",color:"white",fontSize:"14px",padding:"8px 16px",borderRadius:"20px",cursor:"pointer",marginBottom:"20px"},children:" Back"}),b.jsxs("div",{style:{textAlign:"center",marginBottom:"25px"},children:[b.jsx("span",{style:{fontSize:"60px"},children:x.icon}),b.jsx("h2",{style:{color:"white",fontSize:"24px",margin:"10px 0"},children:x.name}),b.jsx("p",{style:{color:"#FFB84D",fontSize:"14px",fontWeight:"bold"},children:x.duration})]}),b.jsxs("div",{style:{marginBottom:"25px"},children:[b.jsx("h4",{style:{color:"white",fontSize:"16px",marginBottom:"10px"},children:" Benefits:"}),x.benefits.map((g,w)=>b.jsxs("div",{style:{color:"#888",fontSize:"14px",marginBottom:"5px",paddingLeft:"10px"},children:[" ",g]},w))]}),n?b.jsx("button",{onClick:f,style:{width:"100%",padding:"18px",background:"linear-gradient(135deg, #FF4444, #FF6B6B)",border:"none",borderRadius:"15px",color:"white",fontSize:"18px",fontWeight:"bold",cursor:"pointer",marginBottom:"20px"},children:" Stop"}):b.jsx("button",{onClick:h,style:{width:"100%",padding:"18px",background:"linear-gradient(135deg, #FFB84D, #FF9500)",border:"none",borderRadius:"15px",color:"white",fontSize:"18px",fontWeight:"bold",cursor:"pointer",marginBottom:"20px",boxShadow:"0 5px 20px rgba(255, 184, 77, 0.4)"},children:" Start Guided Meditation"}),b.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"15px",padding:"20px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[b.jsx("h4",{style:{color:"white",fontSize:"16px",marginBottom:"15px"},children:" Meditation Guide:"}),x.steps.map((g,w)=>b.jsxs("div",{style:{color:n&&w===s?"#FFD700":w<s?"#888":"white",fontSize:"14px",marginBottom:"12px",paddingLeft:"25px",position:"relative",transition:"color 0.3s ease",fontWeight:n&&w===s?"bold":"normal"},children:[b.jsxs("span",{style:{position:"absolute",left:0,color:n&&w===s?"#FFD700":"#FFB84D",fontWeight:"bold"},children:[w+1,"."]}),g]},w))]}),b.jsx("button",{onClick:i,style:{width:"100%",padding:"15px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"12px",color:"white",fontSize:"16px",cursor:"pointer",marginTop:"20px"},children:"Close"})]})})}function iY(){const i=Dp(),[e]=oC(),[t,n]=Te.useState("verifying");e.get("session_id"),Te.useEffect(()=>{r()},[]);const r=async()=>{try{const s=lw.currentUser;if(!s){n("error");return}localStorage.removeItem("subscription_last_verified"),await ar.verifySubscriptionWithServer(s.uid),ar.getCurrentPlan().id!=="free"?(n("success"),setTimeout(()=>i("/dashboard"),3e3)):n("pending")}catch(s){console.error("Error verifying payment:",s),n("error")}};return b.jsx("div",{className:"payment-success-container",children:b.jsxs("div",{className:"payment-success-card",children:[t==="verifying"&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"spinner"}),b.jsx("h2",{children:"Verifying Payment..."}),b.jsx("p",{children:"Please wait while we confirm your subscription."})]}),t==="success"&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"success-icon",children:""}),b.jsx("h2",{children:"Payment Successful!"}),b.jsx("p",{children:"Your subscription is now active."}),b.jsx("p",{children:"Redirecting to dashboard..."})]}),t==="pending"&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"pending-icon",children:""}),b.jsx("h2",{children:"Payment Processing"}),b.jsx("p",{children:"Your payment is being processed. This may take a few minutes."}),b.jsx("button",{onClick:()=>i("/dashboard"),className:"return-button",children:"Return to Dashboard"})]}),t==="error"&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"error-icon",children:""}),b.jsx("h2",{children:"Verification Failed"}),b.jsx("p",{children:"We couldn't verify your payment. Please contact support."}),b.jsx("button",{onClick:()=>i("/dashboard"),className:"return-button",children:"Return to Dashboard"})]})]})})}function rY(){const i=Dp();return b.jsx("div",{className:"payment-canceled-container",children:b.jsxs("div",{className:"payment-canceled-card",children:[b.jsx("div",{className:"canceled-icon",children:""}),b.jsx("h2",{children:"Payment Canceled"}),b.jsx("p",{children:"Your payment was canceled. No charges were made."}),b.jsx("p",{children:"You can try again anytime you're ready."}),b.jsxs("div",{className:"action-buttons",children:[b.jsx("button",{onClick:()=>i("/dashboard"),className:"secondary-button",children:"Return to Dashboard"}),b.jsx("button",{onClick:()=>i("/pricing"),className:"primary-button",children:"View Plans"})]})]})})}let Qx=[],R1=null;const gY=(i,e="info",t=3e3)=>{const n={id:Date.now()+Math.random(),message:i,type:e,duration:t};Qx.push(n),R1&&R1()};function sY(){const[i,e]=Te.useState([]);Te.useEffect(()=>(R1=()=>{if(Qx.length>0){const r=Qx.shift();e(s=>[...s,r]),setTimeout(()=>{e(s=>s.filter(l=>l.id!==r.id))},r.duration)}},()=>{R1=null}),[]);const t=r=>{e(s=>s.filter(l=>l.id!==r))},n=r=>{switch(r){case"success":return"";case"error":return"";case"warning":return"";default:return""}};return b.jsx("div",{className:"toast-container",children:i.map(r=>b.jsxs("div",{className:`toast toast-${r.type}`,onClick:()=>t(r.id),children:[b.jsx("span",{className:"toast-icon",children:n(r.type)}),b.jsx("span",{className:"toast-message",children:r.message}),b.jsx("button",{className:"toast-close",onClick:()=>t(r.id),children:""})]},r.id))})}function aY(){return Te.useEffect(()=>{Sr.initGoogleAnalytics(),Sr.trackPageView("App_Start");const i=lw.onAuthStateChanged(e=>{e&&ar.verifySubscriptionWithServer(e.uid).catch(t=>{console.error("Failed to verify subscription on app start:",t)})});return()=>i()},[]),b.jsx(tu,{children:b.jsxs(RO,{children:[b.jsxs(aO,{children:[b.jsx(kg,{path:"/",element:b.jsx(IG,{})}),b.jsx(kg,{path:"/dashboard",element:b.jsx(Uq,{})}),b.jsx(kg,{path:"/payment-success",element:b.jsx(iY,{})}),b.jsx(kg,{path:"/payment-canceled",element:b.jsx(rY,{})})]}),b.jsx(sY,{})]})})}const O0="1.0.8",oY="__BUILD_TIMESTAMP__";"serviceWorker"in navigator&&(navigator.serviceWorker.getRegistrations().then(i=>{i.forEach(e=>{console.log(" Unregistering service worker:",e),e.unregister()})}),"caches"in window&&caches.keys().then(i=>{i.forEach(e=>{console.log(" Deleting cache:",e),caches.delete(e)})}));try{const i=localStorage.getItem("app_version");i!==O0&&(console.log(` Version upgrade detected: ${i}  ${O0}`),localStorage.setItem("app_version",O0),localStorage.setItem("last_cache_clear",new Date().toISOString()),i&&i!=="null"&&(console.log(" Forcing hard reload for version update..."),window.location.reload(!0)))}catch(i){console.warn("localStorage check failed:",i)}console.log(" APP VERSION:",O0);console.log(" BUILD TIME:",oY);console.log(" CACHE BUSTED - Fresh load!");gP.createRoot(document.getElementById("root")).render(b.jsx(Te.StrictMode,{children:b.jsx(aY,{})}));export{dY as A,kG as B,bo as C,$G as D,SI as E,pY as F,E0 as G,fY as H,AI as I,Bk as J,Eu as L,Uh as M,EI as N,gn as P,lP as R,P0 as S,vL as W,Vt as _,Ii as a,gY as b,Xh as c,$k as d,lY as e,Ei as f,T1 as g,Yw as h,Q_ as i,b as j,Ul as k,KW as l,E9 as m,I9 as n,k9 as o,xI as p,Rd as q,Te as r,ar as s,Or as t,M9 as u,_L as v,Yy as w,hY as x,TG as y,CG as z};
